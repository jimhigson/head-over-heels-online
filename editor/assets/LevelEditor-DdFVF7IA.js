const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WebGPURenderer-CQytJcFj.js","assets/index-DhWTDk3V.js","assets/index-eDkM290f.css","assets/colorToUniform-KTpA7KSL.js","assets/SharedSystems-OuwXHCGQ.js","assets/Graphics-Csd7Lk-g.js","assets/levelEditorSlice-gxeo1swf.js","assets/WebGLRenderer-DkpsM3jH.js","assets/JsonRoomEditor-CPS2SL4v.js","assets/JsonRoomEditor-Cpm53wG5.css"])))=>i.map(i=>d[i]);
import{a0 as eg,$ as ba,a1 as Yn,s as tg,x as Yu,y as Et,e as xa,E as Dn,a as rg,C as te,d as Mn,v as Bn,Z as V,D as Ii,ar as Ut,k as ng,K as un,t as _t,T as Vr,U as og,M as sg,as as Xr,V as Zu,at as ig,w as ji,au as ag,av as lg,j as cg,aw as br,ax as h,ay as Qu,az as Ht,aA as g,aB as ug,aC as ed,aD as dg,aE as hg,aF as ue,aG as pt,aH as td,aI as fg,aJ as pg,aK as B,aL as Ge,aM as dn,aN as gg,aO as mg,aP as yg,aQ as rd,aR as nd,aS as od,ag as le,aT as hr,ad as F,aU as sd,aV as Rt,aW as vg,af as qo,a4 as Tt,aX as wg,aY as bg,aZ as co,a_ as ke,a$ as ss,b0 as cr,a7 as id,b1 as Zn,aa as hn,b2 as xg,b3 as _g,ab as Wt,b4 as ur,b5 as ad,b6 as lt,b7 as Sg,a9 as kg,ai as is,b8 as _a,b9 as Sa,ba as jn,bb as ld,bc as cd,bd as $n,be as ka,bf as Cg,bg as Ca,bh as Pg,bi as xr,ah as Eg,bj as Tg,bk as Pa,bl as Io,bm as xl,bn as Rg,bo as Ag,bp as Og,bq as _r,ac as ud,br as Ea,bs as Ig,a6 as Ts,bt as dd,bu as jg,bv as $g,bw as zg,bx as Ng,by as Lg,bz as Dg,bA as Mg,bB as Bg,bC as Fg,bD as Ug,bE as Hg,bF as Wg}from"./index-DhWTDk3V.js";import{r as Gg,u as be,d as hd,c as qg,s as lr,a as Gt,b as Vg,e as _l,f as Xg,g as Kg,h as Jg,i as Yg,j as fd,k as pd,l as Zg,m as rn,n as Qg,o as em,p as gd,q as Rs,t as md,v as tm,w as $i,x as H,y as Qn,z as yd,A as Ta,B as rm,C as nm,D as Ra,E as Fn,F as Un,G as om,H as Aa,I as vd,J as wd,K as sm,L as Sl,M as bd,N as im,O as am,P as kl,Q as As,R as Os,S as Cl,T as xd,U as zi,V as Pl,W as lm,X as cm}from"./levelEditorSlice-gxeo1swf.js";import{S as um,G as ct}from"./Graphics-Csd7Lk-g.js";function dm(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function hm(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function fm(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var El=t=>Array.isArray(t)?t:[t];function pm(t){const e=Array.isArray(t[0])?t[0]:t;return fm(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function gm(t,e){const r=[],{length:n}=t;for(let o=0;o<n;o++)r.push(t[o].apply(null,e));return r}var mm=class{constructor(t){this.value=t}deref(){return this.value}},ym=typeof WeakRef<"u"?WeakRef:mm,vm=0,Tl=1;function uo(){return{s:vm,v:void 0,o:null,p:null}}function _d(t,e={}){let r=uo();const{resultEqualityCheck:n}=e;let o,s=0;function i(){let a=r;const{length:l}=arguments;for(let d=0,f=l;d<f;d++){const p=arguments[d];if(typeof p=="function"||typeof p=="object"&&p!==null){let y=a.o;y===null&&(a.o=y=new WeakMap);const m=y.get(p);m===void 0?(a=uo(),y.set(p,a)):a=m}else{let y=a.p;y===null&&(a.p=y=new Map);const m=y.get(p);m===void 0?(a=uo(),y.set(p,a)):a=m}}const c=a;let u;if(a.s===Tl)u=a.v;else if(u=t.apply(null,arguments),s++,n){const d=o?.deref?.()??o;d!=null&&n(d,u)&&(u=d,s!==0&&s--),o=typeof u=="object"&&u!==null||typeof u=="function"?new ym(u):u}return c.s=Tl,c.v=u,u}return i.clearCache=()=>{r=uo(),i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function wm(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...o)=>{let s=0,i=0,a,l={},c=o.pop();typeof c=="object"&&(l=c,c=o.pop()),dm(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:d,memoizeOptions:f=[],argsMemoize:p=_d,argsMemoizeOptions:y=[]}=u,m=El(f),v=El(y),w=pm(o),S=d(function(){return s++,c.apply(null,arguments)},...m),b=p(function(){i++;const k=gm(w,arguments);return a=S.apply(null,k),a},...v);return Object.assign(b,{resultFunc:c,memoizedResultFunc:S,dependencies:w,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>a,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:d,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var Sd=wm(_d),bm=Object.assign((t,e=Sd)=>{hm(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((i,a,l)=>(i[r[l]]=a,i),{}))},{withTypes:()=>bm}),ho={},Rl;function xm(){if(Rl)return ho;Rl=1;var t=eg(),e=t.mark(s),r=ba(),n=r.wrapWithIterableIterator,o=r.ensureIterable;function s(){var a,l,c,u,d,f,p=arguments;return t.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:for(a=p.length,l=new Array(a),c=0;c<a;c++)l[c]=p[c];u=0,d=l;case 2:if(!(u<d.length)){m.next=8;break}return f=d[u],m.delegateYield(o(f),"t0",5);case 5:u++,m.next=2;break;case 8:case"end":return m.stop()}},e)}ho.__concat=s;var i=n(s);return ho.concat=i,ho}var fo={},Al;function _m(){if(Al)return fo;Al=1;var t=ba(),e=t.iterableCurry,r=Gg(),n=r.__firstOr,o=Symbol("none");function s(a){return n(a,o)===o}fo.__isEmpty=s;var i=e(s,{reduces:!0});return fo.isEmpty=i,fo}var po={},Ol;function Sm(){if(Ol)return po;Ol=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,d=function(){};return{s:d,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(v){throw v},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=!0,p=!1,y;return{s:function(){c=a[Symbol.iterator]()},n:function(){var v=c.next();return f=v.done,v},e:function(v){p=!0,y=v},f:function(){try{!f&&c.return!=null&&c.return()}finally{if(p)throw y}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=ba(),o=n.ensureIterable;function s(a){var l=o(a),c=0,u=t(l),d;try{for(u.s();!(d=u.n()).done;){var f=d.value;c++}}catch(p){u.e(p)}finally{u.f()}return c}po.__size=s;var i=s;return po.size=i,po}var Is,Il;function km(){return Il||(Il=1,Is=xm().concat),Is}var Cm=km();const jl=Yn(Cm);var js,$l;function Pm(){return $l||($l=1,js=_m().isEmpty),js}var Em=Pm();const Oa=Yn(Em);var $s,zl;function Tm(){return zl||(zl=1,$s=Sm().size),$s}var Rm=Tm();const kd=Yn(Rm),Cd=class Ni extends tg{constructor(e){e={...Ni.defaultOptions,...e},super(e),this.enabled=!0,this._state=um.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1)}apply(e,r,n,o){e.applyFilter(this,r,n,o)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:r,gl:n,...o}=e;let s,i;return r&&(s=Yu.from(r)),n&&(i=Et.from(n)),new Ni({gpuProgram:s,glProgram:i,...o})}};Cd.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Jt=Cd;const Li=[];xa.handleByNamedList(Dn.Environment,Li);async function Am(t){if(!t)for(let e=0;e<Li.length;e++){const r=Li[e];if(r.value.test()){await r.value.load();return}}}let wn;function Om(){if(typeof wn=="boolean")return wn;try{wn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{wn=!1}return wn}var Pd=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(Pd||{});class Im{constructor(e){this.items=[],this._name=e}emit(e,r,n,o,s,i,a,l){const{name:c,items:u}=this;for(let d=0,f=u.length;d<f;d++)u[d][c](e,r,n,o,s,i,a,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&this.items.splice(r,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const jm=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Ed=class Td extends rg{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const r=[...jm,...this.config.runners??[]];this._addRunners(...r),this._unsafeEvalCheck()}async init(e={}){const r=e.skipExtensionImports===!0?!0:e.manageImports===!1;await Am(r),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)e={...this._systemsHash[n].constructor.defaultOptions,...e};e={...Td.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(e);this._initOptions=e}render(e,r){let n=e;if(n instanceof te&&(n={container:n},r&&(Mn(Bn,"passing a second argument is deprecated, please use render options instead"),n.target=r.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor??(n.clearColor=this.background.colorRgba),n.clear??(n.clear=this.background.clearBeforeRender)),n.clearColor){const o=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=o?n.clearColor:V.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),n.container.enableRenderGroup(),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(e,r,n){const o=this.view.resolution;this.view.resize(e,r,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==o&&this.runners.resolutionChange.emit(n)}clear(e={}){const r=this;e.target||(e.target=r.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Pd.ALL);const{clear:n,clearColor:o,target:s}=e;V.shared.setValue(o??this.background.colorRgba),r.renderTarget.clear(s,n,V.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(r=>{this.runners[r]=new Im(r)})}_addSystems(e){let r;for(r in e){const n=e[r];this._addSystem(n.value,n.name)}}_addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const o in this.runners)this.runners[o].add(n);return this}_addPipes(e,r){const n=r.reduce((o,s)=>(o[s.name]=s.value,o),{});e.forEach(o=>{const s=o.value,i=o.name,a=n[i];this.renderPipes[i]=new s(this,a?new a:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(r=>{r.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Om())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Ed.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Rd=Ed,go;function $m(t){return go!==void 0||(go=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:t??Rd.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ii.get().getWebGLRenderingContext())return!1;let n=Ii.get().createCanvas().getContext("webgl",e);const o=!!n?.getContextAttributes()?.stencil;if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,o}catch{return!1}})()),go}let mo;async function zm(t={}){return mo!==void 0||(mo=await(async()=>{const e=Ii.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(t)).requestDevice(),!0}catch{return!1}})()),mo}const Nl=["webgl","webgpu","canvas"];async function Nm(t){let e=[];t.preference?(e.push(t.preference),Nl.forEach(s=>{s!==t.preference&&e.push(s)})):e=Nl.slice();let r,n={};for(let s=0;s<e.length;s++){const i=e[s];if(i==="webgpu"&&await zm()){const{WebGPURenderer:a}=await Ut(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-CQytJcFj.js");return{WebGPURenderer:l}},__vite__mapDeps([0,1,2,3,4,5,6]));r=a,n={...t,...t.webgpu};break}else if(i==="webgl"&&$m(t.failIfMajorPerformanceCaveat??Rd.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ut(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-DkpsM3jH.js");return{WebGLRenderer:l}},__vite__mapDeps([7,1,2,3,4,5,6]));r=a,n={...t,...t.webgl};break}else if(i==="canvas")throw n={...t},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!r)throw new Error("No available renderer for the current environment");const o=new r;return await o.init(n),o}const Ad="8.8.1";class Od{static init(){globalThis.__PIXI_APP_INIT__?.(this,Ad)}static destroy(){}}Od.extension=Dn.Application;class Lm{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Ad)}destroy(){this._renderer=null}}Lm.extension={type:[Dn.WebGLSystem,Dn.WebGPUSystem],name:"initHook",priority:-10};const Id=class Di{constructor(...e){this.stage=new te,e[0]!==void 0&&Mn(Bn,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await Nm(e),Di._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Mn(Bn,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,r=!1){const n=Di._plugins.slice(0);n.reverse(),n.forEach(o=>{o.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Id._plugins=[];let jd=Id;xa.handleByList(Dn.Application,jd._plugins);xa.add(Od);var Dm=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Mm=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,Ll=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;const $d=class zd extends Jt{constructor(e){e={...zd.defaultOptions,...e};const r=Yu.from({vertex:{source:Ll,entryPoint:"mainVertex"},fragment:{source:Ll,entryPoint:"mainFragment"}}),n=Et.from({vertex:Dm,fragment:Mm,name:"alpha-filter"}),{alpha:o,...s}=e,i=new ng({uAlpha:{value:o,type:"f32"}});super({...s,gpuProgram:r,glProgram:n,resources:{alphaUniforms:i}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};$d.defaultOptions={alpha:1};let Bm=$d;class Hn extends un{constructor(...e){let r=e[0];Array.isArray(e[0])&&(r={textures:e[0],autoUpdate:e[1]});const{animationSpeed:n=1,autoPlay:o=!1,autoUpdate:s=!0,loop:i=!0,onComplete:a=null,onFrameChange:l=null,onLoop:c=null,textures:u,updateAnchor:d=!1,...f}=r,[p]=u;super({...f,texture:p instanceof _t?p:p.texture}),this._textures=null,this._durations=null,this._autoUpdate=s,this._isConnectedToTicker=!1,this.animationSpeed=n,this.loop=i,this.updateAnchor=d,this.onComplete=a,this.onFrameChange=l,this.onLoop=c,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=u,o&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Vr.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Vr.shared.add(this.update,this,og.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const r=e.deltaTime,n=this.animationSpeed*r,o=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=n/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const i=Math.sign(this.animationSpeed*r);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):o!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<o||this.animationSpeed<0&&this.currentFrame>o)&&this.onLoop(),this._updateTexture())}_updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const r=[];for(let n=0;n<e.length;++n)r.push(_t.from(e[n]));return new Hn(r)}static fromImages(e){const r=[];for(let n=0;n<e.length;++n)r.push(_t.from(e[n]));return new Hn(r)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof _t)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Vr.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Vr.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class Fm{constructor({matrix:e,observer:r}={}){this.dirty=!0,this._matrix=e??new sg,this.observer=r,this.position=new Xr(this,0,0),this.scale=new Xr(this,1,1),this.pivot=new Xr(this,0,0),this.skew=new Xr(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const e=this._matrix;return this.dirty&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this.dirty=!1),e}_onUpdate(e){this.dirty=!0,e===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(e){e.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this.skew))}}const Nd=class jo extends Zu{constructor(...e){let r=e[0]||{};r instanceof _t&&(r={texture:r}),e.length>1&&(Mn(Bn,"use new TilingSprite({ texture, width:100, height:100 }) instead"),r.width=e[1],r.height=e[2]),r={...jo.defaultOptions,...r};const{texture:n,anchor:o,tilePosition:s,tileScale:i,tileRotation:a,width:l,height:c,applyAnchorToTexture:u,roundPixels:d,...f}=r??{};super({label:"TilingSprite",...f}),this.renderPipeId="tilingSprite",this.batched=!0,this.allowChildren=!1,this._anchor=new Xr({_onUpdate:()=>{this.onViewUpdate()}}),this.applyAnchorToTexture=u,this.texture=n,this._width=l??n.width,this._height=c??n.height,this._tileTransform=new Fm({observer:{_onUpdate:()=>this.onViewUpdate()}}),o&&(this.anchor=o),this.tilePosition=s,this.tileScale=i,this.tileRotation=a,this.roundPixels=d??!1}static from(e,r={}){return typeof e=="string"?new jo({texture:ig.get(e),...r}):new jo({texture:e,...r})}get uvRespectAnchor(){return ji("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture}set uvRespectAnchor(e){ji("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture=e}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(e){this._texture.textureMatrix.clampMargin=e}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get tilePosition(){return this._tileTransform.position}set tilePosition(e){this._tileTransform.position.copyFrom(e)}get tileScale(){return this._tileTransform.scale}set tileScale(e){typeof e=="number"?this._tileTransform.scale.set(e):this._tileTransform.scale.copyFrom(e)}set tileRotation(e){this._tileTransform.rotation=e}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}set texture(e){e||(e=_t.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}set width(e){this._width=e,this.onViewUpdate()}get width(){return this._width}set height(e){this._height=e,this.onViewUpdate()}get height(){return this._height}setSize(e,r){typeof e=="object"&&(r=e.height??e.width,e=e.width),this._width=e,this._height=r??e,this.onViewUpdate()}getSize(e){return e||(e={}),e.width=this._width,e.height=this._height,e}updateBounds(){const e=this._bounds,r=this._anchor,n=this._width,o=this._height;e.minX=-r._x*n,e.maxX=e.minX+n,e.minY=-r._y*o,e.maxY=e.minY+o}containsPoint(e){const r=this._width,n=this._height,o=-r*this._anchor._x;let s=0;return e.x>=o&&e.x<=o+r&&(s=-n*this._anchor._y,e.y>=s&&e.y<=s+n)}destroy(e=!1){if(super.destroy(e),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null}};Nd.defaultOptions={texture:_t.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};let Um=Nd;class Hm extends Zu{constructor(e,r){const{text:n,resolution:o,style:s,anchor:i,width:a,height:l,roundPixels:c,...u}=e;super({...u}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=r,this.text=n??"",this.style=s,this.resolution=o??null,this.allowChildren=!1,this._anchor=new Xr({_onUpdate:()=>{this.onViewUpdate()}}),i&&(this.anchor=i),this.roundPixels=c??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this.bounds.width),r!==void 0&&this._setHeight(r,this.bounds.height)}containsPoint(e){const r=this.bounds.width,n=this.bounds.height,o=-r*this.anchor.x;let s=0;return e.x>=o&&e.x<=o+r&&(s=-n*this.anchor.y,e.y>=s&&e.y<=s+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}}function Wm(t,e){let r=t[0]??{};return(typeof r=="string"||t[1])&&(Mn(Bn,`use new ${e}({ text: "hi!", style }) instead`),r={text:r,style:t[1]}),r}class Gm extends Hm{constructor(...e){const r=Wm(e,"Text");super(r,ag),this.renderPipeId="text"}updateBounds(){const e=this._bounds,r=this._anchor,n=lg.measureText(this._text,this._style),{width:o,height:s}=n;e.minX=-r._x*o,e.maxX=e.minX+o,e.minY=-r._y*s,e.maxY=e.minY+s}}class Ia extends _t{static create(e){return new Ia({source:new cg(e)})}resize(e,r,n){return this.source.resize(e,r,n),this}}const Ld=class Dd extends te{constructor(e={}){e={...Dd.defaultOptions,...e},super(),this.renderLayerChildren=[],this.sortableChildren=e.sortableChildren,this.sortFunction=e.sortFunction}attach(...e){for(let r=0;r<e.length;r++){const n=e[r];if(n.parentRenderLayer){if(n.parentRenderLayer===this)continue;n.parentRenderLayer.detach(n)}this.renderLayerChildren.push(n),n.parentRenderLayer=this;const o=this.renderGroup||this.parentRenderGroup;o&&(o.structureDidChange=!0)}return e[0]}detach(...e){for(let r=0;r<e.length;r++){const n=e[r],o=this.renderLayerChildren.indexOf(n);o!==-1&&this.renderLayerChildren.splice(o,1),n.parentRenderLayer=null;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)}return e[0]}detachAll(){const e=this.renderLayerChildren;for(let r=0;r<e.length;r++)e[r].parentRenderLayer=null;this.renderLayerChildren.length=0}collectRenderables(e,r,n){const o=this.renderLayerChildren,s=o.length;this.sortableChildren&&this.sortRenderLayerChildren();for(let i=0;i<s;i++)o[i].parent||ji("Container must be added to both layer and scene graph. Layers only handle render order - the scene graph is required for transforms (addChild)",o[i]),o[i].collectRenderables(e,r,this)}sortRenderLayerChildren(){this.renderLayerChildren.sort(this.sortFunction)}_getGlobalBoundsRecursive(e,r,n){if(!e)return;const o=this.renderLayerChildren;for(let s=0;s<o.length;s++)o[s]._getGlobalBoundsRecursive(!0,r,this)}};Ld.defaultOptions={sortableChildren:!1,sortFunction:(t,e)=>t.zIndex-e.zIndex};let qm=Ld;const Dl=qm,ja="-",Vm=t=>{const e=Km(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:i=>{const a=i.split(ja);return a[0]===""&&a.length!==1&&a.shift(),Md(a,e)||Xm(i)},getConflictingClassGroupIds:(i,a)=>{const l=r[i]||[];return a&&n[i]?[...l,...n[i]]:l}}},Md=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),o=n?Md(t.slice(1),n):void 0;if(o)return o;if(e.validators.length===0)return;const s=t.join(ja);return e.validators.find(({validator:i})=>i(s))?.classGroupId},Ml=/^\[(.+)\]$/,Xm=t=>{if(Ml.test(t)){const e=Ml.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Km=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return Ym(Object.entries(t.classGroups),r).forEach(([s,i])=>{Mi(i,n,s,e)}),n},Mi=(t,e,r,n)=>{t.forEach(o=>{if(typeof o=="string"){const s=o===""?e:Bl(e,o);s.classGroupId=r;return}if(typeof o=="function"){if(Jm(o)){Mi(o(n),e,r,n);return}e.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(([s,i])=>{Mi(i,Bl(e,s),r,n)})})},Bl=(t,e)=>{let r=t;return e.split(ja).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Jm=t=>t.isThemeGetter,Ym=(t,e)=>e?t.map(([r,n])=>{const o=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,a])=>[e+i,a])):s);return[r,o]}):t,Zm=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const o=(s,i)=>{r.set(s,i),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return o(s,i),i},set(s,i){r.has(s)?r.set(s,i):o(s,i)}}},Bd="!",Qm=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,o=e[0],s=e.length,i=a=>{const l=[];let c=0,u=0,d;for(let v=0;v<a.length;v++){let w=a[v];if(c===0){if(w===o&&(n||a.slice(v,v+s)===e)){l.push(a.slice(u,v)),u=v+s;continue}if(w==="/"){d=v;continue}}w==="["?c++:w==="]"&&c--}const f=l.length===0?a:a.substring(u),p=f.startsWith(Bd),y=p?f.substring(1):f,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:m}};return r?a=>r({className:a,parseClassName:i}):i},ey=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},ty=t=>({cache:Zm(t.cacheSize),parseClassName:Qm(t),...Vm(t)}),ry=/\s+/,ny=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o}=e,s=[],i=t.trim().split(ry);let a="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:u,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:p}=r(c);let y=!!p,m=n(y?f.substring(0,p):f);if(!m){if(!y){a=c+(a.length>0?" "+a:a);continue}if(m=n(f),!m){a=c+(a.length>0?" "+a:a);continue}y=!1}const v=ey(u).join(":"),w=d?v+Bd:v,S=w+m;if(s.includes(S))continue;s.push(S);const b=o(m,y);for(let x=0;x<b.length;++x){const k=b[x];s.push(w+k)}a=c+(a.length>0?" "+a:a)}return a};function oy(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Fd(e))&&(n&&(n+=" "),n+=r);return n}const Fd=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=Fd(t[n]))&&(r&&(r+=" "),r+=e);return r};function sy(t,...e){let r,n,o,s=i;function i(l){const c=e.reduce((u,d)=>d(u),t());return r=ty(c),n=r.cache.get,o=r.cache.set,s=a,a(l)}function a(l){const c=n(l);if(c)return c;const u=ny(l,r);return o(l,u),u}return function(){return s(oy.apply(null,arguments))}}const ge=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Ud=/^\[(?:([a-z-]+):)?(.+)\]$/i,iy=/^\d+\/\d+$/,ay=new Set(["px","full","screen"]),ly=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,cy=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,uy=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,dy=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hy=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,mt=t=>Zr(t)||ay.has(t)||iy.test(t),At=t=>fn(t,"length",by),Zr=t=>!!t&&!Number.isNaN(Number(t)),zs=t=>fn(t,"number",Zr),bn=t=>!!t&&Number.isInteger(Number(t)),fy=t=>t.endsWith("%")&&Zr(t.slice(0,-1)),Y=t=>Ud.test(t),Ot=t=>ly.test(t),py=new Set(["length","size","percentage"]),gy=t=>fn(t,py,Hd),my=t=>fn(t,"position",Hd),yy=new Set(["image","url"]),vy=t=>fn(t,yy,_y),wy=t=>fn(t,"",xy),xn=()=>!0,fn=(t,e,r)=>{const n=Ud.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},by=t=>cy.test(t)&&!uy.test(t),Hd=()=>!1,xy=t=>dy.test(t),_y=t=>hy.test(t),Sy=()=>{const t=ge("colors"),e=ge("spacing"),r=ge("blur"),n=ge("brightness"),o=ge("borderColor"),s=ge("borderRadius"),i=ge("borderSpacing"),a=ge("borderWidth"),l=ge("contrast"),c=ge("grayscale"),u=ge("hueRotate"),d=ge("invert"),f=ge("gap"),p=ge("gradientColorStops"),y=ge("gradientColorStopPositions"),m=ge("inset"),v=ge("margin"),w=ge("opacity"),S=ge("padding"),b=ge("saturate"),x=ge("scale"),k=ge("sepia"),C=ge("skew"),_=ge("space"),j=ge("translate"),D=()=>["auto","contain","none"],N=()=>["auto","hidden","clip","visible","scroll"],W=()=>["auto",Y,e],I=()=>[Y,e],re=()=>["",mt,At],M=()=>["auto",Zr,Y],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>["start","end","center","between","around","evenly","stretch"],ie=()=>["","0",Y],de=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ce=()=>[Zr,Y];return{cacheSize:500,separator:":",theme:{colors:[xn],spacing:[mt,At],blur:["none","",Ot,Y],brightness:ce(),borderColor:[t],borderRadius:["none","","full",Ot,Y],borderSpacing:I(),borderWidth:re(),contrast:ce(),grayscale:ie(),hueRotate:ce(),invert:ie(),gap:I(),gradientColorStops:[t],gradientColorStopPositions:[fy,At],inset:W(),margin:W(),opacity:ce(),padding:I(),saturate:ce(),scale:ce(),sepia:ie(),skew:ce(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Y]}],container:["container"],columns:[{columns:[Ot]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),Y]}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bn,Y]}],basis:[{basis:W()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Y]}],grow:[{grow:ie()}],shrink:[{shrink:ie()}],order:[{order:["first","last","none",bn,Y]}],"grid-cols":[{"grid-cols":[xn]}],"col-start-end":[{col:["auto",{span:["full",bn,Y]},Y]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[xn]}],"row-start-end":[{row:["auto",{span:[bn,Y]},Y]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Y]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Y]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...X()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...X(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...X(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Y,e]}],"min-w":[{"min-w":[Y,e,"min","max","fit"]}],"max-w":[{"max-w":[Y,e,"none","full","min","max","fit","prose",{screen:[Ot]},Ot]}],h:[{h:[Y,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Y,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ot,At]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",zs]}],"font-family":[{font:[xn]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Y]}],"line-clamp":[{"line-clamp":["none",Zr,zs]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",mt,Y]}],"list-image":[{"list-image":["none",Y]}],"list-style-type":[{list:["none","disc","decimal",Y]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",mt,At]}],"underline-offset":[{"underline-offset":["auto",mt,Y]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),my]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gy]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vy]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:G()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[mt,Y]}],"outline-w":[{outline:[mt,At]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:re()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[mt,At]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ot,wy]}],"shadow-color":[{shadow:[xn]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ot,Y]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Y]}],duration:[{duration:ce()}],ease:[{ease:["linear","in","out","in-out",Y]}],delay:[{delay:ce()}],animate:[{animate:["none","spin","ping","pulse","bounce",Y]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[bn,Y]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Y]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Y]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Y]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[mt,At,zs]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Wd=sy(Sy);function Gd(t){if(!Vo(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(br.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function Vo(t){return br.frames[t]!==void 0}function qd(t){return br.animations[t]!==void 0}const ky=t=>t.replaceAll(".","_"),Q=({children:t,className:e,noSlitWords:r,classnameCycle:n,onClick:o,noTint:s=!1,TagName:i="span"})=>{const a=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(a.length===0)return null;const l=r?[a.toUpperCase()]:a.toUpperCase().split(/\s+/);return h.jsxs(i,{className:e,onClick:o,children:[h.jsx("span",{className:"sr-only",children:a}),l.map((c,u)=>h.jsx("span",{className:Wd("text-nowrap inline-block",u===l.length-1?"":"me-1"),children:Array.from(c).map((d,f)=>{const p=`hud.char.${Qu(d)}`;return Vo(p)||console.error("no texture for char",d,d.charCodeAt(0),p,"we have:",Object.keys(Ht().textures)),h.jsx("span",{className:`sprite ${Vo(p)?`texture-${ky(p)}`:"texture-hud_char_?"}
                  ${s?"":"sprite-tinted"}
                  ${n===void 0?"":n[f%n.length]}`},f)})},u))]})};function Be(t,e,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t?.(o),r===!1||!o.defaultPrevented)return e?.(o)}}function Fl(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Vd(...t){return e=>{let r=!1;const n=t.map(o=>{const s=Fl(o,e);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s=="function"?s():Fl(t[o],null)}}}}function nt(...t){return g.useCallback(Vd(...t),t)}function Cy(t,e){const r=g.createContext(e),n=s=>{const{children:i,...a}=s,l=g.useMemo(()=>a,Object.values(a));return h.jsx(r.Provider,{value:l,children:i})};n.displayName=t+"Provider";function o(s){const i=g.useContext(r);if(i)return i;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[n,o]}function $a(t,e=[]){let r=[];function n(s,i){const a=g.createContext(i),l=r.length;r=[...r,i];const c=d=>{const{scope:f,children:p,...y}=d,m=f?.[t]?.[l]||a,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})};c.displayName=s+"Provider";function u(d,f){const p=f?.[t]?.[l]||a,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const o=()=>{const s=r.map(i=>g.createContext(i));return function(a){const l=a?.[t]||s;return g.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return o.scopeName=t,[n,Py(o,...e)]}function Py(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return r.scopeName=e.scopeName,r}var za=ug();const Ey=Yn(za);var as=g.forwardRef((t,e)=>{const{children:r,...n}=t,o=g.Children.toArray(r),s=o.find(Ry);if(s){const i=s.props.children,a=o.map(l=>l===s?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:l);return h.jsx(Bi,{...n,ref:e,children:g.isValidElement(i)?g.cloneElement(i,void 0,a):null})}return h.jsx(Bi,{...n,ref:e,children:r})});as.displayName="Slot";var Bi=g.forwardRef((t,e)=>{const{children:r,...n}=t;if(g.isValidElement(r)){const o=Oy(r),s=Ay(n,r.props);return r.type!==g.Fragment&&(s.ref=e?Vd(e,o):o),g.cloneElement(r,s)}return g.Children.count(r)>1?g.Children.only(null):null});Bi.displayName="SlotClone";var Ty=({children:t})=>h.jsx(h.Fragment,{children:t});function Ry(t){return g.isValidElement(t)&&t.type===Ty}function Ay(t,e){const r={...e};for(const n in e){const o=t[n],s=e[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...a)=>{s(...a),o(...a)}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...t,...r}}function Oy(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Iy=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],we=Iy.reduce((t,e)=>{const r=g.forwardRef((n,o)=>{const{asChild:s,...i}=n,a=s?as:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(a,{...i,ref:o})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function jy(t,e){t&&za.flushSync(()=>t.dispatchEvent(e))}function qt(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...r)=>e.current?.(...r),[])}function $y(t,e=globalThis?.document){const r=qt(t);g.useEffect(()=>{const n=o=>{o.key==="Escape"&&r(o)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var zy="DismissableLayer",Fi="dismissableLayer.update",Ny="dismissableLayer.pointerDownOutside",Ly="dismissableLayer.focusOutside",Ul,Xd=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Na=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:a,...l}=t,c=g.useContext(Xd),[u,d]=g.useState(null),f=u?.ownerDocument??globalThis?.document,[,p]=g.useState({}),y=nt(e,_=>d(_)),m=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=m.indexOf(v),S=u?m.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,x=S>=w,k=By(_=>{const j=_.target,D=[...c.branches].some(N=>N.contains(j));!x||D||(o?.(_),i?.(_),_.defaultPrevented||a?.())},f),C=Fy(_=>{const j=_.target;[...c.branches].some(N=>N.contains(j))||(s?.(_),i?.(_),_.defaultPrevented||a?.())},f);return $y(_=>{S===c.layers.size-1&&(n?.(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},f),g.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Ul=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Hl(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Ul)}},[u,f,r,c]),g.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Hl())},[u,c]),g.useEffect(()=>{const _=()=>p({});return document.addEventListener(Fi,_),()=>document.removeEventListener(Fi,_)},[]),h.jsx(we.div,{...l,ref:y,style:{pointerEvents:b?x?"auto":"none":void 0,...t.style},onFocusCapture:Be(t.onFocusCapture,C.onFocusCapture),onBlurCapture:Be(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Be(t.onPointerDownCapture,k.onPointerDownCapture)})});Na.displayName=zy;var Dy="DismissableLayerBranch",My=g.forwardRef((t,e)=>{const r=g.useContext(Xd),n=g.useRef(null),o=nt(e,n);return g.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),h.jsx(we.div,{...t,ref:o})});My.displayName=Dy;function By(t,e=globalThis?.document){const r=qt(t),n=g.useRef(!1),o=g.useRef(()=>{});return g.useEffect(()=>{const s=a=>{if(a.target&&!n.current){let l=function(){Kd(Ny,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=l,e.addEventListener("click",o.current,{once:!0})):l()}else e.removeEventListener("click",o.current);n.current=!1},i=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),e.removeEventListener("pointerdown",s),e.removeEventListener("click",o.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function Fy(t,e=globalThis?.document){const r=qt(t),n=g.useRef(!1);return g.useEffect(()=>{const o=s=>{s.target&&!n.current&&Kd(Ly,r,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Hl(){const t=new CustomEvent(Fi);document.dispatchEvent(t)}function Kd(t,e,r,{discrete:n}){const o=r.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&o.addEventListener(t,e,{once:!0}),n?jy(o,s):o.dispatchEvent(s)}var Ns=0;function Jd(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Wl()),document.body.insertAdjacentElement("beforeend",t[1]??Wl()),Ns++,()=>{Ns===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Ns--}},[])}function Wl(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ls="focusScope.autoFocusOnMount",Ds="focusScope.autoFocusOnUnmount",Gl={bubbles:!1,cancelable:!0},Uy="FocusScope",La=g.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=t,[a,l]=g.useState(null),c=qt(o),u=qt(s),d=g.useRef(null),f=nt(e,m=>l(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(n){let m=function(b){if(p.paused||!a)return;const x=b.target;a.contains(x)?d.current=x:Nt(d.current,{select:!0})},v=function(b){if(p.paused||!a)return;const x=b.relatedTarget;x!==null&&(a.contains(x)||Nt(d.current,{select:!0}))},w=function(b){if(document.activeElement===document.body)for(const k of b)k.removedNodes.length>0&&Nt(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const S=new MutationObserver(w);return a&&S.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),S.disconnect()}}},[n,a,p.paused]),g.useEffect(()=>{if(a){Vl.add(p);const m=document.activeElement;if(!a.contains(m)){const w=new CustomEvent(Ls,Gl);a.addEventListener(Ls,c),a.dispatchEvent(w),w.defaultPrevented||(Hy(Xy(Yd(a)),{select:!0}),document.activeElement===m&&Nt(a))}return()=>{a.removeEventListener(Ls,c),setTimeout(()=>{const w=new CustomEvent(Ds,Gl);a.addEventListener(Ds,u),a.dispatchEvent(w),w.defaultPrevented||Nt(m??document.body,{select:!0}),a.removeEventListener(Ds,u),Vl.remove(p)},0)}}},[a,c,u,p]);const y=g.useCallback(m=>{if(!r&&!n||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,w=document.activeElement;if(v&&w){const S=m.currentTarget,[b,x]=Wy(S);b&&x?!m.shiftKey&&w===x?(m.preventDefault(),r&&Nt(b,{select:!0})):m.shiftKey&&w===b&&(m.preventDefault(),r&&Nt(x,{select:!0})):w===S&&m.preventDefault()}},[r,n,p.paused]);return h.jsx(we.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});La.displayName=Uy;function Hy(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(Nt(n,{select:e}),document.activeElement!==r)return}function Wy(t){const e=Yd(t),r=ql(e,t),n=ql(e.reverse(),t);return[r,n]}function Yd(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function ql(t,e){for(const r of t)if(!Gy(r,{upTo:e}))return r}function Gy(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function qy(t){return t instanceof HTMLInputElement&&"select"in t}function Nt(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&qy(t)&&e&&t.select()}}var Vl=Vy();function Vy(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=Xl(t,e),t.unshift(e)},remove(e){t=Xl(t,e),t[0]?.resume()}}}function Xl(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function Xy(t){return t.filter(e=>e.tagName!=="A")}var fr=globalThis?.document?g.useLayoutEffect:()=>{},Ky=ed.useId||(()=>{}),Jy=0;function ut(t){const[e,r]=g.useState(Ky());return fr(()=>{r(n=>n??String(Jy++))},[t]),t||(e?`radix-${e}`:"")}const Yy=["top","right","bottom","left"],Vt=Math.min,Me=Math.max,Xo=Math.round,yo=Math.floor,dt=t=>({x:t,y:t}),Zy={left:"right",right:"left",bottom:"top",top:"bottom"},Qy={start:"end",end:"start"};function Ui(t,e,r){return Me(t,Vt(e,r))}function kt(t,e){return typeof t=="function"?t(e):t}function Ct(t){return t.split("-")[0]}function pn(t){return t.split("-")[1]}function Da(t){return t==="x"?"y":"x"}function Ma(t){return t==="y"?"height":"width"}function Xt(t){return["top","bottom"].includes(Ct(t))?"y":"x"}function Ba(t){return Da(Xt(t))}function ev(t,e,r){r===void 0&&(r=!1);const n=pn(t),o=Ba(t),s=Ma(o);let i=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(i=Ko(i)),[i,Ko(i)]}function tv(t){const e=Ko(t);return[Hi(t),e,Hi(e)]}function Hi(t){return t.replace(/start|end/g,e=>Qy[e])}function rv(t,e,r){const n=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(t){case"top":case"bottom":return r?e?o:n:e?n:o;case"left":case"right":return e?s:i;default:return[]}}function nv(t,e,r,n){const o=pn(t);let s=rv(Ct(t),r==="start",n);return o&&(s=s.map(i=>i+"-"+o),e&&(s=s.concat(s.map(Hi)))),s}function Ko(t){return t.replace(/left|right|bottom|top/g,e=>Zy[e])}function ov(t){return{top:0,right:0,bottom:0,left:0,...t}}function Zd(t){return typeof t!="number"?ov(t):{top:t,right:t,bottom:t,left:t}}function Jo(t){const{x:e,y:r,width:n,height:o}=t;return{width:n,height:o,top:r,left:e,right:e+n,bottom:r+o,x:e,y:r}}function Kl(t,e,r){let{reference:n,floating:o}=t;const s=Xt(e),i=Ba(e),a=Ma(i),l=Ct(e),c=s==="y",u=n.x+n.width/2-o.width/2,d=n.y+n.height/2-o.height/2,f=n[a]/2-o[a]/2;let p;switch(l){case"top":p={x:u,y:n.y-o.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-o.width,y:d};break;default:p={x:n.x,y:n.y}}switch(pn(e)){case"start":p[i]-=f*(r&&c?-1:1);break;case"end":p[i]+=f*(r&&c?-1:1);break}return p}const sv=async(t,e,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:s=[],platform:i}=r,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(e));let c=await i.getElementRects({reference:t,floating:e,strategy:o}),{x:u,y:d}=Kl(c,n,l),f=n,p={},y=0;for(let m=0;m<a.length;m++){const{name:v,fn:w}=a[m],{x:S,y:b,data:x,reset:k}=await w({x:u,y:d,initialPlacement:n,placement:f,strategy:o,middlewareData:p,rects:c,platform:i,elements:{reference:t,floating:e}});u=S??u,d=b??d,p={...p,[v]:{...p[v],...x}},k&&y<=50&&(y++,typeof k=="object"&&(k.placement&&(f=k.placement),k.rects&&(c=k.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:o}):k.rects),{x:u,y:d}=Kl(c,f,l)),m=-1)}return{x:u,y:d,placement:f,strategy:o,middlewareData:p}};async function Wn(t,e){var r;e===void 0&&(e={});const{x:n,y:o,platform:s,rects:i,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=kt(e,t),y=Zd(p),v=a[f?d==="floating"?"reference":"floating":d],w=Jo(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(v)))==null||r?v:v.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),S=d==="floating"?{x:n,y:o,width:i.floating.width,height:i.floating.height}:i.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),x=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},k=Jo(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:S,offsetParent:b,strategy:l}):S);return{top:(w.top-k.top+y.top)/x.y,bottom:(k.bottom-w.bottom+y.bottom)/x.y,left:(w.left-k.left+y.left)/x.x,right:(k.right-w.right+y.right)/x.x}}const iv=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:o,rects:s,platform:i,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=kt(t,e)||{};if(c==null)return{};const d=Zd(u),f={x:r,y:n},p=Ba(o),y=Ma(p),m=await i.getDimensions(c),v=p==="y",w=v?"top":"left",S=v?"bottom":"right",b=v?"clientHeight":"clientWidth",x=s.reference[y]+s.reference[p]-f[p]-s.floating[y],k=f[p]-s.reference[p],C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let _=C?C[b]:0;(!_||!await(i.isElement==null?void 0:i.isElement(C)))&&(_=a.floating[b]||s.floating[y]);const j=x/2-k/2,D=_/2-m[y]/2-1,N=Vt(d[w],D),W=Vt(d[S],D),I=N,re=_-m[y]-W,M=_/2-m[y]/2+j,K=Ui(I,M,re),G=!l.arrow&&pn(o)!=null&&M!==K&&s.reference[y]/2-(M<I?N:W)-m[y]/2<0,se=G?M<I?M-I:M-re:0;return{[p]:f[p]+se,data:{[p]:K,centerOffset:M-K-se,...G&&{alignmentOffset:se}},reset:G}}}),av=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=kt(t,e);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const w=Ct(o),S=Xt(a),b=Ct(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=f||(b||!m?[Ko(a)]:tv(a)),C=y!=="none";!f&&C&&k.push(...nv(a,m,y,x));const _=[a,...k],j=await Wn(e,v),D=[];let N=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&D.push(j[w]),d){const M=ev(o,i,x);D.push(j[M[0]],j[M[1]])}if(N=[...N,{placement:o,overflows:D}],!D.every(M=>M<=0)){var W,I;const M=(((W=s.flip)==null?void 0:W.index)||0)+1,K=_[M];if(K)return{data:{index:M,overflows:N},reset:{placement:K}};let G=(I=N.filter(se=>se.overflows[0]<=0).sort((se,X)=>se.overflows[1]-X.overflows[1])[0])==null?void 0:I.placement;if(!G)switch(p){case"bestFit":{var re;const se=(re=N.filter(X=>{if(C){const ie=Xt(X.placement);return ie===S||ie==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(ie=>ie>0).reduce((ie,de)=>ie+de,0)]).sort((X,ie)=>X[1]-ie[1])[0])==null?void 0:re[0];se&&(G=se);break}case"initialPlacement":G=a;break}if(o!==G)return{reset:{placement:G}}}return{}}}};function Jl(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Yl(t){return Yy.some(e=>t[e]>=0)}const lv=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...o}=kt(t,e);switch(n){case"referenceHidden":{const s=await Wn(e,{...o,elementContext:"reference"}),i=Jl(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Yl(i)}}}case"escaped":{const s=await Wn(e,{...o,altBoundary:!0}),i=Jl(s,r.floating);return{data:{escapedOffsets:i,escaped:Yl(i)}}}default:return{}}}}};async function cv(t,e){const{placement:r,platform:n,elements:o}=t,s=await(n.isRTL==null?void 0:n.isRTL(o.floating)),i=Ct(r),a=pn(r),l=Xt(r)==="y",c=["left","top"].includes(i)?-1:1,u=s&&l?-1:1,d=kt(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof y=="number"&&(p=a==="end"?y*-1:y),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const uv=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:o,y:s,placement:i,middlewareData:a}=e,l=await cv(e,t);return i===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},dv=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:o}=e,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:v=>{let{x:w,y:S}=v;return{x:w,y:S}}},...l}=kt(t,e),c={x:r,y:n},u=await Wn(e,l),d=Xt(Ct(o)),f=Da(d);let p=c[f],y=c[d];if(s){const v=f==="y"?"top":"left",w=f==="y"?"bottom":"right",S=p+u[v],b=p-u[w];p=Ui(S,p,b)}if(i){const v=d==="y"?"top":"left",w=d==="y"?"bottom":"right",S=y+u[v],b=y-u[w];y=Ui(S,y,b)}const m=a.fn({...e,[f]:p,[d]:y});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[f]:s,[d]:i}}}}}},hv=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:o,rects:s,middlewareData:i}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=kt(t,e),u={x:r,y:n},d=Xt(o),f=Da(d);let p=u[f],y=u[d];const m=kt(a,e),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=f==="y"?"height":"width",x=s.reference[f]-s.floating[b]+v.mainAxis,k=s.reference[f]+s.reference[b]-v.mainAxis;p<x?p=x:p>k&&(p=k)}if(c){var w,S;const b=f==="y"?"width":"height",x=["top","left"].includes(Ct(o)),k=s.reference[d]-s.floating[b]+(x&&((w=i.offset)==null?void 0:w[d])||0)+(x?0:v.crossAxis),C=s.reference[d]+s.reference[b]+(x?0:((S=i.offset)==null?void 0:S[d])||0)-(x?v.crossAxis:0);y<k?y=k:y>C&&(y=C)}return{[f]:p,[d]:y}}}},fv=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:o,rects:s,platform:i,elements:a}=e,{apply:l=()=>{},...c}=kt(t,e),u=await Wn(e,c),d=Ct(o),f=pn(o),p=Xt(o)==="y",{width:y,height:m}=s.floating;let v,w;d==="top"||d==="bottom"?(v=d,w=f===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(w=d,v=f==="end"?"top":"bottom");const S=m-u.top-u.bottom,b=y-u.left-u.right,x=Vt(m-u[v],S),k=Vt(y-u[w],b),C=!e.middlewareData.shift;let _=x,j=k;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(j=b),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(_=S),C&&!f){const N=Me(u.left,0),W=Me(u.right,0),I=Me(u.top,0),re=Me(u.bottom,0);p?j=y-2*(N!==0||W!==0?N+W:Me(u.left,u.right)):_=m-2*(I!==0||re!==0?I+re:Me(u.top,u.bottom))}await l({...e,availableWidth:j,availableHeight:_});const D=await i.getDimensions(a.floating);return y!==D.width||m!==D.height?{reset:{rects:!0}}:{}}}};function ls(){return typeof window<"u"}function gn(t){return Qd(t)?(t.nodeName||"").toLowerCase():"#document"}function Fe(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function gt(t){var e;return(e=(Qd(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Qd(t){return ls()?t instanceof Node||t instanceof Fe(t).Node:!1}function et(t){return ls()?t instanceof Element||t instanceof Fe(t).Element:!1}function ht(t){return ls()?t instanceof HTMLElement||t instanceof Fe(t).HTMLElement:!1}function Zl(t){return!ls()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Fe(t).ShadowRoot}function eo(t){const{overflow:e,overflowX:r,overflowY:n,display:o}=tt(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(o)}function pv(t){return["table","td","th"].includes(gn(t))}function cs(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Fa(t){const e=Ua(),r=et(t)?tt(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function gv(t){let e=Kt(t);for(;ht(e)&&!nn(e);){if(Fa(e))return e;if(cs(e))return null;e=Kt(e)}return null}function Ua(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function nn(t){return["html","body","#document"].includes(gn(t))}function tt(t){return Fe(t).getComputedStyle(t)}function us(t){return et(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Kt(t){if(gn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Zl(t)&&t.host||gt(t);return Zl(e)?e.host:e}function eh(t){const e=Kt(t);return nn(e)?t.ownerDocument?t.ownerDocument.body:t.body:ht(e)&&eo(e)?e:eh(e)}function Gn(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const o=eh(t),s=o===((n=t.ownerDocument)==null?void 0:n.body),i=Fe(o);if(s){const a=Wi(i);return e.concat(i,i.visualViewport||[],eo(o)?o:[],a&&r?Gn(a):[])}return e.concat(o,Gn(o,[],r))}function Wi(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function th(t){const e=tt(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const o=ht(t),s=o?t.offsetWidth:r,i=o?t.offsetHeight:n,a=Xo(r)!==s||Xo(n)!==i;return a&&(r=s,n=i),{width:r,height:n,$:a}}function Ha(t){return et(t)?t:t.contextElement}function Qr(t){const e=Ha(t);if(!ht(e))return dt(1);const r=e.getBoundingClientRect(),{width:n,height:o,$:s}=th(e);let i=(s?Xo(r.width):r.width)/n,a=(s?Xo(r.height):r.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const mv=dt(0);function rh(t){const e=Fe(t);return!Ua()||!e.visualViewport?mv:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function yv(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Fe(t)?!1:e}function pr(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const o=t.getBoundingClientRect(),s=Ha(t);let i=dt(1);e&&(n?et(n)&&(i=Qr(n)):i=Qr(t));const a=yv(s,r,n)?rh(s):dt(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(s){const f=Fe(s),p=n&&et(n)?Fe(n):n;let y=f,m=Wi(y);for(;m&&n&&p!==y;){const v=Qr(m),w=m.getBoundingClientRect(),S=tt(m),b=w.left+(m.clientLeft+parseFloat(S.paddingLeft))*v.x,x=w.top+(m.clientTop+parseFloat(S.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=b,c+=x,y=Fe(m),m=Wi(y)}}return Jo({width:u,height:d,x:l,y:c})}function Wa(t,e){const r=us(t).scrollLeft;return e?e.left+r:pr(gt(t)).left+r}function nh(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),o=n.left+e.scrollLeft-(r?0:Wa(t,n)),s=n.top+e.scrollTop;return{x:o,y:s}}function vv(t){let{elements:e,rect:r,offsetParent:n,strategy:o}=t;const s=o==="fixed",i=gt(n),a=e?cs(e.floating):!1;if(n===i||a&&s)return r;let l={scrollLeft:0,scrollTop:0},c=dt(1);const u=dt(0),d=ht(n);if((d||!d&&!s)&&((gn(n)!=="body"||eo(i))&&(l=us(n)),ht(n))){const p=pr(n);c=Qr(n),u.x=p.x+n.clientLeft,u.y=p.y+n.clientTop}const f=i&&!d&&!s?nh(i,l,!0):dt(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:r.y*c.y-l.scrollTop*c.y+u.y+f.y}}function wv(t){return Array.from(t.getClientRects())}function bv(t){const e=gt(t),r=us(t),n=t.ownerDocument.body,o=Me(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Me(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Wa(t);const a=-r.scrollTop;return tt(n).direction==="rtl"&&(i+=Me(e.clientWidth,n.clientWidth)-o),{width:o,height:s,x:i,y:a}}function xv(t,e){const r=Fe(t),n=gt(t),o=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=Ua();(!c||c&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function _v(t,e){const r=pr(t,!0,e==="fixed"),n=r.top+t.clientTop,o=r.left+t.clientLeft,s=ht(t)?Qr(t):dt(1),i=t.clientWidth*s.x,a=t.clientHeight*s.y,l=o*s.x,c=n*s.y;return{width:i,height:a,x:l,y:c}}function Ql(t,e,r){let n;if(e==="viewport")n=xv(t,r);else if(e==="document")n=bv(gt(t));else if(et(e))n=_v(e,r);else{const o=rh(t);n={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Jo(n)}function oh(t,e){const r=Kt(t);return r===e||!et(r)||nn(r)?!1:tt(r).position==="fixed"||oh(r,e)}function Sv(t,e){const r=e.get(t);if(r)return r;let n=Gn(t,[],!1).filter(a=>et(a)&&gn(a)!=="body"),o=null;const s=tt(t).position==="fixed";let i=s?Kt(t):t;for(;et(i)&&!nn(i);){const a=tt(i),l=Fa(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||eo(i)&&!l&&oh(t,i))?n=n.filter(u=>u!==i):o=a,i=Kt(i)}return e.set(t,n),n}function kv(t){let{element:e,boundary:r,rootBoundary:n,strategy:o}=t;const i=[...r==="clippingAncestors"?cs(e)?[]:Sv(e,this._c):[].concat(r),n],a=i[0],l=i.reduce((c,u)=>{const d=Ql(e,u,o);return c.top=Me(d.top,c.top),c.right=Vt(d.right,c.right),c.bottom=Vt(d.bottom,c.bottom),c.left=Me(d.left,c.left),c},Ql(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Cv(t){const{width:e,height:r}=th(t);return{width:e,height:r}}function Pv(t,e,r){const n=ht(e),o=gt(e),s=r==="fixed",i=pr(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=dt(0);if(n||!n&&!s)if((gn(e)!=="body"||eo(o))&&(a=us(e)),n){const f=pr(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else o&&(l.x=Wa(o));const c=o&&!n&&!s?nh(o,a):dt(0),u=i.left+a.scrollLeft-l.x-c.x,d=i.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:i.width,height:i.height}}function Ms(t){return tt(t).position==="static"}function ec(t,e){if(!ht(t)||tt(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return gt(t)===r&&(r=r.ownerDocument.body),r}function sh(t,e){const r=Fe(t);if(cs(t))return r;if(!ht(t)){let o=Kt(t);for(;o&&!nn(o);){if(et(o)&&!Ms(o))return o;o=Kt(o)}return r}let n=ec(t,e);for(;n&&pv(n)&&Ms(n);)n=ec(n,e);return n&&nn(n)&&Ms(n)&&!Fa(n)?r:n||gv(t)||r}const Ev=async function(t){const e=this.getOffsetParent||sh,r=this.getDimensions,n=await r(t.floating);return{reference:Pv(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Tv(t){return tt(t).direction==="rtl"}const Rv={convertOffsetParentRelativeRectToViewportRelativeRect:vv,getDocumentElement:gt,getClippingRect:kv,getOffsetParent:sh,getElementRects:Ev,getClientRects:wv,getDimensions:Cv,getScale:Qr,isElement:et,isRTL:Tv};function ih(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Av(t,e){let r=null,n;const o=gt(t);function s(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=c;if(a||e(),!f||!p)return;const y=yo(d),m=yo(o.clientWidth-(u+f)),v=yo(o.clientHeight-(d+p)),w=yo(u),b={rootMargin:-y+"px "+-m+"px "+-v+"px "+-w+"px",threshold:Me(0,Vt(1,l))||1};let x=!0;function k(C){const _=C[0].intersectionRatio;if(_!==l){if(!x)return i();_?i(!1,_):n=setTimeout(()=>{i(!1,1e-7)},1e3)}_===1&&!ih(c,t.getBoundingClientRect())&&i(),x=!1}try{r=new IntersectionObserver(k,{...b,root:o.ownerDocument})}catch{r=new IntersectionObserver(k,b)}r.observe(t)}return i(!0),s}function Ov(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Ha(t),u=o||s?[...c?Gn(c):[],...Gn(e)]:[];u.forEach(w=>{o&&w.addEventListener("scroll",r,{passive:!0}),s&&w.addEventListener("resize",r)});const d=c&&a?Av(c,r):null;let f=-1,p=null;i&&(p=new ResizeObserver(w=>{let[S]=w;S&&S.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),r()}),c&&!l&&p.observe(c),p.observe(e));let y,m=l?pr(t):null;l&&v();function v(){const w=pr(t);m&&!ih(m,w)&&r(),m=w,y=requestAnimationFrame(v)}return r(),()=>{var w;u.forEach(S=>{o&&S.removeEventListener("scroll",r),s&&S.removeEventListener("resize",r)}),d?.(),(w=p)==null||w.disconnect(),p=null,l&&cancelAnimationFrame(y)}}const Iv=uv,jv=dv,$v=av,zv=fv,Nv=lv,tc=iv,Lv=hv,Dv=(t,e,r)=>{const n=new Map,o={platform:Rv,...r},s={...o.platform,_c:n};return sv(t,e,{...o,platform:s})};var $o=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Yo(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!Yo(t[n],e[n]))return!1;return!0}if(o=Object.keys(t),r=o.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,o[n]))return!1;for(n=r;n--!==0;){const s=o[n];if(!(s==="_owner"&&t.$$typeof)&&!Yo(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function ah(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function rc(t,e){const r=ah(t);return Math.round(e*r)/r}function Bs(t){const e=g.useRef(t);return $o(()=>{e.current=t}),e}function Mv(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=g.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=g.useState(n);Yo(f,n)||p(n);const[y,m]=g.useState(null),[v,w]=g.useState(null),S=g.useCallback(X=>{X!==C.current&&(C.current=X,m(X))},[]),b=g.useCallback(X=>{X!==_.current&&(_.current=X,w(X))},[]),x=s||y,k=i||v,C=g.useRef(null),_=g.useRef(null),j=g.useRef(u),D=l!=null,N=Bs(l),W=Bs(o),I=Bs(c),re=g.useCallback(()=>{if(!C.current||!_.current)return;const X={placement:e,strategy:r,middleware:f};W.current&&(X.platform=W.current),Dv(C.current,_.current,X).then(ie=>{const de={...ie,isPositioned:I.current!==!1};M.current&&!Yo(j.current,de)&&(j.current=de,za.flushSync(()=>{d(de)}))})},[f,e,r,W,I]);$o(()=>{c===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,d(X=>({...X,isPositioned:!1})))},[c]);const M=g.useRef(!1);$o(()=>(M.current=!0,()=>{M.current=!1}),[]),$o(()=>{if(x&&(C.current=x),k&&(_.current=k),x&&k){if(N.current)return N.current(x,k,re);re()}},[x,k,re,N,D]);const K=g.useMemo(()=>({reference:C,floating:_,setReference:S,setFloating:b}),[S,b]),G=g.useMemo(()=>({reference:x,floating:k}),[x,k]),se=g.useMemo(()=>{const X={position:r,left:0,top:0};if(!G.floating)return X;const ie=rc(G.floating,u.x),de=rc(G.floating,u.y);return a?{...X,transform:"translate("+ie+"px, "+de+"px)",...ah(G.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ie,top:de}},[r,a,G.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:re,refs:K,elements:G,floatingStyles:se}),[u,re,K,G,se])}const Bv=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:o}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?tc({element:n.current,padding:o}).fn(r):{}:n?tc({element:n,padding:o}).fn(r):{}}}},Fv=(t,e)=>({...Iv(t),options:[t,e]}),Uv=(t,e)=>({...jv(t),options:[t,e]}),Hv=(t,e)=>({...Lv(t),options:[t,e]}),Wv=(t,e)=>({...$v(t),options:[t,e]}),Gv=(t,e)=>({...zv(t),options:[t,e]}),qv=(t,e)=>({...Nv(t),options:[t,e]}),Vv=(t,e)=>({...Bv(t),options:[t,e]});var Xv="Arrow",lh=g.forwardRef((t,e)=>{const{children:r,width:n=10,height:o=5,...s}=t;return h.jsx(we.svg,{...s,ref:e,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});lh.displayName=Xv;var Kv=lh;function Jv(t){const[e,r]=g.useState(void 0);return fr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=t.offsetWidth,a=t.offsetHeight;r({width:i,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var Ga="Popper",[ch,uh]=$a(Ga),[Yv,dh]=ch(Ga),hh=t=>{const{__scopePopper:e,children:r}=t,[n,o]=g.useState(null);return h.jsx(Yv,{scope:e,anchor:n,onAnchorChange:o,children:r})};hh.displayName=Ga;var fh="PopperAnchor",ph=g.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...o}=t,s=dh(fh,r),i=g.useRef(null),a=nt(e,i);return g.useEffect(()=>{s.onAnchorChange(n?.current||i.current)}),n?null:h.jsx(we.div,{...o,ref:a})});ph.displayName=fh;var qa="PopperContent",[Zv,Qv]=ch(qa),gh=g.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=t,v=dh(qa,r),[w,S]=g.useState(null),b=nt(e,R=>S(R)),[x,k]=g.useState(null),C=Jv(x),_=C?.width??0,j=C?.height??0,D=n+(s!=="center"?"-"+s:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},W=Array.isArray(c)?c:[c],I=W.length>0,re={padding:N,boundary:W.filter(tw),altBoundary:I},{refs:M,floatingStyles:K,placement:G,isPositioned:se,middlewareData:X}=Mv({strategy:"fixed",placement:D,whileElementsMounted:(...R)=>Ov(...R,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Fv({mainAxis:o+j,alignmentAxis:i}),l&&Uv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Hv():void 0,...re}),l&&Wv({...re}),Gv({...re,apply:({elements:R,rects:L,availableWidth:ne,availableHeight:he})=>{const{width:Ue,height:He}=L.reference,fe=R.floating.style;fe.setProperty("--radix-popper-available-width",`${ne}px`),fe.setProperty("--radix-popper-available-height",`${he}px`),fe.setProperty("--radix-popper-anchor-width",`${Ue}px`),fe.setProperty("--radix-popper-anchor-height",`${He}px`)}}),x&&Vv({element:x,padding:a}),rw({arrowWidth:_,arrowHeight:j}),f&&qv({strategy:"referenceHidden",...re})]}),[ie,de]=vh(G),ce=qt(y);fr(()=>{se&&ce?.()},[se,ce]);const E=X.arrow?.x,P=X.arrow?.y,A=X.arrow?.centerOffset!==0,[T,O]=g.useState();return fr(()=>{w&&O(window.getComputedStyle(w).zIndex)},[w]),h.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:se?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:T,"--radix-popper-transform-origin":[X.transformOrigin?.x,X.transformOrigin?.y].join(" "),...X.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:h.jsx(Zv,{scope:r,placedSide:ie,onArrowChange:k,arrowX:E,arrowY:P,shouldHideArrow:A,children:h.jsx(we.div,{"data-side":ie,"data-align":de,...m,ref:b,style:{...m.style,animation:se?void 0:"none"}})})})});gh.displayName=qa;var mh="PopperArrow",ew={top:"bottom",right:"left",bottom:"top",left:"right"},yh=g.forwardRef(function(e,r){const{__scopePopper:n,...o}=e,s=Qv(mh,n),i=ew[s.placedSide];return h.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:h.jsx(Kv,{...o,ref:r,style:{...o.style,display:"block"}})})});yh.displayName=mh;function tw(t){return t!==null}var rw=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:o}=e,i=o.arrow?.centerOffset!==0,a=i?0:t.arrowWidth,l=i?0:t.arrowHeight,[c,u]=vh(r),d={start:"0%",center:"50%",end:"100%"}[u],f=(o.arrow?.x??0)+a/2,p=(o.arrow?.y??0)+l/2;let y="",m="";return c==="bottom"?(y=i?d:`${f}px`,m=`${-l}px`):c==="top"?(y=i?d:`${f}px`,m=`${n.floating.height+l}px`):c==="right"?(y=`${-l}px`,m=i?d:`${p}px`):c==="left"&&(y=`${n.floating.width+l}px`,m=i?d:`${p}px`),{data:{x:y,y:m}}}});function vh(t){const[e,r="center"]=t.split("-");return[e,r]}var nw=hh,wh=ph,ow=gh,sw=yh,iw="Portal",bh=g.forwardRef((t,e)=>{const{container:r,...n}=t,[o,s]=g.useState(!1);fr(()=>s(!0),[]);const i=r||o&&globalThis?.document?.body;return i?Ey.createPortal(h.jsx(we.div,{...n,ref:e}),i):null});bh.displayName=iw;function aw(t,e){return g.useReducer((r,n)=>e[r][n]??r,t)}var to=t=>{const{present:e,children:r}=t,n=lw(e),o=typeof r=="function"?r({present:n.isPresent}):g.Children.only(r),s=nt(n.ref,cw(o));return typeof r=="function"||n.isPresent?g.cloneElement(o,{ref:s}):null};to.displayName="Presence";function lw(t){const[e,r]=g.useState(),n=g.useRef({}),o=g.useRef(t),s=g.useRef("none"),i=t?"mounted":"unmounted",[a,l]=aw(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const c=vo(n.current);s.current=a==="mounted"?c:"none"},[a]),fr(()=>{const c=n.current,u=o.current;if(u!==t){const f=s.current,p=vo(c);t?l("MOUNT"):p==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,l]),fr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const m=vo(n.current).includes(p.animationName);if(p.target===e&&m&&(l("ANIMATION_END"),!o.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(s.current=vo(n.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:g.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function vo(t){return t?.animationName||"none"}function cw(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function xh({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,o]=uw({defaultProp:e,onChange:r}),s=t!==void 0,i=s?t:n,a=qt(r),l=g.useCallback(c=>{if(s){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else o(c)},[s,t,o,a]);return[i,l]}function uw({defaultProp:t,onChange:e}){const r=g.useState(t),[n]=r,o=g.useRef(n),s=qt(e);return g.useEffect(()=>{o.current!==n&&(s(n),o.current=n)},[n,o,s]),r}var dw=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Er=new WeakMap,wo=new WeakMap,bo={},Fs=0,_h=function(t){return t&&(t.host||_h(t.parentNode))},hw=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=_h(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},fw=function(t,e,r,n){var o=hw(e,Array.isArray(t)?t:[t]);bo[r]||(bo[r]=new WeakMap);var s=bo[r],i=[],a=new Set,l=new Set(o),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};o.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(n),y=p!==null&&p!=="false",m=(Er.get(f)||0)+1,v=(s.get(f)||0)+1;Er.set(f,m),s.set(f,v),i.push(f),m===1&&y&&wo.set(f,!0),v===1&&f.setAttribute(r,"true"),y||f.setAttribute(n,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return u(e),a.clear(),Fs++,function(){i.forEach(function(d){var f=Er.get(d)-1,p=s.get(d)-1;Er.set(d,f),s.set(d,p),f||(wo.has(d)||d.removeAttribute(n),wo.delete(d)),p||d.removeAttribute(r)}),Fs--,Fs||(Er=new WeakMap,Er=new WeakMap,wo=new WeakMap,bo={})}},Sh=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),o=dw(t);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live]"))),fw(n,o,r,"aria-hidden")):function(){return null}},at=function(){return at=Object.assign||function(e){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},at.apply(this,arguments)};function kh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r}function pw(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var zo="right-scroll-bar-position",No="width-before-scroll-bar",gw="with-scroll-bars-hidden",mw="--removed-body-scroll-bar-size";function Us(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function yw(t,e){var r=g.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}})[0];return r.callback=e,r.facade}var vw=typeof window<"u"?g.useLayoutEffect:g.useEffect,nc=new WeakMap;function ww(t,e){var r=yw(null,function(n){return t.forEach(function(o){return Us(o,n)})});return vw(function(){var n=nc.get(r);if(n){var o=new Set(n),s=new Set(t),i=r.current;o.forEach(function(a){s.has(a)||Us(a,null)}),s.forEach(function(a){o.has(a)||Us(a,i)})}nc.set(r,t)},[t]),r}function bw(t){return t}function xw(t,e){e===void 0&&(e=bw);var r=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(s){var i=e(s,n);return r.push(i),function(){r=r.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(a){return s(a)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var a=r;r=[],a.forEach(s),i=r}var l=function(){var u=i;i=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){i.push(u),c()},filter:function(u){return i=i.filter(u),r}}}};return o}function _w(t){t===void 0&&(t={});var e=xw(null);return e.options=at({async:!0,ssr:!1},t),e}var Ch=function(t){var e=t.sideCar,r=kh(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return g.createElement(n,at({},r))};Ch.isSideCarExport=!0;function Sw(t,e){return t.useMedium(e),Ch}var Ph=_w(),Hs=function(){},ds=g.forwardRef(function(t,e){var r=g.useRef(null),n=g.useState({onScrollCapture:Hs,onWheelCapture:Hs,onTouchMoveCapture:Hs}),o=n[0],s=n[1],i=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,f=t.sideCar,p=t.noIsolation,y=t.inert,m=t.allowPinchZoom,v=t.as,w=v===void 0?"div":v,S=t.gapMode,b=kh(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,k=ww([r,e]),C=at(at({},b),o);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:Ph,removeScrollBar:c,shards:d,noIsolation:p,inert:y,setCallbacks:s,allowPinchZoom:!!m,lockRef:r,gapMode:S}),i?g.cloneElement(g.Children.only(a),at(at({},C),{ref:k})):g.createElement(w,at({},C,{className:l,ref:k}),a))});ds.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};ds.classNames={fullWidth:No,zeroRight:zo};var kw=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Cw(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=kw();return e&&t.setAttribute("nonce",e),t}function Pw(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Ew(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Tw=function(){var t=0,e=null;return{add:function(r){t==0&&(e=Cw())&&(Pw(e,r),Ew(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Rw=function(){var t=Tw();return function(e,r){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},Eh=function(){var t=Rw(),e=function(r){var n=r.styles,o=r.dynamic;return t(n,o),null};return e},Aw={left:0,top:0,right:0,gap:0},Ws=function(t){return parseInt(t||"",10)||0},Ow=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[Ws(r),Ws(n),Ws(o)]},Iw=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Aw;var e=Ow(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},jw=Eh(),en="data-scroll-locked",$w=function(t,e,r,n){var o=t.left,s=t.top,i=t.right,a=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(gw,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(en,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zo,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(No,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(zo," .").concat(zo,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(No," .").concat(No,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(en,`] {
    `).concat(mw,": ").concat(a,`px;
  }
`)},oc=function(){var t=parseInt(document.body.getAttribute(en)||"0",10);return isFinite(t)?t:0},zw=function(){g.useEffect(function(){return document.body.setAttribute(en,(oc()+1).toString()),function(){var t=oc()-1;t<=0?document.body.removeAttribute(en):document.body.setAttribute(en,t.toString())}},[])},Nw=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,o=n===void 0?"margin":n;zw();var s=g.useMemo(function(){return Iw(o)},[o]);return g.createElement(jw,{styles:$w(s,!e,o,r?"":"!important")})},Gi=!1;if(typeof window<"u")try{var xo=Object.defineProperty({},"passive",{get:function(){return Gi=!0,!0}});window.addEventListener("test",xo,xo),window.removeEventListener("test",xo,xo)}catch{Gi=!1}var Tr=Gi?{passive:!1}:!1,Lw=function(t){return t.tagName==="TEXTAREA"},Th=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!Lw(t)&&r[e]==="visible")},Dw=function(t){return Th(t,"overflowY")},Mw=function(t){return Th(t,"overflowX")},sc=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=Rh(t,n);if(o){var s=Ah(t,n),i=s[1],a=s[2];if(i>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Bw=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Fw=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},Rh=function(t,e){return t==="v"?Dw(e):Mw(e)},Ah=function(t,e){return t==="v"?Bw(e):Fw(e)},Uw=function(t,e){return t==="h"&&e==="rtl"?-1:1},Hw=function(t,e,r,n,o){var s=Uw(t,window.getComputedStyle(e).direction),i=s*n,a=r.target,l=e.contains(a),c=!1,u=i>0,d=0,f=0;do{var p=Ah(t,a),y=p[0],m=p[1],v=p[2],w=m-v-s*y;(y||w)&&Rh(t,a)&&(d+=w,f+=y),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(f)<1)&&(c=!0),c},_o=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},ic=function(t){return[t.deltaX,t.deltaY]},ac=function(t){return t&&"current"in t?t.current:t},Ww=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Gw=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},qw=0,Rr=[];function Vw(t){var e=g.useRef([]),r=g.useRef([0,0]),n=g.useRef(),o=g.useState(qw++)[0],s=g.useState(Eh)[0],i=g.useRef(t);g.useEffect(function(){i.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var m=pw([t.lockRef.current],(t.shards||[]).map(ac),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var a=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var w=_o(m),S=r.current,b="deltaX"in m?m.deltaX:S[0]-w[0],x="deltaY"in m?m.deltaY:S[1]-w[1],k,C=m.target,_=Math.abs(b)>Math.abs(x)?"h":"v";if("touches"in m&&_==="h"&&C.type==="range")return!1;var j=sc(_,C);if(!j)return!0;if(j?k=_:(k=_==="v"?"h":"v",j=sc(_,C)),!j)return!1;if(!n.current&&"changedTouches"in m&&(b||x)&&(n.current=k),!k)return!0;var D=n.current||k;return Hw(D,v,m,D==="h"?b:x)},[]),l=g.useCallback(function(m){var v=m;if(!(!Rr.length||Rr[Rr.length-1]!==s)){var w="deltaY"in v?ic(v):_o(v),S=e.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&Ww(k.delta,w)})[0];if(S&&S.should){v.cancelable&&v.preventDefault();return}if(!S){var b=(i.current.shards||[]).map(ac).filter(Boolean).filter(function(k){return k.contains(v.target)}),x=b.length>0?a(v,b[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),c=g.useCallback(function(m,v,w,S){var b={name:m,delta:v,target:w,should:S,shadowParent:Xw(w)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(x){return x!==b})},1)},[]),u=g.useCallback(function(m){r.current=_o(m),n.current=void 0},[]),d=g.useCallback(function(m){c(m.type,ic(m),m.target,a(m,t.lockRef.current))},[]),f=g.useCallback(function(m){c(m.type,_o(m),m.target,a(m,t.lockRef.current))},[]);g.useEffect(function(){return Rr.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Tr),document.addEventListener("touchmove",l,Tr),document.addEventListener("touchstart",u,Tr),function(){Rr=Rr.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,Tr),document.removeEventListener("touchmove",l,Tr),document.removeEventListener("touchstart",u,Tr)}},[]);var p=t.removeScrollBar,y=t.inert;return g.createElement(g.Fragment,null,y?g.createElement(s,{styles:Gw(o)}):null,p?g.createElement(Nw,{gapMode:t.gapMode}):null)}function Xw(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Kw=Sw(Ph,Vw);var Va=g.forwardRef(function(t,e){return g.createElement(ds,at({},t,{ref:e,sideCar:Kw}))});Va.classNames=ds.classNames;var Xa="Popover",[Oh,oE]=$a(Xa,[uh]),ro=uh(),[Jw,Sr]=Oh(Xa),Ih=t=>{const{__scopePopover:e,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!1}=t,a=ro(e),l=g.useRef(null),[c,u]=g.useState(!1),[d=!1,f]=xh({prop:n,defaultProp:o,onChange:s});return h.jsx(nw,{...a,children:h.jsx(Jw,{scope:e,contentId:ut(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:r})})};Ih.displayName=Xa;var jh="PopoverAnchor",Yw=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr(jh,r),s=ro(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:a}=o;return g.useEffect(()=>(i(),()=>a()),[i,a]),h.jsx(wh,{...s,...n,ref:e})});Yw.displayName=jh;var $h="PopoverTrigger",zh=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr($h,r),s=ro(r),i=nt(e,o.triggerRef),a=h.jsx(we.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Mh(o.open),...n,ref:i,onClick:Be(t.onClick,o.onOpenToggle)});return o.hasCustomAnchor?a:h.jsx(wh,{asChild:!0,...s,children:a})});zh.displayName=$h;var Zw="PopoverPortal",[sE,Qw]=Oh(Zw,{forceMount:void 0}),on="PopoverContent",Nh=g.forwardRef((t,e)=>{const r=Qw(on,t.__scopePopover),{forceMount:n=r.forceMount,...o}=t,s=Sr(on,t.__scopePopover);return h.jsx(to,{present:n||s.open,children:s.modal?h.jsx(eb,{...o,ref:e}):h.jsx(tb,{...o,ref:e})})});Nh.displayName=on;var eb=g.forwardRef((t,e)=>{const r=Sr(on,t.__scopePopover),n=g.useRef(null),o=nt(e,n),s=g.useRef(!1);return g.useEffect(()=>{const i=n.current;if(i)return Sh(i)},[]),h.jsx(Va,{as,allowPinchZoom:!0,children:h.jsx(Lh,{...t,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Be(t.onCloseAutoFocus,i=>{i.preventDefault(),s.current||r.triggerRef.current?.focus()}),onPointerDownOutside:Be(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Be(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),tb=g.forwardRef((t,e)=>{const r=Sr(on,t.__scopePopover),n=g.useRef(!1),o=g.useRef(!1);return h.jsx(Lh,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{t.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{t.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),Lh=g.forwardRef((t,e)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,f=Sr(on,r),p=ro(r);return Jd(),h.jsx(La,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:h.jsx(Na,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(ow,{"data-state":Mh(f.open),role:"dialog",id:f.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Dh="PopoverClose",rb=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr(Dh,r);return h.jsx(we.button,{type:"button",...n,ref:e,onClick:Be(t.onClick,()=>o.onOpenChange(!1))})});rb.displayName=Dh;var nb="PopoverArrow",ob=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=ro(r);return h.jsx(sw,{...o,...n,ref:e})});ob.displayName=nb;function Mh(t){return t?"open":"closed"}var sb=zh;function Bh(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(r=Bh(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Fh(){for(var t,e,r=0,n="",o=arguments.length;r<o;r++)(t=arguments[r])&&(e=Bh(t))&&(n&&(n+=" "),n+=e);return n}function Ce(...t){return Wd(Fh(t))}const Uh=Ih,Hh=sb,Wh=g.forwardRef(({className:t,align:e="end",...r},n)=>h.jsx(Nh,{ref:n,align:e,className:Ce("z-popups drop-shadow-oneBlock p-0 border-shadow outline-none",t),...r,onKeyDown:o=>{o.stopPropagation()}})),Ka=({children:t,scaleFactor:e})=>{const r=dg();return h.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})};var lc=1,ib=.9,ab=.8,lb=.17,Gs=.1,qs=.999,cb=.9999,ub=.99,db=/[\\\/_+.#"@\[\(\{&]/,hb=/[\\\/_+.#"@\[\(\{&]/g,fb=/[\s-]/,Gh=/[\s-]/g;function qi(t,e,r,n,o,s,i){if(s===e.length)return o===t.length?lc:ub;var a=`${o},${s}`;if(i[a]!==void 0)return i[a];for(var l=n.charAt(s),c=r.indexOf(l,o),u=0,d,f,p,y;c>=0;)d=qi(t,e,r,n,c+1,s+1,i),d>u&&(c===o?d*=lc:db.test(t.charAt(c-1))?(d*=ab,p=t.slice(o,c-1).match(hb),p&&o>0&&(d*=Math.pow(qs,p.length))):fb.test(t.charAt(c-1))?(d*=ib,y=t.slice(o,c-1).match(Gh),y&&o>0&&(d*=Math.pow(qs,y.length))):(d*=lb,o>0&&(d*=Math.pow(qs,c-o))),t.charAt(c)!==e.charAt(s)&&(d*=cb)),(d<Gs&&r.charAt(c-1)===n.charAt(s+1)||n.charAt(s+1)===n.charAt(s)&&r.charAt(c-1)!==n.charAt(s))&&(f=qi(t,e,r,n,c+1,s+2,i),f*Gs>d&&(d=f*Gs)),d>u&&(u=d),c=r.indexOf(l,c+1);return i[a]=u,u}function cc(t){return t.toLowerCase().replace(Gh," ")}function pb(t,e,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,qi(t,e,cc(t),cc(e),0,0,{})}var Ja="Dialog",[qh,iE]=$a(Ja),[gb,ot]=qh(Ja),Vh=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!0}=t,a=g.useRef(null),l=g.useRef(null),[c=!1,u]=xh({prop:n,defaultProp:o,onChange:s});return h.jsx(gb,{scope:e,triggerRef:a,contentRef:l,contentId:ut(),titleId:ut(),descriptionId:ut(),open:c,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:r})};Vh.displayName=Ja;var Xh="DialogTrigger",mb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=ot(Xh,r),s=nt(e,o.triggerRef);return h.jsx(we.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Qa(o.open),...n,ref:s,onClick:Be(t.onClick,o.onOpenToggle)})});mb.displayName=Xh;var Ya="DialogPortal",[yb,Kh]=qh(Ya,{forceMount:void 0}),Jh=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:o}=t,s=ot(Ya,e);return h.jsx(yb,{scope:e,forceMount:r,children:g.Children.map(n,i=>h.jsx(to,{present:r||s.open,children:h.jsx(bh,{asChild:!0,container:o,children:i})}))})};Jh.displayName=Ya;var Zo="DialogOverlay",Yh=g.forwardRef((t,e)=>{const r=Kh(Zo,t.__scopeDialog),{forceMount:n=r.forceMount,...o}=t,s=ot(Zo,t.__scopeDialog);return s.modal?h.jsx(to,{present:n||s.open,children:h.jsx(vb,{...o,ref:e})}):null});Yh.displayName=Zo;var vb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=ot(Zo,r);return h.jsx(Va,{as,allowPinchZoom:!0,shards:[o.contentRef],children:h.jsx(we.div,{"data-state":Qa(o.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),gr="DialogContent",Zh=g.forwardRef((t,e)=>{const r=Kh(gr,t.__scopeDialog),{forceMount:n=r.forceMount,...o}=t,s=ot(gr,t.__scopeDialog);return h.jsx(to,{present:n||s.open,children:s.modal?h.jsx(wb,{...o,ref:e}):h.jsx(bb,{...o,ref:e})})});Zh.displayName=gr;var wb=g.forwardRef((t,e)=>{const r=ot(gr,t.__scopeDialog),n=g.useRef(null),o=nt(e,r.contentRef,n);return g.useEffect(()=>{const s=n.current;if(s)return Sh(s)},[]),h.jsx(Qh,{...t,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Be(t.onCloseAutoFocus,s=>{s.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Be(t.onPointerDownOutside,s=>{const i=s.detail.originalEvent,a=i.button===0&&i.ctrlKey===!0;(i.button===2||a)&&s.preventDefault()}),onFocusOutside:Be(t.onFocusOutside,s=>s.preventDefault())})}),bb=g.forwardRef((t,e)=>{const r=ot(gr,t.__scopeDialog),n=g.useRef(!1),o=g.useRef(!1);return h.jsx(Qh,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{t.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{t.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),Qh=g.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,...i}=t,a=ot(gr,r),l=g.useRef(null),c=nt(e,l);return Jd(),h.jsxs(h.Fragment,{children:[h.jsx(La,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:h.jsx(Na,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":Qa(a.open),...i,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(kb,{titleId:a.titleId}),h.jsx(Pb,{contentRef:l,descriptionId:a.descriptionId})]})]})}),Za="DialogTitle",xb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=ot(Za,r);return h.jsx(we.h2,{id:o.titleId,...n,ref:e})});xb.displayName=Za;var ef="DialogDescription",_b=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=ot(ef,r);return h.jsx(we.p,{id:o.descriptionId,...n,ref:e})});_b.displayName=ef;var tf="DialogClose",Sb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=ot(tf,r);return h.jsx(we.button,{type:"button",...n,ref:e,onClick:Be(t.onClick,()=>o.onOpenChange(!1))})});Sb.displayName=tf;function Qa(t){return t?"open":"closed"}var rf="DialogTitleWarning",[aE,nf]=Cy(rf,{contentName:gr,titleName:Za,docsSlug:"dialog"}),kb=({titleId:t})=>{const e=nf(rf),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Cb="DialogDescriptionWarning",Pb=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${nf(Cb).contentName}}.`;return g.useEffect(()=>{const o=t.current?.getAttribute("aria-describedby");e&&o&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},Eb=Vh,Tb=Jh,Rb=Yh,Ab=Zh,Vs={exports:{}},Xs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uc;function Ob(){if(uc)return Xs;uc=1;var t=hg();function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,o=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function a(d,f){var p=f(),y=n({inst:{value:p,getSnapshot:f}}),m=y[0].inst,v=y[1];return s(function(){m.value=p,m.getSnapshot=f,l(m)&&v({inst:m})},[d,p,f]),o(function(){return l(m)&&v({inst:m}),d(function(){l(m)&&v({inst:m})})},[d]),i(p),p}function l(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!r(d,p)}catch{return!0}}function c(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Xs.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Xs}var dc;function Ib(){return dc||(dc=1,Vs.exports=Ob()),Vs.exports}var jb=Ib(),_n='[cmdk-group=""]',Ks='[cmdk-group-items=""]',$b='[cmdk-group-heading=""]',el='[cmdk-item=""]',hc=`${el}:not([aria-disabled="true"])`,Vi="cmdk-item-select",or="data-value",zb=(t,e,r)=>pb(t,e,r),of=g.createContext(void 0),no=()=>g.useContext(of),sf=g.createContext(void 0),tl=()=>g.useContext(sf),af=g.createContext(void 0),lf=g.forwardRef((t,e)=>{let r=Hr(()=>{var E,P;return{search:"",value:(P=(E=t.value)!=null?E:t.defaultValue)!=null?P:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=Hr(()=>new Set),o=Hr(()=>new Map),s=Hr(()=>new Map),i=Hr(()=>new Set),a=cf(t),{label:l,children:c,value:u,onValueChange:d,filter:f,shouldFilter:p,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...w}=t,S=ut(),b=ut(),x=ut(),k=g.useRef(null),C=qb();mr(()=>{if(u!==void 0){let E=u.trim();r.current.value=E,_.emit()}},[u]),mr(()=>{C(6,re)},[]);let _=g.useMemo(()=>({subscribe:E=>(i.current.add(E),()=>i.current.delete(E)),snapshot:()=>r.current,setState:(E,P,A)=>{var T,O,R;if(!Object.is(r.current[E],P)){if(r.current[E]=P,E==="search")I(),N(),C(1,W);else if(E==="value"&&(A||C(5,re),((T=a.current)==null?void 0:T.value)!==void 0)){let L=P??"";(R=(O=a.current).onValueChange)==null||R.call(O,L);return}_.emit()}},emit:()=>{i.current.forEach(E=>E())}}),[]),j=g.useMemo(()=>({value:(E,P,A)=>{var T;P!==((T=s.current.get(E))==null?void 0:T.value)&&(s.current.set(E,{value:P,keywords:A}),r.current.filtered.items.set(E,D(P,A)),C(2,()=>{N(),_.emit()}))},item:(E,P)=>(n.current.add(E),P&&(o.current.has(P)?o.current.get(P).add(E):o.current.set(P,new Set([E]))),C(3,()=>{I(),N(),r.current.value||W(),_.emit()}),()=>{s.current.delete(E),n.current.delete(E),r.current.filtered.items.delete(E);let A=M();C(4,()=>{I(),A?.getAttribute("id")===E&&W(),_.emit()})}),group:E=>(o.current.has(E)||o.current.set(E,new Set),()=>{s.current.delete(E),o.current.delete(E)}),filter:()=>a.current.shouldFilter,label:l||t["aria-label"],getDisablePointerSelection:()=>a.current.disablePointerSelection,listId:S,inputId:x,labelId:b,listInnerRef:k}),[]);function D(E,P){var A,T;let O=(T=(A=a.current)==null?void 0:A.filter)!=null?T:zb;return E?O(E,r.current.search,P):0}function N(){if(!r.current.search||a.current.shouldFilter===!1)return;let E=r.current.filtered.items,P=[];r.current.filtered.groups.forEach(T=>{let O=o.current.get(T),R=0;O.forEach(L=>{let ne=E.get(L);R=Math.max(ne,R)}),P.push([T,R])});let A=k.current;K().sort((T,O)=>{var R,L;let ne=T.getAttribute("id"),he=O.getAttribute("id");return((R=E.get(he))!=null?R:0)-((L=E.get(ne))!=null?L:0)}).forEach(T=>{let O=T.closest(Ks);O?O.appendChild(T.parentElement===O?T:T.closest(`${Ks} > *`)):A.appendChild(T.parentElement===A?T:T.closest(`${Ks} > *`))}),P.sort((T,O)=>O[1]-T[1]).forEach(T=>{var O;let R=(O=k.current)==null?void 0:O.querySelector(`${_n}[${or}="${encodeURIComponent(T[0])}"]`);R?.parentElement.appendChild(R)})}function W(){let E=K().find(A=>A.getAttribute("aria-disabled")!=="true"),P=E?.getAttribute(or);_.setState("value",P||void 0)}function I(){var E,P,A,T;if(!r.current.search||a.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let O=0;for(let R of n.current){let L=(P=(E=s.current.get(R))==null?void 0:E.value)!=null?P:"",ne=(T=(A=s.current.get(R))==null?void 0:A.keywords)!=null?T:[],he=D(L,ne);r.current.filtered.items.set(R,he),he>0&&O++}for(let[R,L]of o.current)for(let ne of L)if(r.current.filtered.items.get(ne)>0){r.current.filtered.groups.add(R);break}r.current.filtered.count=O}function re(){var E,P,A;let T=M();T&&(((E=T.parentElement)==null?void 0:E.firstChild)===T&&((A=(P=T.closest(_n))==null?void 0:P.querySelector($b))==null||A.scrollIntoView({block:"nearest"})),T.scrollIntoView({block:"nearest"}))}function M(){var E;return(E=k.current)==null?void 0:E.querySelector(`${el}[aria-selected="true"]`)}function K(){var E;return Array.from(((E=k.current)==null?void 0:E.querySelectorAll(hc))||[])}function G(E){let P=K()[E];P&&_.setState("value",P.getAttribute(or))}function se(E){var P;let A=M(),T=K(),O=T.findIndex(L=>L===A),R=T[O+E];(P=a.current)!=null&&P.loop&&(R=O+E<0?T[T.length-1]:O+E===T.length?T[0]:T[O+E]),R&&_.setState("value",R.getAttribute(or))}function X(E){let P=M(),A=P?.closest(_n),T;for(;A&&!T;)A=E>0?Wb(A,_n):Gb(A,_n),T=A?.querySelector(hc);T?_.setState("value",T.getAttribute(or)):se(E)}let ie=()=>G(K().length-1),de=E=>{E.preventDefault(),E.metaKey?ie():E.altKey?X(1):se(1)},ce=E=>{E.preventDefault(),E.metaKey?G(0):E.altKey?X(-1):se(-1)};return g.createElement(we.div,{ref:e,tabIndex:-1,...w,"cmdk-root":"",onKeyDown:E=>{var P;if((P=w.onKeyDown)==null||P.call(w,E),!E.defaultPrevented)switch(E.key){case"n":case"j":{v&&E.ctrlKey&&de(E);break}case"ArrowDown":{de(E);break}case"p":case"k":{v&&E.ctrlKey&&ce(E);break}case"ArrowUp":{ce(E);break}case"Home":{E.preventDefault(),G(0);break}case"End":{E.preventDefault(),ie();break}case"Enter":if(!E.nativeEvent.isComposing&&E.keyCode!==229){E.preventDefault();let A=M();if(A){let T=new Event(Vi);A.dispatchEvent(T)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:j.inputId,id:j.labelId,style:Xb},l),hs(t,E=>g.createElement(sf.Provider,{value:_},g.createElement(of.Provider,{value:j},E))))}),Nb=g.forwardRef((t,e)=>{var r,n;let o=ut(),s=g.useRef(null),i=g.useContext(af),a=no(),l=cf(t),c=(n=(r=l.current)==null?void 0:r.forceMount)!=null?n:i?.forceMount;mr(()=>{if(!c)return a.item(o,i?.id)},[c]);let u=uf(o,s,[t.value,t.children,s],t.keywords),d=tl(),f=yr(C=>C.value&&C.value===u.current),p=yr(C=>c||a.filter()===!1?!0:C.search?C.filtered.items.get(o)>0:!0);g.useEffect(()=>{let C=s.current;if(!(!C||t.disabled))return C.addEventListener(Vi,y),()=>C.removeEventListener(Vi,y)},[p,t.onSelect,t.disabled]);function y(){var C,_;m(),(_=(C=l.current).onSelect)==null||_.call(C,u.current)}function m(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:w,onSelect:S,forceMount:b,keywords:x,...k}=t;return g.createElement(we.div,{ref:qn([s,e]),...k,id:o,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||a.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},t.children)}),Lb=g.forwardRef((t,e)=>{let{heading:r,children:n,forceMount:o,...s}=t,i=ut(),a=g.useRef(null),l=g.useRef(null),c=ut(),u=no(),d=yr(p=>o||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);mr(()=>u.group(i),[]),uf(i,a,[t.value,t.heading,l]);let f=g.useMemo(()=>({id:i,forceMount:o}),[o]);return g.createElement(we.div,{ref:qn([a,e]),...s,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},r&&g.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),hs(t,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},g.createElement(af.Provider,{value:f},p))))}),Db=g.forwardRef((t,e)=>{let{alwaysRender:r,...n}=t,o=g.useRef(null),s=yr(i=>!i.search);return!r&&!s?null:g.createElement(we.div,{ref:qn([o,e]),...n,"cmdk-separator":"",role:"separator"})}),Mb=g.forwardRef((t,e)=>{let{onValueChange:r,...n}=t,o=t.value!=null,s=tl(),i=yr(u=>u.search),a=yr(u=>u.value),l=no(),c=g.useMemo(()=>{var u;let d=(u=l.listInnerRef.current)==null?void 0:u.querySelector(`${el}[${or}="${encodeURIComponent(a)}"]`);return d?.getAttribute("id")},[]);return g.useEffect(()=>{t.value!=null&&s.setState("search",t.value)},[t.value]),g.createElement(we.input,{ref:e,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":c,id:l.inputId,type:"text",value:o?t.value:i,onChange:u=>{o||s.setState("search",u.target.value),r?.(u.target.value)}})}),Bb=g.forwardRef((t,e)=>{let{children:r,label:n="Suggestions",...o}=t,s=g.useRef(null),i=g.useRef(null),a=no();return g.useEffect(()=>{if(i.current&&s.current){let l=i.current,c=s.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=l.offsetHeight;c.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(l),()=>{cancelAnimationFrame(u),d.unobserve(l)}}},[]),g.createElement(we.div,{ref:qn([s,e]),...o,"cmdk-list":"",role:"listbox","aria-label":n,id:a.listId},hs(t,l=>g.createElement("div",{ref:qn([i,a.listInnerRef]),"cmdk-list-sizer":""},l)))}),Fb=g.forwardRef((t,e)=>{let{open:r,onOpenChange:n,overlayClassName:o,contentClassName:s,container:i,...a}=t;return g.createElement(Eb,{open:r,onOpenChange:n},g.createElement(Tb,{container:i},g.createElement(Rb,{"cmdk-overlay":"",className:o}),g.createElement(Ab,{"aria-label":t.label,"cmdk-dialog":"",className:s},g.createElement(lf,{ref:e,...a}))))}),Ub=g.forwardRef((t,e)=>yr(r=>r.filtered.count===0)?g.createElement(we.div,{ref:e,...t,"cmdk-empty":"",role:"presentation"}):null),Hb=g.forwardRef((t,e)=>{let{progress:r,children:n,label:o="Loading...",...s}=t;return g.createElement(we.div,{ref:e,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},hs(t,i=>g.createElement("div",{"aria-hidden":!0},i)))}),Le=Object.assign(lf,{List:Bb,Item:Nb,Input:Mb,Group:Lb,Separator:Db,Dialog:Fb,Empty:Ub,Loading:Hb});function Wb(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return r;r=r.nextElementSibling}}function Gb(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return r;r=r.previousElementSibling}}function cf(t){let e=g.useRef(t);return mr(()=>{e.current=t}),e}var mr=typeof window>"u"?g.useEffect:g.useLayoutEffect;function Hr(t){let e=g.useRef();return e.current===void 0&&(e.current=t()),e}function qn(t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}function yr(t){let e=tl(),r=()=>t(e.snapshot());return jb.useSyncExternalStore(e.subscribe,r,r)}function uf(t,e,r,n=[]){let o=g.useRef(),s=no();return mr(()=>{var i;let a=(()=>{var c;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():o.current}})(),l=n.map(c=>c.trim());s.value(t,a,l),(i=e.current)==null||i.setAttribute(or,a),o.current=a}),o}var qb=()=>{let[t,e]=g.useState(),r=Hr(()=>new Map);return mr(()=>{r.current.forEach(n=>n()),r.current=new Map},[t]),(n,o)=>{r.current.set(n,o),e({})}};function Vb(t){let e=t.type;return typeof e=="function"?e(t.props):"render"in e?e.render(t.props):t}function hs({asChild:t,children:e},r){return t&&g.isValidElement(e)?g.cloneElement(Vb(e),{ref:e.ref},r(e.props.children)):r(e)}var Xb={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const df=g.forwardRef(({className:t,...e},r)=>h.jsx(Le,{ref:r,className:Ce("flex h-full w-full flex-col overflow-hidden bg-metallicBlue text-popover-foreground",t),...e}));df.displayName=Le.displayName;const hf=g.forwardRef(({className:t,...e},r)=>h.jsxs("div",{className:"flex items-center border-b px-1 pb-1","cmdk-input-wrapper":"",children:[h.jsx("span",{className:"sprite mr-1 texture-hud_char_gt"}),h.jsx(Le.Input,{ref:r,className:Ce("flex h-1 w-full bg-pastelBlue py-1 outline-none placeholder:text-shadow disabled:cursor-not-allowed",t),...e})]}));hf.displayName=Le.Input.displayName;const ff=g.forwardRef(({className:t,...e},r)=>h.jsx(Le.List,{ref:r,className:Ce("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...e}));ff.displayName=Le.List.displayName;const pf=g.forwardRef((t,e)=>h.jsx(Le.Empty,{ref:e,className:"pl-1",...t}));pf.displayName=Le.Empty.displayName;const gf=g.forwardRef(({className:t,...e},r)=>h.jsx(Le.Group,{ref:r,className:Ce("overflow-hidden",t),...e}));gf.displayName=Le.Group.displayName;const Kb=g.forwardRef(({className:t,...e},r)=>h.jsx(Le.Separator,{ref:r,className:Ce("-mx-1 h-px bg-shadow",t),...e}));Kb.displayName=Le.Separator.displayName;const fs=g.forwardRef(({className:t,...e},r)=>h.jsx(Le.Item,{ref:r,className:Ce("relative flex cursor-default select-none items-center text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-midRed hover:bg-pastelBlue data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...e}));fs.displayName=Le.Item.displayName;const St=g.forwardRef(({className:t,selected:e,...r},n)=>h.jsx("button",{"data-selected":e,className:Ce(`inline-flex items-center justify-center whitespace-nowrap 
          bg-metallicBlue zx:bg-zxBlue border-none border-shadow
          gap-2
           disabled:bg-midGrey disabled:text-lightGrey 
           data-[selected=true]:bg-lightBeige
           [&:not(:disabled):hover:not([data-selected=true])]:bg-pastelBlue 
           `,t),ref:n,...r}));St.displayName="Button";var fc=!1,sr,Xi,Ki,Lo,Do,mf,Mo,Ji,Yi,Zi,yf,Qi,ea,vf,wf;function Ie(){if(!fc){fc=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),r=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(Qi=/\b(iPhone|iP[ao]d)/.exec(t),ea=/\b(iP[ao]d)/.exec(t),Zi=/Android/i.exec(t),vf=/FBAN\/\w+;/i.exec(t),wf=/Mobile/i.exec(t),yf=!!/Win64/.exec(t),e){sr=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN,sr&&document&&document.documentMode&&(sr=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);mf=n?parseFloat(n[1])+4:sr,Xi=e[2]?parseFloat(e[2]):NaN,Ki=e[3]?parseFloat(e[3]):NaN,Lo=e[4]?parseFloat(e[4]):NaN,Lo?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),Do=e&&e[1]?parseFloat(e[1]):NaN):Do=NaN}else sr=Xi=Ki=Do=Lo=NaN;if(r){if(r[1]){var o=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);Mo=o?parseFloat(o[1].replace("_",".")):!0}else Mo=!1;Ji=!!r[2],Yi=!!r[3]}else Mo=Ji=Yi=!1}}var ta={ie:function(){return Ie()||sr},ieCompatibilityMode:function(){return Ie()||mf>sr},ie64:function(){return ta.ie()&&yf},firefox:function(){return Ie()||Xi},opera:function(){return Ie()||Ki},webkit:function(){return Ie()||Lo},safari:function(){return ta.webkit()},chrome:function(){return Ie()||Do},windows:function(){return Ie()||Ji},osx:function(){return Ie()||Mo},linux:function(){return Ie()||Yi},iphone:function(){return Ie()||Qi},mobile:function(){return Ie()||Qi||ea||Zi||wf},nativeApp:function(){return Ie()||vf},android:function(){return Ie()||Zi},ipad:function(){return Ie()||ea}},Jb=ta,Yb=!!(typeof window<"u"&&window.document&&window.document.createElement),Zb={canUseDOM:Yb},bf=Zb,xf;bf.canUseDOM&&(xf=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Qb(t,e){if(!bf.canUseDOM||e&&!("addEventListener"in document))return!1;var r="on"+t,n=r in document;if(!n){var o=document.createElement("div");o.setAttribute(r,"return;"),n=typeof o[r]=="function"}return!n&&xf&&t==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var ex=Qb,pc=10,gc=40,mc=800;function _f(t){var e=0,r=0,n=0,o=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*pc,o=r*pc,"deltaY"in t&&(o=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||o)&&t.deltaMode&&(t.deltaMode==1?(n*=gc,o*=gc):(n*=mc,o*=mc)),n&&!e&&(e=n<1?-1:1),o&&!r&&(r=o<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:o}}_f.getEventType=function(){return Jb.firefox()?"DOMMouseScroll":ex("wheel")?"wheel":"mousewheel"};var tx=_f;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const rx=(t,e,r=!1)=>{const n=g.useRef(0),o=g.useCallback(s=>{if(r)return;const i=s;i.preventDefault(),i.stopPropagation();const a=tx(i);n.current-=a.spinY,n.current>=1&&(e(1),n.current=0),n.current<=-1&&(e(-1),n.current=0)},[e,r]);g.useEffect(()=>{const s=t.current;if(s!==null)return s.addEventListener("wheel",o,{passive:!1}),()=>{s.removeEventListener("wheel",o)}},[t,o])},Sf=(t,e,r,n=!1)=>{const o=g.useRef(0);return rx(t,s=>{if(e.length===0)return;const i=(o.current+s+256*e.length)%e.length;o.current=i,r(e[i],i)},n)},nx=({value:t,onSelect:e})=>h.jsx(fs,{value:t,onSelect:e,className:"px-1",children:h.jsx(Q,{children:t})}),ps=t=>{const{values:e,onSelect:r,triggerButtonClassName:n="",triggerButtonStyle:o=ue,triggerButtonLabel:s="",OptionCommandItem:i=nx}=t,[a,l]=g.useState(!1),c=g.useRef(null);return Sf(c,e,u=>{r(u)},!a),h.jsxs(Uh,{open:a,onOpenChange:l,children:[h.jsx(Hh,{asChild:!0,children:h.jsxs(St,{className:Ce("h-2 px-1 flex flex-row gap-1 justify-start leading-none",n),style:o,ref:c,children:[typeof s=="string"?h.jsx(Q,{className:"grow overflow-hidden text-left",children:s}):s,h.jsx(Q,{className:"grow-0",children:a?"X":""})]})}),h.jsx(Wh,{className:"p-0",children:h.jsx(Ka,{scaleFactor:2,children:h.jsxs(df,{className:"w-[--radix-popper-anchor-width]",children:[t.disableCommandInput===!0?null:h.jsx(hf,{placeholder:t.placeholder}),h.jsxs(ff,{children:[h.jsx(pf,{children:h.jsx(Q,{children:"Nothing found"})}),h.jsx(gf,{children:e.map(u=>h.jsx(i,{value:u,onSelect:d=>{l(!1),r(d)}},u))})]})]})})})]})},ox=()=>{const t=pt(),e=td();return h.jsx(h.Fragment,{children:h.jsx(ps,{value:e,values:fg,onSelect:r=>{t(pg(r))},disableCommandInput:!0,triggerButtonLabel:e,triggerButtonClassName:"w-13"})})};function kf({campaign:t,onSelect:e,headRoomId:r,heelsRoomId:n,value:o,triggerButtonClassName:s,excludeRoomIds:i=[]}){const a=Object.keys(t.rooms).filter(l=>!i.includes(l));return h.jsx(ps,{onSelect:l=>e?.(l),value:o,values:a,triggerButtonClassName:s,placeholder:"search",disableCommandInput:!1,triggerButtonLabel:o??"none",OptionCommandItem:({value:l,onSelect:c})=>h.jsxs(fs,{value:l,onSelect:c,className:"px-1",children:[r===l&&h.jsx("span",{className:"sprite mr-1 my-1 texture-head_walking_towards_2"}),n===l&&h.jsx("span",{className:"sprite mr-1 my-1 texture-heels_walking_towards_2"}),h.jsx(Q,{children:l})]})})}const me=t=>t,ra="h-[calc(3*var(--block)-1px*var(--scale))] w-[calc(3*var(--block)-1px*var(--scale))]",q=me("[button:not([data-selected=true]):not(:hover)_&]:sprite-revert-to-two-tone-dim"),Pe=me("flex flex-wrap gap-oneScaledPix w-full"),rt=({className:t,onClick:e,children:r,disabled:n=!1,isCurrentTool:o=!1})=>h.jsx(St,{disabled:n,selected:o,className:`
        ${ra} 
        active:pt-oneScaledPix  gap-0 inline-flex overflow-hidden 
        
        ${t??""}`,onClick:e,children:r}),sx=()=>{const t=be(e=>e.levelEditor.selectedJsonItemIds.length>0);return h.jsx(rt,{className:"bg-midRed",disabled:!t,onClick:()=>B.dispatch(hd()),children:h.jsx("span",{className:"sprite sprite-tinted texture-hud_char_X relative"})})},rl=({className:t,value:e,onClick:r,trueLabel:n="ON",falseLabel:o="OFF",label:s})=>{const i=Math.max(n.length,o.length)+1,a=n.padStart(i," "),l=o.padEnd(i," ");return h.jsxs("span",{onClick:c=>r?.(c,!e),className:Ce("inline-flex justify-between",t),children:[s&&h.jsx(Q,{className:"inline-block mr-1 text-lightGrey",noSlitWords:!0,children:s}),h.jsx(Q,{className:Fh("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?a:l})]})},ix=({className:t})=>{const e=pt();return h.jsx(rl,{className:t,label:"snap",value:be(r=>r.levelEditor.halfGridResolution),onClick:(r,n)=>{e(qg(n))},falseLabel:"Block",trueLabel:"Half"})},$=({itemTool:t,children:e,className:r})=>{const n=be(lr),o=Ge(n?.type==="item"&&n.item,t);return h.jsx(rt,{isCurrentTool:o,className:r,onClick:()=>B.dispatch(Gt({type:"item",item:t})),children:e})},Sn=({children:t})=>{const[e,r]=g.useState(!1),[n,o]=g.useState(0),s=g.useRef(null);Sf(s,t,(a,l)=>{o(l)});const i=t[n];return h.jsxs(Uh,{open:e,onOpenChange:r,children:[h.jsx("div",{className:Ce(ra,"relative",{"drop-shadow-oneBlock z-popups":e}),children:h.jsxs("span",{className:"content",ref:s,children:[i,h.jsx(Hh,{asChild:!0,children:h.jsx(St,{className:"absolute bottom-0 right-0 bg-metallicBlueHalfbrite",children:h.jsx(Q,{className:"pl-oneScaledPix",children:e?"X":""})})})]})}),h.jsx(Wh,{children:h.jsx(Ka,{scaleFactor:2,children:h.jsx("div",{className:"flex flex-col gap-oneScaledPix py-oneScaledPix bg-metallicBlueHalfbrite",children:t.map((a,l)=>l===n?null:h.jsx("div",{className:ra,onClick:()=>{o(l),r(!1)},children:a},l))})})})]})},ax=()=>{const e=be(lr)?.type==="pointer";return h.jsx(rt,{onClick:()=>B.dispatch(Gt({type:"pointer"})),isCurrentTool:e,children:h.jsx("span",{className:"sprite texture-editor_tool_pointer relative"})})},z={pureBlack:new V("#000000"),shadow:new V("#325149"),midGrey:new V("#7F7773"),lightGrey:new V("#BBB1AB"),white:new V("#FBFEFB"),pastelBlue:new V("#75ACFF"),metallicBlue:new V("#366CAA"),pink:new V("#D68ED1"),moss:new V("#9E9600"),redShadow:new V("#805E50"),midRed:new V("#CA7463"),lightBeige:new V("#DAA78F"),highlightBeige:new V("#EBC690"),alpha:new V("#1E7790"),replaceLight:new V("#08A086"),replaceDark:new V("#0A4730")},zn=.33,Cf=t=>{const[e,r,n]=t.toUint8RgbArray();return new V({r:e*.75,g:r*.75,b:n*.75})},sn=(t,e=zn)=>{const[r,n,o]=t.toUint8RgbArray();return new V({r:r*e,g:n*e,b:o*e})};function lE(t){t=t.replace(/^#/,"");let e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);e=Math.floor(e*zn),r=Math.floor(r*zn),n=Math.floor(n*zn);const o=s=>s.toString(16).padStart(2,"0");return`#${o(e)}${o(r)}${o(n)}`}const Xe={original:new V(dn.zxWhite),basic:z.white,dimmed:z.lightGrey},Ke={original:new V(dn.zxYellow),basic:new V(15654246),dimmed:sn(new V(15654246),.5)},Pf={original:new V(dn.zxYellow),basic:z.midRed,dimmed:z.redShadow},st={original:new V(dn.zxMagenta),basic:z.pink,dimmed:sn(z.pink,.5)},xe={original:new V(dn.zxCyan),basic:z.pastelBlue,dimmed:sn(z.pastelBlue,.5)},it={original:new V(dn.zxGreen),basic:z.moss,dimmed:sn(z.moss,.5)},gs={white:{basic:{main:Xe,edges:{towards:{...xe,dimInOriginal:!1},right:{...Ke,dimInOriginal:!0}},hud:{lives:Ke,dimmed:st,icons:xe}},dimmed:{main:Xe,edges:{towards:{...it,dimInOriginal:!1},right:{...xe,dimInOriginal:!0}},hud:{lives:Pf,dimmed:st,icons:xe}}},yellow:{basic:{main:Ke,edges:{towards:{...it,dimInOriginal:!1},right:{...Xe,dimInOriginal:!0}},hud:{lives:xe,dimmed:st,icons:it}},dimmed:{main:Ke,edges:{towards:{...xe,dimInOriginal:!0},right:{...xe,dimInOriginal:!1}},hud:{lives:xe,dimmed:st,icons:it}}},magenta:{basic:{main:st,edges:{towards:{...it,dimInOriginal:!0},right:{...xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:xe,icons:Ke}},dimmed:{main:st,edges:{towards:{...it,dimInOriginal:!0},right:{...xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:xe,icons:Ke}}},cyan:{basic:{main:xe,edges:{towards:{...st,dimInOriginal:!1},right:{...Xe,dimInOriginal:!1}},hud:{lives:Xe,dimmed:it,icons:Ke}},dimmed:{main:xe,edges:{towards:{...st,dimInOriginal:!0},right:{...Xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:it,icons:Ke}}},green:{basic:{main:it,edges:{towards:{...xe,dimInOriginal:!1},right:{...Ke,dimInOriginal:!1}},hud:{lives:Xe,dimmed:st,icons:xe}},dimmed:{main:it,edges:{towards:{...xe,dimInOriginal:!0},right:{...Ke,dimInOriginal:!0}},hud:{lives:Xe,dimmed:st,icons:xe}}}},Qo=t=>gs[t.hue][t.shade],Kr={head:z.pastelBlue,heels:z.pink},yc=t=>{const{main:e}=gs[t].basic;return{backgroundColor:e.basic.toHex(),borderColor:e.dimmed.toHex()}};function lx(){const t=pt(),e=be(Vg);return h.jsxs(h.Fragment,{children:[h.jsx(ps,{value:e.hue,onSelect:r=>{t(_l({hue:r}))},values:gg,disableCommandInput:!0,OptionCommandItem:({value:r,onSelect:n})=>h.jsx(fs,{value:r,className:"border-l-3 h-2 w-full p-0",style:yc(r),onSelect:n}),triggerButtonLabel:"colour",triggerButtonClassName:Ce("w-full",`${e.hue==="white"||e.hue==="yellow"?"text-pureBlack":"text-white"}`),triggerButtonStyle:yc(e.hue)}),h.jsx(rl,{className:"w-full",label:"shade",value:e.shade==="basic",onClick:(r,n)=>{t(_l({shade:n?"basic":"dimmed"}))},falseLabel:"dim",trueLabel:"basic"})]})}function cx(){const t=pt(),e=be(Xg);return h.jsx(ps,{value:e,onSelect:r=>{t(Kg(r))},values:mg,disableCommandInput:!0,triggerButtonClassName:"w-full",triggerButtonLabel:e})}const It=({iconClasses:t,text:e})=>h.jsxs("div",{className:"relative w-full h-full",children:[h.jsx("span",{className:`sprite absolute top-0 left-0 ${t} ${q}`}),h.jsx(Q,{className:"bg-metallicBlueHalfbrite absolute top-0 right-0 pl-oneScaledPix block",children:e})]}),So=({iconClassName:t})=>h.jsx(vt,{topClasses:me("texture-bubbles_white_2 [button:hover_&]:texture-animated-bubbles_white"),bottomClasses:t}),vt=({topClasses:t,bottomClasses:e="texture-headlessBase"})=>h.jsxs("div",{className:"relative w-full h-full",children:[h.jsx("span",{className:`sprite absolute top-[calc(9px*var(--scale))] left-0 ${e} ${q}`}),h.jsx("span",{className:`sprite absolute top-[calc(-3px*var(--scale))] left-0 ${t} ${q}`})]}),ux="[button:not(:disabled):hover_&]:hidden",dx="hidden [button:not(:disabled):hover_&]:inline mt-quarter",hx="hidden [button:not(:disabled):hover_&]:inline",Vn=({icon:t,topText:e,bottomText:r})=>h.jsxs("span",{className:"w-full h-full flex flex-col items-center justify-center",children:[h.jsx("span",{className:ux,children:t}),h.jsx(Q,{className:dx,children:e}),h.jsx(Q,{className:hx,children:r})]}),fx=()=>{const t=pt(),e=be(Jg),r=be(Yg);return h.jsxs("div",{className:"flex flex-row gap-oneScaledPix bg-metallicBlue",children:[h.jsx(rt,{disabled:!e,onClick:()=>{t(fd())},children:h.jsx(Vn,{icon:h.jsx(Q,{children:""}),topText:"un",bottomText:"do"})}),h.jsx(rt,{disabled:!r,onClick:()=>{t(pd())},children:h.jsx(Vn,{icon:h.jsx(Q,{children:""}),topText:"re",bottomText:"do"})})]})},px=({className:t})=>{const e=pt();return h.jsx(rl,{className:t,label:"scenery",value:be(r=>r.levelEditor.wallsFloorsLocked),onClick:(r,n)=>{e(Zg(n))},falseLabel:"edit",trueLabel:"lock"})},gx=()=>{const t=be(r=>rn(r).planet),e=me(t==="moonbase"?"texture-door_frame_moonbase_x_whole":"texture-door_frame_generic_x_whole");return h.jsx($,{itemTool:{type:"door",config:{direction:"away",toRoom:"(placeholder)"}},children:h.jsx("span",{className:`sprite ${e} ${q}`})})},mx=()=>{const t=be(n=>rn(n).planet),e={type:"wall",config:{direction:"away",tiles:Array.from(Qg(t,1))}},r=me(t==="blacktooth"?"texture-blacktooth_wall_plain_away":t==="bookworld"?"texture-bookworld_wall_cowboy_away":t==="jail"?"texture-jail_wall_bars_away":t==="egyptus"?"texture-egyptus_wall_hieroglyphics_away":t==="market"?"texture-market_wall_passage_away":t==="moonbase"?"texture-moonbase_wall_window1_away":t==="penitentiary"?"texture-penitentiary_wall_loop_away":"texture-safari_wall_wall_away");return h.jsx($,{itemTool:e,children:h.jsx("span",{className:`sprite ${r} ${q}`})})},yx=()=>h.jsx(rt,{className:"bg-midRed",onClick:()=>B.dispatch(em()),children:h.jsx(Q,{className:"relative leading-none",children:"CLR"})}),Ef=({currentRoomId:t,direction:e})=>{const r=be(({levelEditor:s})=>s.campaignInProgress),n=be(({levelEditor:s})=>s.currentlyEditingRoomId),o=pt();return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex flex-row gap-oneScaledPix w-full flex-wrap pt-1",children:[h.jsxs(Q,{className:"text-lightGrey leading-none",children:["Room ",e==="roomAbove"?"":""]}),h.jsx("div",{className:"flex-grow"}),h.jsxs("div",{className:"flex flex-row gap-oneScaledPix",children:[h.jsx(St,{className:"w-2 leading-none bg-moss",children:h.jsx(Q,{onClick:()=>o(Rs({direction:e,createNew:!0})),children:"+"})}),h.jsx(St,{className:"w-2 leading-none bg-midRed",children:h.jsx(Q,{onClick:()=>o(Rs({direction:e,createNew:!1,roomId:void 0})),children:"x"})})]})]}),h.jsx("div",{className:"flex flex-row gap-oneScaledPix w-full flex-wrap",children:h.jsx(kf,{value:t,campaign:r,excludeRoomIds:[n],triggerButtonClassName:"w-full",onSelect:s=>{o(Rs({direction:e,createNew:!1,roomId:s}))}})})]})},vx=()=>{const t=be(({levelEditor:e})=>gd(e).roomAbove);return h.jsx(h.Fragment,{children:h.jsx(Ef,{currentRoomId:t,direction:"roomAbove"})})},wx=()=>{const t=be(({levelEditor:e})=>gd(e).roomBelow);return h.jsx(h.Fragment,{children:h.jsx(Ef,{currentRoomId:t,direction:"roomBelow"})})},bx=()=>{const t=be(({levelEditor:e})=>e.tool.type==="eyeDropper");return h.jsx(rt,{isCurrentTool:t,onClick:()=>B.dispatch(Gt({type:"eyeDropper"})),children:h.jsx("span",{className:"relative sprite texture-editor_tool_eyedropper leading-none"})})},ms=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const xx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",En=Array.prototype.slice.call(xx),ko=(t=>{let e={};return t.forEach((r,n)=>e[r]=n),e})(En),_x=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Bo=String.fromCharCode.bind(String),vc=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Sx=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Tf=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),kx=t=>{let e,r,n,o,s="";const i=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|o,s+=En[e>>18&63]+En[e>>12&63]+En[e>>6&63]+En[e&63]}return i?s.slice(0,i-3)+"===".substring(i):s},Cx=typeof btoa=="function"?t=>btoa(t):ms?t=>Buffer.from(t,"binary").toString("base64"):kx,wc=ms?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let n=0,o=t.length;n<o;n+=4096)r.push(Bo.apply(null,t.subarray(n,n+4096)));return Cx(r.join(""))},Px=(t,e=!1)=>e?Sx(wc(t)):wc(t),Ex=t=>{if(t=t.replace(/\s+/g,""),!_x.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",n,o;for(let s=0;s<t.length;)e=ko[t.charAt(s++)]<<18|ko[t.charAt(s++)]<<12|(n=ko[t.charAt(s++)])<<6|(o=ko[t.charAt(s++)]),r+=n===64?Bo(e>>16&255):o===64?Bo(e>>16&255,e>>8&255):Bo(e>>16&255,e>>8&255,e&255);return r},Tx=typeof atob=="function"?t=>atob(Tf(t)):ms?t=>Buffer.from(t,"base64").toString("binary"):Ex,Rx=ms?t=>vc(Buffer.from(t,"base64")):t=>vc(Tx(t).split("").map(e=>e.charCodeAt(0))),Ax=t=>Rx(Ox(t)),Ox=t=>Tf(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Ix=!0,Rf=async t=>{const e=JSON.stringify(t),n=new TextEncoder().encode(e),o=new Blob([n]),s=new CompressionStream(Af),i=o.stream().pipeThrough(s),a=await new Response(i).arrayBuffer(),l=new Uint8Array(a);return Px(l,Ix)},jx=async t=>{try{const e=Ax(t),r=new Blob([e]),n=new DecompressionStream(Af),o=r.stream().pipeThrough(n),s=await new Response(o).text();return JSON.parse(s)}catch(e){throw new Error("error decompressing object",{cause:e})}},Af="gzip",$x=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class nl extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class zx extends nl{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class bc extends nl{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xc extends nl{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var na;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(na||(na={}));var Nx=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class Lx{constructor(e,{headers:r={},customFetch:n,region:o=na.Any}={}){this.url=e,this.headers=r,this.region=o,this.fetch=$x(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return Nx(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(a["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(a["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),o),body:u}).catch(m=>{throw new zx(m)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new bc(d);if(!d.ok)throw new xc(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return p==="application/json"?y=yield d.json():p==="application/octet-stream"?y=yield d.blob():p==="text/event-stream"?y=d:p==="multipart/form-data"?y=yield d.formData():y=yield d.text(),{data:y,error:null,response:d}}catch(o){return{data:null,error:o,response:o instanceof xc||o instanceof bc?o.context:void 0}}})}}var _e={},Ar={},Or={},Ir={},jr={},$r={},Dx=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},an=Dx();const Mx=an.fetch,Of=an.fetch.bind(an),If=an.Headers,Bx=an.Request,Fx=an.Response,mn=Object.freeze(Object.defineProperty({__proto__:null,Headers:If,Request:Bx,Response:Fx,default:Of,fetch:Mx},Symbol.toStringTag,{value:"Module"})),Ux=yg(mn);var Co={},_c;function jf(){if(_c)return Co;_c=1,Object.defineProperty(Co,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Co.default=t,Co}var Sc;function $f(){if(Sc)return $r;Sc=1;var t=$r&&$r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty($r,"__esModule",{value:!0});const e=t(Ux),r=t(jf());class n{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=Object.assign({},this.headers),this.headers[s]=i,this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f;let p=null,y=null,m=null,v=c.status,w=c.statusText;if(c.ok){if(this.method!=="HEAD"){const k=await c.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=k:y=JSON.parse(k))}const b=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),x=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");b&&x&&x.length>1&&(m=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(p={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,m=null,v=406,w="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(y=[],p=null,v=200,w="OK")}catch{c.status===404&&b===""?(v=204,w="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((f=p?.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,v=200,w="OK"),p&&this.shouldThrowOnError)throw new r.default(p)}return{error:p,data:y,count:m,status:v,statusText:w}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,f;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(d=c?.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(f=c?.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}}return $r.default=n,$r}var kc;function zf(){if(kc)return jr;kc=1;var t=jr&&jr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(jr,"__esModule",{value:!0});const e=t($f());class r extends e.default{select(o){let s=!1;const i=(o??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:s=!0,nullsFirst:i,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${o}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${o}`),this}range(o,s,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${o}`),this.url.searchParams.set(c,`${s-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:s=!1,settings:i=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const d=[o?"analyze":null,s?"verbose":null,i?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${d};`,c==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return jr.default=r,jr}var Cc;function ol(){if(Cc)return Ir;Cc=1;var t=Ir&&Ir.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ir,"__esModule",{value:!0});const e=t(zf());class r extends e.default{eq(o,s){return this.url.searchParams.append(o,`eq.${s}`),this}neq(o,s){return this.url.searchParams.append(o,`neq.${s}`),this}gt(o,s){return this.url.searchParams.append(o,`gt.${s}`),this}gte(o,s){return this.url.searchParams.append(o,`gte.${s}`),this}lt(o,s){return this.url.searchParams.append(o,`lt.${s}`),this}lte(o,s){return this.url.searchParams.append(o,`lte.${s}`),this}like(o,s){return this.url.searchParams.append(o,`like.${s}`),this}likeAllOf(o,s){return this.url.searchParams.append(o,`like(all).{${s.join(",")}}`),this}likeAnyOf(o,s){return this.url.searchParams.append(o,`like(any).{${s.join(",")}}`),this}ilike(o,s){return this.url.searchParams.append(o,`ilike.${s}`),this}ilikeAllOf(o,s){return this.url.searchParams.append(o,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(o,s){return this.url.searchParams.append(o,`ilike(any).{${s.join(",")}}`),this}is(o,s){return this.url.searchParams.append(o,`is.${s}`),this}in(o,s){const i=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(o,`in.(${i})`),this}contains(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cs.{${s.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(s)}`),this}containedBy(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cd.{${s.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(s)}`),this}rangeGt(o,s){return this.url.searchParams.append(o,`sr.${s}`),this}rangeGte(o,s){return this.url.searchParams.append(o,`nxl.${s}`),this}rangeLt(o,s){return this.url.searchParams.append(o,`sl.${s}`),this}rangeLte(o,s){return this.url.searchParams.append(o,`nxr.${s}`),this}rangeAdjacent(o,s){return this.url.searchParams.append(o,`adj.${s}`),this}overlaps(o,s){return typeof s=="string"?this.url.searchParams.append(o,`ov.${s}`):this.url.searchParams.append(o,`ov.{${s.join(",")}}`),this}textSearch(o,s,{config:i,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=i===void 0?"":`(${i})`;return this.url.searchParams.append(o,`${l}fts${c}.${s}`),this}match(o){return Object.entries(o).forEach(([s,i])=>{this.url.searchParams.append(s,`eq.${i}`)}),this}not(o,s,i){return this.url.searchParams.append(o,`not.${s}.${i}`),this}or(o,{foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${o})`),this}filter(o,s,i){return this.url.searchParams.append(o,`${s}.${i}`),this}}return Ir.default=r,Ir}var Pc;function Nf(){if(Pc)return Or;Pc=1;var t=Or&&Or.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Or,"__esModule",{value:!0});const e=t(ol());class r{constructor(o,{headers:s={},schema:i,fetch:a}){this.url=o,this.headers=s,this.schema=i,this.fetch=a}select(o,{head:s=!1,count:i}={}){const a=s?"HEAD":"GET";let l=!1;const c=(o??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:s,defaultToNull:i=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(o)){const c=o.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:s,ignoreDuplicates:i=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${i?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(o)){const d=o.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(d.length>0){const f=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:s}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const s="DELETE",i=[];return o&&i.push(`count=${o}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Or.default=r,Or}var kn={},Cn={},Ec;function Hx(){return Ec||(Ec=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.version=void 0,Cn.version="0.0.0-automated"),Cn}var Tc;function Wx(){if(Tc)return kn;Tc=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.DEFAULT_HEADERS=void 0;const t=Hx();return kn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},kn}var Rc;function Gx(){if(Rc)return Ar;Rc=1;var t=Ar&&Ar.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ar,"__esModule",{value:!0});const e=t(Nf()),r=t(ol()),n=Wx();class o{constructor(i,{headers:a={},schema:l,fetch:c}={}){this.url=i,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new o(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:l=!1,get:c=!1,count:u}={}){let d;const f=new URL(`${this.url}/rpc/${i}`);let p;l||c?(d=l?"HEAD":"GET",Object.entries(a).filter(([m,v])=>v!==void 0).map(([m,v])=>[m,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([m,v])=>{f.searchParams.append(m,v)})):(d="POST",p=a);const y=Object.assign({},this.headers);return u&&(y.Prefer=`count=${u}`),new r.default({method:d,url:f,headers:y,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return Ar.default=o,Ar}var Ac;function qx(){if(Ac)return _e;Ac=1;var t=_e&&_e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(_e,"__esModule",{value:!0}),_e.PostgrestError=_e.PostgrestBuilder=_e.PostgrestTransformBuilder=_e.PostgrestFilterBuilder=_e.PostgrestQueryBuilder=_e.PostgrestClient=void 0;const e=t(Gx());_e.PostgrestClient=e.default;const r=t(Nf());_e.PostgrestQueryBuilder=r.default;const n=t(ol());_e.PostgrestFilterBuilder=n.default;const o=t(zf());_e.PostgrestTransformBuilder=o.default;const s=t($f());_e.PostgrestBuilder=s.default;const i=t(jf());return _e.PostgrestError=i.default,_e.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:s.default,PostgrestError:i.default},_e}var Vx=qx();const Xx=Yn(Vx),{PostgrestClient:Kx,PostgrestQueryBuilder:cE,PostgrestFilterBuilder:uE,PostgrestTransformBuilder:dE,PostgrestBuilder:hE,PostgrestError:fE}=Xx;function Jx(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Yx=Jx(),Zx="2.11.15",Qx=`realtime-js/${Zx}`,e0="1.0.0",Lf=1e4,t0=1e3;var Nn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Nn||(Nn={}));var Ee;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Ee||(Ee={}));var Ye;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ye||(Ye={}));var oa;(function(t){t.websocket="websocket"})(oa||(oa={}));var ir;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ir||(ir={}));class r0{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const o=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const a=n.decode(e.slice(i,i+o));i=i+o;const l=n.decode(e.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class Df{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var pe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(pe||(pe={}));const Oc=(t,e,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,i)=>(s[i]=n0(i,t,e,o),s),{})},n0=(t,e,r,n)=>{const o=e.find(a=>a.name===t),s=o?.type,i=r[t];return s&&!n.includes(s)?Mf(s,i):sa(i)},Mf=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return a0(e,r)}switch(t){case pe.bool:return o0(e);case pe.float4:case pe.float8:case pe.int2:case pe.int4:case pe.int8:case pe.numeric:case pe.oid:return s0(e);case pe.json:case pe.jsonb:return i0(e);case pe.timestamp:return l0(e);case pe.abstime:case pe.date:case pe.daterange:case pe.int4range:case pe.int8range:case pe.money:case pe.reltime:case pe.text:case pe.time:case pe.timestamptz:case pe.timetz:case pe.tsrange:case pe.tstzrange:return sa(e);default:return sa(e)}},sa=t=>t,o0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},s0=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},i0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},a0=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const i=t.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(a=>Mf(e,a))}return t},l0=t=>typeof t=="string"?t.replace(" ","T"):t,Bf=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Js{constructor(e,r,n={},o=Lf){this.channel=e,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ic;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ic||(Ic={}));class Ln{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ln.syncState(this.state,o,s,i),this.pendingDiffs.forEach(l=>{this.state=Ln.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Ln.syncDiff(this.state,o,s,i),a())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,o){const s=this.cloneDeep(e),i=this.transformState(r),a={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const d=s[c];if(d){const f=u.map(v=>v.presence_ref),p=d.map(v=>v.presence_ref),y=u.filter(v=>p.indexOf(v.presence_ref)<0),m=d.filter(v=>f.indexOf(v.presence_ref)<0);y.length>0&&(a[c]=y),m.length>0&&(l[c]=m)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},n,o)}static syncDiff(e,r,n,o){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(s,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(p=>p.presence_ref),f=u.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...f)}n(a,u,l)}),this.map(i,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,o(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const o=e[n];return"metas"in o?r[n]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=o,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jc;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(jc||(jc={}));var $c;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})($c||($c={}));var bt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(bt||(bt={}));class sl{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Ee.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Js(this,Ye.join,this.params,this.timeout),this.rejoinTimer=new Df(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ee.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ee.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ee.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ee.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ye.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Ln(this),this.broadcastEndpointURL=Bf(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Ee.closed){const{config:{broadcast:s,presence:i,private:a}}=this.params;this._onError(u=>e?.(bt.CHANNEL_ERROR,u)),this._onClose(()=>e?.(bt.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&o!==void 0?o:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e?.(bt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(d=f?.length)!==null&&d!==void 0?d:0,y=[];for(let m=0;m<p;m++){const v=f[m],{filter:{event:w,schema:S,table:b,filter:x}}=v,k=u&&u[m];if(k&&k.event===w&&k.schema===S&&k.table===b&&k.filter===x)y.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=Ee.errored,e?.(bt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(bt.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ee.errored,e?.(bt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(bt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ee.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ye.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new Js(this,Ye.leave,{},e),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const o=new AbortController,s=setTimeout(()=>o.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(s),i}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Js(this,e,r,n);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var o,s;const i=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Ye;if(n&&[a,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let f=this._onMessage(i,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(p=>{var y,m,v;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(p=>p.callback(f,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var y,m,v,w,S,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const x=p.id,k=(y=p.filter)===null||y===void 0?void 0:y.event;return x&&((m=r.ids)===null||m===void 0?void 0:m.includes(x))&&(k==="*"||k?.toLocaleLowerCase()===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const x=(S=(w=p?.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return x==="*"||x===((b=r?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:m,table:v,commit_timestamp:w,type:S,errors:b}=y;f=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:w,eventType:S,new:{},old:{},errors:b}),this._getPayloadRecords(y))}p.callback(f,n)})}_isClosed(){return this.state===Ee.closed}_isJoined(){return this.state===Ee.joined}_isJoining(){return this.state===Ee.joining}_isLeaving(){return this.state===Ee.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const o=e.toLocaleLowerCase(),s={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&sl.isEqual(o.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ye.close,{},e)}_onError(e){this._on(Ye.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ee.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Oc(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Oc(e.columns,e.old_record)),r}}const zc=()=>{},c0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class u0{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lf,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zc,this.ref=0,this.logger=zc,this.conn=null,this.sendBuffer=[],this.serializer=new r0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>Ut(async()=>{const{default:l}=await Promise.resolve().then(()=>mn);return{default:l}},void 0).then(({default:l})=>l(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${oa.websocket}`,this.httpEndpoint=Bf(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const o=(n=r?.params)===null||n===void 0?void 0:n.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r?.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Df(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Yx),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:e0}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Nn.connecting:return ir.Connecting;case Nn.open:return ir.Open;case Nn.closing:return ir.Closing;default:return ir.Closed}}isConnected(){return this.connectionState()===ir.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,o=this.getChannels().find(s=>s.topic===n);if(o)return o;{const s=new sl(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:o,ref:s}=e,i=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:Qx};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Ye.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(t0,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:o,payload:s,ref:i}=r;n==="phoenix"&&o==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${o} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(o,s,i)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ye.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${e}${n}${o}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([c0],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class il extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Se(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class d0 extends il{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ia extends il{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var h0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const Ff=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},f0=()=>h0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ut(()=>Promise.resolve().then(()=>mn),void 0)).Response:Response}),aa=t=>{if(Array.isArray(t))return t.map(r=>aa(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=aa(n)}),e};var kr=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const Ys=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),p0=(t,e,r)=>kr(void 0,void 0,void 0,function*(){const n=yield f0();t instanceof n&&!r?.noResolveJson?t.json().then(o=>{e(new d0(Ys(o),t.status||500))}).catch(o=>{e(new ia(Ys(o),o))}):e(new ia(Ys(t),t))}),g0=(t,e,r,n)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n&&(o.body=JSON.stringify(n)),Object.assign(Object.assign({},o),r))};function oo(t,e,r,n,o,s){return kr(this,void 0,void 0,function*(){return new Promise((i,a)=>{t(r,g0(e,n,o,s)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>p0(l,a,n))})})}function es(t,e,r,n){return kr(this,void 0,void 0,function*(){return oo(t,"GET",e,r,n)})}function Dt(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"POST",e,n,o,r)})}function m0(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"PUT",e,n,o,r)})}function y0(t,e,r,n){return kr(this,void 0,void 0,function*(){return oo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Uf(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"DELETE",e,n,o,r)})}var je=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const v0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Nc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class w0{constructor(e,r={},n,o){this.url=e,this.headers=r,this.bucketId=n,this.fetch=Ff(o)}uploadOrUpdate(e,r,n,o){return je(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Nc),o);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),o?.headers&&(a=Object.assign(Object.assign({},a),o.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:a},i?.duplex?{duplex:i.duplex}:{})),f=yield d.json();return d.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}upload(e,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,o){return je(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Nc.upsert},o),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Se(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return je(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const o=Object.assign({},this.headers);r?.upsert&&(o["x-upsert"]="true");const s=yield Dt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),i=new URL(this.url+s.url),a=i.searchParams.get("token");if(!a)throw new il("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}update(e,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return je(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}copy(e,r,n){return je(this,void 0,void 0,function*(){try{return{data:{path:(yield Dt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}createSignedUrl(e,r,n){return je(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield Dt(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}createSignedUrls(e,r,n){return je(this,void 0,void 0,function*(){try{const o=yield Dt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}download(e,r){return je(this,void 0,void 0,function*(){const o=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),i=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield es(this.fetch,`${this.url}/${o}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}info(e){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield es(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:aa(n),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}exists(e){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield y0(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Se(n)&&n instanceof ia){const o=n.originalError;if([400,404].includes(o?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),o=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&o.push(s);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&o.push(l);let c=o.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield Uf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}list(e,r,n){return je(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},v0),r),{prefix:e||""});return{data:yield Dt(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const b0="2.7.1",x0={"X-Client-Info":`storage-js/${b0}`};var zr=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class _0{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},x0),r),this.fetch=Ff(n)}listBuckets(){return zr(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Se(e))return{data:null,error:e};throw e}})}getBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return zr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return zr(this,void 0,void 0,function*(){try{return{data:yield m0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}emptyBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}deleteBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield Uf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}}class S0 extends _0{constructor(e,r={},n){super(e,r,n)}from(e){return new w0(this.url,this.headers,e,this.fetch)}}const k0="2.51.0";let Tn="";typeof Deno<"u"?Tn="deno":typeof document<"u"?Tn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tn="react-native":Tn="node";const C0={"X-Client-Info":`supabase-js-${Tn}/${k0}`},P0={headers:C0},E0={schema:"public"},T0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},R0={};var A0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const O0=t=>{let e;return t?e=t:typeof fetch>"u"?e=Of:e=fetch,(...r)=>e(...r)},I0=()=>typeof Headers>"u"?If:Headers,j0=(t,e,r)=>{const n=O0(r),o=I0();return(s,i)=>A0(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new o(i?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var $0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};function z0(t){return t.endsWith("/")?t:t+"/"}function N0(t,e){var r,n;const{db:o,auth:s,realtime:i,global:a}=t,{db:l,auth:c,realtime:u,global:d}=e,f={db:Object.assign(Object.assign({},l),o),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(r=d?.headers)!==null&&r!==void 0?r:{}),(n=a?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>$0(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}const Hf="2.71.0",Wr=30*1e3,la=3,Zs=la*Wr,L0="http://localhost:9999",D0="supabase.auth.token",M0={"X-Client-Info":`gotrue-js/${Hf}`},ca="X-Supabase-Api-Version",Wf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},B0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,F0=10*60*1e3;class al extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function J(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class U0 extends al{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function H0(t){return J(t)&&t.name==="AuthApiError"}class Gf extends al{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Yt extends al{constructor(e,r,n,o){super(e,n,o),this.name=r,this.status=n}}class Lt extends Yt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function W0(t){return J(t)&&t.name==="AuthSessionMissingError"}class Po extends Yt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Eo extends Yt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class To extends Yt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function G0(t){return J(t)&&t.name==="AuthImplicitGrantRedirectError"}class Lc extends Yt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ua extends Yt{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Qs(t){return J(t)&&t.name==="AuthRetryableFetchError"}class Dc extends Yt{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class da extends Yt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mc=` 	
\r=`.split(""),q0=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Mc.length;e+=1)t[Mc[e].charCodeAt(0)]=-2;for(let e=0;e<ts.length;e+=1)t[ts[e].charCodeAt(0)]=e;return t})();function Bc(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ts[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ts[n]),e.queuedBits-=6}}function qf(t,e,r){const n=q0[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Fc(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{K0(i,n,r)};for(let i=0;i<t.length;i+=1)qf(t.charCodeAt(i),o,s);return e.join("")}function V0(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function X0(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}V0(n,e)}}function K0(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function J0(t){const e=[],r={queue:0,queuedBits:0},n=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)qf(t.charCodeAt(o),r,n);return new Uint8Array(e)}function Y0(t){const e=[];return X0(t,r=>e.push(r)),new Uint8Array(e)}function Z0(t){const e=[],r={queue:0,queuedBits:0},n=o=>{e.push(o)};return t.forEach(o=>Bc(o,r,n)),Bc(null,r,n),e.join("")}function Q0(t){return Math.round(Date.now()/1e3)+t}function e_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Je=()=>typeof window<"u"&&typeof document<"u",er={tested:!1,writable:!1},Vf=()=>{if(!Je())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(er.tested)return er.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),er.tested=!0,er.writable=!0}catch{er.tested=!0,er.writable=!1}return er.writable};function t_(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return r.searchParams.forEach((n,o)=>{e[o]=n}),e}const Xf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},r_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Gr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},tr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},jt=async(t,e)=>{await t.removeItem(e)};class ys{constructor(){this.promise=new ys.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}ys.promiseConstructor=Promise;function ei(t){const e=t.split(".");if(e.length!==3)throw new da("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!B0.test(e[n]))throw new da("JWT not in base64url format");return{header:JSON.parse(Fc(e[0])),payload:JSON.parse(Fc(e[1])),signature:J0(e[2]),raw:{header:e[0],payload:e[1]}}}async function n_(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function o_(t,e){return new Promise((n,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await t(s);if(!e(s,null,i)){n(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function s_(t){return("0"+t.toString(16)).substr(-2)}function i_(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let s=0;s<56;s++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(e),Array.from(e,s_).join("")}async function a_(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function l_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await a_(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Nr(t,e,r=!1){const n=i_();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await Gr(t,`${e}-code-verifier`,o);const s=await l_(n);return[s,n===s?"plain":"s256"]}const c_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function u_(t){const e=t.headers.get(ca);if(!e||!e.match(c_))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function d_(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function h_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const f_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lr(t){if(!f_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ti(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var p_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};const nr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),g_=[502,503,504];async function Uc(t){var e;if(!r_(t))throw new ua(nr(t),0);if(g_.includes(t.status))throw new ua(nr(t),t.status);let r;try{r=await t.json()}catch(s){throw new Gf(nr(s),s)}let n;const o=u_(t);if(o&&o.getTime()>=Wf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Dc(nr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Lt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Dc(nr(r),t.status,r.weak_password.reasons);throw new U0(nr(r),t.status||500,n)}const m_=(t,e,r,n)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function oe(t,e,r,n){var o;const s=Object.assign({},n?.headers);s[ca]||(s[ca]=Wf["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(o=n?.query)!==null&&o!==void 0?o:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await y_(t,e,r+a,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function y_(t,e,r,n,o,s){const i=m_(e,n,o,s);let a;try{a=await t(r,Object.assign({},i))}catch(l){throw console.error(l),new ua(nr(l),0)}if(a.ok||await Uc(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await Uc(l)}}function wt(t){var e;let r=null;x_(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Q0(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Hc(t){const e=wt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Mt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function v_(t){return{data:t,error:null}}function w_(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s}=t,i=p_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s},l=Object.assign({},i);return{data:{properties:a,user:l},error:null}}function b_(t){return t}function x_(t){return t.access_token&&t.refresh_token&&t.expires_in}const ri=["global","local","others"];var __=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};class S_{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Xf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=ri[0]){if(ri.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ri.join(", ")}`);try{return await oe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=__(e,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n?.newEmail,delete o.newEmail),await oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:w_,redirectTo:r?.redirectTo})}catch(r){if(J(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await oe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Mt})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,o,s,i,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:b_});if(u.error)throw u.error;const d=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const m=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(J(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Lr(e);try{return await oe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Mt})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Lr(e);try{return await oe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Lr(e);try{return await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Lr(e.userId);try{const{data:r,error:n}=await oe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(J(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Lr(e.userId),Lr(e.id);try{return{data:await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}}function Wc(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function k_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Dr={debug:!!(globalThis&&Vf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kf extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class C_ extends Kf{}async function P_(t,e,r){Dr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Dr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Dr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await r()}finally{Dr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw Dr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new C_(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Dr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}k_();const E_={url:L0,storageKey:D0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:M0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Gc(t,e,r){return await r()}const Mr={};class Xn{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Xn.nextInstanceID,Xn.nextInstanceID+=1,this.instanceID>0&&Je()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},E_),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new S_({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Xf(o.fetch),this.lock=o.lock||Gc,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Je()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=P_:this.lock=Gc,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Vf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Wc(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Wc(this.memoryStorage)),Je()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Hf}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=t_(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Je()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),G0(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:a}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return J(r)?{error:r}:{error:new Gf("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,o;try{const s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:wt}),{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(J(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,o;try{let s;if("email"in e){const{email:u,password:d,options:f}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await Nr(this.storage,this.storageKey)),s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:d,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:y},xform:wt})}else if("phone"in e){const{phone:u,password:d,options:f}=e;s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(o=f?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:wt})}else throw new Eo("You must provide either an email or phone number and a password");const{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(J(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:i,options:a}=e;r=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Hc})}else if("phone"in e){const{phone:s,password:i,options:a}=e;r=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Hc})}else throw new Eo("You must provide either an email or phone number and a password");const{data:n,error:o}=r;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Po}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,o,s,i,a,l,c,u,d,f,p;let y,m;if("message"in e)y=e.message,m=e.signature;else{const{chain:v,wallet:w,statement:S,options:b}=e;let x;if(Je())if(typeof w=="object")x=w;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))x=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=w}const k=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const C=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),S?{statement:S}:null));let _;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")_=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)_=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)y=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),m=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${k.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(o=(n=b?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=b?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((i=b?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((c=b?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((d=(u=b?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...b.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const C=await x.signMessage(new TextEncoder().encode(y),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=C}}try{const{data:v,error:w}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Z0(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:wt});if(w)throw w;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Po}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:w})}catch(v){if(J(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await tr(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{const{data:s,error:i}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:wt});if(await jt(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Po}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(J(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:o,access_token:s,nonce:i}=e,a=await oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:wt}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Po}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,o,s,i;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Nr(this.storage,this.storageKey));const{error:d}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(o=l?.data)!==null&&o!==void 0?o:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(i=l?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Eo("You must provide either an email or phone number.")}catch(a){if(J(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let o,s;"options"in e&&(o=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:a}=await oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:wt});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(J(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var r,n,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Nr(this.storage,this.storageKey)),await oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:v_})}catch(s){if(J(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Lt;const{error:o}=await oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(J(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:o,options:s}=e,{error:i}=await oe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:n,type:o,options:s}=e,{data:i,error:a}=await oe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:a}}throw new Eo("You must provide either an email or phone number and a type")}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await tr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Zs:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const i=await tr(this.userStorage,this.storageKey+"-user");i?.user?e.user=i.user:e.user=ti()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mt}):await this._useSession(async r=>{var n,o,s;const{data:i,error:a}=r;if(a)throw a;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Lt}:await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Mt})})}catch(r){if(J(r))return W0(r)&&(await this._removeSession(),await jt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:o,error:s}=n;if(s)throw s;if(!o.session)throw new Lt;const i=o.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Nr(this.storage,this.storageKey));const{data:c,error:u}=await oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:i.access_token,xform:Mt});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Lt;const r=Date.now()/1e3;let n=r,o=!0,s=null;const{payload:i}=ei(e.access_token);if(i.exp&&(n=i.exp,o=n<=r),o){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(J(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:i,error:a}=r;if(a)throw a;e=(n=i.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Lt;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Je())throw new To("No browser detected.");if(e.error||e.error_description||e.error_code)throw new To(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Lc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new To("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Lc("No code detected.");const{data:S,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:a,expires_at:l,token_type:c}=e;if(!s||!a||!i||!c)throw new To("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let f=u+d;l&&(f=parseInt(l));const p=f-u;p*1e3<=Wr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const y=f-d;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,u);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const w={provider_token:n,provider_refresh_token:o,access_token:s,expires_in:d,expires_at:f,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(n){if(J(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await tr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{error:s};const i=(n=o.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(H0(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await jt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=e_(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,o;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await Nr(this.storage,this.storageKey,!0));try{return await oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(J(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:o}=await this._useSession(async s=>{var i,a,l,c,u;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await oe(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(o)throw o;return Je()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(J(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)throw i;return await oe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await o_(async o=>(o>0&&await n_(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:wt})),(o,s)=>{const i=200*Math.pow(2,o);return s&&Qs(s)&&Date.now()+i-n<Wr})}catch(n){if(this._debug(r,"error",n),J(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Je()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await tr(this.storage,this.storageKey);if(o&&this.userStorage){let i=await tr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await Gr(this.userStorage,this.storageKey+"-user",i)),o.user=(e=i?.user)!==null&&e!==void 0?e:ti()}else if(o&&!o.user&&!o.user){const i=await tr(this.storage,this.storageKey+"-user");i&&i?.user?(o.user=i.user,await jt(this.storage,this.storageKey+"-user"),await Gr(this.storage,this.storageKey,o)):o.user=ti()}if(this._debug(n,"session from storage",o),!this._isValidSession(o)){this._debug(n,"session is not valid"),o!==null&&await this._removeSession();return}const s=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Zs;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Zs}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),Qs(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:a}=await this._getUser(o.access_token);!a&&i?.user?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(n,"error",o),console.error(o);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Lt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new ys;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new Lt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(o,"error",s),J(s)){const i={session:null,error:s};return Qs(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,r,n=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Gr(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const s=structuredClone(o);await Gr(this.storage,this.storageKey,s)}else{const o=structuredClone(r);await Gr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await jt(this.storage,this.storageKey),await jt(this.storage,this.storageKey+"-code-verifier"),await jt(this.storage,this.storageKey+"-user"),this.userStorage&&await jt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Je()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Wr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-e)/Wr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Wr}ms, refresh threshold is ${la} ticks`),o<=la&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Kf)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Je()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Nr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(a.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);o.push(s.toString())}return n?.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await oe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await oe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((o=l?.totp)===null||o===void 0)&&o.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:a}=await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(r){if(J(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(J(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],o=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=ei(o.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((n=(r=o.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+F0>o)return n;const{data:s,error:i}=await oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,n=s.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:y}=await this.getSession();if(y||!p.session)return{data:null,error:y};n=p.session.access_token}const{header:o,payload:s,signature:i,raw:{header:a,payload:l}}=ei(n);r?.allowExpired||d_(s.exp);const c=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:o,signature:i},error:null}}const u=h_(o.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,i,Y0(`${a}.${l}`)))throw new da("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}}Xn.nextInstanceID=0;const T_=Xn;class R_ extends T_{constructor(e){super(e)}}var A_=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class O_{constructor(e,r,n){var o,s,i;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=z0(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:E0,realtime:R0,auth:Object.assign(Object.assign({},T0),{storageKey:c}),global:P0},d=N0(n??{},u);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=j0(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Kx(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Lx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new S0(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return A_(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:o,storageKey:s,flowType:i,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new R_({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:o,flowType:i,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new u0(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const I_=(t,e,r)=>new O_(t,e,r),ln=I_("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),j_=async(t,e)=>{const r=await ln.from("campaigns").upsert([{name:t,data:await Rf(e)}]).select();if(r.error)throw new Error(`error saving to db ${r.error.message} ${r.error.details}`,{cause:r.error});return console.log("saved ok",r.data),r.data},$_=async t=>{const e=await ln.from("campaigns").select("data").eq("name",t);if(e.error)throw e.error;const[r]=e.data;return await jx(r.data)},Jf=()=>{const[t,e]=g.useState(null);return g.useEffect(()=>{ln.auth.getUser().then(({data:{user:n}})=>{e(n)});const{data:{subscription:r}}=ln.auth.onAuthStateChange((n,o)=>{e(o?.user??null)});return()=>r.unsubscribe()},[]),t},z_=()=>{const t=Jf();return h.jsxs(h.Fragment,{children:[h.jsx(rt,{disabled:t===null,onClick:async()=>{const e=B.getState();await j_("sequel",md(e))},children:h.jsx(Vn,{icon:h.jsxs("div",{className:"flex flex-row items-center",children:[h.jsx("span",{className:Ce("sprite sprite-tinted text-highlightBeige texture-hud_char_ relative",{"text-lightGrey":t===null})}),h.jsx("span",{className:Ce("sprite texture-editor_tool_save relative",{"sprite-revert-to-two-tone-dim":t===null})})]}),topText:"sa",bottomText:"ve"})}),h.jsx(rt,{disabled:t===null,onClick:async()=>{try{const e=await $_("sequel");console.log(e),B.dispatch(tm({campaign:e}))}catch(e){console.error(e)}},children:h.jsx(Vn,{icon:h.jsxs("div",{className:"flex flex-row items-center",children:[h.jsx("span",{className:Ce("sprite texture-editor_tool_save relative",{"sprite-revert-to-two-tone-dim":t===null})}),h.jsx("span",{className:Ce("sprite sprite-tinted text-highlightBeige texture-hud_char_ relative",{"text-lightGrey":t===null})})]}),topText:"lo",bottomText:"ad"})})]})},N_=()=>h.jsx(rt,{children:h.jsx(Q,{className:"relative leading-none",children:"MAP"})}),L_=()=>h.jsx(rt,{onClick:async()=>{const t=B.getState(),e=md(t),r=await Rf(e),n=new URL("https://blockstack.ing"),o=n.searchParams;o.set("campaignData",r),o.set("noSaves","1"),o.set("cheats","1"),n.hash=t.levelEditor.currentlyEditingRoomId,window.open(n.toString(),"playtest")},children:h.jsx(Vn,{topText:"pl",bottomText:"ay",icon:h.jsx("span",{className:"sprite texture-joystick mt-half"})})}),D_=t=>{switch(t){case"github":return rd;case"discord":return nd;default:throw new Error}},M_=({className:t})=>{const e=Jf(),r=o=>async()=>{const s=new URL(window.location.href);s.hash="";const i=s.toString(),{error:a}=await ln.auth.signInWithOAuth({provider:o,options:{redirectTo:i}});a&&console.error("Login error:",a)},n=async()=>{const{error:o}=await ln.auth.signOut();o&&console.error("Logout error:",o)};return h.jsx("div",{className:Ce(t),children:e?h.jsxs("div",{className:"bg-moss",children:[h.jsx(Q,{noSlitWords:!0,className:"overflow-hidden",children:`${D_(e.app_metadata.provider)}${e.email}`}),h.jsx(St,{className:"px-1 w-full",onClick:n,children:h.jsx(Q,{children:"Logout"})})]}):h.jsxs("div",{className:"px-1 bg-midRed",children:[h.jsx(Q,{className:"block w-full sprites-double-height pb-1",children:"Not logged in"}),h.jsx(Q,{className:"block w-full text-highlightBeige",children:"You will not be able to save"}),h.jsxs("div",{className:"pt-1 flex flex-col gap-half",children:[h.jsx(Q,{children:"Log in with:"}),h.jsxs(St,{className:"px-1 w-full flex-row justify-between bg-redShadow",onClick:r("github"),children:[h.jsx(Q,{children:rd}),h.jsx(Q,{children:"GitHub"})]}),h.jsxs(St,{className:"px-1 w-full flex-row justify-between bg-redShadow",onClick:r("discord"),children:[h.jsx(Q,{children:nd}),h.jsx(Q,{children:"Discord"})]})]})]})})},B_=()=>{const t=be(n=>n.levelEditor.campaignInProgress),e=be(n=>n.levelEditor.currentlyEditingRoomId),r=pt();return h.jsxs("div",{className:"scale-editor flex w-full h-full text-white bg-metallicBlueHalfbrite pb-1 gap-1 flex-wrap justify-start overflow-auto",children:[h.jsx("div",{className:Pe,children:h.jsx(M_,{className:"w-full mb-1"})}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"Campaign"}),h.jsx(z_,{}),h.jsx(N_,{}),h.jsx(L_,{})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full pt-2",children:"Room"}),h.jsx(kf,{value:e,campaign:t,onSelect:n=>{r($i(n))},triggerButtonClassName:"w-full"}),h.jsx("div",{className:"h-1 w-full"}),h.jsx(cx,{}),h.jsx(lx,{}),h.jsx("div",{className:"h-1 w-full"}),h.jsx(vx,{}),h.jsx(wx,{})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full pt-2",children:"Edit"}),h.jsxs("div",{className:Pe,children:[h.jsx(ax,{}),h.jsx(bx,{})]}),h.jsx(fx,{}),h.jsx(sx,{}),h.jsx(yx,{}),h.jsx("div",{className:"h-1 w-full"}),h.jsxs("div",{className:"flex flex-row justify-between flex-wrap gap-x-1",children:[h.jsx(ix,{className:""}),h.jsx(px,{className:""})]})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full pt-2",children:"Blocks"}),h.jsx($,{itemTool:{type:"block",config:{style:"organic"}},children:h.jsx("span",{className:`sprite texture-block_organic ${q}`})}),h.jsx($,{itemTool:{type:"block",config:{style:"organic",disappearing:{on:"stand"}}},children:h.jsx(So,{iconClassName:me("texture-block_organic_disappearing")})}),h.jsx($,{itemTool:{type:"block",config:{style:"artificial"}},children:h.jsx("span",{className:`sprite texture-block_artificial ${q}`})}),h.jsx($,{itemTool:{type:"block",config:{style:"artificial",disappearing:{on:"stand"}}},children:h.jsx(So,{iconClassName:me("texture-block_artificial_disappearing")})}),h.jsx($,{itemTool:{type:"block",config:{style:"tower"}},children:h.jsx("span",{className:`sprite texture-tower ${q}`})}),h.jsx($,{itemTool:{type:"block",config:{style:"book"}},children:h.jsx("span",{className:`sprite texture-book_x ${q}`})}),h.jsxs(Sn,{children:[h.jsx($,{itemTool:{type:"barrier",config:{axis:"x"}},children:h.jsx("span",{className:`sprite texture-barrier_x ${q}`})}),h.jsx($,{itemTool:{type:"barrier",config:{axis:"y"}},children:h.jsx("span",{className:`sprite texture-barrier_y ${q}`})}),h.jsx($,{itemTool:{type:"barrier",config:{axis:"x",disappearing:{on:"touch"}}},children:h.jsx(So,{iconClassName:me("texture-barrier_x")})}),h.jsx($,{itemTool:{type:"barrier",config:{axis:"y",disappearing:{on:"touch"}}},children:h.jsx(So,{iconClassName:me("texture-barrier_y")})})]})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"Monsters"}),h.jsx($,{itemTool:{type:"monster",config:{which:"dalek",movement:"patrol-randomly-diagonal",activated:"on"}},children:h.jsx("span",{className:`sprite texture-dalek_1 [button:hover_&]:texture-animated-dalek" ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"cyberman",activated:"on",movement:"towards-on-shortest-axis-xy4",startDirection:"towards"}},children:h.jsx(vt,{topClasses:"texture-cyberman_towards [button:hover_&]:texture-cyberman_right",bottomClasses:"texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"})}),h.jsx($,{itemTool:{type:"monster",config:{which:"skiHead",style:"greenAndPink",activated:"on",movement:"back-forth",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-skiHead_greenAndPink_towards [button:hover_&]:texture-skiHead_greenAndPink_right ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"helicopterBug",activated:"on",movement:"patrol-randomly-xy8"}},children:h.jsx("span",{className:`sprite texture-helicopterBug_1 [button:hover_&]:texture-animated-helicopterBug ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"turtle",activated:"on",movement:"clockwise",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-turtle_towards_1 [button:hover_&]:texture-animated-turtle_right ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"homingBot",activated:"on",movement:"towards-tripped-on-axis-xy4"}},children:h.jsx("span",{className:`sprite texture-headlessBase [button:hover_&]:texture-headlessBase_all ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"computerBot",activated:"on",movement:"patrol-randomly-xy4-and-reverse"}},children:h.jsx(vt,{topClasses:"texture-computerBot_towards [button:hover_&]:texture-computerBot_right"})}),h.jsx($,{itemTool:{type:"monster",config:{which:"bubbleRobot",activated:"on",movement:"patrol-randomly-xy8"}},children:h.jsx(vt,{topClasses:me("texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"),bottomClasses:me("texture-headlessBase")})}),h.jsx($,{itemTool:{type:"monster",config:{which:"monkey",activated:"on",movement:"patrol-randomly-xy4"}},children:h.jsx(vt,{topClasses:"texture-monkey_towards [button:hover_&]:texture-monkey_right"})}),h.jsx($,{itemTool:{type:"monster",config:{which:"elephant",activated:"on",movement:"patrol-randomly-xy4"}},children:h.jsx(vt,{topClasses:"texture-elephant_towards [button:hover_&]:texture-elephant_right"})}),h.jsx($,{itemTool:{type:"monster",config:{which:"elephantHead",activated:"on",movement:"turn-to-player",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-elephant_towards [button:hover_&]:texture-elephant_right ${q}`})}),h.jsx($,{itemTool:{type:"monster",config:{which:"emperorsGuardian",activated:"while-player-near",movement:"towards-analogue-unless-planet-crowns"}},className:"inline relative",children:h.jsx(vt,{topClasses:"texture-ball",bottomClasses:"texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"})}),h.jsx($,{itemTool:{type:"monster",config:{which:"emperor",activated:"while-player-near",movement:"towards-analogue"}},children:h.jsx("span",{className:`sprite texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"Pickups"}),h.jsxs(Sn,{children:[h.jsx($,{itemTool:{type:"pickup",config:{gives:"extra-life"}},children:h.jsx(It,{iconClasses:"texture-whiteRabbit",text:"2"})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"shield"}},children:h.jsx(It,{iconClasses:"texture-whiteRabbit",text:""})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"jumps"}},children:h.jsx(It,{iconClasses:"texture-whiteRabbit",text:""})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"fast"}},children:h.jsx(It,{iconClasses:"texture-whiteRabbit",text:""})})]}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"bag"}},children:h.jsx("span",{className:`sprite texture-bag ${q}`})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"hooter"}},children:h.jsx("span",{className:`sprite texture-hooter ${q}`})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"doughnuts"}},children:h.jsx("span",{className:`sprite texture-doughnuts ${q}`})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"crown",planet:"blacktooth"}},children:h.jsx("span",{className:`sprite texture-crown_blacktooth ${q}`})}),h.jsx($,{itemTool:{type:"pickup",config:{gives:"scroll",page:"blacktooth"}},children:h.jsx("span",{className:`sprite texture-scroll ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"deadly"}),h.jsxs(Sn,{children:[h.jsx($,{itemTool:{type:"deadlyBlock",config:{style:"volcano"}},children:h.jsx("span",{className:`sprite texture-volcano_1 [button:hover_&]:texture-animated-volcano ${q}`})}),h.jsx($,{itemTool:{type:"deadlyBlock",config:{style:"toaster"}},children:h.jsx("span",{className:`sprite texture-toaster_off ${q}`})})]}),h.jsx($,{itemTool:{type:"slidingDeadly",config:{style:"spikyBall",startingPhase:1}},children:h.jsx("span",{className:`sprite texture-spikyBall_1 [button:hover_&]:texture-spikyBall_2 ${q}`})}),h.jsx($,{itemTool:{type:"spikes",config:ue},children:h.jsx("span",{className:`sprite texture-spikes ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"control"}),h.jsx($,{itemTool:{type:"charles",config:ue},children:h.jsx(vt,{topClasses:"texture-charles_towards [button:hover_&]:texture-charles_right"})}),h.jsx($,{itemTool:{type:"joystick",config:{controls:["charles"]}},children:h.jsx("span",{className:`sprite texture-joystick ${q}`})}),h.jsx($,{itemTool:{type:"switch",config:{initialSetting:"left",type:"in-room",modifies:od}},children:h.jsx("span",{className:`sprite texture-switch_left [button:hover_&]:texture-switch_right ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"movable"}),h.jsx($,{itemTool:{type:"spring",config:{}},children:h.jsx("span",{className:`sprite texture-spring_released [button:hover_&]:texture-spring_compressed ${q}`})}),h.jsxs(Sn,{children:[h.jsx($,{itemTool:{type:"portableBlock",config:{style:"cube"}},children:h.jsx("span",{className:`sprite texture-cube ${q}`})}),h.jsx($,{itemTool:{type:"portableBlock",config:{style:"drum"}},children:h.jsx("span",{className:`sprite texture-drum ${q}`})}),h.jsx($,{itemTool:{type:"portableBlock",config:{style:"sticks"}},children:h.jsx("span",{className:`sprite texture-sticks ${q}`})})]}),h.jsx($,{itemTool:{type:"pushableBlock",config:{}},children:h.jsx("span",{className:`sprite texture-stepStool ${q}`})}),h.jsx($,{itemTool:{type:"ball",config:ue},children:h.jsx("span",{className:`sprite texture-ball ${q}`})}),h.jsx($,{itemTool:{type:"slidingBlock",config:{style:"puck"}},children:h.jsx("span",{className:`sprite texture-puck ${q}`})}),h.jsx($,{itemTool:{type:"slidingBlock",config:{style:"book"}},children:h.jsx("span",{className:`sprite texture-book_y ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"misc."}),h.jsxs($,{itemTool:{type:"lift",config:{top:11,bottom:0}},className:"inline relative",children:[h.jsx("span",{className:`sprite inline-block absolute top-0 left-0 texture-lift_static ${q} [button:active_&]:top-oneScaledPix`}),h.jsx("span",{className:`sprite inline-block absolute top-0 left-0 texture-lift_1 [button:hover_&]:texture-animated-lift ${q} [button:active_&]:top-oneScaledPix`})]}),h.jsxs(Sn,{children:[h.jsx($,{itemTool:{type:"conveyor",config:{direction:"away"}},children:h.jsx(It,{iconClasses:"texture-conveyor_y_1 [button:hover_&]:texture-animated-conveyor_y",text:""})}),h.jsx($,{itemTool:{type:"conveyor",config:{direction:"towards"}},children:h.jsx(It,{iconClasses:"texture-conveyor_y_1 [button:hover_&]:texture-animated-reversed-conveyor_y",text:""})}),h.jsx($,{itemTool:{type:"conveyor",config:{direction:"left"}},children:h.jsx(It,{iconClasses:"texture-conveyor_x_1 [button:hover_&]:texture-animated-conveyor_x",text:""})}),h.jsx($,{itemTool:{type:"conveyor",config:{direction:"right"}},children:h.jsx(It,{iconClasses:"texture-conveyor_x_1 [button:hover_&]:texture-animated-reversed-conveyor_x",text:""})})]}),h.jsx($,{itemTool:{type:"teleporter",config:{toRoom:"to?",toPosition:le}},children:h.jsx("span",{className:`sprite texture-teleporter ${q}`})}),h.jsx($,{itemTool:{type:"movingPlatform",config:{movement:"clockwise",activated:"on",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-sandwich ${q}`})}),h.jsx($,{itemTool:{type:"hushPuppy",config:{}},children:h.jsx("span",{className:`sprite texture-hushPuppy ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"Structure"}),h.jsx(gx,{}),h.jsx(mx,{}),h.jsx($,{itemTool:{type:"floor",config:{floorType:"standable",scenery:"blacktooth",times:{x:1,y:1}}},children:h.jsx("span",{className:`sprite texture-blacktooth_floor ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"Player"}),h.jsx($,{itemTool:{type:"player",config:{which:"head"}},children:h.jsx("span",{className:`sprite texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right ${q}`})}),h.jsx($,{itemTool:{type:"player",config:{which:"heels"}},children:h.jsx("span",{className:`sprite texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right ${q}`})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full",children:"NPCs"}),h.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"head",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right ${q}`})}),h.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"heels",startDirection:"towards"}},children:h.jsx("span",{className:`sprite texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right ${q}`})}),h.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"headOverHeels",startDirection:"towards"}},children:h.jsx(vt,{topClasses:"texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right",bottomClasses:"texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right"})})]}),h.jsxs("div",{className:Pe,children:[h.jsx(Q,{className:"w-full pt-2",children:"debug"}),h.jsx(ox,{})]})]})},ni=({x:t=0,y:e=0})=>e-t,Z=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),F_=(t,e,r)=>{const n=Z(t),o=hr(r,n);return F(Yf(e,o),t)},Yf=(t,{x:e,y:r})=>{switch(sd(t)){case"xy":return{x:-e/2-r,y:e/2-r,z:0};case"xz":return{x:-e,y:0,z:e/2-r};case"yz":return{x:0,y:e,z:-e/2-r};default:throw new Error("only axis-aligned planes are supported for unprojection")}},ye=({x:t=0,y:e=0,z:r=0})=>({x:t*H.w,y:e*H.d,z:r*H.h}),Fo=({x:t=0,y:e=0,z:r=0})=>({x:t/H.w,y:e/H.d,z:r/H.h}),vr=t=>Z(ye(t)),cn=(t,e)=>({get bottomCentre(){return this.c000},get topLeft(){return this.c101},get topRight(){return this.c011},get c000(){return Z(t)},get c001(){return Z(F(t,{z:e.z}))},get c010(){return Z(F(t,{y:e.y}))},get c011(){return Z(F(t,{y:e.y,z:e.z}))},get c100(){return Z(F(t,{x:e.x}))},get c101(){return Z(F(t,{x:e.x,z:e.z}))},get c110(){return Z(F(t,{x:e.x,y:e.y}))},get c111(){return Z(F(t,{x:e.x,y:e.y,z:e.z}))},projectCorner(r){return Z(F(t,{x:r.x*e.x,y:r.y*e.y,z:r.z*e.z}))}}),oi=1e-5,qc=-1,Pn=(t,e,r,n,o)=>n-o>t&&r<e-o,U_=0,Zf=1,Qf=2,ep=3,H_=(t,e,r,n)=>{const{topLeft:o,topRight:s,bottomCentre:i}=cn(t,e),{topLeft:a,topRight:l,bottomCentre:c}=cn(r,n),u=s.y-s.x/2,d=i.y-i.x/2,f=l.y-l.x/2,p=c.y-c.x/2,y=o.y+o.x/2,m=i.y+i.x/2,v=a.y+a.x/2,w=c.y+c.x/2,S=o.x,b=s.x,x=a.x,k=l.x,C=Pn(u,d,f,p,oi),_=Pn(y,m,v,w,oi),j=Pn(S,b,x,k,oi);return C&&_&&j?Zf:_&&j&&Pn(u,d,f,p,qc)?Qf:C&&j&&Pn(y,m,v,w,qc)?ep:U_},W_=(t,e,r,n)=>{for(const o of vg){const s=t[o],i=s+e[o],a=r[o],l=a+n[o];if(i<=a)return 1*(o==="z"?-1:1);if(s>=l)return-1*(o==="z"?-1:1)}return Vc(r)-Vc(t)},G_=(t,e)=>{if(t.fixedZIndex!==void 0||e.fixedZIndex!==void 0)return 0;const r=t.renderAabb||t.aabb,n=e.renderAabb||e.aabb,o=t.renderAabbOffset?F(t.state.position,t.renderAabbOffset):t.state.position,s=e.renderAabbOffset?F(e.state.position,e.renderAabbOffset):e.state.position;switch(H_(o,r,s,n)){case Zf:return W_(o,r,s,n);case Qf:return Rt(o.y,s.y+n.y)&&Rt(o.z,s.z+n.z)?1:Rt(s.y,o.y+r.y)&&Rt(s.z,o.z+r.z)?-1:0;case ep:return Rt(o.x,s.x+n.x)&&Rt(o.z,s.z+n.z)?1:Rt(s.x,o.x+r.x)&&Rt(s.z,o.z+r.z)?-1:0;default:return 0}},Vc=t=>t.x+t.y-t.z;class Uo extends Error{constructor(e,r,n){super(`CyclicDependencyError: .cyclicDependency property of this error has nodes as an array. ${e.join(" -> ")}`,n),this.cyclicDependency=e,this.hasClosedCycle=r}}const q_=t=>{const e=V_(t);let r=e.length,n=r;const o=new Array(r),s={},i=X_(e);for(;n--;)s[n]||a(e[n],n,new Set);return o;function a(l,c,u){if(u.has(l))throw new Uo([l],!1);if(s[c])return;s[c]=!0;const d=t.get(l)||new Set,f=Array.from(d);if(c=f.length){u.add(l);do{const p=f[--c];try{a(p,i.get(p),u)}catch(y){throw y instanceof Uo?y.hasClosedCycle?y:new Uo([l,...y.cyclicDependency],y.cyclicDependency.includes(l)):y}}while(c);u.delete(l)}o[--r]=l}};function V_(t){const e=new Set;for(const[r,n]of t.entries()){e.add(r);for(const o of n)e.add(o)}return Array.from(e)}function X_(t){const e=new Map;for(let r=0,n=t.length;r<n;r++)e.set(t[r],r);return e}const Xc=(t,e,r)=>{t.has(e)||t.set(e,new Set),t.get(e).add(r)},Ro=(t,e,r)=>{const n=t.get(e);n!==void 0&&(n?.delete(r),n.size===0&&t.delete(e))},tp=(t,e=new Set(qo(t)),r=new Map)=>{const n=new Map;for(const[o,s]of r)if(!t[o])r.delete(o);else for(const i of s)t[i]||Ro(r,o,i);for(const o of e)if(o.fixedZIndex===void 0)for(const s of qo(t)){if(s.fixedZIndex!==void 0||n.get(s)?.has(o)||o===s)continue;const i=G_(o,s);if(Xc(n,o,s),i===0){Ro(r,o.id,s.id),Ro(r,s.id,o.id);continue}const a=i>0?o.id:s.id,l=i>0?s.id:o.id;Xc(r,a,l),Ro(r,l,a)}return r},ll=(t,e,r=3)=>{try{return{order:q_(t),impossible:!1}}catch(n){if(n instanceof Uo){const o=n.cyclicDependency;return t.get(o[0])?.delete(o[1]),console.warn("cyclc dependency detected: ",o.join(" --front-of--> "),`breaking link ${o[0]} --front-of--> ${o[1]}`),{order:ll(t,e,r-1).order,impossible:!0}}else throw n}};class K_{constructor(e,r){this.renderContext=e,this.appearance=r,this.output=new te({label:"AppearanceRenderer"})}#e;output;destroy(){this.output.destroy({children:!0})}tick(e){const r=this.appearance({renderContext:this.renderContext,currentRendering:this.#e,tickContext:e});r!=="no-update"&&(this.output.children.at(0)!==r.output&&(this.#e?.output&&this.output.removeChild(this.#e.output),r.output!==void 0&&this.output.addChild(r.output)),this.#e=r)}}class rp extends K_{}const Kc=(t,e)=>{e.poly([Z({}),Z({x:t.x}),Z({x:t.x,y:t.y}),Z({y:t.y})]).poly([Z({}),Z({z:t.z}),Z({y:t.y,z:t.z}),Z({y:t.y})]).poly([Z({x:t.x}),Z({x:t.x,z:t.z}),Z(t),Z({x:t.x,y:t.y})]).poly([Z({z:t.z}),Z({x:t.x,z:t.z}),Z({x:t.x,y:t.y,z:t.z}),Z({y:t.y,z:t.z})])},Jc=(t,e)=>{const r=new ct;return Kc(t,r),r.stroke({width:.5,color:e,alpha:1}),r.eventMode="static",r.on("pointerenter",()=>{r.fill({color:e,alpha:.5})}),r.on("pointerleave",()=>{r.clear(),Kc(t,r),r.stroke({width:.5,color:e,alpha:1})}),r},J_={head:"rgba(255,184,0)",wall:"rgba(128,200,0)",portal:"rgba(255,0,255)",pickup:"rgba(0,196,255)",emitter:"rgba(0,255,255)",stopAutowalk:"rgba(255,128,128)",floatingText:"rgba(128,0,255)"};class Y_{constructor(e){this.renderContext=e;const{item:r}=e,n=J_[r.type]??"rgba(255,255,255)";if(this.#e=new te({label:`ItemBoundingBoxRenderer ${r.id}`}),Qn("portal")(r)){const s=Z(r.config.relativePoint);this.#e.addChild(new ct().circle(s.x,s.y,5).stroke(n)),this.#e.addChild(new ct().circle(s.x,s.y,2).fill(n))}if(this.#e.addChild(new ct({label:"objectOrigin"}).circle(0,0,2).fill(n)),this.#e.addChild(Jc(r.aabb,n)),r.renderAabb){const s="rgba(184, 184, 255)",i=Jc(r.renderAabb,s);if(r.renderAabbOffset){const a=Z(r.renderAabbOffset);i.position.set(a.x,a.y),i.circle(0,0,2).fill(s)}this.#e.addChild(i)}this.#e.eventMode="static";let o;this.#e.on("pointerenter",()=>{if(o!==void 0)return;const s=`${r.id} ${r.type}
@(${r.state.position.x}, ${r.state.position.y}, ${r.state.position.z})}
#(${r.aabb.x}, ${r.aabb.y}, ${r.aabb.z})}`;this.#e.addChild(o=new Gm({text:s,style:{fill:n,fontSize:6,fontFamily:"Menlo"}})),o.resolution=4}),this.#e.on("pointerleave",()=>{o!==void 0&&(this.#e.removeChild(o),o=void 0)}),e.frontLayer.attach(this.#e)}#e;tick(){}destroy(){this.#e.destroy({children:!0})}get output(){return this.#e}}class Z_{constructor(e,r){this.renderContext=e,this.wrappedRenderer=r,this.#e=new te({label:`ItemPositionRenderer ${e.item.id}`,children:[r.output]}),this.#t()}#e;#t(){const e=Z(this.renderContext.item.state.position);this.#e.x=e.x,this.#e.y=e.y}tick(e){this.wrappedRenderer?.tick(e),e.movedItems.has(this.renderContext.item)&&this.#t()}destroy(){this.#e.destroy({children:!0}),this.wrappedRenderer?.destroy()}get output(){return this.#e}}const vs=({aabb:t,state:{position:e}},{aabb:r,state:{position:n}})=>!(e.x+t.x<=n.x||e.x>=n.x+r.x)&&!(e.y+t.y<=n.y||e.y>=n.y+r.y)&&!(e.z+t.z<=n.z||e.z>=n.z+r.z),Q_=(t,e)=>[...Tt(e).filter(r=>t.id!==r.id&&vs(t,r))];function*np(t,e){for(const r of e)t.id!==r.id&&vs(t,r)&&(yield r)}const Yc=wg/1e3,op={firedDoughnut:2*Yc,floatingText:Yc},so=11,Zc=6e4,eS=9999,tS=8,rS=750,nS=2500,Qc=200,oS=.15,sp=50,eu={x:.5,y:1},tu=t=>typeof t!="string"&&Object.hasOwn(t,"animationId"),ha=t=>{if(typeof t=="string")return ha({textureId:t});{const{anchor:e,flipX:r,pivot:n,x:o,y:s,filter:i,times:a,label:l}=t;let c;if(tu(t)?c=sS(t):c=new un(Ht().textures[t.textureId]),t.hasOwnProperty("times")){const u={x:1,y:1,z:1,...a},d=new te({label:l??"timesXyz"});for(let{x:f}=u;f>=1;f--)for(let{y:p}=u;p>=1;p--)for(let y=1;y<=u.z;y++){const m={...t,textureId:t.textureId??t.textureIdCallback?.(f-1,p-1,y-1),label:`(${f},${p},${y})`};delete m.times;const v=ha(m),w=vr({x:f-1,y:p-1,z:y-1});v.x+=w.x,v.y+=+w.y,d.addChild(v)}return d}if(e===void 0&&n===void 0)if(tu(t))c.anchor=eu;else{const u=Ht().data.frames[t.textureId];if(u===void 0)throw new Error(`no spritesheet entry for textureId "${t.textureId}"`);const d=u.frame;d.pivot!==void 0?c.pivot=d.pivot:c.anchor=eu}else e!==void 0&&(c.anchor=e),n!==void 0&&(c.pivot=n);return o!==void 0&&(c.x=o),s!==void 0&&(c.y=s),i!==void 0&&(c.filters=i),l!==void 0&&(c.label=l),c.eventMode="static",r===!0&&(c.scale.x=-1),c}},U=ha;function sS({animationId:t,reverse:e,playOnce:r,paused:n,randomiseStartFrame:o}){const s=Ht().animations[t],a=(n?[s[0]]:s).map(c=>({texture:c,time:bg}));e&&a.reverse();const l=new Hn(a);return l.animationSpeed=br.animations[t].animationSpeed,l.gotoAndPlay(o?Math.floor(Math.random()*a.length):0),r!==void 0&&(l.loop=!1,l.onComplete=()=>{l.stop(),r==="and-destroy"&&(l.visible=!1)}),l}const ip=(t,e)=>{const r=e.getLocalBounds(),n=Ia.create({width:r.maxX-r.minX,height:r.maxY-r.minY});return e.x-=r.minX,e.y-=r.minY,t.render({container:e,target:n}),new un({texture:n,label:"shadowMaskSprite (of renderTexture)",pivot:{x:-r.minX,y:-r.minY}})},ws=(t,e,r)=>{const n=r&&{x:r.x??1,y:r.y??1},o=U({...typeof e=="string"?{textureId:e}:e,times:n});return o instanceof un?o:ip(t,o)},$t=t=>Re(({renderContext:{item:e}})=>yd(e)?U({...typeof t=="string"?{textureId:t}:t,times:Ta(e)}):U(t)),We=t=>Re(({renderContext:{item:e,general:{pixiRenderer:r}}})=>{if(yd(e))return ws(r,t,Ta(e));{const n=U(t);return n instanceof un?n:ip(r,n)}}),Re=t=>({renderContext:e,currentRendering:r,tickContext:n})=>r===void 0?{output:t({renderContext:e,currentRendering:void 0,tickContext:n}),renderProps:ue}:"no-update",zt=t=>({renderContext:{general:{pixiRenderer:e},item:r},currentRendering:n})=>{if(n===void 0){const o=Ta(r),s={output:ws(e,t(r.config),o),renderProps:ue};return o&&(s.output.y-=((o.z??1)-1)*H.h),s}else return"no-update"},Te={x:12,y:12,z:H.h},iS={x:14,y:14,z:H.h},ar={x:16,y:16,z:H.h},si={...Te,z:H.h*2},ap=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:Te};case"slidingBlock":return t.config.style==="book"?{aabb:ar}:{aabb:Te};case"lift":return{aabb:{...Te,z:Te.z}};case"switch":return{aabb:{...Te,z:Te.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:Te};case"charles":return{aabb:si};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:ar};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:ar};case"tower":return{aabb:{x:11,y:11,z:H.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...Te,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:si};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:Te};case"turtle":return{aabb:Te};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:ar};case"bubbles":return{aabb:Te};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:ar};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:H.h}:{x:15,y:3,z:H.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:si}:{aabb:Te};case"emitter":return{aabb:le};default:return{aabb:iS}}},Ze={aabb:Te},aS=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,ii={x:1,y:0,z:0},ai={x:-1,y:0,z:0},li={x:0,y:-1,z:0},ci={x:0,y:1,z:0},qe={away:ci,left:ii,right:ai,towards:li,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:co(F(ci,ai)),towardsRight:co(F(li,ai)),towardsLeft:co(F(li,ii)),awayLeft:co(F(ci,ii))},fa=t=>{const e=ye(t.position),{aabb:r}=ap(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:F(e,{x:H.w-r.x>>1,y:H.d-r.y>>1})},$e=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:ke,stoodOnUntilRoomTime:ke}),ru=()=>({standingOnItemId:null,vels:{gravity:le,movingFloor:le},latentMovement:[],actedOnAt:{roomTime:ke,by:ue},collidedWith:{roomTime:ke,by:ue}}),lS=t=>{const e=rm.includes(t.type);return{...$e(),position:fa(t),...e?{standingOnItemId:null,vels:{gravity:le,movingFloor:le,...nm.includes(t.type)?{sliding:le}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:le}:{}},latentMovement:[],actedOnAt:{roomTime:ke,by:ue},collidedWith:{roomTime:ke,by:ue}}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:qe[t.config.startDirection]}:{facing:qe.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:qe[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:le}}:{},...t.type==="charles"?{facing:qe.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:ke,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?ss(qe[t.config.direction],op.firedDoughnut):le}}:{}}},ui=H.h*2,lp=4,Rn=H.h*lp,cS=2,uS=2*H.w;function*dS(t,e){const{config:{direction:r},position:n}=t,o=Zn(r),s=hn(o),i=aS(t),a={...le,[s]:i?-.5:0},l=1,c={[s]:i?-1:0},u=l*H.w,d={...le,[s]:u},f=9,p=8,y=8;{const m={[o]:p,[s]:y,z:Rn};yield{...t,...Ze,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"far"},state:{...$e(),position:ye(F(n,{[o]:1.5},a,c)),stoodOnBy:ue},aabb:F(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}{const m={[o]:f,[s]:y,z:Rn};yield{...t,...Ze,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"near"},state:{...$e(),position:ye(F(n,a,c)),stoodOnBy:ue},aabb:F(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}{const m={[o]:2*H.w-f-p,[s]:y,z:Rn-ui};yield{...t,...Ze,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"top"},state:{...$e(),position:F(ye(F(n,a,c)),{[o]:f,z:ui}),stoodOnBy:ue},aabb:F(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}yield{...t,...Ze,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...$e(),position:F(ye(F(n,a)),{z:Rn}),stoodOnBy:ue},aabb:ye({[o]:2,[s]:.5,z:so-lp-n.z}),renderAabb:le,fixedZIndex:cr},yield{...t,...Ze,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...t.config,inHidden:i,relativePoint:ye({...le,[s]:i?.25:-.25}),direction:qe[r]},fixedZIndex:cr,state:{...$e(),position:F(ye(F(n,{[s]:i?-.5:.5})),{[o]:f}),stoodOnBy:ue},aabb:{[o]:cS*H.w-f-p,[s]:0,z:ui}},n.z!==0&&(yield{...t,...Ze,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:i,style:"none",side:"away",height:n.z},renders:!0,shadowCastTexture:i?{textureId:"shadow.door.floatingThreshold.double.y",flipX:o==="x"}:void 0,state:{...$e(),position:{...ye(F(n,a,c)),z:0}},aabb:F(ye({[o]:2,[s]:.5,z:n.z}),d),renderAabb:i?F(ye({[o]:2,[s]:.5,z:.5})):void 0,renderAabbOffset:i?F({[o]:0,[s]:0,z:(n.z-.5)*H.h},{[s]:d[s]}):void 0,shadowOffset:{z:n.z*H.h,[s]:i?d[s]:void 0}}),yield{type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:ye({[o]:2,[s]:0,z:2}),config:{},fixedZIndex:cr,state:{...$e(),position:ye(id(n,ss(qe[r],.75))),stoodOnBy:ue}}}const nu={config:ue,shadowCastTexture:"shadow.smallRound",aabb:Te},ou=()=>{const t=_g(B.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:qe.towards,walkStartFacing:qe.towards,walkDistance:0,vels:{walking:le,gravity:le,movingFloor:le},switchedToAt:ke,lastDiedAt:ke,gameTime:0,jumpStartTime:ke,lives:t?"infinite":tS,jumpStartZ:0}},hS=(t,e)=>{const r=xg(B.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...Ze,...nu,state:{...$e(),...ru(),...ou(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:ke,shieldCollectedAt:ke,doughnuts:r?"infinite":0,position:fa(t),stoodOnUntilRoomTime:ke}}:{id:e,jsonItemId:e,type:"heels",...Ze,...nu,state:{...$e(),...ru(),...ou(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:ke,position:fa(t),stoodOnUntilRoomTime:ke}}},cp=1,fS=(t=so)=>({x:H.w,y:H.d*cp,z:t*H.h}),pS={x:H.w,y:0,z:sp},gS=(t=so)=>({x:H.w*cp,y:H.d,z:t*H.h}),mS={x:0,y:H.d,z:sp},yS=(t,e,r)=>{const{config:{direction:n},position:o}=e,s=Ra(e.config),{size:{z:i}}=r,a=Zn(n),l=hn(a),c=n==="towards"||n==="right",u={...le,[l]:c?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Fn(a==="y"?gS(i):fS(i),s),renderAabb:c?le:Fn(a==="y"?mS:pS,s),fixedZIndex:c?cr:void 0,state:{...$e(),position:ye(F(o,u)),stoodOnBy:ue},shadowCastTexture:a==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0}}},vS=3,su=10,iu=.52,au=.5,wS=(t,e,r)=>{const{config:{times:n},position:o}=e,s=F(o,{z:-3}),i={...n,z:vS};let a=s,l=i;const c=Tt(qo(r.items)).filter(f=>f.type==="door");if(o.z===0){const f={};for(const p of c){const{position:y,config:{direction:m}}=p;switch(m){case"towards":!f.towards&&y.y===s.y&&(l=F(l,{y:au}),a=F(a,{y:-.5}),f.towards=!0);break;case"away":!f.away&&y.y===s.y+n.y&&(l=F(l,{y:iu}),f.away=!0);break;case"right":!f.right&&y.x===s.x&&(l=F(l,{x:au}),a=F(a,{x:-.5}),f.right=!0);break;case"left":!f.left&&y.x===s.x+n.x&&(l=F(l,{x:iu}),f.left=!0);break}}}const u=ye(a),d=Fn(ar,l);return{type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Fn(ar,i),position:ye(s)}},aabb:d,renderAabb:{...d,z:su},renderAabbOffset:{...le,z:d.z-su},shadowCastTexture:"shadow.fullBlock",state:{...$e(),position:u}}};function*cl(t,e,r,n=ue,o={}){if(!n[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&o[e.config.page]))switch(e.type){case"door":return yield*dS(e,t);case"player":{yield hS(e,t);return}case"wall":{yield yS(t,e,r);return}case"floor":{yield wS(t,e,r);return}case"sceneryCrown":if(!B.getState().gameMenus.planetsLiberated[e.config.planet])return;default:{const s=ap(e),i=e.config.times!==void 0?{aabb:Fn(s.aabb,e.config.times),renderAabb:void 0}:s;let a;try{a=lS(e)}catch(l){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:l})}yield{...e,...Ze,...i,id:t,jsonItemId:t,fixedZIndex:e.type==="emitter"?cr:void 0,shadowCastTexture:bS(e),config:e.config,state:a}}}}const bS=t=>{switch(t.type){case"lift":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Wt(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};function*xS(t){const e=t.size.z??so,r=ye({...t.size,z:1}),n=ye({...ur,z:-1});if(t.roomBelow!==void 0&&(yield{...Ze,type:"portal",id:"floor/portal",fixedZIndex:cr,config:{toRoom:t.roomBelow,relativePoint:{x:r.x/2,y:r.y/2,z:r.z},direction:qe.down},aabb:r,state:{...$e(),position:n},renders:!1}),t.roomAbove!==void 0){const o=F(n,{z:H.h*e});yield{...Ze,type:"portal",id:"ceiling",fixedZIndex:cr,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?ye(t.ceilingRelativePoint):{x:r.x/2,y:r.y/2},z:-12},direction:qe.up},aabb:r,state:{...$e(),position:o}}}}const _S=(t,e,r,n)=>{const o=Math.max(0,Math.min(t.x+e.x,r.x+n.x)-Math.max(t.x,r.x)),s=Math.max(0,Math.min(t.y+e.y,r.y+n.y)-Math.max(t.y,r.y));return o*s},lu=({state:{position:t},aabb:e},{state:{position:r},aabb:n})=>_S(t,e,r,n),cu={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},SS=(t,e)=>cu[t.type]-cu[e.type],kS=(t,e,r=.001)=>{if(!Un(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:n}}}}=t;return n>0?!1:vs({state:{position:F(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+ad},id:t.id},{state:{position:F(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},CS=(t,e)=>{const n=[...Tt(e).filter(s=>kS(t,s))];return n.length===0?void 0:n.reduce((s,i)=>{const a=SS(i,s);return a<0||a===0&&lu(t,i)>lu(t,s)?i:s})},PS=({above:t,below:e})=>{t.state.standingOnItemId=e.id,e.state.stoodOnBy[t.id]=!0};function*ES(t,e,r,n){const o=kg(t.items);for(const[s,i]of o)i.type==="player"&&!n||(yield*cl(s,i,t,e,r))}const uu=t=>Tt(t).reduce((e,r)=>({...e,[r.id]:r}),{}),di=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:n=!1})=>{const o={...uu(xS(t)),...uu(ES(t,e,r,n))};for(const i of lt(o)){const l=Q_(i,Sg(o)).find(c=>Un(i)&&Un(c)&&!(i.type==="wall"&&c.type==="wall"));l!==void 0&&console.error(`in room ${t.id} item ${i.id} @${JSON.stringify(i.state.position)} #${JSON.stringify(i.aabb)} is colliding with (solid item) ${l.id} @${JSON.stringify(l.state.position)} #${JSON.stringify(l.aabb)} on loading room ${t.id}`)}for(const i of lt(o).filter(om)){const a=CS(i,lt(o).filter(l=>l.id!==i.id));a!==void 0&&PS({above:i,below:a})}return{...t,roomJson:t,items:o,roomTime:0}},io=(t,e)=>Tt(is(t)).map(r=>{const n=e.items[r];if(n===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return n});Qn("head");const TS=Qn("heels"),RS=Qn("headOverHeels"),AS=t=>{if(TS(t))return t.state;if(RS(t))return t.state.heels},OS=1e3/25,up=t=>{const e=br.animations[t],r=e.length,{animationSpeed:n}=e;return r*OS/n};up("bubbles.white");up("head.fadeOut");const ul=({config:{activatedOnStoreValue:t}})=>t===void 0?!0:_a(B.getState(),t),IS=({renderContext:{general:{pixiRenderer:t},item:e,room:r},currentRendering:n})=>{const{state:{stoodOnBy:o},config:{times:s}}=e,i=n?.renderProps,a=ul(e),l=a&&io(o,r).find(Aa)!==void 0;return i===void 0||a!==i.activated||l!==i.flashing?{output:ws(t,{textureId:l?"shadowMask.teleporter.flashing":a?"shadowMask.teleporter":"shadowMask.fullBlock"},s),renderProps:{flashing:l,activated:a}}:"no-update"},hi=(t,e=1)=>({renderContext:{item:{state:{facing:r}}},currentRendering:n})=>{const o=n?.renderProps,s=Sa(r)??"towards";if(!(o===void 0||s!==o.facingXy4))return"no-update";const a=U(s==="left"||s==="away"?`shadowMask.${t}.away`:`shadowMask.${t}.right`);return a.y=-(H.h*(e-1)),a.scale.x=s==="away"||s==="right"?1:-1,{output:a,renderProps:{facingXy4:s}}},du={lift:We("shadowMask.smallBlock"),conveyor:zt(({direction:t})=>({textureId:"shadowMask.conveyor",flipX:Wt(t)==="x"})),doorLegs:zt(({direction:t})=>({textureId:t==="right"||t==="towards"?"shadowMask.door.floatingThreshold.double.y":"shadowMask.door.legs.threshold.double.y",flipX:Wt(t)==="y"})),teleporter:IS,floor:"no-mask",barrier:zt(({axis:t})=>({textureId:"shadowMask.barrier.y",flipX:t==="x"})),spring:We("shadowMask.smallRound"),block:zt(({style:t})=>t==="tower"?"shadowMask.tower":"shadowMask.fullBlock"),pushableBlock:We("shadowMask.stepStool"),movingPlatform:We("shadowMask.fullBlock"),hushPuppy:We("shadowMask.hushPuppy"),portableBlock:zt(({style:t})=>t==="drum"?"shadowMask.smallRound":"shadowMask.smallBlock"),slidingBlock:zt(({style:t})=>t==="book"?"shadowMask.fullBlock":"shadowMask.smallRound"),deadlyBlock:zt(({style:t})=>t==="volcano"?"shadowMask.volcano":"shadowMask.toaster"),spikes:We("shadowMask.spikes"),switch:We("shadowMask.switch"),pickup:zt(({gives:t})=>{switch(t){case"scroll":return"shadowMask.scroll";case"doughnuts":return"shadowMask.doughnuts";case"fast":case"extra-life":case"jumps":case"shield":return"shadowMask.whiteRabbit";default:return"blank"}}),slidingDeadly:We("shadowMask.smallRound"),ball:We("shadowMask.ball"),"monster.dalek":We("shadowMask.dalek"),"monster.turtle":hi("turtle"),"monster.skiHead":hi("skiHead"),"monster.homingBot":We("shadowMask.smallRound"),joystick:We("shadowMask.joystick"),charles:hi("charles",2)},jS=t=>{switch(t.type){case"monster":return du[`monster.${t.config.which}`];case"floor":return t.config.floorType==="none"?void 0:"no-mask";default:return du[t.type]}},$S=new Bm({alpha:1-zn});class zS{constructor(e,r){if(this.renderContext=e,this.#e.filters=$S,r!=="no-mask")if(this.#r=new rp(e,r),e.item.shadowOffset===void 0)this.#e.addChild(this.#r.output);else{const n=new te({label:"shadowMaskOffset",...Z(e.item.shadowOffset),children:[this.#r.output]});this.#e.addChild(n)}this.#e.addChild(this.#t)}#e=new te({label:"ItemShadowRenderer"});#t=new te({label:"shadows"});#r;#n={};get#o(){return B.getState().gameMenus.userSettings.displaySettings.showShadowMasks}#s(e){if(this.#r===void 0)return;const r=this.#r.output.children.at(0);this.#r.tick(e);const n=this.#r.output.children.at(0);if(n===void 0||!(n instanceof un)){const{item:o}=this.renderContext;throw new Error(`ItemShadowRenderer: this.#shadowMaskRenderer didn't create a sprite for item "${o.id}" of type "${o.type}". Have got ${n}`)}r!==n&&(this.#o?this.renderContext.frontLayer.attach(n):this.#e.mask=n)}destroy(){this.#e.destroy(!0),this.#r?.destroy()}tick(e){if(this.#t.parent===null)throw new Error("shadow container not in scene graph");const{movedItems:r,progression:n}=e,{item:o,general:{pixiRenderer:s},room:i}=this.renderContext,a=r.has(o),l=o.state.position.z+o.aabb.z,c=lt(i.items).filter(function(y){return y.shadowCastTexture!==void 0}),u={id:o.id,state:{position:{...o.state.position,z:l}},aabb:{...o.aabb,z:eS}},d=Object.groupBy(c,p=>{const y=this.#n[p.id]!==void 0,m=r.has(p);return!a&&!m?y?"keepUnchanged":"noShadow":vs(u,p)?y?"update":"create":"noShadow"});for(const p of jl(d.keepUnchanged,d.update))this.#n[p.id].renderedOnProgression=n;if(d.create)for(const p of d.create){const{times:y}=p.config,m=ws(s,p.shadowCastTexture,y);m.label=p.id,this.#t.addChild(m),this.#n[p.id]={sprite:m,renderedOnProgression:n}}for(const p of jl(d.create,d.update)){const{sprite:y}=this.#n[p.id],m=Z({...jn(hr(p.state.position,o.state.position),p.shadowOffset??ur),z:o.aabb.z});y.x=m.x,y.y=m.y}for(const[p,{sprite:y,renderedOnProgression:m}]of ld(this.#n))m!==n&&(y.destroy(),delete this.#n[p]);const f=(d.keepUnchanged?.length??0)+(d.update?.length??0)+(d.create?.length??0)>0;this.#e.visible=f,f&&this.#s(e)}get output(){return this.#e}}const NS=t=>{const e=jS(t.item);return e===void 0?void 0:new zS(t,e)};class LS{constructor(e,r){this.renderContext=e,this.componentRenderers=r,this.output={graphics:r.graphics?.output,sound:r.sound?.output}}output;tick(e){this.componentRenderers.graphics?.tick(e),this.componentRenderers.sound?.tick(e)}destroy(){this.componentRenderers.graphics?.destroy(),this.componentRenderers.sound?.destroy()}}const ae=new window.AudioContext,pa=()=>{throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`)},Ae=t=>{const e=typeof t=="string"?{soundId:t}:t,{playbackRate:r=1,soundId:n,connectTo:o,loop:s=!1,varyPlaybackRate:i=!1,randomiseStartPoint:a=!1}=e,l=ae.createBufferSource(),c=pa()[n];return l.buffer=c,l.loop=s,l.playbackRate.value=i?r-.05+Math.random()*.1:r,s&&a?l.start(0,c.duration*Math.random()):l.start(),o!==void 0&&l.connect(o),l},Br=(t,e,r)=>{const n=ae.createGain();return e!==void 0&&(n.gain.value=e),t.connect(n),n.connect(r),n},ze=({start:t,change:e,loop:r,stop:n,startAndLoopTogether:o=!1,noStartOnFirstFrame:s=!0},i)=>{let a=!0,l,c;return u=>{if(!!u!=!!c)u?t!==void 0&&!(a&&s)?(l?.stop(),l=Ae({...t}),Br(l,t.gain,i),r!==void 0&&(o?(l=Ae({...r,loop:!0}),Br(l,r.gain,i)):l.onended=()=>{c&&(l=Ae({...r,loop:!0}),Br(l,r.gain,i))})):r!==void 0&&(l=Ae({...r,loop:!0}),Br(l,r.gain,i)):(l&&l.loop&&(l.stop(),l.onended=null),n!==void 0&&(l=Ae({...n}),Br(l,n.gain,i)));else if(c!==u&&e!==void 0){const f=Ae({...e});Br(f,e.gain,i)}a=!1,c=u}};class DS{constructor(e){this.renderContext=e,this.output.gain.value=4}output=ae.createGain();#e=ze({loop:{soundId:"rollingBallLoop",playbackRate:.5}},this.output);tick(){const{renderContext:{item:{state:{vels:{sliding:e},standingOnItemId:r}}}}=this,n=(e.x!==0||e.y!==0)&&r!==null;this.#e(n)}destroy(){}}class MS{constructor(e){this.renderContext=e;const{item:{config:{was:r}}}=e;switch(r.type){case"pickup":{r.gives!=="scroll"&&Ae({soundId:"bonus",connectTo:this.output});break}case"disappearing":{Ae({soundId:"destroy",connectTo:this.output});break}case"hushPuppy":{this.output.gain.value=.5,Ae({soundId:"hushPuppyVanish",connectTo:this.output});break}}}output=ae.createGain();tick(){}destroy(){}}class dl{constructor(e,r,n=1){this.renderContext=e,this.#e=ze({start:r},this.output),this.output.gain.value=n}output=ae.createGain();#e;tick({lastRenderRoomTime:e}){const{renderContext:{item:r}}=this,{state:{collidedWith:{roomTime:n,by:o}}}=r,s=n>(e??ke)&&!Oa(is(o));this.#e(s)}destroy(){}}class BS{constructor(e){this.renderContext=e,this.#e.connect(this.output),this.#e.gain.value=.5,this.#r=new dl(e,{soundId:"metalHit"},.3),this.#r.output.connect(this.output)}output=ae.createGain();#e=ae.createGain();#t=ze({start:{soundId:"servoStart",playbackRate:.5},loop:{soundId:"servoLoop",playbackRate:.5},stop:{soundId:"servoStop",playbackRate:.5}},this.#e);#r;tick(e){const{renderContext:{item:r,room:{roomTime:n,items:o}}}=this,{state:{actedOnAt:{roomTime:s,by:i}}}=r,a=n===s&&Tt(is(i)).some(l=>vd(o[l]));this.#t(a),this.#r.tick(e)}destroy(){}}const ao=t=>{for(const e in t)return!0;return!1},fi=2;class FS{constructor(e){this.renderContext=e}output=ae.createGain();#e=ze({start:{soundId:"conveyorStart",playbackRate:fi},loop:{soundId:"conveyorLoop",playbackRate:fi},stop:{soundId:"conveyorEnd",playbackRate:fi}},this.output);tick(){const{renderContext:{item:{state:{stoodOnBy:e}}}}=this,r=ao(e);this.#e(r)}destroy(){this.#e(!1)}}const US=3;class HS{constructor(e){this.renderContext=e,this.output.gain.value=.7}output=ae.createGain();#e=Ae({soundId:"helicopter",loop:!0,connectTo:this.output});tick(){const{renderContext:{item:{state:{vels:{lift:{z:e}}}}}}=this;this.#e.playbackRate.value=Math.max(.5,1+US*e)}destroy(){}}const hu={skiHead:{soundId:"softBump"},turtle:{soundId:"softBump"},dalek:{soundId:"metalHit"},homingBot:{soundId:"metalHit"},computerBot:{soundId:"metalHit"}},fu={cyberman:{soundId:"jetpackTurnaround",gain:1.2},dalek:{soundId:"mojoTurn",gain:.3}},pu={cyberman:{soundId:"jetpackLoop",gain:.7},emperorsGuardian:{soundId:"jetpackLoop"},dalek:{soundId:"mojoLoop"},bubbleRobot:{soundId:"bubbleRobotLoop"},helicopterBug:{soundId:"helicopter"}},gu={homingBot:{start:{soundId:"detect"},loop:{soundId:"robotWhirLoop",gain:4},startAndLoopTogether:!0},computerBot:{loop:{soundId:"robotBeepingLoop",randomiseStartPoint:!0,varyPlaybackRate:!0}}};class WS{constructor(e){this.renderContext=e,this.#e.connect(this.output),this.#t.connect(this.output),this.#t.gain.value=.66;const{item:{config:{which:r}}}=e;hu[r]!==void 0&&(this.#o=new dl(e,hu[r]),this.#o.output.connect(this.output)),fu[r]!==void 0&&(this.#r=ze({change:fu[r]},this.#e)),gu[r]!==void 0&&(this.#s=ze(gu[r],this.#e)),pu[r]!==void 0&&(this.#n=ze({loop:pu[r]},this.#t))}output=ae.createGain();#e=ae.createGain();#t=ae.createGain();#r;#n;#o;#s;tick(e){const{renderContext:{item:r}}=this,{state:{facing:n,activated:o,busyLickingDoughnutsOffFace:s,vels:{walking:i}}}=r;if(this.#r){const a=cd(n);this.#r(a)}if(this.#o&&this.#o.tick(e),this.#n){const a=o&&!s;this.#n(a)}if(this.#s){const a=!$n(i,le);this.#s(a)}}destroy(){}}class pi{constructor(e){this.renderContext=e;const{general:{soundSettings:r},item:{type:n}}=e,{noFootsteps:o}={...ka.soundSettings,...r};o||(this.#e=ae.createGain(),this.#e.gain.value=2,this.#e.connect(this.output),this.#t=ze({loop:{soundId:`${n==="headOverHeels"?"heels":n}Walk`}},this.#e)),this.#r.gain.value=.8,this.#r.connect(this.output),this.#i.gain.value=1.2,this.#i.connect(this.output),this.#s.connect(this.output),this.#n=ze({start:{soundId:`${n==="headOverHeels"?"head":n}Jump`}},this.#r),this.#o=ze({loop:{soundId:`${n==="headOverHeels"?"head":n}Fall`}},this.#r)}output=ae.createGain();#e;#t;#r=ae.createGain();#n;#o;#s=ae.createGain();#l=ze({start:{soundId:"landing"},noStartOnFirstFrame:!0},this.#s);#i=ae.createGain();#c=ze({start:{soundId:"carry",playbackRate:.95},stop:{soundId:"carry",playbackRate:1.05}},this.#i);#a={teleportingPhase:null,positionZ:0};tick({lastRenderRoomTime:e}){const{renderContext:{item:r}}=this,{state:{action:n,teleporting:o,jumpStartZ:s,jumped:i,standingOnItemId:a,position:{z:l},vels:{gravity:{z:c}},collidedWith:{roomTime:u,by:d}}}=r,f=AS(r),{teleportingPhase:p,positionZ:y}=this.#a,m=o?o.phase:null,v=i&&l>s&&l>y&&c>0,w=l<y&&c<0&&a===null;this.#o(w),this.#n(v),this.#t!==void 0&&this.#t(!v&&!w&&n==="moving"),f!==void 0&&this.#c(f.carrying!==null);const S=a!==null&&u>(e??ke)&&d[a];if(this.#l(S),m!==null&&m!==p)if(m==="in"){const b=pa().teleportIn,x=ae.createBufferSource();x.buffer=b,x.connect(this.output),x.start()}else{const b=pa().teleportOut,x=ae.createBufferSource();x.buffer=b,x.connect(this.output),x.start()}this.#a={teleportingPhase:m,positionZ:l}}destroy(){}}class GS{constructor(e){this.renderContext=e}output=ae.createGain();#e=void 0;tick(){const{renderContext:{item:{state:{stoodOnBy:e},config:{style:r}}}}=this;if(r!=="drum")return;const n=this.#e?.stoodOn??!1,o=ao(e);!n&&o&&Ae({soundId:"drum",connectTo:this.output}),this.#e={stoodOn:o}}destroy(){}}class qS{constructor(e){this.renderContext=e,this.scrapeBracketed=ze({loop:{soundId:"stepStoolScraping"}},this.output),this.output.gain.value=.4}output=ae.createGain();scrapeBracketed;tick({movedItems:e}){const{renderContext:{item:r,room:{roomTime:n}}}=this,{state:{actedOnAt:{roomTime:o},standingOnItemId:s}}=r,i=n===o&&s!==null&&e.has(r);this.scrapeBracketed(i)}destroy(){}}class VS{constructor(e){this.renderContext=e}output=ae.createGain();tick({lastRenderRoomTime:e}){const{renderContext:{item:{state:{stoodOnBy:r,stoodOnUntilRoomTime:n}}}}=this,o=ao(r);e!==void 0&&n>e&&!o&&Ae({soundId:"springBoing",connectTo:this.output})}destroy(){}}class XS{constructor(e){this.renderContext=e,this.#e.connect(this.output)}output=ae.createGain();#e=ae.createGain();#t=void 0;tick(){const{renderContext:{item:{state:{setting:e},config:r}}}=this,n=r.type==="in-store"?_a(B.getState(),r.path)?"right":"left":e,o=this.#t?.setting;o!==void 0&&o!==n&&Ae({soundId:"switchClick",playbackRate:n==="right"?.95:1.05,connectTo:this.#e}),this.#t={setting:n}}destroy(){}}class KS{constructor(e){this.renderContext=e}output=ae.createGain();#e=ze({loop:{soundId:"teleportWarningSiren"}},this.output);tick(){const{renderContext:{item:e,room:r}}=this;this.#e(ul(e)&&io(e.state.stoodOnBy,r).some(Aa))}destroy(){}}class JS{constructor(e){this.renderContext=e,Ae({soundId:"hooter",connectTo:this.output})}output=ae.createGain();tick(){}destroy(){}}class YS extends dl{constructor(e){super(e,{soundId:"glassClink",varyPlaybackRate:!0},.8),this.renderContext=e}}const ZS=(t,e)=>kd(io(t.state.stoodOnBy,e).filter(wd));class QS{constructor(e){this.renderContext=e,this.output.gain.value=2}output=ae.createGain();#e=void 0;tick(e){const{renderContext:{item:r,room:n}}=this,o=ZS(r,n);this.#e!==void 0&&o<this.#e&&Ae({soundId:"toasterPopUpSoundUrl",connectTo:this.output}),this.#e=o}destroy(){}}const ek={lift:HS,switch:XS,bubbles:MS,head:pi,heels:pi,headOverHeels:pi,teleporter:KS,monster:WS,conveyor:FS,spring:VS,portableBlock:GS,charles:BS,ball:DS,pushableBlock:qS,firedDoughnut:JS,slidingBlock:YS},tk=t=>{if(t.item.type==="deadlyBlock"&&t.item.config.style==="toaster")return new QS(t);const e=ek[t.item.type];if(e)return new e(t)},mu=H.h*so,yu=H.h*-1,rk=H.w*16,nk=0,gi=(t,e,r)=>(t-e)/(r-e)*2-1;class ok{constructor(e,r){this.renderContext=e,this.childRenderer=r,r.output.connect(this.output),this.output.rolloffFactor=2,this.output.maxDistance=5,this.output.distanceModel="exponential";const{room:{size:{y:n,x:o}}}=e;this.positionMinX=ni(ye({x:0,y:n})),this.positionMaxX=ni(ye({x:o,y:0}))}output=ae.createPanner();positionMinX;positionMaxX;tick(e){this.childRenderer.tick(e);const{item:r}=this.renderContext,n=r.state,o=F(n.position,ss(r.aabb,.5)),s=gi(ni(o),this.positionMaxX,this.positionMinX),i=gi(o.z,yu,mu);if(!Number.isFinite(i))throw new Error(`y position for sound rendering is not finite;
        positionY = numberInRangeToMinus1To1Range(
          itemCentrePosition = ${o.z},
          ${yu},
          ${mu},
        );
        itemCentrePosition = addXyz(
          itemState.position = ${JSON.stringify(n.position)},
          scaleXyz(${JSON.stringify(r.aabb)}, 0.5),
        )`);const a=gi(o.x+o.y,nk,rk);this.output.positionX.value=s,this.output.positionY.value=i,this.output.positionZ.value=a}destroy(){this.childRenderer.destroy()}}const Cr=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,sk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColour;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    // we know c.a is either 0 or 1, so no need to do a step()

    finalColor = mix(c, vec4(uColour, 1), c.a);
}
`;class rs extends Jt{constructor(e){const r=Et.from({vertex:Cr,fragment:sk,name:"oneColour-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uColour:{value:new Float32Array(3),type:"vec3<f32>"}}}});const n=this.resources.colorReplaceUniforms.uniforms,[o,s,i]=e.toArray();n.uColour[0]=o,n.uColour[1]=s,n.uColour[2]=i}}const ik={pureBlack:new V("#000000"),shadow:new V("#1B2D3B"),midGrey:new V("#505A55"),lightGrey:new V("#929981"),white:new V("#F8FEF8"),pastelBlue:new V("#4893FF"),metallicBlue:new V("#1D4E80"),pink:new V("#B973AF"),moss:new V("#6E7B00"),redShadow:new V("#513D40"),midRed:new V("#A7574B"),lightBeige:new V("#BF8E69"),highlightBeige:new V("#DBB269"),alpha:new V("#105A69"),replaceLight:new V("#048662"),replaceDark:new V("#052229")},ak=`#version 300 es
// keep this one at mediump for the hash function's precision
precision mediump float;

in vec2 vTextureCoord;
out vec4 finalColor;

const float LUT_SIZE = 256.0;
const float magicNumber = 31.0; // Small prime number

uniform sampler2D uTexture;
uniform sampler2D uLut;

/** returns in [0, LUT_SIZE] range
this must match the TypeScript version of the hash function*/
float hashColor(vec3 color) {
    vec3 c255 = floor(color * 255.0);
    
    float hash = mod(
        c255.r + c255.g * magicNumber + c255.b * magicNumber * magicNumber, 
        LUT_SIZE
    );
    return hash;
}

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    float h = hashColor(c.rgb);

    // use the hash to look up the replacement in the LUT:
    vec4 replacementColour = texture(
        uLut, 
        vec2(
            // normalise h to [0, 1] range
            (h + 0.5) / LUT_SIZE, 
            0.5
        )
    );
    
    // use original if either: 
    //      original alpha is 0 (because keep transparent)
    //      or lut alpha is 0 (signals nothing in this slot of the LUT)
    finalColor = mix(c, replacementColour, c.a * replacementColour.a);
}
`,An=256,mi=31;function lk(t){const e=Math.floor(t.red*255),r=Math.floor(t.green*255),n=Math.floor(t.blue*255);return(e+r*mi+n*mi*mi)%An}function ck(t){const e=new Float32Array(An*4);for(const[o,s]of Cg(t)){const i=z[o],a=lk(i);if(e[a*4+3]>.5)throw new Error("LUT collision - mess with the hash function or lut size until this goes away");e[a*4+0]=s.red,e[a*4+1]=s.green,e[a*4+2]=s.blue,e[a*4+3]=1}const r=new Uint8Array(An*4);for(let o=0;o<An*4;o++)r[o]=Math.floor(e[o]*255);return _t.from({resource:r,width:An,height:1,scaleMode:"nearest"})}class Zt extends Jt{#e;constructor(e){const r=Object.keys(e).length,n=Et.from({vertex:Cr,fragment:ak,name:"palette-swop-filter"}),o=ck(e);super({glProgram:n,resources:{colorReplaceUniforms:{uOriginal:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uReplacement:{value:new Float32Array(3*r),type:"vec3<f32>",size:r}},uLut:o.source}}),this.#e=o;const s=this.resources.colorReplaceUniforms.uniforms;Object.entries(e).forEach(([i,a],l)=>{z[i].toArray().forEach((c,u)=>{s.uOriginal[l*3+u]=c}),a.toArray().forEach((c,u)=>{s.uReplacement[l*3+u]=c})})}destroy(e){this.#e?.destroy(!0),this.#e=null,super.destroy(e)}}const uk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uTargetColor;

vec4 black = vec4(0.0, 0.0, 0.0, 1.0);

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    // 1 if black, 0 if non-black
    float isBlack = step(length(c.rgb), 0.01);

    // keep original if either:
    //      * black
    //      * transparent

    finalColor = mix(    
        vec4(uTargetColor, 1),    
        c, 
        max(isBlack, 1.0 - c.a)
    );
}
`;class Ne extends Jt{uniforms;constructor(e="white"){const r=Et.from({vertex:Cr,fragment:uk,name:"revert-colourise-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"}}}}),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this.targetColor=e}set targetColor(e){const[r,n,o]=new V(e).toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}}const dk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    finalColor = vec4(c.rgb * 0.5, c.a);
}
`;class hk extends Jt{constructor(){const e=Et.from({vertex:Cr,fragment:dk,name:"halfbrite-filter"});super({glProgram:e,resources:{}})}}const dp=({basic:t,dimmed:e})=>({replaceLight:t,replaceDark:e}),hp=({color:{hue:t,shade:e},planet:r})=>{const n=t==="yellow"?e==="dimmed"||r==="jail"?Pf:Ke:gs[t][e].main;return dp(n)},fk=t=>new Zt({lightBeige:z.lightGrey,redShadow:z.shadow,pink:z.lightGrey,moss:z.lightGrey,midRed:z.midGrey,highlightBeige:z.lightGrey,...t&&hp(t)}),pk=new Zt({midGrey:z.midRed,lightGrey:z.lightBeige,white:z.highlightBeige,metallicBlue:z.redShadow,pink:z.midRed,moss:z.midRed,replaceDark:z.midRed,replaceLight:z.lightBeige}),vu=(t,e)=>{const r=Qo(t.color).edges[e],n=r.original;return r.dimInOriginal?Cf(n):n},fp=(t,e,r)=>r?new Zt(dp(gs[t.color.hue][t.color.shade].edges[e])):new Ne(Qo(t.color).edges[e].original),ft=t=>new Zt(hp(t)),gk=t=>{switch(t.color.hue){case"white":return new Zt({replaceLight:z.lightGrey,replaceDark:z.midGrey});default:return ft(t)}},pp=t=>{switch(t.color.hue){case"white":return new Zt({replaceLight:z.lightBeige,replaceDark:z.midRed,shadow:z.redShadow});case"yellow":return ft({planet:t.planet,color:{hue:"yellow",shade:"dimmed"}});default:return ft(t)}};new hk;const Qt=od,mk=new Zt(ik),yk=[new rs(z.midRed)],vk=[new rs(z.moss)],wk=75;class bk{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output)}output=new te({label:"ItemFlashOnSwitchedRenderer"});tick(e){const{renderContext:{item:{state:{switchedAtRoomTime:r,switchedSetting:n}},room:{roomTime:o}}}=this;this.output.filters=o-r<wk?n==="left"?vk:yk:Qt,this.childRenderer.tick(e)}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const xk=(t,e,r)=>{const o=Ht().textures[`door.frame.${t.planet}.${e}.near`]!==void 0?t.planet:"generic",s=t.color.shade==="dimmed"&&Ht().textures[`door.frame.${o}.dark.${e}.${r}`]!==void 0;return`door.frame.${o}${s?".dark":""}.${e}.${r}`};function bs(t,e){const r=e||new te;for(const n of t)r.addChild(n);return r}function*_k({config:{direction:t,inHiddenWall:e,height:r}},n){const o=Zn(t),s=o==="y"?1:16;function*i(a){if(e){if(r!==0){const l=U({textureId:`generic.door.floatingThreshold.${o}`,...jn(a,{y:-12*r})});l.filters=fp(n,o==="x"?"towards":"right",!0),yield l}}else{yield U({pivot:{x:s,y:9},textureId:`generic.door.legs.base.${o}`,...jn(a,{})});for(let l=1;l<r;l++)yield U({pivot:{x:s,y:9},textureId:`generic.door.legs.pillar.${o}`,...jn(a,{y:-l*H.h})})}}yield*i(vr({...ur,[o]:1})),yield*i(ur),e||(yield U({pivot:{x:16,y:H.h*r+13},textureId:`generic.door.legs.threshold.double.${o}`,...vr({...ur,[o]:1})}))}const gp=(t,e)=>{const r=Zn(t),n=hn(r),o=8;return t==="towards"||t==="right"?Z({[n]:e[n]-o}):ur},Sk=Re(({renderContext:{item:t,room:e}})=>bs(_k(t,e),new te({filters:ft(e),...gp(t.config.direction,t.aabb)}))),kk=Re(({renderContext:{item:{config:{direction:t,part:e,toRoom:r},aabb:n},room:o,general:{gameState:s}}})=>{const i=Zn(t),a=s===void 0?o:s.campaign.rooms[r];return U({textureId:xk(o,i,e),filter:ft(a),...gp(t,n)})}),yi={animationId:"bubbles.cold"},Jr=({top:t,bottom:e="headlessBase",filter:r})=>{const n=new te({filters:r}),o=U(e);n.addChild(o);const s=U(t);return s.y=-12,n.addChild(s),n[xs]=s,n[hl]=o,n},xs=Symbol(),hl=Symbol(),Ck=({top:t,bottom:e})=>{const r=new te;return r.addChild(e),t.y=-12,r.addChild(t),r[xs]=t,r[hl]=e,r},Pk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform vec2 uTextureSize;
uniform sampler2D uTexture;
uniform vec3 uOutline;
uniform float uOutlineWidth;

void main(void) {
    vec2 scaledTexelSize = vec2(1.0f) / vec2(textureSize(uTexture, 0)) * uOutlineWidth;    
    
    // Calculate offset coordinates
    vec2 rightCoord = vec2(vTextureCoord.x + scaledTexelSize.x, vTextureCoord.y);
    vec2 leftCoord = vec2(vTextureCoord.x - scaledTexelSize.x, vTextureCoord.y);
    vec2 belowCoord = vec2(vTextureCoord.x, vTextureCoord.y + scaledTexelSize.y);
    vec2 aboveCoord = vec2(vTextureCoord.x, vTextureCoord.y - scaledTexelSize.y);
    
    // Create boundary masks (1.0 if within bounds, 0.0 if out of bounds)
    // seems to work fine without this, but could multiply colourToX by this to get zero'd out when OOB
    // float rightInBounds = step(rightCoord.x, 1.0);
    // float leftInBounds = step(0.0, leftCoord.x);
    // float belowInBounds = step(belowCoord.y, 1.0);
    // float aboveInBounds = step(0.0, aboveCoord.y);
    
    vec4 colourToRight = texture(uTexture, rightCoord);
    vec4 colourToLeft = texture(uTexture, leftCoord);
    vec4 colourBelow = texture(uTexture, belowCoord);
    vec4 colourAbove = texture(uTexture, aboveCoord);
    
    // Check if any neighbor is opaque (combine all alpha values)
    float hasOpaqueNeighbor = max(max(colourToRight.a, colourToLeft.a), 
                                  max(colourBelow.a, colourAbove.a));

    vec4 originalColour = texture(uTexture, vTextureCoord);
        
    finalColor = mix(
        originalColour, 
        vec4(uOutline, 1), 
        // 1 if: original colour is transparent and has an opaque neighbour - use outline colour
        // 0 if: original colour is opaque or has no opaque neighbour - use original colour (transparent or sprite)
        (1.0 - originalColour.a) * hasOpaqueNeighbor
    );
}
`;class Pt extends Jt{constructor({outlineColor:e,upscale:r,lowRes:n}){const o=Et.from({vertex:Cr,fragment:Pk,name:"outline-filter"});super({glProgram:o,padding:r,resources:{colorReplaceUniforms:{uOutline:{value:new Float32Array(3),type:"vec3<f32>"},uOutlineWidth:{value:new Float32Array(1),type:"f32"}}}});const s=this.resources.colorReplaceUniforms.uniforms,[i,a,l]=e.toArray();s.uOutline[0]=i,s.uOutline[1]=a,s.uOutline[2]=l,s.uOutlineWidth[0]=r,n&&(this.resolution=1/r,this.padding=r,s.uOutlineWidth[0]=1)}}const Ek=t=>{const{gameTime:e,lastDiedAt:r}=t.type==="headOverHeels"?t.state.head:t.state;return e-r<nS},vi=t=>{if(t===void 0)return 0;const{shieldCollectedAt:e,gameTime:r}=t;return e!==null&&e+Zc>r?100-Math.ceil((r-e)/(Zc/100)):0},Tk=t=>t.type==="headOverHeels"?vi(t.state.head)>0||vi(t.state.heels)>0:vi(t.state)>0,_s=t=>t,ga=.02,Rk=({name:t,action:e,facingXy8:r,teleportingPhase:n,gravityZ:o,paused:s})=>{if(e==="death")return{animationId:`${t}.fadeOut`,paused:s};if(n==="out")return{animationId:`${t}.fadeOut`,paused:s};if(n==="in")return{animationId:`${t}.fadeOut`,paused:s};if(e==="moving")return{animationId:`${t}.walking.${r}`,paused:s};if(e==="jumping")return{textureId:o<ga?`${t}.walking.${r}.2`:`${t}.walking.${r}.1`};if(e==="falling"){const a=`${t}.falling.${r}`;if(Vo(a))return{textureId:a}}const i=`${t}.idle.${r}`;return qd(i)?{animationId:i,paused:s}:{textureId:`${t}.walking.${r}.2`}},ma=Symbol(),ya=Symbol(),Ak=(t,e)=>{t[ma].removeChildren(),t[ma].addChild(U(Rk(e)))},mp=new Zt({pastelBlue:z.pink}),wi=(t,e,r)=>{const n=new te,o=new te;n[ma]=o,n.addChild(o);const s=U({animationId:e?`shine.${t}InSymbio`:"shine",paused:r,filter:t==="heels"?mp:Qt,flipX:t==="heels"});return n[ya]=s,n},wu=({gameTime:t,switchedToAt:e},r,n)=>(r==="headOverHeels"||r===n)&&e+rS>t,Ok=t=>{if(!Ek(t))return!1;const{gameTime:e,lastDiedAt:r}=t.type==="headOverHeels"?t.state.head:t.state;return(e-r)%Qc<Qc*oS},bu=(t,e)=>{t.filters?Array.isArray(t.filters)?t.filters=[...t.filters,e]:t.filters=[t.filters,e].flat():t.filters=e},xu=(t,e)=>{t.filters=Array.isArray(t.filters)?t.filters.filter(r=>!(r instanceof e)):t.filters instanceof e?Qt:[...t.filters]},Ik=(t,{highlighted:e,flashing:r},n,o)=>{const s=n?.highlighted??!1;e&&!s?bu(o,new Pt({outlineColor:Kr[t],upscale:xr(B.getState()),lowRes:!1})):!e&&s&&xu(o,Pt);const i=n?.flashing??!1;r&&!i?bu(o,new rs(Kr[t])):!r&&i&&xu(o,rs)},jk=(t,e,r)=>{e&&!r?t.addChild(t[ya]):!e&&r&&t.removeChild(t[ya])},bi=(t,e,r,n,o,s)=>{r&&Ak(e,{name:t,...n,paused:o}),Ik(t,n,s,e),jk(e,n.shining,s?.shining??!1)},$k=({renderContext:{item:t,general:{gameState:e,paused:r}},currentRendering:n})=>{const{type:o,state:{action:s,facing:i,teleporting:a,vels:{gravity:{z:l}}}}=t,c=n?.renderProps,u=n?.output,d=cd(i)??"towards",f=e!==void 0&&(t.type==="headOverHeels"?wu(t.state.head,"headOverHeels","headOverHeels"):wu(t.state,t.type,e.currentCharacterName)),p=Ok(t),y=Tk(t),m=Ca(i),v=a?.phase??null,w={action:s,facingXy8:d,teleportingPhase:v,flashing:p,highlighted:f,shining:y,gravityZ:l},S=c===void 0||c.action!==s||c.facingXy8!==d||c.teleportingPhase!==v||c?.gravityZ>ga!=l>ga;let b;if(o==="headOverHeels"){b=u??Ck({top:wi("head",!0,r),bottom:wi("heels",!0,r)});const x=b;bi("head",x[xs],S,w,r,c),bi("heels",x[hl],S,w,r,c)}else b=u??wi(o,!1,r),bi(o,b,S,w,r,c);return s==="moving"&&u instanceof Hn&&(u.animationSpeed=m*Pg),{output:b,renderProps:w}},xi=_s($k),_u=t=>t-Math.floor(t),zk=({state:{position:t}},e)=>{const r=o=>o.config.direction==="away"||o.config.direction==="left";return bs(lt(e.items).filter(o=>o.type==="wall"||o.type==="doorLegs").filter(r).map(o=>{const{id:s,config:{direction:i},state:{position:a}}=o;return U({textureId:"floorOverdraw.cornerNearWall",label:s,...Z(id(a,t)),times:o.type==="wall"?Ra(o.config):{[hn(Wt(i))]:2},anchor:{x:0,y:1},flipX:i==="away"})}),new te({label:"floorOverdraws"}))},Nk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColour;

void main(void) {
    finalColor = texture(uTexture, vTextureCoord);
}
`;class Lk extends Jt{constructor(){const e=Et.from({vertex:Cr,fragment:Nk,name:"null-filter"});super({glProgram:e,resources:{}})}}const Dk=`#version 300 es
precision lowp float;

out vec4 finalColor;

in vec2 vTextureCoord;
uniform sampler2D uBackBuffer;
uniform vec3 uTargetColor;
// do not use uTexture in this frag - for some reason it causes pixi's render pipeline
// to take away the backbuffer, which we rely on sampling from

void main() {
    vec3 bg = texture(uBackBuffer, vTextureCoord).rgb;

    float isBlack = step(length(bg), 0.001f); // 1 if black, 0 otherwise
    finalColor = mix(vec4(uTargetColor, 1.0f), vec4(0, 0, 0, 0), isBlack);


}`;class Su extends Jt{uniforms;constructor(e="white"){const r=Et.from({vertex:Cr,fragment:Dk,name:"colour-clash-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"}}},blendRequired:!0}),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this.targetColor=e}set targetColor(e){const[r,n,o]=new V(e).toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}}const ku=({colourised:t,direction:e,room:r,times:n,position:o,colourSwap:s})=>U({label:`floorEdge(${e})`,textureId:`floorEdge.${e}`,times:n,filter:s?fp(r,e,t):void 0,...Z(o)}),Mk=({room:t,xSize:e,ySize:r,y:n})=>{const o=new te({label:"floorColourClash"}),s=vu(t,"right");for(let a=0;a<=r;a++){const l=vr({x:0,y:a,z:0}),c=new ct().rect(l.x-(a===0?0:8),l.y,8*3,8).fill(s);c.filters=new Su(s),o.addChild(c)}const i=vu(t,"towards");for(let a=0;a<=e;a++){const l=vr({x:a,y:0,z:0}),c=new ct().rect(l.x-16,l.y,8*(a===0?2:3),8).fill(i);c.filters=new Su(i),o.addChild(c)}return o.y=n,o},Bk=Re(({renderContext:{room:t,item:e,general:{colourised:r},colourClashLayer:n}})=>{const{color:{shade:o}}=t,{config:s,state:{position:i},aabb:a}=e,{floorType:l,naturalFootprint:c}=s,u=new te({label:"floorAppearance"}),d=Z({...a,y:0}),f=Z({...a,x:0,y:0}),p=Z({...a,x:0}),y=Z(a);if(l!=="none"){const m=new te({label:"tiles"}),v=l==="deadly"?`generic${o==="dimmed"?".dark":""}.floor.deadly`:`${s.scenery}${o==="dimmed"?".dark":""}.floor`,w=Ht().textures[v];try{Gd(v)}catch(I){throw new Error(`no floor textureId for floorType: ${l}, shade: ${o}`,{cause:I})}const S=hr(c.position,i),b={x:_u(S.x/H.w),y:_u(S.y/H.w)},x=8,k={x:d.x,y:y.y-x,width:p.x-d.x,height:f.y-y.y+2*x},C=hr(vr(jn(b,{x:.5,y:.5})),{y:a.z},k),_=new Um({texture:w,tilePosition:C,...k});m.addChild(_),m.addChild(zk(e,t));const j=new ct().moveTo(y.x,y.y).lineTo(p.x,p.y).lineTo(p.x,p.y+3).lineTo(f.x,f.y+3).lineTo(d.x,d.y+3).lineTo(d.x,d.y).fill({color:16711680,alpha:.5});m.addChild(j),m.mask=j,m.filters=[gk(t)];const D=new te({children:[m]});D.filters=new Pt({outlineColor:z.pureBlack,upscale:1,lowRes:!1});const N=new te({children:[D]}),W=new Lk;W.enabled=!1,N.filters=W,N.cacheAsTexture(!0),u.addChild(N),u.addChild(U({textureId:"blank",x:p.x,y:f.y+8}))}{const m=new te({label:"edges"});l==="none"&&m.addChild(new ct().moveTo(p.x,p.y+8).lineTo(p.x,p.y+100).lineTo(d.x,d.y+100).lineTo(d.x,d.y+8).lineTo(f.x,f.y+8).fill(0));const v=Math.ceil(a.y/H.w);m.addChild(ku({colourised:r,direction:"right",room:t,times:{y:v},position:{z:a.z},colourSwap:r}));const w=Math.ceil(a.x/H.w);if(m.addChild(ku({colourised:r,direction:"towards",room:t,times:{x:w},position:{z:a.z},colourSwap:r})),u.addChild(m),!r){const S=Mk({xSize:w,ySize:v,y:-a.z+1,room:t});u.addChild(S),n.attach(S)}}return u}),Fk=["cyberman","dalek","skiHead","bubbleRobot","computerBot","turtle"],Uk=t=>{let e=2166136261;const r=t.length;for(let n=Math.max(0,r-9);n<r;n++)e^=t.charCodeAt(n),e=Math.imul(e,1540483477),e^=e>>>15;return(e>>>0)/4294967295},Hk=200,Wk=1,Gk=(t,e)=>{const r=Uk(e);return Math.sin((t+r*2e4)/Hk)*Wk},Cu=({id:t,config:{which:e},state:r},n,o)=>{if((e==="cyberman"||e==="bubbleRobot")&&r.activated||e==="emperorsGuardian"){const s=o;s[xs].y=-12+Gk(n.roomTime,t)}},qk=({renderContext:{item:t,room:e,general:{paused:r}},currentRendering:n})=>{const{config:o,state:s}=t,i=n?.renderProps,{activated:a,busyLickingDoughnutsOffFace:l}=s,c=l?pk:a?void 0:Fk.includes(o.which)?fk(e):void 0;switch(o.which){case"skiHead":case"turtle":case"cyberman":case"computerBot":case"elephant":case"elephantHead":case"monkey":{const u=Sa(s.facing)??"towards";if(!(i===void 0||a!==i.activated||l!==i.busyLickingDoughnutsOffFace||u!==i.facingXy4))return Cu(t,e,n.output),"no-update";const f={facingXy4:u,activated:a,busyLickingDoughnutsOffFace:l};switch(o.which){case"skiHead":return{output:U({textureId:`${o.which}.${o.style}.${u}`,filter:c}),renderProps:f};case"elephantHead":return{output:U({textureId:`elephant.${u}`,filter:c}),renderProps:f};case"turtle":return{output:U(a&&!l?{animationId:`${o.which}.${u}`,filter:c,paused:r}:{textureId:`${o.which}.${u}.1`,filter:c}),renderProps:f};case"cyberman":return{output:s.activated||s.busyLickingDoughnutsOffFace?Jr({top:{textureId:`${o.which}.${u}`,filter:c||ft(e)},bottom:{...yi,paused:r}}):U({textureId:`${o.which}.${u}`,filter:c}),renderProps:f};case"computerBot":case"elephant":case"monkey":return{output:Jr({top:`${o.which}.${u}`,bottom:{animationId:"headlessBase.flash",playOnce:"and-stop"},filter:c}),renderProps:f};default:throw new Error(`unexpected monster ${o}`)}break}case"homingBot":{const u=!Eg(s.vels.walking,ur);return i===void 0||l!==i.busyLickingDoughnutsOffFace||a!==i.activated||u!==i.walking?{filter:c,output:U({animationId:u?"headlessBase.flash":"headlessBase.scan",filter:c}),renderProps:{activated:a,busyLickingDoughnutsOffFace:l,walking:u}}:"no-update"}case"helicopterBug":case"emperor":case"dalek":case"bubbleRobot":case"emperorsGuardian":{if(!(i===void 0||l!==i.busyLickingDoughnutsOffFace||a!==i.activated))return Cu(t,e,n.output),"no-update";const d={activated:a,busyLickingDoughnutsOffFace:l};switch(o.which){case"helicopterBug":case"dalek":return{output:U(a&&!l?{animationId:o.which,filter:c,paused:r}:{textureId:`${o.which}.1`,filter:c}),renderProps:d};case"bubbleRobot":return{output:Jr({top:{...yi,paused:r},filter:c}),renderProps:d};case"emperorsGuardian":return{output:Jr({top:"ball",bottom:{...yi,paused:r},filter:c}),renderProps:d};case"emperor":return{output:U({animationId:"bubbles.cold",filter:c,paused:r}),renderProps:d};default:throw new Error(`unexpected monster ${o}`)}break}default:throw new Error(`unexpected monster ${o}`)}},Ao=new Pt({outlineColor:z.pureBlack,upscale:xr(B.getState()),lowRes:!0});new Ne;new Ne;new Ne;new Ne(z.moss);new Ne;new Ne(Kr.head),new Ne(sn(Kr.head)),new Ne(Kr.heels),new Ne(sn(Kr.heels));function*Vk(t){const e=typeof t=="string"?t==="infinite"?"":t:t.toString(),r=kd(e);let n=0;for(const o of e){const s=`hud.char.${Qu(o)}`;try{Gd(s)}catch(i){throw new Error(`no texture id for char "${o}": ${i.message}`,{cause:i})}yield U({textureId:s,x:(n+.5-r/2)*Tg.w}),n++}}const yp=(t,e)=>{t.removeChildren();try{bs(Vk(e),t)}catch(r){throw console.error("invalid string is",e,"and on window as window.invalid"),console.error(r),window.invalid=e,new Error(`could not show text "${e}" in container because: "${r.message}"`,{cause:r})}return t},Xk=op.floatingText,Kk=12,Pu=H.h*3,Eu=[z.shadow,z.midGrey,z.redShadow,z.metallicBlue,z.midRed,z.moss,z.pink,z.lightBeige,z.pastelBlue,z.lightGrey,z.highlightBeige],Tu=[...Eu,...new Array(20).fill(z.white),...Eu.toReversed()],Jk=({renderContext:{item:{config:{textLines:t,appearanceRoomTime:e}},room:{roomTime:r},general:{displaySettings:{uncolourised:n}},frontLayer:o},currentRendering:s})=>{const i=s?.output;let a;const c=(r-e)*Xk;if(i===void 0){a=new te({filters:new Pt({outlineColor:z.pureBlack,upscale:xr(B.getState()),lowRes:!1})}),o?.attach(a);for(let u=0;u<t.length;u++){const d=t[u],f=yp(new te({label:d,y:u*Kk,filters:n?Qt:new Ne(z.pink)}),d.toUpperCase());a.addChild(f)}}else a=i;for(let u=0;u<t.length;u++){const d=a.children[u],[f]=d.filters,p=c+u*-12,y=p>0&&p<Pu;if(d.visible=y,y&&f){const m=Math.floor(p/Pu*Tu.length);f.targetColor=Tu[m]}}return a.y=-c,{output:a,renderProps:ue}},Ru=500,Yk=br.animations["conveyor.x"].animationSpeed,Au=br.animations["conveyor.x"].length,Zk=t=>1-(1-t)**2,Qk=(t,e)=>{for(let r=0;r<t.children.length;r++){const n=t.children[r],o=r%Au;n.gotoAndStop(e?Au-o-1:o)}return t},eC=({renderContext:{item:{config:{direction:t,times:e},state:{stoodOnBy:r}},room:{roomTime:n}},currentRendering:o})=>{const s=o?.renderProps,i=ao(r),a=(!i&&s?.moving?n:s?.roomTimeStoppedMoving)??ke,l=Wt(t),c=o?.output??Qk(U({animationId:`conveyor.${l}`,reverse:t==="towards"||t==="right",times:e}),t==="towards"||t==="right"),u=i?0:Math.min(n-a,Ru),d=Math.max(0,1-u/Ru);for(const f of c.children)if(d===0)f.stop();else{const p=Yk*Zk(d);f.play(),f.animationSpeed=p}return{output:c,renderProps:{moving:i,roomTimeStoppedMoving:a}}},tC=_s(eC),rC=({renderContext:{item:t,room:e,general:{paused:r}},currentRendering:n})=>{const{state:{stoodOnBy:o},config:{times:s}}=t,i=n?.renderProps,a=ul(t),l=a&&io(o,e).some(Aa);return i===void 0||a!==i.activated||l!==i.flashing?{output:l?new te({children:[U({textureId:"teleporter",times:s}),U({animationId:"teleporter.flashing",times:s,paused:r})]}):U({textureId:a?"teleporter":"block.artificial",times:s}),renderProps:{flashing:l,activated:a}}:"no-update"},nC=({renderContext:{item:{state:{facing:t,actedOnAt:{roomTime:e,by:r}}},room:{roomTime:n,items:o}},currentRendering:s})=>{const i=s?.renderProps,a=Sa(t)??"towards",l=n===e&&Tt(is(r)).some(u=>vd(o[u]));return i===void 0||a!==i.facingXy4||l!==i.controlledByJoystick?{output:Jr({top:`charles.${a}`,bottom:l?"headlessBase.all":"headlessBase"}),renderProps:{facingXy4:a,controlledByJoystick:l}}:"no-update"},oC=({renderContext:{item:{state:{stoodOnBy:t,stoodOnUntilRoomTime:e}},general:{paused:r}},tickContext:{lastRenderRoomTime:n},currentRendering:o})=>{const s=o?.renderProps,i=ao(t);let a;return o?.output?a=o?.output:(a=U({animationId:"spring.bounce"}),a.loop=!1,a.gotoAndStop(0)),n!==void 0&&e>n&&!i&&!r?a.gotoAndPlay(0):i&&!(s?.compressed??!1)&&a.gotoAndStop(1),{output:a,renderProps:{compressed:i}}},sC=_s(oC),iC=({renderContext:{item:{config:{which:t,startDirection:e}}},currentRendering:r})=>r?.renderProps===void 0?{output:t==="headOverHeels"?Jr({top:{textureId:`head.walking.${e}.2`},bottom:{textureId:`heels.walking.${e}.2`}}):U({textureId:`${t}.walking.${e}.2`}),renderProps:ue}:"no-update",aC=({renderContext:{item:{state:{vels:{sliding:t}},config:{startingPhase:e}},general:{paused:r}},tickContext:{deltaMS:n},currentRendering:o})=>{const i=(o?.renderProps?.distanceTravelled??0)+Pa(t)*(r?0:n),l=o?.output??U("spikyBall.1"),u=(Math.floor(i*2/Io.w)+e)%2+1;return l.texture=Ht().textures[`spikyBall.${u}`],{output:l,renderProps:{distanceTravelled:i}}},lC=_s(aC),cC=(t,e,r,n)=>`${t}${n?".dark":""}.wall.${e}.${r}`,uC=Re(({renderContext:{item:{id:t,config:e},room:r}})=>{if(e.direction==="right"||e.direction==="towards")throw new Error(`wall is near: ${t}`);const{direction:n,tiles:o}=e,s=hn(Wt(n)),i=new te({label:"wallTiles"});for(let a=0;a<e.tiles.length;a++){let l=U({textureId:cC(r.planet,o[a],n,r.color.shade==="dimmed"),y:1,pivot:n==="away"?{x:Io.w,y:Io.h+1}:{x:0,y:Io.h+1}});const c=vr({[s]:a});if(r.planet==="moonbase"){const u=`moonbase.wall.screen.${o[a]}.away`;qd(u)&&(l=new te({children:[l]}),l.addChild(U({animationId:u,randomiseStartFrame:!0,flipX:n==="left",x:n==="away"?-8:8,y:-23})))}l.x+=c.x,l.y+=c.y,i.addChild(l),i.filters=ft(r)}return i}),dC=({renderContext:{item:{state:{setting:t},config:e}},currentRendering:r})=>{const n=r?.renderProps,o=e.type==="in-store"?_a(B.getState(),e.path)?"right":"left":t;return n===void 0||o!==n.setting?{output:U(`switch.${o}`),renderProps:{setting:o}}:"no-update"},hC=(t,e,r)=>e==="tower"?"tower":e==="book"?"book.x":e==="organic"&&t?`block.organic.dark${r?".disappearing":""}`:`block.${e}${r?".disappearing":""}`,fC=({renderContext:{item:{config:{style:t,times:e},state:{disappearing:r}},room:n},currentRendering:o})=>{const s=o?.renderProps,i=r!==null;return s===void 0||s.isDissapearing!==i?{output:U({textureId:hC(n.color.shade==="dimmed",t,i),filter:t==="organic"?ft(n):t==="book"?pp(n):void 0,times:e}),renderProps:{isDissapearing:i}}:"no-update"},pC=({state:{stoodOnBy:t,position:e},config:{times:r}},n)=>{const o=new Array(r?.x??1).fill(null).map(()=>new Array(r?.y??1));return io(t,n).filter(wd).forEach(({id:s,state:{position:i}})=>{const a=hr(i,e),l={x:Math.floor(a.x/H.w),y:Math.floor(a.y/H.d)};l.x<0||l.x>=(r?.x??1)||l.y<0||l.y>=(r?.y??1)||(o[l.x][l.y]=s)}),o},gC=(t,e)=>{let r=0,n=1;for(const o of e)for(const s of o)s!==void 0&&t.items[s]?.state.activated&&(r|=n),n<<=1;return r},mC=({renderContext:{item:t,room:e},currentRendering:r})=>{const{config:{times:n}}=t,o=r===void 0?pC(t,e):r.renderProps.chargePositions,s=gC(e,o);return s!==r?.renderProps.cybermanActivationBitmask?{output:U({textureIdCallback(a,l){const c=o[a][l];return c===void 0||e.items[c]?.state.everActivated?"toaster.off":"toaster.on"},times:n??ue}),renderProps:{chargePositions:o,cybermanActivationBitmask:s}}:"no-update"},yC={head:xi,heels:xi,headOverHeels:xi,doorFrame:kk,doorLegs:Sk,monster:qk,floatingText:Jk,barrier:Re(({renderContext:{item:{config:{axis:t,times:e}}}})=>U({textureId:`barrier.${t}`,times:e})),deadlyBlock:Re(({renderContext:{item:{config:t},room:e}})=>{switch(t.style){case"volcano":return U({animationId:"volcano",filter:ft(e),times:t.times,randomiseStartFrame:!0});case"toaster":throw new Error("use the special toaster appearance instead");default:throw t.style,new Error("unknown deadly block style")}}),spikes:$t("spikes"),slidingDeadly:lC,slidingBlock:Re(({renderContext:{item:{config:{style:t}},room:e}})=>U(t==="book"?{textureId:"book.y",filter:pp(e)}:t)),block:fC,switch:dC,conveyor:tC,lift:Re(({renderContext:{general:{paused:t}}})=>{const e=new te,r={x:xl.w/2,y:xl.h};return e.addChild(U({animationId:"lift",pivot:r,paused:t})),e.addChild(U({textureId:"lift.static",pivot:r})),e}),teleporter:rC,sceneryCrown:Re(({renderContext:{item:{config:{planet:t}}}})=>U({textureId:`crown.${t}`})),pickup:Re(({renderContext:{item:{config:t},room:e,general:{paused:r}}})=>{if(t.gives==="crown")return U({textureId:`crown.${t.planet}`});const o={shield:"whiteRabbit",jumps:"whiteRabbit",fast:"whiteRabbit","extra-life":"whiteRabbit",bag:"bag",doughnuts:"doughnuts",hooter:"hooter",scroll:{textureId:"scroll",filter:ft(e)},reincarnation:{animationId:"fish",paused:r}}[t.gives];return U(o)}),moveableDeadly:$t("fish.1"),charles:nC,joystick:$t("joystick"),movingPlatform:$t("sandwich"),pushableBlock:$t("stepStool"),portableBlock:Re(({renderContext:{item:{config:{style:t}}}})=>U(t)),spring:sC,sceneryPlayer:iC,hushPuppy:$t("hushPuppy"),bubbles:Re(({renderContext:{item:{config:{style:t}},general:{paused:e}}})=>U({animationId:`bubbles.${t}`,paused:e})),firedDoughnut:$t({animationId:"bubbles.doughnut"}),ball:$t("ball"),floor:Bk,particle:Re(({renderContext:{item:{config:{forCharacter:t}}}})=>U({animationId:"particle.fade",anchor:{x:.5,y:.5},filter:t==="heels"?mp:Qt}))},vC=t=>{if(t.type==="wall"){const{direction:e}=t.config;return e==="right"||e==="towards"?void 0:uC}return t.type==="deadlyBlock"&&t.config.style==="toaster"?mC:yC[t.type]},wC=z.moss,bC=()=>new Pt({outlineColor:wC,lowRes:!1,upscale:xr(B.getState())});class xC{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output)}output=new te({label:"PortableItemPickUpNextHighlightRenderer"});#e=!1;tick(e){const{wouldPickUpNext:r}=this.renderContext.item.state;r!==!this.#e&&(this.output.filters=r?[bC()]:Qt),this.#e=r,this.childRenderer.tick(e)}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const _C=(t,e,r)=>sm(t)?new xC(e,r):r,SC=z.pastelBlue,kC=z.highlightBeige,CC=z.midRed,Ou=new Pt({outlineColor:kC,upscale:xr(B.getState()),lowRes:!1}),Iu=new Pt({outlineColor:CC,upscale:xr(B.getState()),lowRes:!1}),ju=new Ne(SC),$u={left:"",away:"",right:"",towards:""};class PC{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output),this.#e()}output=new te({label:"EditorAnnotationsRenderer"});#e(){const e=this.renderContext.item;switch(e.type){case"pickup":if(e.config.gives==="shield"||e.config.gives==="extra-life"||e.config.gives==="jumps"||e.config.gives==="fast"){const r={shield:"",jumps:"",fast:"","extra-life":"+2"};this.#t({annotationText:r[e.config.gives],yAdj:-16})}break;case"doorFrame":if(e.config.part==="near"){const{rooms:r}=B.getState().levelEditor.campaignInProgress,{config:{toRoom:n,direction:o}}=e,s=!!r[n],i=n.toUpperCase(),a=$u[o],l=o==="away"||o==="right"?`${i}${a}`:`${a}${i}`;this.#t({annotationText:l,yAdj:o==="left"||o==="away"?-48:0,error:!s,clickDispatch:s?()=>$i(n):void 0})}break;case"teleporter":{const{rooms:r}=B.getState().levelEditor.campaignInProgress,{config:{toRoom:n}}=e,o=!!r[n];this.#t({annotationText:`${n.toUpperCase()}`,yAdj:-12,error:!o,clickDispatch:o?()=>$i(n):void 0})}break;case"conveyor":{const{config:{direction:r}}=e,n=$u[r];this.#t({annotationText:n,yAdj:-12})}break}}#t({annotationText:e,yAdj:r=0,error:n=!1,clickDispatch:o}){const{renderContext:{frontLayer:s}}=this,i=new Ne(n?z.midRed:z.white),a=yp(new te({label:"EditorAnnotationTextContainer",filters:[i,new Pt({lowRes:!0,outlineColor:z.pureBlack,upscale:xr(B.getState())})]}),e);a.y=r,o!==void 0&&(a.eventMode="static",a.on("click",()=>{B.dispatch(o())}),a.on("mouseover",()=>{B.getState().levelEditor.tool.type==="pointer"&&(B.dispatch(Sl(!0)),i.targetColor=z.pastelBlue)}),a.on("mouseout",()=>{B.dispatch(Sl(!1)),i.targetColor=z.white}),a.cursor="pointer"),this.output.addChild(a),s.attach(a)}tick(e){this.#r(),this.childRenderer.tick(e)}#r(){const{renderContext:{item:e}}=this,{clickableAnnotationHovered:r}=B.getState().levelEditor,{jsonItemId:n}=e,o=B.getState(),s=bd(o),i=im(o),a=lr(o),l=n&&s?.jsonItemId===n&&!r,c=n&&i.includes(n);this.output.filters=l&&c?[ju,a.type==="eyeDropper"?Iu:Ou]:l?a.type==="eyeDropper"?Iu:Ou:c?ju:Qt}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const EC=(t,e,r)=>e.general.editor?new PC(e,r):r,TC=(t,e)=>{e!==void 0&&B.getState().gameMenus.cheatsOn&&(e.eventMode="static",e.on("pointertap",()=>{B.dispatch(Og({item:t}))}))},RC=t=>{const e=B.getState(),r=Rg(e),n=!Ag(e),{item:o}=t,s=r==="all"||r==="non-wall"&&t.item.type!=="wall",i=[],a=vC(o);if(a!==void 0){const f=new rp(t,a),p=new bk(t,f);i.push(EC(o,t,_C(o,t,p)))}if(n){const f=NS(t);f!==void 0&&i.push(f)}s&&i.push(new Y_(t));let l;if(i.length===0)l=void 0;else{const f=i.length===1?i[0]:new AC(i,t);TC(o,f.output),l=new Z_(t,f)}const c=t.general.soundSettings.mute??ka.soundSettings.mute,u=t.general.paused||c?void 0:tk(t),d=u===void 0?void 0:new ok(t,u);return new LS(t,{graphics:l,sound:d})};class AC{constructor(e,r){this.renderContext=r,this.#e=e,this.#t.addChild(...e.map(n=>n.output))}#e;#t=new te({label:"CompositeRenderer"});tick(e){for(const r of this.#e)r.tick(e)}destroy(){for(const e of this.#e)e.destroy()}get output(){return this.#t}}const OC=Qn("wall","doorFrame"),zu=256;function*IC(t){const{left:e,right:r}=lt(t.items).filter(OC).reduce((n,{aabb:o,renderAabb:s,renderAabbOffset:i,state:{position:a}})=>{const l=s??o,c=F(a,i??le),u=Z(F(c,{x:l.x})).x,d=Z(F(c,{y:l.y})).x;return{left:Math.min(n.left,u),right:Math.max(n.right,d)}},{left:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY});e!==Number.POSITIVE_INFINITY&&(yield new ct().rect(e-100,-256,100,zu).fill(0)),r!==Number.NEGATIVE_INFINITY&&(yield new ct().rect(r,-256,100,zu).fill(0))}class jC{constructor(e){this.renderContext=e;const{general:{colourised:r,soundSettings:n},room:o}=e;this.initFilters(r,e.room.color);const i=n.mute??ka.soundSettings.mute?void 0:ae.createGain();bs(IC(o),this.#o),this.output={sound:i,graphics:new te({label:`RoomRenderer(${e.room.id})`})},this.output.graphics.addChild(this.#t),r||(this.#r=new Dl({sortableChildren:!1}),this.output.graphics.addChild(this.#r)),this.output.graphics.addChild(this.#o),this.output.graphics.addChild(this.#n)}#e=!1;#t=new te({label:"items"});#r;#n=new Dl({sortableChildren:!1});#o=new te({label:"occlusion"});output;#s=void 0;#l=new Map;#i=new Map;initFilters(e,r){this.#t.filters=e?r.shade==="dimmed"?mk:Qt:new Ne(r.shade==="dimmed"?Cf(Qo(r).main.original):Qo(r).main.original)}#c(e){const{room:r}=this.renderContext,n={...e,lastRenderRoomTime:this.#s};for(const s of lt(r.items)){let i=this.#i.get(s.id);if(i===void 0){i=RC({...this.renderContext,colourClashLayer:this.#r,frontLayer:this.#n,item:s}),this.#i.set(s.id,i);const{graphics:a,sound:l}=i.output;if(a&&(this.#t.addChild(a),s.fixedZIndex&&(a.zIndex=s.fixedZIndex)),l){if(!this.output.sound)throw new Error("item renderer has sound, but room renderer does not - this probably means that they disagree on if the user has sound muted");l.connect(this.output.sound)}}try{i.tick(n)}catch(a){throw new Error(`RoomRenderer caught error while ticking Renderer for item "${s.id}" - item in play object is:
           ${JSON.stringify(s,null,2)}`,{cause:a})}}let o=!1;for(const[s,i]of this.#i.entries())r.items[s]===void 0&&(i.destroy(),this.#i.delete(s),o=!0);o&&this.#a()}#a(){if(this.#r)for(const e of this.#r.renderLayerChildren)e.parent===null&&this.#r.detach(e);for(const e of this.#n.renderLayerChildren)e.parent===null&&this.#n.detach(e)}#d(e){const r=tp(this.renderContext.room.items,e.movedItems,this.#l),{order:n}=ll(r,this.renderContext.room.items);for(let o=0;o<n.length;o++){const s=this.#i.get(n[o]);if(s===void 0)throw new Error(`Item id=${n[o]} does not have a renderer - cannot assign a z-index`);const i=s.output.graphics;if(i)i.zIndex=n.length-o;else throw new Error(`order ${n[o]} was given a z-order by sorting, but item has no graphics`)}}get#u(){return this.#s!==void 0}tick(e){const r=this.#u?e:{...e,movedItems:new Set(lt(this.renderContext.room.items))};this.#c(r),(!this.#u||r.movedItems.size>0)&&this.#d(r),this.#s=this.renderContext.room.roomTime}destroy(){this.output.graphics.label=this.output.graphics.label+"DESTROYED",this.output.graphics.destroy({children:!0}),this.output.sound?.disconnect(),this.#i.forEach(e=>{e.destroy()}),this.#e=!0}get destroyed(){return this.#e}}const $C=t=>()=>_r(t),pE=$C(rn),zC=Sd([rn,t=>t.levelEditor.previewedEdits],(t,e)=>ud(t,r=>{const n=ld(e);for(const[o,s]of n)s===null?delete r.items[o]:r.items[o]=s})),fl=g.createContext(null),NC=()=>{const[t,e]=g.useState(()=>di({roomJson:rn(B.getState()),roomPickupsCollected:ue,scrollsRead:ue,isNewGame:!0})),[r,n]=g.useState(t),o=be(rn),s=be(zC);return g.useEffect(()=>{const i=di({roomJson:o,roomPickupsCollected:ue,scrollsRead:ue,isNewGame:!0});if(e(i),o===s)n(i);else{const a=di({roomJson:s,roomPickupsCollected:ue,scrollsRead:ue,isNewGame:!0});n(a)}},[o,s]),{roomState:t,roomStateWithPreviews:r}},LC=({children:t})=>{const e=NC();return h.jsx(fl,{value:e,children:t})},DC=()=>{const t=g.useContext(fl);if(t===null)throw new Error("no room state in context, or no context");return t.roomState},vp=()=>{const t=g.useContext(fl);if(t===null)throw new Error("no room state in context, or no context");return t.roomStateWithPreviews},MC=t=>{t.ticker.remove(t.render,t)},wp=g.createContext(null),BC=({children:t})=>{const[e,r]=g.useState(null);return g.useEffect(()=>{const n=new jd;return n.init({background:z.pureBlack,sharedTicker:!0}).then(()=>{MC(n),r(n)}),()=>{}},[]),e===null?null:h.jsx(wp,{value:e,children:t})},Pr=()=>g.useContext(wp),FC=(t,e)=>({displaySettings:{emulatedResolution:"amigaLowResPal",showBoundingBoxes:e},soundSettings:{mute:!0},pixiRenderer:t,gameState:void 0,paused:!1,colourised:!0,upscale:Ea(B.getState()),editor:!0}),Nu=(t,e,r)=>new jC({room:t,general:FC(e,r)}),UC=()=>{const{renderer:t}=Pr(),e=td();if(!t)throw new Error("this should never be falsey (typescript violation)");const r=vp(),[n,o]=g.useState(()=>Nu(r,t,e));return g.useEffect(()=>{const s=Nu(r,t,e);return o(s),()=>{s.destroy()}},[r,t,e]),n},Lu=(t,e,r)=>{const{world:{onItem:{face:n},position:o,itemId:s}}=t;if(n.z>ad)return Fo(o);if(r.type==="door"){const i=e.items[s];if(i.type!=="wall")return;const{config:a,aabb:l,state:{position:c}}=i,u=am(Ra(a)),d=hn(Wt(a.direction)),f=Wt(a.direction);if(u[d]<2)return;const p=c[d],y=c[d]+l[d]-uS,m=c.z,v=c.z+l.z-Rn,w={[d]:Math.max(Math.min(o[d],y),p),[f]:o[f],z:Math.max(Math.min(o.z,v),m)};return Fo(w)}return F(Fo(o),n)},HC={z:1,x:0,y:0},WC={z:0,x:0,y:-1},Du={z:0,x:-1,y:0},GC=(t,{x:e,y:r},n)=>{if(n.type==="item"&&n.item.type==="door"&&t.type==="wall"){const l=t.config.direction;return ss(qe[l],-1)}const{bottomCentre:o,topLeft:s,topRight:i}=cn(t.state.position,t.aabb);return r<s.y-(s.x-e)/2?r<i.y-(e-i.x)/2?HC:Du:e<o.x?WC:Du},qC=3,VC=(t,{x:e,y:r},n)=>{const o=cn(t.state.position,t.aabb);return Ig.find(s=>{const i=o.projectCorner(s);return Pa(hr(i,{x:e,y:r}))<qC})},Fr=3,_i=1.5;function yt({x:t,y:e},r,n){const o={x:t-r.x,y:e-r.y},s=o.x*n.y-o.y*n.x;return Math.abs(s)/Math.hypot(n.x,n.y)}const bp={point:{x:-1,y:-1,z:0},normal:{x:0,y:0,z:1}},xp={point:{x:-1,y:0,z:1},normal:{x:0,y:1,z:0}},_p={point:{x:0,y:-1,z:1},normal:{x:1,y:0,z:0}},Sp={point:{x:0,y:1,z:1},normal:{x:1,y:0,z:0}},kp={point:{x:1,y:0,z:1},normal:{x:0,y:1,z:0}},Cp={point:{x:1,y:-1,z:0},normal:{x:0,y:0,z:1}},Pp={point:{x:0,y:-1,z:-1},normal:{x:1,y:0,z:0}},Ep={point:{x:-1,y:1,z:0},normal:{x:0,y:0,z:1}},Tp={point:{x:-1,y:0,z:-1},normal:{x:0,y:1,z:0}},XC=(t,e,r,n)=>{const o=cn(t.state.position,t.aabb),s=r.x<0,i=r.y<0,a=r.z>0;if((s||i)&&yt(e,o.bottomCentre,{x:0,y:-1})<_i)return bp;if((s||a)&&yt(e,o.topRight,{x:2,y:-1})<_i)return xp;if((i||a)&&yt(e,o.topLeft,{x:2,y:1})<_i)return _p;switch(!0){case a:{const l=o.c111;if(yt(e,l,{x:2,y:1})<Fr)return Sp;if(yt(e,l,{x:-2,y:1})<Fr)return kp;break}case i:{const l=o.c100;if(yt(e,l,{x:0,y:-1})<Fr)return Cp;if(yt(e,l,{x:2,y:1})<Fr)return Pp;break}case s:{const l=o.c010;if(yt(e,l,{x:0,y:-1})<Fr)return Ep;if(yt(e,l,{x:-2,y:1})<Fr)return Tp;break}}},KC=({x:t,y:e},r)=>n=>{const{position:o,aabb:s}=JC(n,r),{bottomCentre:i,topLeft:a,topRight:l}=cn(o,s);return!(t<a.x||t>l.x||e<l.y-(l.x-t)/2||e<a.y-(t-a.x)/2||e>i.y-(t-i.x)/2||e>i.y-(i.x-t)/2)},JC=(t,e)=>e.type==="item"&&t.type==="wall"?{position:t.state.position,aabb:t.aabb}:{position:F(t.state.position,t.renderAabbOffset??le),aabb:t.renderAabb??t.aabb},Mu=t=>t.fixedZIndex!==void 0,YC=t=>{if(t.every(Mu))return t.toSorted((s,i)=>i.fixedZIndex-s.fixedZIndex).at(0);const e=t.filter(s=>!Mu(s));if(e.length===0)return;if(e.length===1)return e[0];const r=Object.fromEntries(e.map(s=>[s.id,s])),n=tp(r),{order:o}=ll(n,r);return r[o[0]]},Rp=(t,e,r,n)=>{const o=!n||r.type==="item"&&r.item.type==="door",s=o?H.w:H.w/2,i=H.h,a=o?0:s/2,l=i/2,c=sd(e);return{x:c==="yz"?Math.round(t.x/s)*s:Math.floor((t.x-a)/s)*s,y:c==="xz"?Math.round(t.y/s)*s:Math.floor((t.y-a)/s)*s,z:c==="xy"?Math.round(t.z/i)*i:Math.floor((t.z+l)/i)*i}},ZC=({state:{position:t},aabb:e},r,n,o,s)=>{const i={x:t.x+(r.x<0?0:e.x),y:t.y+(r.y<0?0:e.y),z:t.z+(r.z<0?0:e.z)},a=F_(i,r,n);return Rp(a,r,o,s)},QC=t=>e=>{const r=Un(e);return t.type==="item"&&t.item.type==="door"?r&&e.type==="wall":r},Si=(t,e,r,n)=>{const o=YC(Array.from(lt(e.items).filter(QC(r)).filter(KC(t,r)))),s=e.id;if(o){const i=GC(o,t,r);if(!(i.z>0&&!Object.isExtensible(o.state.stoodOnBy)))return{roomId:s,scrXy:t,world:{itemId:o.id,onItem:{face:i,corner:VC(o,t),edge:XC(o,t,i)},position:ZC(o,i,t,r,n)}}}return{roomId:s,scrXy:t,world:void 0}},eP=(t,e=console.error)=>(...r)=>{try{return t(...r)}catch(n){e(n);return}},tP=t=>{const e=t.key;(e==="Backspace"||e==="Delete")&&B.dispatch(hd()),(e==="z"||e==="Z")&&B.dispatch(t.shiftKey?pd():fd()),(e==="i"||e==="I"||e===",")&&B.dispatch(Gt({type:"eyeDropper"})),e==="Escape"&&B.dispatch(Gt({type:"pointer"}))},Ap=t=>Ca(pl(t))>0,pl=t=>{switch(t.type){case"deadlyBlock":return Ts;case"conveyor":if(t.config.disappearing)return le;switch(t.config.direction){case"left":case"right":return{x:1,y:0,z:0};case"away":case"towards":return{x:0,y:1,z:0};default:throw t.config.direction,new Error}case"hushPuppy":return Ts;case"teleporter":return{x:1,y:1,z:0};case"floor":case"spikes":return{x:1,y:1,z:0};case"block":return t.config.disappearing?le:Ts;case"barrier":if(t.config.disappearing)return le;switch(t.config.axis){case"x":return{x:1,y:0,z:1};case"y":return{x:0,y:1,z:1};default:throw t.config.axis,new Error}case"wall":switch(t.config.direction){case"left":case"right":return{x:0,y:1,z:1};case"away":case"towards":return{x:1,y:0,z:1};default:throw t.config,new Error}default:return le}},Op=t=>lt(t.items).filter(e=>Un(e)),rP=({roomState:t,jsonItemId:e,newBlockPosition:r,newTimes:n})=>{const o=Tt(Op(t)).filter(i=>i.id!==e);return cl("testItem",ud(t.roomJson.items[e],i=>{n&&(i.config.times=n),i.position=r}),t.roomJson).some(i=>{const a=np(i,o);return!Oa(a)})},nP=({roomState:t,blockPosition:e,itemTool:r})=>{const n=Tt(Op(t)),o=r.type==="door"?n.filter(i=>i.type!=="wall"):n;return cl("maybeAddedItem",{...r,position:e},t.roomJson).some(i=>{const a=np(i,o);return!Oa(a)})},Ip=(t,...e)=>({x:t(...e.map(r=>r.x)),y:t(...e.map(r=>r.y)),z:t(...e.map(r=>r.z))}),oP=t=>Ip(e=>e>0?e:e>-1?1:-e+1,t),sP=({jsonItem:t,blockDragAccVec:e,resizeEdgeDirection:r,startTimes:n,startPosition:o})=>{const s=dd(e,r,pl(t)),i=F(n,s),a=oP(i),l=Ip((c,u,d,f,p)=>{const y=u<1;return c<0!==y?y?d-p+1:d+f-p:y?d+f-1:d},r,i,o,n,a);return{newTimes:a,newPosition:l}},iP=5,ki=(t,e)=>{const r=t.cssUpscale*t.gameEngineUpscale;if(e.target===null)throw new Error("Mouse event target is null");const n=e.target.getBoundingClientRect(),o=e.clientX-n.left,s=e.clientY-n.top;return{x:o/r-t.gameEngineScreenSize.x/2,y:s/r-t.gameEngineScreenSize.y+16}},aP=(t,e)=>{const r=t.cssUpscale*t.gameEngineUpscale;if(e.target===null)throw new Error("Mouse event target is null");const n=e.movementX,o=e.movementY;return{x:n/r,y:o/r}},lP=(t,e,r)=>{const n=t.world?.onItem.edge,o=dd(n?.point??le,pl(r));return Ca(o)>0?n.normal:e?{x:1,y:0,z:0}:{x:0,y:0,z:1}},cP=(t,e,r,n,o,s)=>{if(t===void 0)return;const i=hr(e,t.scrXy),a=Pa(i);if(!(o||a>iP))return;const c=lP(t,n,s),u=Yf(c,r);return n?{x:0,y:0,z:u.z}:u},Bu=(t,e=!1)=>{const r=B.getState().levelEditor;return Rp(t,{x:0,y:0,z:1},r.tool,!e&&r.halfGridResolution)},Ci=(t,e)=>t.items[e]?.jsonItemId,uP=(t,e)=>e.jsonItemId&&t.levelEditor.selectedJsonItemIds.includes(e.jsonItemId),Ho=(t,e)=>e.levelEditor.wallsFloorsLocked&&(t.type==="wall"||t.type==="floor"),Pi=(t,e)=>{const r=B.getState();let n;if(e.world){const o=e.world.itemId,s=o&&t.items[o],i=Ho(s,r)?void 0:s.jsonItemId;n=i===void 0?void 0:{jsonItemId:i,pointingAtOnItem:e.world.onItem}}else n=void 0;Ge(bd(r),n)||B.dispatch(xd(n))},dP=t=>{const e=Pr(),r=_r(Ea),n=pt(),o=DC(),s=g.useRef(void 0),i=g.useRef(void 0),a=g.useRef(void 0),l=g.useRef(void 0),c=g.useRef(!0);g.useEffect(()=>{if(t===null)return;const u=v=>{const w=ki(r,v),S=aP(r,v),b=B.getState(),x=lr(b),k=Si(w,o,x,b.levelEditor.halfGridResolution),C=!Ge(k.world,s.current?.world);switch(x.type){case"item":{if(!C||(n(zi()),k.world===void 0))break;const _=Ci(o,k.world.itemId),j=As(b,_);if(j===void 0)break;const D=Lu(k,o,x.item);if(D===void 0||nP({roomState:o,blockPosition:D,itemTool:x.item}))break;n(Cl({blockPosition:D,pointedAtItemJson:j,preview:!0}));break}case"pointer":{const _=i.current?.world?.itemId;if(_===void 0){Pi(o,k);break}const j=o.items[_],{jsonItemId:D}=j,N=o.roomJson.items[D],W=cP(i.current,w,S,v.metaKey||v.shiftKey,a.current!==void 0,N);if(!W){Pi(o,k);break}if(l.current===void 0&&(B.dispatch(kl(!0)),c.current=!0,l.current={position:N.position,times:Pl(N.config.times)}),D===void 0||Ho(j,b))break;uP(b,j)||B.dispatch(Os({jsonItemId:D}));const I=i.current?.world?.onItem.edge,re=I&&Ap(N),M=a.current??le,K=F(M,W),G=Bu(K,re);if(a.current=K,$n(Bu(M,re),G))break;const se=l.current.position,X=l.current.times,ie=Fo(G);let de,ce;if(re?{newTimes:ce,newPosition:de}=sP({jsonItem:N,blockDragAccVec:ie,resizeEdgeDirection:I.point,startTimes:X,startPosition:se}):de=F(se,ie),(!ce||$n(ce,Pl(N.config.times)))&&$n(de,N.position)||rP({roomState:o,jsonItemId:D,newBlockPosition:de,newTimes:ce}))break;n(lm({jsonItemId:D,newPosition:de,newTimes:ce,startOfGesture:c.current})),c.current=!1;break}case"eyeDropper":Pi(o,k);break}s.current=k},d=v=>{const w=B.getState();if(o.id!==w.levelEditor.currentlyEditingRoomId)return;const S=ki(r,v),b=lr(B.getState()),x=Si(S,o,b,w.levelEditor.halfGridResolution),k=a.current!==void 0,C=!k&&x.roomId===i.current?.roomId&&x.world?.itemId===i.current?.world?.itemId;if(a.current=void 0,i.current=void 0,l.current=void 0,B.dispatch(kl(!1)),!C&&!k){console.log("mouseUp - not a click or drag end - skipping");return}switch(b.type){case"item":{if(x.world===void 0){n(Gt({type:"pointer"}));break}const _=Ci(o,x.world.itemId),j=As(w,_);j!==void 0&&n(Cl({blockPosition:Lu(x,o,b.item),pointedAtItemJson:j,preview:!1}));break}case"pointer":{if(C){const _=x.world===void 0?void 0:o.items[x.world.itemId];if(_?.jsonItemId===void 0||Ho(_,w)){n(Os({jsonItemId:void 0}));break}n(Os({jsonItemId:_.jsonItemId,additive:v.ctrlKey||v.metaKey}))}break}case"eyeDropper":{if(C){const _=x.world?.itemId;if(_===void 0){console.warn("no itemId");break}const j=o.items[_];if(Ho(j,w))break;const D=Ci(o,_),N=As(w,D);if(N===void 0){console.warn("no json item");break}const W={type:"item",item:{type:N.type,config:N.config}};n(Gt(W))}break}}},f=v=>{const w=lr(B.getState());switch(a.current=void 0,i.current=void 0,l.current=void 0,w.type){case"item":{n(zi());break}case"pointer":{n(xd(void 0));break}}},p=v=>{const w=ki(r,v),S=B.getState(),b=lr(S),x=Si(w,o,b,S.levelEditor.halfGridResolution);console.log("setting mouseDownPointingAtRef to",x),i.current=x},y=v=>{tP(v)},m=eP(u);return t.addEventListener("mousemove",m),t.addEventListener("mouseup",d),t.addEventListener("mousedown",p),t.addEventListener("mouseleave",f),t.tabIndex=0,t.addEventListener("keyup",y),()=>{t.removeEventListener("mousemove",m),t.removeEventListener("mouseup",d),t.removeEventListener("mousedown",p),t.removeEventListener("mouseleave",f),t.removeEventListener("keyup",y)}},[e.stage,r,t,n,o])},hP=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=_r(Ea);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},fP=t=>{const e=vp(),r=Pr();g.useEffect(()=>{let n=0;const o=({deltaMS:s})=>{if(t.destroyed)return;t.renderContext.room!==e&&console.warn("room renderer does not have the current room");const i=new Set(qo(e.items));e.roomTime+=s,t.tick({deltaMS:s,movedItems:i,progression:n++}),r.render()};return Vr.shared.add(o),()=>{Vr.shared.remove(o)}},[t,e,r])},pP=t=>{const e=Pr();g.useEffect(()=>{if(t)return t.appendChild(e.canvas),()=>{t.removeChild(e.canvas)}},[t,e])},gP=()=>{const t=Pr(),e=_r(r=>r.upscale.upscale.gameEngineUpscale);t.stage.scale=e},mP=()=>{const t=Pr(),e=_r(jg);g.useEffect(()=>{t.renderer?.resize(e.x,e.y)},[t.renderer,e])},yP=t=>{const e=Pr(),[r]=g.useState(()=>new te),n=_r($g);g.useEffect(()=>{if(t.destroyed){console.log("useAddRoomRendererOutputToApplicationStage: room renderer was destroyed, will not add its output to app");return}return r.addChild(t.output.graphics),e.stage.addChild(r),()=>{e.stage.removeChild(r),r.removeChild(t.output.graphics)}},[t,e,r]),g.useEffect(()=>{r.x=n.x/2,r.y=n.y-16},[r,n])},Fu=(t,e)=>{B.dispatch(zg(Ng(t??Lg(B.getState()),e)))},vP=(t,e)=>{const r=pt();g.useLayoutEffect(()=>{Fu()},[]),g.useLayoutEffect(()=>{const n=()=>Fu(t,e);if(e){const o=new ResizeObserver(n);return o.observe(e),()=>o.disconnect()}else return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r,e,t])},wP=()=>{g.useEffect(()=>Dg({actionCreator:Gt,effect(t,{dispatch:e}){e(zi())}}))},bP=({levelEditor:t})=>{const{dragInProgress:e,clickableAnnotationHovered:r,hoveredItem:n,selectedJsonItemIds:o}=t;if(e)return me("cursor-grabbing");if(r)return me("cursor-pointer");if(n){const s=cm(t,n.jsonItemId);if(s!==void 0&&Ap(s))if(n.pointingAtOnItem.corner){if($n(n.pointingAtOnItem.corner,{x:1,y:1,z:1}))return me("cursor-n-resize")}else{const{edge:i}=n.pointingAtOnItem;if(i){if(Ge(i,Ep))return me("cursor-e-resize");if(Ge(i,bp))return me("cursor-s-resize");if(Ge(i,Cp))return me("cursor-w-resize");if(Ge(i,xp)||Ge(i,Sp))return me("cursor-ne-resize");if(Ge(i,_p)||Ge(i,kp))return me("cursor-nw-resize");if(Ge(i,Tp))return me("cursor-se-resize");if(Ge(i,Pp))return me("cursor-sw-resize")}}return o.includes(n.jsonItemId)?me("cursor-grab"):me("cursor-default")}return me("cursor-crosshair")},xP=()=>be(bP);Mg.defaultOptions.scaleMode="nearest";const _P=()=>{const t=UC(),[e,r]=g.useState(null),[n,o]=g.useState(null),s=xP();vP("amigaLowResPal",n??void 0),mP(),yP(t),fP(t),dP(e),pP(e),gP(),wP();const i=hP();return h.jsx("div",{className:`w-full h-full overflow-hidden ${s}`,ref:o,children:h.jsx("div",{style:i,ref:r})})},Uu=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,SP=()=>{const t=Bg(),e=_r(Fg);g.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",Ug())},[]),g.useEffect(()=>{document.body.classList.remove(...Object.keys(Hg).map(Uu)),document.body.classList.add(Uu(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},Ss=g.createContext(null);Ss.displayName="PanelGroupContext";const ve={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},gl=10,dr=g.useLayoutEffect,Hu=ed.useId,kP=typeof Hu=="function"?Hu:()=>null;let CP=0;function ml(t=null){const e=kP(),r=g.useRef(t||e||null);return r.current===null&&(r.current=""+CP++),t??r.current}function jp({children:t,className:e="",collapsedSize:r,collapsible:n,defaultSize:o,forwardedRef:s,id:i,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:f,style:p,tagName:y="div",...m}){const v=g.useContext(Ss);if(v===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:w,expandPanel:S,getPanelSize:b,getPanelStyle:x,groupId:k,isPanelCollapsed:C,reevaluatePanelConstraints:_,registerPanel:j,resizePanel:D,unregisterPanel:N}=v,W=ml(i),I=g.useRef({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:r,collapsible:n,defaultSize:o,maxSize:a,minSize:l},id:W,idIsFromProps:i!==void 0,order:f});g.useRef({didLogMissingDefaultSizeWarning:!1}),dr(()=>{const{callbacks:M,constraints:K}=I.current,G={...K};I.current.id=W,I.current.idIsFromProps=i!==void 0,I.current.order=f,M.onCollapse=c,M.onExpand=u,M.onResize=d,K.collapsedSize=r,K.collapsible=n,K.defaultSize=o,K.maxSize=a,K.minSize=l,(G.collapsedSize!==K.collapsedSize||G.collapsible!==K.collapsible||G.maxSize!==K.maxSize||G.minSize!==K.minSize)&&_(I.current,G)}),dr(()=>{const M=I.current;return j(M),()=>{N(M)}},[f,W,j,N]),g.useImperativeHandle(s,()=>({collapse:()=>{w(I.current)},expand:M=>{S(I.current,M)},getId(){return W},getSize(){return b(I.current)},isCollapsed(){return C(I.current)},isExpanded(){return!C(I.current)},resize:M=>{D(I.current,M)}}),[w,S,b,C,W,D]);const re=x(I.current,o);return g.createElement(y,{...m,children:t,className:e,id:W,style:{...re,...p},[ve.groupId]:k,[ve.panel]:"",[ve.panelCollapsible]:n||void 0,[ve.panelId]:W,[ve.panelSize]:parseFloat(""+re.flexGrow).toFixed(1)})}const Wo=g.forwardRef((t,e)=>g.createElement(jp,{...t,forwardedRef:e}));jp.displayName="Panel";Wo.displayName="forwardRef(Panel)";let va=null,Go=-1,Bt=null;function PP(t,e){if(e){const r=(e&Dp)!==0,n=(e&Mp)!==0,o=(e&Bp)!==0,s=(e&Fp)!==0;if(r)return o?"se-resize":s?"ne-resize":"e-resize";if(n)return o?"sw-resize":s?"nw-resize":"w-resize";if(o)return"s-resize";if(s)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function EP(){Bt!==null&&(document.head.removeChild(Bt),va=null,Bt=null,Go=-1)}function Ei(t,e){var r,n;const o=PP(t,e);if(va!==o){if(va=o,Bt===null&&(Bt=document.createElement("style"),document.head.appendChild(Bt)),Go>=0){var s;(s=Bt.sheet)===null||s===void 0||s.removeRule(Go)}Go=(r=(n=Bt.sheet)===null||n===void 0?void 0:n.insertRule(`*{cursor: ${o} !important;}`))!==null&&r!==void 0?r:-1}}function $p(t){return t.type==="keydown"}function zp(t){return t.type.startsWith("pointer")}function Np(t){return t.type.startsWith("mouse")}function ks(t){if(zp(t)){if(t.isPrimary)return{x:t.clientX,y:t.clientY}}else if(Np(t))return{x:t.clientX,y:t.clientY};return{x:1/0,y:1/0}}function TP(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function RP(t,e,r){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function AP(t,e){if(t===e)throw new Error("Cannot compare node with itself");const r={a:qu(t),b:qu(e)};let n;for(;r.a.at(-1)===r.b.at(-1);)t=r.a.pop(),e=r.b.pop(),n=t;ee(n,"Stacking order can only be calculated for elements with a common ancestor");const o={a:Gu(Wu(r.a)),b:Gu(Wu(r.b))};if(o.a===o.b){const s=n.childNodes,i={a:r.a.at(-1),b:r.b.at(-1)};let a=s.length;for(;a--;){const l=s[a];if(l===i.a)return 1;if(l===i.b)return-1}}return Math.sign(o.a-o.b)}const OP=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function IP(t){var e;const r=getComputedStyle((e=Lp(t))!==null&&e!==void 0?e:t).display;return r==="flex"||r==="inline-flex"}function jP(t){const e=getComputedStyle(t);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||IP(t))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||OP.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function Wu(t){let e=t.length;for(;e--;){const r=t[e];if(ee(r,"Missing node"),jP(r))return r}return null}function Gu(t){return t&&Number(getComputedStyle(t).zIndex)||0}function qu(t){const e=[];for(;t;)e.push(t),t=Lp(t);return e}function Lp(t){const{parentNode:e}=t;return e&&e instanceof ShadowRoot?e.host:e}const Dp=1,Mp=2,Bp=4,Fp=8,$P=TP()==="coarse";let Qe=[],tn=!1,Ft=new Map,Cs=new Map;const Kn=new Set;function zP(t,e,r,n,o){var s;const{ownerDocument:i}=e,a={direction:r,element:e,hitAreaMargins:n,setResizeHandlerState:o},l=(s=Ft.get(i))!==null&&s!==void 0?s:0;return Ft.set(i,l+1),Kn.add(a),ns(),function(){var u;Cs.delete(t),Kn.delete(a);const d=(u=Ft.get(i))!==null&&u!==void 0?u:1;if(Ft.set(i,d-1),ns(),d===1&&Ft.delete(i),Qe.includes(a)){const f=Qe.indexOf(a);f>=0&&Qe.splice(f,1),vl(),o("up",!0,null)}}}function NP(t){const{target:e}=t,{x:r,y:n}=ks(t);tn=!0,yl({target:e,x:r,y:n}),ns(),Qe.length>0&&(os("down",t),t.preventDefault(),Up(e)||t.stopImmediatePropagation())}function Ti(t){const{x:e,y:r}=ks(t);if(tn&&t.buttons===0&&(tn=!1,os("up",t)),!tn){const{target:n}=t;yl({target:n,x:e,y:r})}os("move",t),vl(),Qe.length>0&&t.preventDefault()}function Ri(t){const{target:e}=t,{x:r,y:n}=ks(t);Cs.clear(),tn=!1,Qe.length>0&&(t.preventDefault(),Up(e)||t.stopImmediatePropagation()),os("up",t),yl({target:e,x:r,y:n}),vl(),ns()}function Up(t){let e=t;for(;e;){if(e.hasAttribute(ve.resizeHandle))return!0;e=e.parentElement}return!1}function yl({target:t,x:e,y:r}){Qe.splice(0);let n=null;(t instanceof HTMLElement||t instanceof SVGElement)&&(n=t),Kn.forEach(o=>{const{element:s,hitAreaMargins:i}=o,a=s.getBoundingClientRect(),{bottom:l,left:c,right:u,top:d}=a,f=$P?i.coarse:i.fine;if(e>=c-f&&e<=u+f&&r>=d-f&&r<=l+f){if(n!==null&&document.contains(n)&&s!==n&&!s.contains(n)&&!n.contains(s)&&AP(n,s)>0){let y=n,m=!1;for(;y&&!y.contains(s);){if(RP(y.getBoundingClientRect(),a)){m=!0;break}y=y.parentElement}if(m)return}Qe.push(o)}})}function Ai(t,e){Cs.set(t,e)}function vl(){let t=!1,e=!1;Qe.forEach(n=>{const{direction:o}=n;o==="horizontal"?t=!0:e=!0});let r=0;Cs.forEach(n=>{r|=n}),t&&e?Ei("intersection",r):t?Ei("horizontal",r):e?Ei("vertical",r):EP()}let Oi;function ns(){var t;(t=Oi)===null||t===void 0||t.abort(),Oi=new AbortController;const e={capture:!0,signal:Oi.signal};Kn.size&&(tn?(Qe.length>0&&Ft.forEach((r,n)=>{const{body:o}=n;r>0&&(o.addEventListener("contextmenu",Ri,e),o.addEventListener("pointerleave",Ti,e),o.addEventListener("pointermove",Ti,e))}),Ft.forEach((r,n)=>{const{body:o}=n;o.addEventListener("pointerup",Ri,e),o.addEventListener("pointercancel",Ri,e)})):Ft.forEach((r,n)=>{const{body:o}=n;r>0&&(o.addEventListener("pointerdown",NP,e),o.addEventListener("pointermove",Ti,e))}))}function os(t,e){Kn.forEach(r=>{const{setResizeHandlerState:n}=r,o=Qe.includes(r);n(t,o,e)})}function LP(){const[t,e]=g.useState(0);return g.useCallback(()=>e(r=>r+1),[])}function ee(t,e){if(!t)throw console.error(e),Error(e)}function wr(t,e,r=gl){return t.toFixed(r)===e.toFixed(r)?0:t>e?1:-1}function xt(t,e,r=gl){return wr(t,e,r)===0}function De(t,e,r){return wr(t,e,r)===0}function DP(t,e,r){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++){const o=t[n],s=e[n];if(!De(o,s,r))return!1}return!0}function Yr({panelConstraints:t,panelIndex:e,size:r}){const n=t[e];ee(n!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:o=0,collapsible:s,maxSize:i=100,minSize:a=0}=n;if(wr(r,a)<0)if(s){const l=(o+a)/2;wr(r,l)<0?r=o:r=a}else r=a;return r=Math.min(i,r),r=parseFloat(r.toFixed(gl)),r}function On({delta:t,initialLayout:e,panelConstraints:r,pivotIndices:n,prevLayout:o,trigger:s}){if(De(t,0))return e;const i=[...e],[a,l]=n;ee(a!=null,"Invalid first pivot index"),ee(l!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const d=t<0?l:a,f=r[d];ee(f,`Panel constraints not found for index ${d}`);const{collapsedSize:p=0,collapsible:y,minSize:m=0}=f;if(y){const v=e[d];if(ee(v!=null,`Previous layout not found for panel index ${d}`),De(v,p)){const w=m-v;wr(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}{const d=t<0?a:l,f=r[d];ee(f,`No panel constraints found for index ${d}`);const{collapsedSize:p=0,collapsible:y,minSize:m=0}=f;if(y){const v=e[d];if(ee(v!=null,`Previous layout not found for panel index ${d}`),De(v,m)){const w=v-p;wr(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}}{const d=t<0?1:-1;let f=t<0?l:a,p=0;for(;;){const m=e[f];ee(m!=null,`Previous layout not found for panel index ${f}`);const w=Yr({panelConstraints:r,panelIndex:f,size:100})-m;if(p+=w,f+=d,f<0||f>=r.length)break}const y=Math.min(Math.abs(t),Math.abs(p));t=t<0?0-y:y}{let f=t<0?a:l;for(;f>=0&&f<r.length;){const p=Math.abs(t)-Math.abs(c),y=e[f];ee(y!=null,`Previous layout not found for panel index ${f}`);const m=y-p,v=Yr({panelConstraints:r,panelIndex:f,size:m});if(!De(y,v)&&(c+=y-v,i[f]=v,c.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?f--:f++}}if(DP(o,i))return o;{const d=t<0?l:a,f=e[d];ee(f!=null,`Previous layout not found for panel index ${d}`);const p=f+c,y=Yr({panelConstraints:r,panelIndex:d,size:p});if(i[d]=y,!De(y,p)){let m=p-y,w=t<0?l:a;for(;w>=0&&w<r.length;){const S=i[w];ee(S!=null,`Previous layout not found for panel index ${w}`);const b=S+m,x=Yr({panelConstraints:r,panelIndex:w,size:b});if(De(S,x)||(m-=x-S,i[w]=x),De(m,0))break;t>0?w--:w++}}}const u=i.reduce((d,f)=>f+d,0);return De(u,100)?i:o}function MP({layout:t,panelsArray:e,pivotIndices:r}){let n=0,o=100,s=0,i=0;const a=r[0];ee(a!=null,"No pivot index found"),e.forEach((d,f)=>{const{constraints:p}=d,{maxSize:y=100,minSize:m=0}=p;f===a?(n=m,o=y):(s+=m,i+=y)});const l=Math.min(o,100-s),c=Math.max(n,100-i),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function Jn(t,e=document){return Array.from(e.querySelectorAll(`[${ve.resizeHandleId}][data-panel-group-id="${t}"]`))}function Hp(t,e,r=document){const o=Jn(t,r).findIndex(s=>s.getAttribute(ve.resizeHandleId)===e);return o??null}function Wp(t,e,r){const n=Hp(t,e,r);return n!=null?[n,n+1]:[-1,-1]}function BP(t){return t instanceof HTMLElement?!0:typeof t=="object"&&t!==null&&"tagName"in t&&"getAttribute"in t}function Gp(t,e=document){if(BP(e)&&e.dataset.panelGroupId==t)return e;const r=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return r||null}function Ps(t,e=document){const r=e.querySelector(`[${ve.resizeHandleId}="${t}"]`);return r||null}function FP(t,e,r,n=document){var o,s,i,a;const l=Ps(e,n),c=Jn(t,n),u=l?c.indexOf(l):-1,d=(o=(s=r[u])===null||s===void 0?void 0:s.id)!==null&&o!==void 0?o:null,f=(i=(a=r[u+1])===null||a===void 0?void 0:a.id)!==null&&i!==void 0?i:null;return[d,f]}function UP({committedValuesRef:t,eagerValuesRef:e,groupId:r,layout:n,panelDataArray:o,panelGroupElement:s,setLayout:i}){g.useRef({didWarnAboutMissingResizeHandle:!1}),dr(()=>{if(!s)return;const a=Jn(r,s);for(let l=0;l<o.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=MP({layout:n,panelsArray:o,pivotIndices:[l,l+1]}),f=a[l];if(f!=null){const p=o[l];ee(p,`No panel data found for index "${l}"`),f.setAttribute("aria-controls",p.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(u)),f.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[r,n,o,s]),g.useEffect(()=>{if(!s)return;const a=e.current;ee(a,"Eager values not found");const{panelDataArray:l}=a,c=Gp(r,s);ee(c!=null,`No group found for id "${r}"`);const u=Jn(r,s);ee(u,`No resize handles found for group id "${r}"`);const d=u.map(f=>{const p=f.getAttribute(ve.resizeHandleId);ee(p,"Resize handle element has no handle id attribute");const[y,m]=FP(r,p,l,s);if(y==null||m==null)return()=>{};const v=w=>{if(!w.defaultPrevented)switch(w.key){case"Enter":{w.preventDefault();const S=l.findIndex(b=>b.id===y);if(S>=0){const b=l[S];ee(b,`No panel data found for index ${S}`);const x=n[S],{collapsedSize:k=0,collapsible:C,minSize:_=0}=b.constraints;if(x!=null&&C){const j=On({delta:De(x,k)?_-k:k-x,initialLayout:n,panelConstraints:l.map(D=>D.constraints),pivotIndices:Wp(r,p,s),prevLayout:n,trigger:"keyboard"});n!==j&&i(j)}}break}}};return f.addEventListener("keydown",v),()=>{f.removeEventListener("keydown",v)}});return()=>{d.forEach(f=>f())}},[s,t,e,r,n,o,i])}function Vu(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function qp(t,e){const r=t==="horizontal",{x:n,y:o}=ks(e);return r?n:o}function HP(t,e,r,n,o){const s=r==="horizontal",i=Ps(e,o);ee(i,`No resize handle element found for id "${e}"`);const a=i.getAttribute(ve.groupId);ee(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=n;const c=qp(r,t),u=Gp(a,o);ee(u,`No group element found for id "${a}"`);const d=u.getBoundingClientRect(),f=s?d.width:d.height;return(c-l)/f*100}function WP(t,e,r,n,o,s){if($p(t)){const i=r==="horizontal";let a=0;t.shiftKey?a=100:o!=null?a=o:a=10;let l=0;switch(t.key){case"ArrowDown":l=i?0:a;break;case"ArrowLeft":l=i?-a:0;break;case"ArrowRight":l=i?a:0;break;case"ArrowUp":l=i?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return n==null?0:HP(t,e,r,n,s)}function GP({panelDataArray:t}){const e=Array(t.length),r=t.map(s=>s.constraints);let n=0,o=100;for(let s=0;s<t.length;s++){const i=r[s];ee(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;a!=null&&(n++,e[s]=a,o-=a)}for(let s=0;s<t.length;s++){const i=r[s];ee(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;if(a!=null)continue;const l=t.length-n,c=o/l;n++,e[s]=c,o-=c}return e}function Ur(t,e,r){e.forEach((n,o)=>{const s=t[o];ee(s,`Panel data not found for index ${o}`);const{callbacks:i,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:u}=a,d=r[l];if(d==null||n!==d){r[l]=n;const{onCollapse:f,onExpand:p,onResize:y}=i;y&&y(n,d),u&&(f||p)&&(p&&(d==null||xt(d,c))&&!xt(n,c)&&p(),f&&(d==null||!xt(d,c))&&xt(n,c)&&f())}})}function Oo(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0}function qP({defaultSize:t,dragState:e,layout:r,panelData:n,panelIndex:o,precision:s=3}){const i=r[o];let a;return i==null?a=t!=null?t.toPrecision(s):"1":n.length===1?a="1":a=i.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function VP(t,e=10){let r=null;return(...o)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{t(...o)},e)}}function Xu(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,r)=>{localStorage.setItem(e,r)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function Vp(t){return`react-resizable-panels:${t}`}function Xp(t){return t.map(e=>{const{constraints:r,id:n,idIsFromProps:o,order:s}=e;return o?n:s?`${s}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((e,r)=>e.localeCompare(r)).join(",")}function Kp(t,e){try{const r=Vp(t),n=e.getItem(r);if(n){const o=JSON.parse(n);if(typeof o=="object"&&o!=null)return o}}catch{}return null}function XP(t,e,r){var n,o;const s=(n=Kp(t,r))!==null&&n!==void 0?n:{},i=Xp(e);return(o=s[i])!==null&&o!==void 0?o:null}function KP(t,e,r,n,o){var s;const i=Vp(t),a=Xp(e),l=(s=Kp(t,o))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{o.setItem(i,JSON.stringify(l))}catch(c){console.error(c)}}function Ku({layout:t,panelConstraints:e}){const r=[...t],n=r.reduce((s,i)=>s+i,0);if(r.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${r.map(s=>`${s}%`).join(", ")}`);if(!De(n,100)&&r.length>0)for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=100/n*i;r[s]=a}let o=0;for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=Yr({panelConstraints:e,panelIndex:s,size:i});i!=a&&(o+=i-a,r[s]=a)}if(!De(o,0))for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=i+o,l=Yr({panelConstraints:e,panelIndex:s,size:a});if(i!==l&&(o-=l-i,r[s]=l,De(o,0)))break}return r}const JP=100,In={getItem:t=>(Xu(In),In.getItem(t)),setItem:(t,e)=>{Xu(In),In.setItem(t,e)}},Ju={};function Jp({autoSaveId:t=null,children:e,className:r="",direction:n,forwardedRef:o,id:s=null,onLayout:i=null,keyboardResizeBy:a=null,storage:l=In,style:c,tagName:u="div",...d}){const f=ml(s),p=g.useRef(null),[y,m]=g.useState(null),[v,w]=g.useState([]),S=LP(),b=g.useRef({}),x=g.useRef(new Map),k=g.useRef(0),C=g.useRef({autoSaveId:t,direction:n,dragState:y,id:f,keyboardResizeBy:a,onLayout:i,storage:l}),_=g.useRef({layout:v,panelDataArray:[],panelDataArrayChanged:!1});g.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),g.useImperativeHandle(o,()=>({getId:()=>C.current.id,getLayout:()=>{const{layout:P}=_.current;return P},setLayout:P=>{const{onLayout:A}=C.current,{layout:T,panelDataArray:O}=_.current,R=Ku({layout:P,panelConstraints:O.map(L=>L.constraints)});Vu(T,R)||(w(R),_.current.layout=R,A&&A(R),Ur(O,R,b.current))}}),[]),dr(()=>{C.current.autoSaveId=t,C.current.direction=n,C.current.dragState=y,C.current.id=f,C.current.onLayout=i,C.current.storage=l}),UP({committedValuesRef:C,eagerValuesRef:_,groupId:f,layout:v,panelDataArray:_.current.panelDataArray,setLayout:w,panelGroupElement:p.current}),g.useEffect(()=>{const{panelDataArray:P}=_.current;if(t){if(v.length===0||v.length!==P.length)return;let A=Ju[t];A==null&&(A=VP(KP,JP),Ju[t]=A);const T=[...P],O=new Map(x.current);A(t,T,O,v,l)}},[t,v,l]),g.useEffect(()=>{});const j=g.useCallback(P=>{const{onLayout:A}=C.current,{layout:T,panelDataArray:O}=_.current;if(P.constraints.collapsible){const R=O.map(Ue=>Ue.constraints),{collapsedSize:L=0,panelSize:ne,pivotIndices:he}=rr(O,P,T);if(ee(ne!=null,`Panel size not found for panel "${P.id}"`),!xt(ne,L)){x.current.set(P.id,ne);const He=qr(O,P)===O.length-1?ne-L:L-ne,fe=On({delta:He,initialLayout:T,panelConstraints:R,pivotIndices:he,prevLayout:T,trigger:"imperative-api"});Oo(T,fe)||(w(fe),_.current.layout=fe,A&&A(fe),Ur(O,fe,b.current))}}},[]),D=g.useCallback((P,A)=>{const{onLayout:T}=C.current,{layout:O,panelDataArray:R}=_.current;if(P.constraints.collapsible){const L=R.map(Ve=>Ve.constraints),{collapsedSize:ne=0,panelSize:he=0,minSize:Ue=0,pivotIndices:He}=rr(R,P,O),fe=A??Ue;if(xt(he,ne)){const Ve=x.current.get(P.id),yn=Ve!=null&&Ve>=fe?Ve:fe,Es=qr(R,P)===R.length-1?he-yn:yn-he,Oe=On({delta:Es,initialLayout:O,panelConstraints:L,pivotIndices:He,prevLayout:O,trigger:"imperative-api"});Oo(O,Oe)||(w(Oe),_.current.layout=Oe,T&&T(Oe),Ur(R,Oe,b.current))}}},[]),N=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{panelSize:O}=rr(T,P,A);return ee(O!=null,`Panel size not found for panel "${P.id}"`),O},[]),W=g.useCallback((P,A)=>{const{panelDataArray:T}=_.current,O=qr(T,P);return qP({defaultSize:A,dragState:y,layout:v,panelData:T,panelIndex:O})},[y,v]),I=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{collapsedSize:O=0,collapsible:R,panelSize:L}=rr(T,P,A);return ee(L!=null,`Panel size not found for panel "${P.id}"`),R===!0&&xt(L,O)},[]),re=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{collapsedSize:O=0,collapsible:R,panelSize:L}=rr(T,P,A);return ee(L!=null,`Panel size not found for panel "${P.id}"`),!R||wr(L,O)>0},[]),M=g.useCallback(P=>{const{panelDataArray:A}=_.current;A.push(P),A.sort((T,O)=>{const R=T.order,L=O.order;return R==null&&L==null?0:R==null?-1:L==null?1:R-L}),_.current.panelDataArrayChanged=!0,S()},[S]);dr(()=>{if(_.current.panelDataArrayChanged){_.current.panelDataArrayChanged=!1;const{autoSaveId:P,onLayout:A,storage:T}=C.current,{layout:O,panelDataArray:R}=_.current;let L=null;if(P){const he=XP(P,R,T);he&&(x.current=new Map(Object.entries(he.expandToSizes)),L=he.layout)}L==null&&(L=GP({panelDataArray:R}));const ne=Ku({layout:L,panelConstraints:R.map(he=>he.constraints)});Vu(O,ne)||(w(ne),_.current.layout=ne,A&&A(ne),Ur(R,ne,b.current))}}),dr(()=>{const P=_.current;return()=>{P.layout=[]}},[]);const K=g.useCallback(P=>{let A=!1;const T=p.current;return T&&window.getComputedStyle(T,null).getPropertyValue("direction")==="rtl"&&(A=!0),function(R){R.preventDefault();const L=p.current;if(!L)return()=>null;const{direction:ne,dragState:he,id:Ue,keyboardResizeBy:He,onLayout:fe}=C.current,{layout:Ve,panelDataArray:yn}=_.current,{initialLayout:lo}=he??{},Es=Wp(Ue,P,L);let Oe=WP(R,P,ne,he,He,L);const wl=ne==="horizontal";wl&&A&&(Oe=-Oe);const Zp=yn.map(Qp=>Qp.constraints),vn=On({delta:Oe,initialLayout:lo??Ve,panelConstraints:Zp,pivotIndices:Es,prevLayout:Ve,trigger:$p(R)?"keyboard":"mouse-or-touch"}),bl=!Oo(Ve,vn);(zp(R)||Np(R))&&k.current!=Oe&&(k.current=Oe,!bl&&Oe!==0?wl?Ai(P,Oe<0?Dp:Mp):Ai(P,Oe<0?Bp:Fp):Ai(P,0)),bl&&(w(vn),_.current.layout=vn,fe&&fe(vn),Ur(yn,vn,b.current))}},[]),G=g.useCallback((P,A)=>{const{onLayout:T}=C.current,{layout:O,panelDataArray:R}=_.current,L=R.map(Ve=>Ve.constraints),{panelSize:ne,pivotIndices:he}=rr(R,P,O);ee(ne!=null,`Panel size not found for panel "${P.id}"`);const He=qr(R,P)===R.length-1?ne-A:A-ne,fe=On({delta:He,initialLayout:O,panelConstraints:L,pivotIndices:he,prevLayout:O,trigger:"imperative-api"});Oo(O,fe)||(w(fe),_.current.layout=fe,T&&T(fe),Ur(R,fe,b.current))},[]),se=g.useCallback((P,A)=>{const{layout:T,panelDataArray:O}=_.current,{collapsedSize:R=0,collapsible:L}=A,{collapsedSize:ne=0,collapsible:he,maxSize:Ue=100,minSize:He=0}=P.constraints,{panelSize:fe}=rr(O,P,T);fe!=null&&(L&&he&&xt(fe,R)?xt(R,ne)||G(P,ne):fe<He?G(P,He):fe>Ue&&G(P,Ue))},[G]),X=g.useCallback((P,A)=>{const{direction:T}=C.current,{layout:O}=_.current;if(!p.current)return;const R=Ps(P,p.current);ee(R,`Drag handle element not found for id "${P}"`);const L=qp(T,A);m({dragHandleId:P,dragHandleRect:R.getBoundingClientRect(),initialCursorPosition:L,initialLayout:O})},[]),ie=g.useCallback(()=>{m(null)},[]),de=g.useCallback(P=>{const{panelDataArray:A}=_.current,T=qr(A,P);T>=0&&(A.splice(T,1),delete b.current[P.id],_.current.panelDataArrayChanged=!0,S())},[S]),ce=g.useMemo(()=>({collapsePanel:j,direction:n,dragState:y,expandPanel:D,getPanelSize:N,getPanelStyle:W,groupId:f,isPanelCollapsed:I,isPanelExpanded:re,reevaluatePanelConstraints:se,registerPanel:M,registerResizeHandle:K,resizePanel:G,startDragging:X,stopDragging:ie,unregisterPanel:de,panelGroupElement:p.current}),[j,y,n,D,N,W,f,I,re,se,M,K,G,X,ie,de]),E={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return g.createElement(Ss.Provider,{value:ce},g.createElement(u,{...d,children:e,className:r,id:s,ref:p,style:{...E,...c},[ve.group]:"",[ve.groupDirection]:n,[ve.groupId]:f}))}const Yp=g.forwardRef((t,e)=>g.createElement(Jp,{...t,forwardedRef:e}));Jp.displayName="PanelGroup";Yp.displayName="forwardRef(PanelGroup)";function qr(t,e){return t.findIndex(r=>r===e||r.id===e.id)}function rr(t,e,r){const n=qr(t,e),s=n===t.length-1?[n-1,n]:[n,n+1],i=r[n];return{...e.constraints,panelSize:i,pivotIndices:s}}function YP({disabled:t,handleId:e,resizeHandler:r,panelGroupElement:n}){g.useEffect(()=>{if(t||r==null||n==null)return;const o=Ps(e,n);if(o==null)return;const s=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),r(i);break}case"F6":{i.preventDefault();const a=o.getAttribute(ve.groupId);ee(a,`No group element found for id "${a}"`);const l=Jn(a,n),c=Hp(a,e,n);ee(c!==null,`No resize element found for id "${e}"`);const u=i.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return o.addEventListener("keydown",s),()=>{o.removeEventListener("keydown",s)}},[n,t,e,r])}function wa({children:t=null,className:e="",disabled:r=!1,hitAreaMargins:n,id:o,onBlur:s,onClick:i,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:u,style:d={},tabIndex:f=0,tagName:p="div",...y}){var m,v;const w=g.useRef(null),S=g.useRef({onClick:i,onDragging:a,onPointerDown:c,onPointerUp:u});g.useEffect(()=>{S.current.onClick=i,S.current.onDragging=a,S.current.onPointerDown=c,S.current.onPointerUp=u});const b=g.useContext(Ss);if(b===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:x,groupId:k,registerResizeHandle:C,startDragging:_,stopDragging:j,panelGroupElement:D}=b,N=ml(o),[W,I]=g.useState("inactive"),[re,M]=g.useState(!1),[K,G]=g.useState(null),se=g.useRef({state:W});dr(()=>{se.current.state=W}),g.useEffect(()=>{if(r)G(null);else{const ce=C(N);G(()=>ce)}},[r,N,C]);const X=(m=n?.coarse)!==null&&m!==void 0?m:15,ie=(v=n?.fine)!==null&&v!==void 0?v:5;g.useEffect(()=>{if(r||K==null)return;const ce=w.current;ee(ce,"Element ref not attached");let E=!1;return zP(N,ce,x,{coarse:X,fine:ie},(A,T,O)=>{if(!T){I("inactive");return}switch(A){case"down":{I("drag"),E=!1,ee(O,'Expected event to be defined for "down" action'),_(N,O);const{onDragging:R,onPointerDown:L}=S.current;R?.(!0),L?.();break}case"move":{const{state:R}=se.current;E=!0,R!=="drag"&&I("hover"),ee(O,'Expected event to be defined for "move" action'),K(O);break}case"up":{I("hover"),j();const{onClick:R,onDragging:L,onPointerUp:ne}=S.current;L?.(!1),ne?.(),E||R?.();break}}})},[X,x,r,ie,C,N,K,_,j]),YP({disabled:r,handleId:N,resizeHandler:K,panelGroupElement:D});const de={touchAction:"none",userSelect:"none"};return g.createElement(p,{...y,children:t,className:e,id:o,onBlur:()=>{M(!1),s?.()},onFocus:()=>{M(!0),l?.()},ref:w,role:"separator",style:{...de,...d},tabIndex:f,[ve.groupDirection]:x,[ve.groupId]:k,[ve.resizeHandle]:"",[ve.resizeHandleActive]:W==="drag"?"pointer":re?"keyboard":void 0,[ve.resizeHandleEnabled]:!r,[ve.resizeHandleId]:N,[ve.resizeHandleState]:W})}wa.displayName="PanelResizeHandle";const ZP=Wg(()=>Ut(()=>import("./JsonRoomEditor-CPS2SL4v.js").then(t=>t.J),__vite__mapDeps([8,1,2,6,9]))),QP=g.lazy(ZP),eE=()=>{SP();const t=h.jsx("div",{className:"flex h-full items-center justify-center bg-pureBlack",children:h.jsx("span",{className:"sprite texture-animated-head_walking_right"})});return h.jsx(h.Fragment,{children:h.jsx(Ka,{children:h.jsxs(Yp,{direction:"horizontal",className:"w-full h-full",children:[h.jsx(Wo,{id:"jsonEditor",defaultSize:18,minSize:12,collapsible:!0,children:h.jsx(g.Suspense,{fallback:t,children:h.jsx(QP,{})})}),h.jsx(wa,{className:"scale-editor w-1 bg-metallicBlueHalfbrite  hover:border-moss hover:bg-moss border-r-[calc(1px*var(--scale))] border-metallicBlue"}),h.jsx(Wo,{id:"editingArea",children:h.jsx(BC,{children:h.jsx(LC,{children:h.jsx(_P,{})})})}),h.jsx(wa,{className:"scale-editor w-1 bg-metallicBlueHalfbrite  hover:border-moss hover:bg-moss border-l-[calc(1px*var(--scale))] border-metallicBlue"}),h.jsx(Wo,{id:"toolbar",defaultSize:20,maxSize:33,minSize:10,children:h.jsx(B_,{})})]})})})},gE=Object.freeze(Object.defineProperty({__proto__:null,default:eE},Symbol.toStringTag,{value:"Module"}));export{Rd as A,Pd as C,Jt as F,gE as L,Ia as R,Im as S,Ad as V,Lm as a,pE as b,lE as h,me as t,Om as u};
