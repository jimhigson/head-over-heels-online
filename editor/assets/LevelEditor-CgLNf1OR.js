const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WebGPURenderer-jEd_BskH.js","assets/index-BOrjGEYY.js","assets/index-ClVD85Bl.css","assets/colorToUniform-KTpA7KSL.js","assets/SharedSystems-9dQvFAhj.js","assets/Graphics-B7XG9IqG.js","assets/levelEditorSlice-JX0myE-o.js","assets/WebGLRenderer-D-jkawIW.js","assets/JsonRoomEditor-C1XSmQua.js","assets/JsonRoomEditor-Cpm53wG5.css"])))=>i.map(i=>d[i]);
import{a6 as Kp,a5 as pa,a7 as Yn,s as Xp,x as Hu,y as Et,e as ga,E as Ln,a as Jp,C as te,d as Mn,v as Bn,Z as V,D as Pi,aw as Ut,k as Yp,K as un,t as St,T as Vr,U as Zp,M as Qp,ax as Kr,V as Wu,ay as eg,w as Ei,az as tg,aA as rg,j as ng,aB as xr,aC as f,aD as Gu,aE as Ht,aF as g,aG as og,aH as qu,aI as sg,aJ as ig,aK as ce,aL as gt,aM as Vu,aN as ag,aO as lg,aP as L,aQ as qe,aR as dn,aS as cg,aT as ug,aU as dg,aV as Ku,aW as Xu,aX as Ju,ae as ge,ai as fr,aa as W,aY as Yu,aZ as Rt,a_ as hg,ac as Go,ab as Tt,a$ as fg,b0 as pg,b1 as ke,b2 as os,b3 as ur,ag as Zu,b4 as Zn,an as hn,b5 as gg,b6 as mg,ao as Wt,ad as dr,b7 as Qu,b8 as Be,b9 as yg,af as vg,at as ss,ba as ma,bb as ya,bc as jn,bd as ed,be as td,ar as $n,bf as va,bg as wg,as as rd,bh as bg,bi as Jt,ah as xg,bj as _g,bk as wa,bl as Oo,bm as fl,bn as Sg,bo as kg,bp as Cg,bq as _r,ap as nd,br as ba,bs as Pg,bt as od,bu as Eg,bv as Tg,bw as Rg,bx as Ag,by as Og,bz as Ig,bA as jg,bB as $g,bC as zg,bD as Ng,bE as Dg,bF as Lg}from"./index-BOrjGEYY.js";import{r as Mg,u as be,d as sd,c as Bg,s as cr,a as Gt,b as Fg,e as pl,f as Ug,g as Hg,h as Wg,i as Gg,j as id,k as ad,l as qg,m as rn,n as Vg,o as Kg,p as ld,q as Es,t as cd,v as Xg,w as Ti,x as H,y as Qn,z as ud,A as xa,B as Jg,C as Ve,D as Yg,E as Zg,F as _a,G as Fn,H as Qg,I as Un,J as em,K as Sa,L as dd,M as hd,N as tm,O as gl,P as fd,Q as rm,R as nm,S as pd,T as ml,U as Ts,V as Rs,W as yl,X as gd,Y as Ri,Z as vl,_ as md,$ as om,a0 as sm}from"./levelEditorSlice-JX0myE-o.js";import{S as im,G as ct}from"./Graphics-B7XG9IqG.js";function am(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function lm(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function cm(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var wl=t=>Array.isArray(t)?t:[t];function um(t){const e=Array.isArray(t[0])?t[0]:t;return cm(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function dm(t,e){const r=[],{length:n}=t;for(let o=0;o<n;o++)r.push(t[o].apply(null,e));return r}var hm=class{constructor(t){this.value=t}deref(){return this.value}},fm=typeof WeakRef<"u"?WeakRef:hm,pm=0,bl=1;function co(){return{s:pm,v:void 0,o:null,p:null}}function yd(t,e={}){let r=co();const{resultEqualityCheck:n}=e;let o,s=0;function i(){let a=r;const{length:l}=arguments;for(let d=0,h=l;d<h;d++){const p=arguments[d];if(typeof p=="function"||typeof p=="object"&&p!==null){let y=a.o;y===null&&(a.o=y=new WeakMap);const m=y.get(p);m===void 0?(a=co(),y.set(p,a)):a=m}else{let y=a.p;y===null&&(a.p=y=new Map);const m=y.get(p);m===void 0?(a=co(),y.set(p,a)):a=m}}const c=a;let u;if(a.s===bl)u=a.v;else if(u=t.apply(null,arguments),s++,n){const d=o?.deref?.()??o;d!=null&&n(d,u)&&(u=d,s!==0&&s--),o=typeof u=="object"&&u!==null||typeof u=="function"?new fm(u):u}return c.s=bl,c.v=u,u}return i.clearCache=()=>{r=co(),i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function gm(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...o)=>{let s=0,i=0,a,l={},c=o.pop();typeof c=="object"&&(l=c,c=o.pop()),am(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:d,memoizeOptions:h=[],argsMemoize:p=yd,argsMemoizeOptions:y=[]}=u,m=wl(h),v=wl(y),w=um(o),S=d(function(){return s++,c.apply(null,arguments)},...m),b=p(function(){i++;const k=dm(w,arguments);return a=S.apply(null,k),a},...v);return Object.assign(b,{resultFunc:c,memoizedResultFunc:S,dependencies:w,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>a,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:d,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var vd=gm(yd),mm=Object.assign((t,e=vd)=>{lm(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((i,a,l)=>(i[r[l]]=a,i),{}))},{withTypes:()=>mm}),uo={},xl;function ym(){if(xl)return uo;xl=1;var t=Kp(),e=t.mark(s),r=pa(),n=r.wrapWithIterableIterator,o=r.ensureIterable;function s(){var a,l,c,u,d,h,p=arguments;return t.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:for(a=p.length,l=new Array(a),c=0;c<a;c++)l[c]=p[c];u=0,d=l;case 2:if(!(u<d.length)){m.next=8;break}return h=d[u],m.delegateYield(o(h),"t0",5);case 5:u++,m.next=2;break;case 8:case"end":return m.stop()}},e)}uo.__concat=s;var i=n(s);return uo.concat=i,uo}var ho={},_l;function vm(){if(_l)return ho;_l=1;var t=pa(),e=t.iterableCurry,r=Mg(),n=r.__firstOr,o=Symbol("none");function s(a){return n(a,o)===o}ho.__isEmpty=s;var i=e(s,{reduces:!0});return ho.isEmpty=i,ho}var fo={},Sl;function wm(){if(Sl)return fo;Sl=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,d=function(){};return{s:d,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(v){throw v},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,p=!1,y;return{s:function(){c=a[Symbol.iterator]()},n:function(){var v=c.next();return h=v.done,v},e:function(v){p=!0,y=v},f:function(){try{!h&&c.return!=null&&c.return()}finally{if(p)throw y}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=pa(),o=n.ensureIterable;function s(a){var l=o(a),c=0,u=t(l),d;try{for(u.s();!(d=u.n()).done;){var h=d.value;c++}}catch(p){u.e(p)}finally{u.f()}return c}fo.__size=s;var i=s;return fo.size=i,fo}var As,kl;function bm(){return kl||(kl=1,As=ym().concat),As}var xm=bm();const Cl=Yn(xm);var Os,Pl;function _m(){return Pl||(Pl=1,Os=vm().isEmpty),Os}var Sm=_m();const ka=Yn(Sm);var Is,El;function km(){return El||(El=1,Is=wm().size),Is}var Cm=km();const wd=Yn(Cm),bd=class Ai extends Xp{constructor(e){e={...Ai.defaultOptions,...e},super(e),this.enabled=!0,this._state=im.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1)}apply(e,r,n,o){e.applyFilter(this,r,n,o)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:r,gl:n,...o}=e;let s,i;return r&&(s=Hu.from(r)),n&&(i=Et.from(n)),new Ai({gpuProgram:s,glProgram:i,...o})}};bd.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Yt=bd;const Oi=[];ga.handleByNamedList(Ln.Environment,Oi);async function Pm(t){if(!t)for(let e=0;e<Oi.length;e++){const r=Oi[e];if(r.value.test()){await r.value.load();return}}}let wn;function Em(){if(typeof wn=="boolean")return wn;try{wn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{wn=!1}return wn}var xd=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(xd||{});class Tm{constructor(e){this.items=[],this._name=e}emit(e,r,n,o,s,i,a,l){const{name:c,items:u}=this;for(let d=0,h=u.length;d<h;d++)u[d][c](e,r,n,o,s,i,a,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&this.items.splice(r,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Rm=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],_d=class Sd extends Jp{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const r=[...Rm,...this.config.runners??[]];this._addRunners(...r),this._unsafeEvalCheck()}async init(e={}){const r=e.skipExtensionImports===!0?!0:e.manageImports===!1;await Pm(r),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)e={...this._systemsHash[n].constructor.defaultOptions,...e};e={...Sd.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(e);this._initOptions=e}render(e,r){let n=e;if(n instanceof te&&(n={container:n},r&&(Mn(Bn,"passing a second argument is deprecated, please use render options instead"),n.target=r.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor??(n.clearColor=this.background.colorRgba),n.clear??(n.clear=this.background.clearBeforeRender)),n.clearColor){const o=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=o?n.clearColor:V.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),n.container.enableRenderGroup(),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(e,r,n){const o=this.view.resolution;this.view.resize(e,r,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==o&&this.runners.resolutionChange.emit(n)}clear(e={}){const r=this;e.target||(e.target=r.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=xd.ALL);const{clear:n,clearColor:o,target:s}=e;V.shared.setValue(o??this.background.colorRgba),r.renderTarget.clear(s,n,V.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(r=>{this.runners[r]=new Tm(r)})}_addSystems(e){let r;for(r in e){const n=e[r];this._addSystem(n.value,n.name)}}_addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const o in this.runners)this.runners[o].add(n);return this}_addPipes(e,r){const n=r.reduce((o,s)=>(o[s.name]=s.value,o),{});e.forEach(o=>{const s=o.value,i=o.name,a=n[i];this.renderPipes[i]=new s(this,a?new a:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(r=>{r.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Em())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};_d.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let kd=_d,po;function Am(t){return po!==void 0||(po=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:t??kd.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Pi.get().getWebGLRenderingContext())return!1;let n=Pi.get().createCanvas().getContext("webgl",e);const o=!!n?.getContextAttributes()?.stencil;if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,o}catch{return!1}})()),po}let go;async function Om(t={}){return go!==void 0||(go=await(async()=>{const e=Pi.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(t)).requestDevice(),!0}catch{return!1}})()),go}const Tl=["webgl","webgpu","canvas"];async function Im(t){let e=[];t.preference?(e.push(t.preference),Tl.forEach(s=>{s!==t.preference&&e.push(s)})):e=Tl.slice();let r,n={};for(let s=0;s<e.length;s++){const i=e[s];if(i==="webgpu"&&await Om()){const{WebGPURenderer:a}=await Ut(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-jEd_BskH.js");return{WebGPURenderer:l}},__vite__mapDeps([0,1,2,3,4,5,6]));r=a,n={...t,...t.webgpu};break}else if(i==="webgl"&&Am(t.failIfMajorPerformanceCaveat??kd.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ut(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-D-jkawIW.js");return{WebGLRenderer:l}},__vite__mapDeps([7,1,2,3,4,5,6]));r=a,n={...t,...t.webgl};break}else if(i==="canvas")throw n={...t},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!r)throw new Error("No available renderer for the current environment");const o=new r;return await o.init(n),o}const Cd="8.8.1";class Pd{static init(){globalThis.__PIXI_APP_INIT__?.(this,Cd)}static destroy(){}}Pd.extension=Ln.Application;class jm{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Cd)}destroy(){this._renderer=null}}jm.extension={type:[Ln.WebGLSystem,Ln.WebGPUSystem],name:"initHook",priority:-10};const Ed=class Ii{constructor(...e){this.stage=new te,e[0]!==void 0&&Mn(Bn,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await Im(e),Ii._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Mn(Bn,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,r=!1){const n=Ii._plugins.slice(0);n.reverse(),n.forEach(o=>{o.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Ed._plugins=[];let Td=Ed;ga.handleByList(Ln.Application,Td._plugins);ga.add(Pd);var $m=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,zm=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,Rl=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;const Rd=class Ad extends Yt{constructor(e){e={...Ad.defaultOptions,...e};const r=Hu.from({vertex:{source:Rl,entryPoint:"mainVertex"},fragment:{source:Rl,entryPoint:"mainFragment"}}),n=Et.from({vertex:$m,fragment:zm,name:"alpha-filter"}),{alpha:o,...s}=e,i=new Yp({uAlpha:{value:o,type:"f32"}});super({...s,gpuProgram:r,glProgram:n,resources:{alphaUniforms:i}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};Rd.defaultOptions={alpha:1};let Nm=Rd;class Hn extends un{constructor(...e){let r=e[0];Array.isArray(e[0])&&(r={textures:e[0],autoUpdate:e[1]});const{animationSpeed:n=1,autoPlay:o=!1,autoUpdate:s=!0,loop:i=!0,onComplete:a=null,onFrameChange:l=null,onLoop:c=null,textures:u,updateAnchor:d=!1,...h}=r,[p]=u;super({...h,texture:p instanceof St?p:p.texture}),this._textures=null,this._durations=null,this._autoUpdate=s,this._isConnectedToTicker=!1,this.animationSpeed=n,this.loop=i,this.updateAnchor=d,this.onComplete=a,this.onFrameChange=l,this.onLoop=c,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=u,o&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Vr.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Vr.shared.add(this.update,this,Zp.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const r=e.deltaTime,n=this.animationSpeed*r,o=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=n/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const i=Math.sign(this.animationSpeed*r);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):o!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<o||this.animationSpeed<0&&this.currentFrame>o)&&this.onLoop(),this._updateTexture())}_updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const r=[];for(let n=0;n<e.length;++n)r.push(St.from(e[n]));return new Hn(r)}static fromImages(e){const r=[];for(let n=0;n<e.length;++n)r.push(St.from(e[n]));return new Hn(r)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof St)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Vr.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Vr.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class Dm{constructor({matrix:e,observer:r}={}){this.dirty=!0,this._matrix=e??new Qp,this.observer=r,this.position=new Kr(this,0,0),this.scale=new Kr(this,1,1),this.pivot=new Kr(this,0,0),this.skew=new Kr(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const e=this._matrix;return this.dirty&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this.dirty=!1),e}_onUpdate(e){this.dirty=!0,e===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(e){e.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this.skew))}}const Od=class Io extends Wu{constructor(...e){let r=e[0]||{};r instanceof St&&(r={texture:r}),e.length>1&&(Mn(Bn,"use new TilingSprite({ texture, width:100, height:100 }) instead"),r.width=e[1],r.height=e[2]),r={...Io.defaultOptions,...r};const{texture:n,anchor:o,tilePosition:s,tileScale:i,tileRotation:a,width:l,height:c,applyAnchorToTexture:u,roundPixels:d,...h}=r??{};super({label:"TilingSprite",...h}),this.renderPipeId="tilingSprite",this.batched=!0,this.allowChildren=!1,this._anchor=new Kr({_onUpdate:()=>{this.onViewUpdate()}}),this.applyAnchorToTexture=u,this.texture=n,this._width=l??n.width,this._height=c??n.height,this._tileTransform=new Dm({observer:{_onUpdate:()=>this.onViewUpdate()}}),o&&(this.anchor=o),this.tilePosition=s,this.tileScale=i,this.tileRotation=a,this.roundPixels=d??!1}static from(e,r={}){return typeof e=="string"?new Io({texture:eg.get(e),...r}):new Io({texture:e,...r})}get uvRespectAnchor(){return Ei("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture}set uvRespectAnchor(e){Ei("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture=e}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(e){this._texture.textureMatrix.clampMargin=e}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get tilePosition(){return this._tileTransform.position}set tilePosition(e){this._tileTransform.position.copyFrom(e)}get tileScale(){return this._tileTransform.scale}set tileScale(e){typeof e=="number"?this._tileTransform.scale.set(e):this._tileTransform.scale.copyFrom(e)}set tileRotation(e){this._tileTransform.rotation=e}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}set texture(e){e||(e=St.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}set width(e){this._width=e,this.onViewUpdate()}get width(){return this._width}set height(e){this._height=e,this.onViewUpdate()}get height(){return this._height}setSize(e,r){typeof e=="object"&&(r=e.height??e.width,e=e.width),this._width=e,this._height=r??e,this.onViewUpdate()}getSize(e){return e||(e={}),e.width=this._width,e.height=this._height,e}updateBounds(){const e=this._bounds,r=this._anchor,n=this._width,o=this._height;e.minX=-r._x*n,e.maxX=e.minX+n,e.minY=-r._y*o,e.maxY=e.minY+o}containsPoint(e){const r=this._width,n=this._height,o=-r*this._anchor._x;let s=0;return e.x>=o&&e.x<=o+r&&(s=-n*this._anchor._y,e.y>=s&&e.y<=s+n)}destroy(e=!1){if(super.destroy(e),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null}};Od.defaultOptions={texture:St.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};let Lm=Od;class Mm extends Wu{constructor(e,r){const{text:n,resolution:o,style:s,anchor:i,width:a,height:l,roundPixels:c,...u}=e;super({...u}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=r,this.text=n??"",this.style=s,this.resolution=o??null,this.allowChildren=!1,this._anchor=new Kr({_onUpdate:()=>{this.onViewUpdate()}}),i&&(this.anchor=i),this.roundPixels=c??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this.bounds.width),r!==void 0&&this._setHeight(r,this.bounds.height)}containsPoint(e){const r=this.bounds.width,n=this.bounds.height,o=-r*this.anchor.x;let s=0;return e.x>=o&&e.x<=o+r&&(s=-n*this.anchor.y,e.y>=s&&e.y<=s+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}}function Bm(t,e){let r=t[0]??{};return(typeof r=="string"||t[1])&&(Mn(Bn,`use new ${e}({ text: "hi!", style }) instead`),r={text:r,style:t[1]}),r}class Fm extends Mm{constructor(...e){const r=Bm(e,"Text");super(r,tg),this.renderPipeId="text"}updateBounds(){const e=this._bounds,r=this._anchor,n=rg.measureText(this._text,this._style),{width:o,height:s}=n;e.minX=-r._x*o,e.maxX=e.minX+o,e.minY=-r._y*s,e.maxY=e.minY+s}}class Ca extends St{static create(e){return new Ca({source:new ng(e)})}resize(e,r,n){return this.source.resize(e,r,n),this}}const Id=class jd extends te{constructor(e={}){e={...jd.defaultOptions,...e},super(),this.renderLayerChildren=[],this.sortableChildren=e.sortableChildren,this.sortFunction=e.sortFunction}attach(...e){for(let r=0;r<e.length;r++){const n=e[r];if(n.parentRenderLayer){if(n.parentRenderLayer===this)continue;n.parentRenderLayer.detach(n)}this.renderLayerChildren.push(n),n.parentRenderLayer=this;const o=this.renderGroup||this.parentRenderGroup;o&&(o.structureDidChange=!0)}return e[0]}detach(...e){for(let r=0;r<e.length;r++){const n=e[r],o=this.renderLayerChildren.indexOf(n);o!==-1&&this.renderLayerChildren.splice(o,1),n.parentRenderLayer=null;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)}return e[0]}detachAll(){const e=this.renderLayerChildren;for(let r=0;r<e.length;r++)e[r].parentRenderLayer=null;this.renderLayerChildren.length=0}collectRenderables(e,r,n){const o=this.renderLayerChildren,s=o.length;this.sortableChildren&&this.sortRenderLayerChildren();for(let i=0;i<s;i++)o[i].parent||Ei("Container must be added to both layer and scene graph. Layers only handle render order - the scene graph is required for transforms (addChild)",o[i]),o[i].collectRenderables(e,r,this)}sortRenderLayerChildren(){this.renderLayerChildren.sort(this.sortFunction)}_getGlobalBoundsRecursive(e,r,n){if(!e)return;const o=this.renderLayerChildren;for(let s=0;s<o.length;s++)o[s]._getGlobalBoundsRecursive(!0,r,this)}};Id.defaultOptions={sortableChildren:!1,sortFunction:(t,e)=>t.zIndex-e.zIndex};let Um=Id;const Al=Um,Pa="-",Hm=t=>{const e=Gm(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:i=>{const a=i.split(Pa);return a[0]===""&&a.length!==1&&a.shift(),$d(a,e)||Wm(i)},getConflictingClassGroupIds:(i,a)=>{const l=r[i]||[];return a&&n[i]?[...l,...n[i]]:l}}},$d=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),o=n?$d(t.slice(1),n):void 0;if(o)return o;if(e.validators.length===0)return;const s=t.join(Pa);return e.validators.find(({validator:i})=>i(s))?.classGroupId},Ol=/^\[(.+)\]$/,Wm=t=>{if(Ol.test(t)){const e=Ol.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Gm=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return Vm(Object.entries(t.classGroups),r).forEach(([s,i])=>{ji(i,n,s,e)}),n},ji=(t,e,r,n)=>{t.forEach(o=>{if(typeof o=="string"){const s=o===""?e:Il(e,o);s.classGroupId=r;return}if(typeof o=="function"){if(qm(o)){ji(o(n),e,r,n);return}e.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(([s,i])=>{ji(i,Il(e,s),r,n)})})},Il=(t,e)=>{let r=t;return e.split(Pa).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},qm=t=>t.isThemeGetter,Vm=(t,e)=>e?t.map(([r,n])=>{const o=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,a])=>[e+i,a])):s);return[r,o]}):t,Km=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const o=(s,i)=>{r.set(s,i),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return o(s,i),i},set(s,i){r.has(s)?r.set(s,i):o(s,i)}}},zd="!",Xm=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,o=e[0],s=e.length,i=a=>{const l=[];let c=0,u=0,d;for(let v=0;v<a.length;v++){let w=a[v];if(c===0){if(w===o&&(n||a.slice(v,v+s)===e)){l.push(a.slice(u,v)),u=v+s;continue}if(w==="/"){d=v;continue}}w==="["?c++:w==="]"&&c--}const h=l.length===0?a:a.substring(u),p=h.startsWith(zd),y=p?h.substring(1):h,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:m}};return r?a=>r({className:a,parseClassName:i}):i},Jm=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},Ym=t=>({cache:Km(t.cacheSize),parseClassName:Xm(t),...Hm(t)}),Zm=/\s+/,Qm=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o}=e,s=[],i=t.trim().split(Zm);let a="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:p}=r(c);let y=!!p,m=n(y?h.substring(0,p):h);if(!m){if(!y){a=c+(a.length>0?" "+a:a);continue}if(m=n(h),!m){a=c+(a.length>0?" "+a:a);continue}y=!1}const v=Jm(u).join(":"),w=d?v+zd:v,S=w+m;if(s.includes(S))continue;s.push(S);const b=o(m,y);for(let x=0;x<b.length;++x){const k=b[x];s.push(w+k)}a=c+(a.length>0?" "+a:a)}return a};function ey(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Nd(e))&&(n&&(n+=" "),n+=r);return n}const Nd=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=Nd(t[n]))&&(r&&(r+=" "),r+=e);return r};function ty(t,...e){let r,n,o,s=i;function i(l){const c=e.reduce((u,d)=>d(u),t());return r=Ym(c),n=r.cache.get,o=r.cache.set,s=a,a(l)}function a(l){const c=n(l);if(c)return c;const u=Qm(l,r);return o(l,u),u}return function(){return s(ey.apply(null,arguments))}}const pe=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Dd=/^\[(?:([a-z-]+):)?(.+)\]$/i,ry=/^\d+\/\d+$/,ny=new Set(["px","full","screen"]),oy=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sy=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iy=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ay=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ly=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,yt=t=>Zr(t)||ny.has(t)||ry.test(t),At=t=>fn(t,"length",my),Zr=t=>!!t&&!Number.isNaN(Number(t)),js=t=>fn(t,"number",Zr),bn=t=>!!t&&Number.isInteger(Number(t)),cy=t=>t.endsWith("%")&&Zr(t.slice(0,-1)),Y=t=>Dd.test(t),Ot=t=>oy.test(t),uy=new Set(["length","size","percentage"]),dy=t=>fn(t,uy,Ld),hy=t=>fn(t,"position",Ld),fy=new Set(["image","url"]),py=t=>fn(t,fy,vy),gy=t=>fn(t,"",yy),xn=()=>!0,fn=(t,e,r)=>{const n=Dd.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},my=t=>sy.test(t)&&!iy.test(t),Ld=()=>!1,yy=t=>ay.test(t),vy=t=>ly.test(t),wy=()=>{const t=pe("colors"),e=pe("spacing"),r=pe("blur"),n=pe("brightness"),o=pe("borderColor"),s=pe("borderRadius"),i=pe("borderSpacing"),a=pe("borderWidth"),l=pe("contrast"),c=pe("grayscale"),u=pe("hueRotate"),d=pe("invert"),h=pe("gap"),p=pe("gradientColorStops"),y=pe("gradientColorStopPositions"),m=pe("inset"),v=pe("margin"),w=pe("opacity"),S=pe("padding"),b=pe("saturate"),x=pe("scale"),k=pe("sepia"),C=pe("skew"),_=pe("space"),j=pe("translate"),M=()=>["auto","contain","none"],N=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto",Y,e],I=()=>[Y,e],re=()=>["",yt,At],B=()=>["auto",Zr,Y],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],q=()=>["solid","dashed","dotted","double","none"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],ie=()=>["","0",Y],ue=()=>["auto","avoid","all","avoid-page","page","left","right","column"],le=()=>[Zr,Y];return{cacheSize:500,separator:":",theme:{colors:[xn],spacing:[yt,At],blur:["none","",Ot,Y],brightness:le(),borderColor:[t],borderRadius:["none","","full",Ot,Y],borderSpacing:I(),borderWidth:re(),contrast:le(),grayscale:ie(),hueRotate:le(),invert:ie(),gap:I(),gradientColorStops:[t],gradientColorStopPositions:[cy,At],inset:G(),margin:G(),opacity:le(),padding:I(),saturate:le(),scale:le(),sepia:ie(),skew:le(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Y]}],container:["container"],columns:[{columns:[Ot]}],"break-after":[{"break-after":ue()}],"break-before":[{"break-before":ue()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),Y]}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bn,Y]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Y]}],grow:[{grow:ie()}],shrink:[{shrink:ie()}],order:[{order:["first","last","none",bn,Y]}],"grid-cols":[{"grid-cols":[xn]}],"col-start-end":[{col:["auto",{span:["full",bn,Y]},Y]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[xn]}],"row-start-end":[{row:["auto",{span:[bn,Y]},Y]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Y]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Y]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Y,e]}],"min-w":[{"min-w":[Y,e,"min","max","fit"]}],"max-w":[{"max-w":[Y,e,"none","full","min","max","fit","prose",{screen:[Ot]},Ot]}],h:[{h:[Y,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Y,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ot,At]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",js]}],"font-family":[{font:[xn]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Y]}],"line-clamp":[{"line-clamp":["none",Zr,js]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",yt,Y]}],"list-image":[{"list-image":["none",Y]}],"list-style-type":[{list:["none","disc","decimal",Y]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",yt,At]}],"underline-offset":[{"underline-offset":["auto",yt,Y]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),hy]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",dy]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},py]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...q(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:q()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...q()]}],"outline-offset":[{"outline-offset":[yt,Y]}],"outline-w":[{outline:[yt,At]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:re()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[yt,At]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ot,gy]}],"shadow-color":[{shadow:[xn]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ot,Y]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Y]}],duration:[{duration:le()}],ease:[{ease:["linear","in","out","in-out",Y]}],delay:[{delay:le()}],animate:[{animate:["none","spin","ping","pulse","bounce",Y]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[bn,Y]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Y]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Y]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Y]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[yt,At,js]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Md=ty(wy);function Bd(t){if(!qo(t))throw new Error(`Invalid textureId: "${t}"; textureId ∋ {${Object.keys(xr.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function qo(t){return xr.frames[t]!==void 0}function Fd(t){return xr.animations[t]!==void 0}const by=t=>t.replaceAll(".","_"),Q=({children:t,className:e,noSlitWords:r,classnameCycle:n,onClick:o,noTint:s=!1,TagName:i="span"})=>{const a=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(a.length===0)return null;const l=r?[a.toUpperCase()]:a.toUpperCase().split(/\s+/);return f.jsxs(i,{className:e,onClick:o,children:[f.jsx("span",{className:"sr-only",children:a}),l.map((c,u)=>f.jsx("span",{className:Md("text-nowrap inline-block",u===l.length-1?"":"me-1"),children:Array.from(c).map((d,h)=>{const p=`hud.char.${Gu(d)}`;return qo(p)||console.error("no texture for char",d,d.charCodeAt(0),p,"we have:",Object.keys(Ht().textures)),f.jsx("span",{className:`sprite ${qo(p)?`texture-${by(p)}`:"texture-hud_char_?"}
                  ${s?"":"sprite-tinted"}
                  ${n===void 0?"":n[h%n.length]}`},h)})},u))]})};function Fe(t,e,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t?.(o),r===!1||!o.defaultPrevented)return e?.(o)}}function jl(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Ud(...t){return e=>{let r=!1;const n=t.map(o=>{const s=jl(o,e);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s=="function"?s():jl(t[o],null)}}}}function ot(...t){return g.useCallback(Ud(...t),t)}function xy(t,e){const r=g.createContext(e),n=s=>{const{children:i,...a}=s,l=g.useMemo(()=>a,Object.values(a));return f.jsx(r.Provider,{value:l,children:i})};n.displayName=t+"Provider";function o(s){const i=g.useContext(r);if(i)return i;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[n,o]}function Ea(t,e=[]){let r=[];function n(s,i){const a=g.createContext(i),l=r.length;r=[...r,i];const c=d=>{const{scope:h,children:p,...y}=d,m=h?.[t]?.[l]||a,v=g.useMemo(()=>y,Object.values(y));return f.jsx(m.Provider,{value:v,children:p})};c.displayName=s+"Provider";function u(d,h){const p=h?.[t]?.[l]||a,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const o=()=>{const s=r.map(i=>g.createContext(i));return function(a){const l=a?.[t]||s;return g.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return o.scopeName=t,[n,_y(o,...e)]}function _y(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return r.scopeName=e.scopeName,r}var Ta=og();const Sy=Yn(Ta);var is=g.forwardRef((t,e)=>{const{children:r,...n}=t,o=g.Children.toArray(r),s=o.find(Cy);if(s){const i=s.props.children,a=o.map(l=>l===s?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:l);return f.jsx($i,{...n,ref:e,children:g.isValidElement(i)?g.cloneElement(i,void 0,a):null})}return f.jsx($i,{...n,ref:e,children:r})});is.displayName="Slot";var $i=g.forwardRef((t,e)=>{const{children:r,...n}=t;if(g.isValidElement(r)){const o=Ey(r),s=Py(n,r.props);return r.type!==g.Fragment&&(s.ref=e?Ud(e,o):o),g.cloneElement(r,s)}return g.Children.count(r)>1?g.Children.only(null):null});$i.displayName="SlotClone";var ky=({children:t})=>f.jsx(f.Fragment,{children:t});function Cy(t){return g.isValidElement(t)&&t.type===ky}function Py(t,e){const r={...e};for(const n in e){const o=t[n],s=e[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...a)=>{s(...a),o(...a)}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...t,...r}}function Ey(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Ty=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],we=Ty.reduce((t,e)=>{const r=g.forwardRef((n,o)=>{const{asChild:s,...i}=n,a=s?is:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(a,{...i,ref:o})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function Ry(t,e){t&&Ta.flushSync(()=>t.dispatchEvent(e))}function qt(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...r)=>e.current?.(...r),[])}function Ay(t,e=globalThis?.document){const r=qt(t);g.useEffect(()=>{const n=o=>{o.key==="Escape"&&r(o)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var Oy="DismissableLayer",zi="dismissableLayer.update",Iy="dismissableLayer.pointerDownOutside",jy="dismissableLayer.focusOutside",$l,Hd=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ra=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:a,...l}=t,c=g.useContext(Hd),[u,d]=g.useState(null),h=u?.ownerDocument??globalThis?.document,[,p]=g.useState({}),y=ot(e,_=>d(_)),m=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=m.indexOf(v),S=u?m.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,x=S>=w,k=Ny(_=>{const j=_.target,M=[...c.branches].some(N=>N.contains(j));!x||M||(o?.(_),i?.(_),_.defaultPrevented||a?.())},h),C=Dy(_=>{const j=_.target;[...c.branches].some(N=>N.contains(j))||(s?.(_),i?.(_),_.defaultPrevented||a?.())},h);return Ay(_=>{S===c.layers.size-1&&(n?.(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},h),g.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&($l=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),zl(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=$l)}},[u,h,r,c]),g.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),zl())},[u,c]),g.useEffect(()=>{const _=()=>p({});return document.addEventListener(zi,_),()=>document.removeEventListener(zi,_)},[]),f.jsx(we.div,{...l,ref:y,style:{pointerEvents:b?x?"auto":"none":void 0,...t.style},onFocusCapture:Fe(t.onFocusCapture,C.onFocusCapture),onBlurCapture:Fe(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Fe(t.onPointerDownCapture,k.onPointerDownCapture)})});Ra.displayName=Oy;var $y="DismissableLayerBranch",zy=g.forwardRef((t,e)=>{const r=g.useContext(Hd),n=g.useRef(null),o=ot(e,n);return g.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),f.jsx(we.div,{...t,ref:o})});zy.displayName=$y;function Ny(t,e=globalThis?.document){const r=qt(t),n=g.useRef(!1),o=g.useRef(()=>{});return g.useEffect(()=>{const s=a=>{if(a.target&&!n.current){let l=function(){Wd(Iy,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=l,e.addEventListener("click",o.current,{once:!0})):l()}else e.removeEventListener("click",o.current);n.current=!1},i=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),e.removeEventListener("pointerdown",s),e.removeEventListener("click",o.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function Dy(t,e=globalThis?.document){const r=qt(t),n=g.useRef(!1);return g.useEffect(()=>{const o=s=>{s.target&&!n.current&&Wd(jy,r,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function zl(){const t=new CustomEvent(zi);document.dispatchEvent(t)}function Wd(t,e,r,{discrete:n}){const o=r.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&o.addEventListener(t,e,{once:!0}),n?Ry(o,s):o.dispatchEvent(s)}var $s=0;function Gd(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Nl()),document.body.insertAdjacentElement("beforeend",t[1]??Nl()),$s++,()=>{$s===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),$s--}},[])}function Nl(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var zs="focusScope.autoFocusOnMount",Ns="focusScope.autoFocusOnUnmount",Dl={bubbles:!1,cancelable:!0},Ly="FocusScope",Aa=g.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=t,[a,l]=g.useState(null),c=qt(o),u=qt(s),d=g.useRef(null),h=ot(e,m=>l(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(n){let m=function(b){if(p.paused||!a)return;const x=b.target;a.contains(x)?d.current=x:Nt(d.current,{select:!0})},v=function(b){if(p.paused||!a)return;const x=b.relatedTarget;x!==null&&(a.contains(x)||Nt(d.current,{select:!0}))},w=function(b){if(document.activeElement===document.body)for(const k of b)k.removedNodes.length>0&&Nt(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const S=new MutationObserver(w);return a&&S.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),S.disconnect()}}},[n,a,p.paused]),g.useEffect(()=>{if(a){Ml.add(p);const m=document.activeElement;if(!a.contains(m)){const w=new CustomEvent(zs,Dl);a.addEventListener(zs,c),a.dispatchEvent(w),w.defaultPrevented||(My(Wy(qd(a)),{select:!0}),document.activeElement===m&&Nt(a))}return()=>{a.removeEventListener(zs,c),setTimeout(()=>{const w=new CustomEvent(Ns,Dl);a.addEventListener(Ns,u),a.dispatchEvent(w),w.defaultPrevented||Nt(m??document.body,{select:!0}),a.removeEventListener(Ns,u),Ml.remove(p)},0)}}},[a,c,u,p]);const y=g.useCallback(m=>{if(!r&&!n||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,w=document.activeElement;if(v&&w){const S=m.currentTarget,[b,x]=By(S);b&&x?!m.shiftKey&&w===x?(m.preventDefault(),r&&Nt(b,{select:!0})):m.shiftKey&&w===b&&(m.preventDefault(),r&&Nt(x,{select:!0})):w===S&&m.preventDefault()}},[r,n,p.paused]);return f.jsx(we.div,{tabIndex:-1,...i,ref:h,onKeyDown:y})});Aa.displayName=Ly;function My(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(Nt(n,{select:e}),document.activeElement!==r)return}function By(t){const e=qd(t),r=Ll(e,t),n=Ll(e.reverse(),t);return[r,n]}function qd(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function Ll(t,e){for(const r of t)if(!Fy(r,{upTo:e}))return r}function Fy(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Uy(t){return t instanceof HTMLInputElement&&"select"in t}function Nt(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Uy(t)&&e&&t.select()}}var Ml=Hy();function Hy(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=Bl(t,e),t.unshift(e)},remove(e){t=Bl(t,e),t[0]?.resume()}}}function Bl(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function Wy(t){return t.filter(e=>e.tagName!=="A")}var pr=globalThis?.document?g.useLayoutEffect:()=>{},Gy=qu.useId||(()=>{}),qy=0;function ut(t){const[e,r]=g.useState(Gy());return pr(()=>{r(n=>n??String(qy++))},[t]),t||(e?`radix-${e}`:"")}const Vy=["top","right","bottom","left"],Vt=Math.min,Me=Math.max,Vo=Math.round,mo=Math.floor,dt=t=>({x:t,y:t}),Ky={left:"right",right:"left",bottom:"top",top:"bottom"},Xy={start:"end",end:"start"};function Ni(t,e,r){return Me(t,Vt(e,r))}function Ct(t,e){return typeof t=="function"?t(e):t}function Pt(t){return t.split("-")[0]}function pn(t){return t.split("-")[1]}function Oa(t){return t==="x"?"y":"x"}function Ia(t){return t==="y"?"height":"width"}function Kt(t){return["top","bottom"].includes(Pt(t))?"y":"x"}function ja(t){return Oa(Kt(t))}function Jy(t,e,r){r===void 0&&(r=!1);const n=pn(t),o=ja(t),s=Ia(o);let i=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(i=Ko(i)),[i,Ko(i)]}function Yy(t){const e=Ko(t);return[Di(t),e,Di(e)]}function Di(t){return t.replace(/start|end/g,e=>Xy[e])}function Zy(t,e,r){const n=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(t){case"top":case"bottom":return r?e?o:n:e?n:o;case"left":case"right":return e?s:i;default:return[]}}function Qy(t,e,r,n){const o=pn(t);let s=Zy(Pt(t),r==="start",n);return o&&(s=s.map(i=>i+"-"+o),e&&(s=s.concat(s.map(Di)))),s}function Ko(t){return t.replace(/left|right|bottom|top/g,e=>Ky[e])}function ev(t){return{top:0,right:0,bottom:0,left:0,...t}}function Vd(t){return typeof t!="number"?ev(t):{top:t,right:t,bottom:t,left:t}}function Xo(t){const{x:e,y:r,width:n,height:o}=t;return{width:n,height:o,top:r,left:e,right:e+n,bottom:r+o,x:e,y:r}}function Fl(t,e,r){let{reference:n,floating:o}=t;const s=Kt(e),i=ja(e),a=Ia(i),l=Pt(e),c=s==="y",u=n.x+n.width/2-o.width/2,d=n.y+n.height/2-o.height/2,h=n[a]/2-o[a]/2;let p;switch(l){case"top":p={x:u,y:n.y-o.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-o.width,y:d};break;default:p={x:n.x,y:n.y}}switch(pn(e)){case"start":p[i]-=h*(r&&c?-1:1);break;case"end":p[i]+=h*(r&&c?-1:1);break}return p}const tv=async(t,e,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:s=[],platform:i}=r,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(e));let c=await i.getElementRects({reference:t,floating:e,strategy:o}),{x:u,y:d}=Fl(c,n,l),h=n,p={},y=0;for(let m=0;m<a.length;m++){const{name:v,fn:w}=a[m],{x:S,y:b,data:x,reset:k}=await w({x:u,y:d,initialPlacement:n,placement:h,strategy:o,middlewareData:p,rects:c,platform:i,elements:{reference:t,floating:e}});u=S??u,d=b??d,p={...p,[v]:{...p[v],...x}},k&&y<=50&&(y++,typeof k=="object"&&(k.placement&&(h=k.placement),k.rects&&(c=k.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:o}):k.rects),{x:u,y:d}=Fl(c,h,l)),m=-1)}return{x:u,y:d,placement:h,strategy:o,middlewareData:p}};async function Wn(t,e){var r;e===void 0&&(e={});const{x:n,y:o,platform:s,rects:i,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=Ct(e,t),y=Vd(p),v=a[h?d==="floating"?"reference":"floating":d],w=Xo(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(v)))==null||r?v:v.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),S=d==="floating"?{x:n,y:o,width:i.floating.width,height:i.floating.height}:i.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),x=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},k=Xo(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:S,offsetParent:b,strategy:l}):S);return{top:(w.top-k.top+y.top)/x.y,bottom:(k.bottom-w.bottom+y.bottom)/x.y,left:(w.left-k.left+y.left)/x.x,right:(k.right-w.right+y.right)/x.x}}const rv=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:o,rects:s,platform:i,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Ct(t,e)||{};if(c==null)return{};const d=Vd(u),h={x:r,y:n},p=ja(o),y=Ia(p),m=await i.getDimensions(c),v=p==="y",w=v?"top":"left",S=v?"bottom":"right",b=v?"clientHeight":"clientWidth",x=s.reference[y]+s.reference[p]-h[p]-s.floating[y],k=h[p]-s.reference[p],C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let _=C?C[b]:0;(!_||!await(i.isElement==null?void 0:i.isElement(C)))&&(_=a.floating[b]||s.floating[y]);const j=x/2-k/2,M=_/2-m[y]/2-1,N=Vt(d[w],M),G=Vt(d[S],M),I=N,re=_-m[y]-G,B=_/2-m[y]/2+j,X=Ni(I,B,re),q=!l.arrow&&pn(o)!=null&&B!==X&&s.reference[y]/2-(B<I?N:G)-m[y]/2<0,se=q?B<I?B-I:B-re:0;return{[p]:h[p]+se,data:{[p]:X,centerOffset:B-X-se,...q&&{alignmentOffset:se}},reset:q}}}),nv=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=Ct(t,e);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const w=Pt(o),S=Kt(a),b=Pt(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=h||(b||!m?[Ko(a)]:Yy(a)),C=y!=="none";!h&&C&&k.push(...Qy(a,m,y,x));const _=[a,...k],j=await Wn(e,v),M=[];let N=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&M.push(j[w]),d){const B=Jy(o,i,x);M.push(j[B[0]],j[B[1]])}if(N=[...N,{placement:o,overflows:M}],!M.every(B=>B<=0)){var G,I;const B=(((G=s.flip)==null?void 0:G.index)||0)+1,X=_[B];if(X)return{data:{index:B,overflows:N},reset:{placement:X}};let q=(I=N.filter(se=>se.overflows[0]<=0).sort((se,K)=>se.overflows[1]-K.overflows[1])[0])==null?void 0:I.placement;if(!q)switch(p){case"bestFit":{var re;const se=(re=N.filter(K=>{if(C){const ie=Kt(K.placement);return ie===S||ie==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(ie=>ie>0).reduce((ie,ue)=>ie+ue,0)]).sort((K,ie)=>K[1]-ie[1])[0])==null?void 0:re[0];se&&(q=se);break}case"initialPlacement":q=a;break}if(o!==q)return{reset:{placement:q}}}return{}}}};function Ul(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Hl(t){return Vy.some(e=>t[e]>=0)}const ov=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...o}=Ct(t,e);switch(n){case"referenceHidden":{const s=await Wn(e,{...o,elementContext:"reference"}),i=Ul(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Hl(i)}}}case"escaped":{const s=await Wn(e,{...o,altBoundary:!0}),i=Ul(s,r.floating);return{data:{escapedOffsets:i,escaped:Hl(i)}}}default:return{}}}}};async function sv(t,e){const{placement:r,platform:n,elements:o}=t,s=await(n.isRTL==null?void 0:n.isRTL(o.floating)),i=Pt(r),a=pn(r),l=Kt(r)==="y",c=["left","top"].includes(i)?-1:1,u=s&&l?-1:1,d=Ct(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof y=="number"&&(p=a==="end"?y*-1:y),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const iv=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:o,y:s,placement:i,middlewareData:a}=e,l=await sv(e,t);return i===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},av=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:o}=e,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:v=>{let{x:w,y:S}=v;return{x:w,y:S}}},...l}=Ct(t,e),c={x:r,y:n},u=await Wn(e,l),d=Kt(Pt(o)),h=Oa(d);let p=c[h],y=c[d];if(s){const v=h==="y"?"top":"left",w=h==="y"?"bottom":"right",S=p+u[v],b=p-u[w];p=Ni(S,p,b)}if(i){const v=d==="y"?"top":"left",w=d==="y"?"bottom":"right",S=y+u[v],b=y-u[w];y=Ni(S,y,b)}const m=a.fn({...e,[h]:p,[d]:y});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:s,[d]:i}}}}}},lv=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:o,rects:s,middlewareData:i}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Ct(t,e),u={x:r,y:n},d=Kt(o),h=Oa(d);let p=u[h],y=u[d];const m=Ct(a,e),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=h==="y"?"height":"width",x=s.reference[h]-s.floating[b]+v.mainAxis,k=s.reference[h]+s.reference[b]-v.mainAxis;p<x?p=x:p>k&&(p=k)}if(c){var w,S;const b=h==="y"?"width":"height",x=["top","left"].includes(Pt(o)),k=s.reference[d]-s.floating[b]+(x&&((w=i.offset)==null?void 0:w[d])||0)+(x?0:v.crossAxis),C=s.reference[d]+s.reference[b]+(x?0:((S=i.offset)==null?void 0:S[d])||0)-(x?v.crossAxis:0);y<k?y=k:y>C&&(y=C)}return{[h]:p,[d]:y}}}},cv=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:o,rects:s,platform:i,elements:a}=e,{apply:l=()=>{},...c}=Ct(t,e),u=await Wn(e,c),d=Pt(o),h=pn(o),p=Kt(o)==="y",{width:y,height:m}=s.floating;let v,w;d==="top"||d==="bottom"?(v=d,w=h===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(w=d,v=h==="end"?"top":"bottom");const S=m-u.top-u.bottom,b=y-u.left-u.right,x=Vt(m-u[v],S),k=Vt(y-u[w],b),C=!e.middlewareData.shift;let _=x,j=k;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(j=b),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(_=S),C&&!h){const N=Me(u.left,0),G=Me(u.right,0),I=Me(u.top,0),re=Me(u.bottom,0);p?j=y-2*(N!==0||G!==0?N+G:Me(u.left,u.right)):_=m-2*(I!==0||re!==0?I+re:Me(u.top,u.bottom))}await l({...e,availableWidth:j,availableHeight:_});const M=await i.getDimensions(a.floating);return y!==M.width||m!==M.height?{reset:{rects:!0}}:{}}}};function as(){return typeof window<"u"}function gn(t){return Kd(t)?(t.nodeName||"").toLowerCase():"#document"}function Ue(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function mt(t){var e;return(e=(Kd(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Kd(t){return as()?t instanceof Node||t instanceof Ue(t).Node:!1}function tt(t){return as()?t instanceof Element||t instanceof Ue(t).Element:!1}function ht(t){return as()?t instanceof HTMLElement||t instanceof Ue(t).HTMLElement:!1}function Wl(t){return!as()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ue(t).ShadowRoot}function eo(t){const{overflow:e,overflowX:r,overflowY:n,display:o}=rt(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(o)}function uv(t){return["table","td","th"].includes(gn(t))}function ls(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function $a(t){const e=za(),r=tt(t)?rt(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function dv(t){let e=Xt(t);for(;ht(e)&&!nn(e);){if($a(e))return e;if(ls(e))return null;e=Xt(e)}return null}function za(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function nn(t){return["html","body","#document"].includes(gn(t))}function rt(t){return Ue(t).getComputedStyle(t)}function cs(t){return tt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Xt(t){if(gn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Wl(t)&&t.host||mt(t);return Wl(e)?e.host:e}function Xd(t){const e=Xt(t);return nn(e)?t.ownerDocument?t.ownerDocument.body:t.body:ht(e)&&eo(e)?e:Xd(e)}function Gn(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const o=Xd(t),s=o===((n=t.ownerDocument)==null?void 0:n.body),i=Ue(o);if(s){const a=Li(i);return e.concat(i,i.visualViewport||[],eo(o)?o:[],a&&r?Gn(a):[])}return e.concat(o,Gn(o,[],r))}function Li(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Jd(t){const e=rt(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const o=ht(t),s=o?t.offsetWidth:r,i=o?t.offsetHeight:n,a=Vo(r)!==s||Vo(n)!==i;return a&&(r=s,n=i),{width:r,height:n,$:a}}function Na(t){return tt(t)?t:t.contextElement}function Qr(t){const e=Na(t);if(!ht(e))return dt(1);const r=e.getBoundingClientRect(),{width:n,height:o,$:s}=Jd(e);let i=(s?Vo(r.width):r.width)/n,a=(s?Vo(r.height):r.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const hv=dt(0);function Yd(t){const e=Ue(t);return!za()||!e.visualViewport?hv:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function fv(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ue(t)?!1:e}function gr(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const o=t.getBoundingClientRect(),s=Na(t);let i=dt(1);e&&(n?tt(n)&&(i=Qr(n)):i=Qr(t));const a=fv(s,r,n)?Yd(s):dt(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(s){const h=Ue(s),p=n&&tt(n)?Ue(n):n;let y=h,m=Li(y);for(;m&&n&&p!==y;){const v=Qr(m),w=m.getBoundingClientRect(),S=rt(m),b=w.left+(m.clientLeft+parseFloat(S.paddingLeft))*v.x,x=w.top+(m.clientTop+parseFloat(S.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=b,c+=x,y=Ue(m),m=Li(y)}}return Xo({width:u,height:d,x:l,y:c})}function Da(t,e){const r=cs(t).scrollLeft;return e?e.left+r:gr(mt(t)).left+r}function Zd(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),o=n.left+e.scrollLeft-(r?0:Da(t,n)),s=n.top+e.scrollTop;return{x:o,y:s}}function pv(t){let{elements:e,rect:r,offsetParent:n,strategy:o}=t;const s=o==="fixed",i=mt(n),a=e?ls(e.floating):!1;if(n===i||a&&s)return r;let l={scrollLeft:0,scrollTop:0},c=dt(1);const u=dt(0),d=ht(n);if((d||!d&&!s)&&((gn(n)!=="body"||eo(i))&&(l=cs(n)),ht(n))){const p=gr(n);c=Qr(n),u.x=p.x+n.clientLeft,u.y=p.y+n.clientTop}const h=i&&!d&&!s?Zd(i,l,!0):dt(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:r.y*c.y-l.scrollTop*c.y+u.y+h.y}}function gv(t){return Array.from(t.getClientRects())}function mv(t){const e=mt(t),r=cs(t),n=t.ownerDocument.body,o=Me(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Me(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Da(t);const a=-r.scrollTop;return rt(n).direction==="rtl"&&(i+=Me(e.clientWidth,n.clientWidth)-o),{width:o,height:s,x:i,y:a}}function yv(t,e){const r=Ue(t),n=mt(t),o=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=za();(!c||c&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function vv(t,e){const r=gr(t,!0,e==="fixed"),n=r.top+t.clientTop,o=r.left+t.clientLeft,s=ht(t)?Qr(t):dt(1),i=t.clientWidth*s.x,a=t.clientHeight*s.y,l=o*s.x,c=n*s.y;return{width:i,height:a,x:l,y:c}}function Gl(t,e,r){let n;if(e==="viewport")n=yv(t,r);else if(e==="document")n=mv(mt(t));else if(tt(e))n=vv(e,r);else{const o=Yd(t);n={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Xo(n)}function Qd(t,e){const r=Xt(t);return r===e||!tt(r)||nn(r)?!1:rt(r).position==="fixed"||Qd(r,e)}function wv(t,e){const r=e.get(t);if(r)return r;let n=Gn(t,[],!1).filter(a=>tt(a)&&gn(a)!=="body"),o=null;const s=rt(t).position==="fixed";let i=s?Xt(t):t;for(;tt(i)&&!nn(i);){const a=rt(i),l=$a(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||eo(i)&&!l&&Qd(t,i))?n=n.filter(u=>u!==i):o=a,i=Xt(i)}return e.set(t,n),n}function bv(t){let{element:e,boundary:r,rootBoundary:n,strategy:o}=t;const i=[...r==="clippingAncestors"?ls(e)?[]:wv(e,this._c):[].concat(r),n],a=i[0],l=i.reduce((c,u)=>{const d=Gl(e,u,o);return c.top=Me(d.top,c.top),c.right=Vt(d.right,c.right),c.bottom=Vt(d.bottom,c.bottom),c.left=Me(d.left,c.left),c},Gl(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function xv(t){const{width:e,height:r}=Jd(t);return{width:e,height:r}}function _v(t,e,r){const n=ht(e),o=mt(e),s=r==="fixed",i=gr(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=dt(0);if(n||!n&&!s)if((gn(e)!=="body"||eo(o))&&(a=cs(e)),n){const h=gr(e,!0,s,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else o&&(l.x=Da(o));const c=o&&!n&&!s?Zd(o,a):dt(0),u=i.left+a.scrollLeft-l.x-c.x,d=i.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:i.width,height:i.height}}function Ds(t){return rt(t).position==="static"}function ql(t,e){if(!ht(t)||rt(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return mt(t)===r&&(r=r.ownerDocument.body),r}function eh(t,e){const r=Ue(t);if(ls(t))return r;if(!ht(t)){let o=Xt(t);for(;o&&!nn(o);){if(tt(o)&&!Ds(o))return o;o=Xt(o)}return r}let n=ql(t,e);for(;n&&uv(n)&&Ds(n);)n=ql(n,e);return n&&nn(n)&&Ds(n)&&!$a(n)?r:n||dv(t)||r}const Sv=async function(t){const e=this.getOffsetParent||eh,r=this.getDimensions,n=await r(t.floating);return{reference:_v(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function kv(t){return rt(t).direction==="rtl"}const Cv={convertOffsetParentRelativeRectToViewportRelativeRect:pv,getDocumentElement:mt,getClippingRect:bv,getOffsetParent:eh,getElementRects:Sv,getClientRects:gv,getDimensions:xv,getScale:Qr,isElement:tt,isRTL:kv};function th(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Pv(t,e){let r=null,n;const o=mt(t);function s(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:p}=c;if(a||e(),!h||!p)return;const y=mo(d),m=mo(o.clientWidth-(u+h)),v=mo(o.clientHeight-(d+p)),w=mo(u),b={rootMargin:-y+"px "+-m+"px "+-v+"px "+-w+"px",threshold:Me(0,Vt(1,l))||1};let x=!0;function k(C){const _=C[0].intersectionRatio;if(_!==l){if(!x)return i();_?i(!1,_):n=setTimeout(()=>{i(!1,1e-7)},1e3)}_===1&&!th(c,t.getBoundingClientRect())&&i(),x=!1}try{r=new IntersectionObserver(k,{...b,root:o.ownerDocument})}catch{r=new IntersectionObserver(k,b)}r.observe(t)}return i(!0),s}function Ev(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Na(t),u=o||s?[...c?Gn(c):[],...Gn(e)]:[];u.forEach(w=>{o&&w.addEventListener("scroll",r,{passive:!0}),s&&w.addEventListener("resize",r)});const d=c&&a?Pv(c,r):null;let h=-1,p=null;i&&(p=new ResizeObserver(w=>{let[S]=w;S&&S.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),r()}),c&&!l&&p.observe(c),p.observe(e));let y,m=l?gr(t):null;l&&v();function v(){const w=gr(t);m&&!th(m,w)&&r(),m=w,y=requestAnimationFrame(v)}return r(),()=>{var w;u.forEach(S=>{o&&S.removeEventListener("scroll",r),s&&S.removeEventListener("resize",r)}),d?.(),(w=p)==null||w.disconnect(),p=null,l&&cancelAnimationFrame(y)}}const Tv=iv,Rv=av,Av=nv,Ov=cv,Iv=ov,Vl=rv,jv=lv,$v=(t,e,r)=>{const n=new Map,o={platform:Cv,...r},s={...o.platform,_c:n};return tv(t,e,{...o,platform:s})};var jo=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Jo(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!Jo(t[n],e[n]))return!1;return!0}if(o=Object.keys(t),r=o.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,o[n]))return!1;for(n=r;n--!==0;){const s=o[n];if(!(s==="_owner"&&t.$$typeof)&&!Jo(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function rh(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Kl(t,e){const r=rh(t);return Math.round(e*r)/r}function Ls(t){const e=g.useRef(t);return jo(()=>{e.current=t}),e}function zv(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=g.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[h,p]=g.useState(n);Jo(h,n)||p(n);const[y,m]=g.useState(null),[v,w]=g.useState(null),S=g.useCallback(K=>{K!==C.current&&(C.current=K,m(K))},[]),b=g.useCallback(K=>{K!==_.current&&(_.current=K,w(K))},[]),x=s||y,k=i||v,C=g.useRef(null),_=g.useRef(null),j=g.useRef(u),M=l!=null,N=Ls(l),G=Ls(o),I=Ls(c),re=g.useCallback(()=>{if(!C.current||!_.current)return;const K={placement:e,strategy:r,middleware:h};G.current&&(K.platform=G.current),$v(C.current,_.current,K).then(ie=>{const ue={...ie,isPositioned:I.current!==!1};B.current&&!Jo(j.current,ue)&&(j.current=ue,Ta.flushSync(()=>{d(ue)}))})},[h,e,r,G,I]);jo(()=>{c===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[c]);const B=g.useRef(!1);jo(()=>(B.current=!0,()=>{B.current=!1}),[]),jo(()=>{if(x&&(C.current=x),k&&(_.current=k),x&&k){if(N.current)return N.current(x,k,re);re()}},[x,k,re,N,M]);const X=g.useMemo(()=>({reference:C,floating:_,setReference:S,setFloating:b}),[S,b]),q=g.useMemo(()=>({reference:x,floating:k}),[x,k]),se=g.useMemo(()=>{const K={position:r,left:0,top:0};if(!q.floating)return K;const ie=Kl(q.floating,u.x),ue=Kl(q.floating,u.y);return a?{...K,transform:"translate("+ie+"px, "+ue+"px)",...rh(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ie,top:ue}},[r,a,q.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:re,refs:X,elements:q,floatingStyles:se}),[u,re,X,q,se])}const Nv=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:o}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?Vl({element:n.current,padding:o}).fn(r):{}:n?Vl({element:n,padding:o}).fn(r):{}}}},Dv=(t,e)=>({...Tv(t),options:[t,e]}),Lv=(t,e)=>({...Rv(t),options:[t,e]}),Mv=(t,e)=>({...jv(t),options:[t,e]}),Bv=(t,e)=>({...Av(t),options:[t,e]}),Fv=(t,e)=>({...Ov(t),options:[t,e]}),Uv=(t,e)=>({...Iv(t),options:[t,e]}),Hv=(t,e)=>({...Nv(t),options:[t,e]});var Wv="Arrow",nh=g.forwardRef((t,e)=>{const{children:r,width:n=10,height:o=5,...s}=t;return f.jsx(we.svg,{...s,ref:e,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});nh.displayName=Wv;var Gv=nh;function qv(t){const[e,r]=g.useState(void 0);return pr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=t.offsetWidth,a=t.offsetHeight;r({width:i,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var La="Popper",[oh,sh]=Ea(La),[Vv,ih]=oh(La),ah=t=>{const{__scopePopper:e,children:r}=t,[n,o]=g.useState(null);return f.jsx(Vv,{scope:e,anchor:n,onAnchorChange:o,children:r})};ah.displayName=La;var lh="PopperAnchor",ch=g.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...o}=t,s=ih(lh,r),i=g.useRef(null),a=ot(e,i);return g.useEffect(()=>{s.onAnchorChange(n?.current||i.current)}),n?null:f.jsx(we.div,{...o,ref:a})});ch.displayName=lh;var Ma="PopperContent",[Kv,Xv]=oh(Ma),uh=g.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=t,v=ih(Ma,r),[w,S]=g.useState(null),b=ot(e,R=>S(R)),[x,k]=g.useState(null),C=qv(x),_=C?.width??0,j=C?.height??0,M=n+(s!=="center"?"-"+s:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},G=Array.isArray(c)?c:[c],I=G.length>0,re={padding:N,boundary:G.filter(Yv),altBoundary:I},{refs:B,floatingStyles:X,placement:q,isPositioned:se,middlewareData:K}=zv({strategy:"fixed",placement:M,whileElementsMounted:(...R)=>Ev(...R,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Dv({mainAxis:o+j,alignmentAxis:i}),l&&Lv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Mv():void 0,...re}),l&&Bv({...re}),Fv({...re,apply:({elements:R,rects:D,availableWidth:ne,availableHeight:de})=>{const{width:He,height:We}=D.reference,he=R.floating.style;he.setProperty("--radix-popper-available-width",`${ne}px`),he.setProperty("--radix-popper-available-height",`${de}px`),he.setProperty("--radix-popper-anchor-width",`${He}px`),he.setProperty("--radix-popper-anchor-height",`${We}px`)}}),x&&Hv({element:x,padding:a}),Zv({arrowWidth:_,arrowHeight:j}),h&&Uv({strategy:"referenceHidden",...re})]}),[ie,ue]=fh(q),le=qt(y);pr(()=>{se&&le?.()},[se,le]);const E=K.arrow?.x,P=K.arrow?.y,A=K.arrow?.centerOffset!==0,[T,O]=g.useState();return pr(()=>{w&&O(window.getComputedStyle(w).zIndex)},[w]),f.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:se?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:T,"--radix-popper-transform-origin":[K.transformOrigin?.x,K.transformOrigin?.y].join(" "),...K.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(Kv,{scope:r,placedSide:ie,onArrowChange:k,arrowX:E,arrowY:P,shouldHideArrow:A,children:f.jsx(we.div,{"data-side":ie,"data-align":ue,...m,ref:b,style:{...m.style,animation:se?void 0:"none"}})})})});uh.displayName=Ma;var dh="PopperArrow",Jv={top:"bottom",right:"left",bottom:"top",left:"right"},hh=g.forwardRef(function(e,r){const{__scopePopper:n,...o}=e,s=Xv(dh,n),i=Jv[s.placedSide];return f.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:f.jsx(Gv,{...o,ref:r,style:{...o.style,display:"block"}})})});hh.displayName=dh;function Yv(t){return t!==null}var Zv=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:o}=e,i=o.arrow?.centerOffset!==0,a=i?0:t.arrowWidth,l=i?0:t.arrowHeight,[c,u]=fh(r),d={start:"0%",center:"50%",end:"100%"}[u],h=(o.arrow?.x??0)+a/2,p=(o.arrow?.y??0)+l/2;let y="",m="";return c==="bottom"?(y=i?d:`${h}px`,m=`${-l}px`):c==="top"?(y=i?d:`${h}px`,m=`${n.floating.height+l}px`):c==="right"?(y=`${-l}px`,m=i?d:`${p}px`):c==="left"&&(y=`${n.floating.width+l}px`,m=i?d:`${p}px`),{data:{x:y,y:m}}}});function fh(t){const[e,r="center"]=t.split("-");return[e,r]}var Qv=ah,ph=ch,ew=uh,tw=hh,rw="Portal",gh=g.forwardRef((t,e)=>{const{container:r,...n}=t,[o,s]=g.useState(!1);pr(()=>s(!0),[]);const i=r||o&&globalThis?.document?.body;return i?Sy.createPortal(f.jsx(we.div,{...n,ref:e}),i):null});gh.displayName=rw;function nw(t,e){return g.useReducer((r,n)=>e[r][n]??r,t)}var to=t=>{const{present:e,children:r}=t,n=ow(e),o=typeof r=="function"?r({present:n.isPresent}):g.Children.only(r),s=ot(n.ref,sw(o));return typeof r=="function"||n.isPresent?g.cloneElement(o,{ref:s}):null};to.displayName="Presence";function ow(t){const[e,r]=g.useState(),n=g.useRef({}),o=g.useRef(t),s=g.useRef("none"),i=t?"mounted":"unmounted",[a,l]=nw(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const c=yo(n.current);s.current=a==="mounted"?c:"none"},[a]),pr(()=>{const c=n.current,u=o.current;if(u!==t){const h=s.current,p=yo(c);t?l("MOUNT"):p==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,l]),pr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const m=yo(n.current).includes(p.animationName);if(p.target===e&&m&&(l("ANIMATION_END"),!o.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},h=p=>{p.target===e&&(s.current=yo(n.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:g.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function yo(t){return t?.animationName||"none"}function sw(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function mh({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,o]=iw({defaultProp:e,onChange:r}),s=t!==void 0,i=s?t:n,a=qt(r),l=g.useCallback(c=>{if(s){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else o(c)},[s,t,o,a]);return[i,l]}function iw({defaultProp:t,onChange:e}){const r=g.useState(t),[n]=r,o=g.useRef(n),s=qt(e);return g.useEffect(()=>{o.current!==n&&(s(n),o.current=n)},[n,o,s]),r}var aw=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Er=new WeakMap,vo=new WeakMap,wo={},Ms=0,yh=function(t){return t&&(t.host||yh(t.parentNode))},lw=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=yh(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},cw=function(t,e,r,n){var o=lw(e,Array.isArray(t)?t:[t]);wo[r]||(wo[r]=new WeakMap);var s=wo[r],i=[],a=new Set,l=new Set(o),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};o.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var p=h.getAttribute(n),y=p!==null&&p!=="false",m=(Er.get(h)||0)+1,v=(s.get(h)||0)+1;Er.set(h,m),s.set(h,v),i.push(h),m===1&&y&&vo.set(h,!0),v===1&&h.setAttribute(r,"true"),y||h.setAttribute(n,"true")}catch(w){console.error("aria-hidden: cannot operate on ",h,w)}})};return u(e),a.clear(),Ms++,function(){i.forEach(function(d){var h=Er.get(d)-1,p=s.get(d)-1;Er.set(d,h),s.set(d,p),h||(vo.has(d)||d.removeAttribute(n),vo.delete(d)),p||d.removeAttribute(r)}),Ms--,Ms||(Er=new WeakMap,Er=new WeakMap,vo=new WeakMap,wo={})}},vh=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),o=aw(t);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live]"))),cw(n,o,r,"aria-hidden")):function(){return null}},lt=function(){return lt=Object.assign||function(e){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},lt.apply(this,arguments)};function wh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r}function uw(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var $o="right-scroll-bar-position",zo="width-before-scroll-bar",dw="with-scroll-bars-hidden",hw="--removed-body-scroll-bar-size";function Bs(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function fw(t,e){var r=g.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}})[0];return r.callback=e,r.facade}var pw=typeof window<"u"?g.useLayoutEffect:g.useEffect,Xl=new WeakMap;function gw(t,e){var r=fw(null,function(n){return t.forEach(function(o){return Bs(o,n)})});return pw(function(){var n=Xl.get(r);if(n){var o=new Set(n),s=new Set(t),i=r.current;o.forEach(function(a){s.has(a)||Bs(a,null)}),s.forEach(function(a){o.has(a)||Bs(a,i)})}Xl.set(r,t)},[t]),r}function mw(t){return t}function yw(t,e){e===void 0&&(e=mw);var r=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(s){var i=e(s,n);return r.push(i),function(){r=r.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(a){return s(a)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var a=r;r=[],a.forEach(s),i=r}var l=function(){var u=i;i=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){i.push(u),c()},filter:function(u){return i=i.filter(u),r}}}};return o}function vw(t){t===void 0&&(t={});var e=yw(null);return e.options=lt({async:!0,ssr:!1},t),e}var bh=function(t){var e=t.sideCar,r=wh(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return g.createElement(n,lt({},r))};bh.isSideCarExport=!0;function ww(t,e){return t.useMedium(e),bh}var xh=vw(),Fs=function(){},us=g.forwardRef(function(t,e){var r=g.useRef(null),n=g.useState({onScrollCapture:Fs,onWheelCapture:Fs,onTouchMoveCapture:Fs}),o=n[0],s=n[1],i=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,p=t.noIsolation,y=t.inert,m=t.allowPinchZoom,v=t.as,w=v===void 0?"div":v,S=t.gapMode,b=wh(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=h,k=gw([r,e]),C=lt(lt({},b),o);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:xh,removeScrollBar:c,shards:d,noIsolation:p,inert:y,setCallbacks:s,allowPinchZoom:!!m,lockRef:r,gapMode:S}),i?g.cloneElement(g.Children.only(a),lt(lt({},C),{ref:k})):g.createElement(w,lt({},C,{className:l,ref:k}),a))});us.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};us.classNames={fullWidth:zo,zeroRight:$o};var bw=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function xw(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=bw();return e&&t.setAttribute("nonce",e),t}function _w(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Sw(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var kw=function(){var t=0,e=null;return{add:function(r){t==0&&(e=xw())&&(_w(e,r),Sw(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Cw=function(){var t=kw();return function(e,r){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},_h=function(){var t=Cw(),e=function(r){var n=r.styles,o=r.dynamic;return t(n,o),null};return e},Pw={left:0,top:0,right:0,gap:0},Us=function(t){return parseInt(t||"",10)||0},Ew=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[Us(r),Us(n),Us(o)]},Tw=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Pw;var e=Ew(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},Rw=_h(),en="data-scroll-locked",Aw=function(t,e,r,n){var o=t.left,s=t.top,i=t.right,a=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(dw,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(en,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat($o,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(zo,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat($o," .").concat($o,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(zo," .").concat(zo,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(en,`] {
    `).concat(hw,": ").concat(a,`px;
  }
`)},Jl=function(){var t=parseInt(document.body.getAttribute(en)||"0",10);return isFinite(t)?t:0},Ow=function(){g.useEffect(function(){return document.body.setAttribute(en,(Jl()+1).toString()),function(){var t=Jl()-1;t<=0?document.body.removeAttribute(en):document.body.setAttribute(en,t.toString())}},[])},Iw=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,o=n===void 0?"margin":n;Ow();var s=g.useMemo(function(){return Tw(o)},[o]);return g.createElement(Rw,{styles:Aw(s,!e,o,r?"":"!important")})},Mi=!1;if(typeof window<"u")try{var bo=Object.defineProperty({},"passive",{get:function(){return Mi=!0,!0}});window.addEventListener("test",bo,bo),window.removeEventListener("test",bo,bo)}catch{Mi=!1}var Tr=Mi?{passive:!1}:!1,jw=function(t){return t.tagName==="TEXTAREA"},Sh=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!jw(t)&&r[e]==="visible")},$w=function(t){return Sh(t,"overflowY")},zw=function(t){return Sh(t,"overflowX")},Yl=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=kh(t,n);if(o){var s=Ch(t,n),i=s[1],a=s[2];if(i>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Nw=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Dw=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},kh=function(t,e){return t==="v"?$w(e):zw(e)},Ch=function(t,e){return t==="v"?Nw(e):Dw(e)},Lw=function(t,e){return t==="h"&&e==="rtl"?-1:1},Mw=function(t,e,r,n,o){var s=Lw(t,window.getComputedStyle(e).direction),i=s*n,a=r.target,l=e.contains(a),c=!1,u=i>0,d=0,h=0;do{var p=Ch(t,a),y=p[0],m=p[1],v=p[2],w=m-v-s*y;(y||w)&&kh(t,a)&&(d+=w,h+=y),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},xo=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Zl=function(t){return[t.deltaX,t.deltaY]},Ql=function(t){return t&&"current"in t?t.current:t},Bw=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Fw=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Uw=0,Rr=[];function Hw(t){var e=g.useRef([]),r=g.useRef([0,0]),n=g.useRef(),o=g.useState(Uw++)[0],s=g.useState(_h)[0],i=g.useRef(t);g.useEffect(function(){i.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var m=uw([t.lockRef.current],(t.shards||[]).map(Ql),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var a=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var w=xo(m),S=r.current,b="deltaX"in m?m.deltaX:S[0]-w[0],x="deltaY"in m?m.deltaY:S[1]-w[1],k,C=m.target,_=Math.abs(b)>Math.abs(x)?"h":"v";if("touches"in m&&_==="h"&&C.type==="range")return!1;var j=Yl(_,C);if(!j)return!0;if(j?k=_:(k=_==="v"?"h":"v",j=Yl(_,C)),!j)return!1;if(!n.current&&"changedTouches"in m&&(b||x)&&(n.current=k),!k)return!0;var M=n.current||k;return Mw(M,v,m,M==="h"?b:x)},[]),l=g.useCallback(function(m){var v=m;if(!(!Rr.length||Rr[Rr.length-1]!==s)){var w="deltaY"in v?Zl(v):xo(v),S=e.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&Bw(k.delta,w)})[0];if(S&&S.should){v.cancelable&&v.preventDefault();return}if(!S){var b=(i.current.shards||[]).map(Ql).filter(Boolean).filter(function(k){return k.contains(v.target)}),x=b.length>0?a(v,b[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),c=g.useCallback(function(m,v,w,S){var b={name:m,delta:v,target:w,should:S,shadowParent:Ww(w)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(x){return x!==b})},1)},[]),u=g.useCallback(function(m){r.current=xo(m),n.current=void 0},[]),d=g.useCallback(function(m){c(m.type,Zl(m),m.target,a(m,t.lockRef.current))},[]),h=g.useCallback(function(m){c(m.type,xo(m),m.target,a(m,t.lockRef.current))},[]);g.useEffect(function(){return Rr.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Tr),document.addEventListener("touchmove",l,Tr),document.addEventListener("touchstart",u,Tr),function(){Rr=Rr.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,Tr),document.removeEventListener("touchmove",l,Tr),document.removeEventListener("touchstart",u,Tr)}},[]);var p=t.removeScrollBar,y=t.inert;return g.createElement(g.Fragment,null,y?g.createElement(s,{styles:Fw(o)}):null,p?g.createElement(Iw,{gapMode:t.gapMode}):null)}function Ww(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Gw=ww(xh,Hw);var Ba=g.forwardRef(function(t,e){return g.createElement(us,lt({},t,{ref:e,sideCar:Gw}))});Ba.classNames=us.classNames;var Fa="Popover",[Ph,nE]=Ea(Fa,[sh]),ro=sh(),[qw,Sr]=Ph(Fa),Eh=t=>{const{__scopePopover:e,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!1}=t,a=ro(e),l=g.useRef(null),[c,u]=g.useState(!1),[d=!1,h]=mh({prop:n,defaultProp:o,onChange:s});return f.jsx(Qv,{...a,children:f.jsx(qw,{scope:e,contentId:ut(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:g.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:r})})};Eh.displayName=Fa;var Th="PopoverAnchor",Vw=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr(Th,r),s=ro(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:a}=o;return g.useEffect(()=>(i(),()=>a()),[i,a]),f.jsx(ph,{...s,...n,ref:e})});Vw.displayName=Th;var Rh="PopoverTrigger",Ah=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr(Rh,r),s=ro(r),i=ot(e,o.triggerRef),a=f.jsx(we.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":$h(o.open),...n,ref:i,onClick:Fe(t.onClick,o.onOpenToggle)});return o.hasCustomAnchor?a:f.jsx(ph,{asChild:!0,...s,children:a})});Ah.displayName=Rh;var Kw="PopoverPortal",[oE,Xw]=Ph(Kw,{forceMount:void 0}),on="PopoverContent",Oh=g.forwardRef((t,e)=>{const r=Xw(on,t.__scopePopover),{forceMount:n=r.forceMount,...o}=t,s=Sr(on,t.__scopePopover);return f.jsx(to,{present:n||s.open,children:s.modal?f.jsx(Jw,{...o,ref:e}):f.jsx(Yw,{...o,ref:e})})});Oh.displayName=on;var Jw=g.forwardRef((t,e)=>{const r=Sr(on,t.__scopePopover),n=g.useRef(null),o=ot(e,n),s=g.useRef(!1);return g.useEffect(()=>{const i=n.current;if(i)return vh(i)},[]),f.jsx(Ba,{as:is,allowPinchZoom:!0,children:f.jsx(Ih,{...t,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Fe(t.onCloseAutoFocus,i=>{i.preventDefault(),s.current||r.triggerRef.current?.focus()}),onPointerDownOutside:Fe(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Fe(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Yw=g.forwardRef((t,e)=>{const r=Sr(on,t.__scopePopover),n=g.useRef(!1),o=g.useRef(!1);return f.jsx(Ih,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{t.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{t.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),Ih=g.forwardRef((t,e)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=Sr(on,r),p=ro(r);return Gd(),f.jsx(Aa,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:f.jsx(Ra,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(ew,{"data-state":$h(h.open),role:"dialog",id:h.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),jh="PopoverClose",Zw=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=Sr(jh,r);return f.jsx(we.button,{type:"button",...n,ref:e,onClick:Fe(t.onClick,()=>o.onOpenChange(!1))})});Zw.displayName=jh;var Qw="PopoverArrow",eb=g.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,o=ro(r);return f.jsx(tw,{...o,...n,ref:e})});eb.displayName=Qw;function $h(t){return t?"open":"closed"}var tb=Ah;function zh(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(r=zh(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Nh(){for(var t,e,r=0,n="",o=arguments.length;r<o;r++)(t=arguments[r])&&(e=zh(t))&&(n&&(n+=" "),n+=e);return n}function Ce(...t){return Md(Nh(t))}const Dh=Eh,Lh=tb,Mh=g.forwardRef(({className:t,align:e="end",...r},n)=>f.jsx(Oh,{ref:n,align:e,className:Ce("z-popups drop-shadow-oneBlock p-0 border-shadow outline-none",t),...r,onKeyDown:o=>{o.stopPropagation()}})),Ua=({children:t,scaleFactor:e})=>{const r=sg();return f.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})};var ec=1,rb=.9,nb=.8,ob=.17,Hs=.1,Ws=.999,sb=.9999,ib=.99,ab=/[\\\/_+.#"@\[\(\{&]/,lb=/[\\\/_+.#"@\[\(\{&]/g,cb=/[\s-]/,Bh=/[\s-]/g;function Bi(t,e,r,n,o,s,i){if(s===e.length)return o===t.length?ec:ib;var a=`${o},${s}`;if(i[a]!==void 0)return i[a];for(var l=n.charAt(s),c=r.indexOf(l,o),u=0,d,h,p,y;c>=0;)d=Bi(t,e,r,n,c+1,s+1,i),d>u&&(c===o?d*=ec:ab.test(t.charAt(c-1))?(d*=nb,p=t.slice(o,c-1).match(lb),p&&o>0&&(d*=Math.pow(Ws,p.length))):cb.test(t.charAt(c-1))?(d*=rb,y=t.slice(o,c-1).match(Bh),y&&o>0&&(d*=Math.pow(Ws,y.length))):(d*=ob,o>0&&(d*=Math.pow(Ws,c-o))),t.charAt(c)!==e.charAt(s)&&(d*=sb)),(d<Hs&&r.charAt(c-1)===n.charAt(s+1)||n.charAt(s+1)===n.charAt(s)&&r.charAt(c-1)!==n.charAt(s))&&(h=Bi(t,e,r,n,c+1,s+2,i),h*Hs>d&&(d=h*Hs)),d>u&&(u=d),c=r.indexOf(l,c+1);return i[a]=u,u}function tc(t){return t.toLowerCase().replace(Bh," ")}function ub(t,e,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,Bi(t,e,tc(t),tc(e),0,0,{})}var Ha="Dialog",[Fh,sE]=Ea(Ha),[db,st]=Fh(Ha),Uh=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!0}=t,a=g.useRef(null),l=g.useRef(null),[c=!1,u]=mh({prop:n,defaultProp:o,onChange:s});return f.jsx(db,{scope:e,triggerRef:a,contentRef:l,contentId:ut(),titleId:ut(),descriptionId:ut(),open:c,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:r})};Uh.displayName=Ha;var Hh="DialogTrigger",hb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=st(Hh,r),s=ot(e,o.triggerRef);return f.jsx(we.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":qa(o.open),...n,ref:s,onClick:Fe(t.onClick,o.onOpenToggle)})});hb.displayName=Hh;var Wa="DialogPortal",[fb,Wh]=Fh(Wa,{forceMount:void 0}),Gh=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:o}=t,s=st(Wa,e);return f.jsx(fb,{scope:e,forceMount:r,children:g.Children.map(n,i=>f.jsx(to,{present:r||s.open,children:f.jsx(gh,{asChild:!0,container:o,children:i})}))})};Gh.displayName=Wa;var Yo="DialogOverlay",qh=g.forwardRef((t,e)=>{const r=Wh(Yo,t.__scopeDialog),{forceMount:n=r.forceMount,...o}=t,s=st(Yo,t.__scopeDialog);return s.modal?f.jsx(to,{present:n||s.open,children:f.jsx(pb,{...o,ref:e})}):null});qh.displayName=Yo;var pb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=st(Yo,r);return f.jsx(Ba,{as:is,allowPinchZoom:!0,shards:[o.contentRef],children:f.jsx(we.div,{"data-state":qa(o.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),mr="DialogContent",Vh=g.forwardRef((t,e)=>{const r=Wh(mr,t.__scopeDialog),{forceMount:n=r.forceMount,...o}=t,s=st(mr,t.__scopeDialog);return f.jsx(to,{present:n||s.open,children:s.modal?f.jsx(gb,{...o,ref:e}):f.jsx(mb,{...o,ref:e})})});Vh.displayName=mr;var gb=g.forwardRef((t,e)=>{const r=st(mr,t.__scopeDialog),n=g.useRef(null),o=ot(e,r.contentRef,n);return g.useEffect(()=>{const s=n.current;if(s)return vh(s)},[]),f.jsx(Kh,{...t,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Fe(t.onCloseAutoFocus,s=>{s.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Fe(t.onPointerDownOutside,s=>{const i=s.detail.originalEvent,a=i.button===0&&i.ctrlKey===!0;(i.button===2||a)&&s.preventDefault()}),onFocusOutside:Fe(t.onFocusOutside,s=>s.preventDefault())})}),mb=g.forwardRef((t,e)=>{const r=st(mr,t.__scopeDialog),n=g.useRef(!1),o=g.useRef(!1);return f.jsx(Kh,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{t.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{t.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),Kh=g.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,...i}=t,a=st(mr,r),l=g.useRef(null),c=ot(e,l);return Gd(),f.jsxs(f.Fragment,{children:[f.jsx(Aa,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:f.jsx(Ra,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":qa(a.open),...i,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(bb,{titleId:a.titleId}),f.jsx(_b,{contentRef:l,descriptionId:a.descriptionId})]})]})}),Ga="DialogTitle",yb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=st(Ga,r);return f.jsx(we.h2,{id:o.titleId,...n,ref:e})});yb.displayName=Ga;var Xh="DialogDescription",vb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=st(Xh,r);return f.jsx(we.p,{id:o.descriptionId,...n,ref:e})});vb.displayName=Xh;var Jh="DialogClose",wb=g.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,o=st(Jh,r);return f.jsx(we.button,{type:"button",...n,ref:e,onClick:Fe(t.onClick,()=>o.onOpenChange(!1))})});wb.displayName=Jh;function qa(t){return t?"open":"closed"}var Yh="DialogTitleWarning",[iE,Zh]=xy(Yh,{contentName:mr,titleName:Ga,docsSlug:"dialog"}),bb=({titleId:t})=>{const e=Zh(Yh),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},xb="DialogDescriptionWarning",_b=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Zh(xb).contentName}}.`;return g.useEffect(()=>{const o=t.current?.getAttribute("aria-describedby");e&&o&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},Sb=Uh,kb=Gh,Cb=qh,Pb=Vh,Gs={exports:{}},qs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rc;function Eb(){if(rc)return qs;rc=1;var t=ig();function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,o=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function a(d,h){var p=h(),y=n({inst:{value:p,getSnapshot:h}}),m=y[0].inst,v=y[1];return s(function(){m.value=p,m.getSnapshot=h,l(m)&&v({inst:m})},[d,p,h]),o(function(){return l(m)&&v({inst:m}),d(function(){l(m)&&v({inst:m})})},[d]),i(p),p}function l(d){var h=d.getSnapshot;d=d.value;try{var p=h();return!r(d,p)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return qs.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,qs}var nc;function Tb(){return nc||(nc=1,Gs.exports=Eb()),Gs.exports}var Rb=Tb(),_n='[cmdk-group=""]',Vs='[cmdk-group-items=""]',Ab='[cmdk-group-heading=""]',Va='[cmdk-item=""]',oc=`${Va}:not([aria-disabled="true"])`,Fi="cmdk-item-select",sr="data-value",Ob=(t,e,r)=>ub(t,e,r),Qh=g.createContext(void 0),no=()=>g.useContext(Qh),ef=g.createContext(void 0),Ka=()=>g.useContext(ef),tf=g.createContext(void 0),rf=g.forwardRef((t,e)=>{let r=Hr(()=>{var E,P;return{search:"",value:(P=(E=t.value)!=null?E:t.defaultValue)!=null?P:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=Hr(()=>new Set),o=Hr(()=>new Map),s=Hr(()=>new Map),i=Hr(()=>new Set),a=nf(t),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:p,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...w}=t,S=ut(),b=ut(),x=ut(),k=g.useRef(null),C=Ub();yr(()=>{if(u!==void 0){let E=u.trim();r.current.value=E,_.emit()}},[u]),yr(()=>{C(6,re)},[]);let _=g.useMemo(()=>({subscribe:E=>(i.current.add(E),()=>i.current.delete(E)),snapshot:()=>r.current,setState:(E,P,A)=>{var T,O,R;if(!Object.is(r.current[E],P)){if(r.current[E]=P,E==="search")I(),N(),C(1,G);else if(E==="value"&&(A||C(5,re),((T=a.current)==null?void 0:T.value)!==void 0)){let D=P??"";(R=(O=a.current).onValueChange)==null||R.call(O,D);return}_.emit()}},emit:()=>{i.current.forEach(E=>E())}}),[]),j=g.useMemo(()=>({value:(E,P,A)=>{var T;P!==((T=s.current.get(E))==null?void 0:T.value)&&(s.current.set(E,{value:P,keywords:A}),r.current.filtered.items.set(E,M(P,A)),C(2,()=>{N(),_.emit()}))},item:(E,P)=>(n.current.add(E),P&&(o.current.has(P)?o.current.get(P).add(E):o.current.set(P,new Set([E]))),C(3,()=>{I(),N(),r.current.value||G(),_.emit()}),()=>{s.current.delete(E),n.current.delete(E),r.current.filtered.items.delete(E);let A=B();C(4,()=>{I(),A?.getAttribute("id")===E&&G(),_.emit()})}),group:E=>(o.current.has(E)||o.current.set(E,new Set),()=>{s.current.delete(E),o.current.delete(E)}),filter:()=>a.current.shouldFilter,label:l||t["aria-label"],getDisablePointerSelection:()=>a.current.disablePointerSelection,listId:S,inputId:x,labelId:b,listInnerRef:k}),[]);function M(E,P){var A,T;let O=(T=(A=a.current)==null?void 0:A.filter)!=null?T:Ob;return E?O(E,r.current.search,P):0}function N(){if(!r.current.search||a.current.shouldFilter===!1)return;let E=r.current.filtered.items,P=[];r.current.filtered.groups.forEach(T=>{let O=o.current.get(T),R=0;O.forEach(D=>{let ne=E.get(D);R=Math.max(ne,R)}),P.push([T,R])});let A=k.current;X().sort((T,O)=>{var R,D;let ne=T.getAttribute("id"),de=O.getAttribute("id");return((R=E.get(de))!=null?R:0)-((D=E.get(ne))!=null?D:0)}).forEach(T=>{let O=T.closest(Vs);O?O.appendChild(T.parentElement===O?T:T.closest(`${Vs} > *`)):A.appendChild(T.parentElement===A?T:T.closest(`${Vs} > *`))}),P.sort((T,O)=>O[1]-T[1]).forEach(T=>{var O;let R=(O=k.current)==null?void 0:O.querySelector(`${_n}[${sr}="${encodeURIComponent(T[0])}"]`);R?.parentElement.appendChild(R)})}function G(){let E=X().find(A=>A.getAttribute("aria-disabled")!=="true"),P=E?.getAttribute(sr);_.setState("value",P||void 0)}function I(){var E,P,A,T;if(!r.current.search||a.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let O=0;for(let R of n.current){let D=(P=(E=s.current.get(R))==null?void 0:E.value)!=null?P:"",ne=(T=(A=s.current.get(R))==null?void 0:A.keywords)!=null?T:[],de=M(D,ne);r.current.filtered.items.set(R,de),de>0&&O++}for(let[R,D]of o.current)for(let ne of D)if(r.current.filtered.items.get(ne)>0){r.current.filtered.groups.add(R);break}r.current.filtered.count=O}function re(){var E,P,A;let T=B();T&&(((E=T.parentElement)==null?void 0:E.firstChild)===T&&((A=(P=T.closest(_n))==null?void 0:P.querySelector(Ab))==null||A.scrollIntoView({block:"nearest"})),T.scrollIntoView({block:"nearest"}))}function B(){var E;return(E=k.current)==null?void 0:E.querySelector(`${Va}[aria-selected="true"]`)}function X(){var E;return Array.from(((E=k.current)==null?void 0:E.querySelectorAll(oc))||[])}function q(E){let P=X()[E];P&&_.setState("value",P.getAttribute(sr))}function se(E){var P;let A=B(),T=X(),O=T.findIndex(D=>D===A),R=T[O+E];(P=a.current)!=null&&P.loop&&(R=O+E<0?T[T.length-1]:O+E===T.length?T[0]:T[O+E]),R&&_.setState("value",R.getAttribute(sr))}function K(E){let P=B(),A=P?.closest(_n),T;for(;A&&!T;)A=E>0?Bb(A,_n):Fb(A,_n),T=A?.querySelector(oc);T?_.setState("value",T.getAttribute(sr)):se(E)}let ie=()=>q(X().length-1),ue=E=>{E.preventDefault(),E.metaKey?ie():E.altKey?K(1):se(1)},le=E=>{E.preventDefault(),E.metaKey?q(0):E.altKey?K(-1):se(-1)};return g.createElement(we.div,{ref:e,tabIndex:-1,...w,"cmdk-root":"",onKeyDown:E=>{var P;if((P=w.onKeyDown)==null||P.call(w,E),!E.defaultPrevented)switch(E.key){case"n":case"j":{v&&E.ctrlKey&&ue(E);break}case"ArrowDown":{ue(E);break}case"p":case"k":{v&&E.ctrlKey&&le(E);break}case"ArrowUp":{le(E);break}case"Home":{E.preventDefault(),q(0);break}case"End":{E.preventDefault(),ie();break}case"Enter":if(!E.nativeEvent.isComposing&&E.keyCode!==229){E.preventDefault();let A=B();if(A){let T=new Event(Fi);A.dispatchEvent(T)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:j.inputId,id:j.labelId,style:Wb},l),ds(t,E=>g.createElement(ef.Provider,{value:_},g.createElement(Qh.Provider,{value:j},E))))}),Ib=g.forwardRef((t,e)=>{var r,n;let o=ut(),s=g.useRef(null),i=g.useContext(tf),a=no(),l=nf(t),c=(n=(r=l.current)==null?void 0:r.forceMount)!=null?n:i?.forceMount;yr(()=>{if(!c)return a.item(o,i?.id)},[c]);let u=of(o,s,[t.value,t.children,s],t.keywords),d=Ka(),h=vr(C=>C.value&&C.value===u.current),p=vr(C=>c||a.filter()===!1?!0:C.search?C.filtered.items.get(o)>0:!0);g.useEffect(()=>{let C=s.current;if(!(!C||t.disabled))return C.addEventListener(Fi,y),()=>C.removeEventListener(Fi,y)},[p,t.onSelect,t.disabled]);function y(){var C,_;m(),(_=(C=l.current).onSelect)==null||_.call(C,u.current)}function m(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:w,onSelect:S,forceMount:b,keywords:x,...k}=t;return g.createElement(we.div,{ref:qn([s,e]),...k,id:o,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||a.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},t.children)}),jb=g.forwardRef((t,e)=>{let{heading:r,children:n,forceMount:o,...s}=t,i=ut(),a=g.useRef(null),l=g.useRef(null),c=ut(),u=no(),d=vr(p=>o||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);yr(()=>u.group(i),[]),of(i,a,[t.value,t.heading,l]);let h=g.useMemo(()=>({id:i,forceMount:o}),[o]);return g.createElement(we.div,{ref:qn([a,e]),...s,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},r&&g.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),ds(t,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},g.createElement(tf.Provider,{value:h},p))))}),$b=g.forwardRef((t,e)=>{let{alwaysRender:r,...n}=t,o=g.useRef(null),s=vr(i=>!i.search);return!r&&!s?null:g.createElement(we.div,{ref:qn([o,e]),...n,"cmdk-separator":"",role:"separator"})}),zb=g.forwardRef((t,e)=>{let{onValueChange:r,...n}=t,o=t.value!=null,s=Ka(),i=vr(u=>u.search),a=vr(u=>u.value),l=no(),c=g.useMemo(()=>{var u;let d=(u=l.listInnerRef.current)==null?void 0:u.querySelector(`${Va}[${sr}="${encodeURIComponent(a)}"]`);return d?.getAttribute("id")},[]);return g.useEffect(()=>{t.value!=null&&s.setState("search",t.value)},[t.value]),g.createElement(we.input,{ref:e,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":c,id:l.inputId,type:"text",value:o?t.value:i,onChange:u=>{o||s.setState("search",u.target.value),r?.(u.target.value)}})}),Nb=g.forwardRef((t,e)=>{let{children:r,label:n="Suggestions",...o}=t,s=g.useRef(null),i=g.useRef(null),a=no();return g.useEffect(()=>{if(i.current&&s.current){let l=i.current,c=s.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let h=l.offsetHeight;c.style.setProperty("--cmdk-list-height",h.toFixed(1)+"px")})});return d.observe(l),()=>{cancelAnimationFrame(u),d.unobserve(l)}}},[]),g.createElement(we.div,{ref:qn([s,e]),...o,"cmdk-list":"",role:"listbox","aria-label":n,id:a.listId},ds(t,l=>g.createElement("div",{ref:qn([i,a.listInnerRef]),"cmdk-list-sizer":""},l)))}),Db=g.forwardRef((t,e)=>{let{open:r,onOpenChange:n,overlayClassName:o,contentClassName:s,container:i,...a}=t;return g.createElement(Sb,{open:r,onOpenChange:n},g.createElement(kb,{container:i},g.createElement(Cb,{"cmdk-overlay":"",className:o}),g.createElement(Pb,{"aria-label":t.label,"cmdk-dialog":"",className:s},g.createElement(rf,{ref:e,...a}))))}),Lb=g.forwardRef((t,e)=>vr(r=>r.filtered.count===0)?g.createElement(we.div,{ref:e,...t,"cmdk-empty":"",role:"presentation"}):null),Mb=g.forwardRef((t,e)=>{let{progress:r,children:n,label:o="Loading...",...s}=t;return g.createElement(we.div,{ref:e,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},ds(t,i=>g.createElement("div",{"aria-hidden":!0},i)))}),De=Object.assign(rf,{List:Nb,Item:Ib,Input:zb,Group:jb,Separator:$b,Dialog:Db,Empty:Lb,Loading:Mb});function Bb(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return r;r=r.nextElementSibling}}function Fb(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return r;r=r.previousElementSibling}}function nf(t){let e=g.useRef(t);return yr(()=>{e.current=t}),e}var yr=typeof window>"u"?g.useEffect:g.useLayoutEffect;function Hr(t){let e=g.useRef();return e.current===void 0&&(e.current=t()),e}function qn(t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}function vr(t){let e=Ka(),r=()=>t(e.snapshot());return Rb.useSyncExternalStore(e.subscribe,r,r)}function of(t,e,r,n=[]){let o=g.useRef(),s=no();return yr(()=>{var i;let a=(()=>{var c;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():o.current}})(),l=n.map(c=>c.trim());s.value(t,a,l),(i=e.current)==null||i.setAttribute(sr,a),o.current=a}),o}var Ub=()=>{let[t,e]=g.useState(),r=Hr(()=>new Map);return yr(()=>{r.current.forEach(n=>n()),r.current=new Map},[t]),(n,o)=>{r.current.set(n,o),e({})}};function Hb(t){let e=t.type;return typeof e=="function"?e(t.props):"render"in e?e.render(t.props):t}function ds({asChild:t,children:e},r){return t&&g.isValidElement(e)?g.cloneElement(Hb(e),{ref:e.ref},r(e.props.children)):r(e)}var Wb={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const sf=g.forwardRef(({className:t,...e},r)=>f.jsx(De,{ref:r,className:Ce("flex h-full w-full flex-col overflow-hidden bg-metallicBlue text-popover-foreground",t),...e}));sf.displayName=De.displayName;const af=g.forwardRef(({className:t,...e},r)=>f.jsxs("div",{className:"flex items-center border-b px-1 pb-1","cmdk-input-wrapper":"",children:[f.jsx("span",{className:"sprite mr-1 texture-hud_char_gt"}),f.jsx(De.Input,{ref:r,className:Ce("flex h-1 w-full bg-pastelBlue py-1 outline-none placeholder:text-shadow disabled:cursor-not-allowed",t),...e})]}));af.displayName=De.Input.displayName;const lf=g.forwardRef(({className:t,...e},r)=>f.jsx(De.List,{ref:r,className:Ce("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...e}));lf.displayName=De.List.displayName;const cf=g.forwardRef((t,e)=>f.jsx(De.Empty,{ref:e,className:"pl-1",...t}));cf.displayName=De.Empty.displayName;const uf=g.forwardRef(({className:t,...e},r)=>f.jsx(De.Group,{ref:r,className:Ce("overflow-hidden",t),...e}));uf.displayName=De.Group.displayName;const Gb=g.forwardRef(({className:t,...e},r)=>f.jsx(De.Separator,{ref:r,className:Ce("-mx-1 h-px bg-shadow",t),...e}));Gb.displayName=De.Separator.displayName;const hs=g.forwardRef(({className:t,...e},r)=>f.jsx(De.Item,{ref:r,className:Ce("relative flex cursor-default select-none items-center text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-midRed hover:bg-pastelBlue data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...e}));hs.displayName=De.Item.displayName;const kt=g.forwardRef(({className:t,selected:e,...r},n)=>f.jsx("button",{"data-selected":e,className:Ce(`inline-flex items-center justify-center whitespace-nowrap 
          bg-metallicBlue zx:bg-zxBlue border-none border-shadow
          gap-2
           disabled:bg-midGrey disabled:text-lightGrey 
           data-[selected=true]:bg-lightBeige
           [&:not(:disabled):hover:not([data-selected=true])]:bg-pastelBlue 
           `,t),ref:n,...r}));kt.displayName="Button";var sc=!1,ir,Ui,Hi,No,Do,df,Lo,Wi,Gi,qi,hf,Vi,Ki,ff,pf;function Ie(){if(!sc){sc=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),r=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(Vi=/\b(iPhone|iP[ao]d)/.exec(t),Ki=/\b(iP[ao]d)/.exec(t),qi=/Android/i.exec(t),ff=/FBAN\/\w+;/i.exec(t),pf=/Mobile/i.exec(t),hf=!!/Win64/.exec(t),e){ir=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN,ir&&document&&document.documentMode&&(ir=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);df=n?parseFloat(n[1])+4:ir,Ui=e[2]?parseFloat(e[2]):NaN,Hi=e[3]?parseFloat(e[3]):NaN,No=e[4]?parseFloat(e[4]):NaN,No?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),Do=e&&e[1]?parseFloat(e[1]):NaN):Do=NaN}else ir=Ui=Hi=Do=No=NaN;if(r){if(r[1]){var o=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);Lo=o?parseFloat(o[1].replace("_",".")):!0}else Lo=!1;Wi=!!r[2],Gi=!!r[3]}else Lo=Wi=Gi=!1}}var Xi={ie:function(){return Ie()||ir},ieCompatibilityMode:function(){return Ie()||df>ir},ie64:function(){return Xi.ie()&&hf},firefox:function(){return Ie()||Ui},opera:function(){return Ie()||Hi},webkit:function(){return Ie()||No},safari:function(){return Xi.webkit()},chrome:function(){return Ie()||Do},windows:function(){return Ie()||Wi},osx:function(){return Ie()||Lo},linux:function(){return Ie()||Gi},iphone:function(){return Ie()||Vi},mobile:function(){return Ie()||Vi||Ki||qi||pf},nativeApp:function(){return Ie()||ff},android:function(){return Ie()||qi},ipad:function(){return Ie()||Ki}},qb=Xi,Vb=!!(typeof window<"u"&&window.document&&window.document.createElement),Kb={canUseDOM:Vb},gf=Kb,mf;gf.canUseDOM&&(mf=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Xb(t,e){if(!gf.canUseDOM||e&&!("addEventListener"in document))return!1;var r="on"+t,n=r in document;if(!n){var o=document.createElement("div");o.setAttribute(r,"return;"),n=typeof o[r]=="function"}return!n&&mf&&t==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var Jb=Xb,ic=10,ac=40,lc=800;function yf(t){var e=0,r=0,n=0,o=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*ic,o=r*ic,"deltaY"in t&&(o=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||o)&&t.deltaMode&&(t.deltaMode==1?(n*=ac,o*=ac):(n*=lc,o*=lc)),n&&!e&&(e=n<1?-1:1),o&&!r&&(r=o<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:o}}yf.getEventType=function(){return qb.firefox()?"DOMMouseScroll":Jb("wheel")?"wheel":"mousewheel"};var Yb=yf;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const Zb=(t,e,r=!1)=>{const n=g.useRef(0),o=g.useCallback(s=>{if(r)return;const i=s;i.preventDefault(),i.stopPropagation();const a=Yb(i);n.current-=a.spinY,n.current>=1&&(e(1),n.current=0),n.current<=-1&&(e(-1),n.current=0)},[e,r]);g.useEffect(()=>{const s=t.current;if(s!==null)return s.addEventListener("wheel",o,{passive:!1}),()=>{s.removeEventListener("wheel",o)}},[t,o])},vf=(t,e,r,n=!1)=>{const o=g.useRef(0);return Zb(t,s=>{if(e.length===0)return;const i=(o.current+s+256*e.length)%e.length;o.current=i,r(e[i],i)},n)},Qb=({value:t,onSelect:e})=>f.jsx(hs,{value:t,onSelect:e,className:"px-1",children:f.jsx(Q,{children:t})}),fs=t=>{const{values:e,onSelect:r,triggerButtonClassName:n="",triggerButtonStyle:o=ce,triggerButtonLabel:s="",OptionCommandItem:i=Qb}=t,[a,l]=g.useState(!1),c=g.useRef(null);return vf(c,e,u=>{r(u)},!a),f.jsxs(Dh,{open:a,onOpenChange:l,children:[f.jsx(Lh,{asChild:!0,children:f.jsxs(kt,{className:Ce("h-2 px-1 flex flex-row gap-1 justify-start leading-none",n),style:o,ref:c,children:[typeof s=="string"?f.jsx(Q,{className:"grow overflow-hidden text-left",children:s}):s,f.jsx(Q,{className:"grow-0",children:a?"X":"⬇"})]})}),f.jsx(Mh,{className:"p-0",children:f.jsx(Ua,{scaleFactor:2,children:f.jsxs(sf,{className:"w-[--radix-popper-anchor-width]",children:[t.disableCommandInput===!0?null:f.jsx(af,{placeholder:t.placeholder}),f.jsxs(lf,{children:[f.jsx(cf,{children:f.jsx(Q,{children:"Nothing found"})}),f.jsx(uf,{children:e.map(u=>f.jsx(i,{value:u,onSelect:d=>{l(!1),r(d)}},u))})]})]})})})]})},ex=()=>{const t=gt(),e=Vu();return f.jsx(f.Fragment,{children:f.jsx(fs,{value:e,values:ag,onSelect:r=>{t(lg(r))},disableCommandInput:!0,triggerButtonLabel:e,triggerButtonClassName:"w-13"})})};function wf({campaign:t,onSelect:e,headRoomId:r,heelsRoomId:n,value:o,triggerButtonClassName:s,excludeRoomIds:i=[]}){const a=Object.keys(t.rooms).filter(l=>!i.includes(l));return f.jsx(fs,{onSelect:l=>e?.(l),value:o,values:a,triggerButtonClassName:s,placeholder:"search",disableCommandInput:!1,triggerButtonLabel:o??"none",OptionCommandItem:({value:l,onSelect:c})=>f.jsxs(hs,{value:l,onSelect:c,className:"px-1",children:[r===l&&f.jsx("span",{className:"sprite mr-1 my-1 texture-head_walking_towards_2"}),n===l&&f.jsx("span",{className:"sprite mr-1 my-1 texture-heels_walking_towards_2"}),f.jsx(Q,{children:l})]})})}const me=t=>t,Ji="h-[calc(3*var(--block)-1px*var(--scale))] w-[calc(3*var(--block)-1px*var(--scale))]",F=me("[button:not([data-selected=true]):not(:hover)_&]:sprite-revert-to-two-tone-dim"),Pe=me("flex flex-wrap gap-oneScaledPix w-full"),nt=({className:t,onClick:e,children:r,disabled:n=!1,isCurrentTool:o=!1})=>f.jsx(kt,{disabled:n,selected:o,className:`
        ${Ji} 
        active:pt-oneScaledPix  gap-0 inline-flex overflow-hidden 
        
        ${t??""}`,onClick:e,children:r}),tx=()=>{const t=be(e=>e.levelEditor.selectedJsonItemIds.length>0);return f.jsx(nt,{className:"bg-midRed",disabled:!t,onClick:()=>L.dispatch(sd()),children:f.jsx("span",{className:"sprite sprite-tinted texture-hud_char_X relative"})})},Xa=({className:t,value:e,onClick:r,trueLabel:n="ON",falseLabel:o="OFF",label:s})=>{const i=Math.max(n.length,o.length)+1,a=n.padStart(i," "),l=o.padEnd(i," ");return f.jsxs("span",{onClick:c=>r?.(c,!e),className:Ce("inline-flex justify-between",t),children:[s&&f.jsx(Q,{className:"inline-block mr-1 text-lightGrey",noSlitWords:!0,children:s}),f.jsx(Q,{className:Nh("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?a:l})]})},rx=({className:t})=>{const e=gt();return f.jsx(Xa,{className:t,label:"snap",value:be(r=>r.levelEditor.halfGridResolution),onClick:(r,n)=>{e(Bg(n))},falseLabel:"Block",trueLabel:"Half"})},$=({itemTool:t,children:e,className:r})=>{const n=be(cr),o=qe(n?.type==="item"&&n.item,t);return f.jsx(nt,{isCurrentTool:o,className:r,onClick:()=>L.dispatch(Gt({type:"item",item:t})),children:e})},Sn=({children:t})=>{const[e,r]=g.useState(!1),[n,o]=g.useState(0),s=g.useRef(null);vf(s,t,(a,l)=>{o(l)});const i=t[n];return f.jsxs(Dh,{open:e,onOpenChange:r,children:[f.jsx("div",{className:Ce(Ji,"relative",{"drop-shadow-oneBlock z-popups":e}),children:f.jsxs("span",{className:"content",ref:s,children:[i,f.jsx(Lh,{asChild:!0,children:f.jsx(kt,{className:"absolute bottom-0 right-0 bg-metallicBlueHalfbrite",children:f.jsx(Q,{className:"pl-oneScaledPix",children:e?"X":"⬇"})})})]})}),f.jsx(Mh,{children:f.jsx(Ua,{scaleFactor:2,children:f.jsx("div",{className:"flex flex-col gap-oneScaledPix py-oneScaledPix bg-metallicBlueHalfbrite",children:t.map((a,l)=>l===n?null:f.jsx("div",{className:Ji,onClick:()=>{o(l),r(!1)},children:a},l))})})})]})},nx=()=>{const e=be(cr)?.type==="pointer";return f.jsx(nt,{onClick:()=>L.dispatch(Gt({type:"pointer"})),isCurrentTool:e,children:f.jsx("span",{className:"sprite texture-editor_tool_pointer relative"})})},z={pureBlack:new V("#000000"),shadow:new V("#325149"),midGrey:new V("#7F7773"),lightGrey:new V("#BBB1AB"),white:new V("#FBFEFB"),pastelBlue:new V("#75ACFF"),metallicBlue:new V("#366CAA"),pink:new V("#D68ED1"),moss:new V("#9E9600"),redShadow:new V("#805E50"),midRed:new V("#CA7463"),lightBeige:new V("#DAA78F"),highlightBeige:new V("#EBC690"),alpha:new V("#1E7790"),replaceLight:new V("#08A086"),replaceDark:new V("#0A4730")},zn=.33,bf=t=>{const[e,r,n]=t.toUint8RgbArray();return new V({r:e*.75,g:r*.75,b:n*.75})},sn=(t,e=zn)=>{const[r,n,o]=t.toUint8RgbArray();return new V({r:r*e,g:n*e,b:o*e})};function aE(t){t=t.replace(/^#/,"");let e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);e=Math.floor(e*zn),r=Math.floor(r*zn),n=Math.floor(n*zn);const o=s=>s.toString(16).padStart(2,"0");return`#${o(e)}${o(r)}${o(n)}`}const Xe={original:new V(dn.zxWhite),basic:z.white,dimmed:z.lightGrey},Je={original:new V(dn.zxYellow),basic:new V(15654246),dimmed:sn(new V(15654246),.5)},xf={original:new V(dn.zxYellow),basic:z.midRed,dimmed:z.redShadow},it={original:new V(dn.zxMagenta),basic:z.pink,dimmed:sn(z.pink,.5)},xe={original:new V(dn.zxCyan),basic:z.pastelBlue,dimmed:sn(z.pastelBlue,.5)},at={original:new V(dn.zxGreen),basic:z.moss,dimmed:sn(z.moss,.5)},ps={white:{basic:{main:Xe,edges:{towards:{...xe,dimInOriginal:!1},right:{...Je,dimInOriginal:!0}},hud:{lives:Je,dimmed:it,icons:xe}},dimmed:{main:Xe,edges:{towards:{...at,dimInOriginal:!1},right:{...xe,dimInOriginal:!0}},hud:{lives:xf,dimmed:it,icons:xe}}},yellow:{basic:{main:Je,edges:{towards:{...at,dimInOriginal:!1},right:{...Xe,dimInOriginal:!0}},hud:{lives:xe,dimmed:it,icons:at}},dimmed:{main:Je,edges:{towards:{...xe,dimInOriginal:!0},right:{...xe,dimInOriginal:!1}},hud:{lives:xe,dimmed:it,icons:at}}},magenta:{basic:{main:it,edges:{towards:{...at,dimInOriginal:!0},right:{...xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:xe,icons:Je}},dimmed:{main:it,edges:{towards:{...at,dimInOriginal:!0},right:{...xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:xe,icons:Je}}},cyan:{basic:{main:xe,edges:{towards:{...it,dimInOriginal:!1},right:{...Xe,dimInOriginal:!1}},hud:{lives:Xe,dimmed:at,icons:Je}},dimmed:{main:xe,edges:{towards:{...it,dimInOriginal:!0},right:{...Xe,dimInOriginal:!0}},hud:{lives:Xe,dimmed:at,icons:Je}}},green:{basic:{main:at,edges:{towards:{...xe,dimInOriginal:!1},right:{...Je,dimInOriginal:!1}},hud:{lives:Xe,dimmed:it,icons:xe}},dimmed:{main:at,edges:{towards:{...xe,dimInOriginal:!0},right:{...Je,dimInOriginal:!0}},hud:{lives:Xe,dimmed:it,icons:xe}}}},Zo=t=>ps[t.hue][t.shade],Xr={head:z.pastelBlue,heels:z.pink},cc=t=>{const{main:e}=ps[t].basic;return{backgroundColor:e.basic.toHex(),borderColor:e.dimmed.toHex()}};function ox(){const t=gt(),e=be(Fg);return f.jsxs(f.Fragment,{children:[f.jsx(fs,{value:e.hue,onSelect:r=>{t(pl({hue:r}))},values:cg,disableCommandInput:!0,OptionCommandItem:({value:r,onSelect:n})=>f.jsx(hs,{value:r,className:"border-l-3 h-2 w-full p-0",style:cc(r),onSelect:n}),triggerButtonLabel:"colour",triggerButtonClassName:Ce("w-full",`${e.hue==="white"||e.hue==="yellow"?"text-pureBlack":"text-white"}`),triggerButtonStyle:cc(e.hue)}),f.jsx(Xa,{className:"",label:"shade",value:e.shade==="basic",onClick:(r,n)=>{t(pl({shade:n?"basic":"dimmed"}))},falseLabel:"dim",trueLabel:"basic"})]})}function sx(){const t=gt(),e=be(Ug);return f.jsx(fs,{value:e,onSelect:r=>{t(Hg(r))},values:ug,disableCommandInput:!0,triggerButtonClassName:"w-full",triggerButtonLabel:e})}const It=({iconClasses:t,text:e})=>f.jsxs("div",{className:"relative w-full h-full",children:[f.jsx("span",{className:`sprite absolute top-0 left-0 ${t} ${F}`}),f.jsx(Q,{className:"bg-metallicBlueHalfbrite absolute top-0 right-0 pl-oneScaledPix block",children:e})]}),_o=({iconClassName:t})=>f.jsx(wt,{topClasses:me("texture-bubbles_white_2 [button:hover_&]:texture-animated-bubbles_white"),bottomClasses:t}),wt=({topClasses:t,bottomClasses:e="texture-headlessBase"})=>f.jsxs("div",{className:"relative w-full h-full",children:[f.jsx("span",{className:`sprite absolute top-[calc(9px*var(--scale))] left-0 ${e} ${F}`}),f.jsx("span",{className:`sprite absolute top-[calc(-3px*var(--scale))] left-0 ${t} ${F}`})]}),ix="[button:not(:disabled):hover_&]:hidden",ax="hidden [button:not(:disabled):hover_&]:inline mt-quarter",lx="hidden [button:not(:disabled):hover_&]:inline",Vn=({icon:t,topText:e,bottomText:r})=>f.jsxs("span",{className:"w-full h-full flex flex-col items-center justify-center",children:[f.jsx("span",{className:ix,children:t}),f.jsx(Q,{className:ax,children:e}),f.jsx(Q,{className:lx,children:r})]}),cx=()=>{const t=gt(),e=be(Wg),r=be(Gg);return f.jsxs("div",{className:"flex flex-row gap-oneScaledPix bg-metallicBlue",children:[f.jsx(nt,{disabled:!e,onClick:()=>{t(id())},children:f.jsx(Vn,{icon:f.jsx(Q,{children:"⬅"}),topText:"un",bottomText:"do"})}),f.jsx(nt,{disabled:!r,onClick:()=>{t(ad())},children:f.jsx(Vn,{icon:f.jsx(Q,{children:"➡"}),topText:"re",bottomText:"do"})})]})},ux=({className:t})=>{const e=gt();return f.jsx(Xa,{className:t,label:"scenery",value:be(r=>r.levelEditor.wallsFloorsLocked),onClick:(r,n)=>{e(qg(n))},falseLabel:"edit",trueLabel:"lock"})},dx=()=>{const t=be(r=>rn(r).planet),e=me(t==="moonbase"?"texture-door_frame_moonbase_x_whole":"texture-door_frame_generic_x_whole");return f.jsx($,{itemTool:{type:"door",config:{direction:"away",toRoom:"(placeholder)"}},children:f.jsx("span",{className:`sprite ${e} ${F}`})})},hx=()=>{const t=be(n=>rn(n).planet),e={type:"wall",config:{direction:"away",tiles:Array.from(Vg(t,1))}},r=me(t==="blacktooth"?"texture-blacktooth_wall_plain_away":t==="bookworld"?"texture-bookworld_wall_cowboy_away":t==="jail"?"texture-jail_wall_bars_away":t==="egyptus"?"texture-egyptus_wall_hieroglyphics_away":t==="market"?"texture-market_wall_passage_away":t==="moonbase"?"texture-moonbase_wall_window1_away":t==="penitentiary"?"texture-penitentiary_wall_loop_away":"texture-safari_wall_wall_away");return f.jsx($,{itemTool:e,children:f.jsx("span",{className:`sprite ${r} ${F}`})})},fx=()=>f.jsx(nt,{className:"bg-midRed",onClick:()=>L.dispatch(Kg()),children:f.jsx(Q,{className:"relative leading-none",children:"CLR"})}),_f=({currentRoomId:t,direction:e})=>{const r=be(({levelEditor:s})=>s.campaignInProgress),n=be(({levelEditor:s})=>s.currentlyEditingRoomId),o=gt();return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex flex-row gap-oneScaledPix w-full flex-wrap pt-1",children:[f.jsxs(Q,{className:"text-lightGrey leading-none",children:["Room ",e==="roomAbove"?"⬆":"⬇"]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex flex-row gap-oneScaledPix",children:[f.jsx(kt,{className:"w-2 leading-none bg-moss",children:f.jsx(Q,{onClick:()=>o(Es({direction:e,createNew:!0})),children:"+"})}),f.jsx(kt,{className:"w-2 leading-none bg-midRed",children:f.jsx(Q,{onClick:()=>o(Es({direction:e,createNew:!1,roomId:void 0})),children:"x"})})]})]}),f.jsx("div",{className:"flex flex-row gap-oneScaledPix w-full flex-wrap",children:f.jsx(wf,{value:t,campaign:r,excludeRoomIds:[n],triggerButtonClassName:"w-full",onSelect:s=>{o(Es({direction:e,createNew:!1,roomId:s}))}})})]})},px=()=>{const t=be(({levelEditor:e})=>ld(e).roomAbove);return f.jsx(f.Fragment,{children:f.jsx(_f,{currentRoomId:t,direction:"roomAbove"})})},gx=()=>{const t=be(({levelEditor:e})=>ld(e).roomBelow);return f.jsx(f.Fragment,{children:f.jsx(_f,{currentRoomId:t,direction:"roomBelow"})})},mx=()=>{const t=be(({levelEditor:e})=>e.tool.type==="eyeDropper");return f.jsx(nt,{isCurrentTool:t,onClick:()=>L.dispatch(Gt({type:"eyeDropper"})),children:f.jsx("span",{className:"relative sprite texture-editor_tool_eyedropper leading-none"})})},gs=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const yx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",En=Array.prototype.slice.call(yx),So=(t=>{let e={};return t.forEach((r,n)=>e[r]=n),e})(En),vx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Mo=String.fromCharCode.bind(String),uc=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),wx=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Sf=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),bx=t=>{let e,r,n,o,s="";const i=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|o,s+=En[e>>18&63]+En[e>>12&63]+En[e>>6&63]+En[e&63]}return i?s.slice(0,i-3)+"===".substring(i):s},xx=typeof btoa=="function"?t=>btoa(t):gs?t=>Buffer.from(t,"binary").toString("base64"):bx,dc=gs?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let n=0,o=t.length;n<o;n+=4096)r.push(Mo.apply(null,t.subarray(n,n+4096)));return xx(r.join(""))},_x=(t,e=!1)=>e?wx(dc(t)):dc(t),Sx=t=>{if(t=t.replace(/\s+/g,""),!vx.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",n,o;for(let s=0;s<t.length;)e=So[t.charAt(s++)]<<18|So[t.charAt(s++)]<<12|(n=So[t.charAt(s++)])<<6|(o=So[t.charAt(s++)]),r+=n===64?Mo(e>>16&255):o===64?Mo(e>>16&255,e>>8&255):Mo(e>>16&255,e>>8&255,e&255);return r},kx=typeof atob=="function"?t=>atob(Sf(t)):gs?t=>Buffer.from(t,"base64").toString("binary"):Sx,Cx=gs?t=>uc(Buffer.from(t,"base64")):t=>uc(kx(t).split("").map(e=>e.charCodeAt(0))),Px=t=>Cx(Ex(t)),Ex=t=>Sf(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Tx=!0,kf="gzip",Cf=async t=>{const e=JSON.stringify(t),n=new TextEncoder().encode(e),o=new Blob([n]),s=new CompressionStream(kf),i=o.stream().pipeThrough(s),a=await new Response(i).arrayBuffer(),l=new Uint8Array(a);return _x(l,Tx)},Rx=async t=>{try{const e=Px(t),r=new Blob([e]),n=new DecompressionStream(kf),o=r.stream().pipeThrough(n),s=await new Response(o).text();return JSON.parse(s)}catch(e){throw new Error("error decompressing object",{cause:e})}},Ax=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Ja extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Ox extends Ja{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class hc extends Ja{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class fc extends Ja{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Yi;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Yi||(Yi={}));var Ix=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class jx{constructor(e,{headers:r={},customFetch:n,region:o=Yi.Any}={}){this.url=e,this.headers=r,this.region=o,this.fetch=Ax(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return Ix(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(a["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(a["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),o),body:u}).catch(m=>{throw new Ox(m)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new hc(d);if(!d.ok)throw new fc(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return p==="application/json"?y=yield d.json():p==="application/octet-stream"?y=yield d.blob():p==="text/event-stream"?y=d:p==="multipart/form-data"?y=yield d.formData():y=yield d.text(),{data:y,error:null,response:d}}catch(o){return{data:null,error:o,response:o instanceof fc||o instanceof hc?o.context:void 0}}})}}var _e={},Ar={},Or={},Ir={},jr={},$r={},$x=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},an=$x();const zx=an.fetch,Pf=an.fetch.bind(an),Ef=an.Headers,Nx=an.Request,Dx=an.Response,mn=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ef,Request:Nx,Response:Dx,default:Pf,fetch:zx},Symbol.toStringTag,{value:"Module"})),Lx=dg(mn);var ko={},pc;function Tf(){if(pc)return ko;pc=1,Object.defineProperty(ko,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ko.default=t,ko}var gc;function Rf(){if(gc)return $r;gc=1;var t=$r&&$r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty($r,"__esModule",{value:!0});const e=t(Lx),r=t(Tf());class n{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=Object.assign({},this.headers),this.headers[s]=i,this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h;let p=null,y=null,m=null,v=c.status,w=c.statusText;if(c.ok){if(this.method!=="HEAD"){const k=await c.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=k:y=JSON.parse(k))}const b=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),x=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");b&&x&&x.length>1&&(m=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(p={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,m=null,v=406,w="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(y=[],p=null,v=200,w="OK")}catch{c.status===404&&b===""?(v=204,w="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((h=p?.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,v=200,w="OK"),p&&this.shouldThrowOnError)throw new r.default(p)}return{error:p,data:y,count:m,status:v,statusText:w}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(d=c?.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=c?.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}}return $r.default=n,$r}var mc;function Af(){if(mc)return jr;mc=1;var t=jr&&jr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(jr,"__esModule",{value:!0});const e=t(Rf());class r extends e.default{select(o){let s=!1;const i=(o??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:s=!0,nullsFirst:i,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${o}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${o}`),this}range(o,s,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${o}`),this.url.searchParams.set(c,`${s-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:s=!1,settings:i=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const d=[o?"analyze":null,s?"verbose":null,i?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${h}"; options=${d};`,c==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return jr.default=r,jr}var yc;function Ya(){if(yc)return Ir;yc=1;var t=Ir&&Ir.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ir,"__esModule",{value:!0});const e=t(Af());class r extends e.default{eq(o,s){return this.url.searchParams.append(o,`eq.${s}`),this}neq(o,s){return this.url.searchParams.append(o,`neq.${s}`),this}gt(o,s){return this.url.searchParams.append(o,`gt.${s}`),this}gte(o,s){return this.url.searchParams.append(o,`gte.${s}`),this}lt(o,s){return this.url.searchParams.append(o,`lt.${s}`),this}lte(o,s){return this.url.searchParams.append(o,`lte.${s}`),this}like(o,s){return this.url.searchParams.append(o,`like.${s}`),this}likeAllOf(o,s){return this.url.searchParams.append(o,`like(all).{${s.join(",")}}`),this}likeAnyOf(o,s){return this.url.searchParams.append(o,`like(any).{${s.join(",")}}`),this}ilike(o,s){return this.url.searchParams.append(o,`ilike.${s}`),this}ilikeAllOf(o,s){return this.url.searchParams.append(o,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(o,s){return this.url.searchParams.append(o,`ilike(any).{${s.join(",")}}`),this}is(o,s){return this.url.searchParams.append(o,`is.${s}`),this}in(o,s){const i=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(o,`in.(${i})`),this}contains(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cs.{${s.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(s)}`),this}containedBy(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cd.{${s.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(s)}`),this}rangeGt(o,s){return this.url.searchParams.append(o,`sr.${s}`),this}rangeGte(o,s){return this.url.searchParams.append(o,`nxl.${s}`),this}rangeLt(o,s){return this.url.searchParams.append(o,`sl.${s}`),this}rangeLte(o,s){return this.url.searchParams.append(o,`nxr.${s}`),this}rangeAdjacent(o,s){return this.url.searchParams.append(o,`adj.${s}`),this}overlaps(o,s){return typeof s=="string"?this.url.searchParams.append(o,`ov.${s}`):this.url.searchParams.append(o,`ov.{${s.join(",")}}`),this}textSearch(o,s,{config:i,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=i===void 0?"":`(${i})`;return this.url.searchParams.append(o,`${l}fts${c}.${s}`),this}match(o){return Object.entries(o).forEach(([s,i])=>{this.url.searchParams.append(s,`eq.${i}`)}),this}not(o,s,i){return this.url.searchParams.append(o,`not.${s}.${i}`),this}or(o,{foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${o})`),this}filter(o,s,i){return this.url.searchParams.append(o,`${s}.${i}`),this}}return Ir.default=r,Ir}var vc;function Of(){if(vc)return Or;vc=1;var t=Or&&Or.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Or,"__esModule",{value:!0});const e=t(Ya());class r{constructor(o,{headers:s={},schema:i,fetch:a}){this.url=o,this.headers=s,this.schema=i,this.fetch=a}select(o,{head:s=!1,count:i}={}){const a=s?"HEAD":"GET";let l=!1;const c=(o??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:s,defaultToNull:i=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(o)){const c=o.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:s,ignoreDuplicates:i=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${i?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(o)){const d=o.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:s}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const s="DELETE",i=[];return o&&i.push(`count=${o}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Or.default=r,Or}var kn={},Cn={},wc;function Mx(){return wc||(wc=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.version=void 0,Cn.version="0.0.0-automated"),Cn}var bc;function Bx(){if(bc)return kn;bc=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.DEFAULT_HEADERS=void 0;const t=Mx();return kn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},kn}var xc;function Fx(){if(xc)return Ar;xc=1;var t=Ar&&Ar.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ar,"__esModule",{value:!0});const e=t(Of()),r=t(Ya()),n=Bx();class o{constructor(i,{headers:a={},schema:l,fetch:c}={}){this.url=i,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new o(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:l=!1,get:c=!1,count:u}={}){let d;const h=new URL(`${this.url}/rpc/${i}`);let p;l||c?(d=l?"HEAD":"GET",Object.entries(a).filter(([m,v])=>v!==void 0).map(([m,v])=>[m,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([m,v])=>{h.searchParams.append(m,v)})):(d="POST",p=a);const y=Object.assign({},this.headers);return u&&(y.Prefer=`count=${u}`),new r.default({method:d,url:h,headers:y,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return Ar.default=o,Ar}var _c;function Ux(){if(_c)return _e;_c=1;var t=_e&&_e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(_e,"__esModule",{value:!0}),_e.PostgrestError=_e.PostgrestBuilder=_e.PostgrestTransformBuilder=_e.PostgrestFilterBuilder=_e.PostgrestQueryBuilder=_e.PostgrestClient=void 0;const e=t(Fx());_e.PostgrestClient=e.default;const r=t(Of());_e.PostgrestQueryBuilder=r.default;const n=t(Ya());_e.PostgrestFilterBuilder=n.default;const o=t(Af());_e.PostgrestTransformBuilder=o.default;const s=t(Rf());_e.PostgrestBuilder=s.default;const i=t(Tf());return _e.PostgrestError=i.default,_e.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:s.default,PostgrestError:i.default},_e}var Hx=Ux();const Wx=Yn(Hx),{PostgrestClient:Gx,PostgrestQueryBuilder:lE,PostgrestFilterBuilder:cE,PostgrestTransformBuilder:uE,PostgrestBuilder:dE,PostgrestError:hE}=Wx;function qx(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Vx=qx(),Kx="2.11.15",Xx=`realtime-js/${Kx}`,Jx="1.0.0",If=1e4,Yx=1e3;var Nn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Nn||(Nn={}));var Ee;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Ee||(Ee={}));var Ze;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ze||(Ze={}));var Zi;(function(t){t.websocket="websocket"})(Zi||(Zi={}));var ar;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ar||(ar={}));class Zx{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const o=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const a=n.decode(e.slice(i,i+o));i=i+o;const l=n.decode(e.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class jf{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var fe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(fe||(fe={}));const Sc=(t,e,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,i)=>(s[i]=Qx(i,t,e,o),s),{})},Qx=(t,e,r,n)=>{const o=e.find(a=>a.name===t),s=o?.type,i=r[t];return s&&!n.includes(s)?$f(s,i):Qi(i)},$f=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return n0(e,r)}switch(t){case fe.bool:return e0(e);case fe.float4:case fe.float8:case fe.int2:case fe.int4:case fe.int8:case fe.numeric:case fe.oid:return t0(e);case fe.json:case fe.jsonb:return r0(e);case fe.timestamp:return o0(e);case fe.abstime:case fe.date:case fe.daterange:case fe.int4range:case fe.int8range:case fe.money:case fe.reltime:case fe.text:case fe.time:case fe.timestamptz:case fe.timetz:case fe.tsrange:case fe.tstzrange:return Qi(e);default:return Qi(e)}},Qi=t=>t,e0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},t0=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},r0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},n0=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const i=t.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(a=>$f(e,a))}return t},o0=t=>typeof t=="string"?t.replace(" ","T"):t,zf=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Ks{constructor(e,r,n={},o=If){this.channel=e,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kc;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(kc||(kc={}));class Dn{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dn.syncState(this.state,o,s,i),this.pendingDiffs.forEach(l=>{this.state=Dn.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Dn.syncDiff(this.state,o,s,i),a())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,o){const s=this.cloneDeep(e),i=this.transformState(r),a={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const d=s[c];if(d){const h=u.map(v=>v.presence_ref),p=d.map(v=>v.presence_ref),y=u.filter(v=>p.indexOf(v.presence_ref)<0),m=d.filter(v=>h.indexOf(v.presence_ref)<0);y.length>0&&(a[c]=y),m.length>0&&(l[c]=m)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},n,o)}static syncDiff(e,r,n,o){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(s,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(p=>p.presence_ref),h=u.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...h)}n(a,u,l)}),this.map(i,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,o(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const o=e[n];return"metas"in o?r[n]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=o,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Cc;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Cc||(Cc={}));var Pc;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Pc||(Pc={}));var xt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(xt||(xt={}));class Za{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Ee.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ks(this,Ze.join,this.params,this.timeout),this.rejoinTimer=new jf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ee.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ee.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ee.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ee.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ze.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Dn(this),this.broadcastEndpointURL=zf(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Ee.closed){const{config:{broadcast:s,presence:i,private:a}}=this.params;this._onError(u=>e?.(xt.CHANNEL_ERROR,u)),this._onClose(()=>e?.(xt.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&o!==void 0?o:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e?.(xt.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h?.length)!==null&&d!==void 0?d:0,y=[];for(let m=0;m<p;m++){const v=h[m],{filter:{event:w,schema:S,table:b,filter:x}}=v,k=u&&u[m];if(k&&k.event===w&&k.schema===S&&k.table===b&&k.filter===x)y.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=Ee.errored,e?.(xt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(xt.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ee.errored,e?.(xt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(xt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ee.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ze.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new Ks(this,Ze.leave,{},e),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const o=new AbortController,s=setTimeout(()=>o.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(s),i}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Ks(this,e,r,n);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var o,s;const i=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Ze;if(n&&[a,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(p=>{var y,m,v;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var y,m,v,w,S,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const x=p.id,k=(y=p.filter)===null||y===void 0?void 0:y.event;return x&&((m=r.ids)===null||m===void 0?void 0:m.includes(x))&&(k==="*"||k?.toLocaleLowerCase()===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const x=(S=(w=p?.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return x==="*"||x===((b=r?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:m,table:v,commit_timestamp:w,type:S,errors:b}=y;h=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:w,eventType:S,new:{},old:{},errors:b}),this._getPayloadRecords(y))}p.callback(h,n)})}_isClosed(){return this.state===Ee.closed}_isJoined(){return this.state===Ee.joined}_isJoining(){return this.state===Ee.joining}_isLeaving(){return this.state===Ee.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const o=e.toLocaleLowerCase(),s={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Za.isEqual(o.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ze.close,{},e)}_onError(e){this._on(Ze.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ee.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Sc(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Sc(e.columns,e.old_record)),r}}const Ec=()=>{},s0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class i0{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=If,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ec,this.ref=0,this.logger=Ec,this.conn=null,this.sendBuffer=[],this.serializer=new Zx,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>Ut(async()=>{const{default:l}=await Promise.resolve().then(()=>mn);return{default:l}},void 0).then(({default:l})=>l(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${Zi.websocket}`,this.httpEndpoint=zf(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const o=(n=r?.params)===null||n===void 0?void 0:n.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r?.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new jf(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Vx),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Jx}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Nn.connecting:return ar.Connecting;case Nn.open:return ar.Open;case Nn.closing:return ar.Closing;default:return ar.Closed}}isConnected(){return this.connectionState()===ar.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,o=this.getChannels().find(s=>s.topic===n);if(o)return o;{const s=new Za(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:o,ref:s}=e,i=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:Xx};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Ze.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Yx,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:o,payload:s,ref:i}=r;n==="phoenix"&&o==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${o} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(o,s,i)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ze.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${e}${n}${o}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([s0],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Qa extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Se(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class a0 extends Qa{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ea extends Qa{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var l0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const Nf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},c0=()=>l0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ut(()=>Promise.resolve().then(()=>mn),void 0)).Response:Response}),ta=t=>{if(Array.isArray(t))return t.map(r=>ta(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=ta(n)}),e};var kr=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const Xs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),u0=(t,e,r)=>kr(void 0,void 0,void 0,function*(){const n=yield c0();t instanceof n&&!r?.noResolveJson?t.json().then(o=>{e(new a0(Xs(o),t.status||500))}).catch(o=>{e(new ea(Xs(o),o))}):e(new ea(Xs(t),t))}),d0=(t,e,r,n)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n&&(o.body=JSON.stringify(n)),Object.assign(Object.assign({},o),r))};function oo(t,e,r,n,o,s){return kr(this,void 0,void 0,function*(){return new Promise((i,a)=>{t(r,d0(e,n,o,s)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>u0(l,a,n))})})}function Qo(t,e,r,n){return kr(this,void 0,void 0,function*(){return oo(t,"GET",e,r,n)})}function Lt(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"POST",e,n,o,r)})}function h0(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"PUT",e,n,o,r)})}function f0(t,e,r,n){return kr(this,void 0,void 0,function*(){return oo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Df(t,e,r,n,o){return kr(this,void 0,void 0,function*(){return oo(t,"DELETE",e,n,o,r)})}var je=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const p0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Tc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class g0{constructor(e,r={},n,o){this.url=e,this.headers=r,this.bucketId=n,this.fetch=Nf(o)}uploadOrUpdate(e,r,n,o){return je(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Tc),o);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),o?.headers&&(a=Object.assign(Object.assign({},a),o.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:a},i?.duplex?{duplex:i.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}upload(e,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,o){return je(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Tc.upsert},o),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Se(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return je(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const o=Object.assign({},this.headers);r?.upsert&&(o["x-upsert"]="true");const s=yield Lt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),i=new URL(this.url+s.url),a=i.searchParams.get("token");if(!a)throw new Qa("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}update(e,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return je(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}copy(e,r,n){return je(this,void 0,void 0,function*(){try{return{data:{path:(yield Lt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}createSignedUrl(e,r,n){return je(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield Lt(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}createSignedUrls(e,r,n){return je(this,void 0,void 0,function*(){try{const o=yield Lt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}download(e,r){return je(this,void 0,void 0,function*(){const o=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),i=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Qo(this.fetch,`${this.url}/${o}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}info(e){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Qo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ta(n),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}exists(e){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield f0(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Se(n)&&n instanceof ea){const o=n.originalError;if([400,404].includes(o?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),o=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&o.push(s);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&o.push(l);let c=o.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield Df(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}list(e,r,n){return je(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},p0),r),{prefix:e||""});return{data:yield Lt(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const m0="2.7.1",y0={"X-Client-Info":`storage-js/${m0}`};var zr=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class v0{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},y0),r),this.fetch=Nf(n)}listBuckets(){return zr(this,void 0,void 0,function*(){try{return{data:yield Qo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Se(e))return{data:null,error:e};throw e}})}getBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield Qo(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return zr(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return zr(this,void 0,void 0,function*(){try{return{data:yield h0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}emptyBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}deleteBucket(e){return zr(this,void 0,void 0,function*(){try{return{data:yield Df(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}}class w0 extends v0{constructor(e,r={},n){super(e,r,n)}from(e){return new g0(this.url,this.headers,e,this.fetch)}}const b0="2.51.0";let Tn="";typeof Deno<"u"?Tn="deno":typeof document<"u"?Tn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tn="react-native":Tn="node";const x0={"X-Client-Info":`supabase-js-${Tn}/${b0}`},_0={headers:x0},S0={schema:"public"},k0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},C0={};var P0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const E0=t=>{let e;return t?e=t:typeof fetch>"u"?e=Pf:e=fetch,(...r)=>e(...r)},T0=()=>typeof Headers>"u"?Ef:Headers,R0=(t,e,r)=>{const n=E0(r),o=T0();return(s,i)=>P0(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new o(i?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var A0=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};function O0(t){return t.endsWith("/")?t:t+"/"}function I0(t,e){var r,n;const{db:o,auth:s,realtime:i,global:a}=t,{db:l,auth:c,realtime:u,global:d}=e,h={db:Object.assign(Object.assign({},l),o),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(r=d?.headers)!==null&&r!==void 0?r:{}),(n=a?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>A0(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}const Lf="2.71.0",Wr=30*1e3,ra=3,Js=ra*Wr,j0="http://localhost:9999",$0="supabase.auth.token",z0={"X-Client-Info":`gotrue-js/${Lf}`},na="X-Supabase-Api-Version",Mf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},N0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,D0=10*60*1e3;class el extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function J(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class L0 extends el{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function M0(t){return J(t)&&t.name==="AuthApiError"}class Bf extends el{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Zt extends el{constructor(e,r,n,o){super(e,n,o),this.name=r,this.status=n}}class Dt extends Zt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function B0(t){return J(t)&&t.name==="AuthSessionMissingError"}class Co extends Zt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Po extends Zt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Eo extends Zt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function F0(t){return J(t)&&t.name==="AuthImplicitGrantRedirectError"}class Rc extends Zt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class oa extends Zt{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ys(t){return J(t)&&t.name==="AuthRetryableFetchError"}class Ac extends Zt{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class sa extends Zt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Oc=` 	
\r=`.split(""),U0=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Oc.length;e+=1)t[Oc[e].charCodeAt(0)]=-2;for(let e=0;e<es.length;e+=1)t[es[e].charCodeAt(0)]=e;return t})();function Ic(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(es[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(es[n]),e.queuedBits-=6}}function Ff(t,e,r){const n=U0[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function jc(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{G0(i,n,r)};for(let i=0;i<t.length;i+=1)Ff(t.charCodeAt(i),o,s);return e.join("")}function H0(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function W0(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}H0(n,e)}}function G0(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function q0(t){const e=[],r={queue:0,queuedBits:0},n=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)Ff(t.charCodeAt(o),r,n);return new Uint8Array(e)}function V0(t){const e=[];return W0(t,r=>e.push(r)),new Uint8Array(e)}function K0(t){const e=[],r={queue:0,queuedBits:0},n=o=>{e.push(o)};return t.forEach(o=>Ic(o,r,n)),Ic(null,r,n),e.join("")}function X0(t){return Math.round(Date.now()/1e3)+t}function J0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ye=()=>typeof window<"u"&&typeof document<"u",tr={tested:!1,writable:!1},Uf=()=>{if(!Ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(tr.tested)return tr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),tr.tested=!0,tr.writable=!0}catch{tr.tested=!0,tr.writable=!1}return tr.writable};function Y0(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return r.searchParams.forEach((n,o)=>{e[o]=n}),e}const Hf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ut(async()=>{const{default:n}=await Promise.resolve().then(()=>mn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Z0=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Gr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},rr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},jt=async(t,e)=>{await t.removeItem(e)};class ms{constructor(){this.promise=new ms.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}ms.promiseConstructor=Promise;function Zs(t){const e=t.split(".");if(e.length!==3)throw new sa("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!N0.test(e[n]))throw new sa("JWT not in base64url format");return{header:JSON.parse(jc(e[0])),payload:JSON.parse(jc(e[1])),signature:q0(e[2]),raw:{header:e[0],payload:e[1]}}}async function Q0(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function e_(t,e){return new Promise((n,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await t(s);if(!e(s,null,i)){n(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function t_(t){return("0"+t.toString(16)).substr(-2)}function r_(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let s=0;s<56;s++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(e),Array.from(e,t_).join("")}async function n_(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function o_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await n_(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Nr(t,e,r=!1){const n=r_();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await Gr(t,`${e}-code-verifier`,o);const s=await o_(n);return[s,n===s?"plain":"s256"]}const s_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i_(t){const e=t.headers.get(na);if(!e||!e.match(s_))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function a_(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function l_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const c_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Dr(t){if(!c_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qs(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var u_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};const or=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),d_=[502,503,504];async function $c(t){var e;if(!Z0(t))throw new oa(or(t),0);if(d_.includes(t.status))throw new oa(or(t),t.status);let r;try{r=await t.json()}catch(s){throw new Bf(or(s),s)}let n;const o=i_(t);if(o&&o.getTime()>=Mf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ac(or(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Dt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Ac(or(r),t.status,r.weak_password.reasons);throw new L0(or(r),t.status||500,n)}const h_=(t,e,r,n)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function oe(t,e,r,n){var o;const s=Object.assign({},n?.headers);s[na]||(s[na]=Mf["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(o=n?.query)!==null&&o!==void 0?o:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await f_(t,e,r+a,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function f_(t,e,r,n,o,s){const i=h_(e,n,o,s);let a;try{a=await t(r,Object.assign({},i))}catch(l){throw console.error(l),new oa(or(l),0)}if(a.ok||await $c(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await $c(l)}}function bt(t){var e;let r=null;y_(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=X0(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function zc(t){const e=bt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Mt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function p_(t){return{data:t,error:null}}function g_(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s}=t,i=u_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s},l=Object.assign({},i);return{data:{properties:a,user:l},error:null}}function m_(t){return t}function y_(t){return t.access_token&&t.refresh_token&&t.expires_in}const ei=["global","local","others"];var v_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};class w_{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Hf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=ei[0]){if(ei.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ei.join(", ")}`);try{return await oe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=v_(e,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n?.newEmail,delete o.newEmail),await oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:g_,redirectTo:r?.redirectTo})}catch(r){if(J(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await oe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Mt})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,o,s,i,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:m_});if(u.error)throw u.error;const d=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const m=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(J(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Dr(e);try{return await oe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Mt})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Dr(e);try{return await oe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Dr(e);try{return await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Mt})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Dr(e.userId);try{const{data:r,error:n}=await oe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(J(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Dr(e.userId),Dr(e.id);try{return{data:await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}}function Nc(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function b_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lr={debug:!!(globalThis&&Uf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wf extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class x_ extends Wf{}async function __(t,e,r){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await r()}finally{Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new x_(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}b_();const S_={url:j0,storageKey:$0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:z0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Dc(t,e,r){return await r()}const Mr={};class Kn{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kn.nextInstanceID,Kn.nextInstanceID+=1,this.instanceID>0&&Ye()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},S_),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new w_({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Hf(o.fetch),this.lock=o.lock||Dc,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Ye()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=__:this.lock=Dc,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Uf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Nc(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Nc(this.memoryStorage)),Ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Lf}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=Y0(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ye()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),F0(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:a}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return J(r)?{error:r}:{error:new Bf("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,o;try{const s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:bt}),{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(J(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,o;try{let s;if("email"in e){const{email:u,password:d,options:h}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await Nr(this.storage,this.storageKey)),s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:d,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:p,code_challenge_method:y},xform:bt})}else if("phone"in e){const{phone:u,password:d,options:h}=e;s=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:bt})}else throw new Po("You must provide either an email or phone number and a password");const{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(J(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:i,options:a}=e;r=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:zc})}else if("phone"in e){const{phone:s,password:i,options:a}=e;r=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:zc})}else throw new Po("You must provide either an email or phone number and a password");const{data:n,error:o}=r;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Co}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,o,s,i,a,l,c,u,d,h,p;let y,m;if("message"in e)y=e.message,m=e.signature;else{const{chain:v,wallet:w,statement:S,options:b}=e;let x;if(Ye())if(typeof w=="object")x=w;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))x=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=w}const k=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const C=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),S?{statement:S}:null));let _;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")_=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)_=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)y=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),m=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${k.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(o=(n=b?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=b?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((i=b?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((c=b?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((d=(u=b?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...b.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const C=await x.signMessage(new TextEncoder().encode(y),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=C}}try{const{data:v,error:w}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:K0(m)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:bt});if(w)throw w;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Co}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:w})}catch(v){if(J(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await rr(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{const{data:s,error:i}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:bt});if(await jt(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Co}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(J(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:o,access_token:s,nonce:i}=e,a=await oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:bt}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Co}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,o,s,i;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Nr(this.storage,this.storageKey));const{error:d}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(o=l?.data)!==null&&o!==void 0?o:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(i=l?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Po("You must provide either an email or phone number.")}catch(a){if(J(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let o,s;"options"in e&&(o=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:a}=await oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:bt});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(J(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var r,n,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Nr(this.storage,this.storageKey)),await oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:p_})}catch(s){if(J(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Dt;const{error:o}=await oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(J(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:o,options:s}=e,{error:i}=await oe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:n,type:o,options:s}=e,{data:i,error:a}=await oe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:a}}throw new Po("You must provide either an email or phone number and a type")}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await rr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Js:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const i=await rr(this.userStorage,this.storageKey+"-user");i?.user?e.user=i.user:e.user=Qs()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mt}):await this._useSession(async r=>{var n,o,s;const{data:i,error:a}=r;if(a)throw a;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dt}:await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Mt})})}catch(r){if(J(r))return B0(r)&&(await this._removeSession(),await jt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:o,error:s}=n;if(s)throw s;if(!o.session)throw new Dt;const i=o.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Nr(this.storage,this.storageKey));const{data:c,error:u}=await oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:i.access_token,xform:Mt});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dt;const r=Date.now()/1e3;let n=r,o=!0,s=null;const{payload:i}=Zs(e.access_token);if(i.exp&&(n=i.exp,o=n<=r),o){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(J(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:i,error:a}=r;if(a)throw a;e=(n=i.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Dt;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Ye())throw new Eo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Eo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Rc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Eo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Rc("No code detected.");const{data:S,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:a,expires_at:l,token_type:c}=e;if(!s||!a||!i||!c)throw new Eo("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const p=h-u;p*1e3<=Wr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const y=h-d;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,u);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const w={provider_token:n,provider_refresh_token:o,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(n){if(J(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await rr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{error:s};const i=(n=o.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(M0(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await jt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=J0(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,o;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await Nr(this.storage,this.storageKey,!0));try{return await oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(J(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:o}=await this._useSession(async s=>{var i,a,l,c,u;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await oe(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(o)throw o;return Ye()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(J(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)throw i;return await oe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await e_(async o=>(o>0&&await Q0(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:bt})),(o,s)=>{const i=200*Math.pow(2,o);return s&&Ys(s)&&Date.now()+i-n<Wr})}catch(n){if(this._debug(r,"error",n),J(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Ye()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await rr(this.storage,this.storageKey);if(o&&this.userStorage){let i=await rr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await Gr(this.userStorage,this.storageKey+"-user",i)),o.user=(e=i?.user)!==null&&e!==void 0?e:Qs()}else if(o&&!o.user&&!o.user){const i=await rr(this.storage,this.storageKey+"-user");i&&i?.user?(o.user=i.user,await jt(this.storage,this.storageKey+"-user"),await Gr(this.storage,this.storageKey,o)):o.user=Qs()}if(this._debug(n,"session from storage",o),!this._isValidSession(o)){this._debug(n,"session is not valid"),o!==null&&await this._removeSession();return}const s=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Js;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Js}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),Ys(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:a}=await this._getUser(o.access_token);!a&&i?.user?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(n,"error",o),console.error(o);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Dt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new ms;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new Dt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(o,"error",s),J(s)){const i={session:null,error:s};return Ys(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,r,n=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Gr(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const s=structuredClone(o);await Gr(this.storage,this.storageKey,s)}else{const o=structuredClone(r);await Gr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await jt(this.storage,this.storageKey),await jt(this.storage,this.storageKey+"-code-verifier"),await jt(this.storage,this.storageKey+"-user"),this.userStorage&&await jt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ye()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Wr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-e)/Wr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Wr}ms, refresh threshold is ${ra} ticks`),o<=ra&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Wf)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ye()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Nr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(a.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);o.push(s.toString())}return n?.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await oe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await oe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((o=l?.totp)===null||o===void 0)&&o.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:a}=await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(r){if(J(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(J(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],o=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Zs(o.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((n=(r=o.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+D0>o)return n;const{data:s,error:i}=await oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,n=s.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:y}=await this.getSession();if(y||!p.session)return{data:null,error:y};n=p.session.access_token}const{header:o,payload:s,signature:i,raw:{header:a,payload:l}}=Zs(n);r?.allowExpired||a_(s.exp);const c=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:o,signature:i},error:null}}const u=l_(o.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,i,V0(`${a}.${l}`)))throw new sa("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}}Kn.nextInstanceID=0;const k_=Kn;class C_ extends k_{constructor(e){super(e)}}var P_=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function a(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class E_{constructor(e,r,n){var o,s,i;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=O0(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:S0,realtime:C0,auth:Object.assign(Object.assign({},k0),{storageKey:c}),global:_0},d=I0(n??{},u);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=R0(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Gx(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new jx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new w0(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return P_(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:o,storageKey:s,flowType:i,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new C_({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:o,flowType:i,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new i0(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const T_=(t,e,r)=>new E_(t,e,r),ln=T_("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),R_=async(t,e)=>{const r=await ln.rpc("save_campaign_version",{p_name:t,p_data:await Cf(e)});if(r.error)throw new Error(`error saving to db ${r.error.message} ${r.error.details}`,{cause:r.error});return console.log("saved ok",r.data),r.data},A_=async t=>{const e=await ln.rpc("get_latest_campaign",{p_name:t});if(e.error)throw e.error;return await Rx(e.data.data)},Gf=()=>{const[t,e]=g.useState(null);return g.useEffect(()=>{ln.auth.getUser().then(({data:{user:n}})=>{e(n)});const{data:{subscription:r}}=ln.auth.onAuthStateChange((n,o)=>{e(o?.user??null)});return()=>r.unsubscribe()},[]),t},O_=()=>{const t=Gf();return f.jsxs(f.Fragment,{children:[f.jsx(nt,{disabled:t===null,onClick:async()=>{const e=L.getState();await R_("sequel",cd(e))},children:f.jsx(Vn,{icon:f.jsxs("div",{className:"flex flex-row items-center",children:[f.jsx("span",{className:Ce("sprite sprite-tinted text-highlightBeige texture-hud_char_➡ relative",{"text-lightGrey":t===null})}),f.jsx("span",{className:Ce("sprite texture-editor_tool_save relative",{"sprite-revert-to-two-tone-dim":t===null})})]}),topText:"sa",bottomText:"ve"})}),f.jsx(nt,{disabled:t===null,onClick:async()=>{try{const e=await A_("sequel");console.log(e),L.dispatch(Xg({campaign:e}))}catch(e){console.error(e)}},children:f.jsx(Vn,{icon:f.jsxs("div",{className:"flex flex-row items-center",children:[f.jsx("span",{className:Ce("sprite texture-editor_tool_save relative",{"sprite-revert-to-two-tone-dim":t===null})}),f.jsx("span",{className:Ce("sprite sprite-tinted text-highlightBeige texture-hud_char_➡ relative",{"text-lightGrey":t===null})})]}),topText:"lo",bottomText:"ad"})})]})},I_=()=>f.jsx(nt,{children:f.jsx(Q,{className:"relative leading-none",children:"MAP"})}),j_=()=>f.jsx(nt,{onClick:async()=>{const t=L.getState(),e=cd(t),r=await Cf(e),n=new URL("https://blockstack.ing"),o=n.searchParams;o.set("campaignData",r),o.set("noSaves","1"),o.set("cheats","1"),n.hash=t.levelEditor.currentlyEditingRoomId,window.open(n.toString(),"playtest")},children:f.jsx(Vn,{topText:"pl",bottomText:"ay",icon:f.jsx("span",{className:"sprite texture-joystick mt-half"})})}),$_=t=>{switch(t){case"github":return Ku;case"discord":return Xu;default:throw new Error}},z_=({className:t})=>{const e=Gf(),r=o=>async()=>{const s=new URL(window.location.href);s.hash="";const i=s.toString(),{error:a}=await ln.auth.signInWithOAuth({provider:o,options:{redirectTo:i}});a&&console.error("Login error:",a)},n=async()=>{const{error:o}=await ln.auth.signOut();o&&console.error("Logout error:",o)};return f.jsx("div",{className:Ce(t),children:e?f.jsxs("div",{className:"bg-moss",children:[f.jsx(Q,{noSlitWords:!0,className:"overflow-hidden",children:`${$_(e.app_metadata.provider)}${e.email}`}),f.jsx(kt,{className:"px-1 w-full",onClick:n,children:f.jsx(Q,{children:"Logout"})})]}):f.jsxs("div",{className:"px-1 bg-midRed",children:[f.jsx(Q,{className:"block w-full sprites-double-height pb-1",children:"Not logged in"}),f.jsx(Q,{className:"block w-full text-highlightBeige",children:"You will not be able to save"}),f.jsxs("div",{className:"pt-1 flex flex-col gap-half",children:[f.jsx(Q,{children:"Log in with:"}),f.jsxs(kt,{className:"px-1 w-full flex-row justify-between bg-redShadow",onClick:r("github"),children:[f.jsx(Q,{children:Ku}),f.jsx(Q,{children:"GitHub"})]}),f.jsxs(kt,{className:"px-1 w-full flex-row justify-between bg-redShadow",onClick:r("discord"),children:[f.jsx(Q,{children:Xu}),f.jsx(Q,{children:"Discord"})]})]})]})})},N_=()=>{const t=be(n=>n.levelEditor.campaignInProgress),e=be(n=>n.levelEditor.currentlyEditingRoomId),r=gt();return f.jsxs("div",{className:"scale-editor flex w-full h-full text-white bg-metallicBlueHalfbrite pb-1 gap-1 flex-wrap justify-start overflow-auto",children:[f.jsx("div",{className:Pe,children:f.jsx(z_,{className:"w-full mb-1"})}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"Campaign"}),f.jsx(O_,{}),f.jsx(I_,{}),f.jsx(j_,{})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full pt-2",children:"Room"}),f.jsx(wf,{value:e,campaign:t,onSelect:n=>{r(Ti(n))},triggerButtonClassName:"w-full"}),f.jsx("div",{className:"h-1 w-full"}),f.jsx(sx,{}),f.jsx(ox,{}),f.jsx("div",{className:"h-1 w-full"}),f.jsx(px,{}),f.jsx(gx,{})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full pt-2",children:"Edit"}),f.jsxs("div",{className:Pe,children:[f.jsx(nx,{}),f.jsx(mx,{})]}),f.jsx(cx,{}),f.jsx(tx,{}),f.jsx(fx,{}),f.jsx("div",{className:"h-1 w-full"}),f.jsxs("div",{className:"flex flex-row justify-between flex-wrap gap-x-2",children:[f.jsx(rx,{className:""}),f.jsx(ux,{className:""})]})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full pt-2",children:"Blocks"}),f.jsx($,{itemTool:{type:"block",config:{style:"organic"}},children:f.jsx("span",{className:`sprite texture-block_organic ${F}`})}),f.jsx($,{itemTool:{type:"block",config:{style:"organic",disappearing:{on:"stand"}}},children:f.jsx(_o,{iconClassName:me("texture-block_organic_disappearing")})}),f.jsx($,{itemTool:{type:"block",config:{style:"artificial"}},children:f.jsx("span",{className:`sprite texture-block_artificial ${F}`})}),f.jsx($,{itemTool:{type:"block",config:{style:"artificial",disappearing:{on:"stand"}}},children:f.jsx(_o,{iconClassName:me("texture-block_artificial_disappearing")})}),f.jsx($,{itemTool:{type:"block",config:{style:"tower"}},children:f.jsx("span",{className:`sprite texture-tower ${F}`})}),f.jsx($,{itemTool:{type:"block",config:{style:"book"}},children:f.jsx("span",{className:`sprite texture-book_x ${F}`})}),f.jsxs(Sn,{children:[f.jsx($,{itemTool:{type:"barrier",config:{axis:"x"}},children:f.jsx("span",{className:`sprite texture-barrier_x ${F}`})}),f.jsx($,{itemTool:{type:"barrier",config:{axis:"y"}},children:f.jsx("span",{className:`sprite texture-barrier_y ${F}`})}),f.jsx($,{itemTool:{type:"barrier",config:{axis:"x",disappearing:{on:"touch"}}},children:f.jsx(_o,{iconClassName:me("texture-barrier_x")})}),f.jsx($,{itemTool:{type:"barrier",config:{axis:"y",disappearing:{on:"touch"}}},children:f.jsx(_o,{iconClassName:me("texture-barrier_y")})})]})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"Monsters"}),f.jsx($,{itemTool:{type:"monster",config:{which:"dalek",movement:"patrol-randomly-diagonal",activated:"on"}},children:f.jsx("span",{className:`sprite texture-dalek_1 [button:hover_&]:texture-animated-dalek" ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"cyberman",activated:"on",movement:"towards-on-shortest-axis-xy4",startDirection:"towards"}},children:f.jsx(wt,{topClasses:"texture-cyberman_towards [button:hover_&]:texture-cyberman_right",bottomClasses:"texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"})}),f.jsx($,{itemTool:{type:"monster",config:{which:"skiHead",style:"greenAndPink",activated:"on",movement:"back-forth",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-skiHead_greenAndPink_towards [button:hover_&]:texture-skiHead_greenAndPink_right ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"helicopterBug",activated:"on",movement:"patrol-randomly-xy8"}},children:f.jsx("span",{className:`sprite texture-helicopterBug_1 [button:hover_&]:texture-animated-helicopterBug ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"turtle",activated:"on",movement:"clockwise",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-turtle_towards_1 [button:hover_&]:texture-animated-turtle_right ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"homingBot",activated:"on",movement:"towards-tripped-on-axis-xy4"}},children:f.jsx("span",{className:`sprite texture-headlessBase [button:hover_&]:texture-headlessBase_all ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"computerBot",activated:"on",movement:"patrol-randomly-xy4-and-reverse"}},children:f.jsx(wt,{topClasses:"texture-computerBot_towards [button:hover_&]:texture-computerBot_right"})}),f.jsx($,{itemTool:{type:"monster",config:{which:"bubbleRobot",activated:"on",movement:"patrol-randomly-xy8"}},children:f.jsx(wt,{topClasses:me("texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"),bottomClasses:me("texture-headlessBase")})}),f.jsx($,{itemTool:{type:"monster",config:{which:"monkey",activated:"on",movement:"patrol-randomly-xy4"}},children:f.jsx(wt,{topClasses:"texture-monkey_towards [button:hover_&]:texture-monkey_right"})}),f.jsx($,{itemTool:{type:"monster",config:{which:"elephant",activated:"on",movement:"patrol-randomly-xy4"}},children:f.jsx(wt,{topClasses:"texture-elephant_towards [button:hover_&]:texture-elephant_right"})}),f.jsx($,{itemTool:{type:"monster",config:{which:"elephantHead",activated:"on",movement:"turn-to-player",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-elephant_towards [button:hover_&]:texture-elephant_right ${F}`})}),f.jsx($,{itemTool:{type:"monster",config:{which:"emperorsGuardian",activated:"while-player-near",movement:"towards-analogue-unless-planet-crowns"}},className:"inline relative",children:f.jsx(wt,{topClasses:"texture-ball",bottomClasses:"texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold"})}),f.jsx($,{itemTool:{type:"monster",config:{which:"emperor",activated:"while-player-near",movement:"towards-analogue"}},children:f.jsx("span",{className:`sprite texture-bubbles_cold_2 [button:hover_&]:texture-animated-bubbles_cold ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"Pickups"}),f.jsxs(Sn,{children:[f.jsx($,{itemTool:{type:"pickup",config:{gives:"extra-life"}},children:f.jsx(It,{iconClasses:"texture-whiteRabbit",text:"2"})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"shield"}},children:f.jsx(It,{iconClasses:"texture-whiteRabbit",text:"🛡"})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"jumps"}},children:f.jsx(It,{iconClasses:"texture-whiteRabbit",text:"♨"})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"fast"}},children:f.jsx(It,{iconClasses:"texture-whiteRabbit",text:"⚡"})})]}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"bag"}},children:f.jsx("span",{className:`sprite texture-bag ${F}`})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"hooter"}},children:f.jsx("span",{className:`sprite texture-hooter ${F}`})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"doughnuts"}},children:f.jsx("span",{className:`sprite texture-doughnuts ${F}`})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"reincarnation"}},children:f.jsx("span",{className:`sprite texture-fish_1 [button:hover_&]:texture-animated-fish ${F}`})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"crown",planet:"blacktooth"}},children:f.jsx("span",{className:`sprite texture-crown_blacktooth ${F}`})}),f.jsx($,{itemTool:{type:"pickup",config:{gives:"scroll",page:"blacktooth"}},children:f.jsx("span",{className:`sprite texture-scroll ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"deadly"}),f.jsxs(Sn,{children:[f.jsx($,{itemTool:{type:"deadlyBlock",config:{style:"volcano"}},children:f.jsx("span",{className:`sprite texture-volcano_1 [button:hover_&]:texture-animated-volcano ${F}`})}),f.jsx($,{itemTool:{type:"deadlyBlock",config:{style:"toaster"}},children:f.jsx("span",{className:`sprite texture-toaster_off ${F}`})})]}),f.jsx($,{itemTool:{type:"slidingDeadly",config:{style:"spikyBall",startingPhase:1}},children:f.jsx("span",{className:`sprite texture-spikyBall_1 [button:hover_&]:texture-spikyBall_2 ${F}`})}),f.jsx($,{itemTool:{type:"spikes",config:ce},children:f.jsx("span",{className:`sprite texture-spikes ${F}`})}),f.jsx($,{itemTool:{type:"moveableDeadly",config:{style:"deadFish"}},children:f.jsx("span",{className:`sprite texture-fish_1 ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"control"}),f.jsx($,{itemTool:{type:"charles",config:ce},children:f.jsx(wt,{topClasses:"texture-charles_towards [button:hover_&]:texture-charles_right"})}),f.jsx($,{itemTool:{type:"joystick",config:{controls:["charles"]}},children:f.jsx("span",{className:`sprite texture-joystick ${F}`})}),f.jsx($,{itemTool:{type:"switch",config:{initialSetting:"left",type:"in-room",modifies:Ju}},children:f.jsx("span",{className:`sprite texture-switch_left [button:hover_&]:texture-switch_right ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"movable"}),f.jsx($,{itemTool:{type:"spring",config:{}},children:f.jsx("span",{className:`sprite texture-spring_released [button:hover_&]:texture-spring_compressed ${F}`})}),f.jsxs(Sn,{children:[f.jsx($,{itemTool:{type:"portableBlock",config:{style:"cube"}},children:f.jsx("span",{className:`sprite texture-cube ${F}`})}),f.jsx($,{itemTool:{type:"portableBlock",config:{style:"drum"}},children:f.jsx("span",{className:`sprite texture-drum ${F}`})}),f.jsx($,{itemTool:{type:"portableBlock",config:{style:"sticks"}},children:f.jsx("span",{className:`sprite texture-sticks ${F}`})})]}),f.jsx($,{itemTool:{type:"pushableBlock",config:{}},children:f.jsx("span",{className:`sprite texture-stepStool ${F}`})}),f.jsx($,{itemTool:{type:"ball",config:ce},children:f.jsx("span",{className:`sprite texture-ball ${F}`})}),f.jsx($,{itemTool:{type:"slidingBlock",config:{style:"puck"}},children:f.jsx("span",{className:`sprite texture-puck ${F}`})}),f.jsx($,{itemTool:{type:"slidingBlock",config:{style:"book"}},children:f.jsx("span",{className:`sprite texture-book_y ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"misc."}),f.jsxs($,{itemTool:{type:"lift",config:{top:11,bottom:0}},className:"inline relative",children:[f.jsx("span",{className:`sprite inline-block absolute top-0 left-0 texture-lift_static ${F} [button:active_&]:top-oneScaledPix`}),f.jsx("span",{className:`sprite inline-block absolute top-0 left-0 texture-lift_1 [button:hover_&]:texture-animated-lift ${F} [button:active_&]:top-oneScaledPix`})]}),f.jsxs(Sn,{children:[f.jsx($,{itemTool:{type:"conveyor",config:{direction:"away"}},children:f.jsx(It,{iconClasses:"texture-conveyor_y_1 [button:hover_&]:texture-animated-conveyor_y",text:"↗"})}),f.jsx($,{itemTool:{type:"conveyor",config:{direction:"towards"}},children:f.jsx(It,{iconClasses:"texture-conveyor_y_1 [button:hover_&]:texture-animated-reversed-conveyor_y",text:"↙"})}),f.jsx($,{itemTool:{type:"conveyor",config:{direction:"left"}},children:f.jsx(It,{iconClasses:"texture-conveyor_x_1 [button:hover_&]:texture-animated-conveyor_x",text:"↖"})}),f.jsx($,{itemTool:{type:"conveyor",config:{direction:"right"}},children:f.jsx(It,{iconClasses:"texture-conveyor_x_1 [button:hover_&]:texture-animated-reversed-conveyor_x",text:"↘"})})]}),f.jsx($,{itemTool:{type:"teleporter",config:{toRoom:"to?",toPosition:ge}},children:f.jsx("span",{className:`sprite texture-teleporter ${F}`})}),f.jsx($,{itemTool:{type:"movingPlatform",config:{movement:"clockwise",activated:"on",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-sandwich ${F}`})}),f.jsx($,{itemTool:{type:"hushPuppy",config:{}},children:f.jsx("span",{className:`sprite texture-hushPuppy ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"Structure"}),f.jsx(dx,{}),f.jsx(hx,{}),f.jsx($,{itemTool:{type:"floor",config:{floorType:"standable",scenery:"blacktooth",times:{x:1,y:1}}},children:f.jsx("span",{className:`sprite texture-blacktooth_floor ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"Player"}),f.jsx($,{itemTool:{type:"player",config:{which:"head"}},children:f.jsx("span",{className:`sprite texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right ${F}`})}),f.jsx($,{itemTool:{type:"player",config:{which:"heels"}},children:f.jsx("span",{className:`sprite texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right ${F}`})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full",children:"NPC’s"}),f.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"head",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right ${F}`})}),f.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"heels",startDirection:"towards"}},children:f.jsx("span",{className:`sprite texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right ${F}`})}),f.jsx($,{itemTool:{type:"sceneryPlayer",config:{which:"headOverHeels",startDirection:"towards"}},children:f.jsx(wt,{topClasses:"texture-head_walking_towards_2 [button:hover_&]:texture-animated-head_walking_right",bottomClasses:"texture-heels_walking_towards_2 [button:hover_&]:texture-animated-heels_walking_right"})})]}),f.jsxs("div",{className:Pe,children:[f.jsx(Q,{className:"w-full pt-2",children:"debug"}),f.jsx(ex,{})]})]})},ti=({x:t=0,y:e=0})=>e-t,Z=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),D_=(t,e,r)=>{const n=Z(t),o=fr(r,n);return W(qf(e,o),t)},qf=(t,{x:e,y:r})=>{switch(Yu(t)){case"xy":return{x:-e/2-r,y:e/2-r,z:0};case"xz":return{x:-e,y:0,z:e/2-r};case"yz":return{x:0,y:e,z:-e/2-r};default:throw new Error("only axis-aligned planes are supported for unprojection")}},ye=({x:t=0,y:e=0,z:r=0})=>({x:t*H.w,y:e*H.d,z:r*H.h}),Bo=({x:t=0,y:e=0,z:r=0})=>({x:t/H.w,y:e/H.d,z:r/H.h}),wr=t=>Z(ye(t)),cn=(t,e)=>({get bottomCentre(){return this.c000},get topLeft(){return this.c101},get topRight(){return this.c011},get c000(){return Z(t)},get c001(){return Z(W(t,{z:e.z}))},get c010(){return Z(W(t,{y:e.y}))},get c011(){return Z(W(t,{y:e.y,z:e.z}))},get c100(){return Z(W(t,{x:e.x}))},get c101(){return Z(W(t,{x:e.x,z:e.z}))},get c110(){return Z(W(t,{x:e.x,y:e.y}))},get c111(){return Z(W(t,{x:e.x,y:e.y,z:e.z}))},projectCorner(r){return Z(W(t,{x:r.x*e.x,y:r.y*e.y,z:r.z*e.z}))}}),ri=1e-5,Lc=-1,Pn=(t,e,r,n,o)=>n-o>t&&r<e-o,L_=0,Vf=1,Kf=2,Xf=3,M_=(t,e,r,n)=>{const{topLeft:o,topRight:s,bottomCentre:i}=cn(t,e),{topLeft:a,topRight:l,bottomCentre:c}=cn(r,n),u=s.y-s.x/2,d=i.y-i.x/2,h=l.y-l.x/2,p=c.y-c.x/2,y=o.y+o.x/2,m=i.y+i.x/2,v=a.y+a.x/2,w=c.y+c.x/2,S=o.x,b=s.x,x=a.x,k=l.x,C=Pn(u,d,h,p,ri),_=Pn(y,m,v,w,ri),j=Pn(S,b,x,k,ri);return C&&_&&j?Vf:_&&j&&Pn(u,d,h,p,Lc)?Kf:C&&j&&Pn(y,m,v,w,Lc)?Xf:L_},B_=(t,e,r,n)=>{for(const o of hg){const s=t[o],i=s+e[o],a=r[o],l=a+n[o];if(i<=a)return 1*(o==="z"?-1:1);if(s>=l)return-1*(o==="z"?-1:1)}return Mc(r)-Mc(t)},F_=(t,e)=>{if(t.fixedZIndex!==void 0||e.fixedZIndex!==void 0)return 0;const r=t.renderAabb||t.aabb,n=e.renderAabb||e.aabb,o=t.renderAabbOffset?W(t.state.position,t.renderAabbOffset):t.state.position,s=e.renderAabbOffset?W(e.state.position,e.renderAabbOffset):e.state.position;switch(M_(o,r,s,n)){case Vf:return B_(o,r,s,n);case Kf:return Rt(o.y,s.y+n.y)&&Rt(o.z,s.z+n.z)?1:Rt(s.y,o.y+r.y)&&Rt(s.z,o.z+r.z)?-1:0;case Xf:return Rt(o.x,s.x+n.x)&&Rt(o.z,s.z+n.z)?1:Rt(s.x,o.x+r.x)&&Rt(s.z,o.z+r.z)?-1:0;default:return 0}},Mc=t=>t.x+t.y-t.z;class Fo extends Error{constructor(e,r,n){super(`CyclicDependencyError: .cyclicDependency property of this error has nodes as an array. ${e.join(" -> ")}`,n),this.cyclicDependency=e,this.hasClosedCycle=r}}const U_=t=>{const e=H_(t);let r=e.length,n=r;const o=new Array(r),s={},i=W_(e);for(;n--;)s[n]||a(e[n],n,new Set);return o;function a(l,c,u){if(u.has(l))throw new Fo([l],!1);if(s[c])return;s[c]=!0;const d=t.get(l)||new Set,h=Array.from(d);if(c=h.length){u.add(l);do{const p=h[--c];try{a(p,i.get(p),u)}catch(y){throw y instanceof Fo?y.hasClosedCycle?y:new Fo([l,...y.cyclicDependency],y.cyclicDependency.includes(l)):y}}while(c);u.delete(l)}o[--r]=l}};function H_(t){const e=new Set;for(const[r,n]of t.entries()){e.add(r);for(const o of n)e.add(o)}return Array.from(e)}function W_(t){const e=new Map;for(let r=0,n=t.length;r<n;r++)e.set(t[r],r);return e}const Bc=(t,e,r)=>{t.has(e)||t.set(e,new Set),t.get(e).add(r)},To=(t,e,r)=>{const n=t.get(e);n!==void 0&&(n?.delete(r),n.size===0&&t.delete(e))},Jf=(t,e=new Set(Go(t)),r=new Map)=>{const n=new Map;for(const[o,s]of r)if(!t[o])r.delete(o);else for(const i of s)t[i]||To(r,o,i);for(const o of e)if(o.fixedZIndex===void 0)for(const s of Go(t)){if(s.fixedZIndex!==void 0||n.get(s)?.has(o)||o===s)continue;const i=F_(o,s);if(Bc(n,o,s),i===0){To(r,o.id,s.id),To(r,s.id,o.id);continue}const a=i>0?o.id:s.id,l=i>0?s.id:o.id;Bc(r,a,l),To(r,l,a)}return r},tl=(t,e,r=3)=>{try{return{order:U_(t),impossible:!1}}catch(n){if(n instanceof Fo){const o=n.cyclicDependency;return t.get(o[0])?.delete(o[1]),console.warn("cyclc dependency detected: ",o.join(" --front-of--> "),`breaking link ${o[0]} --front-of--> ${o[1]}`),{order:tl(t,e,r-1).order,impossible:!0}}else throw n}};class G_{constructor(e,r){this.renderContext=e,this.appearance=r,this.output=new te({label:"AppearanceRenderer"})}#e;output;destroy(){this.output.destroy({children:!0})}tick(e){const r=this.appearance({renderContext:this.renderContext,currentRendering:this.#e,tickContext:e});r!=="no-update"&&(this.output.children.at(0)!==r.output&&(this.#e?.output&&this.output.removeChild(this.#e.output),r.output!==void 0&&this.output.addChild(r.output)),this.#e=r)}}class Yf extends G_{}const Fc=(t,e)=>{e.poly([Z({}),Z({x:t.x}),Z({x:t.x,y:t.y}),Z({y:t.y})]).poly([Z({}),Z({z:t.z}),Z({y:t.y,z:t.z}),Z({y:t.y})]).poly([Z({x:t.x}),Z({x:t.x,z:t.z}),Z(t),Z({x:t.x,y:t.y})]).poly([Z({z:t.z}),Z({x:t.x,z:t.z}),Z({x:t.x,y:t.y,z:t.z}),Z({y:t.y,z:t.z})])},Uc=(t,e)=>{const r=new ct;return Fc(t,r),r.stroke({width:.5,color:e,alpha:1}),r.eventMode="static",r.on("pointerenter",()=>{r.fill({color:e,alpha:.5})}),r.on("pointerleave",()=>{r.clear(),Fc(t,r),r.stroke({width:.5,color:e,alpha:1})}),r},q_={head:"rgba(255,184,0)",wall:"rgba(128,200,0)",portal:"rgba(255,0,255)",pickup:"rgba(0,196,255)",emitter:"rgba(0,255,255)",stopAutowalk:"rgba(255,128,128)",floatingText:"rgba(128,0,255)"};class V_{constructor(e){this.renderContext=e;const{item:r}=e,n=q_[r.type]??"rgba(255,255,255)";if(this.#e=new te({label:`ItemBoundingBoxRenderer ${r.id}`}),Qn("portal")(r)){const s=Z(r.config.relativePoint);this.#e.addChild(new ct().circle(s.x,s.y,5).stroke(n)),this.#e.addChild(new ct().circle(s.x,s.y,2).fill(n))}if(this.#e.addChild(new ct({label:"objectOrigin"}).circle(0,0,2).fill(n)),this.#e.addChild(Uc(r.aabb,n)),r.renderAabb){const s="rgba(184, 184, 255)",i=Uc(r.renderAabb,s);if(r.renderAabbOffset){const a=Z(r.renderAabbOffset);i.position.set(a.x,a.y),i.circle(0,0,2).fill(s)}this.#e.addChild(i)}this.#e.eventMode="static";let o;this.#e.on("pointerenter",()=>{if(o!==void 0)return;const s=`${r.id} ${r.type}
@(${r.state.position.x}, ${r.state.position.y}, ${r.state.position.z})}
#(${r.aabb.x}, ${r.aabb.y}, ${r.aabb.z})}`;this.#e.addChild(o=new Fm({text:s,style:{fill:n,fontSize:6,fontFamily:"Menlo"}})),o.resolution=4}),this.#e.on("pointerleave",()=>{o!==void 0&&(this.#e.removeChild(o),o=void 0)}),e.frontLayer.attach(this.#e)}#e;tick(){}destroy(){this.#e.destroy({children:!0})}get output(){return this.#e}}class K_{constructor(e,r){this.renderContext=e,this.wrappedRenderer=r,this.#e=new te({label:`ItemPositionRenderer ${e.item.id}`,children:[r.output]}),this.#t()}#e;#t(){const e=Z(this.renderContext.item.state.position);this.#e.x=e.x,this.#e.y=e.y}tick(e){this.wrappedRenderer?.tick(e),e.movedItems.has(this.renderContext.item)&&this.#t()}destroy(){this.#e.destroy({children:!0}),this.wrappedRenderer?.destroy()}get output(){return this.#e}}const ys=({aabb:t,state:{position:e}},{aabb:r,state:{position:n}})=>!(e.x+t.x<=n.x||e.x>=n.x+r.x)&&!(e.y+t.y<=n.y||e.y>=n.y+r.y)&&!(e.z+t.z<=n.z||e.z>=n.z+r.z),X_=(t,e)=>[...Tt(e).filter(r=>t.id!==r.id&&ys(t,r))];function*Zf(t,e){for(const r of e)t.id!==r.id&&ys(t,r)&&(yield r)}const Hc=fg/1e3,Qf={firedDoughnut:2*Hc,floatingText:Hc},so=11,Wc=6e4,J_=9999,Y_=8,Z_=750,Q_=2500,Gc=200,eS=.15,ep=50,qc={x:.5,y:1},Vc=t=>typeof t!="string"&&Object.hasOwn(t,"animationId"),ia=t=>{if(typeof t=="string")return ia({textureId:t});{const{anchor:e,flipX:r,pivot:n,x:o,y:s,filter:i,times:a,label:l}=t;let c;if(Vc(t)?c=tS(t):c=new un(Ht().textures[t.textureId]),t.hasOwnProperty("times")){const u={x:1,y:1,z:1,...a},d=new te({label:l??"timesXyz"});for(let{x:h}=u;h>=1;h--)for(let{y:p}=u;p>=1;p--)for(let y=1;y<=u.z;y++){const m={...t,textureId:t.textureId??t.textureIdCallback?.(h-1,p-1,y-1),label:`(${h},${p},${y})`};delete m.times;const v=ia(m),w=wr({x:h-1,y:p-1,z:y-1});v.x+=w.x,v.y+=+w.y,d.addChild(v)}return d}if(e===void 0&&n===void 0)if(Vc(t))c.anchor=qc;else{const u=Ht().data.frames[t.textureId];if(u===void 0)throw new Error(`no spritesheet entry for textureId "${t.textureId}"`);const d=u.frame;d.pivot!==void 0?c.pivot=d.pivot:c.anchor=qc}else e!==void 0&&(c.anchor=e),n!==void 0&&(c.pivot=n);return o!==void 0&&(c.x=o),s!==void 0&&(c.y=s),i!==void 0&&(c.filters=i),l!==void 0&&(c.label=l),c.eventMode="static",r===!0&&(c.scale.x=-1),c}},U=ia;function tS({animationId:t,reverse:e,playOnce:r,paused:n,randomiseStartFrame:o}){const s=Ht().animations[t],a=(n?[s[0]]:s).map(c=>({texture:c,time:pg}));e&&a.reverse();const l=new Hn(a);return l.animationSpeed=xr.animations[t].animationSpeed,l.gotoAndPlay(o?Math.floor(Math.random()*a.length):0),r!==void 0&&(l.loop=!1,l.onComplete=()=>{l.stop(),r==="and-destroy"&&(l.visible=!1)}),l}const tp=(t,e)=>{const r=e.getLocalBounds(),n=Ca.create({width:r.maxX-r.minX,height:r.maxY-r.minY});return e.x-=r.minX,e.y-=r.minY,t.render({container:e,target:n}),new un({texture:n,label:"shadowMaskSprite (of renderTexture)",pivot:{x:-r.minX,y:-r.minY}})},vs=(t,e,r)=>{const n=r&&{x:r.x??1,y:r.y??1},o=U({...typeof e=="string"?{textureId:e}:e,times:n});return o instanceof un?o:tp(t,o)},$t=t=>Re(({renderContext:{item:e}})=>ud(e)?U({...typeof t=="string"?{textureId:t}:t,times:xa(e)}):U(t)),Ge=t=>Re(({renderContext:{item:e,general:{pixiRenderer:r}}})=>{if(ud(e))return vs(r,t,xa(e));{const n=U(t);return n instanceof un?n:tp(r,n)}}),Re=t=>({renderContext:e,currentRendering:r,tickContext:n})=>r===void 0?{output:t({renderContext:e,currentRendering:void 0,tickContext:n}),renderProps:ce}:"no-update",zt=t=>({renderContext:{general:{pixiRenderer:e},item:r},currentRendering:n})=>{if(n===void 0){const o=xa(r),s={output:vs(e,t(r.config),o),renderProps:ce};return o&&(s.output.y-=((o.z??1)-1)*H.h),s}else return"no-update"},Te={x:12,y:12,z:H.h},rS={x:14,y:14,z:H.h},lr={x:16,y:16,z:H.h},ni={...Te,z:H.h*2},rp=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:Te};case"slidingBlock":return t.config.style==="book"?{aabb:lr}:{aabb:Te};case"lift":return{aabb:{...Te,z:Te.z}};case"switch":return{aabb:{...Te,z:Te.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:Te};case"charles":return{aabb:ni};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:lr};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:lr};case"tower":return{aabb:{x:11,y:11,z:H.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...Te,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:ni};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:Te};case"turtle":return{aabb:Te};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:lr};case"bubbles":return{aabb:Te};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:lr};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:H.h}:{x:15,y:3,z:H.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:ni}:{aabb:Te};case"emitter":return{aabb:ge};default:return{aabb:rS}}},Qe={aabb:Te},nS=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,aa=t=>{const e=ye(t.position),{aabb:r}=rp(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:W(e,{x:H.w-r.x>>1,y:H.d-r.y>>1})},$e=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:ke,stoodOnUntilRoomTime:ke}),Kc=()=>({standingOnItemId:null,vels:{gravity:ge,movingFloor:ge},latentMovement:[],actedOnAt:{roomTime:ke,by:ce},collidedWith:{roomTime:ke,by:ce}}),oS=t=>{const e=Jg.includes(t.type);return{...$e(),position:aa(t),...e?{standingOnItemId:null,vels:{gravity:ge,movingFloor:ge,...Yg.includes(t.type)?{sliding:ge}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:ge}:{}},latentMovement:[],actedOnAt:{roomTime:ke,by:ce},collidedWith:{roomTime:ke,by:ce}}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:Ve[t.config.startDirection]}:{facing:Ve.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:Ve[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:ge}}:{},...t.type==="charles"?{facing:Ve.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:ke,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?os(Ve[t.config.direction],Qf.firedDoughnut):ge}}:{}}},oi=H.h*2,np=4,Rn=H.h*np,sS=2,iS=2*H.w;function*aS(t,e){const{config:{direction:r},position:n}=t,o=Zn(r),s=hn(o),i=nS(t),a={...ge,[s]:i?-.5:0},l=1,c={[s]:i?-1:0},u=l*H.w,d={...ge,[s]:u},h=9,p=8,y=8;{const m={[o]:p,[s]:y,z:Rn};yield{...t,...Qe,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"far"},state:{...$e(),position:ye(W(n,{[o]:1.5},a,c)),stoodOnBy:ce},aabb:W(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}{const m={[o]:h,[s]:y,z:Rn};yield{...t,...Qe,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"near"},state:{...$e(),position:ye(W(n,a,c)),stoodOnBy:ce},aabb:W(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}{const m={[o]:2*H.w-h-p,[s]:y,z:Rn-oi};yield{...t,...Qe,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:i,part:"top"},state:{...$e(),position:W(ye(W(n,a,c)),{[o]:h,z:oi}),stoodOnBy:ce},aabb:W(m,d),renderAabb:m,renderAabbOffset:i?d:void 0}}yield{...t,...Qe,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...$e(),position:W(ye(W(n,a,c)),{z:Rn}),stoodOnBy:ce},aabb:W(ye({[o]:2,[s]:l,z:so-np-n.z}),{[s]:y}),renderAabb:ge,fixedZIndex:ur},yield{...t,...Qe,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Zg(t.config,"toRoom","toDoor"),inHidden:i,relativePoint:ye({...ge,[s]:i?.25:-.25}),direction:Ve[r]},fixedZIndex:ur,state:{...$e(),position:W(ye(W(n,{[s]:i?-.5:.5})),{[o]:h}),stoodOnBy:ce},aabb:{[o]:sS*H.w-h-p,[s]:0,z:oi}},n.z!==0&&(yield{...t,...Qe,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:i,style:"none",side:"away",height:n.z},renders:!0,shadowCastTexture:i?{textureId:"shadow.door.floatingThreshold.double.y",flipX:o==="x"}:void 0,state:{...$e(),position:{...ye(W(n,a,c)),z:0}},aabb:W(ye({[o]:2,[s]:.5,z:n.z}),d),renderAabb:i?W(ye({[o]:2,[s]:.5,z:.5})):void 0,renderAabbOffset:i?W({[o]:0,[s]:0,z:(n.z-.5)*H.h},{[s]:d[s]}):void 0,shadowOffset:{z:n.z*H.h,[s]:i?d[s]:void 0}}),yield{type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:ye({[o]:2,[s]:0,z:2}),config:{},fixedZIndex:ur,state:{...$e(),position:ye(Zu(n,os(Ve[r],.75))),stoodOnBy:ce}}}const Xc={config:ce,shadowCastTexture:"shadow.smallRound",aabb:Te},Jc=()=>{const t=mg(L.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:Ve.towards,walkStartFacing:Ve.towards,walkDistance:0,vels:{walking:ge,gravity:ge,movingFloor:ge},switchedToAt:ke,lastDiedAt:ke,gameTime:0,jumpStartTime:ke,lives:t?"infinite":Y_,jumpStartZ:0}},lS=(t,e)=>{const r=gg(L.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...Qe,...Xc,state:{...$e(),...Kc(),...Jc(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:ke,shieldCollectedAt:ke,doughnuts:r?"infinite":0,position:aa(t),stoodOnUntilRoomTime:ke}}:{id:e,jsonItemId:e,type:"heels",...Qe,...Xc,state:{...$e(),...Kc(),...Jc(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:ke,position:aa(t),stoodOnUntilRoomTime:ke}}},op=1,cS=(t=so)=>({x:H.w,y:H.d*op,z:t*H.h}),uS={x:H.w,y:0,z:ep},dS=(t=so)=>({x:H.w*op,y:H.d,z:t*H.h}),hS={x:0,y:H.d,z:ep},fS=(t,e,r)=>{const{config:{direction:n},position:o}=e,s=_a(e.config),{size:{z:i}}=r,a=Zn(n),l=hn(a),c=Qg(n),u={...ge,[l]:c?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Fn(a==="y"?dS(i):cS(i),s),renderAabb:c?ge:Fn(a==="y"?hS:uS,s),fixedZIndex:c?ur:void 0,state:{...$e(),position:ye(W(o,u)),stoodOnBy:ce},shadowCastTexture:a==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0}}},pS=3,Yc=10,Zc=.52,Qc=.5,gS=(t,e,r)=>{const{config:{times:n},position:o}=e,s=W(o,{z:-3}),i={...n,z:pS};let a=s,l=i;const c=Tt(Go(r.items)).filter(h=>h.type==="door");if(o.z===0){const h={};for(const p of c){const{position:y,config:{direction:m}}=p;switch(m){case"towards":!h.towards&&y.y===s.y&&(l=W(l,{y:Qc}),a=W(a,{y:-.5}),h.towards=!0);break;case"away":!h.away&&y.y===s.y+n.y&&(l=W(l,{y:Zc}),h.away=!0);break;case"right":!h.right&&y.x===s.x&&(l=W(l,{x:Qc}),a=W(a,{x:-.5}),h.right=!0);break;case"left":!h.left&&y.x===s.x+n.x&&(l=W(l,{x:Zc}),h.left=!0);break}}}const u=ye(a),d=Fn(lr,l);return{type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Fn(lr,i),position:ye(s)}},aabb:d,renderAabb:{...d,z:Yc},renderAabbOffset:{...ge,z:d.z-Yc},shadowCastTexture:"shadow.fullBlock",state:{...$e(),position:u}}};function*rl(t,e,r,n=ce,o={}){if(!n[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&o[e.config.page]))switch(e.type){case"door":return yield*aS(e,t);case"player":{yield lS(e,t);return}case"wall":{yield fS(t,e,r);return}case"floor":{yield gS(t,e,r);return}case"sceneryCrown":if(!L.getState().gameMenus.planetsLiberated[e.config.planet])return;default:{const s=rp(e),i=e.config.times!==void 0?{aabb:Fn(s.aabb,e.config.times),renderAabb:void 0}:s;let a;try{a=oS(e)}catch(l){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:l})}yield{...e,...Qe,...i,id:t,jsonItemId:t,fixedZIndex:e.type==="emitter"?ur:void 0,shadowCastTexture:mS(e),config:e.config,state:a}}}}const mS=t=>{switch(t.type){case"lift":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Wt(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};function*yS(t){const e=t.size.z??so,r=ye({...t.size,z:1}),n=ye({...dr,z:-1});if(t.roomBelow!==void 0&&(yield{...Qe,type:"portal",id:"floor/portal",fixedZIndex:ur,config:{toRoom:t.roomBelow,relativePoint:{x:r.x/2,y:r.y/2,z:r.z},direction:Ve.down},aabb:r,state:{...$e(),position:n},renders:!1}),t.roomAbove!==void 0){const o=W(n,{z:H.h*e});yield{...Qe,type:"portal",id:"ceiling",fixedZIndex:ur,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?ye(t.ceilingRelativePoint):{x:r.x/2,y:r.y/2},z:-12},direction:Ve.up},aabb:r,state:{...$e(),position:o}}}}const vS=(t,e,r,n)=>{const o=Math.max(0,Math.min(t.x+e.x,r.x+n.x)-Math.max(t.x,r.x)),s=Math.max(0,Math.min(t.y+e.y,r.y+n.y)-Math.max(t.y,r.y));return o*s},eu=({state:{position:t},aabb:e},{state:{position:r},aabb:n})=>vS(t,e,r,n),tu={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},wS=(t,e)=>tu[t.type]-tu[e.type],bS=(t,e,r=.001)=>{if(!Un(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:n}}}}=t;return n>0?!1:ys({state:{position:W(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+Qu},id:t.id},{state:{position:W(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},xS=(t,e)=>{const n=[...Tt(e).filter(s=>bS(t,s))];return n.length===0?void 0:n.reduce((s,i)=>{const a=wS(i,s);return a<0||a===0&&eu(t,i)>eu(t,s)?i:s})},_S=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0};function*SS(t,e,r,n){const o=vg(t.items);for(const[s,i]of o)i.type==="player"&&!n||(yield*rl(s,i,t,e,r))}const ru=t=>Tt(t).reduce((e,r)=>({...e,[r.id]:r}),{}),si=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:n=!1})=>{const o={...ru(yS(t)),...ru(SS(t,e,r,n))};for(const i of Be(o)){const l=X_(i,yg(o)).find(c=>Un(i)&&Un(c)&&!(i.type==="wall"&&c.type==="wall"));l!==void 0&&console.error(`in room ${t.id} item ${i.id} @${JSON.stringify(i.state.position)} #${JSON.stringify(i.aabb)} is colliding with (solid item) ${l.id} @${JSON.stringify(l.state.position)} #${JSON.stringify(l.aabb)} on loading room ${t.id}`)}for(const i of Be(o).filter(em)){const a=xS(i,Be(o).filter(l=>l.id!==i.id));a!==void 0&&_S({above:i,below:a})}return{...t,roomJson:t,items:o,roomTime:0}},io=(t,e)=>Tt(ss(t)).map(r=>{const n=e.items[r];if(n===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return n});Qn("head");const kS=Qn("heels"),CS=Qn("headOverHeels"),PS=t=>{if(kS(t))return t.state;if(CS(t))return t.state.heels},ES=1e3/25,sp=t=>{const e=xr.animations[t],r=e.length,{animationSpeed:n}=e;return r*ES/n};sp("bubbles.white");sp("head.fadeOut");const nl=({config:{activatedOnStoreValue:t}})=>t===void 0?!0:ma(L.getState(),t),TS=({renderContext:{general:{pixiRenderer:t},item:e,room:r},currentRendering:n})=>{const{state:{stoodOnBy:o},config:{times:s}}=e,i=n?.renderProps,a=nl(e),l=a&&io(o,r).find(Sa)!==void 0;return i===void 0||a!==i.activated||l!==i.flashing?{output:vs(t,{textureId:l?"shadowMask.teleporter.flashing":a?"shadowMask.teleporter":"shadowMask.fullBlock"},s),renderProps:{flashing:l,activated:a}}:"no-update"},ii=(t,e=1)=>({renderContext:{item:{state:{facing:r}}},currentRendering:n})=>{const o=n?.renderProps,s=ya(r)??"towards";if(!(o===void 0||s!==o.facingXy4))return"no-update";const a=U(s==="left"||s==="away"?`shadowMask.${t}.away`:`shadowMask.${t}.right`);return a.y=-(H.h*(e-1)),a.scale.x=s==="away"||s==="right"?1:-1,{output:a,renderProps:{facingXy4:s}}},nu={lift:Ge("shadowMask.smallBlock"),conveyor:zt(({direction:t})=>({textureId:"shadowMask.conveyor",flipX:Wt(t)==="x"})),doorLegs:zt(({direction:t})=>({textureId:t==="right"||t==="towards"?"shadowMask.door.floatingThreshold.double.y":"shadowMask.door.legs.threshold.double.y",flipX:Wt(t)==="y"})),teleporter:TS,floor:"no-mask",barrier:zt(({axis:t})=>({textureId:"shadowMask.barrier.y",flipX:t==="x"})),spring:Ge("shadowMask.smallRound"),block:zt(({style:t})=>t==="tower"?"shadowMask.tower":"shadowMask.fullBlock"),pushableBlock:Ge("shadowMask.stepStool"),movingPlatform:Ge("shadowMask.fullBlock"),hushPuppy:Ge("shadowMask.hushPuppy"),portableBlock:zt(({style:t})=>t==="drum"?"shadowMask.smallRound":"shadowMask.smallBlock"),slidingBlock:zt(({style:t})=>t==="book"?"shadowMask.fullBlock":"shadowMask.smallRound"),deadlyBlock:zt(({style:t})=>t==="volcano"?"shadowMask.volcano":"shadowMask.toaster"),spikes:Ge("shadowMask.spikes"),switch:Ge("shadowMask.switch"),pickup:zt(({gives:t})=>{switch(t){case"scroll":return"shadowMask.scroll";case"doughnuts":return"shadowMask.doughnuts";case"fast":case"extra-life":case"jumps":case"shield":return"shadowMask.whiteRabbit";default:return"blank"}}),slidingDeadly:Ge("shadowMask.smallRound"),ball:Ge("shadowMask.ball"),"monster.dalek":Ge("shadowMask.dalek"),"monster.turtle":ii("turtle"),"monster.skiHead":ii("skiHead"),"monster.homingBot":Ge("shadowMask.smallRound"),joystick:Ge("shadowMask.joystick"),charles:ii("charles",2)},RS=t=>{switch(t.type){case"monster":return nu[`monster.${t.config.which}`];case"floor":return t.config.floorType==="none"?void 0:"no-mask";default:return nu[t.type]}},AS=new Nm({alpha:1-zn});class OS{constructor(e,r){if(this.renderContext=e,this.#e.filters=AS,r!=="no-mask")if(this.#r=new Yf(e,r),e.item.shadowOffset===void 0)this.#e.addChild(this.#r.output);else{const n=new te({label:"shadowMaskOffset",...Z(e.item.shadowOffset),children:[this.#r.output]});this.#e.addChild(n)}this.#e.addChild(this.#t)}#e=new te({label:"ItemShadowRenderer"});#t=new te({label:"shadows"});#r;#n={};get#o(){return L.getState().gameMenus.userSettings.displaySettings.showShadowMasks}#s(e){if(this.#r===void 0)return;const r=this.#r.output.children.at(0);this.#r.tick(e);const n=this.#r.output.children.at(0);if(n===void 0||!(n instanceof un)){const{item:o}=this.renderContext;throw new Error(`ItemShadowRenderer: this.#shadowMaskRenderer didn't create a sprite for item "${o.id}" of type "${o.type}". Have got ${n}`)}r!==n&&(this.#o?this.renderContext.frontLayer.attach(n):this.#e.mask=n)}destroy(){this.#e.destroy(!0),this.#r?.destroy()}tick(e){if(this.#t.parent===null)throw new Error("shadow container not in scene graph");const{movedItems:r,progression:n}=e,{item:o,general:{pixiRenderer:s},room:i}=this.renderContext,a=r.has(o),l=o.state.position.z+o.aabb.z,c=Be(i.items).filter(function(y){return y.shadowCastTexture!==void 0}),u={id:o.id,state:{position:{...o.state.position,z:l}},aabb:{...o.aabb,z:J_}},d=Object.groupBy(c,p=>{const y=this.#n[p.id]!==void 0,m=r.has(p);return!a&&!m?y?"keepUnchanged":"noShadow":ys(u,p)?y?"update":"create":"noShadow"});for(const p of Cl(d.keepUnchanged,d.update))this.#n[p.id].renderedOnProgression=n;if(d.create)for(const p of d.create){const{times:y}=p.config,m=vs(s,p.shadowCastTexture,y);m.label=p.id,this.#t.addChild(m),this.#n[p.id]={sprite:m,renderedOnProgression:n}}for(const p of Cl(d.create,d.update)){const{sprite:y}=this.#n[p.id],m=Z({...jn(fr(p.state.position,o.state.position),p.shadowOffset??dr),z:o.aabb.z});y.x=m.x,y.y=m.y}for(const[p,{sprite:y,renderedOnProgression:m}]of ed(this.#n))m!==n&&(y.destroy(),delete this.#n[p]);const h=(d.keepUnchanged?.length??0)+(d.update?.length??0)+(d.create?.length??0)>0;this.#e.visible=h,h&&this.#s(e)}get output(){return this.#e}}const IS=t=>{const e=RS(t.item);return e===void 0?void 0:new OS(t,e)};class jS{constructor(e,r){this.renderContext=e,this.componentRenderers=r,this.output={graphics:r.graphics?.output,sound:r.sound?.output}}output;tick(e){this.componentRenderers.graphics?.tick(e),this.componentRenderers.sound?.tick(e)}destroy(){this.componentRenderers.graphics?.destroy(),this.componentRenderers.sound?.destroy()}}const ae=new window.AudioContext,la=()=>{throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`)},Ae=t=>{const e=typeof t=="string"?{soundId:t}:t,{playbackRate:r=1,soundId:n,connectTo:o,loop:s=!1,varyPlaybackRate:i=!1,randomiseStartPoint:a=!1}=e,l=ae.createBufferSource(),c=la()[n];return l.buffer=c,l.loop=s,l.playbackRate.value=i?r-.05+Math.random()*.1:r,s&&a?l.start(0,c.duration*Math.random()):l.start(),o!==void 0&&l.connect(o),l},Br=(t,e,r)=>{const n=ae.createGain();return e!==void 0&&(n.gain.value=e),t.connect(n),n.connect(r),n},ze=({start:t,change:e,loop:r,stop:n,startAndLoopTogether:o=!1,noStartOnFirstFrame:s=!0},i)=>{let a=!0,l,c;return u=>{if(!!u!=!!c)u?t!==void 0&&!(a&&s)?(l?.stop(),l=Ae({...t}),Br(l,t.gain,i),r!==void 0&&(o?(l=Ae({...r,loop:!0}),Br(l,r.gain,i)):l.onended=()=>{c&&(l=Ae({...r,loop:!0}),Br(l,r.gain,i))})):r!==void 0&&(l=Ae({...r,loop:!0}),Br(l,r.gain,i)):(l&&l.loop&&(l.stop(),l.onended=null),n!==void 0&&(l=Ae({...n}),Br(l,n.gain,i)));else if(c!==u&&e!==void 0){const h=Ae({...e});Br(h,e.gain,i)}a=!1,c=u}};class $S{constructor(e){this.renderContext=e,this.output.gain.value=4}output=ae.createGain();#e=ze({loop:{soundId:"rollingBallLoop",playbackRate:.5}},this.output);tick(){const{renderContext:{item:{state:{vels:{sliding:e},standingOnItemId:r}}}}=this,n=(e.x!==0||e.y!==0)&&r!==null;this.#e(n)}destroy(){}}class zS{constructor(e){this.renderContext=e;const{item:{config:{was:r}}}=e;switch(r.type){case"pickup":{r.gives!=="scroll"&&Ae({soundId:"bonus",connectTo:this.output});break}case"disappearing":{Ae({soundId:"destroy",connectTo:this.output});break}case"hushPuppy":{this.output.gain.value=.5,Ae({soundId:"hushPuppyVanish",connectTo:this.output});break}}}output=ae.createGain();tick(){}destroy(){}}class ol{constructor(e,r,n=1){this.renderContext=e,this.#e=ze({start:r},this.output),this.output.gain.value=n}output=ae.createGain();#e;tick({lastRenderRoomTime:e}){const{renderContext:{item:r}}=this,{state:{collidedWith:{roomTime:n,by:o}}}=r,s=n>(e??ke)&&!ka(ss(o));this.#e(s)}destroy(){}}class NS{constructor(e){this.renderContext=e,this.#e.connect(this.output),this.#e.gain.value=.5,this.#r=new ol(e,{soundId:"metalHit"},.3),this.#r.output.connect(this.output)}output=ae.createGain();#e=ae.createGain();#t=ze({start:{soundId:"servoStart",playbackRate:.5},loop:{soundId:"servoLoop",playbackRate:.5},stop:{soundId:"servoStop",playbackRate:.5}},this.#e);#r;tick(e){const{renderContext:{item:r,room:{roomTime:n,items:o}}}=this,{state:{actedOnAt:{roomTime:s,by:i}}}=r,a=n===s&&Tt(ss(i)).some(l=>dd(o[l]));this.#t(a),this.#r.tick(e)}destroy(){}}const ao=t=>{for(const e in t)return!0;return!1},ai=2;class DS{constructor(e){this.renderContext=e}output=ae.createGain();#e=ze({start:{soundId:"conveyorStart",playbackRate:ai},loop:{soundId:"conveyorLoop",playbackRate:ai},stop:{soundId:"conveyorEnd",playbackRate:ai}},this.output);tick(){const{renderContext:{item:{state:{stoodOnBy:e}}}}=this,r=ao(e);this.#e(r)}destroy(){this.#e(!1)}}const LS=3;class MS{constructor(e){this.renderContext=e,this.output.gain.value=.7}output=ae.createGain();#e=Ae({soundId:"helicopter",loop:!0,connectTo:this.output});tick(){const{renderContext:{item:{state:{vels:{lift:{z:e}}}}}}=this;this.#e.playbackRate.value=Math.max(.5,1+LS*e)}destroy(){}}const ou={skiHead:{soundId:"softBump"},turtle:{soundId:"softBump"},dalek:{soundId:"metalHit"},homingBot:{soundId:"metalHit"},computerBot:{soundId:"metalHit"}},su={cyberman:{soundId:"jetpackTurnaround",gain:1.2},dalek:{soundId:"mojoTurn",gain:.3}},iu={cyberman:{soundId:"jetpackLoop",gain:.7},emperorsGuardian:{soundId:"jetpackLoop"},dalek:{soundId:"mojoLoop"},bubbleRobot:{soundId:"bubbleRobotLoop"},helicopterBug:{soundId:"helicopter"}},au={homingBot:{start:{soundId:"detect"},loop:{soundId:"robotWhirLoop",gain:4},startAndLoopTogether:!0},computerBot:{loop:{soundId:"robotBeepingLoop",randomiseStartPoint:!0,varyPlaybackRate:!0}}};class BS{constructor(e){this.renderContext=e,this.#e.connect(this.output),this.#t.connect(this.output),this.#t.gain.value=.66;const{item:{config:{which:r}}}=e;ou[r]!==void 0&&(this.#o=new ol(e,ou[r]),this.#o.output.connect(this.output)),su[r]!==void 0&&(this.#r=ze({change:su[r]},this.#e)),au[r]!==void 0&&(this.#s=ze(au[r],this.#e)),iu[r]!==void 0&&(this.#n=ze({loop:iu[r]},this.#t))}output=ae.createGain();#e=ae.createGain();#t=ae.createGain();#r;#n;#o;#s;tick(e){const{renderContext:{item:r}}=this,{state:{facing:n,activated:o,busyLickingDoughnutsOffFace:s,vels:{walking:i}}}=r;if(this.#r){const a=td(n);this.#r(a)}if(this.#o&&this.#o.tick(e),this.#n){const a=o&&!s;this.#n(a)}if(this.#s){const a=!$n(i,ge);this.#s(a)}}destroy(){}}class li{constructor(e){this.renderContext=e;const{general:{soundSettings:r},item:{type:n}}=e,{noFootsteps:o}={...va.soundSettings,...r};o||(this.#e=ae.createGain(),this.#e.gain.value=2,this.#e.connect(this.output),this.#t=ze({loop:{soundId:`${n==="headOverHeels"?"heels":n}Walk`}},this.#e)),this.#r.gain.value=.8,this.#r.connect(this.output),this.#i.gain.value=1.2,this.#i.connect(this.output),this.#s.connect(this.output),this.#n=ze({start:{soundId:`${n==="headOverHeels"?"head":n}Jump`}},this.#r),this.#o=ze({loop:{soundId:`${n==="headOverHeels"?"head":n}Fall`}},this.#r)}output=ae.createGain();#e;#t;#r=ae.createGain();#n;#o;#s=ae.createGain();#l=ze({start:{soundId:"landing"},noStartOnFirstFrame:!0},this.#s);#i=ae.createGain();#c=ze({start:{soundId:"carry",playbackRate:.95},stop:{soundId:"carry",playbackRate:1.05}},this.#i);#a={teleportingPhase:null,positionZ:0};tick({lastRenderRoomTime:e}){const{renderContext:{item:r}}=this,{state:{action:n,teleporting:o,jumpStartZ:s,jumped:i,standingOnItemId:a,position:{z:l},vels:{gravity:{z:c}},collidedWith:{roomTime:u,by:d}}}=r,h=PS(r),{teleportingPhase:p,positionZ:y}=this.#a,m=o?o.phase:null,v=i&&l>s&&l>y&&c>0,w=l<y&&c<0&&a===null;this.#o(w),this.#n(v),this.#t!==void 0&&this.#t(!v&&!w&&n==="moving"),h!==void 0&&this.#c(h.carrying!==null);const S=a!==null&&u>(e??ke)&&d[a];if(this.#l(S),m!==null&&m!==p)if(m==="in"){const b=la().teleportIn,x=ae.createBufferSource();x.buffer=b,x.connect(this.output),x.start()}else{const b=la().teleportOut,x=ae.createBufferSource();x.buffer=b,x.connect(this.output),x.start()}this.#a={teleportingPhase:m,positionZ:l}}destroy(){}}class FS{constructor(e){this.renderContext=e}output=ae.createGain();#e=void 0;tick(){const{renderContext:{item:{state:{stoodOnBy:e},config:{style:r}}}}=this;if(r!=="drum")return;const n=this.#e?.stoodOn??!1,o=ao(e);!n&&o&&Ae({soundId:"drum",connectTo:this.output}),this.#e={stoodOn:o}}destroy(){}}class US{constructor(e){this.renderContext=e,this.scrapeBracketed=ze({loop:{soundId:"stepStoolScraping"}},this.output),this.output.gain.value=.4}output=ae.createGain();scrapeBracketed;tick({movedItems:e}){const{renderContext:{item:r,room:{roomTime:n}}}=this,{state:{actedOnAt:{roomTime:o},standingOnItemId:s}}=r,i=n===o&&s!==null&&e.has(r);this.scrapeBracketed(i)}destroy(){}}class HS{constructor(e){this.renderContext=e}output=ae.createGain();tick({lastRenderRoomTime:e}){const{renderContext:{item:{state:{stoodOnBy:r,stoodOnUntilRoomTime:n}}}}=this,o=ao(r);e!==void 0&&n>e&&!o&&Ae({soundId:"springBoing",connectTo:this.output})}destroy(){}}class WS{constructor(e){this.renderContext=e,this.#e.connect(this.output)}output=ae.createGain();#e=ae.createGain();#t=void 0;tick(){const{renderContext:{item:{state:{setting:e},config:r}}}=this,n=r.type==="in-store"?ma(L.getState(),r.path)?"right":"left":e,o=this.#t?.setting;o!==void 0&&o!==n&&Ae({soundId:"switchClick",playbackRate:n==="right"?.95:1.05,connectTo:this.#e}),this.#t={setting:n}}destroy(){}}class GS{constructor(e){this.renderContext=e}output=ae.createGain();#e=ze({loop:{soundId:"teleportWarningSiren"}},this.output);tick(){const{renderContext:{item:e,room:r}}=this;this.#e(nl(e)&&io(e.state.stoodOnBy,r).some(Sa))}destroy(){}}class qS{constructor(e){this.renderContext=e,Ae({soundId:"hooter",connectTo:this.output})}output=ae.createGain();tick(){}destroy(){}}class VS extends ol{constructor(e){super(e,{soundId:"glassClink",varyPlaybackRate:!0},.8),this.renderContext=e}}const KS=(t,e)=>wd(io(t.state.stoodOnBy,e).filter(hd));class XS{constructor(e){this.renderContext=e,this.output.gain.value=2}output=ae.createGain();#e=void 0;tick(e){const{renderContext:{item:r,room:n}}=this,o=KS(r,n);this.#e!==void 0&&o<this.#e&&Ae({soundId:"toasterPopUpSoundUrl",connectTo:this.output}),this.#e=o}destroy(){}}const JS={lift:MS,switch:WS,bubbles:zS,head:li,heels:li,headOverHeels:li,teleporter:GS,monster:BS,conveyor:DS,spring:HS,portableBlock:FS,charles:NS,ball:$S,pushableBlock:US,firedDoughnut:qS,slidingBlock:VS},YS=t=>{if(t.item.type==="deadlyBlock"&&t.item.config.style==="toaster")return new XS(t);const e=JS[t.item.type];if(e)return new e(t)},lu=H.h*so,cu=H.h*-1,ZS=H.w*16,QS=0,ci=(t,e,r)=>(t-e)/(r-e)*2-1;class ek{constructor(e,r){this.renderContext=e,this.childRenderer=r,r.output.connect(this.output),this.output.rolloffFactor=2,this.output.maxDistance=5,this.output.distanceModel="exponential";const{room:{size:{y:n,x:o}}}=e;this.positionMinX=ti(ye({x:0,y:n})),this.positionMaxX=ti(ye({x:o,y:0}))}output=ae.createPanner();positionMinX;positionMaxX;tick(e){this.childRenderer.tick(e);const{item:r}=this.renderContext,n=r.state,o=W(n.position,os(r.aabb,.5)),s=ci(ti(o),this.positionMaxX,this.positionMinX),i=ci(o.z,cu,lu);if(!Number.isFinite(i))throw new Error(`y position for sound rendering is not finite;
        positionY = numberInRangeToMinus1To1Range(
          itemCentrePosition = ${o.z},
          ${cu},
          ${lu},
        );
        itemCentrePosition = addXyz(
          itemState.position = ${JSON.stringify(n.position)},
          scaleXyz(${JSON.stringify(r.aabb)}, 0.5),
        )`);const a=ci(o.x+o.y,QS,ZS);this.output.positionX.value=s,this.output.positionY.value=i,this.output.positionZ.value=a}destroy(){this.childRenderer.destroy()}}const Cr=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,tk=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColour;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    // we know c.a is either 0 or 1, so no need to do a step()

    finalColor = mix(c, vec4(uColour, 1), c.a);
}
`;class ts extends Yt{constructor(e){const r=Et.from({vertex:Cr,fragment:tk,name:"oneColour-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uColour:{value:new Float32Array(3),type:"vec3<f32>"}}}});const n=this.resources.colorReplaceUniforms.uniforms,[o,s,i]=e.toArray();n.uColour[0]=o,n.uColour[1]=s,n.uColour[2]=i}}const rk={pureBlack:new V("#000000"),shadow:new V("#1B2D3B"),midGrey:new V("#505A55"),lightGrey:new V("#929981"),white:new V("#F8FEF8"),pastelBlue:new V("#4893FF"),metallicBlue:new V("#1D4E80"),pink:new V("#B973AF"),moss:new V("#6E7B00"),redShadow:new V("#513D40"),midRed:new V("#A7574B"),lightBeige:new V("#BF8E69"),highlightBeige:new V("#DBB269"),alpha:new V("#105A69"),replaceLight:new V("#048662"),replaceDark:new V("#052229")},nk=`#version 300 es
// keep this one at mediump for the hash function's precision
precision mediump float;

in vec2 vTextureCoord;
out vec4 finalColor;

const float LUT_SIZE = 256.0;
const float magicNumber = 31.0; // Small prime number

uniform sampler2D uTexture;
uniform sampler2D uLut;

/** returns in [0, LUT_SIZE] range
this must match the TypeScript version of the hash function*/
float hashColor(vec3 color) {
    vec3 c255 = floor(color * 255.0);
    
    float hash = mod(
        c255.r + c255.g * magicNumber + c255.b * magicNumber * magicNumber, 
        LUT_SIZE
    );
    return hash;
}

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    float h = hashColor(c.rgb);

    // use the hash to look up the replacement in the LUT:
    vec4 replacementColour = texture(
        uLut, 
        vec2(
            // normalise h to [0, 1] range
            (h + 0.5) / LUT_SIZE, 
            0.5
        )
    );
    
    // use original if either: 
    //      original alpha is 0 (because keep transparent)
    //      or lut alpha is 0 (signals nothing in this slot of the LUT)
    finalColor = mix(c, replacementColour, c.a * replacementColour.a);
}
`,An=256,ui=31;function ok(t){const e=Math.floor(t.red*255),r=Math.floor(t.green*255),n=Math.floor(t.blue*255);return(e+r*ui+n*ui*ui)%An}function sk(t){const e=new Float32Array(An*4);for(const[o,s]of wg(t)){const i=z[o],a=ok(i);if(e[a*4+3]>.5)throw new Error("LUT collision - mess with the hash function or lut size until this goes away");e[a*4+0]=s.red,e[a*4+1]=s.green,e[a*4+2]=s.blue,e[a*4+3]=1}const r=new Uint8Array(An*4);for(let o=0;o<An*4;o++)r[o]=Math.floor(e[o]*255);return St.from({resource:r,width:An,height:1,scaleMode:"nearest"})}class Qt extends Yt{#e;constructor(e){const r=Object.keys(e).length,n=Et.from({vertex:Cr,fragment:nk,name:"palette-swop-filter"}),o=sk(e);super({glProgram:n,resources:{colorReplaceUniforms:{uOriginal:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uReplacement:{value:new Float32Array(3*r),type:"vec3<f32>",size:r}},uLut:o.source}}),this.#e=o;const s=this.resources.colorReplaceUniforms.uniforms;Object.entries(e).forEach(([i,a],l)=>{z[i].toArray().forEach((c,u)=>{s.uOriginal[l*3+u]=c}),a.toArray().forEach((c,u)=>{s.uReplacement[l*3+u]=c})})}destroy(e){this.#e?.destroy(!0),this.#e=null,super.destroy(e)}}const ik=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uTargetColor;

vec4 black = vec4(0.0, 0.0, 0.0, 1.0);

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    // 1 if black, 0 if non-black
    float isBlack = step(length(c.rgb), 0.01);

    // keep original if either:
    //      * black
    //      * transparent

    finalColor = mix(    
        vec4(uTargetColor, 1),    
        c, 
        max(isBlack, 1.0 - c.a)
    );
}
`;class Ne extends Yt{uniforms;constructor(e="white"){const r=Et.from({vertex:Cr,fragment:ik,name:"revert-colourise-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"}}}}),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this.targetColor=e}set targetColor(e){const[r,n,o]=new V(e).toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}}const ak=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    finalColor = vec4(c.rgb * 0.5, c.a);
}
`;class lk extends Yt{constructor(){const e=Et.from({vertex:Cr,fragment:ak,name:"halfbrite-filter"});super({glProgram:e,resources:{}})}}const ip=({basic:t,dimmed:e})=>({replaceLight:t,replaceDark:e}),ap=({color:{hue:t,shade:e},planet:r})=>{const n=t==="yellow"?e==="dimmed"||r==="jail"?xf:Je:ps[t][e].main;return ip(n)},ck=t=>new Qt({lightBeige:z.lightGrey,redShadow:z.shadow,pink:z.lightGrey,moss:z.lightGrey,midRed:z.midGrey,highlightBeige:z.lightGrey,...t&&ap(t)}),uk=new Qt({midGrey:z.midRed,lightGrey:z.lightBeige,white:z.highlightBeige,metallicBlue:z.redShadow,pink:z.midRed,moss:z.midRed,replaceDark:z.midRed,replaceLight:z.lightBeige}),uu=(t,e)=>{const r=Zo(t.color).edges[e],n=r.original;return r.dimInOriginal?bf(n):n},lp=(t,e,r)=>r?new Qt(ip(ps[t.color.hue][t.color.shade].edges[e])):new Ne(Zo(t.color).edges[e].original),ft=t=>new Qt(ap(t)),dk=t=>{switch(t.color.hue){case"white":return new Qt({replaceLight:z.lightGrey,replaceDark:z.midGrey});default:return ft(t)}},cp=t=>{switch(t.color.hue){case"white":return new Qt({replaceLight:z.lightBeige,replaceDark:z.midRed,shadow:z.redShadow});case"yellow":return ft({planet:t.planet,color:{hue:"yellow",shade:"dimmed"}});default:return ft(t)}};new lk;const er=Ju,hk=new Qt(rk),fk=[new ts(z.midRed)],pk=[new ts(z.moss)],gk=75;class mk{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output)}output=new te({label:"ItemFlashOnSwitchedRenderer"});tick(e){const{renderContext:{item:{state:{switchedAtRoomTime:r,switchedSetting:n}},room:{roomTime:o}}}=this;this.output.filters=o-r<gk?n==="left"?pk:fk:er,this.childRenderer.tick(e)}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const yk=(t,e,r)=>{const o=Ht().textures[`door.frame.${t.planet}.${e}.near`]!==void 0?t.planet:"generic",s=t.color.shade==="dimmed"&&Ht().textures[`door.frame.${o}.dark.${e}.${r}`]!==void 0;return`door.frame.${o}${s?".dark":""}.${e}.${r}`};function ws(t,e){const r=e||new te;for(const n of t)r.addChild(n);return r}function*vk({config:{direction:t,inHiddenWall:e,height:r}},n){const o=Zn(t),s=o==="y"?1:16;function*i(a){if(e){if(r!==0){const l=U({textureId:`generic.door.floatingThreshold.${o}`,...jn(a,{y:-12*r})});l.filters=lp(n,o==="x"?"towards":"right",!0),yield l}}else{yield U({pivot:{x:s,y:9},textureId:`generic.door.legs.base.${o}`,...jn(a,{})});for(let l=1;l<r;l++)yield U({pivot:{x:s,y:9},textureId:`generic.door.legs.pillar.${o}`,...jn(a,{y:-l*H.h})})}}yield*i(wr({...dr,[o]:1})),yield*i(dr),e||(yield U({pivot:{x:16,y:H.h*r+13},textureId:`generic.door.legs.threshold.double.${o}`,...wr({...dr,[o]:1})}))}const up=(t,e)=>{const r=Zn(t),n=hn(r),o=8;return t==="towards"||t==="right"?Z({[n]:e[n]-o}):dr},wk=Re(({renderContext:{item:t,room:e}})=>ws(vk(t,e),new te({filters:ft(e),...up(t.config.direction,t.aabb)}))),bk=Re(({renderContext:{item:{config:{direction:t,part:e,toRoom:r},aabb:n},room:o,general:{gameState:s}}})=>{const i=Zn(t),a=s===void 0?o:s.campaign.rooms[r];return U({textureId:yk(o,i,e),filter:ft(a),...up(t,n)})}),di={animationId:"bubbles.cold"},Jr=({top:t,bottom:e="headlessBase",filter:r})=>{const n=new te({filters:r}),o=U(e);n.addChild(o);const s=U(t);return s.y=-12,n.addChild(s),n[bs]=s,n[sl]=o,n},bs=Symbol(),sl=Symbol(),xk=({top:t,bottom:e})=>{const r=new te;return r.addChild(e),t.y=-12,r.addChild(t),r[bs]=t,r[sl]=e,r},_k=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform vec2 uTextureSize;
uniform sampler2D uTexture;
uniform vec3 uOutline;
uniform float uOutlineWidth;

void main(void) {
    vec2 scaledTexelSize = vec2(1.0f) / vec2(textureSize(uTexture, 0)) * uOutlineWidth;    
    
    // Calculate offset coordinates
    vec2 rightCoord = vec2(vTextureCoord.x + scaledTexelSize.x, vTextureCoord.y);
    vec2 leftCoord = vec2(vTextureCoord.x - scaledTexelSize.x, vTextureCoord.y);
    vec2 belowCoord = vec2(vTextureCoord.x, vTextureCoord.y + scaledTexelSize.y);
    vec2 aboveCoord = vec2(vTextureCoord.x, vTextureCoord.y - scaledTexelSize.y);
    
    // Create boundary masks (1.0 if within bounds, 0.0 if out of bounds)
    // seems to work fine without this, but could multiply colourToX by this to get zero'd out when OOB
    // float rightInBounds = step(rightCoord.x, 1.0);
    // float leftInBounds = step(0.0, leftCoord.x);
    // float belowInBounds = step(belowCoord.y, 1.0);
    // float aboveInBounds = step(0.0, aboveCoord.y);
    
    vec4 colourToRight = texture(uTexture, rightCoord);
    vec4 colourToLeft = texture(uTexture, leftCoord);
    vec4 colourBelow = texture(uTexture, belowCoord);
    vec4 colourAbove = texture(uTexture, aboveCoord);
    
    // Check if any neighbor is opaque (combine all alpha values)
    float hasOpaqueNeighbor = max(max(colourToRight.a, colourToLeft.a), 
                                  max(colourBelow.a, colourAbove.a));

    vec4 originalColour = texture(uTexture, vTextureCoord);
        
    finalColor = mix(
        originalColour, 
        vec4(uOutline, 1), 
        // 1 if: original colour is transparent and has an opaque neighbour - use outline colour
        // 0 if: original colour is opaque or has no opaque neighbour - use original colour (transparent or sprite)
        (1.0 - originalColour.a) * hasOpaqueNeighbor
    );
}
`;class pt extends Yt{constructor({outlineColor:e,upscale:r,lowRes:n}){const o=Et.from({vertex:Cr,fragment:_k,name:"outline-filter"});super({glProgram:o,padding:r,resources:{colorReplaceUniforms:{uOutline:{value:new Float32Array(3),type:"vec3<f32>"},uOutlineWidth:{value:new Float32Array(1),type:"f32"}}}});const s=this.resources.colorReplaceUniforms.uniforms,[i,a,l]=e.toArray();s.uOutline[0]=i,s.uOutline[1]=a,s.uOutline[2]=l,s.uOutlineWidth[0]=r,n&&(this.resolution=1/r,this.padding=r,s.uOutlineWidth[0]=1)}}const Sk=t=>{const{gameTime:e,lastDiedAt:r}=t.type==="headOverHeels"?t.state.head:t.state;return e-r<Q_},hi=t=>{if(t===void 0)return 0;const{shieldCollectedAt:e,gameTime:r}=t;return e!==null&&e+Wc>r?100-Math.ceil((r-e)/(Wc/100)):0},kk=t=>t.type==="headOverHeels"?hi(t.state.head)>0||hi(t.state.heels)>0:hi(t.state)>0,xs=t=>t,ca=.02,Ck=({name:t,action:e,facingXy8:r,teleportingPhase:n,gravityZ:o,paused:s})=>{if(e==="death")return{animationId:`${t}.fadeOut`,paused:s};if(n==="out")return{animationId:`${t}.fadeOut`,paused:s};if(n==="in")return{animationId:`${t}.fadeOut`,paused:s};if(e==="moving")return{animationId:`${t}.walking.${r}`,paused:s};if(e==="jumping")return{textureId:o<ca?`${t}.walking.${r}.2`:`${t}.walking.${r}.1`};if(e==="falling"){const a=`${t}.falling.${r}`;if(qo(a))return{textureId:a}}const i=`${t}.idle.${r}`;return Fd(i)?{animationId:i,paused:s}:{textureId:`${t}.walking.${r}.2`}},ua=Symbol(),da=Symbol(),Pk=(t,e)=>{t[ua].removeChildren(),t[ua].addChild(U(Ck(e)))},dp=new Qt({pastelBlue:z.pink}),fi=(t,e,r)=>{const n=new te,o=new te;n[ua]=o,n.addChild(o);const s=U({animationId:e?`shine.${t}InSymbio`:"shine",paused:r,filter:t==="heels"?dp:er,flipX:t==="heels"});return n[da]=s,n},du=({gameTime:t,switchedToAt:e},r,n)=>(r==="headOverHeels"||r===n)&&e+Z_>t,Ek=t=>{if(!Sk(t))return!1;const{gameTime:e,lastDiedAt:r}=t.type==="headOverHeels"?t.state.head:t.state;return(e-r)%Gc<Gc*eS},hu=(t,e)=>{t.filters?Array.isArray(t.filters)?t.filters=[...t.filters,e]:t.filters=[t.filters,e].flat():t.filters=e},fu=(t,e)=>{t.filters=Array.isArray(t.filters)?t.filters.filter(r=>!(r instanceof e)):t.filters instanceof e?er:[...t.filters]},Tk=(t,{highlighted:e,flashing:r},n,o)=>{const s=n?.highlighted??!1;e&&!s?hu(o,new pt({outlineColor:Xr[t],upscale:Jt(L.getState()),lowRes:!1})):!e&&s&&fu(o,pt);const i=n?.flashing??!1;r&&!i?hu(o,new ts(Xr[t])):!r&&i&&fu(o,ts)},Rk=(t,e,r)=>{e&&!r?t.addChild(t[da]):!e&&r&&t.removeChild(t[da])},pi=(t,e,r,n,o,s)=>{r&&Pk(e,{name:t,...n,paused:o}),Tk(t,n,s,e),Rk(e,n.shining,s?.shining??!1)},Ak=({renderContext:{item:t,general:{gameState:e,paused:r}},currentRendering:n})=>{const{type:o,state:{action:s,facing:i,teleporting:a,vels:{gravity:{z:l}}}}=t,c=n?.renderProps,u=n?.output,d=td(i)??"towards",h=e!==void 0&&(t.type==="headOverHeels"?du(t.state.head,"headOverHeels","headOverHeels"):du(t.state,t.type,e.currentCharacterName)),p=Ek(t),y=kk(t),m=rd(i),v=a?.phase??null,w={action:s,facingXy8:d,teleportingPhase:v,flashing:p,highlighted:h,shining:y,gravityZ:l},S=c===void 0||c.action!==s||c.facingXy8!==d||c.teleportingPhase!==v||c?.gravityZ>ca!=l>ca;let b;if(o==="headOverHeels"){b=u??xk({top:fi("head",!0,r),bottom:fi("heels",!0,r)});const x=b;pi("head",x[bs],S,w,r,c),pi("heels",x[sl],S,w,r,c)}else b=u??fi(o,!1,r),pi(o,b,S,w,r,c);return s==="moving"&&u instanceof Hn&&(u.animationSpeed=m*bg),{output:b,renderProps:w}},gi=xs(Ak),pu=t=>t-Math.floor(t),Ok=({state:{position:t}},e)=>{const r=o=>o.config.direction==="away"||o.config.direction==="left";return ws(Be(e.items).filter(o=>o.type==="wall"||o.type==="doorLegs").filter(r).map(o=>{const{id:s,config:{direction:i},state:{position:a}}=o;return U({textureId:"floorOverdraw.cornerNearWall",label:s,...Z(Zu(a,t)),times:o.type==="wall"?_a(o.config):{[hn(Wt(i))]:2},anchor:{x:0,y:1},flipX:i==="away"})}),new te({label:"floorOverdraws"}))},Ik=`#version 300 es
precision lowp float;

in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColour;

void main(void) {
    finalColor = texture(uTexture, vTextureCoord);
}
`;class jk extends Yt{constructor(){const e=Et.from({vertex:Cr,fragment:Ik,name:"null-filter"});super({glProgram:e,resources:{}})}}const $k=`#version 300 es
precision lowp float;

out vec4 finalColor;

in vec2 vTextureCoord;
uniform sampler2D uBackBuffer;
uniform vec3 uTargetColor;
// do not use uTexture in this frag - for some reason it causes pixi's render pipeline
// to take away the backbuffer, which we rely on sampling from

void main() {
    vec3 bg = texture(uBackBuffer, vTextureCoord).rgb;

    float isBlack = step(length(bg), 0.001f); // 1 if black, 0 otherwise
    finalColor = mix(vec4(uTargetColor, 1.0f), vec4(0, 0, 0, 0), isBlack);


}`;class gu extends Yt{uniforms;constructor(e="white"){const r=Et.from({vertex:Cr,fragment:$k,name:"colour-clash-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"}}},blendRequired:!0}),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this.targetColor=e}set targetColor(e){const[r,n,o]=new V(e).toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}}const mu=({colourised:t,direction:e,room:r,times:n,position:o,colourSwap:s})=>U({label:`floorEdge(${e})`,textureId:`floorEdge.${e}`,times:n,filter:s?lp(r,e,t):void 0,...Z(o)}),zk=({room:t,xSize:e,ySize:r,y:n})=>{const o=new te({label:"floorColourClash"}),s=uu(t,"right");for(let a=0;a<=r;a++){const l=wr({x:0,y:a,z:0}),c=new ct().rect(l.x-(a===0?0:8),l.y,8*3,8).fill(s);c.filters=new gu(s),o.addChild(c)}const i=uu(t,"towards");for(let a=0;a<=e;a++){const l=wr({x:a,y:0,z:0}),c=new ct().rect(l.x-16,l.y,8*(a===0?2:3),8).fill(i);c.filters=new gu(i),o.addChild(c)}return o.y=n,o},Nk=Re(({renderContext:{room:t,item:e,general:{colourised:r},colourClashLayer:n}})=>{const{color:{shade:o}}=t,{config:s,state:{position:i},aabb:a}=e,{floorType:l,naturalFootprint:c}=s,u=new te({label:"floorAppearance"}),d=Z({...a,y:0}),h=Z({...a,x:0,y:0}),p=Z({...a,x:0}),y=Z(a);if(l!=="none"){const m=new te({label:"tiles"}),v=l==="deadly"?`generic${o==="dimmed"?".dark":""}.floor.deadly`:`${s.scenery}${o==="dimmed"?".dark":""}.floor`,w=Ht().textures[v];try{Bd(v)}catch(I){throw new Error(`no floor textureId for floorType: ${l}, shade: ${o}`,{cause:I})}const S=fr(c.position,i),b={x:pu(S.x/H.w),y:pu(S.y/H.w)},x=8,k={x:d.x,y:y.y-x,width:p.x-d.x,height:h.y-y.y+2*x},C=fr(wr(jn(b,{x:.5,y:.5})),{y:a.z},k),_=new Lm({texture:w,tilePosition:C,...k});m.addChild(_),m.addChild(Ok(e,t));const j=new ct().moveTo(y.x,y.y).lineTo(p.x,p.y).lineTo(p.x,p.y+3).lineTo(h.x,h.y+3).lineTo(d.x,d.y+3).lineTo(d.x,d.y).fill({color:16711680,alpha:.5});m.addChild(j),m.mask=j,m.filters=[dk(t)];const M=new te({children:[m]});M.filters=new pt({outlineColor:z.pureBlack,upscale:1,lowRes:!1});const N=new te({children:[M]}),G=new jk;G.enabled=!1,N.filters=G,N.cacheAsTexture(!0),u.addChild(N),u.addChild(U({textureId:"blank",x:p.x,y:h.y+8}))}{const m=new te({label:"edges"});l==="none"&&m.addChild(new ct().moveTo(p.x,p.y+8).lineTo(p.x,p.y+100).lineTo(d.x,d.y+100).lineTo(d.x,d.y+8).lineTo(h.x,h.y+8).fill(0));const v=Math.ceil(a.y/H.w);m.addChild(mu({colourised:r,direction:"right",room:t,times:{y:v},position:{z:a.z},colourSwap:r}));const w=Math.ceil(a.x/H.w);if(m.addChild(mu({colourised:r,direction:"towards",room:t,times:{x:w},position:{z:a.z},colourSwap:r})),u.addChild(m),!r){const S=zk({xSize:w,ySize:v,y:-a.z+1,room:t});u.addChild(S),n.attach(S)}}return u}),Dk=["cyberman","dalek","skiHead","bubbleRobot","computerBot","turtle"],Lk=t=>{let e=2166136261;const r=t.length;for(let n=Math.max(0,r-9);n<r;n++)e^=t.charCodeAt(n),e=Math.imul(e,1540483477),e^=e>>>15;return(e>>>0)/4294967295},Mk=200,Bk=1,Fk=(t,e)=>{const r=Lk(e);return Math.sin((t+r*2e4)/Mk)*Bk},yu=({id:t,config:{which:e},state:r},n,o)=>{if((e==="cyberman"||e==="bubbleRobot")&&r.activated||e==="emperorsGuardian"){const s=o;s[bs].y=-12+Fk(n.roomTime,t)}},Uk=({renderContext:{item:t,room:e,general:{paused:r}},currentRendering:n})=>{const{config:o,state:s}=t,i=n?.renderProps,{activated:a,busyLickingDoughnutsOffFace:l}=s,c=l?uk:a?void 0:Dk.includes(o.which)?ck(e):void 0;switch(o.which){case"skiHead":case"turtle":case"cyberman":case"computerBot":case"elephant":case"elephantHead":case"monkey":{const u=ya(s.facing)??"towards";if(!(i===void 0||a!==i.activated||l!==i.busyLickingDoughnutsOffFace||u!==i.facingXy4))return yu(t,e,n.output),"no-update";const h={facingXy4:u,activated:a,busyLickingDoughnutsOffFace:l};switch(o.which){case"skiHead":return{output:U({textureId:`${o.which}.${o.style}.${u}`,filter:c}),renderProps:h};case"elephantHead":return{output:U({textureId:`elephant.${u}`,filter:c}),renderProps:h};case"turtle":return{output:U(a&&!l?{animationId:`${o.which}.${u}`,filter:c,paused:r}:{textureId:`${o.which}.${u}.1`,filter:c}),renderProps:h};case"cyberman":return{output:s.activated||s.busyLickingDoughnutsOffFace?Jr({top:{textureId:`${o.which}.${u}`,filter:c||ft(e)},bottom:{...di,paused:r}}):U({textureId:`${o.which}.${u}`,filter:c}),renderProps:h};case"computerBot":case"elephant":case"monkey":return{output:Jr({top:`${o.which}.${u}`,bottom:{animationId:"headlessBase.flash",playOnce:"and-stop"},filter:c}),renderProps:h};default:throw new Error(`unexpected monster ${o}`)}break}case"homingBot":{const u=!xg(s.vels.walking,dr);return i===void 0||l!==i.busyLickingDoughnutsOffFace||a!==i.activated||u!==i.walking?{filter:c,output:U({animationId:u?"headlessBase.flash":"headlessBase.scan",filter:c}),renderProps:{activated:a,busyLickingDoughnutsOffFace:l,walking:u}}:"no-update"}case"helicopterBug":case"emperor":case"dalek":case"bubbleRobot":case"emperorsGuardian":{if(!(i===void 0||l!==i.busyLickingDoughnutsOffFace||a!==i.activated))return yu(t,e,n.output),"no-update";const d={activated:a,busyLickingDoughnutsOffFace:l};switch(o.which){case"helicopterBug":case"dalek":return{output:U(a&&!l?{animationId:o.which,filter:c,paused:r}:{textureId:`${o.which}.1`,filter:c}),renderProps:d};case"bubbleRobot":return{output:Jr({top:{...di,paused:r},filter:c}),renderProps:d};case"emperorsGuardian":return{output:Jr({top:"ball",bottom:{...di,paused:r},filter:c}),renderProps:d};case"emperor":return{output:U({animationId:"bubbles.cold",filter:c,paused:r}),renderProps:d};default:throw new Error(`unexpected monster ${o}`)}break}default:throw new Error(`unexpected monster ${o}`)}},Ro=new pt({outlineColor:z.pureBlack,upscale:Jt(L.getState()),lowRes:!0});new Ne;new Ne;new Ne;new Ne(z.moss);new Ne;new Ne(Xr.head),new Ne(sn(Xr.head)),new Ne(Xr.heels),new Ne(sn(Xr.heels));function*Hk(t){const e=typeof t=="string"?t==="infinite"?"":t:t.toString(),r=wd(e);let n=0;for(const o of e){const s=`hud.char.${Gu(o)}`;try{Bd(s)}catch(i){throw new Error(`no texture id for char "${o}": ${i.message}`,{cause:i})}yield U({textureId:s,x:(n+.5-r/2)*_g.w}),n++}}const hp=(t,e)=>{t.removeChildren();try{ws(Hk(e),t)}catch(r){throw console.error("invalid string is",e,"and on window as window.invalid"),console.error(r),window.invalid=e,new Error(`could not show text "${e}" in container because: "${r.message}"`,{cause:r})}return t},Wk=Qf.floatingText,Gk=12,vu=H.h*3,wu=[z.shadow,z.midGrey,z.redShadow,z.metallicBlue,z.midRed,z.moss,z.pink,z.lightBeige,z.pastelBlue,z.lightGrey,z.highlightBeige],bu=[...wu,...new Array(20).fill(z.white),...wu.toReversed()],qk=({renderContext:{item:{config:{textLines:t,appearanceRoomTime:e}},room:{roomTime:r},general:{displaySettings:{uncolourised:n}},frontLayer:o},currentRendering:s})=>{const i=s?.output;let a;const c=(r-e)*Wk;if(i===void 0){a=new te({filters:new pt({outlineColor:z.pureBlack,upscale:Jt(L.getState()),lowRes:!1})}),o?.attach(a);for(let u=0;u<t.length;u++){const d=t[u],h=hp(new te({label:d,y:u*Gk,filters:n?er:new Ne(z.pink)}),d.toUpperCase());a.addChild(h)}}else a=i;for(let u=0;u<t.length;u++){const d=a.children[u],[h]=d.filters,p=c+u*-12,y=p>0&&p<vu;if(d.visible=y,y&&h){const m=Math.floor(p/vu*bu.length);h.targetColor=bu[m]}}return a.y=-c,{output:a,renderProps:ce}},xu=500,Vk=xr.animations["conveyor.x"].animationSpeed,_u=xr.animations["conveyor.x"].length,Kk=t=>1-(1-t)**2,Xk=(t,e)=>{for(let r=0;r<t.children.length;r++){const n=t.children[r],o=r%_u;n.gotoAndStop(e?_u-o-1:o)}return t},Jk=({renderContext:{item:{config:{direction:t,times:e},state:{stoodOnBy:r}},room:{roomTime:n}},currentRendering:o})=>{const s=o?.renderProps,i=ao(r),a=(!i&&s?.moving?n:s?.roomTimeStoppedMoving)??ke,l=Wt(t),c=o?.output??Xk(U({animationId:`conveyor.${l}`,reverse:t==="towards"||t==="right",times:e}),t==="towards"||t==="right"),u=i?0:Math.min(n-a,xu),d=Math.max(0,1-u/xu);for(const h of c.children)if(d===0)h.stop();else{const p=Vk*Kk(d);h.play(),h.animationSpeed=p}return{output:c,renderProps:{moving:i,roomTimeStoppedMoving:a}}},Yk=xs(Jk),Zk=({renderContext:{item:t,room:e,general:{paused:r}},currentRendering:n})=>{const{state:{stoodOnBy:o},config:{times:s}}=t,i=n?.renderProps,a=nl(t),l=a&&io(o,e).some(Sa);return i===void 0||a!==i.activated||l!==i.flashing?{output:l?new te({children:[U({textureId:"teleporter",times:s}),U({animationId:"teleporter.flashing",times:s,paused:r})]}):U({textureId:a?"teleporter":"block.artificial",times:s}),renderProps:{flashing:l,activated:a}}:"no-update"},Qk=({renderContext:{item:{state:{facing:t,actedOnAt:{roomTime:e,by:r}}},room:{roomTime:n,items:o}},currentRendering:s})=>{const i=s?.renderProps,a=ya(t)??"towards",l=n===e&&Tt(ss(r)).some(u=>dd(o[u]));return i===void 0||a!==i.facingXy4||l!==i.controlledByJoystick?{output:Jr({top:`charles.${a}`,bottom:l?"headlessBase.all":"headlessBase"}),renderProps:{facingXy4:a,controlledByJoystick:l}}:"no-update"},eC=({renderContext:{item:{state:{stoodOnBy:t,stoodOnUntilRoomTime:e}},general:{paused:r}},tickContext:{lastRenderRoomTime:n},currentRendering:o})=>{const s=o?.renderProps,i=ao(t);let a;return o?.output?a=o?.output:(a=U({animationId:"spring.bounce"}),a.loop=!1,a.gotoAndStop(0)),n!==void 0&&e>n&&!i&&!r?a.gotoAndPlay(0):i&&!(s?.compressed??!1)&&a.gotoAndStop(1),{output:a,renderProps:{compressed:i}}},tC=xs(eC),rC=({renderContext:{item:{config:{which:t,startDirection:e}}},currentRendering:r})=>r?.renderProps===void 0?{output:t==="headOverHeels"?Jr({top:{textureId:`head.walking.${e}.2`},bottom:{textureId:`heels.walking.${e}.2`}}):U({textureId:`${t}.walking.${e}.2`}),renderProps:ce}:"no-update",nC=({renderContext:{item:{state:{vels:{sliding:t}},config:{startingPhase:e}},general:{paused:r}},tickContext:{deltaMS:n},currentRendering:o})=>{const i=(o?.renderProps?.distanceTravelled??0)+wa(t)*(r?0:n),l=o?.output??U("spikyBall.1"),u=(Math.floor(i*2/Oo.w)+e)%2+1;return l.texture=Ht().textures[`spikyBall.${u}`],{output:l,renderProps:{distanceTravelled:i}}},oC=xs(nC),sC=(t,e,r,n)=>`${t}${n?".dark":""}.wall.${e}.${r}`,iC=Re(({renderContext:{item:{id:t,config:e},room:r}})=>{if(e.direction==="right"||e.direction==="towards")throw new Error(`wall is near: ${t}`);const{direction:n,tiles:o}=e,s=hn(Wt(n)),i=new te({label:"wallTiles"});for(let a=0;a<e.tiles.length;a++){let l=U({textureId:sC(r.planet,o[a],n,r.color.shade==="dimmed"),y:1,pivot:n==="away"?{x:Oo.w,y:Oo.h+1}:{x:0,y:Oo.h+1}});const c=wr({[s]:a});if(r.planet==="moonbase"){const u=`moonbase.wall.screen.${o[a]}.away`;Fd(u)&&(l=new te({children:[l]}),l.addChild(U({animationId:u,randomiseStartFrame:!0,flipX:n==="left",x:n==="away"?-8:8,y:-23})))}l.x+=c.x,l.y+=c.y,i.addChild(l),i.filters=ft(r)}return i}),aC=({renderContext:{item:{state:{setting:t},config:e}},currentRendering:r})=>{const n=r?.renderProps,o=e.type==="in-store"?ma(L.getState(),e.path)?"right":"left":t;return n===void 0||o!==n.setting?{output:U(`switch.${o}`),renderProps:{setting:o}}:"no-update"},lC=(t,e,r)=>e==="tower"?"tower":e==="book"?"book.x":e==="organic"&&t?`block.organic.dark${r?".disappearing":""}`:`block.${e}${r?".disappearing":""}`,cC=({renderContext:{item:{config:{style:t,times:e},state:{disappearing:r}},room:n},currentRendering:o})=>{const s=o?.renderProps,i=r!==null;return s===void 0||s.isDissapearing!==i?{output:U({textureId:lC(n.color.shade==="dimmed",t,i),filter:t==="organic"?ft(n):t==="book"?cp(n):void 0,times:e}),renderProps:{isDissapearing:i}}:"no-update"},uC=({state:{stoodOnBy:t,position:e},config:{times:r}},n)=>{const o=new Array(r?.x??1).fill(null).map(()=>new Array(r?.y??1));return io(t,n).filter(hd).forEach(({id:s,state:{position:i}})=>{const a=fr(i,e),l={x:Math.floor(a.x/H.w),y:Math.floor(a.y/H.d)};l.x<0||l.x>=(r?.x??1)||l.y<0||l.y>=(r?.y??1)||(o[l.x][l.y]=s)}),o},dC=(t,e)=>{let r=0,n=1;for(const o of e)for(const s of o)s!==void 0&&t.items[s]?.state.activated&&(r|=n),n<<=1;return r},hC=({renderContext:{item:t,room:e},currentRendering:r})=>{const{config:{times:n}}=t,o=r===void 0?uC(t,e):r.renderProps.chargePositions,s=dC(e,o);return s!==r?.renderProps.cybermanActivationBitmask?{output:U({textureIdCallback(a,l){const c=o[a][l];return c===void 0||e.items[c]?.state.everActivated?"toaster.off":"toaster.on"},times:n??ce}),renderProps:{chargePositions:o,cybermanActivationBitmask:s}}:"no-update"},fC={head:gi,heels:gi,headOverHeels:gi,doorFrame:bk,doorLegs:wk,monster:Uk,floatingText:qk,barrier:Re(({renderContext:{item:{config:{axis:t,times:e}}}})=>U({textureId:`barrier.${t}`,times:e})),deadlyBlock:Re(({renderContext:{item:{config:t},room:e}})=>{switch(t.style){case"volcano":return U({animationId:"volcano",filter:ft(e),times:t.times,randomiseStartFrame:!0});case"toaster":throw new Error("use the special toaster appearance instead");default:throw t.style,new Error("unknown deadly block style")}}),spikes:$t("spikes"),slidingDeadly:oC,slidingBlock:Re(({renderContext:{item:{config:{style:t}},room:e}})=>U(t==="book"?{textureId:"book.y",filter:cp(e)}:t)),block:cC,switch:aC,conveyor:Yk,lift:Re(({renderContext:{general:{paused:t}}})=>{const e=new te,r={x:fl.w/2,y:fl.h};return e.addChild(U({animationId:"lift",pivot:r,paused:t})),e.addChild(U({textureId:"lift.static",pivot:r})),e}),teleporter:Zk,sceneryCrown:Re(({renderContext:{item:{config:{planet:t}}}})=>U({textureId:`crown.${t}`})),pickup:Re(({renderContext:{item:{config:t},room:e,general:{paused:r}}})=>{if(t.gives==="crown")return U({textureId:`crown.${t.planet}`});const o={shield:"whiteRabbit",jumps:"whiteRabbit",fast:"whiteRabbit","extra-life":"whiteRabbit",bag:"bag",doughnuts:"doughnuts",hooter:"hooter",scroll:{textureId:"scroll",filter:ft(e)},reincarnation:{animationId:"fish",paused:r}}[t.gives];return U(o)}),moveableDeadly:$t("fish.1"),charles:Qk,joystick:$t("joystick"),movingPlatform:$t("sandwich"),pushableBlock:$t("stepStool"),portableBlock:Re(({renderContext:{item:{config:{style:t}}}})=>U(t)),spring:tC,sceneryPlayer:rC,hushPuppy:$t("hushPuppy"),bubbles:Re(({renderContext:{item:{config:{style:t}},general:{paused:e}}})=>U({animationId:`bubbles.${t}`,paused:e})),firedDoughnut:$t({animationId:"bubbles.doughnut"}),ball:$t("ball"),floor:Nk,particle:Re(({renderContext:{item:{config:{forCharacter:t}}}})=>U({animationId:"particle.fade",anchor:{x:.5,y:.5},filter:t==="heels"?dp:er}))},pC=t=>{if(t.type==="wall"){const{direction:e}=t.config;return e==="right"||e==="towards"?void 0:iC}return t.type==="deadlyBlock"&&t.config.style==="toaster"?hC:fC[t.type]},gC=z.moss,mC=()=>new pt({outlineColor:gC,lowRes:!1,upscale:Jt(L.getState())});class yC{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output)}output=new te({label:"PortableItemPickUpNextHighlightRenderer"});#e=!1;tick(e){const{wouldPickUpNext:r}=this.renderContext.item.state;r!==!this.#e&&(this.output.filters=r?[mC()]:er),this.#e=r,this.childRenderer.tick(e)}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const vC=(t,e,r)=>tm(t)?new yC(e,r):r,wC=z.pastelBlue,bC=z.highlightBeige,xC=z.midRed,_C=z.white,Su=new pt({outlineColor:bC,upscale:Jt(L.getState()),lowRes:!1}),ku=new pt({outlineColor:xC,upscale:Jt(L.getState()),lowRes:!1}),SC=new pt({outlineColor:_C,upscale:Jt(L.getState()),lowRes:!1}),Cu=new Ne(wC),Pu={left:"↖",away:"↗",right:"↘",towards:"↙"};class kC{constructor(e,r){this.renderContext=e,this.childRenderer=r,this.output.addChild(r.output),this.#e()}output=new te({label:"EditorAnnotationsRenderer"});#e(){const e=this.renderContext.item;switch(e.type){case"pickup":if(e.config.gives==="shield"||e.config.gives==="extra-life"||e.config.gives==="jumps"||e.config.gives==="fast"){const r={shield:"🛡",jumps:"♨",fast:"⚡","extra-life":"+2"};this.#t({annotationText:r[e.config.gives],yAdj:-16})}break;case"doorFrame":if(e.config.part==="near"){const{rooms:r}=L.getState().levelEditor.campaignInProgress,{config:{toRoom:n,direction:o}}=e,s=!!r[n],i=n.toUpperCase(),a=Pu[o],l=o==="away"||o==="right"?`${i}${a}`:`${a}${i}`;this.#t({annotationText:l,yAdj:o==="left"||o==="away"?-48:0,error:!s,clickDispatch:s?()=>Ti(n):void 0})}break;case"teleporter":{const{rooms:r}=L.getState().levelEditor.campaignInProgress,{config:{toRoom:n}}=e,o=!!r[n];this.#t({annotationText:`➡${n.toUpperCase()}`,yAdj:-12,error:!o,clickDispatch:o?()=>Ti(n):void 0})}break;case"conveyor":{const{config:{direction:r}}=e,n=Pu[r];this.#t({annotationText:n,yAdj:-12})}break}}#t({annotationText:e,yAdj:r=0,error:n=!1,clickDispatch:o}){const{renderContext:{frontLayer:s}}=this,i=new Ne(n?z.midRed:z.white),a=hp(new te({label:"EditorAnnotationTextContainer",filters:[i,new pt({lowRes:!0,outlineColor:z.pureBlack,upscale:Jt(L.getState())})]}),e);a.y=r,o!==void 0&&(a.eventMode="static",a.on("click",()=>{L.dispatch(o())}),a.on("mouseover",()=>{L.getState().levelEditor.tool.type==="pointer"&&(L.dispatch(gl(!0)),i.targetColor=z.pastelBlue)}),a.on("mouseout",()=>{L.dispatch(gl(!1)),i.targetColor=z.white}),a.cursor="pointer"),this.output.addChild(a),s.attach(a)}tick(e){this.#r(),this.childRenderer.tick(e)}#r(){const{renderContext:{item:e,room:r}}=this,{clickableAnnotationHovered:n}=L.getState().levelEditor,{jsonItemId:o}=e,s=L.getState(),i=fd(s),a=rm(s),l=cr(s),c=o&&i?.jsonItemId===o&&!n,u=o&&a.includes(o),d=()=>o!==void 0&&(Be(r.items).some(h=>h.jsonItemId===i?.jsonItemId&&h.type==="switch"&&h.config.type==="in-room"&&h.config.modifies.some(p=>p.targets.includes(o)))||e.type==="switch"&&Be(r.items).some(({jsonItemId:h})=>h!==void 0&&h===i?.jsonItemId&&e.config.type==="in-room"&&e.config.modifies.some(p=>p.targets.includes(h)))||e.type==="charles"&&Be(r.items).some(h=>h.jsonItemId===i?.jsonItemId&&h.type==="joystick"&&h.config.controls.some(p=>p===o))||e.type==="joystick"&&e.config.controls.some(h=>i?.jsonItemId===h));this.output.filters=c&&u?[Cu,l.type==="eyeDropper"?ku:Su]:c?l.type==="eyeDropper"?ku:Su:u?Cu:d()?SC:er}destroy(){this.output.destroy(),this.childRenderer.destroy()}}const CC=(t,e,r)=>e.general.editor?new kC(e,r):r,PC=(t,e)=>{e!==void 0&&L.getState().gameMenus.cheatsOn&&(e.eventMode="static",e.on("pointertap",()=>{L.dispatch(Cg({item:t}))}))},EC=t=>{const e=L.getState(),r=Sg(e),n=!kg(e),{item:o}=t,s=r==="all"||r==="non-wall"&&t.item.type!=="wall",i=[],a=pC(o);if(a!==void 0){const h=new Yf(t,a),p=new mk(t,h);i.push(CC(o,t,vC(o,t,p)))}if(n){const h=IS(t);h!==void 0&&i.push(h)}s&&i.push(new V_(t));let l;if(i.length===0)l=void 0;else{const h=i.length===1?i[0]:new TC(i,t);PC(o,h.output),l=new K_(t,h)}const c=t.general.soundSettings.mute??va.soundSettings.mute,u=t.general.paused||c?void 0:YS(t),d=u===void 0?void 0:new ek(t,u);return new jS(t,{graphics:l,sound:d})};class TC{constructor(e,r){this.renderContext=r,this.#e=e,this.#t.addChild(...e.map(n=>n.output))}#e;#t=new te({label:"CompositeRenderer"});tick(e){for(const r of this.#e)r.tick(e)}destroy(){for(const e of this.#e)e.destroy()}get output(){return this.#t}}const RC=Qn("wall","doorFrame"),Eu=256;function*AC(t){const{left:e,right:r}=Be(t.items).filter(RC).reduce((n,{aabb:o,renderAabb:s,renderAabbOffset:i,state:{position:a}})=>{const l=s??o,c=W(a,i??ge),u=Z(W(c,{x:l.x})).x,d=Z(W(c,{y:l.y})).x;return{left:Math.min(n.left,u),right:Math.max(n.right,d)}},{left:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY});e!==Number.POSITIVE_INFINITY&&(yield new ct().rect(e-100,-256,100,Eu).fill(0)),r!==Number.NEGATIVE_INFINITY&&(yield new ct().rect(r,-256,100,Eu).fill(0))}class OC{constructor(e){this.renderContext=e;const{general:{colourised:r,soundSettings:n},room:o}=e;this.initFilters(r,e.room.color);const i=n.mute??va.soundSettings.mute?void 0:ae.createGain();ws(AC(o),this.#o),this.output={sound:i,graphics:new te({label:`RoomRenderer(${e.room.id})`})},this.output.graphics.addChild(this.#t),r||(this.#r=new Al({sortableChildren:!1}),this.output.graphics.addChild(this.#r)),this.output.graphics.addChild(this.#o),this.output.graphics.addChild(this.#n)}#e=!1;#t=new te({label:"items"});#r;#n=new Al({sortableChildren:!1});#o=new te({label:"occlusion"});output;#s=void 0;#l=new Map;#i=new Map;initFilters(e,r){this.#t.filters=e?r.shade==="dimmed"?hk:er:new Ne(r.shade==="dimmed"?bf(Zo(r).main.original):Zo(r).main.original)}#c(e){const{room:r}=this.renderContext,n={...e,lastRenderRoomTime:this.#s};for(const s of Be(r.items)){let i=this.#i.get(s.id);if(i===void 0){i=EC({...this.renderContext,colourClashLayer:this.#r,frontLayer:this.#n,item:s}),this.#i.set(s.id,i);const{graphics:a,sound:l}=i.output;if(a&&(this.#t.addChild(a),s.fixedZIndex&&(a.zIndex=s.fixedZIndex)),l){if(!this.output.sound)throw new Error("item renderer has sound, but room renderer does not - this probably means that they disagree on if the user has sound muted");l.connect(this.output.sound)}}try{i.tick(n)}catch(a){throw new Error(`RoomRenderer caught error while ticking Renderer for item "${s.id}" - item in play object is:
           ${JSON.stringify(s,null,2)}`,{cause:a})}}let o=!1;for(const[s,i]of this.#i.entries())r.items[s]===void 0&&(i.destroy(),this.#i.delete(s),o=!0);o&&this.#a()}#a(){if(this.#r)for(const e of this.#r.renderLayerChildren)e.parent===null&&this.#r.detach(e);for(const e of this.#n.renderLayerChildren)e.parent===null&&this.#n.detach(e)}#d(e){const r=Jf(this.renderContext.room.items,e.movedItems,this.#l),{order:n}=tl(r,this.renderContext.room.items);for(let o=0;o<n.length;o++){const s=this.#i.get(n[o]);if(s===void 0)throw new Error(`Item id=${n[o]} does not have a renderer - cannot assign a z-index`);const i=s.output.graphics;if(i)i.zIndex=n.length-o;else throw new Error(`order ${n[o]} was given a z-order by sorting, but item has no graphics`)}}get#u(){return this.#s!==void 0}tick(e){const r=this.#u?e:{...e,movedItems:new Set(Be(this.renderContext.room.items))};this.#c(r),(!this.#u||r.movedItems.size>0)&&this.#d(r),this.#s=this.renderContext.room.roomTime}destroy(){this.output.graphics.label=this.output.graphics.label+"DESTROYED",this.output.graphics.destroy({children:!0}),this.output.sound?.disconnect(),this.#i.forEach(e=>{e.destroy()}),this.#e=!0}get destroyed(){return this.#e}}const IC=t=>()=>_r(t),fE=IC(rn),jC=vd([rn,t=>t.levelEditor.previewedEdits],(t,e)=>nd(t,r=>{const n=ed(e);for(const[o,s]of n)s===null?delete r.items[o]:r.items[o]=s})),il=g.createContext(null),$C=()=>{const[t,e]=g.useState(()=>si({roomJson:rn(L.getState()),roomPickupsCollected:ce,scrollsRead:ce,isNewGame:!0})),[r,n]=g.useState(t),o=be(rn),s=be(jC);return g.useEffect(()=>{const i=si({roomJson:o,roomPickupsCollected:ce,scrollsRead:ce,isNewGame:!0});if(e(i),o===s)n(i);else{const a=si({roomJson:s,roomPickupsCollected:ce,scrollsRead:ce,isNewGame:!0});n(a)}},[o,s]),{roomState:t,roomStateWithPreviews:r}},zC=({children:t})=>{const e=$C();return f.jsx(il,{value:e,children:t})},NC=()=>{const t=g.useContext(il);if(t===null)throw new Error("no room state in context, or no context");return t.roomState},fp=()=>{const t=g.useContext(il);if(t===null)throw new Error("no room state in context, or no context");return t.roomStateWithPreviews},DC=t=>{t.ticker.remove(t.render,t)},pp=g.createContext(null),LC=({children:t})=>{const[e,r]=g.useState(null);return g.useEffect(()=>{const n=new Td;return n.init({background:z.pureBlack,sharedTicker:!0}).then(()=>{DC(n),r(n)}),()=>{}},[]),e===null?null:f.jsx(pp,{value:e,children:t})},Pr=()=>g.useContext(pp),MC=(t,e)=>({displaySettings:{emulatedResolution:"amigaLowResPal",showBoundingBoxes:e},soundSettings:{mute:!0},pixiRenderer:t,gameState:void 0,paused:!1,colourised:!0,upscale:ba(L.getState()),editor:!0}),Tu=(t,e,r)=>new OC({room:t,general:MC(e,r)}),BC=()=>{const{renderer:t}=Pr(),e=Vu();if(!t)throw new Error("this should never be falsey (typescript violation)");const r=fp(),[n,o]=g.useState(()=>Tu(r,t,e));return g.useEffect(()=>{const s=Tu(r,t,e);return o(s),()=>{s.destroy()}},[r,t,e]),n},Ru=(t,e,r)=>{const{world:{onItem:{face:n},position:o,itemId:s}}=t;if(n.z>Qu)return Bo(o);if(r.type==="door"){const i=e.items[s];if(i.type!=="wall")return;const{config:a,aabb:l,state:{position:c}}=i,u=nm(_a(a)),d=hn(Wt(a.direction)),h=Wt(a.direction);if(u[d]<2)return;const p=c[d],y=c[d]+l[d]-iS,m=c.z,v=c.z+l.z-Rn,w={[d]:Math.max(Math.min(o[d],y),p),[h]:o[h],z:Math.max(Math.min(o.z,v),m)};return Bo(w)}return W(Bo(o),n)},FC={z:1,x:0,y:0},UC={z:0,x:0,y:-1},Au={z:0,x:-1,y:0},HC=(t,{x:e,y:r},n)=>{if(n.type==="item"&&n.item.type==="door"&&t.type==="wall"){const l=t.config.direction;return os(Ve[l],-1)}const{bottomCentre:o,topLeft:s,topRight:i}=cn(t.state.position,t.aabb);return r<s.y-(s.x-e)/2?r<i.y-(e-i.x)/2?FC:Au:e<o.x?UC:Au},WC=3,GC=(t,{x:e,y:r},n)=>{const o=cn(t.state.position,t.aabb);return Pg.find(s=>{const i=o.projectCorner(s);return wa(fr(i,{x:e,y:r}))<WC})},Fr=3,mi=1.5;function vt({x:t,y:e},r,n){const o={x:t-r.x,y:e-r.y},s=o.x*n.y-o.y*n.x;return Math.abs(s)/Math.hypot(n.x,n.y)}const gp={point:{x:-1,y:-1,z:0},normal:{x:0,y:0,z:1}},mp={point:{x:-1,y:0,z:1},normal:{x:0,y:1,z:0}},yp={point:{x:0,y:-1,z:1},normal:{x:1,y:0,z:0}},vp={point:{x:0,y:1,z:1},normal:{x:1,y:0,z:0}},wp={point:{x:1,y:0,z:1},normal:{x:0,y:1,z:0}},bp={point:{x:1,y:-1,z:0},normal:{x:0,y:0,z:1}},xp={point:{x:0,y:-1,z:-1},normal:{x:1,y:0,z:0}},_p={point:{x:-1,y:1,z:0},normal:{x:0,y:0,z:1}},Sp={point:{x:-1,y:0,z:-1},normal:{x:0,y:1,z:0}},qC=(t,e,r,n)=>{const o=cn(t.state.position,t.aabb),s=r.x<0,i=r.y<0,a=r.z>0;if((s||i)&&vt(e,o.bottomCentre,{x:0,y:-1})<mi)return gp;if((s||a)&&vt(e,o.topRight,{x:2,y:-1})<mi)return mp;if((i||a)&&vt(e,o.topLeft,{x:2,y:1})<mi)return yp;switch(!0){case a:{const l=o.c111;if(vt(e,l,{x:2,y:1})<Fr)return vp;if(vt(e,l,{x:-2,y:1})<Fr)return wp;break}case i:{const l=o.c100;if(vt(e,l,{x:0,y:-1})<Fr)return bp;if(vt(e,l,{x:2,y:1})<Fr)return xp;break}case s:{const l=o.c010;if(vt(e,l,{x:0,y:-1})<Fr)return _p;if(vt(e,l,{x:-2,y:1})<Fr)return Sp;break}}},VC=({x:t,y:e},r)=>n=>{const{position:o,aabb:s}=KC(n,r),{bottomCentre:i,topLeft:a,topRight:l}=cn(o,s);return!(t<a.x||t>l.x||e<l.y-(l.x-t)/2||e<a.y-(t-a.x)/2||e>i.y-(t-i.x)/2||e>i.y-(i.x-t)/2)},KC=(t,e)=>e.type==="item"&&t.type==="wall"?{position:t.state.position,aabb:t.aabb}:{position:W(t.state.position,t.renderAabbOffset??ge),aabb:t.renderAabb??t.aabb},Ou=t=>t.fixedZIndex!==void 0,XC=t=>{if(t.every(Ou))return t.toSorted((s,i)=>i.fixedZIndex-s.fixedZIndex).at(0);const e=t.filter(s=>!Ou(s));if(e.length===0)return;if(e.length===1)return e[0];const r=Object.fromEntries(e.map(s=>[s.id,s])),n=Jf(r),{order:o}=tl(n,r);return r[o[0]]},kp=(t,e,r,n)=>{const o=!n||r.type==="item"&&r.item.type==="door",s=o?H.w:H.w/2,i=H.h,a=o?0:s/2,l=i/2,c=Yu(e);return{x:c==="yz"?Math.round(t.x/s)*s:Math.floor((t.x-a)/s)*s,y:c==="xz"?Math.round(t.y/s)*s:Math.floor((t.y-a)/s)*s,z:c==="xy"?Math.round(t.z/i)*i:Math.floor((t.z+l)/i)*i}},JC=({state:{position:t},aabb:e},r,n,o,s)=>{const i={x:t.x+(r.x<0?0:e.x),y:t.y+(r.y<0?0:e.y),z:t.z+(r.z<0?0:e.z)},a=D_(i,r,n);return kp(a,r,o,s)},YC=t=>e=>{const r=Un(e);return t.type==="item"&&t.item.type==="door"?r&&e.type==="wall":r},yi=(t,e,r,n)=>{const o=XC(Array.from(Be(e.items).filter(YC(r)).filter(VC(t,r)))),s=e.id;if(o){const i=HC(o,t,r);if(!(i.z>0&&!Object.isExtensible(o.state.stoodOnBy)))return{roomId:s,scrXy:t,world:{itemId:o.id,onItem:{face:i,corner:GC(o,t),edge:qC(o,t,i)},position:JC(o,i,t,r,n)}}}return{roomId:s,scrXy:t,world:void 0}},ZC=(t,e=console.error)=>(...r)=>{try{return t(...r)}catch(n){e(n);return}},QC=t=>{const e=t.key;(e==="Backspace"||e==="Delete")&&L.dispatch(sd()),(e==="z"||e==="Z")&&L.dispatch(t.shiftKey?ad():id()),(e==="i"||e==="I"||e===",")&&L.dispatch(Gt({type:"eyeDropper"})),e==="Escape"&&L.dispatch(Gt({type:"pointer"}))},eP=t=>Be(t.items).filter(e=>Un(e)),Cp=(t,e)=>{const r=Tt(eP(t));return e==="door"?r.filter(o=>o.type!=="wall"):r},tP=({roomState:t,jsonItemId:e,newBlockPosition:r,newTimes:n})=>{const o=t.roomJson.items[e],s=rl("testItem",nd(o,a=>{n&&(a.config.times=n),a.position=r}),t.roomJson),i=Tt(Cp(t,o.type)).filter(a=>a.id!==e);return s.some(a=>{const l=Zf(a,i);return!ka(l)})},rP=({roomState:t,blockPosition:e,itemTool:r})=>{const n=rl("maybeAddedItem",{...r,position:e},t.roomJson),o=Cp(t,r.type);return n.some(s=>{const i=Zf(s,o);return!ka(i)})},Pp=(t,...e)=>({x:t(...e.map(r=>r.x)),y:t(...e.map(r=>r.y)),z:t(...e.map(r=>r.z))}),nP=t=>Pp(e=>e>0?e:e>-1?1:-e+1,t),oP=({jsonItem:t,blockDragAccVec:e,resizeEdgeDirection:r,startTimes:n,startPosition:o})=>{const s=od(e,r,pd(t)),i=W(n,s),a=nP(i),l=Pp((c,u,d,h,p)=>{const y=u<1;return c<0!==y?y?d-p+1:d+h-p:y?d+h-1:d},r,i,o,n,a);return{newTimes:a,newPosition:l}},sP=5,vi=(t,e)=>{const r=t.cssUpscale*t.gameEngineUpscale;if(e.target===null)throw new Error("Mouse event target is null");const n=e.target.getBoundingClientRect(),o=e.clientX-n.left,s=e.clientY-n.top;return{x:o/r-t.gameEngineScreenSize.x/2,y:s/r-t.gameEngineScreenSize.y+16}},iP=(t,e)=>{const r=t.cssUpscale*t.gameEngineUpscale;if(e.target===null)throw new Error("Mouse event target is null");const n=e.movementX,o=e.movementY;return{x:n/r,y:o/r}},aP=(t,e,r)=>{const n=t.world?.onItem.edge,o=od(n?.point??ge,pd(r));return rd(o)>0?n.normal:e?{x:1,y:0,z:0}:{x:0,y:0,z:1}},lP=(t,e,r,n,o,s)=>{if(t===void 0)return;const i=fr(e,t.scrXy),a=wa(i);if(!(o||a>sP))return;const c=aP(t,n,s),u=qf(c,r);return n?{x:0,y:0,z:u.z}:u},Iu=(t,e=!1)=>{const r=L.getState().levelEditor;return kp(t,{x:0,y:0,z:1},r.tool,!e&&r.halfGridResolution)},wi=(t,e)=>t.items[e]?.jsonItemId,cP=(t,e)=>e.jsonItemId&&t.levelEditor.selectedJsonItemIds.includes(e.jsonItemId),Uo=(t,e)=>e.levelEditor.wallsFloorsLocked&&(t.type==="wall"||t.type==="floor"),bi=(t,e)=>{const r=L.getState();let n;if(e.world){const o=e.world.itemId,s=o&&t.items[o],i=Uo(s,r)?void 0:s.jsonItemId;n=i===void 0?void 0:{jsonItemId:i,pointingAtOnItem:e.world.onItem}}else n=void 0;qe(fd(r),n)||L.dispatch(gd(n))},uP=t=>{const e=Pr(),r=_r(ba),n=gt(),o=NC(),s=g.useRef(void 0),i=g.useRef(void 0),a=g.useRef(void 0),l=g.useRef(void 0),c=g.useRef(!0);g.useEffect(()=>{if(t===null)return;const u=v=>{const w=vi(r,v),S=iP(r,v),b=L.getState(),x=cr(b),k=yi(w,o,x,b.levelEditor.halfGridResolution),C=!qe(k.world,s.current?.world);switch(x.type){case"item":{if(!C||(n(Ri()),k.world===void 0))break;const _=wi(o,k.world.itemId),j=Ts(b,_);if(j===void 0)break;const M=Ru(k,o,x.item);if(M===void 0||rP({roomState:o,blockPosition:M,itemTool:x.item}))break;n(yl({blockPosition:M,pointedAtItemJson:j,preview:!0}));break}case"pointer":{const _=i.current?.world?.itemId;if(_===void 0){bi(o,k);break}const j=o.items[_],{jsonItemId:M}=j,N=o.roomJson.items[M],G=lP(i.current,w,S,v.metaKey||v.shiftKey,a.current!==void 0,N);if(!G){bi(o,k);break}if(l.current===void 0&&(L.dispatch(ml(!0)),c.current=!0,l.current={position:N.position,times:vl(N.config.times)}),M===void 0||Uo(j,b))break;cP(b,j)||L.dispatch(Rs({jsonItemId:M}));const I=i.current?.world?.onItem.edge,re=I&&md(N),B=a.current??ge,X=W(B,G),q=Iu(X,re);if(a.current=X,$n(Iu(B,re),q))break;const se=l.current.position,K=l.current.times,ie=Bo(q);let ue,le;if(re?{newTimes:le,newPosition:ue}=oP({jsonItem:N,blockDragAccVec:ie,resizeEdgeDirection:I.point,startTimes:K,startPosition:se}):ue=W(se,ie),(!le||$n(le,vl(N.config.times)))&&$n(ue,N.position)||tP({roomState:o,jsonItemId:M,newBlockPosition:ue,newTimes:le}))break;n(om({jsonItemId:M,newPosition:ue,newTimes:le,startOfGesture:c.current})),c.current=!1;break}case"eyeDropper":bi(o,k);break}s.current=k},d=v=>{const w=L.getState();if(o.id!==w.levelEditor.currentlyEditingRoomId)return;const S=vi(r,v),b=cr(L.getState()),x=yi(S,o,b,w.levelEditor.halfGridResolution),k=a.current!==void 0,C=!k&&x.roomId===i.current?.roomId&&x.world?.itemId===i.current?.world?.itemId;if(a.current=void 0,i.current=void 0,l.current=void 0,L.dispatch(ml(!1)),!C&&!k){console.log("mouseUp - not a click or drag end - skipping");return}switch(b.type){case"item":{if(x.world===void 0){n(Gt({type:"pointer"}));break}const _=wi(o,x.world.itemId),j=Ts(w,_);j!==void 0&&n(yl({blockPosition:Ru(x,o,b.item),pointedAtItemJson:j,preview:!1}));break}case"pointer":{if(C){const _=x.world===void 0?void 0:o.items[x.world.itemId];if(_?.jsonItemId===void 0||Uo(_,w)){n(Rs({jsonItemId:void 0}));break}n(Rs({jsonItemId:_.jsonItemId,additive:v.ctrlKey||v.metaKey}))}break}case"eyeDropper":{if(C){const _=x.world?.itemId;if(_===void 0){console.warn("no itemId");break}const j=o.items[_];if(Uo(j,w))break;const M=wi(o,_),N=Ts(w,M);if(N===void 0){console.warn("no json item");break}const G={type:"item",item:{type:N.type,config:N.config}};n(Gt(G))}break}}},h=v=>{const w=cr(L.getState());switch(a.current=void 0,i.current=void 0,l.current=void 0,w.type){case"item":{n(Ri());break}case"pointer":{n(gd(void 0));break}}},p=v=>{const w=vi(r,v),S=L.getState(),b=cr(S),x=yi(w,o,b,S.levelEditor.halfGridResolution);console.log("setting mouseDownPointingAtRef to",x),i.current=x},y=v=>{QC(v)},m=ZC(u);return t.addEventListener("mousemove",m),t.addEventListener("mouseup",d),t.addEventListener("mousedown",p),t.addEventListener("mouseleave",h),t.tabIndex=0,t.addEventListener("keyup",y),()=>{t.removeEventListener("mousemove",m),t.removeEventListener("mouseup",d),t.removeEventListener("mousedown",p),t.removeEventListener("mouseleave",h),t.removeEventListener("keyup",y)}},[e.stage,r,t,n,o])},dP=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=_r(ba);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},hP=t=>{const e=fp(),r=Pr();g.useEffect(()=>{let n=0;const o=({deltaMS:s})=>{if(t.destroyed)return;t.renderContext.room!==e&&console.warn("room renderer does not have the current room");const i=new Set(Go(e.items));e.roomTime+=s,t.tick({deltaMS:s,movedItems:i,progression:n++}),r.render()};return Vr.shared.add(o),()=>{Vr.shared.remove(o)}},[t,e,r])},fP=t=>{const e=Pr();g.useEffect(()=>{if(t)return t.appendChild(e.canvas),()=>{t.removeChild(e.canvas)}},[t,e])},pP=()=>{const t=Pr(),e=_r(r=>r.upscale.upscale.gameEngineUpscale);t.stage.scale=e},gP=()=>{const t=Pr(),e=_r(Eg);g.useEffect(()=>{t.renderer?.resize(e.x,e.y)},[t.renderer,e])},mP=t=>{const e=Pr(),[r]=g.useState(()=>new te),n=_r(Tg);g.useEffect(()=>{if(t.destroyed){console.log("useAddRoomRendererOutputToApplicationStage: room renderer was destroyed, will not add its output to app");return}return r.addChild(t.output.graphics),e.stage.addChild(r),()=>{e.stage.removeChild(r),r.removeChild(t.output.graphics)}},[t,e,r]),g.useEffect(()=>{r.x=n.x/2,r.y=n.y-16},[r,n])},ju=(t,e)=>{L.dispatch(Rg(Ag(t??Og(L.getState()),e)))},yP=(t,e)=>{const r=gt();g.useLayoutEffect(()=>{ju()},[]),g.useLayoutEffect(()=>{const n=()=>ju(t,e);if(e){const o=new ResizeObserver(n);return o.observe(e),()=>o.disconnect()}else return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r,e,t])},vP=()=>{g.useEffect(()=>Ig({actionCreator:Gt,effect(t,{dispatch:e}){e(Ri())}}))},wP=({levelEditor:t})=>{const{dragInProgress:e,clickableAnnotationHovered:r,hoveredItem:n,selectedJsonItemIds:o}=t;if(e)return me("cursor-grabbing");if(r)return me("cursor-pointer");if(n){const s=sm(t,n.jsonItemId);if(s!==void 0&&md(s))if(n.pointingAtOnItem.corner){if($n(n.pointingAtOnItem.corner,{x:1,y:1,z:1}))return me("cursor-n-resize")}else{const{edge:i}=n.pointingAtOnItem;if(i){if(qe(i,_p))return me("cursor-e-resize");if(qe(i,gp))return me("cursor-s-resize");if(qe(i,bp))return me("cursor-w-resize");if(qe(i,mp)||qe(i,vp))return me("cursor-ne-resize");if(qe(i,yp)||qe(i,wp))return me("cursor-nw-resize");if(qe(i,Sp))return me("cursor-se-resize");if(qe(i,xp))return me("cursor-sw-resize")}}return o.includes(n.jsonItemId)?me("cursor-grab"):me("cursor-default")}return me("cursor-crosshair")},bP=()=>be(wP);jg.defaultOptions.scaleMode="nearest";const xP=()=>{const t=BC(),[e,r]=g.useState(null),[n,o]=g.useState(null),s=bP();yP("amigaLowResPal",n??void 0),gP(),mP(t),hP(t),uP(e),fP(e),pP(),vP();const i=dP();return f.jsx("div",{className:`w-full h-full overflow-hidden ${s}`,ref:o,children:f.jsx("div",{style:i,ref:r})})},$u=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,_P=()=>{const t=$g(),e=_r(zg);g.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",Ng())},[]),g.useEffect(()=>{document.body.classList.remove(...Object.keys(Dg).map($u)),document.body.classList.add($u(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},_s=g.createContext(null);_s.displayName="PanelGroupContext";const ve={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},al=10,hr=g.useLayoutEffect,zu=qu.useId,SP=typeof zu=="function"?zu:()=>null;let kP=0;function ll(t=null){const e=SP(),r=g.useRef(t||e||null);return r.current===null&&(r.current=""+kP++),t??r.current}function Ep({children:t,className:e="",collapsedSize:r,collapsible:n,defaultSize:o,forwardedRef:s,id:i,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:h,style:p,tagName:y="div",...m}){const v=g.useContext(_s);if(v===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:w,expandPanel:S,getPanelSize:b,getPanelStyle:x,groupId:k,isPanelCollapsed:C,reevaluatePanelConstraints:_,registerPanel:j,resizePanel:M,unregisterPanel:N}=v,G=ll(i),I=g.useRef({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:r,collapsible:n,defaultSize:o,maxSize:a,minSize:l},id:G,idIsFromProps:i!==void 0,order:h});g.useRef({didLogMissingDefaultSizeWarning:!1}),hr(()=>{const{callbacks:B,constraints:X}=I.current,q={...X};I.current.id=G,I.current.idIsFromProps=i!==void 0,I.current.order=h,B.onCollapse=c,B.onExpand=u,B.onResize=d,X.collapsedSize=r,X.collapsible=n,X.defaultSize=o,X.maxSize=a,X.minSize=l,(q.collapsedSize!==X.collapsedSize||q.collapsible!==X.collapsible||q.maxSize!==X.maxSize||q.minSize!==X.minSize)&&_(I.current,q)}),hr(()=>{const B=I.current;return j(B),()=>{N(B)}},[h,G,j,N]),g.useImperativeHandle(s,()=>({collapse:()=>{w(I.current)},expand:B=>{S(I.current,B)},getId(){return G},getSize(){return b(I.current)},isCollapsed(){return C(I.current)},isExpanded(){return!C(I.current)},resize:B=>{M(I.current,B)}}),[w,S,b,C,G,M]);const re=x(I.current,o);return g.createElement(y,{...m,children:t,className:e,id:G,style:{...re,...p},[ve.groupId]:k,[ve.panel]:"",[ve.panelCollapsible]:n||void 0,[ve.panelId]:G,[ve.panelSize]:parseFloat(""+re.flexGrow).toFixed(1)})}const Ho=g.forwardRef((t,e)=>g.createElement(Ep,{...t,forwardedRef:e}));Ep.displayName="Panel";Ho.displayName="forwardRef(Panel)";let ha=null,Wo=-1,Bt=null;function CP(t,e){if(e){const r=(e&Ip)!==0,n=(e&jp)!==0,o=(e&$p)!==0,s=(e&zp)!==0;if(r)return o?"se-resize":s?"ne-resize":"e-resize";if(n)return o?"sw-resize":s?"nw-resize":"w-resize";if(o)return"s-resize";if(s)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function PP(){Bt!==null&&(document.head.removeChild(Bt),ha=null,Bt=null,Wo=-1)}function xi(t,e){var r,n;const o=CP(t,e);if(ha!==o){if(ha=o,Bt===null&&(Bt=document.createElement("style"),document.head.appendChild(Bt)),Wo>=0){var s;(s=Bt.sheet)===null||s===void 0||s.removeRule(Wo)}Wo=(r=(n=Bt.sheet)===null||n===void 0?void 0:n.insertRule(`*{cursor: ${o} !important;}`))!==null&&r!==void 0?r:-1}}function Tp(t){return t.type==="keydown"}function Rp(t){return t.type.startsWith("pointer")}function Ap(t){return t.type.startsWith("mouse")}function Ss(t){if(Rp(t)){if(t.isPrimary)return{x:t.clientX,y:t.clientY}}else if(Ap(t))return{x:t.clientX,y:t.clientY};return{x:1/0,y:1/0}}function EP(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function TP(t,e,r){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function RP(t,e){if(t===e)throw new Error("Cannot compare node with itself");const r={a:Lu(t),b:Lu(e)};let n;for(;r.a.at(-1)===r.b.at(-1);)t=r.a.pop(),e=r.b.pop(),n=t;ee(n,"Stacking order can only be calculated for elements with a common ancestor");const o={a:Du(Nu(r.a)),b:Du(Nu(r.b))};if(o.a===o.b){const s=n.childNodes,i={a:r.a.at(-1),b:r.b.at(-1)};let a=s.length;for(;a--;){const l=s[a];if(l===i.a)return 1;if(l===i.b)return-1}}return Math.sign(o.a-o.b)}const AP=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function OP(t){var e;const r=getComputedStyle((e=Op(t))!==null&&e!==void 0?e:t).display;return r==="flex"||r==="inline-flex"}function IP(t){const e=getComputedStyle(t);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||OP(t))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||AP.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function Nu(t){let e=t.length;for(;e--;){const r=t[e];if(ee(r,"Missing node"),IP(r))return r}return null}function Du(t){return t&&Number(getComputedStyle(t).zIndex)||0}function Lu(t){const e=[];for(;t;)e.push(t),t=Op(t);return e}function Op(t){const{parentNode:e}=t;return e&&e instanceof ShadowRoot?e.host:e}const Ip=1,jp=2,$p=4,zp=8,jP=EP()==="coarse";let et=[],tn=!1,Ft=new Map,ks=new Map;const Xn=new Set;function $P(t,e,r,n,o){var s;const{ownerDocument:i}=e,a={direction:r,element:e,hitAreaMargins:n,setResizeHandlerState:o},l=(s=Ft.get(i))!==null&&s!==void 0?s:0;return Ft.set(i,l+1),Xn.add(a),rs(),function(){var u;ks.delete(t),Xn.delete(a);const d=(u=Ft.get(i))!==null&&u!==void 0?u:1;if(Ft.set(i,d-1),rs(),d===1&&Ft.delete(i),et.includes(a)){const h=et.indexOf(a);h>=0&&et.splice(h,1),ul(),o("up",!0,null)}}}function zP(t){const{target:e}=t,{x:r,y:n}=Ss(t);tn=!0,cl({target:e,x:r,y:n}),rs(),et.length>0&&(ns("down",t),t.preventDefault(),Np(e)||t.stopImmediatePropagation())}function _i(t){const{x:e,y:r}=Ss(t);if(tn&&t.buttons===0&&(tn=!1,ns("up",t)),!tn){const{target:n}=t;cl({target:n,x:e,y:r})}ns("move",t),ul(),et.length>0&&t.preventDefault()}function Si(t){const{target:e}=t,{x:r,y:n}=Ss(t);ks.clear(),tn=!1,et.length>0&&(t.preventDefault(),Np(e)||t.stopImmediatePropagation()),ns("up",t),cl({target:e,x:r,y:n}),ul(),rs()}function Np(t){let e=t;for(;e;){if(e.hasAttribute(ve.resizeHandle))return!0;e=e.parentElement}return!1}function cl({target:t,x:e,y:r}){et.splice(0);let n=null;(t instanceof HTMLElement||t instanceof SVGElement)&&(n=t),Xn.forEach(o=>{const{element:s,hitAreaMargins:i}=o,a=s.getBoundingClientRect(),{bottom:l,left:c,right:u,top:d}=a,h=jP?i.coarse:i.fine;if(e>=c-h&&e<=u+h&&r>=d-h&&r<=l+h){if(n!==null&&document.contains(n)&&s!==n&&!s.contains(n)&&!n.contains(s)&&RP(n,s)>0){let y=n,m=!1;for(;y&&!y.contains(s);){if(TP(y.getBoundingClientRect(),a)){m=!0;break}y=y.parentElement}if(m)return}et.push(o)}})}function ki(t,e){ks.set(t,e)}function ul(){let t=!1,e=!1;et.forEach(n=>{const{direction:o}=n;o==="horizontal"?t=!0:e=!0});let r=0;ks.forEach(n=>{r|=n}),t&&e?xi("intersection",r):t?xi("horizontal",r):e?xi("vertical",r):PP()}let Ci;function rs(){var t;(t=Ci)===null||t===void 0||t.abort(),Ci=new AbortController;const e={capture:!0,signal:Ci.signal};Xn.size&&(tn?(et.length>0&&Ft.forEach((r,n)=>{const{body:o}=n;r>0&&(o.addEventListener("contextmenu",Si,e),o.addEventListener("pointerleave",_i,e),o.addEventListener("pointermove",_i,e))}),Ft.forEach((r,n)=>{const{body:o}=n;o.addEventListener("pointerup",Si,e),o.addEventListener("pointercancel",Si,e)})):Ft.forEach((r,n)=>{const{body:o}=n;r>0&&(o.addEventListener("pointerdown",zP,e),o.addEventListener("pointermove",_i,e))}))}function ns(t,e){Xn.forEach(r=>{const{setResizeHandlerState:n}=r,o=et.includes(r);n(t,o,e)})}function NP(){const[t,e]=g.useState(0);return g.useCallback(()=>e(r=>r+1),[])}function ee(t,e){if(!t)throw console.error(e),Error(e)}function br(t,e,r=al){return t.toFixed(r)===e.toFixed(r)?0:t>e?1:-1}function _t(t,e,r=al){return br(t,e,r)===0}function Le(t,e,r){return br(t,e,r)===0}function DP(t,e,r){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++){const o=t[n],s=e[n];if(!Le(o,s,r))return!1}return!0}function Yr({panelConstraints:t,panelIndex:e,size:r}){const n=t[e];ee(n!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:o=0,collapsible:s,maxSize:i=100,minSize:a=0}=n;if(br(r,a)<0)if(s){const l=(o+a)/2;br(r,l)<0?r=o:r=a}else r=a;return r=Math.min(i,r),r=parseFloat(r.toFixed(al)),r}function On({delta:t,initialLayout:e,panelConstraints:r,pivotIndices:n,prevLayout:o,trigger:s}){if(Le(t,0))return e;const i=[...e],[a,l]=n;ee(a!=null,"Invalid first pivot index"),ee(l!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const d=t<0?l:a,h=r[d];ee(h,`Panel constraints not found for index ${d}`);const{collapsedSize:p=0,collapsible:y,minSize:m=0}=h;if(y){const v=e[d];if(ee(v!=null,`Previous layout not found for panel index ${d}`),Le(v,p)){const w=m-v;br(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}{const d=t<0?a:l,h=r[d];ee(h,`No panel constraints found for index ${d}`);const{collapsedSize:p=0,collapsible:y,minSize:m=0}=h;if(y){const v=e[d];if(ee(v!=null,`Previous layout not found for panel index ${d}`),Le(v,m)){const w=v-p;br(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}}{const d=t<0?1:-1;let h=t<0?l:a,p=0;for(;;){const m=e[h];ee(m!=null,`Previous layout not found for panel index ${h}`);const w=Yr({panelConstraints:r,panelIndex:h,size:100})-m;if(p+=w,h+=d,h<0||h>=r.length)break}const y=Math.min(Math.abs(t),Math.abs(p));t=t<0?0-y:y}{let h=t<0?a:l;for(;h>=0&&h<r.length;){const p=Math.abs(t)-Math.abs(c),y=e[h];ee(y!=null,`Previous layout not found for panel index ${h}`);const m=y-p,v=Yr({panelConstraints:r,panelIndex:h,size:m});if(!Le(y,v)&&(c+=y-v,i[h]=v,c.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?h--:h++}}if(DP(o,i))return o;{const d=t<0?l:a,h=e[d];ee(h!=null,`Previous layout not found for panel index ${d}`);const p=h+c,y=Yr({panelConstraints:r,panelIndex:d,size:p});if(i[d]=y,!Le(y,p)){let m=p-y,w=t<0?l:a;for(;w>=0&&w<r.length;){const S=i[w];ee(S!=null,`Previous layout not found for panel index ${w}`);const b=S+m,x=Yr({panelConstraints:r,panelIndex:w,size:b});if(Le(S,x)||(m-=x-S,i[w]=x),Le(m,0))break;t>0?w--:w++}}}const u=i.reduce((d,h)=>h+d,0);return Le(u,100)?i:o}function LP({layout:t,panelsArray:e,pivotIndices:r}){let n=0,o=100,s=0,i=0;const a=r[0];ee(a!=null,"No pivot index found"),e.forEach((d,h)=>{const{constraints:p}=d,{maxSize:y=100,minSize:m=0}=p;h===a?(n=m,o=y):(s+=m,i+=y)});const l=Math.min(o,100-s),c=Math.max(n,100-i),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function Jn(t,e=document){return Array.from(e.querySelectorAll(`[${ve.resizeHandleId}][data-panel-group-id="${t}"]`))}function Dp(t,e,r=document){const o=Jn(t,r).findIndex(s=>s.getAttribute(ve.resizeHandleId)===e);return o??null}function Lp(t,e,r){const n=Dp(t,e,r);return n!=null?[n,n+1]:[-1,-1]}function MP(t){return t instanceof HTMLElement?!0:typeof t=="object"&&t!==null&&"tagName"in t&&"getAttribute"in t}function Mp(t,e=document){if(MP(e)&&e.dataset.panelGroupId==t)return e;const r=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return r||null}function Cs(t,e=document){const r=e.querySelector(`[${ve.resizeHandleId}="${t}"]`);return r||null}function BP(t,e,r,n=document){var o,s,i,a;const l=Cs(e,n),c=Jn(t,n),u=l?c.indexOf(l):-1,d=(o=(s=r[u])===null||s===void 0?void 0:s.id)!==null&&o!==void 0?o:null,h=(i=(a=r[u+1])===null||a===void 0?void 0:a.id)!==null&&i!==void 0?i:null;return[d,h]}function FP({committedValuesRef:t,eagerValuesRef:e,groupId:r,layout:n,panelDataArray:o,panelGroupElement:s,setLayout:i}){g.useRef({didWarnAboutMissingResizeHandle:!1}),hr(()=>{if(!s)return;const a=Jn(r,s);for(let l=0;l<o.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=LP({layout:n,panelsArray:o,pivotIndices:[l,l+1]}),h=a[l];if(h!=null){const p=o[l];ee(p,`No panel data found for index "${l}"`),h.setAttribute("aria-controls",p.id),h.setAttribute("aria-valuemax",""+Math.round(c)),h.setAttribute("aria-valuemin",""+Math.round(u)),h.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[r,n,o,s]),g.useEffect(()=>{if(!s)return;const a=e.current;ee(a,"Eager values not found");const{panelDataArray:l}=a,c=Mp(r,s);ee(c!=null,`No group found for id "${r}"`);const u=Jn(r,s);ee(u,`No resize handles found for group id "${r}"`);const d=u.map(h=>{const p=h.getAttribute(ve.resizeHandleId);ee(p,"Resize handle element has no handle id attribute");const[y,m]=BP(r,p,l,s);if(y==null||m==null)return()=>{};const v=w=>{if(!w.defaultPrevented)switch(w.key){case"Enter":{w.preventDefault();const S=l.findIndex(b=>b.id===y);if(S>=0){const b=l[S];ee(b,`No panel data found for index ${S}`);const x=n[S],{collapsedSize:k=0,collapsible:C,minSize:_=0}=b.constraints;if(x!=null&&C){const j=On({delta:Le(x,k)?_-k:k-x,initialLayout:n,panelConstraints:l.map(M=>M.constraints),pivotIndices:Lp(r,p,s),prevLayout:n,trigger:"keyboard"});n!==j&&i(j)}}break}}};return h.addEventListener("keydown",v),()=>{h.removeEventListener("keydown",v)}});return()=>{d.forEach(h=>h())}},[s,t,e,r,n,o,i])}function Mu(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Bp(t,e){const r=t==="horizontal",{x:n,y:o}=Ss(e);return r?n:o}function UP(t,e,r,n,o){const s=r==="horizontal",i=Cs(e,o);ee(i,`No resize handle element found for id "${e}"`);const a=i.getAttribute(ve.groupId);ee(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=n;const c=Bp(r,t),u=Mp(a,o);ee(u,`No group element found for id "${a}"`);const d=u.getBoundingClientRect(),h=s?d.width:d.height;return(c-l)/h*100}function HP(t,e,r,n,o,s){if(Tp(t)){const i=r==="horizontal";let a=0;t.shiftKey?a=100:o!=null?a=o:a=10;let l=0;switch(t.key){case"ArrowDown":l=i?0:a;break;case"ArrowLeft":l=i?-a:0;break;case"ArrowRight":l=i?a:0;break;case"ArrowUp":l=i?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return n==null?0:UP(t,e,r,n,s)}function WP({panelDataArray:t}){const e=Array(t.length),r=t.map(s=>s.constraints);let n=0,o=100;for(let s=0;s<t.length;s++){const i=r[s];ee(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;a!=null&&(n++,e[s]=a,o-=a)}for(let s=0;s<t.length;s++){const i=r[s];ee(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;if(a!=null)continue;const l=t.length-n,c=o/l;n++,e[s]=c,o-=c}return e}function Ur(t,e,r){e.forEach((n,o)=>{const s=t[o];ee(s,`Panel data not found for index ${o}`);const{callbacks:i,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:u}=a,d=r[l];if(d==null||n!==d){r[l]=n;const{onCollapse:h,onExpand:p,onResize:y}=i;y&&y(n,d),u&&(h||p)&&(p&&(d==null||_t(d,c))&&!_t(n,c)&&p(),h&&(d==null||!_t(d,c))&&_t(n,c)&&h())}})}function Ao(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0}function GP({defaultSize:t,dragState:e,layout:r,panelData:n,panelIndex:o,precision:s=3}){const i=r[o];let a;return i==null?a=t!=null?t.toPrecision(s):"1":n.length===1?a="1":a=i.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function qP(t,e=10){let r=null;return(...o)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{t(...o)},e)}}function Bu(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,r)=>{localStorage.setItem(e,r)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function Fp(t){return`react-resizable-panels:${t}`}function Up(t){return t.map(e=>{const{constraints:r,id:n,idIsFromProps:o,order:s}=e;return o?n:s?`${s}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((e,r)=>e.localeCompare(r)).join(",")}function Hp(t,e){try{const r=Fp(t),n=e.getItem(r);if(n){const o=JSON.parse(n);if(typeof o=="object"&&o!=null)return o}}catch{}return null}function VP(t,e,r){var n,o;const s=(n=Hp(t,r))!==null&&n!==void 0?n:{},i=Up(e);return(o=s[i])!==null&&o!==void 0?o:null}function KP(t,e,r,n,o){var s;const i=Fp(t),a=Up(e),l=(s=Hp(t,o))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{o.setItem(i,JSON.stringify(l))}catch(c){console.error(c)}}function Fu({layout:t,panelConstraints:e}){const r=[...t],n=r.reduce((s,i)=>s+i,0);if(r.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${r.map(s=>`${s}%`).join(", ")}`);if(!Le(n,100)&&r.length>0)for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=100/n*i;r[s]=a}let o=0;for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=Yr({panelConstraints:e,panelIndex:s,size:i});i!=a&&(o+=i-a,r[s]=a)}if(!Le(o,0))for(let s=0;s<e.length;s++){const i=r[s];ee(i!=null,`No layout data found for index ${s}`);const a=i+o,l=Yr({panelConstraints:e,panelIndex:s,size:a});if(i!==l&&(o-=l-i,r[s]=l,Le(o,0)))break}return r}const XP=100,In={getItem:t=>(Bu(In),In.getItem(t)),setItem:(t,e)=>{Bu(In),In.setItem(t,e)}},Uu={};function Wp({autoSaveId:t=null,children:e,className:r="",direction:n,forwardedRef:o,id:s=null,onLayout:i=null,keyboardResizeBy:a=null,storage:l=In,style:c,tagName:u="div",...d}){const h=ll(s),p=g.useRef(null),[y,m]=g.useState(null),[v,w]=g.useState([]),S=NP(),b=g.useRef({}),x=g.useRef(new Map),k=g.useRef(0),C=g.useRef({autoSaveId:t,direction:n,dragState:y,id:h,keyboardResizeBy:a,onLayout:i,storage:l}),_=g.useRef({layout:v,panelDataArray:[],panelDataArrayChanged:!1});g.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),g.useImperativeHandle(o,()=>({getId:()=>C.current.id,getLayout:()=>{const{layout:P}=_.current;return P},setLayout:P=>{const{onLayout:A}=C.current,{layout:T,panelDataArray:O}=_.current,R=Fu({layout:P,panelConstraints:O.map(D=>D.constraints)});Mu(T,R)||(w(R),_.current.layout=R,A&&A(R),Ur(O,R,b.current))}}),[]),hr(()=>{C.current.autoSaveId=t,C.current.direction=n,C.current.dragState=y,C.current.id=h,C.current.onLayout=i,C.current.storage=l}),FP({committedValuesRef:C,eagerValuesRef:_,groupId:h,layout:v,panelDataArray:_.current.panelDataArray,setLayout:w,panelGroupElement:p.current}),g.useEffect(()=>{const{panelDataArray:P}=_.current;if(t){if(v.length===0||v.length!==P.length)return;let A=Uu[t];A==null&&(A=qP(KP,XP),Uu[t]=A);const T=[...P],O=new Map(x.current);A(t,T,O,v,l)}},[t,v,l]),g.useEffect(()=>{});const j=g.useCallback(P=>{const{onLayout:A}=C.current,{layout:T,panelDataArray:O}=_.current;if(P.constraints.collapsible){const R=O.map(He=>He.constraints),{collapsedSize:D=0,panelSize:ne,pivotIndices:de}=nr(O,P,T);if(ee(ne!=null,`Panel size not found for panel "${P.id}"`),!_t(ne,D)){x.current.set(P.id,ne);const We=qr(O,P)===O.length-1?ne-D:D-ne,he=On({delta:We,initialLayout:T,panelConstraints:R,pivotIndices:de,prevLayout:T,trigger:"imperative-api"});Ao(T,he)||(w(he),_.current.layout=he,A&&A(he),Ur(O,he,b.current))}}},[]),M=g.useCallback((P,A)=>{const{onLayout:T}=C.current,{layout:O,panelDataArray:R}=_.current;if(P.constraints.collapsible){const D=R.map(Ke=>Ke.constraints),{collapsedSize:ne=0,panelSize:de=0,minSize:He=0,pivotIndices:We}=nr(R,P,O),he=A??He;if(_t(de,ne)){const Ke=x.current.get(P.id),yn=Ke!=null&&Ke>=he?Ke:he,Ps=qr(R,P)===R.length-1?de-yn:yn-de,Oe=On({delta:Ps,initialLayout:O,panelConstraints:D,pivotIndices:We,prevLayout:O,trigger:"imperative-api"});Ao(O,Oe)||(w(Oe),_.current.layout=Oe,T&&T(Oe),Ur(R,Oe,b.current))}}},[]),N=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{panelSize:O}=nr(T,P,A);return ee(O!=null,`Panel size not found for panel "${P.id}"`),O},[]),G=g.useCallback((P,A)=>{const{panelDataArray:T}=_.current,O=qr(T,P);return GP({defaultSize:A,dragState:y,layout:v,panelData:T,panelIndex:O})},[y,v]),I=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{collapsedSize:O=0,collapsible:R,panelSize:D}=nr(T,P,A);return ee(D!=null,`Panel size not found for panel "${P.id}"`),R===!0&&_t(D,O)},[]),re=g.useCallback(P=>{const{layout:A,panelDataArray:T}=_.current,{collapsedSize:O=0,collapsible:R,panelSize:D}=nr(T,P,A);return ee(D!=null,`Panel size not found for panel "${P.id}"`),!R||br(D,O)>0},[]),B=g.useCallback(P=>{const{panelDataArray:A}=_.current;A.push(P),A.sort((T,O)=>{const R=T.order,D=O.order;return R==null&&D==null?0:R==null?-1:D==null?1:R-D}),_.current.panelDataArrayChanged=!0,S()},[S]);hr(()=>{if(_.current.panelDataArrayChanged){_.current.panelDataArrayChanged=!1;const{autoSaveId:P,onLayout:A,storage:T}=C.current,{layout:O,panelDataArray:R}=_.current;let D=null;if(P){const de=VP(P,R,T);de&&(x.current=new Map(Object.entries(de.expandToSizes)),D=de.layout)}D==null&&(D=WP({panelDataArray:R}));const ne=Fu({layout:D,panelConstraints:R.map(de=>de.constraints)});Mu(O,ne)||(w(ne),_.current.layout=ne,A&&A(ne),Ur(R,ne,b.current))}}),hr(()=>{const P=_.current;return()=>{P.layout=[]}},[]);const X=g.useCallback(P=>{let A=!1;const T=p.current;return T&&window.getComputedStyle(T,null).getPropertyValue("direction")==="rtl"&&(A=!0),function(R){R.preventDefault();const D=p.current;if(!D)return()=>null;const{direction:ne,dragState:de,id:He,keyboardResizeBy:We,onLayout:he}=C.current,{layout:Ke,panelDataArray:yn}=_.current,{initialLayout:lo}=de??{},Ps=Lp(He,P,D);let Oe=HP(R,P,ne,de,We,D);const dl=ne==="horizontal";dl&&A&&(Oe=-Oe);const qp=yn.map(Vp=>Vp.constraints),vn=On({delta:Oe,initialLayout:lo??Ke,panelConstraints:qp,pivotIndices:Ps,prevLayout:Ke,trigger:Tp(R)?"keyboard":"mouse-or-touch"}),hl=!Ao(Ke,vn);(Rp(R)||Ap(R))&&k.current!=Oe&&(k.current=Oe,!hl&&Oe!==0?dl?ki(P,Oe<0?Ip:jp):ki(P,Oe<0?$p:zp):ki(P,0)),hl&&(w(vn),_.current.layout=vn,he&&he(vn),Ur(yn,vn,b.current))}},[]),q=g.useCallback((P,A)=>{const{onLayout:T}=C.current,{layout:O,panelDataArray:R}=_.current,D=R.map(Ke=>Ke.constraints),{panelSize:ne,pivotIndices:de}=nr(R,P,O);ee(ne!=null,`Panel size not found for panel "${P.id}"`);const We=qr(R,P)===R.length-1?ne-A:A-ne,he=On({delta:We,initialLayout:O,panelConstraints:D,pivotIndices:de,prevLayout:O,trigger:"imperative-api"});Ao(O,he)||(w(he),_.current.layout=he,T&&T(he),Ur(R,he,b.current))},[]),se=g.useCallback((P,A)=>{const{layout:T,panelDataArray:O}=_.current,{collapsedSize:R=0,collapsible:D}=A,{collapsedSize:ne=0,collapsible:de,maxSize:He=100,minSize:We=0}=P.constraints,{panelSize:he}=nr(O,P,T);he!=null&&(D&&de&&_t(he,R)?_t(R,ne)||q(P,ne):he<We?q(P,We):he>He&&q(P,He))},[q]),K=g.useCallback((P,A)=>{const{direction:T}=C.current,{layout:O}=_.current;if(!p.current)return;const R=Cs(P,p.current);ee(R,`Drag handle element not found for id "${P}"`);const D=Bp(T,A);m({dragHandleId:P,dragHandleRect:R.getBoundingClientRect(),initialCursorPosition:D,initialLayout:O})},[]),ie=g.useCallback(()=>{m(null)},[]),ue=g.useCallback(P=>{const{panelDataArray:A}=_.current,T=qr(A,P);T>=0&&(A.splice(T,1),delete b.current[P.id],_.current.panelDataArrayChanged=!0,S())},[S]),le=g.useMemo(()=>({collapsePanel:j,direction:n,dragState:y,expandPanel:M,getPanelSize:N,getPanelStyle:G,groupId:h,isPanelCollapsed:I,isPanelExpanded:re,reevaluatePanelConstraints:se,registerPanel:B,registerResizeHandle:X,resizePanel:q,startDragging:K,stopDragging:ie,unregisterPanel:ue,panelGroupElement:p.current}),[j,y,n,M,N,G,h,I,re,se,B,X,q,K,ie,ue]),E={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return g.createElement(_s.Provider,{value:le},g.createElement(u,{...d,children:e,className:r,id:s,ref:p,style:{...E,...c},[ve.group]:"",[ve.groupDirection]:n,[ve.groupId]:h}))}const Gp=g.forwardRef((t,e)=>g.createElement(Wp,{...t,forwardedRef:e}));Wp.displayName="PanelGroup";Gp.displayName="forwardRef(PanelGroup)";function qr(t,e){return t.findIndex(r=>r===e||r.id===e.id)}function nr(t,e,r){const n=qr(t,e),s=n===t.length-1?[n-1,n]:[n,n+1],i=r[n];return{...e.constraints,panelSize:i,pivotIndices:s}}function JP({disabled:t,handleId:e,resizeHandler:r,panelGroupElement:n}){g.useEffect(()=>{if(t||r==null||n==null)return;const o=Cs(e,n);if(o==null)return;const s=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),r(i);break}case"F6":{i.preventDefault();const a=o.getAttribute(ve.groupId);ee(a,`No group element found for id "${a}"`);const l=Jn(a,n),c=Dp(a,e,n);ee(c!==null,`No resize element found for id "${e}"`);const u=i.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return o.addEventListener("keydown",s),()=>{o.removeEventListener("keydown",s)}},[n,t,e,r])}function fa({children:t=null,className:e="",disabled:r=!1,hitAreaMargins:n,id:o,onBlur:s,onClick:i,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:u,style:d={},tabIndex:h=0,tagName:p="div",...y}){var m,v;const w=g.useRef(null),S=g.useRef({onClick:i,onDragging:a,onPointerDown:c,onPointerUp:u});g.useEffect(()=>{S.current.onClick=i,S.current.onDragging=a,S.current.onPointerDown=c,S.current.onPointerUp=u});const b=g.useContext(_s);if(b===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:x,groupId:k,registerResizeHandle:C,startDragging:_,stopDragging:j,panelGroupElement:M}=b,N=ll(o),[G,I]=g.useState("inactive"),[re,B]=g.useState(!1),[X,q]=g.useState(null),se=g.useRef({state:G});hr(()=>{se.current.state=G}),g.useEffect(()=>{if(r)q(null);else{const le=C(N);q(()=>le)}},[r,N,C]);const K=(m=n?.coarse)!==null&&m!==void 0?m:15,ie=(v=n?.fine)!==null&&v!==void 0?v:5;g.useEffect(()=>{if(r||X==null)return;const le=w.current;ee(le,"Element ref not attached");let E=!1;return $P(N,le,x,{coarse:K,fine:ie},(A,T,O)=>{if(!T){I("inactive");return}switch(A){case"down":{I("drag"),E=!1,ee(O,'Expected event to be defined for "down" action'),_(N,O);const{onDragging:R,onPointerDown:D}=S.current;R?.(!0),D?.();break}case"move":{const{state:R}=se.current;E=!0,R!=="drag"&&I("hover"),ee(O,'Expected event to be defined for "move" action'),X(O);break}case"up":{I("hover"),j();const{onClick:R,onDragging:D,onPointerUp:ne}=S.current;D?.(!1),ne?.(),E||R?.();break}}})},[K,x,r,ie,C,N,X,_,j]),JP({disabled:r,handleId:N,resizeHandler:X,panelGroupElement:M});const ue={touchAction:"none",userSelect:"none"};return g.createElement(p,{...y,children:t,className:e,id:o,onBlur:()=>{B(!1),s?.()},onFocus:()=>{B(!0),l?.()},ref:w,role:"separator",style:{...ue,...d},tabIndex:h,[ve.groupDirection]:x,[ve.groupId]:k,[ve.resizeHandle]:"",[ve.resizeHandleActive]:G==="drag"?"pointer":re?"keyboard":void 0,[ve.resizeHandleEnabled]:!r,[ve.resizeHandleId]:N,[ve.resizeHandleState]:G})}fa.displayName="PanelResizeHandle";const YP=Lg(()=>Ut(()=>import("./JsonRoomEditor-C1XSmQua.js").then(t=>t.J),__vite__mapDeps([8,1,2,6,9]))),ZP=g.lazy(YP),QP=()=>{_P();const t=f.jsx("div",{className:"flex h-full items-center justify-center bg-pureBlack",children:f.jsx("span",{className:"sprite texture-animated-head_walking_right"})});return f.jsx(f.Fragment,{children:f.jsx(Ua,{children:f.jsxs(Gp,{direction:"horizontal",className:"w-full h-full",children:[f.jsx(Ho,{id:"jsonEditor",defaultSize:18,minSize:12,collapsible:!0,children:f.jsx(g.Suspense,{fallback:t,children:f.jsx(ZP,{})})}),f.jsx(fa,{className:"scale-editor w-1 bg-metallicBlueHalfbrite  hover:border-moss hover:bg-moss border-r-[calc(1px*var(--scale))] border-metallicBlue"}),f.jsx(Ho,{id:"editingArea",children:f.jsx(LC,{children:f.jsx(zC,{children:f.jsx(xP,{})})})}),f.jsx(fa,{className:"scale-editor w-1 bg-metallicBlueHalfbrite  hover:border-moss hover:bg-moss border-l-[calc(1px*var(--scale))] border-metallicBlue"}),f.jsx(Ho,{id:"toolbar",defaultSize:20,maxSize:33,minSize:10,children:f.jsx(N_,{})})]})})})},pE=Object.freeze(Object.defineProperty({__proto__:null,default:QP},Symbol.toStringTag,{value:"Module"}));export{kd as A,xd as C,Yt as F,pE as L,Ca as R,Tm as S,Cd as V,jm as a,fE as b,aE as h,me as t,Em as u};
