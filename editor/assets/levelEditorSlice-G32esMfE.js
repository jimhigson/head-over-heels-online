import{a5 as M,a6 as se,a7 as D,a8 as F,a9 as G,aa as A,ab as q,ac as Ue,ad as mo,ae as J,af as Ye,ag as Ve,ah as yo,ai as po,aj as go,ak as ho,al as Io,am as L,an as vo,ao as Ae,ap as U,aq as Ke,ar as xo,as as wo,at as Ze,au as bo,av as Qe,aw as Ro,ax as Eo,ay as zo}from"./index-BR7Uz2db.js";var Y={},V={},Se;function ko(){if(Se)return V;Se=1;function e(c,p){var i;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(i=o(c))||p){i&&(c=i);var f=0,n=function(){};return{s:n,n:function(){return f>=c.length?{done:!0}:{done:!1,value:c[f++]}},e:function(y){throw y},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,u=!1,m;return{s:function(){i=c[Symbol.iterator]()},n:function(){var y=i.next();return d=y.done,y},e:function(y){u=!0,m=y},f:function(){try{!d&&i.return!=null&&i.return()}finally{if(u)throw m}}}}function o(c,p){if(c){if(typeof c=="string")return t(c,p);var i=Object.prototype.toString.call(c).slice(8,-1);if(i==="Object"&&c.constructor&&(i=c.constructor.name),i==="Map"||i==="Set")return Array.from(c);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(c,p)}}function t(c,p){(p==null||p>c.length)&&(p=c.length);for(var i=0,f=new Array(p);i<p;i++)f[i]=c[i];return f}var r=M(),s=r.ensureIterable;function a(c){var p=[],i=e(c),f;try{for(i.s();!(f=i.n()).done;){var n=f.value;p.push(n)}}catch(d){i.e(d)}finally{i.f()}return p}V.__toArray=a;function l(c){return a(s(c))}return V.toArray=l,V}var Ce;function Ao(){if(Ce)return Y;Ce=1;var e=se(),o=e.mark(l),t=M(),r=t.iterableCurry,s=ko(),a=s.__toArray;function l(p,i){var f;return e.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(f=Array.isArray(p)?p:a(p),f.length){d.next=3;break}return d.abrupt("return");case 3:if(!i--){d.next=7;break}return d.delegateYield(f,"t0",5);case 5:d.next=3;break;case 7:case"end":return d.stop()}},o)}Y.__cycleTimes=l;var c=r(l);return Y.cycleTimes=c,Y}var K={},Pe;function So(){if(Pe)return K;Pe=1;var e=se(),o=e.mark(c);function t(i,f){var n;if(typeof Symbol>"u"||i[Symbol.iterator]==null){if(Array.isArray(i)||(n=r(i))||f){n&&(i=n);var d=0,u=function(){};return{s:u,n:function(){return d>=i.length?{done:!0}:{done:!1,value:i[d++]}},e:function(g){throw g},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,h=!1,y;return{s:function(){n=i[Symbol.iterator]()},n:function(){var g=n.next();return m=g.done,g},e:function(g){h=!0,y=g},f:function(){try{!m&&n.return!=null&&n.return()}finally{if(h)throw y}}}}function r(i,f){if(i){if(typeof i=="string")return s(i,f);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(i,f)}}function s(i,f){(f==null||f>i.length)&&(f=i.length);for(var n=0,d=new Array(f);n<f;n++)d[n]=i[n];return d}var a=M(),l=a.iterableCurry;function c(i,f){var n,d,u,m;return e.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:n=0,d=t(i),y.prev=2,d.s();case 4:if((u=d.n()).done){y.next=11;break}if(m=u.value,!f(m,n++)){y.next=9;break}return y.next=9,m;case 9:y.next=4;break;case 11:y.next=16;break;case 13:y.prev=13,y.t0=y.catch(2),d.e(y.t0);case 16:return y.prev=16,d.f(),y.finish(16);case 19:case"end":return y.stop()}},o,null,[[2,13,16,19]])}K.__filter=c;var p=l(c);return K.filter=p,K}var Z={},Te;function Co(){if(Te)return Z;Te=1;var e=M(),o=e.iterableCurry,t=Ao(),r=t.__cycleTimes;function s(l){return r(l,1/0)}Z.__cycle=s;var a=o(s);return Z.cycle=a,Z}var Q={},Fe;function Po(){if(Fe)return Q;Fe=1;var e=se(),o=e.mark(c);function t(i,f){var n;if(typeof Symbol>"u"||i[Symbol.iterator]==null){if(Array.isArray(i)||(n=r(i))||f){n&&(i=n);var d=0,u=function(){};return{s:u,n:function(){return d>=i.length?{done:!0}:{done:!1,value:i[d++]}},e:function(g){throw g},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,h=!1,y;return{s:function(){n=i[Symbol.iterator]()},n:function(){var g=n.next();return m=g.done,g},e:function(g){h=!0,y=g},f:function(){try{!m&&n.return!=null&&n.return()}finally{if(h)throw y}}}}function r(i,f){if(i){if(typeof i=="string")return s(i,f);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(i,f)}}function s(i,f){(f==null||f>i.length)&&(f=i.length);for(var n=0,d=new Array(f);n<f;n++)d[n]=i[n];return d}var a=M(),l=a.iterableCurry;function c(i,f){var n,d,u,m;return e.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:n=0,d=t(i),y.prev=2,d.s();case 4:if((u=d.n()).done){y.next=11;break}if(m=u.value,!(n++>=f)){y.next=9;break}return y.next=9,m;case 9:y.next=4;break;case 11:y.next=16;break;case 13:y.prev=13,y.t0=y.catch(2),d.e(y.t0);case 16:return y.prev=16,d.f(),y.finish(16);case 19:case"end":return y.stop()}},o,null,[[2,13,16,19]])}Q.__drop=c;var p=l(c);return Q.drop=p,Q}var ee={},oe={},Oe;function To(){if(Oe)return oe;Oe=1;var e=M(),o=e.iterableCurry,t=e.callReturn;function r(a,l){var c=a[Symbol.iterator](),p=c.next(),i=p.value,f=p.done;return f?l:(t(c),i)}oe.__firstOr=r;var s=o(r,{reduces:!0});return oe.firstOr=s,oe}var $e;function Fo(){if($e)return ee;$e=1;var e=M(),o=e.iterableCurry,t=To(),r=t.__firstOr;function s(l){return r(l,void 0)}ee.__first=s;var a=o(s,{reduces:!0});return ee.first=a,ee}var te={},We;function Oo(){if(We)return te;We=1;var e=se(),o=e.mark(c);function t(i,f){var n;if(typeof Symbol>"u"||i[Symbol.iterator]==null){if(Array.isArray(i)||(n=r(i))||f){n&&(i=n);var d=0,u=function(){};return{s:u,n:function(){return d>=i.length?{done:!0}:{done:!1,value:i[d++]}},e:function(g){throw g},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,h=!1,y;return{s:function(){n=i[Symbol.iterator]()},n:function(){var g=n.next();return m=g.done,g},e:function(g){h=!0,y=g},f:function(){try{!m&&n.return!=null&&n.return()}finally{if(h)throw y}}}}function r(i,f){if(i){if(typeof i=="string")return s(i,f);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(i,f)}}function s(i,f){(f==null||f>i.length)&&(f=i.length);for(var n=0,d=new Array(f);n<f;n++)d[n]=i[n];return d}var a=M(),l=a.iterableCurry;function c(i,f){var n,d,u,m;return e.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f!==0){y.next=2;break}return y.abrupt("return");case 2:n=0,d=t(i),y.prev=4,d.s();case 6:if((u=d.n()).done){y.next=14;break}return m=u.value,y.next=10,m;case 10:if(++n!==f){y.next=12;break}return y.abrupt("break",14);case 12:y.next=6;break;case 14:y.next=19;break;case 16:y.prev=16,y.t0=y.catch(4),d.e(y.t0);case 19:return y.prev=19,d.f(),y.finish(19);case 22:case"end":return y.stop()}},o,null,[[4,16,19,22]])}te.__take=c;var p=l(c);return te.take=p,te}var ce,_e;function $o(){return _e||(_e=1,ce=Co().cycle),ce}var Wo=$o();const _o=D(Wo);var le,Me;function Mo(){return Me||(Me=1,le=Po().drop),le}var qo=Mo();const No=D(qo);var de,qe;function Bo(){return qe||(qe=1,de=So().filter),de}var Ho=Bo();const Jo=D(Ho);var fe,Ne;function Lo(){return Ne||(Ne=1,fe=Fo().first),fe}var Xo=Lo();const he=D(Xo);var ue,Be;function jo(){return Be||(Be=1,ue=Oo().take),ue}var Do=jo();const Go=D(Do),P=e=>e.campaignInProgress.rooms[e.currentlyEditingRoomId],Ie=(e,o)=>e.campaignInProgress.rooms[o],eo=(e,o,t)=>e.campaignInProgress.rooms[t??e.currentlyEditingRoomId]?.items[o],Uo=(e,o)=>e.selectedJsonItemIds.includes(o),B=e=>{const o=structuredClone(F(P(e))),{history:t}=e;t.redo=[],t.undo.push(o)},Yo={undo(e){const o=e,{campaignInProgress:t,history:{undo:r,redo:s},currentlyEditingRoomId:a}=o;r.length!==0&&(s.push(t.rooms[a]),t.rooms[a]=r.pop())},redo(e){const o=e,{campaignInProgress:t,history:{redo:r,undo:s},currentlyEditingRoomId:a}=o;r.length!==0&&(s.push(t.rooms[a]),t.rooms[a]=r.pop())}},Vo={selectCanUndo:e=>e.history.undo.length>0,selectCanRedo:e=>e.history.redo.length>0},me={x:1,y:0,z:0},ye={x:-1,y:0,z:0},pe={x:0,y:-1,z:0},ge={x:0,y:1,z:0},X={away:ge,left:me,right:ye,towards:pe,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:G(A(ge,ye)),towardsRight:G(A(pe,ye)),towardsLeft:G(A(pe,me)),awayLeft:G(A(ge,me))},Hr={w:16,d:16,h:12},ne={x:16,y:16,z:12},Ko=(e,o,t)=>{if(o==="*")return!0;const r=t.meta.subRooms[o];return e.x>=r.physicalPosition.from.x&&e.y>=r.physicalPosition.from.y&&e.x<=r.physicalPosition.to.x&&e.y<=r.physicalPosition.to.y},Zo=({position:e},o,t)=>Ko(e,o,t),re=(e,o,t,r)=>o.some(s=>s.config.direction===e)?"doorway":t===void 0?"wall":Object.values(t).some(({gridPosition:s})=>yo(X[e],po(s,r)))?"open":"wall";function*N(e){try{yield*Qo(e)}catch(o){const t=o;throw new Error(`
  error in recursion ${e.roomId}/${e.subRoomId??"*"}`,{cause:t})}}function*Qo({roomId:e,subRoomId:o="*",campaign:t,visited:r={},vectorFromPrevious:s,previousRoomGridPosition:a=J}){if(e==="nowhere"||r[e]?.[o])return;r[e]===void 0&&(r[e]={}),r[e][o]=!0;const l=t.rooms[e];if(l===void 0)throw new Error(`no room in the campaign with id="${e}"`);const c=[...q(Ue(l.items)).filter(u=>u.type==="door").filter(u=>Zo(u,o,l))],p=A(a,s===void 0?mo:s),i=l.meta?.subRooms;if(i){if(o==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${e}: ${Object.keys(i)}`);if(!i[o])throw new Error(`Sub-room ${o} not found in room ${e}. Available sub-rooms: ${Object.keys(i)}`)}const f=i?.[o].gridPosition,n={left:re("left",c,i,f),right:re("right",c,i,f),away:re("away",c,i,f),towards:re("towards",c,i,f)};if(yield{roomId:e,subRoomId:o,gridPosition:p,boundaries:n},i!==void 0){if(f===void 0)throw new Error(`Sub-room ${o} not found in room ${e}. Available sub-rooms: ${Object.keys(i)}`);for(const[u,{gridPosition:m}]of q(Ye(i)))u!==o&&(yield*N({roomId:e,subRoomId:u,campaign:t,visited:r,vectorFromPrevious:Ve({...m,z:0},f),previousRoomGridPosition:p}))}if(l.roomAbove!==void 0){const{roomAbove:u,subRoomAbove:m}=l;yield*N({roomId:u,subRoomId:m,campaign:t,visited:r,vectorFromPrevious:X.up,previousRoomGridPosition:p})}if(l.roomBelow!==void 0){const{roomBelow:u,subRoomBelow:m}=l;yield*N({roomId:u,subRoomId:m,campaign:t,visited:r,vectorFromPrevious:X.down,previousRoomGridPosition:p})}for(const u of c){const{toRoom:m}=u.config;yield*N({roomId:m,campaign:t,visited:r,subRoomId:u.config.meta?.toSubRoom,vectorFromPrevious:X[u.config.direction],previousRoomGridPosition:p})}const d=l.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:u},gridOffset:m}=d;yield*N({roomId:u,campaign:t,visited:r,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:p})}}const et={jail:["bars"],blacktooth:["plain","plain","armour","shield","shield","armour"],bookworld:["book","book","cowboy"],egyptus:["hieroglyphics","hieroglyphics","hieroglyphics","sarcophagus","sarcophagus"],market:["passage","more-fruits","fruits","more-fruits","fruits"],moonbase:["coil","window1","window2","window3"],penitentiary:["loop","loop","skeleton"],safari:["wall","shield","wall","window","window","wall","shield"]},j=(e,o,t=0)=>{const r=_o(et[e]);return No(t,Go(o+t,r))},ot=e=>({awayWall:{type:"wall",config:{direction:"away",tiles:Array.from(j("blacktooth",e.x))},position:{x:0,y:e.y,z:0}},leftWall:{type:"wall",config:{direction:"left",tiles:Array.from(j("blacktooth",e.y))},position:{x:e.x,y:0,z:0}},towardsWall:{type:"wall",config:{direction:"towards",times:{x:e.x}},position:{x:0,y:0,z:0}},rightWall:{type:"wall",config:{direction:"right",times:{y:e.y}},position:{x:0,y:0,z:0}}}),oo=e=>({planet:"blacktooth",color:{hue:"cyan",shade:"basic"},items:{floor:{type:"floor",config:{floorType:"standable",scenery:"blacktooth",times:e},position:{x:0,y:0,z:0}},...ot(e)}}),to=(e,o)=>{e.planet=o;for(const t of Object.values(e.items))t.type==="floor"&&t.config.floorType==="standable"&&(t.config.scenery=o),t.type==="wall"&&(t.config.direction==="away"||t.config.direction==="left")&&(t.config.tiles=Array.from(j(o,t.config.tiles.length))),t.type==="pickup"&&t.config.gives==="crown"&&go.includes(o)&&(t.config.planet=o)},tt=e=>e[Math.floor(Math.random()*e.length)],xe=(e,o,t)=>{const s=`room_${q(ho({start:0})).find(c=>e.campaignInProgress.rooms[`room_${c}`]===void 0)}`,a=t??{hue:tt(Io),shade:Math.random()<.66?"basic":"dimmed"},l={id:s,...structuredClone(oo({x:8,y:8})),color:a};return to(l,o),e.campaignInProgress.rooms[s]=l,l},we=(e,o,t)=>{if(o.type==="player"){const{which:s}=o.config;return t?`preview-${s}`:s}const r=o.type==="monster"?o.config.which:o.type;for(let s=1;;s++){const a=s===1?r:`${r}_${s}`;if(!e.items[a])return a}},ve=(e,o,t,r)=>{const s=P(e),a=we(s,o,r),l=ro(e,r),c={type:o.type,config:o.config,position:t};return l[a]=c,[a,c]},ro=(e,o,t=e.currentlyEditingRoomId)=>o?e.previewedEdits:e.campaignInProgress.rooms[t].items,rt=["head","heels"],nt=[...rt,"headOverHeels"],S=(...e)=>o=>e.includes(o.type),it=S("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),st=(e,o)=>it(e)||yt(e)&&(o!==void 0&&dt(o)||e.config.direction.z!==0)||gt(e)&&e.config.floorType==="none",Jr=(e,o)=>!st(e,o),at=["ball","slidingBlock","slidingDeadly"];S(...at);const ct=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],lt=["dalek","turtle","elephantHead","homingBot","helicopterBug"],Lr=e=>e.type==="slidingBlock"?e.config.style==="puck":e.type==="monster"?lt.includes(e.config.which):ct.includes(e.type),dt=e=>e.type==="head"||e.type==="heels"||e.type==="headOverHeels";function Xr(e){return ft.includes(e.type)}const ft=[...nt,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],ut=["monster","deadlyBlock","moveableDeadly","slidingDeadly"];S(...ut);const mt=e=>e.config.times!==void 0,yt=S("portal");S("teleporter");S("heels");S("head");S("heels","headOverHeels");S("head","headOverHeels");S("lift");S("emitter");const pt=S("monster"),gt=S("floor");S("pickup");S("spring");const jr=S("joystick");S("monster","movingPlatform");const Dr=e=>pt(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1,ae=e=>({x:e.direction==="away"?e.tiles.length:e.direction==="towards"?e.times?.x:1,y:e.direction==="left"?e.tiles.length:e.direction==="right"?e.times?.y:1}),Gr=e=>e.type==="wall"?ae(e.config):mt(e)?e.config.times:void 0,He=(e=L)=>({x:e.x??1,y:e.y??1,z:e.z??1}),ht=e=>({x:e.x??1,y:e.y??1}),$=e=>{const o=t=>t.config.times!==void 0;return e.type==="wall"?He(ae(e.config)):o(e)?He(e.config.times):L},no=e=>{const o={};let t=!1;return e.x!==1&&(o.x=e.x,t=!0),e.y!==1&&(o.y=e.y,t=!0),e.z!==1&&(o.z=e.z,t=!0),t?o:void 0};function*io(e,o,t){for(const r of Ye(e)){const[s,a]=r;if(a===null||a.type!=="wall"||a.config.direction!==o)continue;const{position:l,config:c}=a,p=ht(ae(c)),i=vo(Ae(c.direction)),f=Ae(c.direction),n=Ve(t,l);if(n[f]!==0||n[i]<-1||n[i]>=p[i])continue;if(n[i]===0&&p[i]===2){yield[s,null];continue}const d=2+n[i];if(d===1||d===2){const g=U(a,x=>{x.position=A(l,{[i]:d});const v=x.config;switch(v.direction){case"towards":case"right":v.times[i]=p[i]-d;break;default:v.tiles=v.tiles.slice(d)}});yield[s,g];continue}const m=p[i]-n[i];if(m===2||m===1){const g=U(a,x=>{const v=x.config;switch(v.direction){case"towards":case"right":v.times[i]=p[i]-m;break;default:v.tiles=v.tiles.slice(0,-m)}});yield[s,g];continue}const y=U(a,g=>{const x=g.config;switch(x.direction){case"towards":case"right":x.times[i]=n[i];break;default:x.tiles=x.tiles.slice(0,n[i])}});yield[`${s}/beforeDoor`,y];const I=U(a,g=>{g.position={...l,[i]:t[i]+2};const x=g.config;switch(x.direction){case"towards":case"right":x.times[i]=p[i]-n[i]-2;break;default:x.tiles=x.tiles.slice(n[i]+2)}});yield[`${s}/afterDoor`,I],yield[s,null]}}const Je=(e,o,t,r,s)=>{const a=Ie(e,o);if(a===void 0)throw new Error("can't cut hole in walls for a room that does not exist");const l=ro(e,s,o);for(const[c,p]of io(a.items,t,r))s?l[c]=p:p===null?delete l[c]:l[c]=p},It=e=>Ue(e.items),vt=e=>Ke(e),xt=e=>q(It(e)),_=(e,...o)=>{const t=q(vt(e));return o.length===0?t:t.filter(([,r])=>o.includes(r.type))},wt=({state:e,fromRoomJson:o,direction:t,isPreview:r,autoAddRooms:s})=>{const a=e.campaignInProgress,l=q(N({campaign:a,roomId:o.id})).find(({gridPosition:c})=>wo(c,X[t]));if(l)return a.rooms[l.roomId];if(!r)return s?xe(e,o.planet):void 0},bt=e=>_(e.items,"floor").reduce((o,[,t])=>{const r=t.position.y;return Math.min(o,r)},Number.POSITIVE_INFINITY),Rt=e=>_(e.items,"floor").reduce((o,[,t])=>{const r=t.position.y+t.config.times.y;return Math.max(o,r)},Number.NEGATIVE_INFINITY),Et=e=>_(e.items,"floor").reduce((o,[,t])=>{const r=t.position.x;return Math.min(o,r)},Number.POSITIVE_INFINITY),zt=e=>_(e.items,"floor").reduce((o,[,t])=>{const r=t.position.x+t.config.times.x;return Math.max(o,r)},Number.NEGATIVE_INFINITY),kt=(e,o,t,r,s)=>{const a=P(e),l=t;Je(e,a.id,l,o,s);const c=r.config.toRoom==="+";console.log("autoAddRooms:",c);const p=wt({state:e,fromRoomJson:a,direction:l,isPreview:s,autoAddRooms:c}),[i,f]=ve(e,{type:"door",config:{...r.config,toRoom:p?p.id:r.config.toRoom,direction:l}},o,s);if(!s&&p){const n=we(p,r,s),d={x:l==="left"?Et(p):l==="right"?zt(p):o.x,y:l==="away"?bt(p):l==="towards"?Rt(p):o.y,z:o.z},u=xo(l),m={type:"door",config:{toRoom:a.id,direction:u},position:d};p.items[n]=m,m.config.toDoor=i,f.config.toDoor=n,Je(e,p.id,u,d,!1)}};function Le(e){var o="";return t(e),o;function t(s){if(s===null||typeof s!="object"||s.toJSON!=null)o+=JSON.stringify(s);else if(Array.isArray(s)){o+="[";var a=!1;s.forEach(function(c){a&&(o+=","),a=!0,c===void 0&&(c=null),t(c)}),o+="]"}else{o+="{";var l=Object.keys(s).filter(function(c){return s[c]!==void 0}).sort();l.forEach(function(c,p){return r(s,c,p)}),o+="}"}}function r(s,a,l){l>0&&(o+=","),o+=JSON.stringify(a),o+=":",t(s[a])}}const Ur=(e,...o)=>{const t={};for(const r of o)t[r]=e[r];return t},Xe=(e,...o)=>{const t={...e};for(const r of o)delete t[r];return t},be=e=>Ze(Re(e))>0,Re=e=>{switch(e.type){case"deadlyBlock":return L;case"conveyor":if(e.config.disappearing)return J;switch(e.config.direction){case"left":case"right":return{x:1,y:0,z:0};case"away":case"towards":return{x:0,y:1,z:0};default:throw e.config.direction,new Error}case"hushPuppy":return L;case"teleporter":return{x:1,y:1,z:0};case"floor":case"spikes":return{x:1,y:1,z:0};case"block":return e.config.disappearing?J:L;case"barrier":if(e.config.disappearing)return J;switch(e.config.axis){case"x":return{x:1,y:0,z:1};case"y":return{x:0,y:1,z:1};default:throw e.config.axis,new Error}case"wall":switch(e.config.direction){case"left":case"right":return{x:0,y:1,z:1};case"away":case"towards":return{x:1,y:0,z:1};default:throw e.config,new Error}default:return J}};class ie{#t;#o;#e;constructor(o,t){this.#o={x:-o.x,y:-o.y,z:-o.z},this.#e={x:t.x-o.x+1,y:t.y-o.y+1,z:t.z-o.z+1},this.#t=Array.from({length:this.#e.x},()=>Array.from({length:this.#e.y},()=>Array.from({length:this.#e.z},()=>new Set)))}static fromItems(o){let t=1/0,r=1/0,s=1/0,a=-1/0,l=-1/0,c=-1/0;const p=[...o];for(const[,f]of p){const{x:n,y:d,z:u}=f.position,m=$(f);t=Math.min(t,n),r=Math.min(r,d),s=Math.min(s,u),a=Math.max(a,n+m.x-1),l=Math.max(l,d+m.y-1),c=Math.max(c,u+m.z-1)}if(p.length===0)return new ie({x:0,y:0,z:0},{x:0,y:0,z:0});const i=new ie({x:t,y:r,z:s},{x:a,y:l,z:c});for(const f of p){const[,n]=f,{x:d,y:u,z:m}=n.position,h=$(n);for(let y=0;y<h.x;y++)for(let I=0;I<h.y;I++)for(let g=0;g<h.z;g++)i.add({x:d+y,y:u+I,z:m+g},f)}return i}get(o){const t=o.x+this.#o.x,r=o.y+this.#o.y,s=o.z+this.#o.z;if(this.#r(t,r,s))return this.#t[t][r][s]}set(o,t){const r=o.x+this.#o.x,s=o.y+this.#o.y,a=o.z+this.#o.z;this.#r(r,s,a)&&(this.#t[r][s][a]=t)}add(o,t){const r=this.get(o);r&&r.add(t)}remove(o,t){const r=this.get(o);r&&r.delete(t)}get size(){return{...this.#e}}get minBounds(){return{x:-this.#o.x,y:-this.#o.y,z:-this.#o.z}}get maxBounds(){const o=this.minBounds;return{x:o.x+this.#e.x-1,y:o.y+this.#e.y-1,z:o.z+this.#e.z-1}}*iterate(){const{minBounds:o}=this;for(let t=0;t<this.#e.x;t++)for(let r=0;r<this.#e.y;r++)for(let s=0;s<this.#e.z;s++)yield[{x:t+o.x,y:r+o.y,z:s+o.z},this.#t[t][r][s]]}extractUniqueItems(){const o=new Set,t=[];for(const[,r]of this.iterate())for(const s of r)o.has(s)||(o.add(s),t.push(s));return t}#r(o,t,r){return o>=0&&o<this.#e.x&&t>=0&&t<this.#e.y&&r>=0&&r<this.#e.z}}const O=e=>e.type==="wall"?`wall/${e.config.direction}`:e.type==="teleporter"?Le({type:e.type,config:Xe(e.config,"toPosition","times")}):Le({type:e.type,config:Xe(e.config,"times")}),At=e=>be(e[1]),St=e=>({x:Math.floor(e.x%1*ne.x),y:Math.floor(e.y%1*ne.y)}),Ct=(e,o)=>`${e},${o}`,Pt=e=>{let o=e,t=o.length;for(;;){const r=[...Ft(o)];if(r.length===t)return r;t=r.length,o=r}},Tt=e=>{const o=new Map,t=[];for(const s of e){const[,a]=s;if(be(a)){const l=St(a.position),c=Ct(l.x,l.y);o.has(c)||o.set(c,[]),o.get(c).push(s)}else t.push(s)}const r=[];for(const[s,a]of o)if(a.length>0){const l=a.map(([d,u])=>[d,{...u,position:{x:Math.floor(u.position.x),y:Math.floor(u.position.y),z:u.position.z}}]),c=Pt(l),[p,i]=s.split(",").map(Number),f=p/ne.x,n=i/ne.y;for(const[d,u]of c)r.push([d,{...u,position:{x:u.position.x+f,y:u.position.y+n,z:u.position.z}}])}return[...r,...t]},Ft=e=>{const o=[],t=[];for(const n of e)At(n)?o.push(n):t.push(n);const r=ie.fromItems(o),s=r.size,{minBounds:a}=r,l=new Map,c=new Map;for(const[,n]of r.iterate())for(const[,d]of n){const u=O(d);c.has(u)||c.set(u,d)}for(const[n]of c)l.set(n,Array.from({length:s.x},()=>Array.from({length:s.y},()=>Array(s.z).fill(!1))));const p=(n,d)=>{const u=$(d),m={x:n.x+u.x-1,y:n.y+u.y-1,z:n.z+u.z-1},h=Re(d),y=O(d),I=new Set;I.add(d);const g=v=>{const E=new Set;let z=!1;for(let{x:w}=n;w<=v.x;w++)for(let{y:b}=n;b<=v.y;b++)for(let{z:R}=n;R<=v.z;R++){const C=r.get({x:w,y:b,z:R});let W=!1,H=!1;if(C)for(const[,T]of C)O(T)===y?(W=!0,E.add(T)):be(T)&&T.type!=="wall"&&(H=!0);H&&!W&&(z=!0),(!C||C.size===0)&&(z=!0),W||(z=!0)}if(z)return!1;let k=!1;for(const w of E)I.has(w)||(k=!0,I.add(w));if(!k)return!1;for(const w of E){const b=$(w),R={x:w.position.x+b.x-1,y:w.position.y+b.y-1,z:w.position.z+b.z-1};if(w.position.x<n.x||w.position.y<n.y||w.position.z<n.z||R.x>v.x||R.y>v.y||R.z>v.z)return!1}return!0};let x=!0;for(;x;){if(x=!1,h.x>0&&m.x+1<a.x+s.x){let v=m.x;for(let{y:E}=n;E<=m.y;E++)for(let{z}=n;z<=m.z;z++){const k=r.get({x:m.x+1,y:E,z});if(k){for(const[,w]of k)if(O(w)===y){const b=$(w),R=w.position.x+b.x-1;v=Math.max(v,R)}}}v>m.x&&g({...m,x:v})&&(m.x=v,x=!0)}if(h.y>0&&m.y+1<a.y+s.y){let v=m.y;for(let{x:E}=n;E<=m.x;E++)for(let{z}=n;z<=m.z;z++){const k=r.get({x:E,y:m.y+1,z});if(k){for(const[,w]of k)if(O(w)===y){const b=$(w),R=w.position.y+b.y-1;v=Math.max(v,R)}}}v>m.y&&g({...m,y:v})&&(m.y=v,x=!0)}if(h.z>0&&m.z+1<a.z+s.z){let v=m.z;for(let{x:E}=n;E<=m.x;E++)for(let{y:z}=n;z<=m.y;z++){const k=r.get({x:E,y:z,z:m.z+1});if(k){for(const[,w]of k)if(O(w)===y){const b=$(w),R=w.position.z+b.z-1;v=Math.max(v,R)}}}v>m.z&&g({...m,z:v})&&(m.z=v,x=!0)}}return m},i=(n,d)=>{if(n.type==="wall"){if(d.type!=="wall")throw new Error("only walls can join walls");if(n.config.direction!==d.config.direction)throw new Error("walls must have the same direction to join");return n.config.direction==="right"||n.config.direction==="towards"?n:{...n,config:{...n.config,tiles:[...n.config.tiles,...d.config.tiles]}}}return n},f=({x:n,y:d,z:u},{x:m,y:h,z:y},I)=>{const[g,x]=I,v=O(x),E=m-n+1,z=h-d+1,k=y-u+1;let w=x;if(E+z+k>3){const b={...x.config};if(x.type==="wall")switch(x.config.direction){case"away":case"left":break;case"towards":E!==1&&(b.times={x:E});break;case"right":z!==1&&(b.times={y:z});break}else{const R={...no($(x))};E!==1&&(R.x=E),z!==1&&(R.y=z),k!==1&&(R.z=k),b.times=R}w={...x,config:b}}for(let b=n;b<=m;b++)for(let R=d;R<=h;R++)for(let C=u;C<=y;C++)if(l.get(v)[b-a.x][R-a.y][C-a.z]=!0,b!==n||R!==d||C!==u){const W=r.get({x:b,y:R,z:C});if(W)e:for(const H of W){const[,T]=H;if(O(T)===v){T.position.x===b&&T.position.y===R&&T.position.z===C&&(w=i(w,T)),r.remove({x:b,y:R,z:C},H);break e}}}return[g,w]};for(const[n,d]of r.iterate())for(const u of d){const[,m]=u;if(m.position.x===n.x&&m.position.y===n.y&&m.position.z===n.z){const h=O(m),y=l.get(h),I=n.x-a.x,g=n.y-a.y,x=n.z-a.z;if(y&&!y[I][g][x]){const v=p(n,m),E=f(n,v,u);r.remove(n,u),r.add(n,E)}}}return[...r.extractUniqueItems(),...t]},so=e=>Object.fromEntries(Tt(Object.entries(e))),ao=e=>{const o=P(e);o.items=so(o.items);const t=e.selectedJsonItemIds.filter(r=>o.items[r]!==void 0);t.length!==e.selectedJsonItemIds.length&&(e.selectedJsonItemIds=t)},Ot=e=>e.type==="door",$t=e=>e.type==="monster"&&e.config.which==="cyberman",Wt={applyItemTool(e,{payload:{blockPosition:o,pointedAtItemJson:t,preview:r}}){const s=e,{tool:a}=s;if(a.type!=="item")throw new Error("applying item tool reducer while the current tool is not an item tool");switch(r||(B(s),s.previewedEdits={}),s.selectedJsonItemIds=[],!0){case Ot(a.item):{if(t.type!=="wall")throw new Error("doors can only be added on walls");kt(s,o,t.config.direction,a.item,r);break}case($t(a.item)&&t.type==="deadlyBlock"&&t.config.style==="toaster"&&t.position.z+1===o.z):{ve(s,{...a.item,config:{...a.item.config,activated:"off"}},o,r);break}default:ve(s,a.item,o,r)}!r&&s.autoCoalesce&&ao(s)}},_t={changeDragInProgress(e,{payload:o}){const t=e;t.dragInProgress=o}},Mt={changeGridResolution(e,{payload:o}){const t=e;t.halfGridResolution=o},changeWallsFloorsLocked(e,{payload:o}){const t=e;t.wallsFloorsLocked=o}},qt={setSelectedItemsInRoom(e,{payload:{jsonItemIds:o}}){e.selectedJsonItemIds=o},toggleSelectedItemInRoom(e,{payload:{jsonItemId:o}}){const t=e.selectedJsonItemIds.indexOf(o);t===-1?e.selectedJsonItemIds.push(o):e.selectedJsonItemIds.splice(t,1)},setHoveredItemInRoom(e,o){e.hoveredItem=o.payload},setClickableAnnotationHovered(e,o){e.clickableAnnotationHovered=o.payload}},Nt=(e,...o)=>({x:e(...o.map(t=>t.x)),y:e(...o.map(t=>t.y)),z:e(...o.map(t=>t.z))}),je=(e,o,t)=>{const r=t-e.length;r>0?e.push(...j(o,r,e.length)):r<0&&e.splice(t)},Bt=e=>e==="towards"||e==="right";function*co(e,o){const t={type:"wall",config:Bt(e.config.direction)?e.config.direction==="towards"?{direction:e.config.direction,times:{x:2}}:{direction:e.config.direction,times:{y:2}}:{direction:e.config.direction,tiles:[...j(o.planet,2,e.position[e.config.direction==="away"?"x":"y"])]},position:{...e.position,z:0}};yield[we(o,t,!1),t]}function lo(e,o){const t=ae(e.config),r=A(o.position,o.config.times);switch(e.config.direction){case"towards":if(e.position.y===o.position.y&&e.position.x>=o.position.x&&e.position.x<r.x)return{tangentAxis:"x",normalAxis:"y",edgePosition:e.position.y,wallStart:e.position.x,wallLength:t.x??1,isOnFloorEdge:!0,wallFullySpansFloor:e.position.x===o.position.x&&t.x===o.config.times.x,wallTouchesFloorEnd:e.position.x+(t.x??1)===r.x};break;case"right":if(e.position.x===o.position.x&&e.position.y>=o.position.y&&e.position.y<r.y)return{tangentAxis:"y",normalAxis:"x",edgePosition:e.position.x,wallStart:e.position.y,wallLength:t.y??1,isOnFloorEdge:!0,wallFullySpansFloor:e.position.y===o.position.y&&t.y===o.config.times.y,wallTouchesFloorEnd:e.position.y+(t.y??1)===r.y};break;case"away":if(e.position.y===o.position.y+o.config.times.y&&e.position.x>=o.position.x&&e.position.x<r.x)return{tangentAxis:"x",normalAxis:"y",edgePosition:e.position.y,wallStart:e.position.x,wallLength:t.x??1,isOnFloorEdge:!0,wallFullySpansFloor:e.position.x===o.position.x&&t.x===o.config.times.x,wallTouchesFloorEnd:e.position.x+(t.x??1)===r.x};break;case"left":if(e.position.x===o.position.x+o.config.times.x&&e.position.y>=o.position.y&&e.position.y<r.y)return{tangentAxis:"y",normalAxis:"x",edgePosition:e.position.x,wallStart:e.position.y,wallLength:t.y??1,isOnFloorEdge:!0,wallFullySpansFloor:e.position.y===o.position.y&&t.y===o.config.times.y,wallTouchesFloorEnd:e.position.y+(t.y??1)===r.y};break}return null}function*fo(e,o,t,r,s){const a=A(o.position,r),l=o.config.times,c=s?A(l,s):o.config.times,p=A(o.position,l),i=A(a,c);for(const[f,n]of q(e)){if(n.type==="wall"&&n.position.z!==o.position.z)continue;if(n.type==="door"){const h=n.config;let y=!1,I={...F(n.position)};switch(h.direction){case"towards":n.position.y===o.position.y&&n.position.x>=o.position.x&&n.position.x<o.position.x+l.x&&(y=!0,I=A(n.position,r));break;case"right":n.position.x===o.position.x&&n.position.y>=o.position.y&&n.position.y<o.position.y+l.y&&(y=!0,I=A(n.position,r));break;case"away":n.position.y===o.position.y+l.y&&n.position.x>=o.position.x&&n.position.x<o.position.x+l.x&&(y=!0,I=A(n.position,{x:r.x,y:r.y+(s?.y??0),z:r.z}));break;case"left":n.position.x===o.position.x+l.x&&n.position.y>=o.position.y&&n.position.y<o.position.y+l.y&&(y=!0,I=A(n.position,{x:r.x+(s?.x??0),y:r.y,z:r.z}));break}if(y){const g=structuredClone(F(n));g.position=I,yield[f,g]}continue}const d=n,u=lo(d,o);if(!u||!u.isOnFloorEdge)continue;const m=structuredClone(F(d));switch(d.config.direction){case"towards":case"right":m.position=A(d.position,r);break;case"away":{const h=a.y+c.y;m.position={...d.position,x:d.position.x+r.x,y:h};break}case"left":{const h=a.x+c.x;m.position={...d.position,x:h,y:d.position.y+r.y};break}}if(u.wallFullySpansFloor){const h=c[u.tangentAxis];d.config.direction==="away"||d.config.direction==="left"?je(m.config.tiles,t,h):m.config.times={[u.tangentAxis]:h},yield[f,m]}else{const h=o.position[u.tangentAxis],y=p[u.tangentAxis],I=a[u.tangentAxis],g=i[u.tangentAxis],x=m.position[u.tangentAxis];if(x>=g){yield[f,null];continue}const v=Math.max(u.wallStart,h),z=Math.min(u.wallStart+u.wallLength,y)-v;let k;if(d.config.direction==="away"||d.config.direction==="left"){const C=o.position[u.normalAxis]+l[u.normalAxis],W=a[u.normalAxis]+c[u.normalAxis];k=C!==W}else k=o.position[u.normalAxis]!==a[u.normalAxis];const w=Math.max(x,I);let b;u.wallTouchesFloorEnd&&!k?b=g:b=Math.min(x+z,g);const R=b-w;R<=0?yield[f,null]:(d.config.direction==="away"||d.config.direction==="left"?je(m.config.tiles,t,R):m.config.times={[u.tangentAxis]:R},yield[f,m])}}}function*Ht(e,o,t,r){for(const[s,a]of _(e.items,"floor")){const l=lo(o,a);if(!l)continue;const c={x:0,y:0,z:0},p={x:0,y:0,z:0},i=t[l.normalAxis],f=t[l.tangentAxis],n=r?r[l.tangentAxis]:0;if(i!==0&&(o.config.direction==="towards"||o.config.direction==="right"?(c[l.normalAxis]=i,p[l.normalAxis]=-i):p[l.normalAxis]=i),f!==0&&(l.wallStart===a.position[l.tangentAxis]?(c[l.tangentAxis]=f,p[l.tangentAxis]=-f):l.wallTouchesFloorEnd&&(p[l.tangentAxis]=f)),n!==0&&l.wallTouchesFloorEnd&&(p[l.tangentAxis]=n),c.x!==0||c.y!==0||p.x!==0||p.y!==0){const d=A(a.config.times,p),u={...a,position:A(a.position,c),config:{...a.config,times:{x:d.x,y:d.y}}};yield[s,u]}yield*fo(_(e.items,"wall","door"),a,e.planet,c,p)}}const Jt={moveOrResizeItemAsPreview(e,{payload:{jsonItemIds:o,timesDelta:t,positionDelta:r}}){const s=e,a=P(s);for(const l of o){const c=eo(s,l);if(c===void 0)throw new Error(`no json item found for some of the ids in resize ${l}`);if(c.type==="wall"){for(const[i,f]of Ht(a,c,r,t))s.previewedEdits[i]=f;continue}if(c.type==="floor")for(const[i,f]of fo(_(a.items,"wall","door"),c,a.planet,r,t))s.previewedEdits[i]=f;if(c.type==="door"){console.log("before healing, room items are",F(a.items));for(const[i,f]of co(c,F(a)))console.log("healing",`"${i}"`,f),s.previewedEdits[i]=f}const p={...c,position:A(c.position,r),config:{...c.config}};if(s.previewedEdits[l]=p,Lt(p,t),c.type==="door"){console.log("before cutting room plus previews is",{...F(a.items),...F(s.previewedEdits)});for(const[i,f]of io({...F(a.items),...F(s.previewedEdits)},p.config.direction,p.position))console.log("cutting",`"${i}"`,f),s.previewedEdits[i]=f}}s.dragInProgress=!0}},Lt=(e,o)=>{if(o!==void 0){const t=$(e),r=Re(e),s=bo(o,r);if(Ze(s)>0){const a=no(Nt((l,c)=>Math.max(1,l+c),t,s));a===void 0?delete e.config.times:e.config.times=a}}},Xt=(e,o)=>{const t=e.items[o];if(t.type==="door"){for(const[r,s]of co(t,e))e.items[r]=s;e.items=so(e.items)}delete e.items[o]},De=(e,o)=>{xt(e).filter(t=>t.type==="floor").filter(t=>t.position.z===0).forEach(t=>{t.config={...t.config,floorType:o,scenery:o==="standable"?e.planet:void 0}})},jt={changeRoomColour(e,{payload:o}){const t=e,r=t.campaignInProgress.rooms[t.currentlyEditingRoomId].color;B(t),Object.assign(r,o)},changeRoomScenery(e,{payload:o}){const t=e,r=P(t);B(t),to(r,o)},roomJsonEdited(e,{payload:o}){const t=e;t.campaignInProgress.rooms[t.currentlyEditingRoomId]=o},deleteSelected(e){const o=e,t=P(o);B(o),o.selectedJsonItemIds.forEach(r=>{Xt(t,r)}),o.selectedJsonItemIds=[]},clearRoom(e){const o=e,t=P(o);B(o);for(const r of Qe(t.items)){const s=t.items[r];s.type!=="floor"&&s.type!=="wall"&&s.type!=="door"&&(delete t.items[r],o.selectedJsonItemIds=o.selectedJsonItemIds.filter(a=>a!==r))}},setRoomAboveOrBelow(e,{payload:o}){const t=e,r=o.direction==="above"?"roomAbove":"roomBelow",s=r==="roomAbove"?"roomBelow":"roomAbove",a=P(t),l=o.createNew?xe(t,a.planet,a.color).id:o.roomId,c=a[r]&&Ie(t,a[r]);c?.[s]===t.currentlyEditingRoomId&&(c[s]=void 0),a[r]=l;const p=l&&Ie(t,l);p!==void 0&&(p[s]=a.id),p?De(r==="roomBelow"?a:p,"none"):De(r==="roomBelow"?a:c,"standable")}},Dt=(e,o)=>{const t=Ke(o);for(const[r,s]of t)s===null?delete e.items[r]:e.items[r]=s},Gt={setAutoCoalesce(e,o){e.autoCoalesce=o.payload},resetPreviewedEdits(e){e.previewedEdits={}},commitCurrentPreviewedEdits(e){B(e),Dt(P(e),e.previewedEdits),e.autoCoalesce&&ao(e),e.previewedEdits={}}},Ee="room_0",Ut={id:Ee,...oo({x:8,y:8})},Ge={name:"new campaign",rooms:{[Ee]:Ut}},ze={campaignInProgress:Ge,savedCampaign:Ge,currentlyEditingRoomId:Ee,editingRoomIdHistory:{back:[],forward:[]},previewedEdits:{},tool:{type:"pointer"},hoveredItem:void 0,clickableAnnotationHovered:!1,selectedJsonItemIds:[],halfGridResolution:!1,autoCoalesce:!0,wallsFloorsLocked:!0,dragInProgress:!1,history:{undo:[],redo:[]}},Yt={loadCampaign(e,{payload:{campaign:o}}){const t=e;t.savedCampaign=o,t.campaignInProgress=o,t.hoveredItem=void 0,t.selectedJsonItemIds=[],t.clickableAnnotationHovered=!1,t.dragInProgress=!1,t.history=ze.history;const r=he(Qe(o.rooms));if(r===void 0)throw new Error("could not find any rooms in this campaign");t.currentlyEditingRoomId=r},campaignSaved(e,{payload:{campaign:o}}){const t=e;t.savedCampaign=o}},uo=(e,o)=>{if(!e.campaignInProgress.rooms[o]){console.warn(`can't change to room ${o} - it doesn't exist`);return}e.editingRoomIdHistory.back.push(e.currentlyEditingRoomId),e.currentlyEditingRoomId=o,e.clickableAnnotationHovered=!1,e.hoveredItem=void 0,e.selectedJsonItemIds=[],e.history=ze.history},Vt={changeToRoom(e,{payload:o}){uo(e,o)},roomBack(e){const o=e,{editingRoomIdHistory:t}=o;if(t.back.length===0)return;const r=t.back.pop();t.forward.push(o.currentlyEditingRoomId),o.currentlyEditingRoomId=r},roomForward(e){const o=e,{editingRoomIdHistory:t}=o;if(t.forward.length===0)return;const r=t.forward.pop();t.back.push(o.currentlyEditingRoomId),o.currentlyEditingRoomId=r}},Kt={addRoom(e){const o=e.campaignInProgress.rooms[e.currentlyEditingRoomId],t=xe(e,o.planet);uo(e,t.id)},removeRoom(e){const o=e.campaignInProgress.rooms[e.currentlyEditingRoomId],r=he(_(o.items,"door","teleporter"))?.[1].config.toRoom??he(Jo(s=>s!==e.currentlyEditingRoomId,Ro(e.campaignInProgress.rooms)));r!==void 0&&(delete e.campaignInProgress.rooms[e.currentlyEditingRoomId],e.currentlyEditingRoomId=r)}},ke=Eo({name:"levelEditor",initialState:ze,reducers:{setTool(e,{payload:o}){const t=e;o.type==="item"&&(t.selectedJsonItemIds=[]),t.tool=o},injected(){},...Mt,...Yo,...Wt,..._t,...qt,...jt,...Jt,...Gt,...Yt,...Kt,...Vt},selectors:{selectCurrentCampaignInProgress:e=>e.campaignInProgress,selectCurrentEditingRoomJson:P,selectItem:eo,selectCurrentEditingRoomColour:e=>P(e).color,selectCurrentEditingRoomScenery:e=>P(e).planet,selectTool:e=>e.tool,selectSelectedJsonItemIds:e=>e.selectedJsonItemIds,selectHoveredItem:e=>e.hoveredItem,selectItemIsSelected:Uo,...Vo}}),{addRoom:Zt,applyItemTool:Qt,campaignSaved:er,changeDragInProgress:or,changeGridResolution:tr,changeRoomColour:rr,changeRoomScenery:nr,changeToRoom:ir,changeWallsFloorsLocked:sr,clearRoom:ar,commitCurrentPreviewedEdits:cr,deleteSelected:lr,injected:dr,loadCampaign:fr,moveOrResizeItemAsPreview:ur,redo:mr,removeRoom:yr,resetPreviewedEdits:pr,roomBack:gr,roomJsonEdited:hr,setAutoCoalesce:Ir,setClickableAnnotationHovered:vr,setHoveredItemInRoom:xr,setRoomAboveOrBelow:wr,setSelectedItemsInRoom:br,setTool:Rr,toggleSelectedItemInRoom:Er,undo:zr,roomForward:kr}=ke.actions,{selectCanRedo:Ar,selectCanUndo:Sr,selectCurrentCampaignInProgress:Cr,selectCurrentEditingRoomColour:Pr,selectCurrentEditingRoomJson:Tr,selectCurrentEditingRoomScenery:Fr,selectHoveredItem:Or,selectItem:$r,selectItemIsSelected:Wr,selectSelectedJsonItemIds:_r,selectTool:Mr}=ke.selectors,qr=zo.withTypes(),Yr=Object.freeze(Object.defineProperty({__proto__:null,addRoom:Zt,applyItemTool:Qt,campaignSaved:er,changeDragInProgress:or,changeGridResolution:tr,changeRoomColour:rr,changeRoomScenery:nr,changeToRoom:ir,changeWallsFloorsLocked:sr,clearRoom:ar,commitCurrentPreviewedEdits:cr,deleteSelected:lr,injected:dr,levelEditorSlice:ke,loadCampaign:fr,moveOrResizeItemAsPreview:ur,redo:mr,removeRoom:yr,resetPreviewedEdits:pr,roomBack:gr,roomForward:kr,roomJsonEdited:hr,selectCanRedo:Ar,selectCanUndo:Sr,selectCurrentCampaignInProgress:Cr,selectCurrentEditingRoomColour:Pr,selectCurrentEditingRoomJson:Tr,selectCurrentEditingRoomScenery:Fr,selectHoveredItem:Or,selectItem:$r,selectItemIsSelected:Wr,selectSelectedJsonItemIds:_r,selectTool:Mr,setAutoCoalesce:Ir,setClickableAnnotationHovered:vr,setHoveredItemInRoom:xr,setRoomAboveOrBelow:wr,setSelectedItemsInRoom:br,setTool:Rr,toggleSelectedItemInRoom:Er,undo:zr,useAppSelectorWithLevelEditorSlice:qr},Symbol.toStringTag,{value:"Module"}));export{Or as $,ft as A,X as B,at as C,Ur as D,He as E,ne as F,ae as G,Bt as H,gt as I,Jr as J,Xr as K,Lt as L,Jo as M,ur as N,cr as O,gr as P,kr as Q,Ir as R,ir as S,S as T,mt as U,Gr as V,dt as W,jr as X,Dr as Y,Lr as Z,vr as _,Rr as a,_r as a0,ht as a1,$ as a2,Re as a3,Nt as a4,or as a5,br as a6,Er as a7,Qt as a8,xr as a9,pr as aa,eo as ab,$r as ac,Wr as ad,be as ae,hr as af,Yr as ag,Pr as b,tr as c,lr as d,rr as e,Fr as f,nr as g,Sr as h,Ar as i,zr as j,mr as k,sr as l,Tr as m,j as n,ar as o,P as p,wr as q,To as r,Mr as s,Cr as t,qr as u,er as v,fr as w,Zt as x,yr as y,Hr as z};
