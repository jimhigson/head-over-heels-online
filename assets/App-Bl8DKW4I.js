const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-B43f2Qjm.js","assets/webworkerAll-Di8FdxcH.js","assets/Graphics-CaQT4KcC.js","assets/colorToUniform-KTpA7KSL.js","assets/index-CDXihtEH.js","assets/index-DLoutohD.css","assets/campaign-DbbAJxQb.js","assets/Cheats-DRjJIlbo.js","assets/changeCharacterRoom-Cm-NQnSo.js","assets/gameMain-D66On8ja.js","assets/consolidateItems-CzclfxHN.js","assets/testCampaign-CmCM5bp4.js"])))=>i.map(i=>d[i]);
import{b as rs,r as I,R as vg,a as $e,j as d,_ as ss,t as De,d as Hf,B as Ze,D as Se,L as Gf,i as ns,c as cn}from"./index-CDXihtEH.js";function _g(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,a=[],o="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(a.push(r),o+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),a.push(n.substring(1,~s?s:~i?i:n.length)),o+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~s?"?":"")+"\\"+n.substring(i))):o+="/"+n;return{keys:a,pattern:new RegExp("^"+o+(e?"(?=$|/)":"/?$"),"i")}}var Oi={exports:{}},Li={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rc;function kg(){if(Rc)return Li;Rc=1;var t=rs();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:e,s=t.useState,n=t.useEffect,i=t.useLayoutEffect,a=t.useDebugValue;function o(h,f){var A=f(),m=s({inst:{value:A,getSnapshot:f}}),g=m[0].inst,p=m[1];return i(function(){g.value=A,g.getSnapshot=f,l(g)&&p({inst:g})},[h,A,f]),n(function(){return l(g)&&p({inst:g}),h(function(){l(g)&&p({inst:g})})},[h]),a(A),A}function l(h){var f=h.getSnapshot;h=h.value;try{var A=f();return!r(h,A)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return Li.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Li}var Bc;function Sg(){return Bc||(Bc=1,Oi.exports=kg()),Oi.exports}var Cg=Sg();const Mg=vg.useInsertionEffect,Pg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Eg=Pg?I.useLayoutEffect:I.useEffect,Tg=Mg||Eg,Uf=t=>{const e=I.useRef([t,(...r)=>e[0](...r)]).current;return Tg(()=>{e[0]=t}),e[1]},Ig="popstate",Sl="pushState",Cl="replaceState",Rg="hashchange",jc=[Ig,Sl,Cl,Rg],Bg=t=>{for(const e of jc)addEventListener(e,t);return()=>{for(const e of jc)removeEventListener(e,t)}},Wf=(t,e)=>Cg.useSyncExternalStore(Bg,t,e),jg=()=>location.search,zg=({ssrSearch:t=""}={})=>Wf(jg,()=>t),zc=()=>location.pathname,Ng=({ssrPath:t}={})=>Wf(zc,t?()=>t:zc),Fg=(t,{replace:e=!1,state:r=null}={})=>history[e?Cl:Sl](r,"",t),Og=(t={})=>[Ng(t),Fg],Nc=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Nc]>"u"){for(const t of[Sl,Cl]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,Nc,{value:!0})}const Lg=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Yf=(t="")=>t==="/"?"":t,Dg=(t,e)=>t[0]==="~"?t.slice(1):Yf(e)+t,Hg=(t="",e)=>Lg(Fc(Yf(t)),Fc(e)),Fc=t=>{try{return decodeURI(t)}catch{return t}},$f={hook:Og,searchHook:zg,parser:_g,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},Xf=I.createContext($f),wi=()=>I.useContext(Xf),Qf={},Kf=I.createContext(Qf),Gg=()=>I.useContext(Kf),Ml=t=>{const[e,r]=t.hook(t);return[Hg(t.base,e),Uf((s,n)=>r(Dg(s,t.base),n))]},Zf=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),a=n.exec(r)||[],[o,...l]=a;return o!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,f)=>[h,l[f]])):a.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[o]:[]]:[!1,null]},Ug=({children:t,...e})=>{const r=wi(),s=e.hook?$f:r;let n=s;const[i,a]=e.ssrPath?.split("?")??[];a&&(e.ssrSearch=a,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let o=I.useRef({}),l=o.current,c=l;for(let u in s){const h=u==="base"?s[u]+(e[u]||""):e[u]||s[u];l===c&&h!==c[u]&&(o.current=c={...c}),c[u]=h,h!==s[u]&&(n=c)}return I.createElement(Xf.Provider,{value:n,children:t})},Oc=({children:t,component:e},r)=>e?I.createElement(e,{params:r}):typeof t=="function"?t(r):t,Wg=t=>{let e=I.useRef(Qf);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},un=({path:t,nest:e,match:r,...s})=>{const n=wi(),[i]=Ml(n),[a,o,l]=r??Zf(n.parser,t,i,e),c=Wg({...Gg(),...o});if(!a)return null;const u=l?I.createElement(Ug,{base:l},Oc(s,c)):Oc(s,c);return I.createElement(Kf.Provider,{value:c,children:u})};I.forwardRef((t,e)=>{const r=wi(),[s,n]=Ml(r),{to:i="",href:a=i,onClick:o,asChild:l,children:c,className:u,replace:h,state:f,...A}=t,m=Uf(p=>{p.ctrlKey||p.metaKey||p.altKey||p.shiftKey||p.button!==0||(o?.(p),p.defaultPrevented||(p.preventDefault(),n(a,t)))}),g=r.hrefs(a[0]==="~"?a.slice(1):r.base+a,r);return l&&I.isValidElement(c)?I.cloneElement(c,{onClick:m,href:g}):I.createElement("a",{...A,onClick:m,href:g,className:u?.call?u(s===a):u,children:c,ref:e})});const Jf=t=>Array.isArray(t)?t.flatMap(e=>Jf(e&&e.type===I.Fragment?e.props.children:e)):[t],Yg=({children:t,location:e})=>{const r=wi(),[s]=Ml(r);for(const n of Jf(t)){let i=0;if(I.isValidElement(n)&&(i=Zf(r.parser,n.props.path,e||s,n.props.nest))[0])return I.cloneElement(n,{match:i})}return null},Ce=t=>t[Symbol.iterator](),Es=1e-4,_r=(t,e)=>Math.abs(t-e)<Es,BP=t=>t===0?Es:Math.abs(t)<Es?Es*Math.sign(t):t,Zs=["away","towards","left","right"],$g=["awayRight","towardsRight","towardsLeft","awayLeft"],$r=[...Zs,...$g],eA=t=>t==="away"||t==="towards"?"y":"x",jP=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",tA=t=>Pl(eA(t)),Pl=t=>t==="x"?"y":"x",ar=(t,...e)=>e.reduce((r,s)=>({x:r.x+(s.x??0),y:r.y+(s.y??0)}),t),Xg=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0)}),t),El=(t,e)=>({x:t.x*e,y:t.y*e}),Js=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),Qg=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),rA=({x:t,y:e,z:r})=>Math.hypot(t,e,r),sA=({x:t,y:e})=>Math.hypot(t,e),Hr=t=>{const e=rA(t);if(e===0)throw new Error("unitVector called with zero length vector");return Js(t,1/e)},ee=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n=0,y:i=0,z:a=0})=>({x:e+n,y:r+i,z:s+a}),pe),Kg=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n,y:i,z:a})=>({x:e*n,y:r*i,z:s*a}),Tl),ti=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0),z:r.z-(s.z??0)}),t),Zg=({x:t,y:e,z:r},{x:s,y:n,z:i})=>t===s&&e===n&&r===i,Jg=({x:t,y:e},{x:r,y:s})=>t===r&&e===s,zP=t=>{const{x:e}=t,r=Math.round(e),s=!Number.isInteger(e)&&_r(e,r),{y:n}=t,i=Math.round(n),a=!Number.isInteger(n)&&_r(n,i),{z:o}=t,l=Math.round(o),c=!Number.isInteger(o)&&_r(t.z,l);return s||a||c?{x:s?r:e,y:a?i:n,z:c?l:o}:t},NP=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),FP=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),ey=Object.freeze({x:0,y:0}),pe=Object.freeze({x:0,y:0,z:0}),Tl=Object.freeze({x:1,y:1,z:1}),OP=["x","y","z"],Oo=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,ty=({x:t,y:e})=>{if(!(_r(t,0)&&_r(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},ry=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],nA=({x:t,y:e})=>{if(_r(t,0)&&_r(e,0))return;const r=Math.atan2(-e,-t),s=Math.round(8*r/(2*Math.PI))&7;return ry[s]},LP=({x:t,y:e},{x:r,y:s})=>Math.abs(r-t)**2+Math.abs(s-e)**2;var Di={exports:{}},Hi={exports:{}},Lc;function ur(){return Lc||(Lc=1,function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Hi)),Hi.exports}var Dc;function sy(){return Dc||(Dc=1,function(t){var e=ur().default;function r(){t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var s,n={},i=Object.prototype,a=i.hasOwnProperty,o=Object.defineProperty||function(v,V,S){v[V]=S.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function f(v,V,S){return Object.defineProperty(v,V,{value:S,enumerable:!0,configurable:!0,writable:!0}),v[V]}try{f({},"")}catch{f=function(S,M,T){return S[M]=T}}function A(v,V,S,M){var T=V&&V.prototype instanceof k?V:k,j=Object.create(T.prototype),F=new w(M||[]);return o(j,"_invoke",{value:G(v,S,F)}),j}function m(v,V,S){try{return{type:"normal",arg:v.call(V,S)}}catch(M){return{type:"throw",arg:M}}}n.wrap=A;var g="suspendedStart",p="suspendedYield",q="executing",x="completed",b={};function k(){}function P(){}function C(){}var E={};f(E,c,function(){return this});var z=Object.getPrototypeOf,B=z&&z(z(_([])));B&&B!==i&&a.call(B,c)&&(E=B);var R=C.prototype=k.prototype=Object.create(E);function O(v){["next","throw","return"].forEach(function(V){f(v,V,function(S){return this._invoke(V,S)})})}function K(v,V){function S(T,j,F,Z){var J=m(v[T],v,j);if(J.type!=="throw"){var te=J.arg,me=te.value;return me&&e(me)=="object"&&a.call(me,"__await")?V.resolve(me.__await).then(function(re){S("next",re,F,Z)},function(re){S("throw",re,F,Z)}):V.resolve(me).then(function(re){te.value=re,F(te)},function(re){return S("throw",re,F,Z)})}Z(J.arg)}var M;o(this,"_invoke",{value:function(j,F){function Z(){return new V(function(J,te){S(j,F,J,te)})}return M=M?M.then(Z,Z):Z()}})}function G(v,V,S){var M=g;return function(T,j){if(M===q)throw Error("Generator is already running");if(M===x){if(T==="throw")throw j;return{value:s,done:!0}}for(S.method=T,S.arg=j;;){var F=S.delegate;if(F){var Z=$(F,S);if(Z){if(Z===b)continue;return Z}}if(S.method==="next")S.sent=S._sent=S.arg;else if(S.method==="throw"){if(M===g)throw M=x,S.arg;S.dispatchException(S.arg)}else S.method==="return"&&S.abrupt("return",S.arg);M=q;var J=m(v,V,S);if(J.type==="normal"){if(M=S.done?x:p,J.arg===b)continue;return{value:J.arg,done:S.done}}J.type==="throw"&&(M=x,S.method="throw",S.arg=J.arg)}}}function $(v,V){var S=V.method,M=v.iterator[S];if(M===s)return V.delegate=null,S==="throw"&&v.iterator.return&&(V.method="return",V.arg=s,$(v,V),V.method==="throw")||S!=="return"&&(V.method="throw",V.arg=new TypeError("The iterator does not provide a '"+S+"' method")),b;var T=m(M,v.iterator,V.arg);if(T.type==="throw")return V.method="throw",V.arg=T.arg,V.delegate=null,b;var j=T.arg;return j?j.done?(V[v.resultName]=j.value,V.next=v.nextLoc,V.method!=="return"&&(V.method="next",V.arg=s),V.delegate=null,b):j:(V.method="throw",V.arg=new TypeError("iterator result is not an object"),V.delegate=null,b)}function le(v){var V={tryLoc:v[0]};1 in v&&(V.catchLoc=v[1]),2 in v&&(V.finallyLoc=v[2],V.afterLoc=v[3]),this.tryEntries.push(V)}function y(v){var V=v.completion||{};V.type="normal",delete V.arg,v.completion=V}function w(v){this.tryEntries=[{tryLoc:"root"}],v.forEach(le,this),this.reset(!0)}function _(v){if(v||v===""){var V=v[c];if(V)return V.call(v);if(typeof v.next=="function")return v;if(!isNaN(v.length)){var S=-1,M=function T(){for(;++S<v.length;)if(a.call(v,S))return T.value=v[S],T.done=!1,T;return T.value=s,T.done=!0,T};return M.next=M}}throw new TypeError(e(v)+" is not iterable")}return P.prototype=C,o(R,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:P,configurable:!0}),P.displayName=f(C,h,"GeneratorFunction"),n.isGeneratorFunction=function(v){var V=typeof v=="function"&&v.constructor;return!!V&&(V===P||(V.displayName||V.name)==="GeneratorFunction")},n.mark=function(v){return Object.setPrototypeOf?Object.setPrototypeOf(v,C):(v.__proto__=C,f(v,h,"GeneratorFunction")),v.prototype=Object.create(R),v},n.awrap=function(v){return{__await:v}},O(K.prototype),f(K.prototype,u,function(){return this}),n.AsyncIterator=K,n.async=function(v,V,S,M,T){T===void 0&&(T=Promise);var j=new K(A(v,V,S,M),T);return n.isGeneratorFunction(V)?j:j.next().then(function(F){return F.done?F.value:j.next()})},O(R),f(R,h,"Generator"),f(R,c,function(){return this}),f(R,"toString",function(){return"[object Generator]"}),n.keys=function(v){var V=Object(v),S=[];for(var M in V)S.push(M);return S.reverse(),function T(){for(;S.length;){var j=S.pop();if(j in V)return T.value=j,T.done=!1,T}return T.done=!0,T}},n.values=_,w.prototype={constructor:w,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(y),!V)for(var S in this)S.charAt(0)==="t"&&a.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=s)},stop:function(){this.done=!0;var V=this.tryEntries[0].completion;if(V.type==="throw")throw V.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var S=this;function M(te,me){return F.type="throw",F.arg=V,S.next=te,me&&(S.method="next",S.arg=s),!!me}for(var T=this.tryEntries.length-1;T>=0;--T){var j=this.tryEntries[T],F=j.completion;if(j.tryLoc==="root")return M("end");if(j.tryLoc<=this.prev){var Z=a.call(j,"catchLoc"),J=a.call(j,"finallyLoc");if(Z&&J){if(this.prev<j.catchLoc)return M(j.catchLoc,!0);if(this.prev<j.finallyLoc)return M(j.finallyLoc)}else if(Z){if(this.prev<j.catchLoc)return M(j.catchLoc,!0)}else{if(!J)throw Error("try statement without catch or finally");if(this.prev<j.finallyLoc)return M(j.finallyLoc)}}}},abrupt:function(V,S){for(var M=this.tryEntries.length-1;M>=0;--M){var T=this.tryEntries[M];if(T.tryLoc<=this.prev&&a.call(T,"finallyLoc")&&this.prev<T.finallyLoc){var j=T;break}}j&&(V==="break"||V==="continue")&&j.tryLoc<=S&&S<=j.finallyLoc&&(j=null);var F=j?j.completion:{};return F.type=V,F.arg=S,j?(this.method="next",this.next=j.finallyLoc,b):this.complete(F)},complete:function(V,S){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&S&&(this.next=S),b},finish:function(V){for(var S=this.tryEntries.length-1;S>=0;--S){var M=this.tryEntries[S];if(M.finallyLoc===V)return this.complete(M.completion,M.afterLoc),y(M),b}},catch:function(V){for(var S=this.tryEntries.length-1;S>=0;--S){var M=this.tryEntries[S];if(M.tryLoc===V){var T=M.completion;if(T.type==="throw"){var j=T.arg;y(M)}return j}}throw Error("illegal catch attempt")},delegateYield:function(V,S,M){return this.delegate={iterator:_(V),resultName:S,nextLoc:M},this.method==="next"&&(this.arg=s),b}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Di)),Di.exports}var Gi,Hc;function hr(){if(Hc)return Gi;Hc=1;var t=sy()();Gi=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return Gi}var ft={},Ui={exports:{}},Wi={exports:{}},Yi={exports:{}},Gc;function ny(){return Gc||(Gc=1,function(t){var e=ur().default;function r(s,n){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,n||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Yi)),Yi.exports}var Uc;function iA(){return Uc||(Uc=1,function(t){var e=ur().default,r=ny();function s(n){var i=r(n,"string");return e(i)=="symbol"?i:i+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(Wi)),Wi.exports}var Wc;function iy(){return Wc||(Wc=1,function(t){var e=iA();function r(s,n,i){return(n=e(n))in s?Object.defineProperty(s,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[n]=i,s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ui)),Ui.exports}var $i={exports:{}},Xi={exports:{}},Qi={exports:{}},Yc;function aA(){return Yc||(Yc=1,function(t){function e(r,s){(s==null||s>r.length)&&(s=r.length);for(var n=0,i=Array(s);n<s;n++)i[n]=r[n];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Qi)),Qi.exports}var $c;function ay(){return $c||($c=1,function(t){var e=aA();function r(s){if(Array.isArray(s))return e(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Xi)),Xi.exports}var Ki={exports:{}},Xc;function oy(){return Xc||(Xc=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ki)),Ki.exports}var Zi={exports:{}},Qc;function oA(){return Qc||(Qc=1,function(t){var e=aA();function r(s,n){if(s){if(typeof s=="string")return e(s,n);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,n):void 0}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Zi)),Zi.exports}var Ji={exports:{}},Kc;function ly(){return Kc||(Kc=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ji)),Ji.exports}var Zc;function Il(){return Zc||(Zc=1,function(t){var e=ay(),r=oy(),s=oA(),n=ly();function i(a){return e(a)||r(a)||s(a)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}($i)),$i.exports}var ea={},ta={},Jc;function vi(){if(Jc)return ta;Jc=1;function t(e){return typeof e<"u"}return ta.notUndefined=t,ta}var eu;function lA(){if(eu)return ea;eu=1;var t=vi(),e=t.notUndefined;function r(s){return s!=null&&e(s[Symbol.iterator])}return ea.isIterable=r,ea}var ra={},tu;function cy(){return tu||(tu=1,ra.isLoopable=lA().isIterable),ra}var sa={},ru;function uy(){if(ru)return sa;ru=1;var t=vi(),e=t.notUndefined;function r(s){return s==null||e(s[Symbol.iterator])}return sa.isWrappable=r,sa}var hn={},su;function hy(){if(su)return hn;su=1;var t=hr(),e=t.mark(s),r=t.mark(n);function s(i){return t.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.delegateYield(i,"t0",1);case 1:case"end":return o.stop()}},e)}hn.wrap=s;function n(i){return t.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(i==null){o.next=2;break}return o.delegateYield(i,"t0",2);case 2:case"end":return o.stop()}},r)}return hn.nullableWrap=n,hn}var dn={},nu;function dy(){if(nu)return dn;nu=1;var t=Il();function e(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.length,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return i<=l.length?n.apply(void 0,t(a).concat(l)):e(n,i-l.length,[].concat(t(a),l))}}dn.curry=e;function r(n,i){var a=n.fn,o=n.validateArgs,l=n.variadic,c=n.reduces,u=n.growRight,h=n.minArgs,f=n.maxArgs,A=n.isIterable,m=n.iterableType,g=n.applyOnIterableArgs,p=n.IterableClass;if(i.length>h){var q=!0,x=l?i.findIndex(function(B,R){return A(B)&&R>=h}):Math.min(f,i.length-1),b=l?i.length:x+1;if(l)for(var k=x;k<i.length;k++)q=q&&A(i[k]);else q=A(i[x]);if(i.length>f&&(x===-1||!q)){var P=l?"...".concat(m,"s"):m,C="".concat(a.name," takes up to ").concat(f," arguments, followed by ").concat(P,". ")+"You already passed ".concat(i.length," arguments");throw l?new Error("".concat(C," and the following arguments were not all ").concat(m,"s")):new Error("".concat(C," and the last argument was not ").concat(m))}if(x>=0&&q){for(var E=x;E<b;E++)i[E]=g(i[E]);var z=l?i.slice(x):i[x];return i.splice(x),u||i.reverse(),i.unshift(z),o(i),c?a.apply(void 0,t(i)):new p(a,i)}}return s(n,i)}function s(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];if(o.length===0)throw new Error("Cannot make a partial application with no arguments");return o.unshift.apply(o,t(i)),r(n,o)}}return dn.variadicCurryWithValidation=s,dn}var ds={},iu;function fy(){if(iu)return ds;iu=1;var t=Symbol.for("_");ds._=t;var e=Symbol("__iterate");ds.__iterate=e;var r=Symbol("split");return ds.split=r,ds}var au;function _t(){if(au)return ft;au=1;var t=iy(),e=Il(),r,s=lA(),n=s.isIterable,i=cy(),a=i.isLoopable,o=uy(),l=o.isWrappable,c=hy(),u=c.nullableWrap,h=dy(),f=h.variadicCurryWithValidation,A=fy(),m=A._,g=A.__iterate;ft.wrap=u,ft.isIterable=n,ft.isLoopable=a,ft.isWrappable=l;function p(z){if(l(z))return n(z)?z:u(z);throw typeof z.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}ft.ensureIterable=p;function q(z){"return"in z&&z.return()}ft.callReturn=q;function x(z,B){this[m]={fn:z,args:B,staticIterator:null}}ft.BaseIterableIterator=x,Object.assign(x.prototype,(r={constructor:x},t(r,g,function(){var z=this[m],B=z.fn,R=z.args;return B.apply(void 0,e(R))}),t(r,"next",function(){var B=this[m];return B.staticIterator=B.staticIterator||this[g](),B.staticIterator.next()}),t(r,"return",function(B){var R=this[m];return R.staticIterator=R.staticIterator||this[g](),R.staticIterator.return(B)}),t(r,"throw",function(B){var R=this[m];return R.staticIterator=R.staticIterator||this[g](),R.staticIterator.throw(B)}),r));function b(){for(var z=arguments.length,B=new Array(z),R=0;R<z;R++)B[R]=arguments[R];x.apply(this,B)}ft.IterableIterator=b,b.prototype=Object.assign(Object.create(x.prototype),t({constructor:b},Symbol.iterator,function(){return this[g]()}));function k(z){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=B.validateArgs,O=R===void 0?function(j){}:R,K=B.variadic,G=K===void 0?!1:K,$=B.reduces,le=$===void 0?!1:$,y=B.growRight,w=y===void 0?!1:y,_=B.minArgs,v=_===void 0?z.length-1:_,V=B.maxArgs,S=V===void 0?z.length-1:V,M=B.applyOnIterableArgs,T=M===void 0?p:M;return{fn:z,validateArgs:O,variadic:G,reduces:le,growRight:w,minArgs:v,maxArgs:S,isIterable:l,iterableType:"iterable",applyOnIterableArgs:T,IterableClass:b}}function P(z){return e(z)}ft.cache=P;function C(z){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=B.validateArgs,O=R===void 0?function(K){return K}:R;return function(){for(var K=arguments.length,G=new Array(K),$=0;$<K;$++)G[$]=arguments[$];return O(G),new b(z,G)}}ft.wrapWithIterableIterator=C;var E=function(B,R){return f(k(B,R))};return ft.iterableCurry=E,ft}var na={exports:{}},ou;function Rl(){return ou||(ou=1,function(t){function e(r,s){if(!(r instanceof s))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(na)),na.exports}var ia={exports:{}},lu;function Bl(){return lu||(lu=1,function(t){var e=iA();function r(n,i){for(var a=0;a<i.length;a++){var o=i[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,e(o.key),o)}}function s(n,i,a){return i&&r(n.prototype,i),a&&r(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(ia)),ia.exports}var aa={exports:{}},oa={exports:{}},cu;function cA(){return cu||(cu=1,function(t){function e(r,s){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(oa)),oa.exports}var uu;function Ay(){return uu||(uu=1,function(t){var e=cA();function r(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(n&&n.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),n&&e(s,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(aa)),aa.exports}var la={exports:{}},ca={exports:{}},hu;function py(){return hu||(hu=1,function(t){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ca)),ca.exports}var du;function my(){return du||(du=1,function(t){var e=ur().default,r=py();function s(n,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(n)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(la)),la.exports}var ua={exports:{}},fu;function uA(){return fu||(fu=1,function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ua)),ua.exports}var ha={exports:{}},da={exports:{}},Au;function gy(){return Au||(Au=1,function(t){function e(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!r},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(da)),da.exports}var pu;function yy(){return pu||(pu=1,function(t){var e=gy(),r=cA();function s(n,i,a){if(e())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,i);var l=new(n.bind.apply(n,o));return a&&r(l,a.prototype),l}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(ha)),ha.exports}var fa={},mu;function xy(){if(mu)return fa;mu=1;var t=Rl(),e=Bl(),r=function(){function s(){t(this,s)}return e(s,[{key:Symbol.iterator,value:function(){return this}}]),s}();return fa.IterableIterator=r,fa}var fs={},gu;function hA(){if(gu)return fs;gu=1;function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&isFinite(s)&&!(n&&s===0)}fs.isInteger=t;function e(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return t(s)&&(n?s>0:s>=0)}fs.isPositiveInteger=e;function r(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&!(n&&s===0)}return fs.isIntegerOrInfinite=r,fs}var Aa={exports:{}},pa={exports:{}},yu;function qy(){return yu||(yu=1,function(t){var e=uA();function r(s,n){for(;!{}.hasOwnProperty.call(s,n)&&(s=e(s))!==null;);return s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(pa)),pa.exports}var xu;function Vy(){return xu||(xu=1,function(t){var e=qy();function r(){return t.exports=r=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(s,n,i){var a=e(s,n);if(a){var o=Object.getOwnPropertyDescriptor(a,n);return o.get?o.get.call(arguments.length<3?s:i):o.value}},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(null,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Aa)),Aa.exports}var ma={exports:{}},ga={exports:{}},qu;function by(){return qu||(qu=1,function(t){function e(r){if(Array.isArray(r))return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ga)),ga.exports}var ya={exports:{}},Vu;function wy(){return Vu||(Vu=1,function(t){function e(r,s){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,o,l,c=[],u=!0,h=!1;try{if(o=(n=n.call(r)).next,s===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=o.call(n)).done)&&(c.push(i.value),c.length!==s);u=!0);}catch(f){h=!0,a=f}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(h)throw a}}return c}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ya)),ya.exports}var xa={exports:{}},bu;function vy(){return bu||(bu=1,function(t){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(xa)),xa.exports}var wu;function _y(){return wu||(wu=1,function(t){var e=by(),r=wy(),s=oA(),n=vy();function i(a,o){return e(a)||r(a,o)||s(a,o)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(ma)),ma.exports}var fn={},vu;function ky(){if(vu)return fn;vu=1;var t=hr(),e=t.mark(o);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=s(c))||u){h&&(c=h);var f=0,A=function(){};return{s:A,n:function(){return f>=c.length?{done:!0}:{done:!1,value:c[f++]}},e:function(x){throw x},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,g=!1,p;return{s:function(){h=c[Symbol.iterator]()},n:function(){var x=h.next();return m=x.done,x},e:function(x){g=!0,p=x},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(g)throw p}}}}function s(c,u){if(c){if(typeof c=="string")return n(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return n(c,u)}}function n(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,f=new Array(u);h<u;h++)f[h]=c[h];return f}var i=_t(),a=i.iterableCurry;function o(c,u){var h,f,A,m;return t.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:h=0,f=r(c),p.prev=2,f.s();case 4:if((A=f.n()).done){p.next=10;break}return m=A.value,p.next=8,u(m,h++);case 8:p.next=4;break;case 10:p.next=15;break;case 12:p.prev=12,p.t0=p.catch(2),f.e(p.t0);case 15:return p.prev=15,f.f(),p.finish(15);case 18:case"end":return p.stop()}},e,null,[[2,12,15,18]])}fn.__map=o;var l=a(o);return fn.map=l,fn}var An={},_u;function Sy(){if(_u)return An;_u=1;function t(o,l){var c;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(c=e(o))||l){c&&(o=c);var u=0,h=function(){};return{s:h,n:function(){return u>=o.length?{done:!0}:{done:!1,value:o[u++]}},e:function(p){throw p},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=!0,A=!1,m;return{s:function(){c=o[Symbol.iterator]()},n:function(){var p=c.next();return f=p.done,p},e:function(p){A=!0,m=p},f:function(){try{!f&&c.return!=null&&c.return()}finally{if(A)throw m}}}}function e(o,l){if(o){if(typeof o=="string")return r(o,l);var c=Object.prototype.toString.call(o).slice(8,-1);if(c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set")return Array.from(o);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(o,l)}}function r(o,l){(l==null||l>o.length)&&(l=o.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=o[c];return u}var s=_t(),n=s.ensureIterable;function i(o){var l=[],c=t(o),u;try{for(c.s();!(u=c.n()).done;){var h=u.value;l.push(h)}}catch(f){c.e(f)}finally{c.f()}return l}An.__toArray=i;function a(o){return i(n(o))}return An.toArray=a,An}var qa={},ku;function dA(){if(ku)return qa;ku=1;var t=ur();function e(r){return t(r)==="object"&&r!==null}return qa.isObject=e,qa}var Va={},Su;function Cy(){if(Su)return Va;Su=1;function t(n,i){var a;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(a=e(n))||i){a&&(n=a);var o=0,l=function(){};return{s:l,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(A){throw A},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,u=!1,h;return{s:function(){a=n[Symbol.iterator]()},n:function(){var A=a.next();return c=A.done,A},e:function(A){u=!0,h=A},f:function(){try{!c&&a.return!=null&&a.return()}finally{if(u)throw h}}}}function e(n,i){if(n){if(typeof n=="string")return r(n,i);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(n,i)}}function r(n,i){(i==null||i>n.length)&&(i=n.length);for(var a=0,o=new Array(i);a<i;a++)o[a]=n[a];return o}function s(n,i){var a=t(n),o;try{for(a.s();!(o=a.n()).done;){var l=o.value;i(l)}}catch(c){a.e(c)}finally{a.f()}}return Va.parallelEach=s,Va}var ba={},Cu;function My(){if(Cu)return ba;Cu=1;var t=yy(),e=Rl(),r=Bl(),s=_t(),n=s.ensureIterable,i=s.callReturn,a=Symbol.for("_"),o=function(){function c(u){e(this,c),this.peekr=u}return r(c,[{key:"next",value:function(){var h=this.peekr,f=h.current;return h.advance(),f}},{key:"return",value:function(){return this.peekr.return(),{value:void 0,done:!0}}},{key:Symbol.iterator,value:function(){return this}}]),c}(),l=function(){r(c,null,[{key:"from",value:function(h){for(var f=n(h)[Symbol.iterator](),A=f.next(),m=arguments.length,g=new Array(m>1?m-1:0),p=1;p<m;p++)g[p-1]=arguments[p];return t(this,[f,A].concat(g))}}]);function c(u,h){e(this,c),this[a]={iterator:u,current:h,index:0}}return r(c,[{key:"advance",value:function(){var h=this[a];return h.current.done||(h.index++,h.current=h.iterator.next()),this}},{key:"return",value:function(){var h=this[a];return this.done||i(h.iterator),h.current={value:void 0,done:!0},this}},{key:"asIterator",value:function(){return new o(this)}},{key:"current",get:function(){return this[a].current}},{key:"value",get:function(){return this[a].current.value}},{key:"done",get:function(){return this[a].current.done}},{key:"index",get:function(){return this[a].index}}]),c}();return ba.Peekerator=l,ba}var wa={},Mu;function Py(){if(Mu)return wa;Mu=1;var t=hA(),e=t.isInteger,r=dA(),s=r.isObject,n=vi(),i=n.notUndefined,a=function(l){return function(u){if(s(u[1])){var h=u[1],f=h.start,A=h.step;u[1]=f,u[2]=A}if(i(u[2])&&(u[2]=Number(u[2]),!e(u[2],!0)))throw new Error("step argument to ".concat(l," must be a non-zero integer"))}};return wa.makeValidateArgs=a,wa}var As={},Pu;function Ey(){if(Pu)return As;Pu=1;var t=Il(),e=Rl(),r=Bl(),s=Vy(),n=Ay(),i=my(),a=uA();function o($){var le=l();return function(){var w=a($),_;if(le){var v=a(this).constructor;_=Reflect.construct(w,arguments,v)}else _=w.apply(this,arguments);return i(this,_)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var c=_t(),u=c.iterableCurry,h=c.callReturn,f=xy(),A=f.IterableIterator,m=Cy(),g=m.parallelEach,p=My(),q=p.Peekerator,x=ky(),b=x.__map,k=Sy(),P=k.__toArray,C=Symbol.for("_"),E=Symbol.for("__advance"),z=function($){n(y,$);var le=o(y);function y(w,_,v){var V;return e(this,y),V=le.call(this,w,_),V[C].inputSummary=v,V}return r(y,[{key:"advance",value:function(){this[C].inputSummary.advanceBuffer(this)}},{key:E,value:function(){s(a(y.prototype),"advance",this).call(this)}}]),y}(q),B=function(){function $(){e(this,$),this.buffers=[],this.notDoneBuffer=null,this.index=0}return r($,[{key:"init",value:function(y){this.buffers=y,this.updateNotDone()}},{key:"updateNotDone",value:function(){this.notDoneBuffer=this.buffers.find(function(y){return!y.done})}},{key:"advanceBuffer",value:function(y){var w=y.done;y[E](),this.index++,!w&&y.done&&this.updateNotDone()}}]),$}(),R=function(){function $(le){e(this,$),this[C]=le}return r($,[{key:"advance",value:function(){throw new Error("advance() is not supported on an interleave summary")}},{key:"current",get:function(){return{value:this.value,done:this.done}}},{key:"value",get:function(){return this[C].notDoneBuffer}},{key:"done",get:function(){return this[C].notDoneBuffer===void 0}},{key:"index",get:function(){return this[C].index}}]),$}();As.InputSummary=R;var O=function($){n(y,$);var le=o(y);function y(w,_,v){var V;return e(this,y),V=le.call(this),V.sources=w,V.strategy=_,V.options=v,V.initialized=!1,V.inputSummary=new B(w),V}return r(y,[{key:"init",value:function(){this.initialized=!0;var _=this.strategy,v=this.options,V=this.inputSummary;this.buffers=P(b(this.sources,function(S){return z.from(S,V)})),this.iterator=_.apply(void 0,[v,new R(V)].concat(t(this.buffers))),V.init(this.buffers)}},{key:"returnBuffers",value:function(){g(this.buffers,function(_){return _.return()})}},{key:"next",value:function(){this.initialized||this.init();var _=this.iterator.next();return _.done&&this.returnBuffers(),_}},{key:"return",value:function(){return h(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}]),y}(A);function K($,le){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new O($,le,y)}As.__interleave=K;var G=u(K,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return As.interleave=G,As}var pn={},mn={},Eu;function Ty(){if(Eu)return mn;Eu=1;var t=_t(),e=t.iterableCurry,r=t.callReturn;function s(i,a){var o=i[Symbol.iterator](),l=o.next(),c=l.value,u=l.done;return u?a:(r(o),c)}mn.__firstOr=s;var n=e(s,{reduces:!0});return mn.firstOr=n,mn}var Tu;function Iy(){if(Tu)return pn;Tu=1;var t=_t(),e=t.iterableCurry,r=Ty(),s=r.__firstOr;function n(a){return s(a,void 0)}pn.__first=n;var i=e(n,{reduces:!0});return pn.first=i,pn}var gn={},Iu;function Ry(){if(Iu)return gn;Iu=1;var t=ur(),e=hr(),r=e.mark(a),s=_t(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,[c,l[c]];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}gn.__objectEntries=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return gn.objectEntries=o,gn}var yn={},Ru;function By(){if(Ru)return yn;Ru=1;var t=ur(),e=hr(),r=e.mark(a),s=_t(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,c;case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}yn.__objectKeys=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return yn.objectKeys=o,yn}var xn={},Bu;function jy(){if(Bu)return xn;Bu=1;var t=ur(),e=hr(),r=e.mark(a),s=_t(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,l[c];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}xn.__objectValues=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return xn.objectValues=o,xn}var qn={},ju;function zy(){if(ju)return qn;ju=1;var t=_y(),e=hr(),r=e.mark(f),s=_t(),n=s.wrapWithIterableIterator,i=hA(),a=i.isInteger,o=i.isIntegerOrInfinite,l=dA(),c=l.isObject,u=vi(),h=u.notUndefined;function f(){var m,g,p,q,x=arguments;return e.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:m=x.length>0&&x[0]!==void 0?x[0]:0,g=x.length>1&&x[1]!==void 0?x[1]:1/0,p=x.length>2&&x[2]!==void 0?x[2]:1,q=m;case 4:if(!(p>0?q<g:q>g)){k.next=10;break}return k.next=7,q;case 7:q+=p,k.next=4;break;case 10:case"end":return k.stop()}},r)}qn.__range=f;var A=n(f,{growRight:!0,validateArgs:function(g){var p=t(g,3),q=p[0],x=p[1],b=x===void 0?1/0:x,k=p[2],P;if(c(q)?(P=q.start,b=q.end,k=q.step):g.length>1?P=q:b=q,h(P)&&!a(P))throw new TypeError("The specified start was not an integer");if(h(b)&&!o(b))throw new TypeError("The specified end was not an integer or infinite");if(h(k)&&!a(k,!0))throw new TypeError("The specified step was not a non-zero integer");g[0]=P,g[1]=b,g[2]=k}});return qn.range=A,qn}var Vn={},zu;function Ny(){if(zu)return Vn;zu=1;var t=hr(),e=t.mark(l),r=_t(),s=r.iterableCurry,n=Ey(),i=n.__interleave,a=Py(),o=a.makeValidateArgs;function l(h,f){var A,m,g,p,q,x,b,k=arguments;return t.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:for(A=h.start,m=h.step,g=k.length,p=new Array(g>2?g-2:0),q=2;q<g;q++)p[q-2]=k[q];A=A%p.length,x=A;case 4:if(f.done){C.next=13;break}if(b=p[x],b.done){C.next=10;break}return C.next=9,b.value;case 9:b.advance();case 10:x=(x+m)%p.length,C.next=4;break;case 13:case"end":return C.stop()}},e)}function c(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i(h,l,{start:A,step:f})}Vn.__roundRobin=c;var u=s(c,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:o("roundRobin")});return Vn.roundRobin=u,Vn}var bn={},Nu;function Fy(){if(Nu)return bn;Nu=1;function t(o,l){var c;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(c=e(o))||l){c&&(o=c);var u=0,h=function(){};return{s:h,n:function(){return u>=o.length?{done:!0}:{done:!1,value:o[u++]}},e:function(p){throw p},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=!0,A=!1,m;return{s:function(){c=o[Symbol.iterator]()},n:function(){var p=c.next();return f=p.done,p},e:function(p){A=!0,m=p},f:function(){try{!f&&c.return!=null&&c.return()}finally{if(A)throw m}}}}function e(o,l){if(o){if(typeof o=="string")return r(o,l);var c=Object.prototype.toString.call(o).slice(8,-1);if(c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set")return Array.from(o);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(o,l)}}function r(o,l){(l==null||l>o.length)&&(l=o.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=o[c];return u}var s=_t(),n=s.ensureIterable;function i(o){var l=n(o),c=0,u=t(l),h;try{for(u.s();!(h=u.n()).done;){var f=h.value;c++}}catch(A){u.e(A)}finally{u.f()}return c}bn.__size=i;var a=i;return bn.size=a,bn}var wn={},Fu;function Oy(){if(Fu)return wn;Fu=1;var t=hr(),e=t.mark(o);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=s(c))||u){h&&(c=h);var f=0,A=function(){};return{s:A,n:function(){return f>=c.length?{done:!0}:{done:!1,value:c[f++]}},e:function(x){throw x},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,g=!1,p;return{s:function(){h=c[Symbol.iterator]()},n:function(){var x=h.next();return m=x.done,x},e:function(x){g=!0,p=x},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(g)throw p}}}}function s(c,u){if(c){if(typeof c=="string")return n(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return n(c,u)}}function n(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,f=new Array(u);h<u;h++)f[h]=c[h];return f}var i=_t(),a=i.iterableCurry;function o(c,u){var h,f,A,m;return t.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(u!==0){p.next=2;break}return p.abrupt("return");case 2:h=0,f=r(c),p.prev=4,f.s();case 6:if((A=f.n()).done){p.next=14;break}return m=A.value,p.next=10,m;case 10:if(++h!==u){p.next=12;break}return p.abrupt("break",14);case 12:p.next=6;break;case 14:p.next=19;break;case 16:p.prev=16,p.t0=p.catch(4),f.e(p.t0);case 19:return p.prev=19,f.f(),p.finish(19);case 22:case"end":return p.stop()}},e,null,[[4,16,19,22]])}wn.__take=o;var l=a(o);return wn.take=l,wn}var va,Ou;function Ly(){return Ou||(Ou=1,va=Iy().first),va}var Dy=Ly();const Hy=$e(Dy);var _a,Lu;function Gy(){return Lu||(Lu=1,_a=Ry().objectEntries),_a}var Uy=Gy();const jl=$e(Uy);var ka,Du;function Wy(){return Du||(Du=1,ka=By().objectKeys),ka}var Yy=Wy();const fA=$e(Yy);var Sa,Hu;function $y(){return Hu||(Hu=1,Sa=jy().objectValues),Sa}var Xy=$y();const Tr=$e(Xy);var Ca,Gu;function Qy(){return Gu||(Gu=1,Ca=zy().range),Ca}var Ky=Qy();const AA=$e(Ky);var Ma,Uu;function Zy(){return Uu||(Uu=1,Ma=Ny().roundRobin),Ma}var Jy=Zy();const ex=$e(Jy);var Pa,Wu;function tx(){return Wu||(Wu=1,Pa=Fy().size),Pa}var rx=tx();const Lo=$e(rx);var Ea,Yu;function sx(){return Yu||(Yu=1,Ea=Oy().take),Ea}var nx=sx();const ix=$e(nx),fr=(t,{x:e,y:r},s)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:r,...s}}],yield[`${t}.away`,{frame:{x:e+s.w+1,y:r,...s}}],yield[`${t}.towards`,{frame:{x:e,y:r+s.h+1,...s}}],yield[`${t}.right`,{frame:{x:e+s.w+1,y:r+s.h+1,...s}}]}return Object.fromEntries(n())},ve=(t,e,{x:r,y:s},n,i=e)=>{function*a(){for(let o=0;o<e;o++)yield[`${t}.${o+1}`,{frame:{x:r+o%i*(n.w+1),y:s+Math.floor(o/i)*(n.h+1),...n}}]}return Object.fromEntries(a())},ax=(t,e,r,s)=>({...ve(`${t}.left`,e,r,s),...ve(`${t}.away`,e,ar(r,{x:(s.w+1)*e}),s),...ve(`${t}.towards`,e,ar(r,{y:s.h+1}),s),...ve(`${t}.right`,e,ar(r,{x:(s.w+1)*e,y:s.h+1}),s)}),bs=(t,e)=>[...Ce(AA(1,e+1)).map(r=>`${t}.${String(r)}`)],Do={w:32,h:16},xt={w:16,h:56},ie={w:32,h:28},L={w:24,h:24},Un={w:8,h:8},H=t=>({x:t.x*(L.w+1)+1,y:t.y*(L.h+1)+2}),ce=t=>({x:t.x*(ie.w+1)+1,y:t.y*(ie.h+1)+396}),DP=["yellow","cyan","green","magenta","white"],HP=["basic","dimmed"],en=25,GP=1e3/en,is={amigaHiResPal:{x:640,y:512},amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},ox=Object.keys(is),UP={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},fe=(t,e)=>Object.assign([...t],{animationSpeed:e}),lx=.5,pA=5e3,cx=pA*2,ps=(t,e)=>{const r=Math.round(pA/(en*4)),s=`head.walking.${t}.${e}`,n=`head.blinking.${t}`,i=[...new Array(r-3).fill(s),n,s,n];return fe(i,.5)},Ta=(t,e)=>{const r=Math.round(cx/(en*4)),s=`heels.walking.${t}.${e}`,n=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(s),...new Array(Math.ceil(r*.2)).fill(n)];return fe(i,.5)},$u=(t,e,r)=>{const s=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*n(){for(let i=0;i<$r.length;i++){const a=s[i];for(let o=0;o<=2;o++)yield[`${t}.walking.${a}.${o+1}`,{frame:{...H({x:e.x+o,y:e.y+i}),...L}}];yield[`${t}.falling.${a}`,{frame:{...H({x:e.x+3,y:e.y+i}),...L}}],r[a]?.noBlinking||(yield[`${t}.blinking.${a}`,{frame:{...H({x:e.x+4,y:e.y+i}),...L}}])}}return Object.fromEntries(n())};function Xu(t){function*e(r,s){yield`${r}.walking.${s}.1`,yield`${r}.walking.${s}.2`,yield`${r}.walking.${s}.3`,yield`${r}.walking.${s}.2`}return $r.reduce((r,s)=>({...r,[`${t}.walking.${s}`]:fe([...e(t,s)],lx)}),{})}const ux={...ve("bubbles.head",6,H({x:0,y:6}),L),...$u("head",{x:0,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},left:{noBlinking:!0}}),...ve("bubbles.heels",6,H({x:6,y:6}),L),...$u("heels",{x:5,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},awayRight:{noBlinking:!0},towardsLeft:{noBlinking:!0},left:{noBlinking:!0}}),...ve("shine",6,ce({x:8,y:-2}),ie,3),blank:{frame:{...H({x:0,y:2}),...L}}},mA={frames:ux,animations:{...Xu("head"),...Xu("heels"),"heels.screenDirections":fe(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":fe(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":ps("right",3),"head.idle.towards":ps("towards",3),"head.idle.towardsRight":ps("towardsRight",2),"head.idle.towardsLeft":ps("towardsLeft",2),"head.idle.awayRight":ps("awayRight",2),"heels.idle.right":Ta("right",2),"heels.idle.towards":Ta("towards",2),"heels.idle.towardsRight":Ta("towardsRight",2),"head.fadeOut":fe(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":fe(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:fe(bs("shine",6),.5),"shine.headInSymbio":fe(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":fe(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},gA={jail:["bars"],blacktooth:["armour","shield","plain"],bookworld:["cowboy","book"],egyptus:["sarcophagus","hieroglyphics"],market:["passage","fruits","more-fruits"],moonbase:["window1","window2","window3","coil"],penitentiary:["loop","skeleton"],safari:["window","shield","wall"]},WP=Object.keys(gA),YP=["blacktooth","penitentiary","bookworld","egyptus","safari"],Xe=(t,e,r,s)=>{function*n(i,a,o){const l=gA[i],{w:c,h:u}=xt,h=c>>1,f=l.length;let A=0;for(;A<l.length;A++)yield[`${i}${s}.wall.${l[A]}.left`,{frame:{x:a+c*A,y:o-h*A,...xt}}],yield[`${i}${s}.wall.${l[A]}.away`,{frame:{x:a+c*((f<<1)-A-1),y:o-h*A,...xt}}];const m=A-1;yield[`${i}${s}.floor`,{frame:{x:a+m*c,y:o-m*h+u,...Do}}]}return Object.fromEntries(n(t,e,r))},Qu={w:16,h:13},Ku={w:8,h:9},hx={...Xe("blacktooth",542,104,".dark"),...Xe("blacktooth",542,29,""),...Xe("bookworld",408,29,".dark"),...Xe("bookworld",408,29,""),...Xe("egyptus",475,29,""),...Xe("egyptus",475,104,".dark"),...Xe("jail",440,104,".dark"),...Xe("jail",440,104,""),...Xe("market",443,357,".dark"),...Xe("market",443,357,""),...Xe("moonbase",453,276,".dark"),...Xe("moonbase",453,204,""),...Xe("penitentiary",376,357,".dark"),...Xe("penitentiary",376,357,""),...Xe("safari",542,357,".dark"),...Xe("safari",542,357,""),"floorEdge.right":{frame:{x:418,y:466,...Qu,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...Qu,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...Ku,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...Ku,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:xt.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:407,y:143,...Do}},"generic.dark.floor.deadly":{frame:{x:407,y:160,...Do}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:xt.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:xt.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:xt.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:xt.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:xt.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:xt.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:xt.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...ve("moonbase.wall.screen.window1.away",3,{x:566,y:196},{w:10,h:7}),...ve("moonbase.wall.screen.window2.away",2,{x:550,y:188},{w:10,h:7}),...ve("moonbase.wall.screen.window3.away",4,{x:534,y:180},{w:10,h:7})},yA={frames:hx,animations:{"moonbase.wall.screen.window1.away":fe(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":fe(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":fe(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},tn=Object.entries,zl=jl,xA=Object.keys,Nl=fA,dx=Object.fromEntries,as=Object.fromEntries,qA=(t,e)=>{const s=Ce(zl(t)).map(e);return dx(s)},fx={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},VA=t=>fx[t]??t,bA="",Ax="",px="",mx="",gx="󱂩",yx="",xx=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","⚡","🛡","♨","🕹",{char:"∞",double:!0},{char:bA,double:!0},{char:Ax,double:!0}],qx=[" ","?","!",".",",",";",":","/","\\","‘","’","'","`","-","+","%","⬅","➡","⬆","⬇","↖","↘","↗","↙","(",")","[","]","<",">","⏩","⁌","⁍","EnterFullscreen","ExitFullscreen","Menu","*","@",px,mx,gx,yx,"•"],Zu=(t,e)=>{function*r(){let{x:s}=e;for(let n=0;n<t.length;n++){const i=t[n],a=typeof i=="string"?i:i.char,l=(typeof i=="string"?!1:i.double)?Un.w*2:Un.w;yield[`hud.char.${VA(a)}`,{frame:{x:s,y:e.y,...Un,w:l}}],s+=l+1}}return as(r())},Vx={frames:{...Zu(xx,{x:151,y:2}),...Zu(qx,{x:151,y:11})}},jr=(t,e,r)=>{const s=({x:i,y:a,w:o,h:l,pivot:c})=>e==="x"?{...ar(r,{x:-i-o-1,y:a}),w:o,h:l,pivot:{x:o-c.x,y:c.y}}:{...ar(r,{x:i+2,y:a}),w:o,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.whole`,{frame:{...s({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...s({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...s({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...s({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return as(n())},bx={frames:{...jr("generic","y",{x:580,y:415}),...jr("generic","x",{x:582,y:415}),...jr("moonbase","y",{x:451,y:204}),...jr("moonbase","x",{x:582,y:204}),...jr("moonbase.dark","y",{x:451,y:276}),...jr("moonbase.dark","x",{x:582,y:276})}},wx={...ve("dalek",2,H({x:0,y:0}),L),"shadowMask.dalek":{frame:{...H({x:2,y:0}),...L}},...ve("bubbles.cold",2,H({x:3,y:0}),L),...fr("cyberman",H({x:1,y:1}),L),...fr("charles",H({x:3,y:1}),L),"shadowMask.charles.away":{frame:{...H({x:5,y:1}),...L}},"shadowMask.charles.right":{frame:{...H({x:5,y:2}),...L}},...fr("elephant",H({x:6,y:1}),L),"crown.blacktooth":{frame:{...H({x:8,y:1}),...L}},"crown.safari":{frame:{...H({x:9,y:1}),...L}},"crown.egyptus":{frame:{...H({x:10,y:1}),...L}},"crown.penitentiary":{frame:{...H({x:11,y:1}),...L}},"crown.bookworld":{frame:{...H({x:12,y:1}),...L}},ball:{frame:{...H({x:13,y:1}),...L}},"shadowMask.ball":{frame:{...H({x:14,y:1}),...L}},sticks:{frame:{...H({x:8,y:2}),...L}},cube:{frame:{...H({x:9,y:2}),...L}},drum:{frame:{...H({x:10,y:2}),...L}},hooter:{frame:{...H({x:11,y:2}),...L}},bag:{frame:{...H({x:12,y:2}),...L}},joystick:{frame:{...H({x:13,y:2}),...L}},"shadowMask.joystick":{frame:{...H({x:14,y:2}),...L}},...ax("turtle",2,H({x:0,y:3}),L),"shadowMask.turtle.away":{frame:{...H({x:4,y:3}),...L}},"shadowMask.turtle.right":{frame:{...H({x:4,y:4}),...L}},...fr("monkey",H({x:5,y:3}),L),...fr("computerBot",H({x:7,y:3}),L),"spring.compressed":{frame:{...H({x:9,y:3}),...L}},"spring.released":{frame:{...H({x:10,y:3}),...L}},"switch.left":{frame:{...H({x:11,y:3}),...L}},"switch.right":{frame:{...H({x:12,y:3}),...L}},"shadowMask.switch":{frame:{...H({x:13,y:3}),...L}},tower:{frame:{...H({x:14,y:3}),...L}},"shadowMask.tower":{frame:{...H({x:15,y:3}),...L}},scroll:{frame:{...H({x:9,y:4}),...L,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...H({x:10,y:4}),...L,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...H({x:11,y:4}),...L,pivot:{x:17,y:24}}},"spikyBall.1":{frame:{...H({x:12,y:4}),...L}},"spikyBall.2":{frame:{...H({x:13,y:4}),...L}},puck:{frame:{...H({x:14,y:4}),...L}},"shadow.smallRound":{frame:{...H({x:15,y:4}),...L}},"shadowMask.smallRound":{frame:{...H({x:16,y:4}),...L}},...ve("helicopterBug",4,H({x:0,y:5}),L),"barrier.x":{frame:{...H({x:4,y:5}),...L,pivot:{x:18,y:23}}},"barrier.y":{frame:{...H({x:5,y:5}),...L,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...H({x:6,y:5}),...L,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...H({x:7,y:5}),...L,pivot:{x:6,y:22}}},...ve("bubbles.taupe",3,H({x:8,y:5}),L),whiteRabbit:{frame:{...H({x:11,y:5}),...L}},"shadowMask.whiteRabbit":{frame:{...H({x:12,y:5}),...L}},...ve("bubbles.white",3,H({x:13,y:5}),L),...ve("fish",2,H({x:12,y:6}),L),doughnuts:{frame:{...H({x:14,y:6}),...L}},"shadowMask.doughnuts":{frame:{...H({x:15,y:6}),...L}},"lift.static":{frame:{...H({x:10,y:7}),...L}},"shadow.smallBlock":{frame:{...H({x:11,y:7}),...L}},"shadowMask.smallBlock":{frame:{...H({x:12,y:7}),...L}},...ve("lift",4,H({x:10,y:8}),L),headlessBase:{frame:{...H({x:14,y:8}),...L}},...ve("headlessBase",4,H({x:10,y:9}),L),"headlessBase.all":{frame:{...H({x:14,y:9}),...L}},...fr("skiHead.greenAndPink",{x:251,y:252},{w:24,h:32}),...fr("skiHead.starsAndStripes",{x:301,y:252},{w:24,h:32}),"shadowMask.skiHead.away":{frame:{x:351,y:252,w:24,h:32}},"shadowMask.skiHead.right":{frame:{x:351,y:285,w:24,h:32}},"editor.cursor.xz":{frame:{...ce({x:7,y:-2}),...ie}},"editor.cursor.floor":{frame:{...ce({x:7,y:-1}),...ie}},"block.organic":{frame:{...ce({x:0,y:0}),...ie}},"block.organic.disappearing":{frame:{...ce({x:1,y:0}),...ie}},"block.organic.dark":{frame:{...ce({x:2,y:0}),...ie}},"block.organic.dark.disappearing":{frame:{...ce({x:3,y:0}),...ie}},"block.artificial":{frame:{...ce({x:4,y:0}),...ie}},"block.artificial.disappearing":{frame:{...ce({x:5,y:0}),...ie}},"book.x":{frame:{...ce({x:6,y:0}),...ie}},"book.y":{frame:{...ce({x:7,y:0}),...ie}},"shadow.fullBlock":{frame:{...ce({x:8,y:0}),...ie}},"shadowMask.fullBlock":{frame:{...ce({x:9,y:0}),...ie}},stepStool:{frame:{...ce({x:0,y:1}),...ie}},"shadowMask.stepStool":{frame:{...ce({x:1,y:1}),...ie}},"volcano.1":{frame:{...ce({x:2,y:1}),...ie}},"volcano.2":{frame:{...ce({x:3,y:1}),...ie}},"shadowMask.volcano":{frame:{...ce({x:4,y:1}),...ie}},hushPuppy:{frame:{...ce({x:5,y:1}),...ie}},"shadowMask.hushPuppy":{frame:{...ce({x:6,y:1}),...ie}},"toaster.on":{frame:{...ce({x:7,y:1}),...ie}},"toaster.off":{frame:{...ce({x:8,y:1}),...ie}},"shadowMask.toaster":{frame:{...ce({x:9,y:1}),...ie}},sandwich:{frame:{...ce({x:10,y:1}),...ie}},spikes:{frame:{...ce({x:11,y:1}),...ie}},"shadowMask.spikes":{frame:{...ce({x:12,y:1}),...ie}},...ve("conveyor.x",7,ce({x:0,y:2}),ie),"shadowMask.conveyor":{frame:{...ce({x:7,y:2}),...ie}},button:{frame:{...ce({x:9,y:2}),...ie}},"button.pressed":{frame:{...ce({x:10,y:2}),...ie}},"button.surfaceMask":{frame:{...ce({x:11,y:2}),...ie}},...ve("conveyor.y",7,ce({x:0,y:3}),ie),teleporter:{frame:{...ce({x:7,y:3}),...ie}},...ve("teleporter.flashing",2,ce({x:8,y:3}),ie),"shadowMask.teleporter":{frame:{...ce({x:10,y:3}),...ie}},"shadowMask.teleporter.flashing":{frame:{...ce({x:11,y:3}),...ie}},...ve("particle",4,{x:331,y:396},{w:9,h:11})},wA={frames:wx,animations:{"teleporter.flashing":fe(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:fe(["fish.1","fish.2"],.25),lift:fe(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:fe(["dalek.1","dalek.2"],.5),"turtle.left":fe(["turtle.left.1","turtle.left.2"],.25),"turtle.away":fe(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":fe(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":fe(["turtle.right.1","turtle.right.2"],.25),helicopterBug:fe(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":fe(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":fe(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":fe(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":fe(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":fe(bs("conveyor.x",7),.5),"conveyor.y":fe(bs("conveyor.y",7),.5),volcano:fe(bs("volcano",2),3/16),"spring.bounce":fe(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"headlessBase.scan":fe(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":fe(["headlessBase.all","headlessBase"],.5),switch:fe(["switch.left","switch.right"],.02),"particle.fade":fe(bs("particle",4),.5)}},vx={frames:{"editor.tool.save":{frame:{w:12,h:12,x:601,y:0}},"editor.tool.pointer":{frame:{w:12,h:12,x:614,y:0}},"editor.tool.eyedropper":{frame:{w:12,h:12,x:628,y:0}}}},_x={...wA.frames,...mA.frames,...yA.frames,...Vx.frames,...bx.frames,...vx.frames},Gt={frames:_x,animations:{...mA.animations,...wA.animations,...yA.animations},meta:{scale:1}},vA="/assets/sprites-Bpvwd7H2.png";var Ia,Ju;function kx(){if(Ju)return Ia;Ju=1;function t(s){if(Array.isArray(s))return!0;var n=s.length;return typeof n=="number"&&n>-1?n?0 in s&&n-1 in s:!0:!1}function e(s){var n=typeof s;return n==="object"?s===null?"null":t(s)?"array":s.constructor===Object?"pure-object":"object":n}function r(s,n){if(s===n||s!==s&&n!==n)return!0;var i=e(s),a=e(n);if(i!==a)return!1;if(i==="pure-object"){if(s===n)return!0;var o=Object.keys(s),l=Object.keys(n).length;if(o.length!==l)return!1;for(var c=0,u=o.length;c<u;c++){var h=o[c];if(!n.hasOwnProperty(o[c]))return!1;var f=s[h],A=n[h];if(f===s||A===n||f===n||A===s)return f===A;if(!r(f,A))return!1}return!0}else if(i==="array"){if(s.length===n.length)for(var m=0;m<s.length;m++){var g=s[m],p=n[m];if(g===s||p===n||g===n||p===s)return g===p;if(!r(g,p))return!1}else return!1;return!0}else if(i==="object"){if(s.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return s.valueOf()===n.valueOf();if(s.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return s.toString()===n.toString()}return!1}return Ia=r,Ia}var Sx=kx();const Cx=$e(Sx);var Ra={exports:{}},Ba={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eh;function Mx(){if(eh)return Ba;eh=1;var t=rs();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,a=t.useMemo,o=t.useDebugValue;return Ba.useSyncExternalStoreWithSelector=function(l,c,u,h,f){var A=n(null);if(A.current===null){var m={hasValue:!1,value:null};A.current=m}else m=A.current;A=a(function(){function p(P){if(!q){if(q=!0,x=P,P=h(P),f!==void 0&&m.hasValue){var C=m.value;if(f(C,P))return b=C}return b=P}if(C=b,r(x,P))return C;var E=h(P);return f!==void 0&&f(C,E)?(x=P,C):(x=P,b=E)}var q=!1,x,b,k=u===void 0?null:u;return[function(){return p(c())},k===null?void 0:function(){return p(k())}]},[c,u,h,f]);var g=s(l,A[0],A[1]);return i(function(){m.hasValue=!0,m.value=g},[g]),o(g),g},Ba}var th;function Px(){return th||(th=1,Ra.exports=Mx()),Ra.exports}var Ex=Px();function Tx(t){t()}function Ix(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Tx(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var rh={notify(){},get:()=>[]};function Rx(t,e){let r,s=rh,n=0,i=!1;function a(g){u();const p=s.subscribe(g);let q=!1;return()=>{q||(q=!0,p(),h())}}function o(){s.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){n++,r||(r=t.subscribe(l),s=Ix())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=rh)}function f(){i||(i=!0,u())}function A(){i&&(i=!1,h())}const m={addNestedSub:a,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:f,tryUnsubscribe:A,getListeners:()=>s};return m}var Bx=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jx=Bx(),zx=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Nx=zx(),Fx=()=>jx||Nx?I.useLayoutEffect:I.useEffect,Ox=Fx(),Lx=Symbol.for("react-redux-context"),Dx=typeof globalThis<"u"?globalThis:{};function Hx(){if(!I.createContext)return{};const t=Dx[Lx]??=new Map;let e=t.get(I.createContext);return e||(e=I.createContext(null),t.set(I.createContext,e)),e}var lr=Hx();function Gx(t){const{children:e,context:r,serverState:s,store:n}=t,i=I.useMemo(()=>{const l=Rx(n);return{store:n,subscription:l,getServerState:s?()=>s:void 0}},[n,s]),a=I.useMemo(()=>n.getState(),[n]);Ox(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,a]);const o=r||lr;return I.createElement(o.Provider,{value:i},e)}var Ux=Gx;function Fl(t=lr){return function(){return I.useContext(t)}}var _A=Fl();function kA(t=lr){const e=t===lr?_A:Fl(t),r=()=>{const{store:s}=e();return s};return Object.assign(r,{withTypes:()=>r}),r}var SA=kA();function Wx(t=lr){const e=t===lr?SA:kA(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var Yx=Wx(),$x=(t,e)=>t===e;function Xx(t=lr){const e=t===lr?_A:Fl(t),r=(s,n={})=>{const{equalityFn:i=$x}=typeof n=="function"?{equalityFn:n}:n,a=e(),{store:o,subscription:l,getServerState:c}=a;I.useRef(!0);const u=I.useCallback({[s.name](f){return s(f)}}[s.name],[s]),h=Ex.useSyncExternalStoreWithSelector(l.addNestedSub,o.getState,c||o.getState,u,i);return I.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var Qx=Xx();const Ol=Yx.withTypes(),oe=Qx.withTypes();SA.withTypes();const Ie={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},sh=qA(Ie,([t,e])=>[e,t]),Kx={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},Zx={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},kt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},CA=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...Zs],MA=[...CA,...Zs],Wn={presses:as(MA.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[]}},nh=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Ir(...t){return{presses:t.reduce((e,r)=>{for(const s of MA)e[s]={keys:nh(e[s]?.keys,r?.presses?.[s]?.keys),gamepadButtons:nh(e[s]?.gamepadButtons,r?.presses?.[s]?.gamepadButtons)};return e},structuredClone(Wn.presses)),axes:{x:Array.from(new Set([...Wn.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...Wn.axes.y,...t.map(e=>e.axes?.y??[]).flat()]))}}}const Rr={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape","§"]},menu_exit:{gamepadButtons:[Ie.b]},menu_select:{keys:["Enter"],gamepadButtons:[Ie.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},os={inputAssignment:Ir(Rr,{presses:{right:{gamepadButtons:[Ie.dPadRight]},towards:{gamepadButtons:[Ie.dPadDown]},left:{gamepadButtons:[Ie.dPadLeft]},away:{gamepadButtons:[Ie.dPadUp]},jump:{gamepadButtons:[Ie.a,Ie.y]},carry:{gamepadButtons:[Ie.x,Ie.y]},fire:{gamepadButtons:[Ie.b]},swop:{gamepadButtons:[Ie.rb]},"swop.head":{gamepadButtons:[Ie.l3]},"swop.heels":{gamepadButtons:[Ie.r3]},hold:{gamepadButtons:[Ie.start]},menu_openOrExit:{gamepadButtons:[Ie.select]},map:{gamepadButtons:[Ie.lb]},toggleColourisation:{gamepadButtons:[Ie.lt]}},axes:{x:[0],y:[1]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},Jx={inputAssignment:Ir(Rr,os.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},eq={inputAssignment:Ir(Rr,os.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},tq={inputAssignment:Ir(Rr,os.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M","Tab"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},rq={inputAssignment:Ir(Rr,os.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},sq={inputAssignment:Ir(Rr,os.inputAssignment,{presses:{right:{keys:[kt.dPadRight]},towards:{keys:[kt.dPadDown]},left:{keys:[kt.dPadLeft]},away:{keys:[kt.dPadUp]},jump:{keys:[kt.a,kt.y]},carry:{keys:[kt.b,kt.y]},fire:{keys:[kt.x]},swop:{keys:[kt.rb]},hold:{keys:[kt.start]},menu_openOrExit:{keys:[kt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that don’t support controllers"},ih=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]}}}),nq={inputAssignment:Ir(Wn,Rr,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},ih(Kx),ih(Zx)),description:"MAME key mappings. For arcade-style control panels"},Xr={default:tq,"zx spectrum":Jx,amiga:eq,mame:nq,wasd:rq,"🕹 8bitdo keyboard mode":sq,"🕹 joystick":os},Et=()=>Vt()==="mobile"||Vt()==="tablet",Vt=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},iq=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Ll={inputAssignment:Xr.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:Vt()==="mobile"?"handheld":"zxSpectrum"},showFps:!1,onScreenControls:Vt()==="mobile"||Vt()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1,soundSettings:{mute:!1,noFootsteps:!1}},ri=(t,e)=>e.split(".").reduce((r,s)=>r[s],t),aq=(t,e,r)=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){const a=s[i];n=n[a]}n[s[s.length-1]]=r};function Ue(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var oq=typeof Symbol=="function"&&Symbol.observable||"@@observable",ah=oq,ja=()=>Math.random().toString(36).substring(7).split("").join("."),lq={INIT:`@@redux/INIT${ja()}`,REPLACE:`@@redux/REPLACE${ja()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ja()}`},si=lq;function Dl(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Hl(t,e,r){if(typeof t!="function")throw new Error(Ue(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ue(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ue(1));return r(Hl)(t,e)}let s=t,n=e,i=new Map,a=i,o=0,l=!1;function c(){a===i&&(a=new Map,i.forEach((p,q)=>{a.set(q,p)}))}function u(){if(l)throw new Error(Ue(3));return n}function h(p){if(typeof p!="function")throw new Error(Ue(4));if(l)throw new Error(Ue(5));let q=!0;c();const x=o++;return a.set(x,p),function(){if(q){if(l)throw new Error(Ue(6));q=!1,c(),a.delete(x),i=null}}}function f(p){if(!Dl(p))throw new Error(Ue(7));if(typeof p.type>"u")throw new Error(Ue(8));if(typeof p.type!="string")throw new Error(Ue(17));if(l)throw new Error(Ue(9));try{l=!0,n=s(n,p)}finally{l=!1}return(i=a).forEach(x=>{x()}),p}function A(p){if(typeof p!="function")throw new Error(Ue(10));s=p,f({type:si.REPLACE})}function m(){const p=h;return{subscribe(q){if(typeof q!="object"||q===null)throw new Error(Ue(11));function x(){const k=q;k.next&&k.next(u())}return x(),{unsubscribe:p(x)}},[ah](){return this}}}return f({type:si.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:A,[ah]:m}}function cq(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:si.INIT})>"u")throw new Error(Ue(12));if(typeof r(void 0,{type:si.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ue(13))})}function PA(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const a=e[i];typeof t[a]=="function"&&(r[a]=t[a])}const s=Object.keys(r);let n;try{cq(r)}catch(i){n=i}return function(a={},o){if(n)throw n;let l=!1;const c={};for(let u=0;u<s.length;u++){const h=s[u],f=r[h],A=a[h],m=f(A,o);if(typeof m>"u")throw o&&o.type,new Error(Ue(14));c[h]=m,l=l||m!==A}return l=l||s.length!==Object.keys(a).length,l?c:a}}function ni(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function uq(...t){return e=>(r,s)=>{const n=e(r,s);let i=()=>{throw new Error(Ue(15))};const a={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},o=t.map(l=>l(a));return i=ni(...o)(n.dispatch),{...n,dispatch:i}}}function EA(t){return Dl(t)&&"type"in t&&typeof t.type=="string"}var TA=Symbol.for("immer-nothing"),oh=Symbol.for("immer-draftable"),wt=Symbol.for("immer-state");function Rt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Qr=Object.getPrototypeOf;function Mr(t){return!!t&&!!t[wt]}function er(t){return t?IA(t)||Array.isArray(t)||!!t[oh]||!!t.constructor?.[oh]||ki(t)||Si(t):!1}var hq=Object.prototype.constructor.toString();function IA(t){if(!t||typeof t!="object")return!1;const e=Qr(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===hq}function ii(t,e){_i(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,s)=>e(s,r,t))}function _i(t){const e=t[wt];return e?e.type_:Array.isArray(t)?1:ki(t)?2:Si(t)?3:0}function Ho(t,e){return _i(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function RA(t,e,r){const s=_i(t);s===2?t.set(e,r):s===3?t.add(r):t[e]=r}function dq(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ki(t){return t instanceof Map}function Si(t){return t instanceof Set}function pr(t){return t.copy_||t.base_}function Go(t,e){if(ki(t))return new Map(t);if(Si(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=IA(t);if(e===!0||e==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[wt];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const a=n[i],o=s[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(s[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[a]})}return Object.create(Qr(t),s)}else{const s=Qr(t);if(s!==null&&r)return{...t};const n=Object.create(s);return Object.assign(n,t)}}function Gl(t,e=!1){return Ci(t)||Mr(t)||!er(t)||(_i(t)>1&&(t.set=t.add=t.clear=t.delete=fq),Object.freeze(t),e&&Object.entries(t).forEach(([r,s])=>Gl(s,!0))),t}function fq(){Rt(2)}function Ci(t){return Object.isFrozen(t)}var Aq={};function Pr(t){const e=Aq[t];return e||Rt(0,t),e}var Ns;function BA(){return Ns}function pq(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function lh(t,e){e&&(Pr("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Uo(t){Wo(t),t.drafts_.forEach(mq),t.drafts_=null}function Wo(t){t===Ns&&(Ns=t.parent_)}function ch(t){return Ns=pq(Ns,t)}function mq(t){const e=t[wt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function uh(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[wt].modified_&&(Uo(e),Rt(4)),er(t)&&(t=ai(e,t),e.parent_||oi(e,t)),e.patches_&&Pr("Patches").generateReplacementPatches_(r[wt].base_,t,e.patches_,e.inversePatches_)):t=ai(e,r,[]),Uo(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==TA?t:void 0}function ai(t,e,r){if(Ci(e))return e;const s=e[wt];if(!s)return ii(e,(n,i)=>hh(t,s,e,n,i,r)),e;if(s.scope_!==t)return e;if(!s.modified_)return oi(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,a=!1;s.type_===3&&(i=new Set(n),n.clear(),a=!0),ii(i,(o,l)=>hh(t,s,n,o,l,r,a)),oi(t,n,!1),r&&t.patches_&&Pr("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function hh(t,e,r,s,n,i,a){if(Mr(n)){const o=i&&e&&e.type_!==3&&!Ho(e.assigned_,s)?i.concat(s):void 0,l=ai(t,n,o);if(RA(r,s,l),Mr(l))t.canAutoFreeze_=!1;else return}else a&&r.add(n);if(er(n)&&!Ci(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ai(t,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,s)&&oi(t,n)}}function oi(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Gl(e,r)}function gq(t,e){const r=Array.isArray(t),s={type_:r?1:0,scope_:e?e.scope_:BA(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=Ul;r&&(n=[s],i=Fs);const{revoke:a,proxy:o}=Proxy.revocable(n,i);return s.draft_=o,s.revoke_=a,o}var Ul={get(t,e){if(e===wt)return t;const r=pr(t);if(!Ho(r,e))return yq(t,r,e);const s=r[e];return t.finalized_||!er(s)?s:s===za(t.base_,e)?(Na(t),t.copy_[e]=$o(s,t)):s},has(t,e){return e in pr(t)},ownKeys(t){return Reflect.ownKeys(pr(t))},set(t,e,r){const s=jA(pr(t),e);if(s?.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const n=za(pr(t),e),i=n?.[wt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(dq(r,n)&&(r!==void 0||Ho(t.base_,e)))return!0;Na(t),Yo(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return za(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Na(t),Yo(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=pr(t),s=Reflect.getOwnPropertyDescriptor(r,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:r[e]}},defineProperty(){Rt(11)},getPrototypeOf(t){return Qr(t.base_)},setPrototypeOf(){Rt(12)}},Fs={};ii(Ul,(t,e)=>{Fs[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Fs.deleteProperty=function(t,e){return Fs.set.call(this,t,e,void 0)};Fs.set=function(t,e,r){return Ul.set.call(this,t[0],e,r,t[0])};function za(t,e){const r=t[wt];return(r?pr(r):t)[e]}function yq(t,e,r){const s=jA(e,r);return s?"value"in s?s.value:s.get?.call(t.draft_):void 0}function jA(t,e){if(!(e in t))return;let r=Qr(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,e);if(s)return s;r=Qr(r)}}function Yo(t){t.modified_||(t.modified_=!0,t.parent_&&Yo(t.parent_))}function Na(t){t.copy_||(t.copy_=Go(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var xq=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,s)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const a=this;return function(l=i,...c){return a.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Rt(6),s!==void 0&&typeof s!="function"&&Rt(7);let n;if(er(e)){const i=ch(this),a=$o(e,void 0);let o=!0;try{n=r(a),o=!1}finally{o?Uo(i):Wo(i)}return lh(i,s),uh(n,i)}else if(!e||typeof e!="object"){if(n=r(e),n===void 0&&(n=e),n===TA&&(n=void 0),this.autoFreeze_&&Gl(n,!0),s){const i=[],a=[];Pr("Patches").generateReplacementPatches_(e,n,i,a),s(i,a)}return n}else Rt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let s,n;return[this.produce(e,r,(a,o)=>{s=a,n=o}),s,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){er(t)||Rt(8),Mr(t)&&(t=qq(t));const e=ch(this),r=$o(t,void 0);return r[wt].isManual_=!0,Wo(e),r}finishDraft(t,e){const r=t&&t[wt];(!r||!r.isManual_)&&Rt(9);const{scope_:s}=r;return lh(s,e),uh(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(e=e.slice(r+1));const s=Pr("Patches").applyPatches_;return Mr(t)?s(t,e):this.produce(t,n=>s(n,e))}};function $o(t,e){const r=ki(t)?Pr("MapSet").proxyMap_(t,e):Si(t)?Pr("MapSet").proxySet_(t,e):gq(t,e);return(e?e.scope_:BA()).drafts_.push(r),r}function qq(t){return Mr(t)||Rt(10,t),zA(t)}function zA(t){if(!er(t)||Ci(t))return t;const e=t[wt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Go(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Go(t,!0);return ii(r,(s,n)=>{RA(r,s,zA(n))}),e&&(e.finalized_=!1),r}var vt=new xq,NA=vt.produce;vt.produceWithPatches.bind(vt);vt.setAutoFreeze.bind(vt);vt.setUseStrictShallowCopy.bind(vt);vt.applyPatches.bind(vt);vt.createDraft.bind(vt);vt.finishDraft.bind(vt);function FA(t){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,t):n(i)}var Vq=FA(),bq=FA,wq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ni:ni.apply(null,arguments)};function Kr(t,e){function r(...s){if(e){let n=e(...s);if(!n)throw new Error(st(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>EA(s)&&s.type===t,r}var OA=class ws extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ws.prototype)}static get[Symbol.species](){return ws}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ws(...e[0].concat(this)):new ws(...e.concat(this))}};function dh(t){return er(t)?NA(t,()=>{}):t}function Xo(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function vq(t){return typeof t=="boolean"}var _q=()=>function(e){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let a=new OA;return r&&(vq(r)?a.push(Vq):a.push(bq(r.extraArgument))),a},kq="RTK_autoBatch",fh=t=>e=>{setTimeout(e,t)},Sq=(t={type:"raf"})=>e=>(...r)=>{const s=e(...r);let n=!0,i=!1,a=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:fh(10):t.type==="callback"?t.queueNotification:fh(t.timeout),c=()=>{a=!1,i&&(i=!1,o.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const h=()=>n&&u(),f=s.subscribe(h);return o.add(u),()=>{f(),o.delete(u)}},dispatch(u){try{return n=!u?.meta?.[kq],i=!n,i&&(a||(a=!0,l(c))),s.dispatch(u)}finally{n=!0}}})},Cq=t=>function(r){const{autoBatch:s=!0}=r??{};let n=new OA(t);return s&&n.push(Sq(typeof s=="object"?s:void 0)),n};function Mq(t){const e=_q(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:a=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Dl(r))o=PA(r);else throw new Error(st(1));let l;typeof s=="function"?l=s(e):l=e();let c=ni;n&&(c=wq({trace:!1,...typeof n=="object"&&n}));const u=uq(...l),h=Cq(u);let f=typeof a=="function"?a(h):h();const A=c(...f);return Hl(o,i,A)}function LA(t){const e={},r=[];let s;const n={addCase(i,a){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(st(28));if(o in e)throw new Error(st(29));return e[o]=a,n},addMatcher(i,a){return r.push({matcher:i,reducer:a}),n},addDefaultCase(i){return s=i,n}};return t(n),[e,r,s]}function Pq(t){return typeof t=="function"}function Eq(t,e){let[r,s,n]=LA(e),i;if(Pq(t))i=()=>dh(t());else{const o=dh(t);i=()=>o}function a(o=i(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(Mr(u)){const A=h(u,l);return A===void 0?u:A}else{if(er(u))return NA(u,f=>h(f,l));{const f=h(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},o)}return a.getInitialState=i,a}var Tq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",DA=(t=21)=>{let e="",r=t;for(;r--;)e+=Tq[Math.random()*64|0];return e},Iq=Symbol.for("rtk-slice-createasyncthunk");function Rq(t,e){return`${t}/${e}`}function Bq({creators:t}={}){const e=t?.asyncThunk?.[Iq];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(st(11));const a=(typeof s.reducers=="function"?s.reducers(zq()):s.reducers)||{},o=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(x,b){const k=typeof x=="string"?x:x.type;if(!k)throw new Error(st(12));if(k in l.sliceCaseReducersByType)throw new Error(st(13));return l.sliceCaseReducersByType[k]=b,c},addMatcher(x,b){return l.sliceMatchers.push({matcher:x,reducer:b}),c},exposeAction(x,b){return l.actionCreators[x]=b,c},exposeCaseReducer(x,b){return l.sliceCaseReducersByName[x]=b,c}};o.forEach(x=>{const b=a[x],k={reducerName:x,type:Rq(n,x),createNotation:typeof s.reducers=="function"};Fq(b)?Lq(k,b,c,e):Nq(k,b,c)});function u(){const[x={},b=[],k=void 0]=typeof s.extraReducers=="function"?LA(s.extraReducers):[s.extraReducers],P={...x,...l.sliceCaseReducersByType};return Eq(s.initialState,C=>{for(let E in P)C.addCase(E,P[E]);for(let E of l.sliceMatchers)C.addMatcher(E.matcher,E.reducer);for(let E of b)C.addMatcher(E.matcher,E.reducer);k&&C.addDefaultCase(k)})}const h=x=>x,f=new Map;let A;function m(x,b){return A||(A=u()),A(x,b)}function g(){return A||(A=u()),A.getInitialState()}function p(x,b=!1){function k(C){let E=C[x];return typeof E>"u"&&b&&(E=g()),E}function P(C=h){const E=Xo(f,b,()=>new WeakMap);return Xo(E,C,()=>{const z={};for(const[B,R]of Object.entries(s.selectors??{}))z[B]=jq(R,C,g,b);return z})}return{reducerPath:x,getSelectors:P,get selectors(){return P(k)},selectSlice:k}}const q={name:n,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g,...p(i),injectInto(x,{reducerPath:b,...k}={}){const P=b??i;return x.inject({reducerPath:P,reducer:m},k),{...q,...p(P,!0)}}};return q}}function jq(t,e,r,s){function n(i,...a){let o=e(i);return typeof o>"u"&&s&&(o=r()),t(o,...a)}return n.unwrapped=t,n}var HA=Bq();function zq(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function Nq({type:t,reducerName:e,createNotation:r},s,n){let i,a;if("reducer"in s){if(r&&!Oq(s))throw new Error(st(17));i=s.reducer,a=s.prepare}else i=s;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,a?Kr(t,a):Kr(t))}function Fq(t){return t._reducerDefinitionType==="asyncThunk"}function Oq(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Lq({type:t,reducerName:e},r,s,n){if(!n)throw new Error(st(18));const{payloadCreator:i,fulfilled:a,pending:o,rejected:l,settled:c,options:u}=r,h=n(t,i,u);s.exposeAction(e,h),a&&s.addCase(h.fulfilled,a),o&&s.addCase(h.pending,o),l&&s.addCase(h.rejected,l),c&&s.addMatcher(h.settled,c),s.exposeCaseReducer(e,{fulfilled:a||vn,pending:o||vn,rejected:l||vn,settled:c||vn})}function vn(){}var Dq="task",GA="listener",UA="completed",Wl="cancelled",Hq=`task-${Wl}`,Gq=`task-${UA}`,Qo=`${GA}-${Wl}`,Uq=`${GA}-${UA}`,Mi=class{constructor(t){this.code=t,this.message=`${Dq} ${Wl} (reason: ${t})`}name="TaskAbortError";message},Yl=(t,e)=>{if(typeof t!="function")throw new TypeError(st(32))},li=()=>{},WA=(t,e=li)=>(t.catch(e),t),YA=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),kr=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Sr=t=>{if(t.aborted){const{reason:e}=t;throw new Mi(e)}};function $A(t,e){let r=li;return new Promise((s,n)=>{const i=()=>n(new Mi(t.reason));if(t.aborted){i();return}r=YA(t,i),e.finally(()=>r()).then(s,n)}).finally(()=>{r=li})}var Wq=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Mi?"cancelled":"rejected",error:r}}finally{e?.()}},ci=t=>e=>WA($A(t,e).then(r=>(Sr(t),r))),XA=t=>{const e=ci(t);return r=>e(new Promise(s=>setTimeout(s,r)))},{assign:Ur}=Object,Ah={},Pi="listenerMiddleware",Yq=(t,e)=>{const r=s=>YA(t,()=>kr(s,t.reason));return(s,n)=>{Yl(s);const i=new AbortController;r(i);const a=Wq(async()=>{Sr(t),Sr(i.signal);const o=await s({pause:ci(i.signal),delay:XA(i.signal),signal:i.signal});return Sr(i.signal),o},()=>kr(i,Gq));return n?.autoJoin&&e.push(a.catch(li)),{result:ci(t)(a),cancel(){kr(i,Hq)}}}},$q=(t,e)=>{const r=async(s,n)=>{Sr(e);let i=()=>{};const o=[new Promise((l,c)=>{let u=t({predicate:s,effect:(h,f)=>{f.unsubscribe(),l([h,f.getState(),f.getOriginalState()])}});i=()=>{u(),c()}})];n!=null&&o.push(new Promise(l=>setTimeout(l,n,null)));try{const l=await $A(e,Promise.race(o));return Sr(e),l}finally{i()}};return(s,n)=>WA(r(s,n))},QA=t=>{let{type:e,actionCreator:r,matcher:s,predicate:n,effect:i}=t;if(e)n=Kr(e).match;else if(r)e=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(st(21));return Yl(i),{predicate:n,type:e,effect:i}},KA=Ur(t=>{const{type:e,predicate:r,effect:s}=QA(t);return{id:DA(),effect:s,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(st(22))}}},{withTypes:()=>KA}),ph=(t,e)=>{const{type:r,effect:s,predicate:n}=QA(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},Ko=t=>{t.pending.forEach(e=>{kr(e,Qo)})},Xq=t=>()=>{t.forEach(Ko),t.clear()},mh=(t,e,r)=>{try{t(e,r)}catch(s){setTimeout(()=>{throw s},0)}},ZA=Ur(Kr(`${Pi}/add`),{withTypes:()=>ZA}),Qq=Kr(`${Pi}/removeAll`),JA=Ur(Kr(`${Pi}/remove`),{withTypes:()=>JA}),Kq=(...t)=>{console.error(`${Pi}/error`,...t)},Zq=(t={})=>{const e=new Map,{extra:r,onError:s=Kq}=t;Yl(s);const n=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Ko(u)}),i=u=>{const h=ph(e,u)??KA(u);return n(h)};Ur(i,{withTypes:()=>i});const a=u=>{const h=ph(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Ko(h)),!!h};Ur(a,{withTypes:()=>a});const o=async(u,h,f,A)=>{const m=new AbortController,g=$q(i,m.signal),p=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,Ur({},f,{getOriginalState:A,condition:(q,x)=>g(q,x).then(Boolean),take:g,delay:XA(m.signal),pause:ci(m.signal),extra:r,signal:m.signal,fork:Yq(m.signal,p),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((q,x,b)=>{q!==m&&(kr(q,Qo),b.delete(q))})},cancel:()=>{kr(m,Qo),u.pending.delete(m)},throwIfCancelled:()=>{Sr(m.signal)}})))}catch(q){q instanceof Mi||mh(s,q,{raisedBy:"effect"})}finally{await Promise.all(p),kr(m,Uq),u.pending.delete(m)}},l=Xq(e);return{middleware:u=>h=>f=>{if(!EA(f))return h(f);if(ZA.match(f))return i(f.payload);if(Qq.match(f)){l();return}if(JA.match(f))return a(f.payload);let A=u.getState();const m=()=>{if(A===Ah)throw new Error(st(23));return A};let g;try{if(g=h(f),e.size>0){const p=u.getState(),q=Array.from(e.values());for(const x of q){let b=!1;try{b=x.predicate(f,p,A)}catch(k){b=!1,mh(s,k,{raisedBy:"predicate"})}b&&o(x,f,u,m)}}}finally{A=Ah}return g},startListening:i,stopListening:a,clearListeners:l}},Jq=t=>"reducerPath"in t&&typeof t.reducerPath=="string",eV=t=>t.flatMap(e=>Jq(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),$l=Symbol.for("rtk-state-proxy-original"),tV=t=>!!t&&!!t[$l],rV=new WeakMap,sV=(t,e)=>Xo(rV,t,()=>new Proxy(t,{get:(r,s,n)=>{if(s===$l)return r;const i=Reflect.get(r,s,n);if(typeof i>"u"){const a=e[s.toString()];if(a){const o=a(void 0,{type:DA()});if(typeof o>"u")throw new Error(st(24));return o}}return i}})),nV=t=>{if(!tV(t))throw new Error(st(25));return t[$l]},iV=(t={})=>t;function aV(...t){const e=Object.fromEntries(eV(t)),r=()=>Object.keys(e).length?PA(e):iV;let s=r();function n(o,l){return s(o,l)}n.withLazyLoadedSlices=()=>n;const i=(o,l={})=>{const{reducerPath:c,reducer:u}=o,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,s=r()),n},a=Object.assign(function(l,c){return function(h,...f){return l(sV(c?c(h,...f):h,e),...f)}},{original:nV});return Object.assign(n,{inject:i,selector:a})}function st(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const oV=t=>Vt()==="server"?is.zxSpectrum:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},Xl=(t,e)=>{const r=Vt();return{renderAreaSize:oV(e),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio}},lV=8,ep=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:s=Vt()})=>{const n=is[e],{renderAreaSize:i,rotate90:a}=s!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},o=El(i,r),l=Math.max(Math.floor(Math.min(o.x/n.x,o.y/n.y)),1),c=Math.min(lV,l),u=l/c/r,h={x:Math.floor(o.x/l),y:Math.floor(o.y/l)},f={x:Math.ceil(i.x/u),y:Math.ceil(i.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:h,canvasSize:f,rotate90:a}},cV={upscale:ep(Xl(Ll.displaySettings.emulatedResolution))},ui=HA({name:"upscale",initialState:cV,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=ep(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:tp}=ui.actions,{selectCanvasSize:uV,selectRot90:hV,selectUpscale:dV,selectGameEngineUpscale:$P,selectTotalUpscale:fV,selectGameEngineScreenSize:XP}=ui.selectors,ht=t=>e=>ri(e.gameMenus.userSettings,t)??ri(Ll,t),rn=()=>oe(fV),hi=ht("inputAssignment"),QP=t=>t.gameMenus.openMenus.length>0,rp=()=>oe(t=>t.gameMenus.cheatsOn),sp=t=>t.gameMenus.assigningInput!==void 0,np=()=>oe(sp),AV=t=>{for(const[e,r]of Ce(zl(Xr)))if(Cx(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},Zr=()=>oe(t=>t.gameMenus.gameRunning),pV=ht("showFps"),Ei=ht("displaySettings.emulatedResolution"),mV=()=>oe(Ei),gV=ht("displaySettings.uncolourised"),Ql=()=>oe(gV),yV=ht("displaySettings.crtFilter"),ip=ht("infiniteLivesPoke"),ap=ht("infiniteDoughnutsPoke"),KP=t=>t.gameMenus.planetsLiberated.egyptus&&t.gameMenus.planetsLiberated.bookworld&&t.gameMenus.planetsLiberated.penitentiary&&t.gameMenus.planetsLiberated.safari,di=()=>oe(t=>t.gameMenus.userSettings.screenRelativeControl),Kl=ht("inputDirectionMode"),op=()=>oe(Kl),xV=t=>Lo(Ce(Tr(t.gameMenus.planetsLiberated)).filter(Boolean)),qV=ht("displaySettings.showBoundingBoxes"),ZP=()=>oe(qV),VV=ht("displaySettings.showShadowMasks"),JP=()=>oe(VV),bV=ht("screenRelativeControl"),wV=ht("onScreenControls"),vV=ht("soundSettings.mute"),_V=ht("soundSettings.noFootsteps"),eE=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??Ll.onScreenControls)&&e.upscale.rotate90===!1,kV=()=>oe(wV),tE=(t,e)=>!!ri(t.gameMenus,e),SV=()=>oe(t=>t.gameMenus.roomsExplored),Ts=({children:t,scaleFactor:e})=>{const r=rn();return d.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},Zo=4,_n=20,CV=()=>{const t=Object.keys(Gt.frames).sort();return d.jsxs(d.Fragment,{children:[d.jsx("img",{src:vA,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),d.jsx("title",{children:"Sprites"}),d.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:t.map(e=>{const{frame:r}=Gt.frames[e],s=r;return d.jsxs("div",{className:"bg-shadow m-[8px] p-[16px] text-center flex flex-col",children:[d.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border-1 mb-1 box-content mx-auto w-min",style:{"--x":`${Gt.frames[e].frame.x}px`,"--y":`${Gt.frames[e].frame.y}px`,"--h":`${Gt.frames[e].frame.h}px`,"--w":`${Gt.frames[e].frame.w}px`},children:s.pivot?d.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${_n}px`,height:`${_n}px`,left:`${s.pivot.x*Zo-_n/2}px`,top:`${s.pivot.y*Zo-_n/2}px`}}):null}),d.jsx("div",{className:"flex-grow"}),d.jsx("div",{className:"text-moss",children:e}),d.jsxs("div",{className:"text-lightGrey",children:[r.w," x ",r.h]}),d.jsx("div",{className:"text-midRed",children:s.pivot?d.jsxs(d.Fragment,{children:["pivot: (",s.pivot.x,", ",s.pivot.y,")"]}):"no pivot"}),d.jsxs("div",{className:"text-midGrey",children:["@(",r.x,", ",r.y,")"]})]},e)})})]})},MV=()=>d.jsx(Ts,{scaleFactor:Zo,children:d.jsx(CV,{})}),Zl=I.createContext(null),PV=({gameApi:t,children:e})=>d.jsx(Zl,{value:t,children:e}),Br=()=>{const t=I.useContext(Zl);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},EV=()=>{const t=I.useContext(Zl);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},Os=(t,...e)=>{const r={};for(const s of e)r[s]=t[s];return r},rE=(t,...e)=>{const r={...t};for(const s of e)delete r[s];return r},vs=t=>JSON.parse(JSON.stringify(t)),TV=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],IV=["planetsLiberated","scrollsRead","roomsExplored","reincarnationPoint"],RV=(t,e)=>Ce(Nl(t)).map(r=>{const s=e.items[r];if(s===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return s});function BV(t,e){return t===null?null:e.items[t]}const ae={w:16,d:16,h:12},gh={x:16,y:16,z:12},jV=["head","heels"],zV=[...jV,"headOverHeels"],Jo=t=>t==="head"?"heels":"head",Ee=(...t)=>e=>t.includes(e.type),NV=Ee("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),FV=(t,e)=>NV(t)||WV(t)&&(e!==void 0&&cp(e)||t.config.direction.z!==0)||fi(t)&&t.config.floorType==="none",el=(t,e)=>!FV(t,e),OV=t=>t.type==="movingPlatform"||t.type==="pushableBlock",sE=(t,e,r=!1)=>Jl(e)&&!(!r&&cp(e)&&e.state.autoWalk)&&!(YV(t)&&OV(e))&&!(ec(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),lp=["ball","slidingBlock","slidingDeadly"],nE=Ee(...lp),LV=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],DV=["dalek","turtle","elephantHead","homingBot","helicopterBug"],iE=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?DV.includes(t.config.which):LV.includes(t.type),cp=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function Jl(t){return up.includes(t.type)}const up=[...zV,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],HV=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],GV=Ee(...HV),aE=t=>ec(t)&&!t.state.activated?!1:GV(t)||t.type==="floor"&&t.config.floorType==="deadly",UV=t=>t.config.times!==void 0,WV=Ee("portal"),oE=Ee("teleporter");Ee("heels");Ee("head");const lE=Ee("heels","headOverHeels"),cE=Ee("head","headOverHeels"),YV=Ee("lift"),uE=Ee("emitter"),ec=Ee("monster"),fi=Ee("floor"),$V=Ee("pickup"),hE=t=>$V(t)&&t.config.gives==="crown",dE=Ee("spring"),fE=Ee("joystick"),AE=Ee("monster","movingPlatform"),pE=t=>ec(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,yh=(t,e)=>{if(t.state.standingOnItemId!==null){const r=BV(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime}},Ai=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;Jl(r)&&yh(r,t);for(const s of RV(r.state.stoodOnBy,t))yh(s,t);typeof e=="string"?delete t.items[e]:delete t.items[r.id]},XV=(t,e,r)=>{const s=vs({saveTime:Date.now(),screenshotBase64:"IAMANIMAGE",campaignId:"original",gameState:Os(t,...TV),store:{gameMenus:Os(e.gameMenus,...IV)}});if(r!==void 0){const n=s.gameState,i=n.characterRooms[n.currentCharacterName];if(!i)throw new Error("how are we saving from a pickup if there is no current room?");Ai({room:i,item:i.items[r]})}return s},xh=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]};var tc="persist:",rc="persist/FLUSH",sn="persist/REHYDRATE",sc="persist/PAUSE",nc="persist/PERSIST",ic="persist/PURGE",ac="persist/REGISTER",hp=-1;function Yn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yn=function(r){return typeof r}:Yn=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Yn(t)}function qh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function QV(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qh(r,!0).forEach(function(s){KV(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qh(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function KV(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZV(t,e,r,s){s.debug;var n=QV({},r);return t&&Yn(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(n[i]=t[i])}),n}function JV(t){var e=t.blacklist||null,r=t.whitelist||null,s=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:tc).concat(t.key),a=t.storage,o;t.serialize===!1?o=function(P){return P}:typeof t.serialize=="function"?o=t.serialize:o=eb;var l=t.writeFailHandler||null,c={},u={},h=[],f=null,A=null,m=function(P){Object.keys(P).forEach(function(C){q(C)&&c[C]!==P[C]&&h.indexOf(C)===-1&&h.push(C)}),Object.keys(c).forEach(function(C){P[C]===void 0&&q(C)&&h.indexOf(C)===-1&&c[C]!==void 0&&h.push(C)}),f===null&&(f=setInterval(g,n)),c=P};function g(){if(h.length===0){f&&clearInterval(f),f=null;return}var k=h.shift(),P=s.reduce(function(C,E){return E.in(C,k,c)},c[k]);if(P!==void 0)try{u[k]=o(P)}catch(C){console.error("redux-persist/createPersistoid: error serializing state",C)}else delete u[k];h.length===0&&p()}function p(){Object.keys(u).forEach(function(k){c[k]===void 0&&delete u[k]}),A=a.setItem(i,o(u)).catch(x)}function q(k){return!(r&&r.indexOf(k)===-1&&k!=="_persist"||e&&e.indexOf(k)!==-1)}function x(k){l&&l(k)}var b=function(){for(;h.length!==0;)g();return A||Promise.resolve()};return{update:m,flush:b}}function eb(t){return JSON.stringify(t)}function tb(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:tc).concat(t.key),s=t.storage;t.debug;var n;return t.deserialize===!1?n=function(a){return a}:typeof t.deserialize=="function"?n=t.deserialize:n=rb,s.getItem(r).then(function(i){if(i)try{var a={},o=n(i);return Object.keys(o).forEach(function(l){a[l]=e.reduceRight(function(c,u){return u.out(c,l,o)},n(o[l]))}),a}catch(l){throw l}else return})}function rb(t){return JSON.parse(t)}function sb(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:tc).concat(t.key);return e.removeItem(r,nb)}function nb(t){}function Vh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function $t(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vh(r,!0).forEach(function(s){ib(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vh(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ib(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ab(t,e){if(t==null)return{};var r=ob(t,e),s,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function ob(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}var lb=5e3;function cb(t,e){var r=t.version!==void 0?t.version:hp;t.debug;var s=t.stateReconciler===void 0?ZV:t.stateReconciler,n=t.getStoredState||tb,i=t.timeout!==void 0?t.timeout:lb,a=null,o=!1,l=!0,c=function(h){return h._persist.rehydrated&&a&&!l&&a.update(h),h};return function(u,h){var f=u||{},A=f._persist,m=ab(f,["_persist"]),g=m;if(h.type===nc){var p=!1,q=function(z,B){p||(h.rehydrate(t.key,z,B),p=!0)};if(i&&setTimeout(function(){!p&&q(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,a||(a=JV(t)),A)return $t({},e(g,h),{_persist:A});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(E){var z=t.migrate||function(B,R){return Promise.resolve(B)};z(E,r).then(function(B){q(B)},function(B){q(void 0,B)})},function(E){q(void 0,E)}),$t({},e(g,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===ic)return o=!0,h.result(sb(t)),$t({},e(g,h),{_persist:A});if(h.type===rc)return h.result(a&&a.flush()),$t({},e(g,h),{_persist:A});if(h.type===sc)l=!0;else if(h.type===sn){if(o)return $t({},g,{_persist:$t({},A,{rehydrated:!0})});if(h.key===t.key){var x=e(g,h),b=h.payload,k=s!==!1&&b!==void 0?s(b,u,x,t):x,P=$t({},k,{_persist:$t({},A,{rehydrated:!0})});return c(P)}}}if(!A)return e(u,h);var C=e(g,h);return C===g?u:c($t({},C,{_persist:A}))}}function bh(t){return db(t)||hb(t)||ub()}function ub(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function hb(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function db(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function wh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function tl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wh(r,!0).forEach(function(s){fb(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wh(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fb(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var dp={registry:[],bootstrapped:!1},Ab=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dp,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case ac:return tl({},e,{registry:[].concat(bh(e.registry),[r.key])});case sn:var s=e.registry.indexOf(r.key),n=bh(e.registry);return n.splice(s,1),tl({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function pb(t,e,r){var s=Hl(Ab,dp,void 0),n=function(l){s.dispatch({type:ac,key:l})},i=function(l,c,u){var h={type:sn,payload:c,err:u,key:l};t.dispatch(h),s.dispatch(h)},a=tl({},s,{purge:function(){var l=[];return t.dispatch({type:ic,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:rc,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:sc})},persist:function(){t.dispatch({type:nc,register:n,rehydrate:i})}});return a.persist(),a}function mb(t,e){return function(r,s){if(!r)return Promise.resolve(void 0);var n=r._persist&&r._persist.version!==void 0?r._persist.version:hp;if(n===s||n>s)return Promise.resolve(r);var i=Object.keys(t).map(function(o){return parseInt(o)}).filter(function(o){return s>=o&&o>n}).sort(function(o,l){return o-l});try{var a=i.reduce(function(o,l){return t[l](o)},r);return Promise.resolve(a)}catch(o){return Promise.reject(o)}}}const fp=[],Ap=new Set;Ap.add=()=>{throw new Error("emptySet.add")};Ap.clear=()=>{throw new Error("emptySet.clear")};const ue=Object.freeze({}),Ti=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t),mE=["none","non-wall","all"],gb=["4-way","8-way","analogue"],yb=Vt()!=="server",Fa=yb?Ti().has("cheats"):!1,pp={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},rl={userSettings:{displaySettings:{},soundSettings:{}},planetsLiberated:pp,roomsExplored:{},scrollsRead:{},gameRunning:Fa,openMenus:Fa?[]:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ue}],assigningInput:void 0,cheatsOn:Fa,currentGame:void 0,reincarnationPoint:void 0},Ii=HA({name:"gameMenus",initialState:rl,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=xh(ox,Ei({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},scrollRead(t,{payload:e}){t.scrollsRead[e]=!0,t.openMenus=[{menuId:`markdown/${e}`,scrollableSelection:!1,menuParam:ue}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=xh(gb,Kl({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(a,o)=>{a.includes(o)||a.push(o)},{presses:s,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":r(s.keys,e.input);break;case"gamepadButtons":r(s.gamepadButtons,e.input);break;case"gamepadAxes":{Zs.includes(i)&&r(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:s}=t.assigningInput,n=r.keys.length+r.gamepadButtons.length+s.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(Xr.default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=s),(e==="towards"||e==="away")&&(i.axes.y=s)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ue}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},gameStarted(t){t.gameRunning?t.openMenus=[]:(t.openMenus=[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.planetsLiberated=pp,t.roomsExplored={},t.scrollsRead={})},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=Xr[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[s]=t.openMenus;s.focussedItemId=e,s.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:ue}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:ue}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){aq(t,e,!ri(t,e))},crownCollected(t,{payload:e}){t.planetsLiberated[e]=!0;const r=Object.values(t.planetsLiberated).every(n=>n),s={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:ue},s]:t.openMenus=[s]},roomExplored(t,{payload:e}){t.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){e&&t.reincarnationPoint!==void 0?t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ue},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:ue}]:(t.gameRunning=!1,delete t.reincarnationPoint,delete t.currentGame,t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ue},{menuId:"mainMenu",scrollableSelection:!0,menuParam:ue}])},reincarnationFishEaten(t,{payload:e}){t.reincarnationPoint=e},reincarnationAccepted(t){delete t.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:ue}]},saveCurrentGame(t,{payload:e}){t.currentGame=e},gameRestoreFromSave(t,{payload:e}){Object.assign(t,e)},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,rl),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){}},extraReducers(t){t.addCase(sn,(e,r)=>{r.payload?.currentGame&&(e.gameRunning=!0,e.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:ue}])})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")}}}),{assignInputStart:At,backToParentMenu:He,characterRoomChange:gE,crownCollected:yE,debugItemClicked:xE,doneAssigningInput:xb,errorCaught:mp,errorDismissed:vh,gameOver:gp,gameRestoreFromSave:qE,gameStarted:qb,goToSubmenu:Mt,holdPressed:yp,inputAddedDuringAssignment:Vb,keyAssignmentPresetChosen:bb,mapPressed:wb,menuOpenOrExitPressed:_h,nextInputDirectionMode:vb,reincarnationAccepted:xp,reincarnationFishEaten:VE,roomExplored:bE,saveCurrentGame:_b,scrollRead:wE,setEmulatedResolution:oc,setFocussedMenuItemId:lc,setShowBoundingBoxes:vE,setShowShadowMasks:_E,toggleBoolean:Bt}=Ii.actions,{selectHasError:kE}=Ii.selectors;var ms={},kn={},Sn={},kh;function kb(){if(kh)return Sn;kh=1,Sn.__esModule=!0,Sn.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(o){return typeof o}:t=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function s(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var a=self[i],o="redux-persist ".concat(i," test");a.setItem(o,"test"),a.getItem(o),a.removeItem(o)}catch{return!1}return!0}function n(i){var a="".concat(i,"Storage");return s(a)?self[a]:r}return Sn}var Sh;function Sb(){if(Sh)return kn;Sh=1,kn.__esModule=!0,kn.default=r;var t=e(kb());function e(s){return s&&s.__esModule?s:{default:s}}function r(s){var n=(0,t.default)(s);return{getItem:function(a){return new Promise(function(o,l){o(n.getItem(a))})},setItem:function(a,o){return new Promise(function(l,c){l(n.setItem(a,o))})},removeItem:function(a){return new Promise(function(o,l){o(n.removeItem(a))})}}}return kn}var Ch;function Cb(){if(Ch)return ms;Ch=1,ms.__esModule=!0,ms.default=void 0;var t=e(Sb());function e(s){return s&&s.__esModule?s:{default:s}}var r=(0,t.default)("local");return ms.default=r,ms}var Mb=Cb();const Pb=$e(Mb),sl=(t,e)=>e?.[t],qp=t=>Tr(t),Cr=t=>Ce(qp(t)),SE=t=>Ce(jl(t)),CE=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),Eb=1e3,or=-2,pt=t=>{const e=rl.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},Tb=mb({1:pt,2:pt,3:pt,4:pt,5:pt,6:pt,7:pt,8:pt,9:pt,10:pt,11:pt,12:pt,13(t){const e=t,r=structuredClone(t);return r.gameMenus.userSettings.soundSettings={},console.log("redux-persist migration: migrating state 12->13 by adding `{}` at `gameMenus.userSettings.soundSettings`",e,"->",r),r},14(t){console.group("redux-persist migration: migrating state 13->14 to add fixedZIndexes");const e=t,r=structuredClone(e),s=o=>{for(const l of Cr(o.items))l.renders===!1?(console.log(l.id,"is a non-rendering item, giving fixedZIndex"),l.fixedZIndex=or):l.type==="floatingText"&&(console.log(l.id,"is getting .fixedZIndex = floatingTextFixedZIndex"),l.fixedZIndex=Eb)},n=o=>{for(const[l,c]of zl(o))console.group("fixing room for",l,c.roomJson.id),s(c),console.groupEnd()},{currentGame:i}=r;i!==void 0&&(console.group("found a currentGame - migrating..."),n(i.gameState.characterRooms),console.groupEnd());const a=o=>{const l=o?.store.gameMenus.reincarnationPoint;if(l===void 0)return;console.log("found a reincarnation point - migrating..."),n(l.gameState.characterRooms),console.log("...reincarnation point migrated");const c=l.store.gameMenus.reincarnationPoint;c!==void 0&&a(c)};return a(i),console.log("migration done"),console.groupEnd(),r},15:pt}),Vp=Zq(),Ib=Vp.startListening.withTypes(),Rb=()=>{Vt()!=="server"&&Ib({actionCreator:oc,effect(t,{dispatch:e,getState:r}){const{emulatedResolution:s}=r().gameMenus.userSettings.displaySettings;s!==void 0&&e(tp(Xl(s)))}})},Bb=15,jb=["userSettings","currentGame"],zb={key:"hohol/gameMenus/userSettings",version:Bb,migrate:Tb,storage:Pb,whitelist:jb},Nb=cb(zb,Ii.reducer),nl=aV({[Ii.reducerPath]:Nb,[ui.reducerPath]:ui.reducer}).withLazyLoadedSlices();nl.inject;const Fb=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?nl(void 0,e):nl(t,e),be=Mq({reducer:Fb,middleware:t=>t({serializableCheck:{ignoredActions:[rc,sn,sc,nc,ic,ac]}}).prepend(Vp.middleware)});Rb();const Ob=pb(be),Lb=Ti().get("noSaves"),Db=()=>{const t=Ol(),e=EV();I.useEffect(()=>{if(e===void 0)return;const r=()=>{Lb||(console.log("saving current game"),t(_b(XV(e.gameState,be.getState()))),Ob.flush())},s=()=>{document.visibilityState==="hidden"&&(console.log("pausing due to visibilityState=hidden"),t(yp("hold")),r())};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",r)}},[t,e])},Hb=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Å","Ä","Ö","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape","§"],Gb=t=>Hb.includes(t);let Ub=1;const Wb=()=>Ub++,Yb=3,Mh=({key:t,location:e,repeat:r})=>{if(r)return;const s=t.length===1?t.toUpperCase():t,n=e===Yb?`Numpad${s}`:s;if(Gb(n))return n;console.warn("unrecognised key",t)},$b=()=>new Map,Xb=t=>{const e=n=>{const i=Mh(n);i!==void 0&&t.set(i,Wb())},r=n=>{const i=Mh(n);i!==void 0&&t.delete(i)},s=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",s,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",s,!1)}},bp=t=>t==="left"?{axis:"x",direction:-1}:t==="right"?{axis:"x",direction:1}:t==="towards"?{axis:"y",direction:1}:t==="away"?{axis:"y",direction:-1}:void 0;var X=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(X||{});const il=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Cn=(t,e)=>il(t).priority??e,ut={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(il).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(il).forEach(e=>{e.type.forEach(r=>{const s=this._addHandlers,n=this._queue;s[r]?s[r]?.(e):(n[r]=n[r]||[],n[r]?.push(e))})}),this},handle(t,e,r){const s=this._addHandlers,n=this._removeHandlers;if(s[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,n[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(a=>e(a)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,s=>{e.findIndex(i=>i.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((i,a)=>Cn(a.value,r)-Cn(i.value,r)))},s=>{const n=e.findIndex(i=>i.name===s.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,r=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((n,i)=>Cn(i,r)-Cn(n,r)))},s=>{const n=e.indexOf(s.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},Qb={extension:{type:X.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await ss(()=>import("./browserAll-B43f2Qjm.js"),__vite__mapDeps([0,1,2,3,4,5]))}},Kb={extension:{type:X.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await ss(()=>import("./webworkerAll-Di8FdxcH.js"),__vite__mapDeps([1,2,3,4,5]))}};class qt{constructor(e,r,s){this._x=r||0,this._y=s||0,this._observer=e}clone(e){return new qt(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Oa={exports:{}},Ph;function Zb(){return Ph||(Ph=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var A=new n(u,h||l,f),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],A]:l._events[m].push(A):(l._events[m]=A,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,A=h.length,m=new Array(A);f<A;f++)m[f]=h[f].fn;return m},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,f,A,m){var g=r?r+c:c;if(!this._events[g])return!1;var p=this._events[g],q=arguments.length,x,b;if(p.fn){switch(p.once&&this.removeListener(c,p.fn,void 0,!0),q){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,u),!0;case 3:return p.fn.call(p.context,u,h),!0;case 4:return p.fn.call(p.context,u,h,f),!0;case 5:return p.fn.call(p.context,u,h,f,A),!0;case 6:return p.fn.call(p.context,u,h,f,A,m),!0}for(b=1,x=new Array(q-1);b<q;b++)x[b-1]=arguments[b];p.fn.apply(p.context,x)}else{var k=p.length,P;for(b=0;b<k;b++)switch(p[b].once&&this.removeListener(c,p[b].fn,void 0,!0),q){case 1:p[b].fn.call(p[b].context);break;case 2:p[b].fn.call(p[b].context,u);break;case 3:p[b].fn.call(p[b].context,u,h);break;case 4:p[b].fn.call(p[b].context,u,h,f);break;default:if(!x)for(P=1,x=new Array(q-1);P<q;P++)x[P-1]=arguments[P];p[b].fn.apply(p[b].context,x)}}return!0},o.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,f){var A=r?r+c:c;if(!this._events[A])return this;if(!u)return a(this,A),this;var m=this._events[A];if(m.fn)m.fn===u&&(!f||m.once)&&(!h||m.context===h)&&a(this,A);else{for(var g=0,p=[],q=m.length;g<q;g++)(m[g].fn!==u||f&&!m[g].once||h&&m[g].context!==h)&&p.push(m[g]);p.length?this._events[A]=p.length===1?p[0]:p:a(this,A)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&a(this,u)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o}(Oa)),Oa.exports}var Jb=Zb();const Ut=$e(Jb),ew=Math.PI*2,tw=180/Math.PI,rw=Math.PI/180;class Ke{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Ke(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return La.x=0,La.y=0,La}}const La=new Ke;class de{constructor(e=1,r=0,s=0,n=1,i=0,a=0){this.array=null,this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,s,n,i,a){return this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=a,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,r){r=r||new Ke;const s=e.x,n=e.y;return r.x=this.a*s+this.c*n+this.tx,r.y=this.b*s+this.d*n+this.ty,r}applyInverse(e,r){r=r||new Ke;const s=this.a,n=this.b,i=this.c,a=this.d,o=this.tx,l=this.ty,c=1/(s*a+i*-n),u=e.x,h=e.y;return r.x=a*c*u+-i*c*h+(l*i-o*a)*c,r.y=s*c*h+-n*c*u+(-l*s+o*n)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),n=this.a,i=this.c,a=this.tx;return this.a=n*r-this.b*s,this.b=n*s+this.b*r,this.c=i*r-this.d*s,this.d=i*s+this.d*r,this.tx=a*r-this.ty*s,this.ty=a*s+this.ty*r,this}append(e){const r=this.a,s=this.b,n=this.c,i=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*s+e.b*i,this.c=e.c*r+e.d*n,this.d=e.c*s+e.d*i,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*i+this.ty,this}appendFrom(e,r){const s=e.a,n=e.b,i=e.c,a=e.d,o=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,f=r.d;return this.a=s*c+n*h,this.b=s*u+n*f,this.c=i*c+a*h,this.d=i*u+a*f,this.tx=o*c+l*h+r.tx,this.ty=o*u+l*f+r.ty,this}setTransform(e,r,s,n,i,a,o,l,c){return this.a=Math.cos(o+c)*i,this.b=Math.sin(o+c)*i,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=e-(s*this.a+n*this.c),this.ty=r-(s*this.b+n*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,s=this.b,n=this.c,i=this.d,a=e.pivot,o=-Math.atan2(-n,i),l=Math.atan2(s,r),c=Math.abs(o+l);return c<1e-5||Math.abs(ew-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(r*r+s*s),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(a.x*r+a.y*n),e.position.y=this.ty+(a.x*s+a.y*i),e}invert(){const e=this.a,r=this.b,s=this.c,n=this.d,i=this.tx,a=e*n-r*s;return this.a=n/a,this.b=-r/a,this.c=-s/a,this.d=e/a,this.tx=(s*this.ty-n*i)/a,this.ty=-(e*this.ty-r*i)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new de;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return nw.identity()}static get shared(){return sw.identity()}}const sw=new de,nw=new de,mr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],gr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],yr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],xr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],al=[],wp=[],Mn=Math.sign;function iw(){for(let t=0;t<16;t++){const e=[];al.push(e);for(let r=0;r<16;r++){const s=Mn(mr[t]*mr[r]+yr[t]*gr[r]),n=Mn(gr[t]*mr[r]+xr[t]*gr[r]),i=Mn(mr[t]*yr[r]+yr[t]*xr[r]),a=Mn(gr[t]*yr[r]+xr[t]*xr[r]);for(let o=0;o<16;o++)if(mr[o]===s&&gr[o]===n&&yr[o]===i&&xr[o]===a){e.push(o);break}}}for(let t=0;t<16;t++){const e=new de;e.set(mr[t],gr[t],yr[t],xr[t],0,0),wp.push(e)}}iw();const qe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>mr[t],uY:t=>gr[t],vX:t=>yr[t],vY:t=>xr[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>al[t][e],sub:(t,e)=>al[t][qe.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?qe.S:qe.N:Math.abs(e)*2<=Math.abs(t)?t>0?qe.E:qe.W:e>0?t>0?qe.SE:qe.SW:t>0?qe.NE:qe.NW,matrixAppendRotationInv:(t,e,r=0,s=0)=>{const n=wp[qe.inv(e)];n.tx=r,n.ty=s,t.append(n)}},Pn=[new Ke,new Ke,new Ke,new Ke];class Me{constructor(e=0,r=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Me(0,0,0,0)}clone(){return new Me(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,s,n=.5){const{width:i,height:a}=this;if(i<=0||a<=0)return!1;const o=this.x,l=this.y,c=s*(1-n),u=s-c,h=o-c,f=o+i+c,A=l-c,m=l+a+c,g=o+u,p=o+i-u,q=l+u,x=l+a-u;return e>=h&&e<=f&&r>=A&&r<=m&&!(e>g&&e<p&&r>q&&r<x)}intersects(e,r){if(!r){const z=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=z)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const s=this.left,n=this.right,i=this.top,a=this.bottom;if(n<=s||a<=i)return!1;const o=Pn[0].set(e.left,e.top),l=Pn[1].set(e.left,e.bottom),c=Pn[2].set(e.right,e.top),u=Pn[3].set(e.right,e.bottom);if(c.x<=o.x||l.y<=o.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(o,o),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(o.x,l.x,c.x,u.x)<=s||Math.min(o.x,l.x,c.x,u.x)>=n||Math.max(o.y,l.y,c.y,u.y)<=i||Math.min(o.y,l.y,c.y,u.y)>=a))return!1;const f=h*(l.y-o.y),A=h*(o.x-l.x),m=f*s+A*i,g=f*n+A*i,p=f*s+A*a,q=f*n+A*a;if(Math.max(m,g,p,q)<=f*o.x+A*o.y||Math.min(m,g,p,q)>=f*u.x+A*u.y)return!1;const x=h*(o.y-c.y),b=h*(c.x-o.x),k=x*s+b*i,P=x*n+b*i,C=x*s+b*a,E=x*n+b*a;return!(Math.max(k,P,C,E)<=x*o.x+b*o.y||Math.min(k,P,C,E)>=x*u.x+b*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(s-r,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,r=.001){const s=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=s-this.x,this.height=n-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=s-r,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new Me),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,s=e.y,n=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Da={default:-1};function Pe(t="default"){return Da[t]===void 0&&(Da[t]=-1),++Da[t]}const Eh={},Qe="8.0.0",aw="8.3.4";function ke(t,e,r=3){if(Eh[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(s=s.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(s))),Eh[e]=!0}const vp=()=>{};function pi(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Th(t){return!(t&t-1)&&!!t}function _p(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const Ih=Object.create(null);function ow(t){const e=Ih[t];return e===void 0&&(Ih[t]=Pe("resource")),e}const kp=class Sp extends Ut{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...Sp.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){ke(Qe,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=ow(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};kp.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let lw=kp;const Cp=class Mp extends Ut{constructor(e={}){super(),this.options=e,this.uid=Pe("textureSource"),this._resourceType="textureSource",this._resourceId=Pe("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...Mp.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new lw(_p(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Pe("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,s){s||(s=this._resolution),e||(e=this.width),r||(r=this.height);const n=Math.round(e*s),i=Math.round(r*s);return this.width=n/s,this.height=i/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=Pe("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Th(this.pixelWidth)&&Th(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};Cp.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Wt=Cp;class cc extends Wt{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(r instanceof Float32Array?s="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?s="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?s="rgba16uint":(r instanceof Int8Array,s="bgra8unorm")),super({...e,resource:r,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}cc.extension=X.TextureSource;const Rh=new de;class cw{constructor(e,r){this.mapCoord=new de,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],a=e[n+1];r[n]=i*s.a+a*s.c+s.tx,r[n+1]=i*s.b+a*s.d+s.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(Rh.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Rh));const i=e.source,a=this.uClampFrame,o=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return a[0]=(e.frame.x+o+l)/i.width,a[1]=(e.frame.y+o+l)/i.height,a[2]=(e.frame.x+e.frame.width-o+l)/i.width,a[3]=(e.frame.y+e.frame.height-o+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class he extends Ut{constructor({source:e,label:r,frame:s,orig:n,trim:i,defaultAnchor:a,defaultBorders:o,rotate:l,dynamic:c}={}){if(super(),this.uid=Pe("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Me,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new Wt,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new cw(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:s,height:n}=this._source,i=r.x/s,a=r.y/n,o=r.width/s,l=r.height/n;let c=this.rotate;if(c){const u=o/2,h=l/2,f=i+u,A=a+h;c=qe.add(c,qe.NW),e.x0=f+u*qe.uX(c),e.y0=A+h*qe.uY(c),c=qe.add(c,2),e.x1=f+u*qe.uX(c),e.y1=A+h*qe.uY(c),c=qe.add(c,2),e.x2=f+u*qe.uX(c),e.y2=A+h*qe.uY(c),c=qe.add(c,2),e.x3=f+u*qe.uX(c),e.y3=A+h*qe.uY(c)}else e.x0=i,e.y0=a,e.x1=i+o,e.y1=a,e.x2=i+o,e.y2=a+l,e.x3=i,e.y3=a+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ke(Qe,"Texture.baseTexture is now Texture.source"),this._source}}he.EMPTY=new he({label:"EMPTY",source:new Wt({label:"EMPTY"})});he.EMPTY.destroy=vp;he.WHITE=new he({source:new cc({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});he.WHITE.destroy=vp;function uw(t,e,r){const{width:s,height:n}=r.orig,i=r.trim;if(i){const a=i.width,o=i.height;t.minX=i.x-e._x*s,t.maxX=t.minX+a,t.minY=i.y-e._y*n,t.maxY=t.minY+o}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*n,t.maxY=t.minY+n}const Bh=new de;class zt{constructor(e=1/0,r=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Bh,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Me);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Bh,this}set(e,r,s,n){this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(e,r,s,n,i){i||(i=this.matrix);const a=i.a,o=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let f=this.minX,A=this.minY,m=this.maxX,g=this.maxY,p=a*e+l*r+u,q=o*e+c*r+h;p<f&&(f=p),q<A&&(A=q),p>m&&(m=p),q>g&&(g=q),p=a*s+l*r+u,q=o*s+c*r+h,p<f&&(f=p),q<A&&(A=q),p>m&&(m=p),q>g&&(g=q),p=a*e+l*n+u,q=o*e+c*n+h,p<f&&(f=p),q<A&&(A=q),p>m&&(m=p),q>g&&(g=q),p=a*s+l*n+u,q=o*s+c*n+h,p<f&&(f=p),q<A&&(A=q),p>m&&(m=p),q>g&&(g=q),this.minX=f,this.minY=A,this.maxX=m,this.maxY=g}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,s=this.minY,n=this.maxX,i=this.maxY,{a,b:o,c:l,d:c,tx:u,ty:h}=e;let f=a*r+l*s+u,A=o*r+c*s+h;this.minX=f,this.minY=A,this.maxX=f,this.maxY=A,f=a*n+l*s+u,A=o*n+c*s+h,this.minX=f<this.minX?f:this.minX,this.minY=A<this.minY?A:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=A>this.maxY?A:this.maxY,f=a*r+l*i+u,A=o*r+c*i+h,this.minX=f<this.minX?f:this.minX,this.minY=A<this.minY?A:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=A>this.maxY?A:this.maxY,f=a*n+l*i+u,A=o*n+c*i+h,this.minX=f<this.minX?f:this.minX,this.minY=A<this.minY?A:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=A>this.maxY?A:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,s,n){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new zt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,s,n){let i=this.minX,a=this.minY,o=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,f=n.d,A=n.tx,m=n.ty;for(let g=r;g<s;g+=2){const p=e[g],q=e[g+1],x=c*p+h*q+A,b=u*p+f*q+m;i=x<i?x:i,a=b<a?b:a,o=x>o?x:o,l=b>l?b:l}this.minX=i,this.minY=a,this.maxX=o,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var hw={grad:.9,turn:360,rad:360/(2*Math.PI)},Xt=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Oe=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Pt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},Pp=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},jh=function(t){return{r:Pt(t.r,0,255),g:Pt(t.g,0,255),b:Pt(t.b,0,255),a:Pt(t.a)}},Ha=function(t){return{r:Oe(t.r),g:Oe(t.g),b:Oe(t.b),a:Oe(t.a,3)}},dw=/^#([0-9a-f]{3,8})$/i,En=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Ep=function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=Math.max(e,r,s),a=i-Math.min(e,r,s),o=a?i===e?(r-s)/a:i===r?2+(s-e)/a:4+(e-r)/a:0;return{h:60*(o<0?o+6:o),s:i?a/i*100:0,v:i/255*100,a:n}},Tp=function(t){var e=t.h,r=t.s,s=t.v,n=t.a;e=e/360*6,r/=100,s/=100;var i=Math.floor(e),a=s*(1-r),o=s*(1-(e-i)*r),l=s*(1-(1-e+i)*r),c=i%6;return{r:255*[s,o,a,a,l,s][c],g:255*[l,s,s,o,a,a][c],b:255*[a,a,l,s,s,o][c],a:n}},zh=function(t){return{h:Pp(t.h),s:Pt(t.s,0,100),l:Pt(t.l,0,100),a:Pt(t.a)}},Nh=function(t){return{h:Oe(t.h),s:Oe(t.s),l:Oe(t.l),a:Oe(t.a,3)}},Fh=function(t){return Tp((r=(e=t).s,{h:e.h,s:(r*=((s=e.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:e.a}));var e,r,s},Is=function(t){return{h:(e=Ep(t)).h,s:(n=(200-(r=e.s))*(s=e.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,s,n},fw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Aw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,pw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ol={string:[[function(t){var e=dw.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Oe(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Oe(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=pw.exec(t)||mw.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:jh({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=fw.exec(t)||Aw.exec(t);if(!e)return null;var r,s,n=zh({h:(r=e[1],s=e[2],s===void 0&&(s="deg"),Number(r)*(hw[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Fh(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=n===void 0?1:n;return Xt(e)&&Xt(r)&&Xt(s)?jh({r:Number(e),g:Number(r),b:Number(s),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,s=t.l,n=t.a,i=n===void 0?1:n;if(!Xt(e)||!Xt(r)||!Xt(s))return null;var a=zh({h:Number(e),s:Number(r),l:Number(s),a:Number(i)});return Fh(a)},"hsl"],[function(t){var e=t.h,r=t.s,s=t.v,n=t.a,i=n===void 0?1:n;if(!Xt(e)||!Xt(r)||!Xt(s))return null;var a=function(o){return{h:Pp(o.h),s:Pt(o.s,0,100),v:Pt(o.v,0,100),a:Pt(o.a)}}({h:Number(e),s:Number(r),v:Number(s),a:Number(i)});return Tp(a)},"hsv"]]},Oh=function(t,e){for(var r=0;r<e.length;r++){var s=e[r][0](t);if(s)return[s,e[r][1]]}return[null,void 0]},gw=function(t){return typeof t=="string"?Oh(t.trim(),ol.string):typeof t=="object"&&t!==null?Oh(t,ol.object):[null,void 0]},Ga=function(t,e){var r=Is(t);return{h:r.h,s:Pt(r.s+100*e,0,100),l:r.l,a:r.a}},Ua=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Lh=function(t,e){var r=Is(t);return{h:r.h,s:r.s,l:Pt(r.l+100*e,0,100),a:r.a}},ll=function(){function t(e){this.parsed=gw(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Oe(Ua(this.rgba),2)},t.prototype.isDark=function(){return Ua(this.rgba)<.5},t.prototype.isLight=function(){return Ua(this.rgba)>=.5},t.prototype.toHex=function(){return e=Ha(this.rgba),r=e.r,s=e.g,n=e.b,a=(i=e.a)<1?En(Oe(255*i)):"","#"+En(r)+En(s)+En(n)+a;var e,r,s,n,i,a},t.prototype.toRgb=function(){return Ha(this.rgba)},t.prototype.toRgbString=function(){return e=Ha(this.rgba),r=e.r,s=e.g,n=e.b,(i=e.a)<1?"rgba("+r+", "+s+", "+n+", "+i+")":"rgb("+r+", "+s+", "+n+")";var e,r,s,n,i},t.prototype.toHsl=function(){return Nh(Is(this.rgba))},t.prototype.toHslString=function(){return e=Nh(Is(this.rgba)),r=e.h,s=e.s,n=e.l,(i=e.a)<1?"hsla("+r+", "+s+"%, "+n+"%, "+i+")":"hsl("+r+", "+s+"%, "+n+"%)";var e,r,s,n,i},t.prototype.toHsv=function(){return e=Ep(this.rgba),{h:Oe(e.h),s:Oe(e.s),v:Oe(e.v),a:Oe(e.a,3)};var e},t.prototype.invert=function(){return Dt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Dt(Ga(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Dt(Ga(this.rgba,-e))},t.prototype.grayscale=function(){return Dt(Ga(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Dt(Lh(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Dt(Lh(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Dt({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Oe(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Is(this.rgba);return typeof e=="number"?Dt({h:e,s:r.s,l:r.l,a:r.a}):Oe(r.h)},t.prototype.isEqual=function(e){return this.toHex()===Dt(e).toHex()},t}(),Dt=function(t){return t instanceof ll?t:new ll(t)},Dh=[],yw=function(t){t.forEach(function(e){Dh.indexOf(e)<0&&(e(ll,ol),Dh.push(e))})};function xw(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in r)s[r[n]]=n;var i={};t.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,c=s[this.toHex()];if(c)return c;if(a?.closest){var u=this.toRgb(),h=1/0,f="black";if(!i.length)for(var A in r)i[A]=new t(r[A]).toRgb();for(var m in r){var g=(o=u,l=i[m],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));g<h&&(h=g,f=m)}return f}},e.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":r[o];return l?new t(l).toRgb():null},"name"])}yw([xw]);const Jr=class _s{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof _s)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const s=typeof e;if(s!==typeof r)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,a)=>i===r[a]);if(e!==null&&r!==null){const i=Object.keys(e),a=Object.keys(r);return i.length!==a.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,s,n]=this._components;return{r:e,g:r,b:s,a:n}}toRgb(){const[e,r,s]=this._components;return{r:e,g:r,b:s}}toRgbaString(){const[e,r,s]=this.toUint8RgbArray();return`rgba(${e},${r},${s},${this.alpha})`}toUint8RgbArray(e){const[r,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(s*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,s,n,i]=this._components;return e[0]=r,e[1]=s,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,s,n]=this._components;return e[0]=r,e[1]=s,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,r,s]=this.toUint8RgbArray();return(s<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,s,n,i]=_s._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=s,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return r&&(s=s*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,s,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;r=(a>>16&255)/255,s=(a>>8&255)/255,n=(a&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,s,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,s,n,i=255]=e,r/=255,s/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=_s.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const a=Dt(e);a.isValid()&&({r,g:s,b:n,a:i}=a.rgba,r/=255,s/=255,n/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=s,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,s]=this._components;this._int=(e*255<<16)+(r*255<<8)+(s*255|0)}_clamp(e,r=0,s=1){return typeof e=="number"?Math.min(Math.max(e,r),s):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,r),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof _s||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Jr.shared=new Jr;Jr._temp=new Jr;Jr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ye=Jr;const qw={cullArea:null,cullable:!1,cullableChildren:!0};class uc{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Vw{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new uc(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const s=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[s]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const Zt=new Vw,bw={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){ke("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function ww(t,e,r){const s=t.length;let n;if(e>=s||r===0)return;r=e+r>s?s-e:r;const i=s-r;for(n=e;n<i;++n)t[n]=t[n+r];t.length=i}const vw={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,s=r-t,n=[];if(s>0&&s<=r){for(let a=r-1;a>=t;a--){const o=this.children[a];o&&(n.push(o),o.parent=null)}ww(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let a=0;a<n.length;++a)this.emit("childRemoved",n[a],this,a),n[a].emit("removed",this);return n.length>0&&this._didViewChangeTick++,n}else if(s===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||ke(Qe,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),r.prepend(s),t.setFromMatrix(r),t}},_w={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const s=this.children,n=s.length;for(let i=0;i<n;i++)s[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:s}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];s[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];s[i.pipe].pop(i,this,t)}}};class Hh{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class kw{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const s=this._tests[r];if(s.test(e))return Zt.get(s.maskClass,e)}return e}returnMaskEffect(e){Zt.return(e)}}const cl=new kw;ut.handleByList(X.MaskEffect,cl._effectClasses);const Sw={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,s)=>r.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),cl.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=cl.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Hh);t=t;const r=t?.length>0,s=e.filters?.length>0,n=r!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Hh),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},Cw={label:null,get name(){return ke(Qe,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){ke(Qe,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let s=0;s<r.length;s++){const n=r[s];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let s=0;s<r.length;s++){const i=r[s].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const s=this.children;for(let n=0;n<s.length;n++){const i=s[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let n=0;n<s.length;n++)s[n].getChildrenByLabel(t,!0,r);return r}},rt=new uc(de),Jt=new uc(zt),Mw=new de,Pw={getFastGlobalBounds(t,e){e||(e=new zt),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(s=Jt.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;s.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const i=this.children;for(let a=0;a<i.length;a++)i[a]._getGlobalBoundsRecursive(t,s,r)}if(n){let i=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(i||(i=!0,s.applyMatrix(a.worldTransform)),this.effects[o].addBounds(s,!0));i&&(s.applyMatrix(a.worldTransform.copyTo(Mw).invert()),e.addBounds(s,this.relativeGroupTransform)),e.addBounds(s),Jt.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Jt.return(s))}};function Ip(t,e,r){r.clear();let s,n;return t.parent?e?s=t.parent.worldTransform:(n=rt.get().identity(),s=hc(t,n)):s=de.IDENTITY,Rp(t,r,s,e),n&&rt.return(n),r.isValid||r.set(0,0,0,0),r}function Rp(t,e,r,s){if(!t.visible||!t.measurable)return;let n;s?n=t.worldTransform:(t.updateLocalTransform(),n=rt.get(),n.appendFrom(t.localTransform,r));const i=e,a=!!t.effects.length;if(a&&(e=Jt.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{t.bounds&&(e.matrix=n,e.addBounds(t.bounds));for(let o=0;o<t.children.length;o++)Rp(t.children[o],e,n,s)}if(a){for(let o=0;o<t.effects.length;o++)t.effects[o].addBounds?.(e);i.addBounds(e,de.IDENTITY),Jt.return(e)}s||rt.return(n)}function hc(t,e){const r=t.parent;return r&&(hc(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function Bp(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,s=t>>8&255,n=t&255,i=e>>16&255,a=e>>8&255,o=e&255,l=r*i/255|0,c=s*a/255|0,u=n*o/255|0;return(l<<16)+(c<<8)+u}const Gh=16777215;function Uh(t,e){return t===Gh?e:e===Gh?t:Bp(t,e)}function $n(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const Ew={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=hc(this,rt.get().identity());return t.appendFrom(this.localTransform,r),rt.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?$n(this.renderGroup.worldColor):this.parentRenderGroup?$n(Uh(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=Uh(e,r.localColor),r=r.parent;return $n(e)}};let Wa=0;const Wh=500;function Ve(...t){Wa!==Wh&&(Wa++,Wa===Wh?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function jp(t,e,r){return e.clear(),r||(r=de.IDENTITY),zp(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function zp(t,e,r,s,n){let i;if(n)i=rt.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=rt.get(),i.appendFrom(l,r)}const a=e,o=!!t.effects.length;if(o&&(e=Jt.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)zp(l[c],e,i,s,!1)}if(o){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);a.addBounds(e,de.IDENTITY),Jt.return(e)}rt.return(i)}function Np(t,e){const r=t.children;for(let s=0;s<r.length;s++){const n=r[s],i=n.uid,a=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,o=e.index;(e.data[o]!==i||e.data[o+1]!==a)&&(e.data[e.index]=i,e.data[e.index+1]=a,e.didChange=!0),e.index=o+2,n.children.length&&Np(n,e)}return e.didChange}const Tw=new de,Iw={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new zt});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),Np(this,t),t.didChange&&jp(this,t.localBounds,Tw),t.localBounds},getBounds(t,e){return Ip(this,t,e||new zt)}},Rw={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},Bw={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(jw))}};function jw(t,e){return t._zIndex-e._zIndex}const zw={getGlobalPosition(t=new Ke,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const s=this.getGlobalTransform(rt.get(),r);return e=s.apply(t,e),rt.return(s),e},toLocal(t,e,r,s){e&&(t=e.toGlobal(t,r,s));const n=this.getGlobalTransform(rt.get(),s);return r=n.applyInverse(t,r),rt.return(n),r}};class Fp{constructor(){this.uid=Pe("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Nw=0;class Fw{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,s){const n=new Wt({...this.textureOptions,width:e,height:r,resolution:1,antialias:s,autoGarbageCollect:!1});return new he({source:n,label:`texturePool_${Nw++}`})}getOptimalTexture(e,r,s=1,n){let i=Math.ceil(e*s-1e-6),a=Math.ceil(r*s-1e-6);i=pi(i),a=pi(a);const o=(i<<17)+(a<<1)+(n?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let l=this._texturePool[o].pop();return l||(l=this.createTexture(i,a,n)),l.source._resolution=s,l.source.width=i/s,l.source.height=a/s,l.source.pixelWidth=i,l.source.pixelHeight=a,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=o,l}getSameSizeTexture(e,r=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const s=this._texturePool[r];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const Ow=new Fw;class Lw{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new de,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Fp,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let s=0;s<r.length;s++){const n=r[s];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Ow.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let s=0;s<r.length;s++)this.addChild(r[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let s=0;s<r.length;s++)this.removeChild(r[s])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const s=e.children;for(let n=0;n<s.length;n++)this._getChildren(s[n],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new de),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new de),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new de),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Dw(t,e,r={}){for(const s in e)!r[s]&&e[s]!==void 0&&(t[s]=e[s])}const Ya=new qt(null),$a=new qt(null),Xa=new qt(null,1,1),Yh=1,Hw=2,Qa=4;class nn extends Ut{constructor(e={}){super(),this.uid=Pe("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new de,this.relativeGroupTransform=new de,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new qt(this,0,0),this._scale=Xa,this._pivot=$a,this._skew=Ya,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Dw(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){ke("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),ut.mixin(nn,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||ke(Qe,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const r=e[0],s=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),s&&(s.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,s&&s.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const r=e[0],s=this.children.indexOf(r);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,s),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Zt.get(Lw,this),this.groupTransform=de.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Zt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new de),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*tw}set angle(e){this.rotation=e*rw}get pivot(){return this._pivot===$a&&(this._pivot=new qt(this,0,0)),this._pivot}set pivot(e){this._pivot===$a&&(this._pivot=new qt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Ya&&(this._skew=new qt(this,0,0)),this._skew}set skew(e){this._skew===Ya&&(this._skew=new qt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Xa&&(this._scale=new qt(this,1,1)),this._scale}set scale(e){this._scale===Xa&&(this._scale=new qt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const s=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,s=this._scale,n=this._pivot,i=this._position,a=s._x,o=s._y,l=n._x,c=n._y;r.a=this._cx*a,r.b=this._sx*a,r.c=this._cy*o,r.d=this._sy*o,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Yh,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=Ye.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=Yh,this._onUpdate())}get tint(){return $n(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Hw,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Qa,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Qa,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Qa,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let n=0;n<r.length;++n)r[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}ut.mixin(nn,vw,Pw,zw,Rw,Iw,Sw,Cw,Bw,qw,bw,Ew,_w);class Gw extends nn{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new zt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:s,y:n}=e;return s>=r.minX&&s<=r.maxX&&n>=r.minY&&n<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,s){const{renderPipes:n,renderableGC:i}=r;n.blendMode.setBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const o=this.children,l=o.length;for(let c=0;c<l;c++)o[c].collectRenderables(e,r,s)}}class Ls extends Gw{constructor(e=he.EMPTY){e instanceof he&&(e={texture:e});const{texture:r=he.EMPTY,anchor:s,roundPixels:n,width:i,height:a,...o}=e;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new qt({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),a!==void 0&&(this.height=a)}static from(e,r=!1){return e instanceof he?new Ls(e):new Ls(he.from(e,r))}set texture(e){e||(e=he.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return uw(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return ke("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,s=this._bounds,{width:n,height:i}=r.orig;s.minX=-e._x*n,s.maxX=s.minX+n,s.minY=-e._y*i,s.maxY=s.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const Uw=new zt;function Op(t,e,r){const s=Uw;t.measurable=!0,Ip(t,r,s),e.addBoundsMask(s),t.measurable=!1}function Lp(t,e,r){const s=Jt.get();t.measurable=!0;const n=rt.get().identity(),i=Dp(t,r,n);jp(t,s,i),t.measurable=!1,e.addBoundsMask(s),rt.return(n),Jt.return(s)}function Dp(t,e,r){return t?(t!==e&&(Dp(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(Ve("Mask bounds, renderable is not inside the root container"),r)}class Hp{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Ls),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||Op(this.mask,e,r)}addLocalBounds(e,r){Lp(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Ls}}Hp.extension=X.MaskEffect;class Gp{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Gp.extension=X.MaskEffect;class Up{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){Op(this.mask,e,r)}addLocalBounds(e,r){Lp(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof nn}}Up.extension=X.MaskEffect;const Ww={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let $h=Ww;const je={get(){return $h},set(t){$h=t}};class Wp extends Wt{constructor(e){e.resource||(e.resource=je.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,s=this._resolution){const n=super.resize(e,r,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Wp.extension=X.TextureSource;class Er extends Wt{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=je.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,Ve("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Er.extension=X.TextureSource;var mi=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(mi||{});class Ka{constructor(e,r=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=s,this._once=n}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Yp=class gt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ka(null,null,1/0),this.deltaMS=1/gt.targetFPMS,this.elapsedMS=1/gt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,s=mi.NORMAL){return this._addListener(new Ka(e,r,s))}addOnce(e,r,s=mi.NORMAL){return this._addListener(new Ka(e,r,s,!0))}_addListener(e){let r=this._head.next,s=this._head;if(!r)e.connect(s);else{for(;r;){if(e.priority>r.priority){e.connect(s);break}s=r,r=r.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,r){let s=this._head.next;for(;s;)s.match(e,r)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*gt.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,r)/1e3,gt.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!gt._shared){const e=gt._shared=new gt;e.autoStart=!0,e._protected=!0}return gt._shared}static get system(){if(!gt._system){const e=gt._system=new gt;e.autoStart=!0,e._protected=!0}return gt._system}};Yp.targetFPMS=.06;let ct=Yp,Za;async function $p(){return Za??(Za=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(a=>{const o=document.createElement("video");o.onloadeddata=()=>a(o),o.onerror=()=>a(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!r)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Za}const Ri=class Xp extends Wt{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Xp.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=ct.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await $p(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ct.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Ri.extension=X.TextureSource;Ri.defaultOptions={...Wt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Ri.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Xn=Ri;const jt=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||r?e(s):s):t);class Yw{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||Ve(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const s=jt(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(s,r);break}}const i=new Map(Object.entries(n||{}));n||s.forEach(l=>{i.set(l,r)});const a=[...i.keys()],o={cacheKeys:a,keys:s};s.forEach(l=>{this._cacheMap.set(l,o)}),a.forEach(l=>{const c=n?n[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&Ve("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){Ve(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const _e=new Yw,ul=[];ut.handleByList(X.TextureSource,ul);function Qp(t={}){const e=t&&t.resource,r=e?t.resource:t,s=e?t:{resource:t};for(let n=0;n<ul.length;n++){const i=ul[n];if(i.test(r))return new i(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function $w(t={},e=!1){const r=t&&t.resource,s=r?t.resource:t,n=r?t:{resource:t};if(!e&&_e.has(s))return _e.get(s);const i=new he({source:Qp(n)});return i.on("destroy",()=>{_e.has(s)&&_e.remove(s)}),e||_e.set(s,i),i}function Xw(t,e=!1){return typeof t=="string"?_e.get(t):t instanceof Wt?new he({source:t}):$w(t,e)}he.from=Xw;Wt.from=Qp;ut.add(Hp,Gp,Up,Xn,Er,Wp,cc);var dr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(dr||{});function It(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function gs(t){return t.split("?")[0].split("#")[0]}function Qw(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Kw(t,e,r){return t.replace(new RegExp(Qw(e),"g"),r)}function Zw(t,e){let r="",s=0,n=-1,i=0,a=-1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",s=0):(r=r.slice(0,l),s=r.length-1-r.lastIndexOf("/")),n=o,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,n=o,i=0;continue}}}else r.length>0?r+=`/${t.slice(n+1,o)}`:r=t.slice(n+1,o),s=o-n-1;n=o,i=0}else a===46&&i!==-1?++i:i=-1}return r}const bt={toPosix(t){return Kw(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){It(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(It(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=gs(this.toPosix(e??je.get().getBaseUrl())),n=gs(this.toPosix(r??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?bt.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(It(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=Zw(t),t.length>0&&s&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return It(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const s=t[r];if(It(s),s.length>0)if(e===void 0)e=s;else{const n=t[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(It(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let s=-1,n=!0;const i=this.getProtocol(t),a=t;t=t.slice(i.length);for(let o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),e===47){if(!n){s=o;break}}else n=!1;return s===-1?r?"/":this.isUrl(a)?i+t:i:r&&s===1?"//":i+t.slice(0,s)},rootname(t){It(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){It(t),e&&It(e),t=gs(this.toPosix(t));let r=0,s=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){r=i+1;break}}else o===-1&&(n=!1,o=i+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(s=i):(a=-1,s=o))}return r===s?s=o:s===-1&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){r=i+1;break}}else s===-1&&(n=!1,s=i+1);return s===-1?"":t.slice(r,s)},extname(t){It(t),t=gs(this.toPosix(t));let e=-1,r=0,s=-1,n=!0,i=0;for(let a=t.length-1;a>=0;--a){const o=t.charCodeAt(a);if(o===47){if(!n){r=a+1;break}continue}s===-1&&(n=!1,s=a+1),o===46?e===-1?e=a:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||s===-1||i===0||i===1&&e===s-1&&e===r+1?"":t.slice(e,s)},parse(t){It(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=gs(this.toPosix(t));let r=t.charCodeAt(0);const s=this.isAbsolute(t);let n;e.root=this.rootname(t),s||this.hasProtocol(t)?n=1:n=0;let i=-1,a=0,o=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!l){a=c+1;break}continue}o===-1&&(l=!1,o=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||o===-1||u===0||u===1&&i===o-1&&i===a+1?o!==-1&&(a===0&&s?e.base=e.name=t.slice(1,o):e.base=e.name=t.slice(a,o)):(a===0&&s?(e.name=t.slice(1,i),e.base=t.slice(1,o)):(e.name=t.slice(a,i),e.base=t.slice(a,o)),e.ext=t.slice(i,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Kp(t,e,r,s,n){const i=e[r];for(let a=0;a<i.length;a++){const o=i[a];r<e.length-1?Kp(t.replace(s[r],o),e,r+1,s,n):n.push(t.replace(s[r],o))}}function Jw(t){const e=/\{(.*?)\}/g,r=t.match(e),s=[];if(r){const n=[];r.forEach(i=>{const a=i.substring(1,i.length-1).split(",");n.push(a)}),Kp(t,n,0,r,s)}else s.push(t);return s}const gi=t=>!Array.isArray(t);class ls{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}getAlias(e){const{alias:r,src:s}=e;return jt(r||s,i=>typeof i=="string"?i:Array.isArray(i)?i.map(a=>a?.src??a):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&Ve("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const s=[];let n=r;Array.isArray(r)||(n=Object.entries(r).map(([i,a])=>typeof a=="string"||Array.isArray(a)?{alias:i,src:a}:{alias:i,...a})),n.forEach(i=>{const a=i.src,o=i.alias;let l;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);s.push(c),l=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));s.push(...c),l=[...o,...c]}this.add({...i,alias:l,src:a})}),this._bundles[e]=s}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let s;s=i=>{this.hasKey(i)&&Ve(`[Resolver] already has key: ${i} overwriting`)},jt(r).forEach(i=>{const{src:a}=i;let{data:o,format:l,loadParser:c}=i;const u=jt(a).map(A=>typeof A=="string"?Jw(A):Array.isArray(A)?A:[A]),h=this.getAlias(i);Array.isArray(h)?h.forEach(s):s(h);const f=[];u.forEach(A=>{A.forEach(m=>{let g={};if(typeof m!="object"){g.src=m;for(let p=0;p<this._parsers.length;p++){const q=this._parsers[p];if(q.test(m)){g=q.parse(m);break}}}else o=m.data??o,l=m.format??l,c=m.loadParser??c,g={...g,...m};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:h,data:o,format:l,loadParser:c}),f.push(g)})}),h.forEach(A=>{this._assetMap[A]=f})})}resolveBundle(e){const r=gi(e);e=jt(e);const s={};return e.forEach(n=>{const i=this._bundles[n];if(i){const a=this.resolve(i),o={};for(const l in a){const c=a[l];o[this._extractAssetIdFromBundle(n,l)]=c}s[n]=o}}),r?s[e[0]]:s}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const s={};for(const n in r)s[n]=r[n].src;return s}return r.src}resolve(e){const r=gi(e);e=jt(e);const s={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const a=this._getPreferredOrder(i);a?.priority.forEach(o=>{a.params[o].forEach(l=>{const c=i.filter(u=>u[o]?u[o]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),r?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const s=e[r],n=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:s,data:n,loadParser:i,format:a}=r;return(this._basePath||this._rootPath)&&(e.src=bt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.format=a??e.format??ev(e.src),e}}ls.RETINA_PREFIX=/@([0-9\.]+)x/;function ev(t){return t.split(".").pop().split("?").shift().split("#").shift()}const hl=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},Zp=class ks{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof he?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const s=parseFloat(r.meta.scale);s?(this.resolution=s,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ks.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const s=ks.BATCH_SIZE;for(;r-e<s&&r<this._frameKeys.length;){const n=this._frameKeys[r],i=this._frames[n],a=i.frame;if(a){let o=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Me(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?o=new Me(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new Me(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Me(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new he({source:this.textureSource,frame:o,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let s=0;s<e[r].length;s++){const n=e[r][s];this.animations[r].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ks.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ks.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Zp.BATCH_SIZE=1e3;let dl=Zp;const tv=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Jp(t,e,r){const s={};if(t.forEach(n=>{s[n]=e}),Object.keys(e.textures).forEach(n=>{s[n]=e.textures[n]}),!r){const n=bt.dirname(t[0]);e.linkedSheets.forEach((i,a)=>{const o=Jp([`${n}/${e.data.meta.related_multi_packs[a]}`],i,!0);Object.assign(s,o)})}return s}const rv={extension:X.Asset,cache:{test:t=>t instanceof dl,getCacheableAssets:(t,e)=>Jp(t,e,!1)},resolver:{extension:{type:X.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),s=r.pop(),n=r.pop();return s==="json"&&tv.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(ls.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:X.LoadParser,priority:dr.Normal,name:"spritesheetLoader"},async testParse(t,e){return bt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:s,imageFilename:n,textureOptions:i}=e?.data??{};let a=bt.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let o;if(s instanceof he)o=s;else{const u=hl(a+(n??t.meta.image),e.src);o=(await r.load([{src:u,data:i}]))[u]}const l=new dl(o.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const f of c){if(typeof f!="string")continue;let A=a+f;e.data?.ignoreMultiPack||(A=hl(A,e.src),u.push(r.load({src:A,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(f=>{f.linkedSheets=[l].concat(l.linkedSheets.filter(A=>A!==f))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};ut.add(rv);const Ja=Object.create(null),Xh=Object.create(null);function dc(t,e){let r=Xh[t];return r===void 0&&(Ja[e]===void 0&&(Ja[e]=1),Xh[t]=r=Ja[e]++),r}let Tn;function em(){return(!Tn||Tn?.isContextLost())&&(Tn=je.get().createCanvas().getContext("webgl",{})),Tn}let In;function sv(){if(!In){In="mediump";const t=em();t&&t.getShaderPrecisionFormat&&(In=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return In}function nv(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function iv(t,e,r){const s=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&s!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function av(t,e){return e?`#version 300 es
${t}`:t}const ov={},lv={};function cv(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const s=r?ov:lv;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function uv(t,e){return e?t.replace("#version 300 es",""):t}const eo={stripVersion:uv,ensurePrecision:iv,addProgramDefines:nv,setProgramName:cv,insertVersion:av},to=Object.create(null),tm=class fl{constructor(e){e={...fl.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:sv()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let n=e.fragment,i=e.vertex;Object.keys(eo).forEach(a=>{const o=s[a];n=eo[a](n,o,!0),i=eo[a](i,o,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=dc(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return to[r]||(to[r]=new fl(e)),to[r]}};tm.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let rm=tm;const Qh={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function hv(t){return Qh[t]??Qh.float32}const dv={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function fv({source:t,entryPoint:e}){const r={},s=t.indexOf(`fn ${e}`);if(s!==-1){const n=t.indexOf("->",s);if(n!==-1){const i=t.substring(s,n),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(i))!==null;){const l=dv[o[3]]??"float32";r[o[2]]={location:parseInt(o[1],10),format:l,stride:hv(l).stride,offset:0,instance:!1,start:0}}}}return r}function ro(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(a)?.map(h=>{const f=h.match(l)[1],A=h.match(o).reduce((m,g)=>{const[p,q]=g.split(":");return m[p.trim()]=q.trim(),m},{});return A?{name:f,members:A}:null}).filter(({name:h})=>c.some(f=>f.type===h))??[];return{groups:c,structs:u}}var Ss=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Ss||{});function Av({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:Ss.VERTEX|Ss.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:Ss.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:Ss.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function pv({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function mv(t,e){const r=new Set,s=new Set,n=[...t.structs,...e.structs].filter(a=>r.has(a.name)?!1:(r.add(a.name),!0)),i=[...t.groups,...e.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return s.has(o)?!1:(s.add(o),!0)});return{structs:n,groups:i}}const so=Object.create(null);class Bi{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:s,layout:n,gpuLayout:i,name:a}=e;if(this.name=a,this.fragment=r,this.vertex=s,r.source===s.source){const o=ro(r.source);this.structsAndGroups=o}else{const o=ro(s.source),l=ro(r.source);this.structsAndGroups=mv(o,l)}this.layout=n??pv(this.structsAndGroups),this.gpuLayout=i??Av(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,s=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=dc(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=fv(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return so[r]||(so[r]=new Bi(e)),so[r]}}const sm=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],gv=sm.reduce((t,e)=>(t[e]=!0,t),{});function yv(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const nm=class im{constructor(e,r){this._touched=0,this.uid=Pe("uniform"),this._resourceType="uniformGroup",this._resourceId=Pe("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...im.defaultOptions,...r},this.uniformStructures=e;const s={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!gv[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${sm.join(", ")}`);i.value??(i.value=yv(i.type,i.size)),s[n]=i.value}this.uniforms=s,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=dc(Object.keys(s).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};nm.defaultOptions={ubo:!1,isStatic:!1};let am=nm;class Qn{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const s in e){const n=e[s];this.setResource(n,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const s in this.resources)e[r++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,r){const s=this.resources[r];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const s in r)r[s]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const s in r)r[s]===e&&(r[s]=null)}else this._updateKey()}}var Al=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(Al||{});class fc extends Ut{constructor(e){super(),this.uid=Pe("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:s,groups:n,resources:i,compatibleRenderers:a,groupMap:o}=e;this.gpuProgram=r,this.glProgram=s,a===void 0&&(a=0,r&&(a|=Al.WEBGPU),s&&(a|=Al.WEBGL)),this.compatibleRenderers=a;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&n&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&n&&o)for(const c in o)for(const u in o[c]){const h=o[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&n&&!o){const c=r.structsAndGroups.groups;o={},c.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},o={},r&&r.structsAndGroups.groups.forEach(h=>{o[h.group]=o[h.group]||{},o[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new Qn,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},o[99]=o[99]||{},o[99][c]=u,c++);for(const u in i){const h=u;let f=i[u];!f.source&&!f._resourceType&&(f=new am(f));const A=l[h];A&&(n[A.group]||(n[A.group]=new Qn,this._ownedBindGroups.push(n[A.group])),n[A.group].setResource(f,A.binding))}}this.groups=n,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(n,l)}addResource(e,r,s){var n,i;(n=this._uniformBindMap)[r]||(n[r]={}),(i=this._uniformBindMap[r])[s]||(i[s]=e),this.groups[r]||(this.groups[r]=new Qn,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const s={};for(const n in r){const i=r[n];Object.defineProperty(s,i.name,{get(){return e[i.group].getResource(i.binding)},set(a){e[i.group].setResource(a,i.binding)}})}return s}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:s,...n}=e;let i,a;return r&&(i=Bi.from(r)),s&&(a=rm.from(s)),new fc({gpuProgram:i,glProgram:a,...n})}}var Rn={exports:{}},Kh;function xv(){if(Kh)return Rn.exports;Kh=1,Rn.exports=t,Rn.exports.default=t;function t(y,w,_){_=_||2;var v=w&&w.length,V=v?w[0]*_:y.length,S=e(y,0,V,_,!0),M=[];if(!S||S.next===S.prev)return M;var T,j,F,Z,J,te,me;if(v&&(S=l(y,w,S,_)),y.length>80*_){T=F=y[0],j=Z=y[1];for(var re=_;re<V;re+=_)J=y[re],te=y[re+1],J<T&&(T=J),te<j&&(j=te),J>F&&(F=J),te>Z&&(Z=te);me=Math.max(F-T,Z-j),me=me!==0?32767/me:0}return s(S,M,_,T,j,me,0),M}function e(y,w,_,v,V){var S,M;if(V===le(y,w,_,v)>0)for(S=w;S<_;S+=v)M=K(S,y[S],y[S+1],M);else for(S=_-v;S>=w;S-=v)M=K(S,y[S],y[S+1],M);return M&&k(M,M.next)&&(G(M),M=M.next),M}function r(y,w){if(!y)return y;w||(w=y);var _=y,v;do if(v=!1,!_.steiner&&(k(_,_.next)||b(_.prev,_,_.next)===0)){if(G(_),_=w=_.prev,_===_.next)break;v=!0}else _=_.next;while(v||_!==w);return w}function s(y,w,_,v,V,S,M){if(y){!M&&S&&A(y,v,V,S);for(var T=y,j,F;y.prev!==y.next;){if(j=y.prev,F=y.next,S?i(y,v,V,S):n(y)){w.push(j.i/_|0),w.push(y.i/_|0),w.push(F.i/_|0),G(y),y=F.next,T=F.next;continue}if(y=F,y===T){M?M===1?(y=a(r(y),w,_),s(y,w,_,v,V,S,2)):M===2&&o(y,w,_,v,V,S):s(r(y),w,_,v,V,S,1);break}}}}function n(y){var w=y.prev,_=y,v=y.next;if(b(w,_,v)>=0)return!1;for(var V=w.x,S=_.x,M=v.x,T=w.y,j=_.y,F=v.y,Z=V<S?V<M?V:M:S<M?S:M,J=T<j?T<F?T:F:j<F?j:F,te=V>S?V>M?V:M:S>M?S:M,me=T>j?T>F?T:F:j>F?j:F,re=v.next;re!==w;){if(re.x>=Z&&re.x<=te&&re.y>=J&&re.y<=me&&q(V,T,S,j,M,F,re.x,re.y)&&b(re.prev,re,re.next)>=0)return!1;re=re.next}return!0}function i(y,w,_,v){var V=y.prev,S=y,M=y.next;if(b(V,S,M)>=0)return!1;for(var T=V.x,j=S.x,F=M.x,Z=V.y,J=S.y,te=M.y,me=T<j?T<F?T:F:j<F?j:F,re=Z<J?Z<te?Z:te:J<te?J:te,Yt=T>j?T>F?T:F:j>F?j:F,dt=Z>J?Z>te?Z:te:J>te?J:te,Ot=g(me,re,w,_,v),Lt=g(Yt,dt,w,_,v),ne=y.prevZ,Ae=y.nextZ;ne&&ne.z>=Ot&&Ae&&Ae.z<=Lt;){if(ne.x>=me&&ne.x<=Yt&&ne.y>=re&&ne.y<=dt&&ne!==V&&ne!==M&&q(T,Z,j,J,F,te,ne.x,ne.y)&&b(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,Ae.x>=me&&Ae.x<=Yt&&Ae.y>=re&&Ae.y<=dt&&Ae!==V&&Ae!==M&&q(T,Z,j,J,F,te,Ae.x,Ae.y)&&b(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;ne&&ne.z>=Ot;){if(ne.x>=me&&ne.x<=Yt&&ne.y>=re&&ne.y<=dt&&ne!==V&&ne!==M&&q(T,Z,j,J,F,te,ne.x,ne.y)&&b(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;Ae&&Ae.z<=Lt;){if(Ae.x>=me&&Ae.x<=Yt&&Ae.y>=re&&Ae.y<=dt&&Ae!==V&&Ae!==M&&q(T,Z,j,J,F,te,Ae.x,Ae.y)&&b(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function a(y,w,_){var v=y;do{var V=v.prev,S=v.next.next;!k(V,S)&&P(V,v,v.next,S)&&B(V,S)&&B(S,V)&&(w.push(V.i/_|0),w.push(v.i/_|0),w.push(S.i/_|0),G(v),G(v.next),v=y=S),v=v.next}while(v!==y);return r(v)}function o(y,w,_,v,V,S){var M=y;do{for(var T=M.next.next;T!==M.prev;){if(M.i!==T.i&&x(M,T)){var j=O(M,T);M=r(M,M.next),j=r(j,j.next),s(M,w,_,v,V,S,0),s(j,w,_,v,V,S,0);return}T=T.next}M=M.next}while(M!==y)}function l(y,w,_,v){var V=[],S,M,T,j,F;for(S=0,M=w.length;S<M;S++)T=w[S]*v,j=S<M-1?w[S+1]*v:y.length,F=e(y,T,j,v,!1),F===F.next&&(F.steiner=!0),V.push(p(F));for(V.sort(c),S=0;S<V.length;S++)_=u(V[S],_);return _}function c(y,w){return y.x-w.x}function u(y,w){var _=h(y,w);if(!_)return w;var v=O(_,y);return r(v,v.next),r(_,_.next)}function h(y,w){var _=w,v=y.x,V=y.y,S=-1/0,M;do{if(V<=_.y&&V>=_.next.y&&_.next.y!==_.y){var T=_.x+(V-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(T<=v&&T>S&&(S=T,M=_.x<_.next.x?_:_.next,T===v))return M}_=_.next}while(_!==w);if(!M)return null;var j=M,F=M.x,Z=M.y,J=1/0,te;_=M;do v>=_.x&&_.x>=F&&v!==_.x&&q(V<Z?v:S,V,F,Z,V<Z?S:v,V,_.x,_.y)&&(te=Math.abs(V-_.y)/(v-_.x),B(_,y)&&(te<J||te===J&&(_.x>M.x||_.x===M.x&&f(M,_)))&&(M=_,J=te)),_=_.next;while(_!==j);return M}function f(y,w){return b(y.prev,y,w.prev)<0&&b(w.next,y,y.next)<0}function A(y,w,_,v){var V=y;do V.z===0&&(V.z=g(V.x,V.y,w,_,v)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==y);V.prevZ.nextZ=null,V.prevZ=null,m(V)}function m(y){var w,_,v,V,S,M,T,j,F=1;do{for(_=y,y=null,S=null,M=0;_;){for(M++,v=_,T=0,w=0;w<F&&(T++,v=v.nextZ,!!v);w++);for(j=F;T>0||j>0&&v;)T!==0&&(j===0||!v||_.z<=v.z)?(V=_,_=_.nextZ,T--):(V=v,v=v.nextZ,j--),S?S.nextZ=V:y=V,V.prevZ=S,S=V;_=v}S.nextZ=null,F*=2}while(M>1);return y}function g(y,w,_,v,V){return y=(y-_)*V|0,w=(w-v)*V|0,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,w=(w|w<<8)&16711935,w=(w|w<<4)&252645135,w=(w|w<<2)&858993459,w=(w|w<<1)&1431655765,y|w<<1}function p(y){var w=y,_=y;do(w.x<_.x||w.x===_.x&&w.y<_.y)&&(_=w),w=w.next;while(w!==y);return _}function q(y,w,_,v,V,S,M,T){return(V-M)*(w-T)>=(y-M)*(S-T)&&(y-M)*(v-T)>=(_-M)*(w-T)&&(_-M)*(S-T)>=(V-M)*(v-T)}function x(y,w){return y.next.i!==w.i&&y.prev.i!==w.i&&!z(y,w)&&(B(y,w)&&B(w,y)&&R(y,w)&&(b(y.prev,y,w.prev)||b(y,w.prev,w))||k(y,w)&&b(y.prev,y,y.next)>0&&b(w.prev,w,w.next)>0)}function b(y,w,_){return(w.y-y.y)*(_.x-w.x)-(w.x-y.x)*(_.y-w.y)}function k(y,w){return y.x===w.x&&y.y===w.y}function P(y,w,_,v){var V=E(b(y,w,_)),S=E(b(y,w,v)),M=E(b(_,v,y)),T=E(b(_,v,w));return!!(V!==S&&M!==T||V===0&&C(y,_,w)||S===0&&C(y,v,w)||M===0&&C(_,y,v)||T===0&&C(_,w,v))}function C(y,w,_){return w.x<=Math.max(y.x,_.x)&&w.x>=Math.min(y.x,_.x)&&w.y<=Math.max(y.y,_.y)&&w.y>=Math.min(y.y,_.y)}function E(y){return y>0?1:y<0?-1:0}function z(y,w){var _=y;do{if(_.i!==y.i&&_.next.i!==y.i&&_.i!==w.i&&_.next.i!==w.i&&P(_,_.next,y,w))return!0;_=_.next}while(_!==y);return!1}function B(y,w){return b(y.prev,y,y.next)<0?b(y,w,y.next)>=0&&b(y,y.prev,w)>=0:b(y,w,y.prev)<0||b(y,y.next,w)<0}function R(y,w){var _=y,v=!1,V=(y.x+w.x)/2,S=(y.y+w.y)/2;do _.y>S!=_.next.y>S&&_.next.y!==_.y&&V<(_.next.x-_.x)*(S-_.y)/(_.next.y-_.y)+_.x&&(v=!v),_=_.next;while(_!==y);return v}function O(y,w){var _=new $(y.i,y.x,y.y),v=new $(w.i,w.x,w.y),V=y.next,S=w.prev;return y.next=w,w.prev=y,_.next=V,V.prev=_,v.next=_,_.prev=v,S.next=v,v.prev=S,v}function K(y,w,_,v){var V=new $(y,w,_);return v?(V.next=v.next,V.prev=v,v.next.prev=V,v.next=V):(V.prev=V,V.next=V),V}function G(y){y.next.prev=y.prev,y.prev.next=y.next,y.prevZ&&(y.prevZ.nextZ=y.nextZ),y.nextZ&&(y.nextZ.prevZ=y.prevZ)}function $(y,w,_){this.i=y,this.x=w,this.y=_,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(y,w,_,v){var V=w&&w.length,S=V?w[0]*_:y.length,M=Math.abs(le(y,0,S,_));if(V)for(var T=0,j=w.length;T<j;T++){var F=w[T]*_,Z=T<j-1?w[T+1]*_:y.length;M-=Math.abs(le(y,F,Z,_))}var J=0;for(T=0;T<v.length;T+=3){var te=v[T]*_,me=v[T+1]*_,re=v[T+2]*_;J+=Math.abs((y[te]-y[re])*(y[me+1]-y[te+1])-(y[te]-y[me])*(y[re+1]-y[te+1]))}return M===0&&J===0?0:Math.abs((J-M)/M)};function le(y,w,_,v){for(var V=0,S=w,M=_-v;S<_;S+=v)V+=(y[M]-y[S])*(y[S+1]+y[M+1]),M=S;return V}return t.flatten=function(y){for(var w=y[0][0].length,_={vertices:[],holes:[],dimensions:w},v=0,V=0;V<y.length;V++){for(var S=0;S<y[V].length;S++)for(var M=0;M<w;M++)_.vertices.push(y[V][S][M]);V>0&&(v+=y[V-1].length,_.holes.push(v))}return _},Rn.exports}var qv=xv();const Vv=$e(qv);class om extends Ut{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return ke(Qe,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return ke(Qe,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return ke(Qe,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return ke(Qe,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return ke(Qe,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Zh=[{offset:0,color:"white"},{offset:1,color:"black"}],Ac=class pl{constructor(...e){this.uid=Pe("fillGradient"),this.type="linear",this.colorStops=[];let r=bv(e);r={...r.type==="radial"?pl.defaultRadialOptions:pl.defaultLinearOptions,..._p(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:Ye.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Zh,r=this._textureSize,{canvas:s,context:n}=ed(r,1),i=n.createLinearGradient(0,0,this._textureSize,0);Jh(i,e),n.fillStyle=i,n.fillRect(0,0,r,1),this.texture=new he({source:new Er({resource:s})});const{x:a,y:o}=this.start,{x:l,y:c}=this.end,u=new de,h=l-a,f=c-o,A=Math.sqrt(h*h+f*f),m=Math.atan2(f,h);u.scale(A/r,1),u.rotate(m),u.translate(a,o),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Zh,r=this._textureSize,{canvas:s,context:n}=ed(r,r),{x:i,y:a}=this.center,{x:o,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=o-u,f=l-u,A=r/(u*2),m=(i-h)*A,g=(a-f)*A,p=n.createRadialGradient(m,g,c*A,(o-h)*A,(l-f)*A,u*A);Jh(p,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,r,r),n.fillStyle=p,n.translate(m,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-g),n.fillRect(0,0,r,r),this.texture=new he({source:new Er({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const q=new de;q.scale(1/A,1/A),q.translate(h,f),this.textureSpace==="local"&&q.scale(r,r),this.transform=q}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};Ac.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};Ac.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let cr=Ac;function Jh(t,e){for(let r=0;r<e.length;r++){const s=e[r];t.addColorStop(s.offset,s.color)}}function ed(t,e){const r=je.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}function bv(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(ke("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??cr.defaultLinearOptions.textureSize}),e}const td={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ji{constructor(e,r){this.uid=Pe("fillPattern"),this.transform=new de,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=td[r].addressModeU,e.source.style.addressModeV=td[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var no,rd;function wv(){if(rd)return no;rd=1,no=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var a=[];return i.replace(e,function(o,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(a.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),a.push(c);if(c.length<t[u])throw new Error("malformed path data");a.push([l].concat(c.splice(0,t[u])))}}),a}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var a=i.match(s);return a?a.map(Number):[]}return no}var vv=wv();const _v=$e(vv);function kv(t,e){const r=_v(t),s=[];let n=null,i=0,a=0;for(let o=0;o<r.length;o++){const l=r[o],c=l[0],u=l;switch(c){case"M":i=u[1],a=u[2],e.moveTo(i,a);break;case"m":i+=u[1],a+=u[2],e.moveTo(i,a);break;case"H":i=u[1],e.lineTo(i,a);break;case"h":i+=u[1],e.lineTo(i,a);break;case"V":a=u[1],e.lineTo(i,a);break;case"v":a+=u[1],e.lineTo(i,a);break;case"L":i=u[1],a=u[2],e.lineTo(i,a);break;case"l":i+=u[1],a+=u[2],e.lineTo(i,a);break;case"C":i=u[5],a=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,a);break;case"c":e.bezierCurveTo(i+u[1],a+u[2],i+u[3],a+u[4],i+u[5],a+u[6]),i+=u[5],a+=u[6];break;case"S":i=u[3],a=u[4],e.bezierCurveToShort(u[1],u[2],i,a);break;case"s":e.bezierCurveToShort(i+u[1],a+u[2],i+u[3],a+u[4]),i+=u[3],a+=u[4];break;case"Q":i=u[3],a=u[4],e.quadraticCurveTo(u[1],u[2],i,a);break;case"q":e.quadraticCurveTo(i+u[1],a+u[2],i+u[3],a+u[4]),i+=u[3],a+=u[4];break;case"T":i=u[1],a=u[2],e.quadraticCurveToShort(i,a);break;case"t":i+=u[1],a+=u[2],e.quadraticCurveToShort(i,a);break;case"A":i=u[6],a=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,a);break;case"a":i+=u[6],a+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,a);break;case"Z":case"z":e.closePath(),s.length>0&&(n=s.pop(),n?(i=n.startX,a=n.startY):(i=0,a=0)),n=null;break;default:Ve(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:a},s.push(n))}return e}class pc{constructor(e=0,r=0,s=0){this.type="circle",this.x=e,this.y=r,this.radius=s}clone(){return new pc(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-e,i=this.y-r;return n*=n,i*=i,n+i<=s}strokeContains(e,r,s,n=.5){if(this.radius===0)return!1;const i=this.x-e,a=this.y-r,o=this.radius,l=(1-n)*s,c=Math.sqrt(i*i+a*a);return c<=o+l&&c>o-(s-l)}getBounds(e){return e||(e=new Me),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class mc{constructor(e=0,r=0,s=0,n=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=s,this.halfHeight=n}clone(){return new mc(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,n=(r-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(e,r,s,n=.5){const{halfWidth:i,halfHeight:a}=this;if(i<=0||a<=0)return!1;const o=s*(1-n),l=s-o,c=i-l,u=a-l,h=i+o,f=a+o,A=e-this.x,m=r-this.y,g=A*A/(c*c)+m*m/(u*u),p=A*A/(h*h)+m*m/(f*f);return g>1&&p<=1}getBounds(e){return e||(e=new Me),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Sv(t,e,r,s,n,i){const a=t-r,o=e-s,l=n-r,c=i-s,u=a*l+o*c,h=l*l+c*c;let f=-1;h!==0&&(f=u/h);let A,m;f<0?(A=r,m=s):f>1?(A=n,m=i):(A=r+f*l,m=s+f*c);const g=t-A,p=e-m;return g*g+p*p}let Cv,Mv;class Rs{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const s=[];for(let n=0,i=r.length;n<i;n++)s.push(r[n].x,r[n].y);r=s}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,s=r.length;for(let n=0;n<s;n+=2){const i=r[n],a=r[n+1],o=r[(n+2)%s],l=r[(n+3)%s];e+=(o-i)*(l+a)}return e<0}containsPolygon(e){const r=this.getBounds(Cv),s=e.getBounds(Mv);if(!r.containsRect(s))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const a=n[i],o=n[i+1];if(!this.contains(a,o))return!1}return!0}clone(){const e=this.points.slice(),r=new Rs(e);return r.closePath=this.closePath,r}contains(e,r){let s=!1;const n=this.points.length/2;for(let i=0,a=n-1;i<n;a=i++){const o=this.points[i*2],l=this.points[i*2+1],c=this.points[a*2],u=this.points[a*2+1];l>r!=u>r&&e<(c-o)*((r-l)/(u-l))+o&&(s=!s)}return s}strokeContains(e,r,s,n=.5){const i=s*s,a=i*(1-n),o=i-a,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],f=l[u+1],A=l[(u+2)%l.length],m=l[(u+3)%l.length],g=Sv(e,r,h,f,A,m),p=Math.sign((A-h)*(r-f)-(m-f)*(e-h));if(g<=(p<0?o:a))return!0}return!1}getBounds(e){e||(e=new Me);const r=this.points;let s=1/0,n=-1/0,i=1/0,a=-1/0;for(let o=0,l=r.length;o<l;o+=2){const c=r[o],u=r[o+1];s=c<s?c:s,n=c>n?c:n,i=u<i?u:i,a=u>a?u:a}return e.x=s,e.width=n-s,e.y=i,e.height=a-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Bn=(t,e,r,s,n,i,a)=>{const o=t-r,l=e-s,c=Math.sqrt(o*o+l*l);return c>=n-i&&c<=n+a};class gc{constructor(e=0,r=0,s=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=s,this.height=n,this.radius=i}getBounds(e){return e||(e=new Me),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new gc(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let n=e-(this.x+s),i=r-(this.y+s);const a=s*s;if(n*n+i*i<=a||(n=e-(this.x+this.width-s),n*n+i*i<=a)||(i=r-(this.y+this.height-s),n*n+i*i<=a)||(n=e-(this.x+s),n*n+i*i<=a))return!0}return!1}strokeContains(e,r,s,n=.5){const{x:i,y:a,width:o,height:l,radius:c}=this,u=s*(1-n),h=s-u,f=i+c,A=a+c,m=o-c*2,g=l-c*2,p=i+o,q=a+l;return(e>=i-u&&e<=i+h||e>=p-h&&e<=p+u)&&r>=A&&r<=A+g||(r>=a-u&&r<=a+h||r>=q-h&&r<=q+u)&&e>=f&&e<=f+m?!0:e<f&&r<A&&Bn(e,r,f,A,c,h,u)||e>p-c&&r<A&&Bn(e,r,p-c,A,c,h,u)||e>p-c&&r>q-c&&Bn(e,r,p-c,q-c,c,h,u)||e<f&&r>q-c&&Bn(e,r,f,q-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Pv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Ev(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function Tv(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=Pv.replace(/%forloop%/gi,Ev(t));if(e.shaderSource(r,s),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let zr=null;function lm(){if(zr)return zr;const t=em();return zr=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),zr=Tv(zr,t),t.getExtension("WEBGL_lose_context")?.loseContext(),zr}const cm={};function Iv(t,e){let r=2166136261;for(let s=0;s<e;s++)r^=t[s].uid,r=Math.imul(r,16777619),r>>>=0;return cm[r]||Rv(t,e,r)}let io=0;function Rv(t,e,r){const s={};let n=0;io||(io=lm());for(let a=0;a<io;a++){const o=a<e?t[a]:he.EMPTY.source;s[n++]=o.source,s[n++]=o.style}const i=new Qn(s);return cm[r]=i,i}class sd{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function nd(t,e){const r=t.byteLength/8|0,s=new Float64Array(t,0,r);new Float64Array(e,0,r).set(s);const i=t.byteLength-r*8;if(i>0){const a=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(a)}}const Bv={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var jv=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(jv||{});function id(t,e){return e.alphaMode==="no-premultiply-alpha"&&Bv[t]||t}class zv{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class Nv{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new zv,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const um=[];let ml=0;function ad(){return ml>0?um[--ml]:new Nv}function od(t){um[ml++]=t}let ys=0;const hm=class Kn{constructor(e={}){this.uid=Pe("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Kn.defaultOptions.maxTextures=Kn.defaultOptions.maxTextures??lm(),e={...Kn.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:s,indicesInitialSize:n}=e;this.attributeBuffer=new sd(s*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)od(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const s=e._batch.textures.ids[r._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let s=ad(),n=s.textures;n.clear();const i=r[this.elementStart];let a=id(i.blendMode,i.texture._source),o=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,f=this._batchIndexStart,A="startBatch";const m=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const p=r[g];r[g]=null;const x=p.texture._source,b=id(p.blendMode,x),k=a!==b||o!==p.topology;if(x._batchTick===ys&&!k){p._textureId=x._textureBindLocation,h+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,l,c,p._attributeStart,p._textureId),this.packQuadIndex(u,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,l,c,p._attributeStart,p._textureId),this.packIndex(p,u,p._indexStart,p._attributeStart/this.vertexSize)),p._batch=s;continue}x._batchTick=ys,(n.count>=m||k)&&(this._finishBatch(s,f,h-f,n,a,o,e,A),A="renderBatch",f=h,a=b,o=p.topology,s=ad(),n=s.textures,n.clear(),++ys),p._textureId=x._textureBindLocation=n.count,n.ids[x.uid]=n.count,n.textures[n.count++]=x,p._batch=s,h+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,l,c,p._attributeStart,p._textureId),this.packQuadIndex(u,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,l,c,p._attributeStart,p._textureId),this.packIndex(p,u,p._indexStart,p._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(s,f,h-f,n,a,o,e,A),f=h,++ys),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=h}_finishBatch(e,r,s,n,i,a,o,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=a,e.start=r,e.size=s,++ys,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),s=new sd(r);nd(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const r=this.indexBuffer;let s=Math.max(e,r.length*1.5);s+=s%2;const n=s>65535?new Uint32Array(s):new Uint16Array(s);if(n.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)n[i]=r[i];else nd(r.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,r,s){e[r]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+3]=s+0,e[r+4]=s+2,e[r+5]=s+3}packIndex(e,r,s,n){const i=e.indices,a=e.indexSize,o=e.indexOffset,l=e.attributeOffset;for(let c=0;c<a;c++)r[s++]=n+i[c+o]-l}destroy(){for(let e=0;e<this.batches.length;e++)od(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};hm.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Fv=hm;var at=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(at||{});let Ds=class extends Ut{constructor(e){let{data:r,size:s}=e;const{usage:n,label:i,shrinkToFit:a}=e;super(),this.uid=Pe("buffer"),this._resourceType="buffer",this._resourceId=Pe("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,s??(s=r?.byteLength);const o=!!r;this.descriptor={size:s,usage:n,mappedAtCreation:o,label:i},this.shrinkToFit=a??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&at.STATIC)}set static(e){e?this.descriptor.usage|=at.STATIC:this.descriptor.usage&=~at.STATIC}setDataWithSize(e,r,s){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Pe("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function dm(t,e){if(!(t instanceof Ds)){let r=e?at.INDEX:at.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=at.INDEX|at.COPY_DST):(t=new Float32Array(t),r=at.VERTEX|at.COPY_DST)),t=new Ds({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function Ov(t,e,r){const s=t.getAttribute(e);if(!s)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const n=s.buffer.data;let i=1/0,a=1/0,o=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(s.offset||0)/c,h=(s.stride||2*4)/c;for(let f=u;f<n.length;f+=h){const A=n[f],m=n[f+1];A>o&&(o=A),m>l&&(l=m),A<i&&(i=A),m<a&&(a=m)}return r.minX=i,r.minY=a,r.maxX=o,r.maxY=l,r}function Lv(t){return(t instanceof Ds||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=dm(t.buffer,!1),t}class Dv extends Ut{constructor(e={}){super(),this.uid=Pe("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new zt,this._boundsDirty=!0;const{attributes:r,indexBuffer:s,topology:n}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const s=Lv(r);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=dm(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Ov(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Hv=new Float32Array(1),Gv=new Uint32Array(1);class Uv extends Dv{constructor(){const r=new Ds({data:Hv,label:"attribute-batch-buffer",usage:at.VERTEX|at.COPY_DST,shrinkToFit:!1}),s=new Ds({data:Gv,label:"index-batch-buffer",usage:at.INDEX|at.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:n,offset:0},aUV:{buffer:r,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:r,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:s})}}function ld(t,e,r){if(t)for(const s in t){const n=s.toLocaleLowerCase(),i=e[n];if(i){let a=t[s];s==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(a)}else Ve(`${s} placement hook does not exist in shader`)}}const Wv=/\{\{(.*?)\}\}/g;function cd(t){const e={};return(t.match(Wv)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function ud(t,e){let r;const s=/@in\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function hd(t,e,r=!1){const s=[];ud(e,s),t.forEach(o=>{o.header&&ud(o.header,s)});const n=s;r&&n.sort();const i=n.map((o,l)=>`       @location(${l}) ${o},`).join(`
`);let a=e.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${i}
`),a}function dd(t,e){let r;const s=/@out\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function Yv(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function $v(t){const e=/@.*?\s+/g;return t.replace(e,"")}function Xv(t,e){const r=[];dd(e,r),t.forEach(l=>{l.header&&dd(l.header,r)});let s=0;const n=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${$v(l)};`).join(`
`),a=`return VSOutput(
            ${r.sort().map(l=>` ${Yv(l)}`).join(`,
`)});`;let o=e.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${n}
`),o=o.replace("{{start}}",`
${i}
`),o=o.replace("{{return}}",`
${a}
`),o}function fd(t,e){let r=t;for(const s in e){const n=e[s];n.join(`
`).length?r=r.replace(`{{${s}}}`,`//-----${s} START-----//
${n.join(`
`)}
//----${s} FINISH----//`):r=r.replace(`{{${s}}}`,"")}return r}const ir=Object.create(null),ao=new Map;let Qv=0;function Kv({template:t,bits:e}){const r=fm(t,e);if(ir[r])return ir[r];const{vertex:s,fragment:n}=Jv(t,e);return ir[r]=Am(s,n,e),ir[r]}function Zv({template:t,bits:e}){const r=fm(t,e);return ir[r]||(ir[r]=Am(t.vertex,t.fragment,e)),ir[r]}function Jv(t,e){const r=e.map(a=>a.vertex).filter(a=>!!a),s=e.map(a=>a.fragment).filter(a=>!!a);let n=hd(r,t.vertex,!0);n=Xv(r,n);const i=hd(s,t.fragment,!0);return{vertex:n,fragment:i}}function fm(t,e){return e.map(r=>(ao.has(r)||ao.set(r,Qv++),ao.get(r))).sort((r,s)=>r-s).join("-")+t.vertex+t.fragment}function Am(t,e,r){const s=cd(t),n=cd(e);return r.forEach(i=>{ld(i.vertex,s,i.name),ld(i.fragment,n,i.name)}),{vertex:fd(t,s),fragment:fd(e,n)}}const e0=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,t0=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,r0=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,s0=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,n0={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},i0={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function a0({bits:t,name:e}){const r=Kv({template:{fragment:t0,vertex:e0},bits:[n0,...t]});return Bi.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function o0({bits:t,name:e}){return new rm({name:e,...Zv({template:{vertex:r0,fragment:s0},bits:[i0,...t]})})}const l0={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},c0={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},oo={};function u0(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${r++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function h0(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function d0(t){return oo[t]||(oo[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${u0(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${h0(t)}
            `}}),oo[t]}const lo={};function f0(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function A0(t){return lo[t]||(lo[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${f0(t)}
            `}}),lo[t]}const p0={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},m0={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Ad={};function g0(t){let e=Ad[t];if(e)return e;const r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=s;return e=Ad[t]=new am({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class y0 extends fc{constructor(e){const r=o0({name:"batch",bits:[c0,A0(e),m0]}),s=a0({name:"batch",bits:[l0,d0(e),p0]});super({glProgram:r,gpuProgram:s,resources:{batchSamplers:g0(e)}})}}let pd=null;const pm=class mm extends Fv{constructor(){super(...arguments),this.geometry=new Uv,this.shader=pd||(pd=new y0(this.maxTextures)),this.name=mm.extension.name,this.vertexSize=6}packAttributes(e,r,s,n,i){const a=i<<16|e.roundPixels&65535,o=e.transform,l=o.a,c=o.b,u=o.c,h=o.d,f=o.tx,A=o.ty,{positions:m,uvs:g}=e,p=e.color,q=e.attributeOffset,x=q+e.attributeSize;for(let b=q;b<x;b++){const k=b*2,P=m[k],C=m[k+1];r[n++]=l*P+u*C+f,r[n++]=h*C+c*P+A,r[n++]=g[k],r[n++]=g[k+1],s[n++]=p,s[n++]=a}}packQuadAttributes(e,r,s,n,i){const a=e.texture,o=e.transform,l=o.a,c=o.b,u=o.c,h=o.d,f=o.tx,A=o.ty,m=e.bounds,g=m.maxX,p=m.minX,q=m.maxY,x=m.minY,b=a.uvs,k=e.color,P=i<<16|e.roundPixels&65535;r[n+0]=l*p+u*x+f,r[n+1]=h*x+c*p+A,r[n+2]=b.x0,r[n+3]=b.y0,s[n+4]=k,s[n+5]=P,r[n+6]=l*g+u*x+f,r[n+7]=h*x+c*g+A,r[n+8]=b.x1,r[n+9]=b.y1,s[n+10]=k,s[n+11]=P,r[n+12]=l*g+u*q+f,r[n+13]=h*q+c*g+A,r[n+14]=b.x2,r[n+15]=b.y2,s[n+16]=k,s[n+17]=P,r[n+18]=l*p+u*q+f,r[n+19]=h*q+c*p+A,r[n+20]=b.x3,r[n+21]=b.y3,s[n+22]=k,s[n+23]=P}};pm.extension={type:[X.Batcher],name:"default"};let x0=pm;function q0(t,e,r,s,n,i,a,o=null){let l=0;r*=e,n*=i;const c=o.a,u=o.b,h=o.c,f=o.d,A=o.tx,m=o.ty;for(;l<a;){const g=t[r],p=t[r+1];s[n]=c*g+h*p+A,s[n+1]=u*g+f*p+m,n+=i,r+=e,l++}}function V0(t,e,r,s){let n=0;for(e*=r;n<s;)t[e]=0,t[e+1]=0,e+=r,n++}function gm(t,e,r,s,n){const i=e.a,a=e.b,o=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),s||(s=2),n||(n=t.length/s-r);let h=r*s;for(let f=0;f<n;f++){const A=t[h],m=t[h+1];t[h]=i*A+o*m+c,t[h+1]=a*A+l*m+u,h+=s}}const b0=new de;class ym{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?Bp(r,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||b0}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Hs={extension:{type:X.ShapeBuilder,name:"circle"},build(t,e){let r,s,n,i,a,o;if(t.type==="circle"){const k=t;r=k.x,s=k.y,a=o=k.radius,n=i=0}else if(t.type==="ellipse"){const k=t;r=k.x,s=k.y,a=k.halfWidth,o=k.halfHeight,n=i=0}else{const k=t,P=k.width/2,C=k.height/2;r=k.x+P,s=k.y+C,a=o=Math.max(0,Math.min(k.radius,Math.min(P,C))),n=P-a,i=C-o}if(!(a>=0&&o>=0&&n>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(a+o)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+n,e[1]=e[3]=s+i,e[2]=e[4]=r-n,e[5]=e[7]=s-i,e;let u=0,h=l*4+(n?2:0)+2,f=h,A=c,m=n+a,g=i,p=r+m,q=r-m,x=s+g;if(e[u++]=p,e[u++]=x,e[--h]=x,e[--h]=q,i){const k=s-g;e[f++]=q,e[f++]=k,e[--A]=k,e[--A]=p}for(let k=1;k<l;k++){const P=Math.PI/2*(k/l),C=n+Math.cos(P)*a,E=i+Math.sin(P)*o,z=r+C,B=r-C,R=s+E,O=s-E;e[u++]=z,e[u++]=R,e[--h]=R,e[--h]=B,e[f++]=B,e[f++]=O,e[--A]=O,e[--A]=z}m=n,g=i+o,p=r+m,q=r-m,x=s+g;const b=s-g;return e[u++]=p,e[u++]=x,e[--A]=b,e[--A]=p,n&&(e[u++]=q,e[u++]=x,e[--A]=b,e[--A]=q),e},triangulate(t,e,r,s,n,i){if(t.length===0)return;let a=0,o=0;for(let u=0;u<t.length;u+=2)a+=t[u],o+=t[u+1];a/=t.length/2,o/=t.length/2;let l=s;e[l*r]=a,e[l*r+1]=o;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},w0={...Hs,extension:{...Hs.extension,name:"ellipse"}},v0={...Hs,extension:{...Hs.extension,name:"roundedRectangle"}},xm=1e-4,md=1e-4;function _0(t){const e=t.length;if(e<6)return 1;let r=0;for(let s=0,n=t[e-2],i=t[e-1];s<e;s+=2){const a=t[s],o=t[s+1];r+=(a-n)*(o+i),n=a,i=o}return r<0?-1:1}function gd(t,e,r,s,n,i,a,o){const l=t-r*n,c=e-s*n,u=t+r*i,h=e+s*i;let f,A;a?(f=s,A=-r):(f=-s,A=r);const m=l+f,g=c+A,p=u+f,q=h+A;return o.push(m,g),o.push(p,q),2}function Ar(t,e,r,s,n,i,a,o){const l=r-t,c=s-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);o&&u<h?u+=Math.PI*2:!o&&u>h&&(h+=Math.PI*2);let f=u;const A=h-u,m=Math.abs(A),g=Math.sqrt(l*l+c*c),p=(15*m*Math.sqrt(g)/Math.PI>>0)+1,q=A/p;if(f+=q,o){a.push(t,e),a.push(r,s);for(let x=1,b=f;x<p;x++,b+=q)a.push(t,e),a.push(t+Math.sin(b)*g,e+Math.cos(b)*g);a.push(t,e),a.push(n,i)}else{a.push(r,s),a.push(t,e);for(let x=1,b=f;x<p;x++,b+=q)a.push(t+Math.sin(b)*g,e+Math.cos(b)*g),a.push(t,e);a.push(n,i),a.push(t,e)}return p*2}function k0(t,e,r,s,n,i){const a=xm;if(t.length===0)return;const o=e;let l=o.alignment;if(e.alignment!==.5){let v=_0(t);l=(l-.5)*v+.5}const c=new Ke(t[0],t[1]),u=new Ke(t[t.length-2],t[t.length-1]),h=s,f=Math.abs(c.x-u.x)<a&&Math.abs(c.y-u.y)<a;if(h){t=t.slice(),f&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const v=(c.x+u.x)*.5,V=(u.y+c.y)*.5;t.unshift(v,V),t.push(v,V)}const A=n,m=t.length/2;let g=t.length;const p=A.length/2,q=o.width/2,x=q*q,b=o.miterLimit*o.miterLimit;let k=t[0],P=t[1],C=t[2],E=t[3],z=0,B=0,R=-(P-E),O=k-C,K=0,G=0,$=Math.sqrt(R*R+O*O);R/=$,O/=$,R*=q,O*=q;const le=l,y=(1-le)*2,w=le*2;h||(o.cap==="round"?g+=Ar(k-R*(y-w)*.5,P-O*(y-w)*.5,k-R*y,P-O*y,k+R*w,P+O*w,A,!0)+2:o.cap==="square"&&(g+=gd(k,P,R,O,y,w,!0,A))),A.push(k-R*y,P-O*y),A.push(k+R*w,P+O*w);for(let v=1;v<m-1;++v){k=t[(v-1)*2],P=t[(v-1)*2+1],C=t[v*2],E=t[v*2+1],z=t[(v+1)*2],B=t[(v+1)*2+1],R=-(P-E),O=k-C,$=Math.sqrt(R*R+O*O),R/=$,O/=$,R*=q,O*=q,K=-(E-B),G=C-z,$=Math.sqrt(K*K+G*G),K/=$,G/=$,K*=q,G*=q;const V=C-k,S=P-E,M=C-z,T=B-E,j=V*M+S*T,F=S*M-T*V,Z=F<0;if(Math.abs(F)<.001*Math.abs(j)){A.push(C-R*y,E-O*y),A.push(C+R*w,E+O*w),j>=0&&(o.join==="round"?g+=Ar(C,E,C-R*y,E-O*y,C-K*y,E-G*y,A,!1)+4:g+=2,A.push(C-K*w,E-G*w),A.push(C+K*y,E+G*y));continue}const J=(-R+k)*(-O+E)-(-R+C)*(-O+P),te=(-K+z)*(-G+E)-(-K+C)*(-G+B),me=(V*te-M*J)/F,re=(T*J-S*te)/F,Yt=(me-C)*(me-C)+(re-E)*(re-E),dt=C+(me-C)*y,Ot=E+(re-E)*y,Lt=C-(me-C)*w,ne=E-(re-E)*w,Ae=Math.min(V*V+S*S,M*M+T*T),Ic=Z?y:w,wg=Ae+Ic*Ic*x;Yt<=wg?o.join==="bevel"||Yt/x>b?(Z?(A.push(dt,Ot),A.push(C+R*w,E+O*w),A.push(dt,Ot),A.push(C+K*w,E+G*w)):(A.push(C-R*y,E-O*y),A.push(Lt,ne),A.push(C-K*y,E-G*y),A.push(Lt,ne)),g+=2):o.join==="round"?Z?(A.push(dt,Ot),A.push(C+R*w,E+O*w),g+=Ar(C,E,C+R*w,E+O*w,C+K*w,E+G*w,A,!0)+4,A.push(dt,Ot),A.push(C+K*w,E+G*w)):(A.push(C-R*y,E-O*y),A.push(Lt,ne),g+=Ar(C,E,C-R*y,E-O*y,C-K*y,E-G*y,A,!1)+4,A.push(C-K*y,E-G*y),A.push(Lt,ne)):(A.push(dt,Ot),A.push(Lt,ne)):(A.push(C-R*y,E-O*y),A.push(C+R*w,E+O*w),o.join==="round"?Z?g+=Ar(C,E,C+R*w,E+O*w,C+K*w,E+G*w,A,!0)+2:g+=Ar(C,E,C-R*y,E-O*y,C-K*y,E-G*y,A,!1)+2:o.join==="miter"&&Yt/x<=b&&(Z?(A.push(Lt,ne),A.push(Lt,ne)):(A.push(dt,Ot),A.push(dt,Ot)),g+=2),A.push(C-K*y,E-G*y),A.push(C+K*w,E+G*w),g+=2)}k=t[(m-2)*2],P=t[(m-2)*2+1],C=t[(m-1)*2],E=t[(m-1)*2+1],R=-(P-E),O=k-C,$=Math.sqrt(R*R+O*O),R/=$,O/=$,R*=q,O*=q,A.push(C-R*y,E-O*y),A.push(C+R*w,E+O*w),h||(o.cap==="round"?g+=Ar(C-R*(y-w)*.5,E-O*(y-w)*.5,C-R*y,E-O*y,C+R*w,E+O*w,A,!1)+2:o.cap==="square"&&(g+=gd(C,E,R,O,y,w,!1,A)));const _=md*md;for(let v=p;v<g+p-2;++v)k=A[v*2],P=A[v*2+1],C=A[(v+1)*2],E=A[(v+1)*2+1],z=A[(v+2)*2],B=A[(v+2)*2+1],!(Math.abs(k*(E-B)+C*(B-P)+z*(P-E))<_)&&i.push(v,v+1,v+2)}function S0(t,e,r,s){const n=xm;if(t.length===0)return;const i=t[0],a=t[1],o=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-o)<n&&Math.abs(a-l)<n,u=r,h=t.length/2,f=u.length/2;for(let A=0;A<h;A++)u.push(t[A*2]),u.push(t[A*2+1]);for(let A=0;A<h-1;A++)s.push(f+A,f+A+1);c&&s.push(f+h-1,f)}function qm(t,e,r,s,n,i,a){const o=Vv(t,e,2);if(!o)return;for(let c=0;c<o.length;c+=3)i[a++]=o[c]+n,i[a++]=o[c+1]+n,i[a++]=o[c+2]+n;let l=n*s;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=s}const C0=[],M0={extension:{type:X.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,s,n,i){qm(t,C0,e,r,s,n,i)}},P0={extension:{type:X.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,s=r.x,n=r.y,i=r.width,a=r.height;return i>=0&&a>=0&&(e[0]=s,e[1]=n,e[2]=s+i,e[3]=n,e[4]=s+i,e[5]=n+a,e[6]=s,e[7]=n+a),e},triangulate(t,e,r,s,n,i){let a=0;s*=r,e[s+a]=t[0],e[s+a+1]=t[1],a+=r,e[s+a]=t[2],e[s+a+1]=t[3],a+=r,e[s+a]=t[6],e[s+a+1]=t[7],a+=r,e[s+a]=t[4],e[s+a+1]=t[5],a+=r;const o=s/r;n[i++]=o,n[i++]=o+1,n[i++]=o+2,n[i++]=o+1,n[i++]=o+3,n[i++]=o+2}},E0={extension:{type:X.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,s,n,i){let a=0;s*=r,e[s+a]=t[0],e[s+a+1]=t[1],a+=r,e[s+a]=t[2],e[s+a+1]=t[3],a+=r,e[s+a]=t[4],e[s+a+1]=t[5];const o=s/r;n[i++]=o,n[i++]=o+1,n[i++]=o+2}},T0=new de,I0=new Me;function R0(t,e,r,s){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(I0);n.translate(-i.x,-i.y),n.scale(1/i.width,1/i.height)}else{n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return s&&n.append(T0.copyFrom(s).invert()),n}const zi={};ut.handleByMap(X.ShapeBuilder,zi);ut.add(P0,M0,E0,Hs,w0,v0);const B0=new Me,j0=new de;function z0(t,e){const{geometryData:r,batches:s}=e;s.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")N0(i.data,s,r);else if(i.action==="fill"||i.action==="stroke"){const a=i.action==="stroke",o=i.data.path.shapePath,l=i.data.style,c=i.data.hole;a&&c&&yd(c.shapePath,l,!0,s,r),c&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),yd(o,l,a,s,r)}}}function N0(t,e,r){const{vertices:s,uvs:n,indices:i}=r,a=i.length,o=s.length/2,l=[],c=zi.rectangle,u=B0,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const f=t.transform;c.build(u,l),f&&gm(l,f),c.triangulate(l,s,2,o,i,a);const A=h.uvs;n.push(A.x0,A.y0,A.x1,A.y1,A.x3,A.y3,A.x2,A.y2);const m=Zt.get(ym);m.indexOffset=a,m.indexSize=i.length-a,m.attributeOffset=o,m.attributeSize=s.length/2-o,m.baseColor=t.style,m.alpha=t.alpha,m.texture=h,m.geometryData=r,e.push(m)}function yd(t,e,r,s,n){const{vertices:i,uvs:a,indices:o}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=o.length,f=i.length/2,A=[],m=zi[l.type];let g="triangle-list";if(m.build(l,A),c&&gm(A,c),r){const b=l.closePath??!0,k=e;k.pixelLine?(S0(A,b,i,o),g="line-list"):k0(A,k,!1,b,i,o)}else if(u){const b=[],k=A.slice();F0(u).forEach(C=>{b.push(k.length/2),k.push(...C)}),qm(k,b,i,2,f,o,h)}else m.triangulate(A,i,2,f,o,h);const p=a.length/2,q=e.texture;if(q!==he.WHITE){const b=R0(j0,e,l,c);q0(i,2,f,a,p,2,i.length/2-f,b)}else V0(a,p,2,i.length/2-f);const x=Zt.get(ym);x.indexOffset=h,x.indexSize=o.length-h,x.attributeOffset=f,x.attributeSize=i.length/2-f,x.baseColor=e.color,x.alpha=e.alpha,x.texture=q,x.geometryData=n,x.topology=g,s.push(x)})}function F0(t){const e=[];for(let r=0;r<t.length;r++){const s=t[r].shape,n=[];zi[s.type].build(s,n),e.push(n)}return e}class O0{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class L0{constructor(){this.batcher=new x0,this.instructions=new Fp}init(){this.instructions.reset()}get geometry(){return ke(aw,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const yc=class gl{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){gl.defaultOptions.bezierSmoothness=e?.bezierSmoothness??gl.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),z0(e,r);const s=e.batchMode;e.customShader||s==="no-batch"?r.isBatchable=!1:s==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=Zt.get(L0),{batches:s,geometryData:n}=this._gpuContextHash[e.uid],i=n.vertices.length,a=n.indices.length;for(let u=0;u<s.length;u++)s[u].applyTransform=!1;const o=r.batcher;o.ensureAttributeBuffer(i),o.ensureIndexBuffer(a),o.begin();for(let u=0;u<s.length;u++){const h=s[u];o.add(h)}o.finish(r.instructions);const l=o.geometry;l.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),l.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const c=o.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=Iv(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new O0;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(Zt.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(s=>{Zt.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};yc.extension={type:[X.WebGLSystem,X.WebGPUSystem,X.CanvasSystem],name:"graphicsContext"};yc.defaultOptions={bezierSmoothness:.5};let Vm=yc;const D0=8,jn=11920929e-14,H0=1;function bm(t,e,r,s,n,i,a,o,l,c){const h=Math.min(.99,Math.max(0,c??Vm.defaultOptions.bezierSmoothness));let f=(H0-h)/1;return f*=f,G0(e,r,s,n,i,a,o,l,t,f),t}function G0(t,e,r,s,n,i,a,o,l,c){yl(t,e,r,s,n,i,a,o,l,c,0),l.push(a,o)}function yl(t,e,r,s,n,i,a,o,l,c,u){if(u>D0)return;const h=(t+r)/2,f=(e+s)/2,A=(r+n)/2,m=(s+i)/2,g=(n+a)/2,p=(i+o)/2,q=(h+A)/2,x=(f+m)/2,b=(A+g)/2,k=(m+p)/2,P=(q+b)/2,C=(x+k)/2;if(u>0){let E=a-t,z=o-e;const B=Math.abs((r-a)*z-(s-o)*E),R=Math.abs((n-a)*z-(i-o)*E);if(B>jn&&R>jn){if((B+R)*(B+R)<=c*(E*E+z*z)){l.push(P,C);return}}else if(B>jn){if(B*B<=c*(E*E+z*z)){l.push(P,C);return}}else if(R>jn){if(R*R<=c*(E*E+z*z)){l.push(P,C);return}}else if(E=P-(t+a)/2,z=C-(e+o)/2,E*E+z*z<=c){l.push(P,C);return}}yl(t,e,h,f,q,x,P,C,l,c,u+1),yl(P,C,b,k,g,p,a,o,l,c,u+1)}const U0=8,W0=11920929e-14,Y0=1;function $0(t,e,r,s,n,i,a,o){const c=Math.min(.99,Math.max(0,o??Vm.defaultOptions.bezierSmoothness));let u=(Y0-c)/1;return u*=u,X0(e,r,s,n,i,a,t,u),t}function X0(t,e,r,s,n,i,a,o){xl(a,t,e,r,s,n,i,o,0),a.push(n,i)}function xl(t,e,r,s,n,i,a,o,l){if(l>U0)return;const c=(e+s)/2,u=(r+n)/2,h=(s+i)/2,f=(n+a)/2,A=(c+h)/2,m=(u+f)/2;let g=i-e,p=a-r;const q=Math.abs((s-i)*p-(n-a)*g);if(q>W0){if(q*q<=o*(g*g+p*p)){t.push(A,m);return}}else if(g=A-(e+i)/2,p=m-(r+a)/2,g*g+p*p<=o){t.push(A,m);return}xl(t,e,r,c,u,A,m,o,l+1),xl(t,A,m,h,f,i,a,o,l+1)}function wm(t,e,r,s,n,i,a,o){let l=Math.abs(n-i);(!a&&n>i||a&&i>n)&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),o=Math.max(o,3);let c=l/o,u=n;c*=a?-1:1;for(let h=0;h<o+1;h++){const f=Math.cos(u),A=Math.sin(u),m=e+f*s,g=r+A*s;t.push(m,g),u+=c}}function Q0(t,e,r,s,n,i){const a=t[t.length-2],l=t[t.length-1]-r,c=a-e,u=n-r,h=s-e,f=Math.abs(l*h-c*u);if(f<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const A=l*l+c*c,m=u*u+h*h,g=l*u+c*h,p=i*Math.sqrt(A)/f,q=i*Math.sqrt(m)/f,x=p*g/A,b=q*g/m,k=p*h+q*c,P=p*u+q*l,C=c*(q+x),E=l*(q+x),z=h*(p+b),B=u*(p+b),R=Math.atan2(E-P,C-k),O=Math.atan2(B-P,z-k);wm(t,k+e,P+r,i,R,O,c*u>h*l)}const Bs=Math.PI*2,co={centerX:0,centerY:0,ang1:0,ang2:0},uo=({x:t,y:e},r,s,n,i,a,o,l)=>{t*=r,e*=s;const c=n*t-i*e,u=i*t+n*e;return l.x=c+a,l.y=u+o,l};function K0(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:r,n=Math.cos(t),i=Math.sin(t),a=Math.cos(t+e),o=Math.sin(t+e);return[{x:n-i*s,y:i+n*s},{x:a+o*s,y:o-a*s},{x:a,y:o}]}const xd=(t,e,r,s)=>{const n=t*s-e*r<0?-1:1;let i=t*r+e*s;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},Z0=(t,e,r,s,n,i,a,o,l,c,u,h,f)=>{const A=Math.pow(n,2),m=Math.pow(i,2),g=Math.pow(u,2),p=Math.pow(h,2);let q=A*m-A*p-m*g;q<0&&(q=0),q/=A*p+m*g,q=Math.sqrt(q)*(a===o?-1:1);const x=q*n/i*h,b=q*-i/n*u,k=c*x-l*b+(t+r)/2,P=l*x+c*b+(e+s)/2,C=(u-x)/n,E=(h-b)/i,z=(-u-x)/n,B=(-h-b)/i,R=xd(1,0,C,E);let O=xd(C,E,z,B);o===0&&O>0&&(O-=Bs),o===1&&O<0&&(O+=Bs),f.centerX=k,f.centerY=P,f.ang1=R,f.ang2=O};function J0(t,e,r,s,n,i,a,o=0,l=0,c=0){if(i===0||a===0)return;const u=Math.sin(o*Bs/360),h=Math.cos(o*Bs/360),f=h*(e-s)/2+u*(r-n)/2,A=-u*(e-s)/2+h*(r-n)/2;if(f===0&&A===0)return;i=Math.abs(i),a=Math.abs(a);const m=Math.pow(f,2)/Math.pow(i,2)+Math.pow(A,2)/Math.pow(a,2);m>1&&(i*=Math.sqrt(m),a*=Math.sqrt(m)),Z0(e,r,s,n,i,a,l,c,u,h,f,A,co);let{ang1:g,ang2:p}=co;const{centerX:q,centerY:x}=co;let b=Math.abs(p)/(Bs/4);Math.abs(1-b)<1e-7&&(b=1);const k=Math.max(Math.ceil(b),1);p/=k;let P=t[t.length-2],C=t[t.length-1];const E={x:0,y:0};for(let z=0;z<k;z++){const B=K0(g,p),{x:R,y:O}=uo(B[0],i,a,h,u,q,x,E),{x:K,y:G}=uo(B[1],i,a,h,u,q,x,E),{x:$,y:le}=uo(B[2],i,a,h,u,q,x,E);bm(t,P,C,R,O,K,G,$,le),P=$,C=le,g+=p}}function e_(t,e,r){const s=(a,o)=>{const l=o.x-a.x,c=o.y-a.y,u=Math.sqrt(l*l+c*c),h=l/u,f=c/u;return{len:u,nx:h,ny:f}},n=(a,o)=>{a===0?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)};let i=e[e.length-1];for(let a=0;a<e.length;a++){const o=e[a%e.length],l=o.radius??r;if(l<=0){n(a,o),i=o;continue}const c=e[(a+1)%e.length],u=s(o,i),h=s(o,c);if(u.len<1e-4||h.len<1e-4){n(a,o),i=o;continue}let f=Math.asin(u.nx*h.ny-u.ny*h.nx),A=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,A=-1,m=!0):f>0&&(A=-1,m=!0);const g=f/2;let p,q=Math.abs(Math.cos(g)*l/Math.sin(g));q>Math.min(u.len/2,h.len/2)?(q=Math.min(u.len/2,h.len/2),p=Math.abs(q*Math.sin(g)/Math.cos(g))):p=l;const x=o.x+h.nx*q+-h.ny*p*A,b=o.y+h.ny*q+h.nx*p*A,k=Math.atan2(u.ny,u.nx)+Math.PI/2*A,P=Math.atan2(h.ny,h.nx)-Math.PI/2*A;a===0&&t.moveTo(x+Math.cos(k)*p,b+Math.sin(k)*p),t.arc(x,b,p,k,P,m),i=o}}function t_(t,e,r,s){const n=(o,l)=>Math.sqrt((o.x-l.x)**2+(o.y-l.y)**2),i=(o,l,c)=>({x:o.x+(l.x-o.x)*c,y:o.y+(l.y-o.y)*c}),a=e.length;for(let o=0;o<a;o++){const l=e[(o+1)%a],c=l.radius??r;if(c<=0){o===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[o],h=e[(o+2)%a],f=n(u,l);let A;if(f<1e-4)A=l;else{const p=Math.min(f/2,c);A=i(l,u,p/f)}const m=n(h,l);let g;if(m<1e-4)g=l;else{const p=Math.min(m/2,c);g=i(l,h,p/m)}o===0?t.moveTo(A.x,A.y):t.lineTo(A.x,A.y),t.quadraticCurveTo(l.x,l.y,g.x,g.y,s)}}const r_=new Me;class s_{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new zt,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],i=s[s.length-1];return(n!==e||i!==r)&&s.push(e,r),this}arc(e,r,s,n,i,a){this._ensurePoly(!1);const o=this._currentPoly.points;return wm(o,e,r,s,n,i,a),this}arcTo(e,r,s,n,i){this._ensurePoly();const a=this._currentPoly.points;return Q0(a,e,r,s,n,i),this}arcToSvg(e,r,s,n,i,a,o){const l=this._currentPoly.points;return J0(l,this._currentPoly.lastX,this._currentPoly.lastY,a,o,e,r,s,n,i),this}bezierCurveTo(e,r,s,n,i,a,o){this._ensurePoly();const l=this._currentPoly;return bm(this._currentPoly.points,l.lastX,l.lastY,e,r,s,n,i,a,o),this}quadraticCurveTo(e,r,s,n,i){this._ensurePoly();const a=this._currentPoly;return $0(this._currentPoly.points,a.lastX,a.lastY,e,r,s,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const s=this.shapePrimitives,n=s.length;for(let i=0;i<e.instructions.length;i++){const a=e.instructions[i];this[a.action](...a.data)}if(e.checkForHoles&&s.length-n>1){let i=null;for(let a=n;a<s.length;a++){const o=s[a];if(o.shape.type==="polygon"){const l=o.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(o),s.copyWithin(a,a+1),s.length--,a--):i=o}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,s,n,i){return this.drawShape(new Me(e,r,s,n),i),this}circle(e,r,s,n){return this.drawShape(new pc(e,r,s),n),this}poly(e,r,s){const n=new Rs(e);return n.closePath=r,this.drawShape(n,s),this}regularPoly(e,r,s,n,i=0,a){n=Math.max(n|0,3);const o=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=o-u*l;c.push(e+s*Math.cos(h),r+s*Math.sin(h))}return this.poly(c,!0,a),this}roundPoly(e,r,s,n,i,a=0,o){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,r,s,n,a);const l=s*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+a,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const A=f*u+c,m=e+s*Math.cos(A),g=r+s*Math.sin(A),p=A+Math.PI+h,q=A-Math.PI-h,x=m+i*Math.cos(p),b=g+i*Math.sin(p),k=m+i*Math.cos(q),P=g+i*Math.sin(q);f===0?this.moveTo(x,b):this.lineTo(x,b),this.quadraticCurveTo(m,g,k,P,o)}return this.closePath()}roundShape(e,r,s=!1,n){return e.length<3?this:(s?t_(this,e,r,n):e_(this,e,r),this.closePath())}filletRect(e,r,s,n,i){if(i===0)return this.rect(e,r,s,n);const a=Math.min(s,n)/2,o=Math.min(a,Math.max(-a,i)),l=e+s,c=r+n,u=o<0?-o:0,h=Math.abs(o);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+s-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,s,n,i,a){if(i<=0)return this.rect(e,r,s,n);const o=Math.min(i,Math.min(s,n)/2),l=e+s,c=r+n,u=[e+o,r,l-o,r,l,r+o,l,c-o,l-o,c,e+o,c,e,c-o,e,r+o];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,a)}ellipse(e,r,s,n,i){return this.drawShape(new mc(e,r,s,n),i),this}roundRect(e,r,s,n,i,a){return this.drawShape(new gc(e,r,s,n,i),a),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let s=this._currentPoly;return s&&this.endPoly(),s=new Rs,s.points.push(e,r),this._currentPoly=s,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Rs,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let s=r.shape.x,n=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,a=s;s=i.a*s+i.c*n+i.tx,n=i.b*a+i.d*n+i.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const s=e.instructions[r];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let s=0;s<r.length;s++){const n=r[s],i=n.shape.getBounds(r_);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class es{constructor(e,r=!1){this.instructions=[],this.uid=Pe("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?kv(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new s_(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,s,n,i){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(Ke.shared);let l=0,c=0;if(!a||a.action!=="bezierCurveTo")l=o.x,c=o.y;else{l=a.data[2],c=a.data[3];const u=o.x,h=o.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,s,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,s){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(Ke.shared);let a=0,o=0;if(!n||n.action!=="quadraticCurveTo")a=i.x,o=i.y;else{a=n.data[0],o=n.data[1];const l=i.x,c=i.y;a=l+(l-a),o=c+(c-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,e,r,s]}),this._dirty=!0,this}rect(e,r,s,n,i){return this.instructions.push({action:"rect",data:[e,r,s,n,i]}),this._dirty=!0,this}circle(e,r,s,n){return this.instructions.push({action:"circle",data:[e,r,s,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,s,n,i,a,o){i||(i=n/2);const l=-1*Math.PI/2+a,c=s*2,u=Math.PI*2/c,h=[];for(let f=0;f<c;f++){const A=f%2?i:n,m=f*u+l;h.push(e+A*Math.cos(m),r+A*Math.sin(m))}return this.poly(h,!0,o),this}clone(e=!1){const r=new es;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];r.instructions.push({action:n.action,data:n.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,s=e.b,n=e.c,i=e.d,a=e.tx,o=e.ty;let l=0,c=0,u=0,h=0,f=0,A=0,m=0,g=0;for(let p=0;p<this.instructions.length;p++){const q=this.instructions[p],x=q.data;switch(q.action){case"moveTo":case"lineTo":l=x[0],c=x[1],x[0]=r*l+n*c+a,x[1]=s*l+i*c+o;break;case"bezierCurveTo":u=x[0],h=x[1],f=x[2],A=x[3],l=x[4],c=x[5],x[0]=r*u+n*h+a,x[1]=s*u+i*h+o,x[2]=r*f+n*A+a,x[3]=s*f+i*A+o,x[4]=r*l+n*c+a,x[5]=s*l+i*c+o;break;case"quadraticCurveTo":u=x[0],h=x[1],l=x[2],c=x[3],x[0]=r*u+n*h+a,x[1]=s*u+i*h+o,x[2]=r*l+n*c+a,x[3]=s*l+i*c+o;break;case"arcToSvg":l=x[5],c=x[6],m=x[0],g=x[1],x[0]=r*m+n*g,x[1]=s*m+i*g,x[5]=r*l+n*c+a,x[6]=s*l+i*c+o;break;case"circle":x[4]=xs(x[3],e);break;case"rect":x[4]=xs(x[4],e);break;case"ellipse":x[8]=xs(x[8],e);break;case"roundRect":x[5]=xs(x[5],e);break;case"addPath":x[0].transform(e);break;case"poly":x[2]=xs(x[2],e);break;default:Ve("unknown transform action",q.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,s=this.instructions[r];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;s=this.instructions[r]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function xs(t,e){return t?t.prepend(e):e.clone()}function we(t,e,r){const s=t.getAttribute(e);return s?Number(s):r}function n_(t,e){const r=t.querySelectorAll("defs");for(let s=0;s<r.length;s++){const n=r[s];for(let i=0;i<n.children.length;i++){const a=n.children[i];switch(a.nodeName.toLowerCase()){case"lineargradient":e.defs[a.id]=i_(a);break;case"radialgradient":e.defs[a.id]=a_();break}}}}function i_(t){const e=we(t,"x1",0),r=we(t,"y1",0),s=we(t,"x2",1),n=we(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",a=new cr(e,r,s,n,i==="objectBoundingBox"?"local":"global");for(let o=0;o<t.children.length;o++){const l=t.children[o],c=we(l,"offset",0),u=Ye.shared.setValue(l.getAttribute("stop-color")).toNumber();a.addColorStop(c,u)}return a}function a_(t){return Ve("[SVG Parser] Radial gradients are not yet supported"),new cr(0,0,1,0)}function qd(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Vd={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function vm(t,e){const r=t.getAttribute("style"),s={},n={},i={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const a in Vd){const o=t.getAttribute(a);o&&bd(e,i,a,o.trim())}if(r){const a=r.split(";");for(let o=0;o<a.length;o++){const l=a[o].trim(),[c,u]=l.split(":");Vd[c]&&bd(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?s:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function bd(t,e,r,s){switch(r){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=qd(s);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=Ye.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=qd(s);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=Ye.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function o_(t,e){if(typeof t=="string"){const a=document.createElement("div");a.innerHTML=t.trim(),t=a.querySelector("svg")}const r={context:e,defs:{},path:new es};n_(t,r);const s=t.children,{fillStyle:n,strokeStyle:i}=vm(t,r);for(let a=0;a<s.length;a++){const o=s[a];o.nodeName.toLowerCase()!=="defs"&&_m(o,r,n,i)}return e}function _m(t,e,r,s){const n=t.children,{fillStyle:i,strokeStyle:a}=vm(t,e);i&&r?r={...r,...i}:i&&(r=i),a&&s?s={...s,...a}:a&&(s=a);const o=!r&&!s;o&&(r={color:0});let l,c,u,h,f,A,m,g,p,q,x,b,k,P,C,E,z;switch(t.nodeName.toLowerCase()){case"path":P=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&Ve("SVG Evenodd fill rule not supported, your svg may render incorrectly"),C=new es(P,!0),e.context.path(C),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"circle":m=we(t,"cx",0),g=we(t,"cy",0),p=we(t,"r",0),e.context.ellipse(m,g,p,p),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"rect":l=we(t,"x",0),c=we(t,"y",0),E=we(t,"width",0),z=we(t,"height",0),q=we(t,"rx",0),x=we(t,"ry",0),q||x?e.context.roundRect(l,c,E,z,q||x):e.context.rect(l,c,E,z),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"ellipse":m=we(t,"cx",0),g=we(t,"cy",0),q=we(t,"rx",0),x=we(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,g,q,x),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"line":u=we(t,"x1",0),h=we(t,"y1",0),f=we(t,"x2",0),A=we(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(f,A),s&&e.context.stroke(s);break;case"polygon":k=t.getAttribute("points"),b=k.match(/\d+/g).map(B=>parseInt(B,10)),e.context.poly(b,!0),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"polyline":k=t.getAttribute("points"),b=k.match(/\d+/g).map(B=>parseInt(B,10)),e.context.poly(b,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{Ve(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}o&&(r=null);for(let B=0;B<n.length;B++)_m(n[B],e,r,s)}function l_(t){return Ye.isColorLike(t)}function wd(t){return t instanceof ji}function vd(t){return t instanceof cr}function c_(t){return t instanceof he}function u_(t,e,r){const s=Ye.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?r.alpha:s.alpha,t.texture=he.WHITE,{...r,...t}}function h_(t,e,r){return t.texture=e,{...r,...t}}function _d(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function kd(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function d_(t,e){const r={...e,...t},s=Ye.shared.setValue(r.color);return r.alpha*=s.alpha,r.color=s.toNumber(),r}function vr(t,e){if(t==null)return null;const r={},s=t;return l_(t)?u_(r,t,e):c_(t)?h_(r,t,e):wd(t)?_d(r,t,e):vd(t)?kd(r,t,e):s.fill&&wd(s.fill)?_d(s,s.fill,e):s.fill&&vd(s.fill)?kd(s,s.fill,e):d_(s,e)}function yi(t,e){const{width:r,alignment:s,miterLimit:n,cap:i,join:a,pixelLine:o,...l}=e,c=vr(t,l);return c?{width:r,alignment:s,miterLimit:n,cap:i,join:a,pixelLine:o,...c}:null}const f_=new Ke,Sd=new de,xc=class Ht extends Ut{constructor(){super(...arguments),this.uid=Pe("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new es,this._transform=new de,this._fillStyle={...Ht.defaultFillStyle},this._strokeStyle={...Ht.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new zt,this._boundsDirty=!0}clone(){const e=new Ht;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=vr(e,Ht.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=yi(e,Ht.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=vr(e,Ht.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=vr(e,Ht.defaultStrokeStyle),this}texture(e,r,s,n,i,a){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:n||0,dw:i||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?Ye.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new es,this}fill(e,r){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(e!=null&&(r!==void 0&&typeof e=="number"&&(ke(Qe,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=vr(e,Ht.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(Ke.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?r=s.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=yi(e,Ht.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(s);else{r.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,r,s,n,i,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,s,n,i,a),this}arcTo(e,r,s,n,i){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,a.a*s+a.c*n+a.tx,a.b*s+a.d*n+a.ty,i),this}arcToSvg(e,r,s,n,i,a,o){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,s,n,i,l.a*a+l.c*o+l.tx,l.b*a+l.d*o+l.ty),this}bezierCurveTo(e,r,s,n,i,a,o){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*s+l.c*n+l.tx,l.b*s+l.d*n+l.ty,l.a*i+l.c*a+l.tx,l.b*i+l.d*a+l.ty,o),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,s,n){return this._tick++,this._activePath.ellipse(e,r,s,n,this._transform.clone()),this}circle(e,r,s){return this._tick++,this._activePath.circle(e,r,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*r+s.tx,s.b*e+s.d*r+s.ty),this}moveTo(e,r){this._tick++;const s=this._transform,n=this._activePath.instructions,i=s.a*e+s.c*r+s.tx,a=s.b*e+s.d*r+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=a,this):(this._activePath.moveTo(i,a),this)}quadraticCurveTo(e,r,s,n,i){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,a.a*s+a.c*n+a.tx,a.b*s+a.d*n+a.ty,i),this}rect(e,r,s,n){return this._tick++,this._activePath.rect(e,r,s,n,this._transform.clone()),this}roundRect(e,r,s,n,i){return this._tick++,this._activePath.roundRect(e,r,s,n,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,s,n,i=0,a){return this._tick++,this._activePath.regularPoly(e,r,s,n,i,a),this}roundPoly(e,r,s,n,i,a){return this._tick++,this._activePath.roundPoly(e,r,s,n,i,a),this}roundShape(e,r,s,n){return this._tick++,this._activePath.roundShape(e,r,s,n),this}filletRect(e,r,s,n,i){return this._tick++,this._activePath.filletRect(e,r,s,n,i),this}chamferRect(e,r,s,n,i,a){return this._tick++,this._activePath.chamferRect(e,r,s,n,i,a),this}star(e,r,s,n,i=0,a=0){return this._tick++,this._activePath.star(e,r,s,n,i,a,this._transform.clone()),this}svg(e){return this._tick++,o_(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,s,n,i,a){return e instanceof de?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,s,n,i,a),this)}transform(e,r,s,n,i,a){return e instanceof de?(this._transform.append(e),this):(Sd.set(e,r,s,n,i,a),this._transform.append(Sd),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r],n=s.action;if(n==="fill"){const i=s.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=s.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=s.data,a=i.style.alignment,o=i.style.width*(1-a),l=i.path.bounds;e.addFrame(l.minX-o,l.minY-o,l.maxX+o,l.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let s=!1;for(let n=0;n<r.length;n++){const i=r[n],a=i.data,o=a.path;if(!i.action||!o)continue;const l=a.style,c=o.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const f=c[u].transform,A=f?f.applyInverse(e,f_):e;if(i.action==="fill")s=h.contains(A.x,A.y);else{const g=l;s=h.strokeContains(A.x,A.y,g.width,g.alignment)}const m=a.hole;if(m){const g=m.shapePath?.shapePrimitives;if(g)for(let p=0;p<g.length;p++)g[p].shape.contains(A.x,A.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};xc.defaultFillStyle={color:16777215,alpha:1,texture:he.WHITE,matrix:null,fill:null,textureSpace:"local"};xc.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:he.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let qr=xc;const Cd=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function A_(t){const e=[];let r=0;for(let s=0;s<Cd.length;s++){const n=`_${Cd[s]}`;e[r++]=t[n]}return r=km(t._fill,e,r),r=p_(t._stroke,e,r),r=m_(t.dropShadow,e,r),e.join("-")}function km(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function p_(t,e,r){return t&&(r=km(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function m_(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=Ye.shared.setValue(t.color).toNumber()),r}const qc=class Lr extends Ut{constructor(e={}){super(),g_(e);const r={...Lr.defaultTextStyle,...e};for(const s in r){const n=s;this[n]=r[s]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Lr.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Lr.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...qr.defaultFillStyle,...e},()=>{this._fill=vr({...this._originalFill},qr.defaultFillStyle)})),this._fill=vr(e===0?"black":e,qr.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...qr.defaultStrokeStyle,...e},()=>{this._stroke=yi({...this._originalStroke},qr.defaultStrokeStyle)})),this._stroke=yi(e,qr.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=A_(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=Lr.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Lr({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(s,n,i)=>(s[n]=i,r?.(n,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(Ye.isColorLike(e)||e instanceof cr||e instanceof ji)}};qc.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};qc.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Gs=qc;function g_(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=Gs.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){ke(Qe,"strokeThickness is now a part of stroke");const r=e.stroke;let s={};if(Ye.isColorLike(r))s.color=r;else if(r instanceof cr||r instanceof ji)s.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))s=r;else throw new Error("Invalid stroke value.");t.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){ke(Qe,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=Gs.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const s=new cr({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),n=e.fillGradientStops.map(i=>Ye.shared.setValue(i).toNumber());n.forEach((i,a)=>{const o=a/(n.length-1);s.addColorStop(o,i)}),t.fill={fill:s}}}class y_{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const s=je.get().createCanvas();s.width=e,s.height=r;const n=s.getContext("2d");return{canvas:s,context:n}}getOptimalCanvasAndContext(e,r,s=1){e=Math.ceil(e*s-1e-6),r=Math.ceil(r*s-1e-6),e=pi(e),r=pi(r);const n=(e<<17)+(r<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:s,height:n}=r,i=(s<<17)+(n<<1);e.context.clearRect(0,0,s,n),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const Md=new y_,x_=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function ql(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let s=r.length-1;s>=0;s--){let n=r[s].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!x_.includes(n)&&(n=`"${n}"`),r[s]=n}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const ho={willReadFrequently:!0},Nt=class U{static get experimentalLetterSpacingSupported(){let e=U._experimentalLetterSpacingSupported;if(e!==void 0){const r=je.get().getCanvasRenderingContext2D().prototype;e=U._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,s,n,i,a,o,l,c){this.text=e,this.style=r,this.width=s,this.height=n,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,s=U._canvas,n=r.wordWrap){const i=`${e}:${r.styleKey}`;if(U._measurementCache[i])return U._measurementCache[i];const a=ql(r),o=U.measureFont(a);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const l=U.__context;l.font=a;const u=(n?U._wordWrap(e,r,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let f=0;for(let x=0;x<u.length;x++){const b=U._measureText(u[x],r.letterSpacing,l);h[x]=b,f=Math.max(f,b)}const A=r._stroke?.width||0;let m=f+A;r.dropShadow&&(m+=r.dropShadow.distance);const g=r.lineHeight||o.fontSize;let p=Math.max(g,o.fontSize+A)+(u.length-1)*(g+r.leading);return r.dropShadow&&(p+=r.dropShadow.distance),new U(e,r,m,p,u,h,g+r.leading,f,o)}static _measureText(e,r,s){let n=!1;U.experimentalLetterSpacingSupported&&(U.experimentalLetterSpacing?(s.letterSpacing=`${r}px`,s.textLetterSpacing=`${r}px`,n=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const i=s.measureText(e);let a=i.width;const o=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-o;if(a>0)if(n)a-=r,c-=r;else{const u=(U.graphemeSegmenter(e).length-1)*r;a+=u,c+=u}return Math.max(a,c)}static _wordWrap(e,r,s=U._canvas){const n=s.getContext("2d",ho);let i=0,a="",o="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=U._collapseSpaces(u),f=U._collapseNewlines(u);let A=!h;const m=r.wordWrapWidth+c,g=U._tokenize(e);for(let p=0;p<g.length;p++){let q=g[p];if(U._isNewline(q)){if(!f){o+=U._addLine(a),A=!h,a="",i=0;continue}q=" "}if(h){const b=U.isBreakingSpace(q),k=U.isBreakingSpace(a[a.length-1]);if(b&&k)continue}const x=U._getFromCache(q,c,l,n);if(x>m)if(a!==""&&(o+=U._addLine(a),a="",i=0),U.canBreakWords(q,r.breakWords)){const b=U.wordWrapSplit(q);for(let k=0;k<b.length;k++){let P=b[k],C=P,E=1;for(;b[k+E];){const B=b[k+E];if(!U.canBreakChars(C,B,q,k,r.breakWords))P+=B;else break;C=B,E++}k+=E-1;const z=U._getFromCache(P,c,l,n);z+i>m&&(o+=U._addLine(a),A=!1,a="",i=0),a+=P,i+=z}}else{a.length>0&&(o+=U._addLine(a),a="",i=0);const b=p===g.length-1;o+=U._addLine(q,!b),A=!1,a="",i=0}else x+i>m&&(A=!1,o+=U._addLine(a),a="",i=0),(a.length>0||!U.isBreakingSpace(q)||A)&&(a+=q,i+=x)}return o+=U._addLine(a,!1),o}static _addLine(e,r=!0){return e=U._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,s,n){let i=s[e];return typeof i!="number"&&(i=U._measureText(e,r,n)+r,s[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const s=e[r];if(!U.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:U._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:U._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let s="";if(typeof e!="string")return r;for(let n=0;n<e.length;n++){const i=e[n],a=e[n+1];if(U.isBreakingSpace(i,a)||U._isNewline(i)){s!==""&&(r.push(s),s=""),r.push(i);continue}s+=i}return s!==""&&r.push(s),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,s,n,i){return!0}static wordWrapSplit(e){return U.graphemeSegmenter(e)}static measureFont(e){if(U._fonts[e])return U._fonts[e];const r=U._context;r.font=e;const s=r.measureText(U.METRICS_STRING+U.BASELINE_SYMBOL),n={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return U._fonts[e]=n,n}static clearMetrics(e=""){e?delete U._fonts[e]:U._fonts={}}static get _canvas(){if(!U.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",ho)?.measureText)return U.__canvas=r,r;e=je.get().createCanvas()}catch{e=je.get().createCanvas()}e.width=e.height=10,U.__canvas=e}return U.__canvas}static get _context(){return U.__context||(U.__context=U._canvas.getContext("2d",ho)),U.__context}};Nt.METRICS_STRING="|ÉqÅ";Nt.BASELINE_SYMBOL="M";Nt.BASELINE_MULTIPLIER=1.4;Nt.HEIGHT_MULTIPLIER=2;Nt.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();Nt.experimentalLetterSpacing=!1;Nt._fonts={};Nt._newlines=[10,13];Nt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Nt._measurementCache={};let Pd=Nt;const Ed=1e5;function Td(t,e,r,s=0){if(t.texture===he.WHITE&&!t.fill)return Ye.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof ji){const n=t.fill,i=e.createPattern(n.texture.source.resource,"repeat"),a=n.transform.copyTo(de.shared);return a.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(a),i}else if(t.fill instanceof cr){const n=t.fill,i=n.type==="linear",a=n.textureSpace==="local";let o=1,l=1;a&&r&&(o=r.width+s,l=r.height+s);let c,u=!1;if(i){const{start:h,end:f}=n;c=e.createLinearGradient(h.x*o,h.y*l,f.x*o,f.y*l),u=Math.abs(f.x-h.x)<Math.abs((f.y-h.y)*.1)}else{const{center:h,innerRadius:f,outerCenter:A,outerRadius:m}=n;c=e.createRadialGradient(h.x*o,h.y*l,f*o,A.x*o,A.y*l,m*o)}if(u&&a&&r){const h=r.lineHeight/l;for(let f=0;f<r.lines.length;f++){const A=(f*r.lineHeight+s/2)/l;n.colorStops.forEach(m=>{const g=A+m.offset*h;c.addColorStop(Math.floor(g*Ed)/Ed,Ye.shared.setValue(m.color).toHex())})}}else n.colorStops.forEach(h=>{c.addColorStop(h.offset,Ye.shared.setValue(h.color).toHex())});return c}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(de.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}return Ve("FillStyle not recognised",t),"red"}function Sm(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,s=t.length;r<s;r++){const n=t[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<i)throw new Error("[BitmapFont]: Invalid character range.");for(let o=i,l=a;o<=l;o++)e.push(String.fromCharCode(o))}else e.push(...Array.from(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Cm=class Mm extends om{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...Mm.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const s=r.style.clone();r.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=he.WHITE,s._fill.fill=null),this.applyFillAsTint=r.overrideFill;const n=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const i=ql(s);r.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/n):s.fontSize=this.baseRenderedFontSize=n,this._style=s,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=Pd.measureFont(i),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){const r=Sm(e).filter(p=>!this._currentChars.includes(p)).filter((p,q,x)=>x.indexOf(p)===q);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:n,context:i}=s.canvasAndContext,a=s.texture.source;const o=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let f=0,A=!1;const m=n.width/this.resolution,g=n.height/this.resolution;for(let p=0;p<r.length;p++){const q=r[p],x=Pd.measureText(q,o,n,!1);x.lineHeight=x.height;const b=x.width*u,k=Math.ceil((o.fontStyle==="italic"?2:1)*b),P=x.height*u,C=k+h*2,E=P+h*2;if(A=!1,q!==`
`&&q!=="\r"&&q!=="	"&&q!==" "&&(A=!0,f=Math.ceil(Math.max(E,f))),l+C>m&&(c+=f,f=E,l=0,c+f>g)){a.update();const B=this._nextPage();n=B.canvasAndContext.canvas,i=B.canvasAndContext.context,a=B.texture.source,c=0}const z=b/u-(o.dropShadow?.distance??0)-(o._stroke?.width??0);if(this.chars[q]={id:q.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:z,kerning:{}},A){this._drawGlyph(i,x,l+h,c+h,u,o);const B=a.width*u,R=a.height*u,O=new Me(l/B*a.width,c/R*a.height,C/B*a.width,E/R*a.height);this.chars[q].texture=new he({source:a,frame:O}),l+=Math.ceil(C)}}a.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return ke(Qe,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const s=this._measureCache;for(let n=0;n<e.length;n++){const i=e[n];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let l=s[i];l||(l=s[i]=r.measureText(i).width);let c=s[o];c||(c=s[o]=r.measureText(o).width);let u=r.measureText(i+o).width,h=u-(l+c);h&&(this.chars[i].kerning[o]=h),u=r.measureText(i+o).width,h=u-(l+c),h&&(this.chars[o].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=Md.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new he({source:new Er({resource:r.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,s){r.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=ql(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const n=r._stroke,i=n?.width??0;if(n&&(e.lineWidth=i,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=Td(n,e)),r._fill&&(e.fillStyle=Td(r._fill,e)),r.dropShadow){const a=r.dropShadow,o=Ye.shared.setValue(a.color).toArray(),l=a.blur*s,c=a.distance*s;e.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(a.angle)*c,e.shadowOffsetY=Math.sin(a.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,s,n,i,a){const o=r.text,l=r.fontProperties,u=(a._stroke?.width??0)*i,h=s+u/2,f=n-u/2,A=l.descent*i,m=r.lineHeight*i;a.stroke&&u&&e.strokeText(o,h,f+m-A),a._fill&&e.fillText(o,h,f+m-A)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:s}=this.pages[e];Md.returnCanvasAndContext(r),s.destroy(!0)}this.pages=null}};Cm.defaultOptions={textureSize:512,style:new Gs,mipmap:!0};let Id=Cm;function q_(t,e,r,s){const n={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=r.baseLineOffset;let i=n.lines[0],a=null,o=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=m=>{const g=i.width;for(let p=0;p<l.index;p++){const q=m.positions[p];i.chars.push(m.chars[p]),i.charPositions.push(q+g)}i.width+=m.width,o=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let m=i.chars.length-1;if(s){let g=i.chars[m];for(;g===" ";)i.width-=r.chars[g].xAdvance,g=i.chars[--m]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(i),n.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,f=e.letterSpacing*h,A=e.wordWrapWidth*h;for(let m=0;m<t.length+1;m++){let g;const p=m===t.length;p||(g=t[m]);const q=r.chars[g]||r.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||p){if(!o&&e.wordWrap&&i.width+l.width-f>A?(u(),c(l),p||i.charPositions.push(0)):(l.start=i.width,c(l),p||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&u();else if(!p){const P=q.xAdvance+(q.kerning[a]||0)+f;i.width+=P,i.spaceWidth=P,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const k=q.kerning[a]||0,P=q.xAdvance+k+f;l.positions[l.index++]=l.width+k,l.chars.push(g),l.width+=P}a=g}return u(),e.align==="center"?V_(n):e.align==="right"?b_(n):e.align==="justify"&&w_(n),n}function V_(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width/2-r.width/2;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function b_(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width-r.width;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function w_(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const s=t.lines[r];let n=0,i=s.spacesIndex[n++],a=0;const o=s.spacesIndex.length,c=(e-s.width)/o;for(let u=0;u<s.charPositions.length;u++)u===i&&(i=s.spacesIndex[n++],a+=c),s.charPositions[u]+=a}}let zn=0;class v_{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let s=`${r.fontFamily}-bitmap`,n=!0;if(r._fill.fill&&!r._stroke)s+=r._fill.fill.styleKey,n=!1;else if(r._stroke||r.dropShadow){let a=r.styleKey;a=a.substring(0,a.lastIndexOf("-")),s=`${a}-bitmap`,n=!1}if(!_e.has(s)){const a=new Id({style:r,overrideFill:n,overrideSize:!0,...this.defaultOptions});zn++,zn>50&&Ve("BitmapText",`You have dynamically created ${zn} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{zn--,_e.remove(s)}),_e.set(s,a)}const i=_e.get(s);return i.ensureCharacters?.(e),i}getLayout(e,r,s=!0){const n=this.getFont(e,r);return q_([...e],r,n,s)}measureText(e,r,s=!0){return this.getLayout(e,r,s)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},ke(Qe,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=r?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const n=r.style,i=n instanceof Gs?n:new Gs(n),a=i._fill.fill!==null&&i._fill.fill!==void 0,o=new Id({style:i,overrideFill:a,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=Sm(r.chars);return o.ensureCharacters(l.join("")),_e.set(`${s}-bitmap`,o),o.once("destroy",()=>_e.remove(`${s}-bitmap`)),o}uninstall(e){const r=`${e}-bitmap`,s=_e.get(r);s&&s.destroy()}}const Rd=new v_;class Pm extends om{constructor(e,r){super();const{textures:s,data:n}=e;Object.keys(n.pages).forEach(i=>{const a=n.pages[parseInt(i,10)],o=s[a.id];this.pages.push({texture:o})}),Object.keys(n.chars).forEach(i=>{const a=n.chars[i],{frame:o,source:l}=s[a.page],c=new Me(a.x+o.x,a.y+o.y,a.width,a.height),u=new he({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:u}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){Rd.install(e)}static uninstall(e){Rd.uninstall(e)}}const fo={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const f=e[h].match(/^[a-z]+/gm)[0],A=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const g in A){const p=A[g].split("="),q=p[0],x=p[1].replace(/"/gm,""),b=parseFloat(x),k=isNaN(b)?x:b;m[q]=k}r[f].push(m)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=r.info,[i]=r.common,[a]=r.distanceField??[];a&&(s.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),s.fontSize=parseInt(n.size,10),s.fontFamily=n.face,s.lineHeight=parseInt(i.lineHeight,10);const o=r.page;for(let h=0;h<o.length;h++)s.pages.push({id:parseInt(o[h].id,10)||0,file:o[h].file});const l={};s.baseLineOffset=s.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const f=c[h],A=parseInt(f.id,10);let m=f.letter??f.char??String.fromCharCode(A);m==="space"&&(m=" "),l[A]=m,s.chars[m]={id:A,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const f=parseInt(u[h].first,10),A=parseInt(u[h].second,10),m=parseInt(u[h].amount,10);s.chars[l[A]].kerning[l[f]]=m}return s}},Bd={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(s.getAttribute("base"),10);for(let c=0;c<a.length;c++){const u=a[c],h=parseInt(u.getAttribute("id"),10);let f=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);f==="space"&&(f=" "),l[h]=f,e.chars[f]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<o.length;c++){const u=parseInt(o[c].getAttribute("first"),10),h=parseInt(o[c].getAttribute("second"),10),f=parseInt(o[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=f}return e}},jd={test(t){return typeof t=="string"&&t.includes("<font>")?Bd.test(je.get().parseXML(t)):!1},parse(t){return Bd.parse(je.get().parseXML(t))}},__=[".xml",".fnt"],k_={extension:{type:X.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof Pm,getCacheableAssets(t,e){const r={};return t.forEach(s=>{r[s]=e,r[`${s}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},S_={extension:{type:X.LoadParser,priority:dr.Normal},name:"loadBitmapFont",test(t){return __.includes(bt.extname(t).toLowerCase())},async testParse(t){return fo.test(t)||jd.test(t)},async parse(t,e,r){const s=fo.test(t)?fo.parse(t):jd.parse(t),{src:n}=e,{pages:i}=s,a=[],o=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const f=i[h].file;let A=bt.join(bt.dirname(n),f);A=hl(A,n),a.push({src:A,data:o})}const l=await r.load(a),c=a.map(h=>l[h.src]);return new Pm({data:s,textures:c},n)},async load(t,e){return await(await je.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(s=>r.unload(s.texture.source._sourceOrigin))),t.destroy()}};class C_{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<r;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const M_={extension:{type:X.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof he),getCacheableAssets:(t,e)=>{const r={};return t.forEach(s=>{e.forEach((n,i)=>{r[s+(i===0?"":i+1)]=n})}),r}};async function Em(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const P_={extension:{type:X.DetectionParser,priority:1},test:async()=>Em("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},zd=["png","jpg","jpeg"],E_={extension:{type:X.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...zd],remove:async t=>t.filter(e=>!zd.includes(e))},T_="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Vc(t){return T_?!1:document.createElement("video").canPlayType(t)!==""}const I_={extension:{type:X.DetectionParser,priority:0},test:async()=>Vc("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},R_={extension:{type:X.DetectionParser,priority:0},test:async()=>Vc("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},B_={extension:{type:X.DetectionParser,priority:0},test:async()=>Vc("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},j_={extension:{type:X.DetectionParser,priority:0},test:async()=>Em("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class z_{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,s)=>(this._parsersValidated=!1,e[r]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const s={promise:null,parser:null};return s.promise=(async()=>{let n=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||Ve(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];if(o.load&&o.test?.(e,r,this)){i=o;break}}if(!i)return Ve(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,r,this),s.parser=i;for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];o.parse&&o.parse&&await o.testParse?.(n,r,this)&&(n=await o.parse(n,r,this)||n,s.parser=o)}return n})(),s}async load(e,r){this._parsersValidated||this._validateParsers();let s=0;const n={},i=gi(e),a=jt(e,c=>({alias:[c],src:c,data:{}})),o=a.length,l=a.map(async c=>{const u=bt.toAbsolute(c.src);if(!n[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),n[c.src]=await this.promiseCache[u].promise,r&&r(++s/o)}catch(h){throw delete this.promiseCache[u],delete n[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?n[a[0].src]:n}async unload(e){const s=jt(e,n=>({alias:[n],src:n})).map(async n=>{const i=bt.toAbsolute(n.src),a=this.promiseCache[i];if(a){const o=await a.promise;delete this.promiseCache[i],await a.parser?.unload?.(o,n,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&Ve(`[Assets] loadParser name conflict "${r.name}"`):Ve("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function cs(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function us(t,e){const r=t.split("?")[0],s=bt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const N_=".json",F_="application/json",O_={extension:{type:X.LoadParser,priority:dr.Low},name:"loadJson",test(t){return cs(t,F_)||us(t,N_)},async load(t){return await(await je.get().fetch(t)).json()}},L_=".txt",D_="text/plain",H_={name:"loadTxt",extension:{type:X.LoadParser,priority:dr.Low,name:"loadTxt"},test(t){return cs(t,D_)||us(t,L_)},async load(t){return await(await je.get().fetch(t)).text()}},G_=["normal","bold","100","200","300","400","500","600","700","800","900"],U_=[".ttf",".otf",".woff",".woff2"],W_=["font/ttf","font/otf","font/woff","font/woff2"],Y_=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function $_(t){const e=bt.extname(t),n=bt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let i=n.length>0;for(const o of n)if(!o.match(Y_)){i=!1;break}let a=n.join(" ");return i||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const X_=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Q_(t){return X_.test(t)?t:encodeURI(t)}const K_={extension:{type:X.LoadParser,priority:dr.Low},name:"loadWebFont",test(t){return cs(t,W_)||us(t,U_)},async load(t,e){const r=je.get().getFontFaceSet();if(r){const s=[],n=e.data?.family??$_(t),i=e.data?.weights?.filter(o=>G_.includes(o))??["normal"],a=e.data??{};for(let o=0;o<i.length;o++){const l=i[o],c=new FontFace(n,`url(${Q_(t)})`,{...a,weight:l});await c.load(),r.add(c),s.push(c)}return _e.set(`${n}-and-url`,{url:t,fontFaces:s}),s.length===1?s[0]:s}return Ve("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{_e.remove(`${e.family}-and-url`),je.get().getFontFaceSet().delete(e)})}};function bc(t,e=1){const r=ls.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function wc(t,e,r){t.label=r,t._sourceOrigin=r;const s=new he({source:t,label:r}),n=()=>{delete e.promiseCache[r],_e.has(r)&&_e.remove(r)};return s.source.once("destroy",()=>{e.promiseCache[r]&&(Ve("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),s.once("destroy",()=>{t.destroyed||(Ve("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),s}const Z_=".svg",J_="image/svg+xml",e1={extension:{type:X.LoadParser,priority:dr.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return cs(t,J_)||us(t,Z_)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?r1(t):t1(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function t1(t,e,r,s){const i=await(await je.get().fetch(t)).blob(),a=URL.createObjectURL(i),o=new Image;o.src=a,o.crossOrigin=s,await o.decode(),URL.revokeObjectURL(a);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||bc(t),h=e.data?.width??o.width,f=e.data?.height??o.height;l.width=h*u,l.height=f*u,c.drawImage(o,0,0,h*u,f*u);const{parseAsGraphicsContext:A,...m}=e.data??{},g=new Er({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...m});return wc(g,r,t)}async function r1(t){const r=await(await je.get().fetch(t)).text(),s=new qr;return s.svg(r),s}const s1=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Wr=null,Vl=class{constructor(){Wr||(Wr=URL.createObjectURL(new Blob([s1],{type:"application/javascript"}))),this.worker=new Worker(Wr)}};Vl.revokeObjectURL=function(){Wr&&(URL.revokeObjectURL(Wr),Wr=null)};const n1=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Yr=null;class Tm{constructor(){Yr||(Yr=URL.createObjectURL(new Blob([n1],{type:"application/javascript"}))),this.worker=new Worker(Yr)}}Tm.revokeObjectURL=function(){Yr&&(URL.revokeObjectURL(Yr),Yr=null)};let Nd=0,Ao;class i1{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new Vl;r.addEventListener("message",s=>{r.terminate(),Vl.revokeObjectURL(),e(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Ao===void 0&&(Ao=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Ao&&(this._createdWorkers++,e=new Tm().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const s=new Promise((n,i)=>{this._queue.push({id:e,arguments:r,resolve:n,reject:i})});return this._next(),s}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),s=r.id;this._resolveHash[Nd]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Nd++,id:s})}}const Fd=new i1,a1=[".jpeg",".jpg",".png",".webp",".avif"],o1=["image/jpeg","image/png","image/webp","image/avif"];async function l1(t,e){const r=await je.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const s=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const Im={name:"loadTextures",extension:{type:X.LoadParser,priority:dr.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return cs(t,o1)||us(t,a1)},async load(t,e,r){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Fd.isImageBitmapSupported()?s=await Fd.loadImageBitmap(t,e):s=await l1(t,e):s=await new Promise((i,a)=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?i(s):(s.onload=()=>{i(s)},s.onerror=a)});const n=new Er({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||bc(t),...e.data});return wc(n,r,t)},unload(t){t.destroy(!0)}},Rm=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],c1=Rm.map(t=>`video/${t.substring(1)}`);function u1(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=d1(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function h1(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",s),t.addEventListener("error",n),t.load();function s(){i(),e()}function n(a){i(),r(a)}function i(){t.removeEventListener("canplaythrough",s),t.removeEventListener("error",n)}})}function d1(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const f1={name:"loadVideo",extension:{type:X.LoadParser,name:"loadVideo"},test(t){const e=cs(t,c1),r=us(t,Rm);return e||r},async load(t,e,r){const s={...Xn.defaultOptions,resolution:e.data?.resolution||bc(t),alphaMode:e.data?.alphaMode||await $p(),...e.data},n=document.createElement("video"),i={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&n.setAttribute(l,c)}),s.muted===!0&&(n.muted=!0),u1(n,t,s.crossorigin);const a=document.createElement("source");let o;if(t.startsWith("data:"))o=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();o=Xn.MIME_TYPES[l]||`video/${l}`}return a.src=t,o&&(a.type=o),new Promise(l=>{const c=async()=>{const u=new Xn({...s,resource:n});n.removeEventListener("canplay",c),e.data.preload&&await h1(n),l(wc(u,r,t))};n.addEventListener("canplay",c),n.appendChild(a)})},unload(t){t.destroy(!0)}},Bm={extension:{type:X.ResolveParser,name:"resolveTexture"},test:Im.test,parse:t=>({resolution:parseFloat(ls.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},A1={extension:{type:X.ResolveParser,priority:-2,name:"resolveJson"},test:t=>ls.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Bm.parse};class p1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ls,this.loader=new z_,this.cache=_e,this._backgroundLoader=new C_(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){Ve("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,s=typeof r=="number"?[r]:r,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:s}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const s=gi(e),n=jt(e).map(o=>{if(typeof o!="string"){const l=this.resolver.getAlias(o);return l.some(c=>!this.resolver.hasKey(c))&&this.add(o),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),i=this.resolver.resolve(n),a=await this._mapLoadToResolve(i,r);return s?a[n[0]]:a}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},a=Object.keys(n);let o=0,l=0;const c=()=>{r?.(++o/l)},u=a.map(h=>{const f=n[h];return l+=Object.keys(f).length,this._mapLoadToResolve(f,c).then(A=>{i[h]=A})});return await Promise.all(u),s?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return _e.get(e);const r={};for(let s=0;s<e.length;s++)r[s]=_e.get(e[s]);return r}async _mapLoadToResolve(e,r){const s=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(s,r);this._backgroundLoader.active=!0;const i={};return s.forEach(a=>{const o=n[a.src],l=[a.src];a.alias&&l.push(...a.alias),l.forEach(c=>{i[c]=o}),_e.set(l,o)}),i}async unload(e){this._initialized||await this.init();const r=jt(e).map(n=>typeof n!="string"?n.src:n),s=this.resolver.resolve(r);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=jt(e);const r=this.resolver.resolveBundle(e),s=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(s)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(s=>{_e.remove(s.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const s of e.detections)e.skipDetections||await s.test()?r=await s.add(r):e.skipDetections||(r=await s.remove(r));return r=r.filter((s,n)=>r.indexOf(s)===n),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(s=>s in e).forEach(s=>{r.config[s]=e[s]})})}}const Cs=new p1;ut.handleByList(X.LoadParser,Cs.loader.parsers).handleByList(X.ResolveParser,Cs.resolver.parsers).handleByList(X.CacheParser,Cs.cache.parsers).handleByList(X.DetectionParser,Cs.detections);ut.add(M_,E_,P_,j_,I_,R_,B_,O_,H_,K_,e1,Im,f1,S_,k_,Bm,A1);const Od={loader:X.LoadParser,resolver:X.ResolveParser,cache:X.CacheParser,detection:X.DetectionParser};ut.handle(X.Asset,t=>{const e=t.ref;Object.entries(Od).filter(([r])=>!!e[r]).forEach(([r,s])=>ut.add(Object.assign(e[r],{extension:e[r].extension??s})))},t=>{const e=t.ref;Object.keys(Od).filter(r=>!!e[r]).forEach(r=>ut.remove(e[r]))});ut.add(Qb,Kb);const po={x:1,y:0,z:0},mo={x:-1,y:0,z:0},go={x:0,y:-1,z:0},yo={x:0,y:1,z:0},ge={away:yo,left:po,right:mo,towards:go,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:Hr(ee(yo,mo)),towardsRight:Hr(ee(go,mo)),towardsLeft:Hr(ee(go,po)),awayLeft:Hr(ee(yo,po))},m1=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),g1=Math.cos(13*(Math.PI/180)),Ld=-Math.PI/4,y1=t=>{const e=Math.cos(Ld),r=Math.sin(Ld);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};Hr({x:1,y:2,z:0});Hr({x:-1,y:2,z:0});const x1=t=>{const e=ty(t);return e===void 0?pe:ge[e]},q1=t=>{const e=nA(t);return e===void 0?pe:ge[e]},V1=(t,e=g1)=>{const{x:r,y:s}=t,n=Math.sqrt(r*r+s*s);if(n===0)return pe;const i=r/n,a=s/n,o=Math.abs(i),l=Math.abs(a);if(o>l){if(o>=e)return{x:Math.sign(r)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(s)*n,z:0};return t},b1={"4-way":x1,"8-way":q1,analogue:V1},w1=.2,v1=45,_1=(t,e)=>!!t.keyboardState.has(e),jm=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},bl=.5,zm=(t,e,r)=>{for(const s of t.gamepads)if(!(s===null||s.axes.length<=e)){if(r===void 0){if(Math.abs(s.axes[e])>bl)return!0}else if(s.axes[e]*r>bl)return!0}return!1},Nn=(t,e,r=!0)=>{const s=hi(be.getState()),n=s.presses[e];if(t.hudInputState[e])return!0;for(const i of n.keys)if(_1(t,i))return!0;for(const i of n.gamepadButtons)if(jm(t,i))return!0;if(r){const i=bp(e);if(i!==void 0){const a=s.axes[i.axis];for(const o of a)if(zm(t,o,i.direction))return!0}}return!1};class k1{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=pe;actionsHandled=new Set;#s=()=>{let e,r,s,n;switch("tap"){case(e=this.currentActionPress("left")):return ge.left;case(r=this.currentActionPress("right")):return ge.right;case(s=this.currentActionPress("away")):return ge.away;case(n=this.currentActionPress("towards")):return ge.towards}const i=(e!=="released"?1:0)+(r!=="released"?1:0)+(s!=="released"?1:0)+(n!=="released"?1:0);if(i>1)return this.#t;if(i===1)switch("hold"){case e:return ge.left;case r:return ge.right;case s:return ge.away;case n:return ge.towards}return pe};#n(){const e=this.#e.at(0);if(e===void 0)return pe;function*r(a){for(const o of Zs)Nn(a,o,!1)&&(yield ge[o])}function*s(a){const{axes:{x:o,y:l}}=hi(be.getState());for(const c of a.gamepads){if(c===null)continue;let u=0,h=0;for(const A of o)c.axes.length<=A||(u-=c.axes[A]);for(const A of l)c.axes.length<=A||(h-=c.axes[A]);const f={x:u,y:h,z:0};rA(f)>w1&&(yield f)}}let n=[...r(e)],i;if(n.length===1){const[a]=n,o=[...Ce(this.#e).drop(1).map(l=>[...r(l)])];e:for(const l of o){if(l.length>2)break e;if(l.length===2&&l.some(c=>Zg(c,a))){const c=l.find(u=>Oo(u,a)<.001);if(c!==void 0){i=c;break e}}}if(!i)for(const l of o)l.length===0&&(n=fp)}return ee(i??pe,...n,...s(e))}#r=({lastTime:e})=>{const r=Kl(be.getState()),i=bV(be.getState())&&r?y1:h=>h,a=b1[r](ee(i(r==="4-way"?this.#s():this.#n()),this.hudInputState.directionVector)),o=sA(a);this.#t={...o>1?El(a,1/o):a,z:0};const l={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:m1(navigator.getGamepads()),atTime:e};this.#e.unshift(l);const c=e-v1,u=this.#e.findIndex(h=>h.atTime<c);u!==-1&&this.#e.splice(u+1);for(const h of this.actionsHandled)Nn(l,h)||this.actionsHandled.delete(h)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const s=Nn(r,e);if(this.actionsHandled.has(e))return"released";if(s){const n=this.#e.at(1);return(n===void 0?!1:Nn(n,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const s of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(s))return{type:"key",input:s};for(const s of e.gamepads)if(s!==null){for(const[n,i]of s.buttons.entries())if(i.pressed&&(r===void 0||!jm(r,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of s.axes.entries())if(Math.abs(i)>bl&&(r===void 0||!zm(r,n)))return{type:"gamepadAxes",input:n}}}}get directionVector(){return this.#t}startTicking(){ct.shared.add(this.#r,void 0,mi.INTERACTION)}stopTicking(){ct.shared.remove(this.#r)}}const S1=()=>({directionVector:pe,...as(CA.map(t=>[t,!1]))}),Nm=I.createContext(null),C1=({children:t})=>{const[e]=I.useState($b),[r]=I.useState(()=>new k1(e,S1()));return I.useEffect(()=>{const s=Xb(e);return r.startTicking(),()=>{s(),r.stopTicking()}},[r,e]),d.jsx(Nm,{value:r,children:t})},vc=()=>{const t=I.useContext(Nm);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},tt=({handler:t,action:e,disabled:r=!1})=>{const s=I.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=vc();I.useEffect(()=>{if(r)return;const i=()=>{for(const a of s)if(n.currentActionPress(a)==="tap"){if(!t(a))for(const c of s)n.actionsHandled.add(c);break}};return ct.shared.add(i),()=>{ct.shared.remove(i)}},[s,r,n,t])},M1=({handler:t,disabled:e=!1})=>{const r=vc();I.useEffect(()=>{if(e)return;const s=()=>{const n=r.inputTap();n!==void 0&&t(n,r)};return ct.shared.add(s),()=>{ct.shared.remove(s)}},[e,t,r])};function D(t,e){const r=Ol();return I.useCallback(()=>{r(t(e))},[t,r,e])}const P1=()=>{const t=oe(r=>r.gameMenus.assigningInput!==void 0),e=oe(r=>r.gameMenus.openMenus.length>0);tt({action:"menu_openOrExit",handler:D(_h),disabled:t}),tt({action:"menu_exit",handler:D(_h),disabled:!e}),tt({action:"toggleShowFps",handler:D(Bt,"userSettings.showFps"),disabled:e}),tt({action:"hold",handler:D(yp,"toggle"),disabled:t}),tt({action:"map",handler:D(wb),disabled:t}),I.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),tt({action:"toggleColourisation",handler:D(Bt,"userSettings.displaySettings.uncolourised"),disabled:t}),tt({action:"cycleResolution",handler:D(oc,void 0),disabled:t})},Dd=(t,e)=>{be.dispatch(tp(Xl(Ei(be.getState()),e)))},E1=(t,e)=>{const r=Ol();I.useLayoutEffect(()=>{Dd()},[]),I.useLayoutEffect(()=>{const s=()=>Dd(t,e);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[r,e,t])},T1=()=>(E1(),P1(),Db(),null),I1=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bag’s icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,R1=`## BLACKTOOTH

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,B1=`## BOOK WORLD

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,j1=`## CONVEYOR BELTS

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,z1=`## CREDITS

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
©1987 Ocean Software Limited.

### Remake

Remake by Jim Higson
Playtesting, ideas, map design, and general support by my brother, Tom Higson
Playtesting, moral support, and `,N1=`## CROWNS

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,F1=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
if you pick them up while head and heels are joined, they get *two each*

## Iron pills ![](texture-hud_shield?sprite-tinted&text-metallicBlue&sprites-normal-height)

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud_bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height)♨ Jump higher bunny ♨

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud_fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height)⚡ Go faster bunny ⚡
![](texture-animated-head_idle_right?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,O1=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so don’t waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,L1=`## EGYPTUS

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,D1=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,H1=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heels’s evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,G1=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_walking_towards_2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heels’s bag and Head’s hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the other’s back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Head’s jumps and Heels’s jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you can’t understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,U1=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown_blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_walking_right_2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,W1=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,Y1=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Head’s race, they disappear and won’t return until they are sure the coast is
clear.

> Head Over Heels Manual
`,$1=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,X1=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,Q1=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* To the right of the address bar, click the **install icon: **
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock 󱂩**
* **Head over heels** is now installed on your mac
* If you don’t want to keep the game in the Dock, right-click the doc icon and uncheck **Options ➡ keep in doc**. It is still available in Applications

`,K1=`## Supported platforms

Almost anything with an up-to-date browser can play

Here’s some I’ve tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,Z1=`## SAFARI

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,J1=`## SPRINGS

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,ek=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Head Over Heels Manual, revised for remake
`,tk=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,rk=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minion’s back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, they’ll never get this far!

*> Your humble minion*
`,sk=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,nk=`## THE EMPEROR’S GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,ik=`## THE GAME

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain ‘keep fit’ equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,ye=Object.assign({"./bag.md":I1,"./blacktooth.md":R1,"./bookWorld.md":B1,"./conveyorBelts.md":j1,"./credits.md":z1,"./crowns.md":N1,"./cuddlyStuffedWhiteRabbits.md":F1,"./doughnuts.md":O1,"./egyptus.md":L1,"./head.md":D1,"./heels.md":H1,"./hintsAndTips.md":G1,"./historyOfTheBlacktoothEmpire.md":U1,"./hooter.md":W1,"./hushPuppies.md":Y1,"./penitentiary.md":$1,"./reincarnationFish.md":X1,"./remake/installGuide.md":Q1,"./remake/supportedPlatforms.md":K1,"./safari.md":Z1,"./springs.md":J1,"./switches.md":ek,"./swopKey.md":tk,"./teleportBack.md":rk,"./teleports.md":sk,"./theEmperorsGuardian.md":nk,"./theGame.md":ik}),_c={historyOfTheBlacktoothEmpire:ye["./historyOfTheBlacktoothEmpire.md"],theGame:ye["./theGame.md"],egyptus:ye["./egyptus.md"],penitentiary:ye["./penitentiary.md"],safari:ye["./safari.md"],bookWorld:ye["./bookWorld.md"],blacktooth:ye["./blacktooth.md"],head:ye["./head.md"],heels:ye["./heels.md"],reincarnationFish:ye["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:ye["./cuddlyStuffedWhiteRabbits.md"],hooter:ye["./hooter.md"],doughnuts:ye["./doughnuts.md"],bag:ye["./bag.md"],crowns:ye["./crowns.md"],teleports:ye["./teleports.md"],springs:ye["./springs.md"],switches:ye["./switches.md"],conveyorBelts:ye["./conveyorBelts.md"],hushPuppies:ye["./hushPuppies.md"],theEmperorsGuardian:ye["./theEmperorsGuardian.md"],swopKey:ye["./swopKey.md"],hintsAndTips:ye["./hintsAndTips.md"],credits:ye["./credits.md"],installGuide:ye["./remake/installGuide.md"]},ak={..._c,teleportBack:ye["./teleportBack.md"]},ok=/^##\s+(.*)$/m,lk=t=>{const e=t.match(ok);if(e===null)return"no title found";const[,r]=e;return r};function EE(t){if(!wl(t))throw new Error(`Invalid textureId: "${t}"; textureId ∋ {${Object.keys(Gt.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function wl(t){return Gt.frames[t]!==void 0}function TE(t){return Gt.animations[t]!==void 0}let js;const ck=async()=>{if(js!==void 0)return js;let t;try{t=await Cs.load(vA)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=he.EMPTY}const e=new dl(t,Gt);return await e.parse(),e.textureSource.scaleMode="nearest",js=e,e},uk=()=>{if(js===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return js},hk=({className:t,children:e})=>t?d.jsx("div",{className:`contents ${t}`,children:e}):e,dk=t=>t.replaceAll(".","_"),N=({children:t,className:e,noSlitWords:r,classnameCycle:s,onClick:n,noTint:i=!1,TagName:a="span"})=>{const o=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(o.length===0)return null;const l=r?[o.toUpperCase()]:o.toUpperCase().split(/\s+/);return d.jsxs(a,{className:e,onClick:n,children:[d.jsx("span",{className:"sr-only",children:o}),l.map((c,u)=>d.jsx("span",{className:De("text-nowrap inline-block",u===l.length-1?"":"me-1"),children:Array.from(c).map((h,f)=>{const A=`hud.char.${VA(h)}`;return wl(A)||console.error("no texture for char",h,h.charCodeAt(0),A,"we have:",Object.keys(uk().textures)),d.jsx("span",{className:`sprite ${wl(A)?`texture-${dk(A)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${s===void 0?"":s[f%s.length]}`},f)})},u))]})},fk=t=>t.props.children!==void 0,et=({children:t,className:e})=>d.jsx(hk,{className:e,children:Array.isArray(t)?t.map((r,s)=>d.jsx(et,{children:r},s)):typeof t=="number"?d.jsx(N,{children:String(t)}):typeof t=="string"?d.jsx(N,{children:t}):I.isValidElement(t)?t.type===N||t.type===et?t:fk(t)?I.cloneElement(t,void 0,typeof t.props.children=="string"?d.jsx(N,{children:`${t.props.children}`}):d.jsx(et,{children:t.props.children})):t:t}),Ak=({flip:t=!1,focussed:e=!1})=>d.jsx(N,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":""),children:e?"⏩⏩":"⁌⁍"});var St={},Nr={},Fr={},Hd;function Ni(){if(Hd)return Fr;Hd=1;var t=Fr&&Fr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Fr,"__esModule",{value:!0});const r=t(rs()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return Fr.default=r,Fr}var Gd;function pk(){if(Gd)return Nr;Gd=1;var t=Nr&&Nr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Nr,"__esModule",{value:!0});const e=t(rs()),r=t(Hf()),s=t(Ni()),n=({id:i,children:a})=>{const{refs:o,renderItems:l}=e.default.useContext(s.default),c=o[i],u=l[i];return c?u?r.default.createPortal(u(a),c,i):r.default.createPortal(a,c,i):null};return Nr.default=n,Nr}var Or={},Ud;function mk(){if(Ud)return Or;Ud=1;var t=Or&&Or.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Or,"__esModule",{value:!0});const e=t(rs()),r=t(Ni()),s=({id:n,renderItem:i=o=>o,className:a})=>{const{register:o,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&o(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,a].filter(u=>!!u).join(" "),ref:c})};return Or.default=s,Or}var rr={},Wd;function gk(){if(Wd)return rr;Wd=1;var t=rr&&rr.__rest||function(i,a){var o={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.indexOf(l)<0&&(o[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)a.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(o[l[c]]=i[l[c]]);return o},e=rr&&rr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(rr,"__esModule",{value:!0});const r=e(rs()),s=e(Ni()),n=({children:i})=>{const[a,o]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((A,m,g)=>{o(p=>Object.assign(Object.assign({},p),{[A]:m})),c(p=>Object.assign(Object.assign({},p),{[A]:g}))},[]),h=r.default.useCallback(A=>{o(m=>{const g=m,p=A;return g[p],t(g,[typeof p=="symbol"?p:p+""])}),c(m=>{const g=m,p=A;return g[p],t(g,[typeof p=="symbol"?p:p+""])})},[]),f=r.default.useMemo(()=>({refs:a,renderItems:l,register:u,unregister:h}),[a,l,u,h]);return r.default.createElement(s.default.Provider,{value:f},i)};return rr.default=n,rr}var Yd;function yk(){if(Yd)return St;Yd=1;var t=St&&St.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(St,"__esModule",{value:!0}),St.Context=St.Placeholder=St.Provider=void 0;const e=t(pk()),r=t(mk()),s=t(gk()),n=t(Ni());St.Provider=s.default,St.Placeholder=r.default,St.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=r.default,i.Provider=s.default,St.default=i,St}var xk=yk();const hs=$e(xk),xe="leading-none [&_[class*='texture-hud']]:mb-oneScaledPix",qk=["menu_select","swop","jump"],Us="data-menuitem_id",Fm="data-menuitem_hidden",Om="data-menuitem_disabled",Vk=()=>{},Q=({id:t,label:e,valueElement:r,flipLeader:s=!1,doubleHeightWhenFocussed:n,onSelect:i=Vk,hidden:a=!1,disabled:o=!1,hintInline:l=!1,className:c,hint:u,leader:h})=>{const f=I.useRef(!0),A=oe(p=>p.gameMenus.openMenus.at(0)?.scrollableSelection??!1),m=oe(p=>p.gameMenus.openMenus.at(0)?.focussedItemId===t);tt({action:qk,handler:i,disabled:!m||a||o});const g=d.jsxs("li",{[Us]:t,[Fm]:a,[Om]:o,tabIndex:0,className:De("contents",a?"hidden":"",n&&m?"sprites-double-height":"",m?"selectedMenuItem":"",c),onMouseMove:D(lc,{focussedItemId:t,scrollableSelection:!1}),onClick:o?void 0:i,children:[h||d.jsx(Ak,{flip:s,focussed:m}),d.jsx("div",{ref:p=>{m&&A&&p?.scrollIntoView({behavior:f.current?"instant":"smooth",block:"center"}),f.current=!1},className:De(r===void 0?"col-span-2":""),children:typeof e=="string"?d.jsx(d.Fragment,{children:d.jsx(N,{children:e})}):e}),r!==void 0&&r,!m||u===void 0||l?null:d.jsx(hs,{children:typeof u=="string"?d.jsx(N,{className:xe,children:u}):u})]});return l&&u?d.jsxs(d.Fragment,{children:[g,d.jsx("div",{className:"col-span-2 col-start-2 mb-2",children:u})]}):g},Ft=()=>d.jsx(Q,{id:"back",label:"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:D(He)}),an=t=>d.jsx("div",{className:`col-span-3 h-1 ${t}`}),Lm=()=>{const t=document.body.querySelectorAll(`[${Us}]`);return Array.from(t)},$d=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=be.getState();if(e===void 0)return!0;const r=Lm();if(r.length<=1)return!0;const s=r.findIndex(i=>i.getAttribute(Us)===e);if(s===-1)return!0;let n=s;do n=(n+t+r.length)%r.length;while(r[n].getAttribute(Fm)==="true"||r[n].getAttribute(Om)==="true");return be.dispatch(lc({focussedItemId:r[n].getAttribute(Us),scrollableSelection:!0})),!1},bk=t=>{const e=np();tt({action:"away",handler:I.useCallback(()=>{if(t.current!==null)return $d(-1)},[t]),disabled:e}),tt({action:"towards",handler:I.useCallback(()=>{if(t.current!==null)return $d(1)},[t]),disabled:e})},Be=({className:t="",children:e})=>{const r=I.useRef(null);return I.useEffect(()=>{if(r.current===null||be.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const s=Lm();be.dispatch(lc({focussedItemId:s[0].getAttribute(Us),scrollableSelection:!0}))},[]),bk(r),d.jsx("menu",{ref:r,className:De("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})};var Dm=Hf();const IE=$e(Dm),Ge=({children:t})=>Dm.createPortal(d.jsx(Ts,{children:t}),document.body),on=({className:t})=>d.jsxs("div",{className:De("text-redShadow zx:text-zxMagenta sprites-double-height flex flex-row gap-1",t),children:[d.jsx(N,{className:"inline-block scale-[-1]",onClick:D(He),children:"⏩⏩"}),d.jsx(N,{className:"inline-block",onClick:D(He),children:"Back"})]}),wk=({pageName:t})=>{const e=_c[t],r=lk(e),s=Vt()==="desktop";return d.jsx(Q,{id:`markdown/${t}`,label:r,onSelect:D(Mt,`markdown/${t}`),doubleHeightWhenFocussed:s})},vk=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midGrey zx:bg-zxCyan",onClick:D(He)}),d.jsx(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:d.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${xe} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[Et()&&d.jsx(on,{className:"mb-1"}),d.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[d.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),d.jsx(N,{className:"sprites-double-height mx-1",children:"Read the manual"}),d.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),d.jsxs(Be,{children:[[...Ce(Nl(_c)).map(t=>d.jsx(wk,{pageName:t},t))],d.jsx(an,{}),Et()||d.jsx(Ft,{})]})]})})]}),_k={"":I.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},Xd=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),kk=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),xo=t=>t.replace(/^\s+|\s+$/g," "),ze=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),Ms=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,s=0;const n=ze("");let i,a;e?(i=ze("p"),a=[n,i],n.c.push(i)):(i=n,a=[n]);let o;const l=(h,f=!0)=>(f&&a.push(h),i.c.push(h),f&&(i=h),h),c=h=>{const f=a.findIndex(A=>A.t===h);a=a.slice(0,f),i=a.at(-1)};for(;o=r.exec(t);){const h=t.substring(s,o.index);if(s=r.lastIndex,h!=="")if(i===n&&e){const f=ze("p",xo(h));n.c.push(f),a=[n,f],i=f}else i.c.push(xo(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(o[3]||o[4]){const f=ze("pre",o[4]?Xd(o[4]):ze("code",Xd(o[3]),o[2]?{language:`language-${o[2].toLowerCase()}`}:{}));n.c.push(f),a=[n],i=n}else if(o[6]){const f=o[6],A=f!==">",m=!!f.match(/\./),g=A?m?"ol":"ul":"blockquote",p=o[5].split(`
`).map(x=>x.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(x=>x.trim()!==""),q=ze(g,A?p.map(x=>ze("li",Ms(x).c)):Ms(p.join(`
`)).c);n.c.push(q),a=[n,q],i=n}else if(o[8]){const f=ze("img",[],{src:o[8],...o[7]?{alt:o[7]}:{}});if(e&&i===n){const A=ze("p",f);n.c.push(A),i=A,a=[n,A]}else l(f,!1)}else if(o[10]){const f=a.find(A=>A.t==="a");f&&(f.p.href=o[11])}else if(o[9])l(ze("a"));else if(o[14]){const f="h"+o[14].length;n.c.push(ze(f,Ms(o[15]).c)),a=[n],i=n}else if(o[13])n.c.push(ze("h1",Ms(o[12]).c)),a=[n],i=n;else if(o[16])l(ze("code",o[16]),!1);else if(o[17]?.[0]===`
`||o[17]===`  
`){if(!(a[1]?.t==="p")){const m=n.c;let g;for(g=m.length-1;g>=0&&!kk(m[g]);g--);if(g!==n.c.length-1){const p=n.c.splice(g+1);n.c.push(ze("p",p))}}const A=ze("p");n.c.push(A),a=[n,A],i=A}else if(o[1])n.c.push(ze("hr")),a=[n],i=n;else if(o[17]){const f=o[17].length===2?"strong":"em";a.findIndex(m=>m.t===f)===-1?l(ze(f)):c(f)}}}const u=xo(t.substring(s));if(u.length){const h=n.c.at(-1);let f;h?.t==="p"?f=h:e?(f=ze("p"),n.c.push(f)):f=n,f.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},Sk=(t,e={})=>{const r={..._k,...e},s=(n,i=0)=>{const a=n.t===""?I.Fragment:r[n.t];return I.createElement(a,{...n.p,key:i},n.c.length===0?void 0:n.c.map((o,l)=>typeof o=="string"?o:s(o,l)))};return s(Ms(t,!0))},Ck=({markdown:t,customComponents:e})=>Sk(t,e),Mk={h2:function({children:e}){return d.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${xe}`,children:d.jsx(et,{children:e})})},h3:function({children:e}){return d.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:d.jsx(et,{children:e})})},blockquote:function({children:e}){return d.jsx("blockquote",{className:`${xe} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:d.jsxs(et,{children:["> ",e]})})},p:function({children:e}){return d.jsx("div",{className:`mb-1 last:mb-0 ${xe}`,children:d.jsx(et,{children:e})})},a:function({children:e,href:r}){return d.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:d.jsx(et,{children:e})})},li:function({children:e}){return d.jsx("div",{className:`mb-1 clear-both ${xe}`,children:d.jsxs(et,{children:[d.jsx(N,{className:"text-metallicBlue zx:text-zxYellow",children:"•"}),e]})})},strong:function({children:e}){return d.jsx(et,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return d.jsx(et,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=rn();if(e===void 0)throw new Error("image without src");const s=e.split(/\?|&/);return d.jsx("span",{style:{"--scale":r*2},children:d.jsx("span",{className:De("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",s.join(" "))})})},hr:function(){return d.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},lt=({markdown:t,className:e})=>d.jsx("div",{className:`contents ${e}`,children:d.jsx(Ck,{customComponents:Mk,markdown:t})}),Qd=4,Kd=Un.h,Hm=()=>{const t=rn(),e=I.useRef(null),r=I.useCallback(s=>{if(e.current===null)return;const{scrollTop:n,scrollLeft:i}=e.current,a=ge[s],o=n+t*Qd*-a.y*Kd,l=i+t*Qd*a.x*Kd;e.current.scrollTo({left:l,top:o,behavior:"instant"})},[t]);return tt({handler:I.useCallback(()=>{r("towards")},[r]),action:"towards"}),tt({handler:I.useCallback(()=>{r("away")},[r]),action:"away"}),tt({handler:I.useCallback(()=>{r("left")},[r]),action:"left"}),tt({handler:I.useCallback(()=>{r("right")},[r]),action:"right"}),e},Zd=({pageName:t})=>{const e=ak[t],r=Hm();return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:D(He)}),d.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:D(He),children:[d.jsxs("div",{className:De("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[Et()&&d.jsx(on,{className:"pb-1"}),d.jsx(lt,{markdown:e})]}),d.jsx(Be,{className:"hidden",children:d.jsx(Ft,{})})]})]})},qs=t=>t,Jd={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},Pk={egyptus:qs("texture-crown_egyptus"),blacktooth:qs("texture-crown_blacktooth"),bookworld:qs("texture-crown_bookworld"),penitentiary:qs("texture-crown_penitentiary"),safari:qs("texture-crown_safari")},Vs=({planet:t,className:e,label:r=t})=>{const s=oe(i=>i.gameMenus.planetsLiberated[t]),n=!Ql();return d.jsxs("div",{className:`flex flex-col ${e}`,children:[d.jsx("span",{className:`sprite block ${Pk[t]} ${s?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),d.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${s?"":"colourised:brightness-halfBrite"} ${Jd[t][0]}`}),d.jsx(N,{classnameCycle:n?Jd[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${s?"":"colourised:brightness-halfBrite"}`,children:r})]})},Ek=()=>d.jsxs(d.Fragment,{children:[d.jsx(N,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),d.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[d.jsx(Vs,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(Vs,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(Vs,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(Vs,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(Vs,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),kc=I.createContext(null),Tk=({children:t})=>{const[e,r]=I.useState(0),s=I.useCallback(()=>r(i=>i+1),[]),n=I.useCallback(()=>r(i=>i-1),[]);return d.jsx(kc,{value:{count:e,loadingStarted:s,loadingFinished:n},children:t})},Ik=()=>{const t=I.useContext(kc);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t},Rk=()=>{const t=I.useContext(kc);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t.count>0},Bk="/assets/rock-C4e7VvX5.mp3",jk=({playMusic:t=!1})=>{const e=Rk(),r=D(He);return d.jsxs(Ge,{children:[e?d.jsx(Gf,{}):d.jsx(Ze,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsxs(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,children:[t&&d.jsx("audio",{src:Bk,autoPlay:!0,loop:!0}),d.jsx(Ek,{}),d.jsx(Be,{className:"hidden",children:!e&&d.jsx(Ft,{})})]})]})},Qt=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],zk=()=>d.jsx(d.Fragment,{children:d.jsxs("div",{className:"flex justify-center gap-2 resHandheld:gap-1 leading-none",children:[d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(N,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(N,{classnameCycle:Qt,children:"Jon"}),d.jsx(N,{classnameCycle:Qt,children:"Ritman"})]}),d.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(N,{classnameCycle:Qt,children:"Bernie"}),d.jsx(N,{classnameCycle:Qt,children:"Drummand"})]})]})]}),d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(N,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),d.jsx("address",{className:"flex",children:d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(N,{classnameCycle:Qt,children:"Jim"}),d.jsx(N,{classnameCycle:Qt,children:"Higson"})]})})]})]})}),Gm=({noSubtitle:t,className:e})=>d.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[d.jsxs("h1",{className:"flex",children:[d.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[d.jsx(N,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),d.jsxs("div",{className:"mt-1 resHandheld:mt-0 relative",children:[d.jsx("span",{className:"sprite zx:sprite-revert-to-white texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"}),d.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})]}),d.jsx(N,{classnameCycle:Qt,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),d.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[d.jsx(N,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),d.jsxs("div",{className:"mt-1 resHandheld:mt-0 relative",children:[d.jsx("span",{className:"sprite zx:sprite-revert-to-white texture-animated-heels_idle_towards hover:texture-animated-heels_walking_towards relative z-topSprite"}),d.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})]})]}),t||d.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[d.jsx(N,{className:"text-midRed zx:text-zxCyan",children:"block"}),d.jsx(N,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),d.jsx(N,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),d.jsx(N,{className:"text-moss zx:text-zxWhite",children:"ing"}),d.jsx(N,{classnameCycle:Qt,children:" remake"})]})]}),Nk=()=>{const[t,e]=I.useReducer(r=>!r,!1);return d.jsxs("div",{onClick:e,className:"flex bg-metallicBlueHalfbrite text-metallicBlue justify-end absolute bottom-0 right-2 z-dialog",children:[!t&&d.jsx(N,{children:"*"}),t&&d.jsxs(N,{children:["9a47ecb","2025-07-30"]})]})},Fk=()=>{const t=Zr();return d.jsx(N,{children:t?"Resume the game":"Play the game"})},Ok=()=>d.jsx(Q,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:D(Mt,"installGuide")}),Lk=()=>{const t=Zr(),e=oe(r=>r.gameMenus.reincarnationPoint!==void 0);return d.jsx(Q,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:D(Mt,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},ef="https://discord.gg/Se5Jznc2jm",Dk=t=>{const e=Zr(),r=D(Mt,"crowns"),s=D(Mt,"score"),n=I.useCallback(()=>{r(),s()},[r,s]);return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),d.jsxs(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[d.jsx(Gm,{noSubtitle:e,className:e?"resHandheld:hidden":""}),d.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[d.jsxs(Be,{className:"w-24 mx-auto",children:[d.jsx(Q,{id:"playGame",label:d.jsx(Fk,{}),doubleHeightWhenFocussed:!0,onSelect:D(qb)}),d.jsx(Q,{id:"map",label:"use the Map",onSelect:D(Mt,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),d.jsx(Q,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e})]}),d.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[d.jsxs(Be,{children:[d.jsx(Q,{id:"modernisationOptions",label:"Options",doubleHeightWhenFocussed:!0,onSelect:D(Mt,"modernisationOptions")}),d.jsx(Q,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:D(Mt,"readTheManual")})]}),d.jsxs(Be,{children:[iq()||d.jsx(Ok,{}),d.jsx(Q,{id:"discord",leader:d.jsx(N,{children:bA}),label:d.jsx("a",{href:ef,target:"_blank",children:d.jsx(N,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:I.useCallback(()=>{window.open(ef,"_blank")},[])})]})]}),d.jsx(Be,{className:"w-24 mx-auto",children:d.jsx(Lk,{})})]}),!e&&d.jsx(zk,{})]}),d.jsx(Nk,{})]})},ln=({className:t})=>d.jsx("div",{className:De("contents",t),children:d.jsx(hs.Placeholder,{})}),Um=t=>{t.reincarnateFrom(be.getState().gameMenus.reincarnationPoint),be.dispatch(xp())},Hk="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",Gk=()=>{const t=Br();return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midRed zx:bg-zxYellow"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed px-1",children:[d.jsx(N,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),d.jsx(lt,{markdown:Hk,className:"text-redShadow zx:text-zxWhite"}),d.jsxs(Be,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{Um(t)}}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:D(gp,{offerReincarnation:!1})})]})]})]})},Ne="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow",Uk=()=>{const t=oe(r=>r.gameMenus.reincarnationPoint!==void 0),e=Br();return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midRed zx:bg-zxYellow"}),d.jsx(Se,{className:"bg-white zx:bg-zxRed px-1",children:d.jsx(hs.Provider,{children:d.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[d.jsx(N,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),d.jsxs(Be,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:d.jsx("span",{className:`${Ne} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:D(He),hint:"Back to the game"}),t&&d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:d.jsx("span",{className:`${Ne} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>Um(e),hint:"Go back and continue from the last reincarnation fish you ate"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:D(gp,{offerReincarnation:!1}),leader:d.jsx("span",{className:`${Ne} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(lt,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"})})]}),d.jsx(ln,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},Wm=ns(()=>ss(()=>import("./campaign-DbbAJxQb.js"),__vite__mapDeps([6,4,5]))),tf=(t,e)=>t*160+e*1e4,Wk=()=>{const{campaign:t}=I.use(Wm()),e=oe(xV),r=oe(({gameMenus:{roomsExplored:o}})=>Lo(Ce(Tr(o)))),s=tf(r,e),n=Lo(fA(t.rooms)),i=tf(n,5),a=s<8e3?"beginner":s<2e4?"novice":s<3e4?"spy":s<55e3?"master-spy":s<84e3?"hero":s<i?"liberator":"completionist";return d.jsxs(d.Fragment,{children:[d.jsx(Gm,{noSubtitle:!0,className:"resHandheld:hidden"}),d.jsx(N,{classnameCycle:Qt,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:a}),d.jsxs("div",{className:`contents ${xe}`,children:[d.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",s.toLocaleString()]}),d.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",n," rooms"," ",`(${(100*r/n).toFixed(1)}%)`]}),d.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),d.jsx(Be,{className:"hidden",children:d.jsx(Ft,{})})]})]})},Yk=()=>d.jsx(Ge,{children:d.jsxs(I.Suspense,{fallback:d.jsxs(d.Fragment,{children:[d.jsx(Gf,{}),d.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[d.jsx(Ze,{className:"bg-metallicBlue zx:bg-zxCyan"}),d.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:D(He),children:d.jsx(Wk,{})})]})}),Vr="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",$k=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:Vr,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:Vr,children:"Cursor"}),"⬇"]});case"ArrowUp":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:Vr,children:"Cursor"}),"⬆"]});case"ArrowLeft":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:Vr,children:"Cursor"}),"⬅"]});case"ArrowRight":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:Vr,children:"Cursor"}),"➡"]});default:return t}},Xk=t=>t===0?"⬅➡":t===1?"⬆⬇":`axis${t}`,Qk=t=>{switch(sh[t]){case"dPadDown":return"d-Pad⬇";case"dPadUp":return"d-Pad⬆";case"dPadLeft":return"d-Pad⬅";case"dPadRight":return"d-Pad➡";case"a":return d.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return d.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return d.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return d.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return sh[t]??t},Sc=({action:t,keyClassName:e,className:r,flashingCursor:s=!1})=>{const n=oe(a=>a.gameMenus.assigningInput?.action===t?a.gameMenus.assigningInput?.presses:hi(a).presses[t]),i=oe(a=>{const o=bp(t);return o===void 0?fp:a.gameMenus.assigningInput?.action===t?a.gameMenus.assigningInput.axes:hi(a).axes[o.axis]});return d.jsxs("div",{className:r,children:[n.keys.map(a=>d.jsx("span",{className:De("text-nowrap",e),children:d.jsx(et,{children:$k(a)})},`key:${a}`)),i.map(a=>d.jsx("span",{className:De("text-nowrap",e),children:d.jsxs(et,{children:[d.jsx("span",{className:Vr,children:"🕹"}),Xk(a)]})},`gamePadAxis:${a}`)),n.gamepadButtons.map(a=>d.jsx("span",{className:De("text-nowrap",e),children:d.jsxs(et,{children:[d.jsx("span",{className:Vr,children:"🕹"}),Qk(a)]})},`gamePadButton:${a}`)),s&&d.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]})},Kk=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>d.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:Vt()==="desktop"?d.jsxs(d.Fragment,{children:[d.jsx(N,{className:"me-1",children:"Press"}),d.jsx(N,{className:De("me-1",r),children:t}),d.jsx(N,{children:"to continue"}),d.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[d.jsx(N,{children:"("}),d.jsx(Sc,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),d.jsx(N,{children:")"})]})]}):d.jsxs(d.Fragment,{children:[d.jsx(N,{className:De("me-1",r),children:"Tap"}),d.jsx(N,{children:"to continue"})]})}),Zk=()=>d.jsx(Ge,{children:d.jsxs(Se,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:D(He),children:[d.jsx(N,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),d.jsx("span",{className:"zx",children:d.jsx(Kk,{className:`${xe} px-1`,action:"hold"})})]})});function Ym(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=Ym(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function $m(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=Ym(t))&&(s&&(s+=" "),s+=e);return s}function Jk(...t){return De($m(t))}const eS=/^(?<modifiers>[⇧⌘^]*)(?<key>.+)$/,tS=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},rS=(t,e,r)=>{const s=t?.join(" ");I.useEffect(()=>{if(!t||t.length===0)return;const n=i=>{if(i.target.closest(".monaco-editor")===null)for(const l of t){const c=l.match(eS);if(!c||!c.groups)continue;const{modifiers:u,key:h}=c.groups;if(tS(u)){console.warn(`Invalid shortcut "${l}": duplicate modifiers`);continue}const f=u.includes("^"),A=u.includes("⌘"),m=u.includes("⇧"),g=f||A||m,p=f===i.ctrlKey&&A===i.metaKey&&m===i.shiftKey&&(g||!i.ctrlKey&&!i.metaKey&&!i.shiftKey);if(i.key.toLowerCase()===h.toLowerCase()&&p){r?.(),i.preventDefault();break}}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[e,r,s])},sr=({className:t,value:e,onChange:r,trueLabel:s="ON",falseLabel:n="OFF",label:i,shortcutKeys:a})=>{const o=Math.max(s.length,n.length)+1,l=s.padStart(o," "),c=n.padEnd(o," ");return rS(a,!1,()=>{r?.(!e,void 0)}),d.jsxs("span",{onClick:u=>r?.(!e,u),className:Jk("inline-flex justify-between",t),children:[i&&d.jsx(N,{className:"inline-block mr-1 text-lightGrey",noSlitWords:!0,children:i}),d.jsx(N,{className:$m("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?l:c})]})},Cc="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",Mc="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",qo="[&_.em]:text-lightBeige zx:[&_.em]:text-zxCyan",sS=`![](texture-animated-head_walking_towards?float-right)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,nS=`pokes can’t be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,iS="everything to *select the keys* and other input settings",aS=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:D(He)}),d.jsx(Se,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:d.jsx(hs.Provider,{children:d.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+Mc,children:[Et()&&d.jsx(on,{className:"text-highlightBeige"}),d.jsx(N,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),d.jsxs(Be,{className:Cc,children:[d.jsx(Q,{id:"controlOptions",label:"Control options",doubleHeightWhenFocussed:!0,onSelect:D(Mt,"controlOptions"),hint:d.jsx(lt,{className:qo,markdown:iS})}),d.jsx(Q,{id:"sound",label:"Sound options",doubleHeightWhenFocussed:!0,onSelect:D(Mt,"sound")}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:d.jsx(sr,{value:!Ql()}),onSelect:D(Bt,"userSettings.displaySettings.uncolourised"),hint:d.jsx(lt,{className:qo,markdown:sS})}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"livesModel",label:"∞ Lives poke",hint:d.jsx(lt,{className:qo,markdown:nS}),valueElement:d.jsx(sr,{value:oe(ip)}),onSelect:D(Bt,"userSettings.infiniteLivesPoke"),disabled:Zr()}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"infiniteDoughnutsPoke",label:"∞ doughnuts poke",valueElement:d.jsx(sr,{value:oe(ap)}),onSelect:D(Bt,"userSettings.infiniteDoughnutsPoke"),disabled:Zr()}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"showFps",label:"Show FPS",valueElement:d.jsx(sr,{value:oe(pV)}),onSelect:D(Bt,"userSettings.showFps"),hint:"show frame rate (frames per second) in the top-right corner"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"crtFilter",label:"CRT TV effect",valueElement:d.jsx(sr,{value:oe(yV)}),onSelect:D(Bt,"userSettings.displaySettings.crtFilter"),hint:"Subtle screen glow a bit like an old tv"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:D(Mt,"emulatedResolution")}),d.jsx(an,{}),Et()||d.jsx(Ft,{})]}),Et()||d.jsx(ln,{className:"text-moss zx:text-zxGreen"})]})})})]}),rf="text-pink zx:text-zxCyan",oS=()=>{const t=oe(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:d.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${xe} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[d.jsx(N,{children:"Press "}),d.jsx(Sc,{className:`inline ${rf}`,action:"menu_openOrExit",keyClassName:"me-1"}),d.jsx(N,{children:"when done selecting keys for "}),d.jsx(N,{className:rf,children:t})]})},lS="**world**: Control is relative to directions in the isometric world",cS=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but requires inputting diagonals a lot`,uS=({className:t})=>d.jsxs("span",{children:[d.jsx(N,{className:De("text-nowrap me-1","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:di()?"screen":"world"}),d.jsx(N,{className:De("text-nowrap","text-moss zx:text-zxBlue selectedMenuItem:text-mossHalfbrite zx:selectedMenuItem:text-zxBlue",t),children:di()?"⬅ ➡ ⬆ ⬇":"↖ ↘ ↗ ↙"})]}),hS=()=>{const t=di();return d.jsx(Q,{id:"screenRelativeControl",label:"input axes",leader:d.jsx("span",{className:`${Ne} ${t?"texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections":"texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_worldDirections"}`}),valueElement:d.jsx(uS,{}),onSelect:D(Bt,"userSettings.screenRelativeControl"),hintInline:!0,hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:t?cS:lS})})},Xm="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",dS="**4-way**: true to the 1987 original - move in x directions only",fS="**8-way**: the original with *4-way* movement, plus *diagonals*",AS="**analogue**: move in *any* direction with analogue stick",pS=()=>{const t=op();return d.jsx(Q,{id:"analogueControl",label:"Directions",leader:d.jsx("span",{className:`${Ne} texture-joystick`}),valueElement:d.jsx(N,{className:Xm,children:t}),onSelect:D(vb),hintInline:!0,hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:t==="analogue"?AS:t==="8-way"?fS:dS})})},mt=({className:t,action:e})=>{const r=oe(s=>s.gameMenus.assigningInput?.action===e);return d.jsx(Sc,{className:De("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:Xm,flashingCursor:r})},mS=({className:t})=>{const e=oe(AV);return d.jsx(N,{className:De("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},gS=()=>{const t=di();return d.jsxs(d.Fragment,{children:[d.jsx(Q,{id:"preset",label:d.jsx(N,{className:`inline-block w-6 ${xe}`,children:"key/ button preset"}),valueElement:d.jsx(mS,{}),onSelect:D(Mt,"inputPreset")}),d.jsx(Q,{id:"left",label:`Left ${t?"⬅":"↖"}`,leader:d.jsx("span",{className:`${Ne} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:d.jsx(mt,{action:"left"}),onSelect:D(At,"left")}),d.jsx(Q,{id:"right",label:`Right ${t?"➡":"↘"}`,leader:d.jsx("span",{className:`${Ne} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:d.jsx(mt,{action:"right"}),onSelect:D(At,"right")}),d.jsx(Q,{id:"up",label:`Up ${t?"⬆":"↗"}`,leader:d.jsx("span",{className:`${Ne} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:d.jsx(mt,{action:"away"}),onSelect:D(At,"away")}),d.jsx(Q,{id:"down",label:`Down ${t?"⬇":"↙"}`,leader:d.jsx("span",{className:`${Ne} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:d.jsx(mt,{action:"towards"}),onSelect:D(At,"towards")}),d.jsxs("div",{className:`${xe} col-span-3`,children:[d.jsx(N,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),d.jsx(N,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),d.jsx(Q,{id:"jump",label:"Jump",leader:d.jsx("span",{className:`${Ne} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:d.jsx(mt,{action:"jump"}),onSelect:D(At,"jump")}),d.jsx(Q,{id:"carry",label:"Carry",leader:d.jsx("span",{className:`${Ne} texture-bag`}),valueElement:d.jsx(mt,{action:"carry"}),onSelect:D(At,"carry"),hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:"**carrying is heels only**. requires the bag"}),hintInline:!0}),d.jsx(Q,{id:"fire",label:d.jsx(N,{className:`inline-block w-6 ${xe}`,children:"fire dough- nuts"}),leader:d.jsx("span",{className:`${Ne} texture-doughnuts`}),hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:"**firing doughnuts is head only**. requires the hooter"}),hintInline:!0,valueElement:d.jsx(mt,{action:"fire"}),onSelect:D(At,"fire")}),d.jsx(Q,{id:"swop",label:"Swop",valueElement:d.jsx(mt,{action:"swop"}),onSelect:D(At,"swop"),hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:d.jsxs("span",{className:`${Ne} texture-blank relative overflow-hidden`,children:[d.jsx("span",{className:`${Ne} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),d.jsx("span",{className:`${Ne} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),d.jsx(Q,{id:"swopHead",label:d.jsx(N,{className:`inline-block w-6 ${xe}`,children:"Swop to head"}),valueElement:d.jsx(mt,{action:"swop.head"}),onSelect:D(At,"swop.head"),hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${Ne} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),d.jsx(Q,{id:"swopHeels",label:d.jsxs("div",{className:`w-6 ${xe}`,children:[d.jsx(N,{className:"me-1",children:"Swop to"}),d.jsx(N,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:d.jsx(mt,{action:"swop.heels"}),onSelect:D(At,"swop.heels"),hint:d.jsx(lt,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${Ne} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),d.jsx(Q,{id:"map",label:"Map",valueElement:d.jsx(mt,{action:"map"}),onSelect:D(At,"map"),leader:d.jsx("span",{className:`${Ne} texture-scroll`})}),d.jsx(Q,{id:"hold",label:"Pause",valueElement:d.jsx(mt,{action:"hold"}),onSelect:D(At,"hold")}),d.jsx(Q,{id:"toggleColourisation",label:d.jsx(N,{className:`inline-block w-6 ${xe}`,children:"toggle colour- isation"}),valueElement:d.jsx(mt,{action:"toggleColourisation"}),onSelect:D(At,"toggleColourisation")})]})},yS=()=>d.jsx(Q,{id:"controlOptions",label:"on-screen controls",valueElement:d.jsx(sr,{value:kV()}),onSelect:D(Bt,"userSettings.onScreenControls")}),xS=()=>{const t=!np();tt({action:"menu_openOrExit",handler:I.useCallback(()=>{be.dispatch(xb())},[]),disabled:t}),M1({handler:I.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&sp(be.getState())&&be.dispatch(Vb(e))},[]),disabled:t})},qS=({showAll:t})=>d.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[d.jsx(N,{className:`block mb-1 ${xe}`,children:"Detected that you are on a phone or tablet"}),d.jsx(N,{className:`block mb-1 ${xe}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),d.jsx(N,{className:`block mb-1 text-midRed zx:text-zxRed ${xe} mb-1`,onClick:t,children:"Tap here to show all settings"})]}),sf=Cc+" !gap-y-1 !sprites-normal-height",VS=()=>{xS();const[t,e]=I.useState(!Et()),r=op();return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:D(He)}),d.jsxs(Se,{tall:!0,wide:!0,className:"bg-white zx:bg-zxWhite pr-0 pl-1",children:[d.jsxs("div",{className:"flex flex-col gap-y-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+Mc,children:[Et()&&d.jsx(on,{className:"mb-1"}),d.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block",children:"control options"}),d.jsxs(Be,{className:sf,children:[d.jsx(pS,{}),d.jsx(yS,{}),r!=="4-way"&&t&&d.jsx(hS,{})]}),t?d.jsxs(d.Fragment,{children:[d.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),d.jsxs(Be,{className:sf,children:[d.jsx(gS,{}),Et()||d.jsx(Ft,{})]})]}):d.jsx(d.Fragment,{children:d.jsx(qS,{showAll:()=>e(!0)})})]}),d.jsx(oS,{})]})]})},bS=({presetName:t})=>d.jsx(Q,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:Xr[t].description,onSelect:D(bb,t)},t),wS=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:D(He)}),d.jsx(Se,{className:"bg-white pl-1",children:d.jsxs(hs.Provider,{children:[d.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),d.jsxs(Be,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[xA(Xr).map(t=>d.jsx(bS,{presetName:t},t)),d.jsx(an,{}),d.jsx(Ft,{})]}),d.jsx(ln,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),vS=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsx(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:D(He),children:d.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[d.jsxs("div",{className:"flex gap-7",children:[d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[d.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),d.jsxs("div",{className:"flex flex-col items-center me-1",children:[d.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_walking_towards_2 hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),d.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[d.jsx(N,{children:"The people salute your heroism"}),d.jsx(N,{children:"and proclaim you"})]}),d.jsx(N,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),d.jsx(Be,{className:"hidden",children:d.jsx(Ft,{})})]})})]}),_S=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),kS=({resolutionName:t})=>{const e=oe(Ei),r=is[t];return d.jsx(Q,{id:t,label:`${e===t?"* ":""}${_S(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:D(oc,t)},t)},SS=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:D(He)}),d.jsx(Se,{className:"bg-white pl-1",children:d.jsxs(hs.Provider,{children:[d.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),d.jsxs(Be,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[xA(is).map(t=>d.jsx(kS,{resolutionName:t})),d.jsx(an,{}),d.jsx(Ft,{})]}),d.jsx(ln,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),CS="/Users/jim/dev/hohjs",MS=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),s=[...t.matchAll(e)],n=[];return r.forEach((i,a)=>{n.push(i);const o=s[a];if(o)try{const[l]=o,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){n.push(l);return}const u=`${CS}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),f=h?`:${h[1]}:${h[2]}`:"",A=`vscode://file${u}${f}`;n.push(d.jsx("a",{href:A,target:"_blank",children:c.pathname},a))}catch{n.push(o[0])}}),d.jsx(I.Fragment,{children:n})},PS=`##The game crashed
Maybe:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord](https://discord.gg/XmV9QNWY)
* play [this](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,ES=({errors:t})=>{const e=oe(a=>a.gameMenus.reincarnationPoint!==void 0),[r,s]=I.useState(!1),n=D(xp),i=t.toReversed().map(({stack:a,message:o})=>`
${o}

${a}
  `).join(`
    
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
⬆⬆ CAUSE        RETHROWN IN ⬇⬇
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

`);return d.jsxs(Ge,{children:[d.jsx(Ze,{className:"loading-border"}),d.jsx(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,children:d.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[d.jsx(lt,{markdown:PS}),d.jsxs(Be,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${xe}`,children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:D(vh,"ignore")}),e&&d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:n}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:D(vh,"clearAllData")}),r?d.jsx(N,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>s(!0))})]}),d.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),d.jsx(N,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),d.jsx("pre",{className:"text-midRed zx:text-zxWhite leading-[1em] [&_a]:text-metallicBlue",children:d.jsx(MS,{children:i})})]})})]})},RE=({x:t=0,y:e=0})=>e-t,Le=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),Fe=({x:t=0,y:e=0,z:r=0})=>({x:t*ae.w,y:e*ae.d,z:r*ae.h}),BE=t=>Le(Fe(t)),Y=48,Kt=36,Ws=.55,it=Y*((1-Ws)/2),nt=Y-it,Ys=8,Gr=128,ts=t=>Math.round(t*10)/10,Pc=t=>{const e=Le(t);return`translate(${ts(e.x)},${ts(e.y)})`},W=t=>{const e=Le(t);return yt(e)},yt=t=>`${ts(t.x)},${ts(t.y)}`,$s=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return"texture-animated-head_walking_away";case"towards":return"texture-animated-head_walking_towards";case"left":return"texture-animated-head_walking_left";case"right":return"texture-animated-head_walking_right";case"awayRight":return"texture-animated-head_walking_awayRight";case"towardsRight":return"texture-animated-head_walking_towardsRight";case"towardsLeft":return"texture-animated-head_walking_towardsLeft";case"awayLeft":return"texture-animated-head_walking_awayLeft";default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return"texture-animated-head_idle_towards";case"right":return"texture-animated-head_idle_right";case"awayRight":return"texture-animated-head_idle_awayRight";case"towardsRight":return"texture-animated-head_idle_towardsRight";case"towardsLeft":return"texture-animated-head_idle_towardsLeft";case"away":return"texture-head_walking_away_2";case"left":return"texture-head_walking_left_2";case"awayLeft":return"texture-head_walking_awayLeft_2";default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return"texture-animated-heels_walking_away";case"towards":return"texture-animated-heels_walking_towards";case"left":return"texture-animated-heels_walking_left";case"right":return"texture-animated-heels_walking_right";case"awayRight":return"texture-animated-heels_walking_awayRight";case"towardsRight":return"texture-animated-heels_walking_towardsRight";case"towardsLeft":return"texture-animated-heels_walking_towardsLeft";case"awayLeft":return"texture-animated-heels_walking_awayLeft";default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return"texture-heels_walking_towards_2";case"right":return"texture-heels_walking_right_2";case"awayRight":return"texture-heels_walking_awayRight_2";case"towardsRight":return"texture-heels_walking_towardsRight_2";case"towardsLeft":return"texture-heels_walking_towardsLeft_2";case"away":return"texture-heels_walking_away_2";case"left":return"texture-heels_walking_left_2";case"awayLeft":return"texture-heels_walking_awayLeft_2";default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},TS=()=>{const t=I.useRef(null);return I.useLayoutEffect(()=>{t.current?.scrollIntoView({behavior:"instant",block:"center"})}),d.jsx("div",{ref:t})},Zn=({className:t,scrollTo:e=!1,onClick:r,yAdjust:s=0})=>d.jsxs("foreignObject",{x:-50,y:-100+s,width:100,height:100,className:t,children:[d.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r}),e&&d.jsx(TS,{})]}),Ps=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:s=!1,yAdjust:n=0,onClick:i})=>d.jsx(Zn,{className:`${s?"[--scale:2.5]":"[--scale:1.5]"}
                ${$s({character:t,action:r?"walking":"idle",facingXy8:nA(e)??"towards"})}`,scrollTo:r,yAdjust:n,onClick:a=>{i?.(t),a.preventDefault(),a.stopPropagation()}}),IS=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return d.jsxs(d.Fragment,{children:[d.jsx(Zn,{className:`${r} texture-lift_static`}),d.jsx(Zn,{className:`${r} texture-lift_2`})]});const s=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return d.jsx(Zn,{className:`${r} ${s}`})},RS=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],BS=({x:t,y:e},{x:r,y:s})=>(t-r)**2+(e-s)**2,jS=(t,e)=>{const r=t%3,s=Math.floor(t/3),n=e%3,i=Math.floor(e/3);return Math.abs(r-n)<=1&&Math.abs(s-i)<=1&&t!==e},nf=t=>t.some((e,r)=>t.slice(r+1).some(s=>jS(e,s))),zs=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...s]=t;return[...zs(s,e),...zs(s,e-1).map(n=>[r,...n])]},Qm=t=>t.length<=1?[t]:t.flatMap((e,r)=>Qm([...t.slice(0,r),...t.slice(r+1)]).map(s=>[e,...s])),af={1:zs([...Array(9).keys()],1),2:zs([...Array(9).keys()],2).filter(t=>!nf(t)),3:zs([...Array(9).keys()],3).filter(t=>!nf(t))},vl=3,Km=({items:t,itemNormalisedPosition:e})=>{const r=tn(t),s=r.length;if(s===0)return ue;if(s>vl)throw new Error(`roomItemPositions supports up to ${vl} items, but got ${s}: ${Object.keys(t).join(", ")}`);const n=r.map(([o,l])=>({id:o,pos:e(l)}));let i=ue,a=1/0;if(af[s]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${s}`);for(const o of af[s]){const l=o.map(c=>RS[c]);for(const c of Qm(l)){const u={};let h=0;for(let f=0;f<s;f++){const{id:A,pos:m}=n[f],g=c[f];u[A]=g,h+=BS(m,g)}h<a&&(a=h,i=u)}}return i},zS={x:1,y:1,z:1},of=t=>ee(t.state.position,Js(t.aabb,.5)),jE=t=>t,NS=t=>Tr(t.items),FS=t=>jl(t),OS=t=>Ce(NS(t)),zE=(t,...e)=>{const r=Ce(FS(t));return e.length===0?r:r.filter(([,s])=>e.includes(s.type))},LS={edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},NE=t=>Cr(t.items).filter(fi).reduce((e,{config:{naturalFootprint:r},state:{position:s},renderAabb:n,renderAabbOffset:i,aabb:a})=>{const o=Le(ee(r.position,{x:r.aabb.x,z:r.aabb.z})).x,l=Le(ee(r.position,{y:r.aabb.y,z:r.aabb.z})).x,c=Le(ee(r.position,r.aabb)).y,u=Le(ee(s,i??pe,{z:(n??a).z})).y;return{edgeLeftX:Math.min(e.edgeLeftX,o),edgeRightX:Math.max(e.edgeRightX,l),topEdgeY:Math.min(e.topEdgeY,c),bottomEdgeY:Math.max(e.bottomEdgeY,u)}},LS),DS={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},Zm=t=>{const e=OS(t).filter(r=>r.type==="floor").reduce((r,s)=>{const{position:n,config:{times:i}}=s;return{from:{x:Math.min(r.from.x,n.x),y:Math.min(r.from.y,n.y),z:Math.min(r.from.z,n.z)},to:{x:Math.max(r.to.x,n.x+i.x),y:Math.max(r.to.y,n.y+i.y),z:Math.max(r.to.z,n.z)}}},DS);if(isFinite(e.from.x))return e},lf=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),Jm=({items:t,positions:e,ItemComponent:r})=>d.jsx("g",{"data-class":"items",children:tn(e).sort(([s,n],[i,a])=>a.y-n.y+(a.x-n.x)).map(([s,n])=>d.jsx("g",{"data-position":JSON.stringify(n),transform:`${Pc(El(n,Y*.5))} translate(0,-3)`,children:d.jsx(r,{item:t[s]})},s))}),HS=(t,e)=>{if(t==="*"){const r=Zm(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},GS=({items:t,roomJson:e,subRoomId:r})=>{const s=I.useMemo(()=>Km({items:t,itemNormalisedPosition:i=>{const a={...i.config.times??ue,...zS},o=ar(i.position,Js(a,.5)),l=HS(r,e);return{x:(o.x-l.from.x)/(l.to.x-l.from.x),y:(o.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return d.jsx(Jm,{ItemComponent:IS,items:t,positions:s})},US=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:s,onClick:n})=>{const i=I.useMemo(()=>({item:{type:l,state:{facing:c}}})=>d.jsx(Ps,{characterName:l,facing:c,isCurrent:s===l,onlyPlayableInRoom:!1,onClick:n}),[s,n]),a=I.useMemo(()=>({head:t,heels:e}),[t,e]),o=I.useMemo(()=>Km({items:a,itemNormalisedPosition:c=>{const u=of(c),h=Kg(of(c),{x:1/ae.w,y:1/ae.d,z:1}),f=Zm(r);if(f===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:lf(h.x,f.from.x,f.to.x),y:lf(u.y,f.from.y,f.to.y)}}}),[a,r]);return d.jsx(Jm,{ItemComponent:i,items:a,positions:o})},nr={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},WS=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.lightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},Tt=t=>({x:(t.x??0)*Y,y:(t.y??0)*Y,z:(t.z??0)*Kt}),eg=.15,Fn=Le(Tt({x:.5,y:.5,z:0})),cf=Le(Tt({x:eg,y:0,z:0})),uf=Le(Tt({x:eg*1.66,y:0,z:0})),YS=({className:t})=>d.jsxs(d.Fragment,{children:[d.jsx("ellipse",{className:"fill-white",cx:Fn.x,cy:Fn.y,rx:Math.abs(uf.x),ry:Math.abs(uf.y)}),d.jsx("ellipse",{className:t,cx:Fn.x,cy:Fn.y,rx:Math.abs(cf.x),ry:Math.abs(cf.y)})]}),tg=(t,e,r)=>{if(e==="*")return!0;const s=r.meta.subRooms[e];return t.x>=s.physicalPosition.from.x&&t.y>=s.physicalPosition.from.y&&t.x<=s.physicalPosition.to.x&&t.y<=s.physicalPosition.to.y},rg=({position:t},e,r)=>tg(t,e,r),$S=({state:{position:t}},e,r)=>{const s={x:t.x/ae.w,y:t.y/ae.d};return tg(s,e,r)},sg=(t,e)=>{const r=e.meta?.subRooms;if(r===void 0)return"*";const s=Ce(Nl(r)).find(n=>$S(t,n,e));if(s===void 0)throw new Error(`${t.id} not found in any subroom of ${e.id} ${JSON.stringify(t.state.position)} ${JSON.stringify(e.meta?.subRooms)}`);return s},XS=(t,e,r)=>rg(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),QS=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const s=Object.groupBy(r,i=>i[1].type),n=ix(e,ex(...Tr(s)));return Object.fromEntries(n)},KS=(t,e,r)=>I.useMemo(()=>{let s=!1,n=!1;const i=Ce(tn(t.items)).filter(([a,o])=>!e[a]).filter(([a,o])=>{if(o.type==="hushPuppy"){if(s)return!1;s=!0}if(o.type==="pickup"&&o.config.gives==="crown"){if(n)return!1;n=!0}return!0}).filter(a=>XS(a[1],r,t));return QS(as(i),vl)},[t,e,r]),Ct=3,hf=sA(Le({x:Y,y:0})),On={wall:void 0,open:"0,999",doorway:`${ts(hf*((1-Ws)/2)-Ct/2)}, ${ts(hf*Ws+Ct)}, 999`},df=`
M ${W({})}
L ${W({y:Y})}
L ${W({x:Y,y:Y})}
L ${W({x:Y})}
z`,Ln=(t,e=Ws)=>{const r=Y*((1-e)/2),s=Y-r,n=t.away!=="wall",i=t.towards!=="wall",a=t.left!=="wall",o=t.right!=="wall";let l=`M${W({x:r,y:r})}`;return o&&(l+=`L${W({x:0,y:r})} L${W({x:0,y:s})}`),l+=`L${W({x:r,y:s})}`,n&&(l+=`L${W({x:r,y:Y})} L${W({x:s,y:Y})}`),l+=`L${W({x:s,y:s})}`,a&&(l+=`L${W({x:Y,y:s})} L${W({x:Y,y:r})}`),l+=`L${W({x:s,y:r})}`,i&&(l+=`L${W({x:s,y:0})} L${W({x:r,y:0})}`),l+="z",l},Vo=4,ZS=Ce(AA(Vo)).map(t=>`
M${W({x:Y*((t+.5)/Vo),y:0})}
L${W({x:Y*((t+.5)/Vo),y:Y})}`).toArray().join(""),ff=t=>{const e=`
M${W({x:0,y:Y})}
L${W({x:0,y:Y,z:Kt})}
L${W({x:Y,y:Y,z:Kt})}
L${W({x:Y,y:Y})}
z
`;return t?e+`
M${W({x:it,y:Y})}
L${W({x:it,y:Y,z:Kt})}
L${W({x:nt,y:Y,z:Kt})}
L${W({x:nt,y:Y})}
L${W({x:it,y:Y})}`:e},JS=`            
M${W({x:Y,y:Y,z:Kt})}            
L${W({x:Y,y:Y})}            
M${W({x:Y,y:0,z:Kt})}            
L${W({x:Y,y:0})}            
M${W({x:0,y:Y,z:Kt})}            
L${W({x:0,y:Y})}            
`,eC=`            
M${W({x:0,y:0,z:Kt})}            
L0, 0            
`,tC=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:s,roomVisited:n,headItemInRoom:i,heelsItemInRoom:a,headOverHeelsItemInRoom:o,currentCharacterName:l,onPlayableClick:c})=>{const{id:u,roomAbove:h,color:f,items:A}=s,m=s.meta?.label,g=KS(s,r,e),p=Object.values(A).filter(b=>b.type==="floor"),q=p.length===0,x=p.some(b=>b.config.floorType==="deadly");return d.jsxs("g",{"data-room-id":u,strokeWidth:Ct,className:WS(f),children:[q?d.jsxs(d.Fragment,{children:["//show a floor outlining the room with a hole:",d.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${df} ${Ln(t)}`}),d.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${Ln(t)} ${Ln(t,Ws*.7)}`})]}):d.jsxs(d.Fragment,{children:["// whole floor in colour",d.jsx("path",{className:"fill-[var(--roomHintColor)]",d:df}),d.jsx("path",{className:"fill-white",d:Ln(t)}),x&&d.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:ZS})]}),s.id==="blacktooth11"?d.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${W({x:it,y:it})}
L${W({x:nt,y:it})}
L${W({x:nt,y:it-Ct*2})}
L${W({x:it,y:it-Ct*2})}
z
M${W({x:it,y:nt})}
L${W({x:nt,y:nt})}
L${W({x:nt,y:nt+Ct*2})}
L${W({x:it,y:nt+Ct*2})}
z
`}):s.id==="moonbase20"||s.id==="moonbase23"?d.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Ct*2,d:`
M${W({x:it,y:Y/2})}
L${W({x:nt,y:Y/2})}

M${W({x:Y/2,y:it})}
L${W({x:nt,y:Y/2})}

M${W({x:Y/2,y:nt})}
L${W({x:nt,y:Y/2})}
`}):s.id==="blacktooth77"||s.id==="safari26"?d.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${W({x:Y/2-Ct,y:0})}
L${W({x:Y/2+Ct,y:0})}
L${W({x:Y/2+Ct,y:Y})}
L${W({x:Y/2-Ct,y:Y})}
z
`}):null,h&&d.jsxs(d.Fragment,{children:[d.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:ff(t.away==="doorway")}),d.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:ff(t.left==="doorway")})]}),d.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[d.jsx("path",{d:`M${W({x:0,y:Y})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:On[t.right]}),d.jsx("path",{d:`M${W({x:Y,y:0})} L${W({x:Y,y:Y})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:On[t.left]}),d.jsx("path",{d:`M${W({x:Y,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:On[t.towards]}),d.jsx("path",{d:`M${W({x:0,y:Y})} L${W({x:Y,y:Y})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:On[t.away]})]}),n&&d.jsx(YS,{className:"fill-[var(--roomHintColor)]"}),h&&d.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:JS}),i&&a?d.jsx(US,{roomJson:s,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:a,onClick:c}):i?d.jsx(Ps,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):a?d.jsx(Ps,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:a.state.facing,yAdjust:-8,onClick:c}):o?d.jsxs(d.Fragment,{children:[d.jsx(Ps,{characterName:"heels",onlyPlayableInRoom:!1,facing:o.state.facing,yAdjust:-16,isCurrent:!0}),d.jsx(Ps,{characterName:"head",onlyPlayableInRoom:!1,facing:o.state.facing,isCurrent:!0,yAdjust:-36})]}):d.jsx(GS,{roomJson:s,subRoomId:e,items:g}),h&&d.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:eC}),m&&d.jsx("g",{transform:Pc(Tt(ar(m.gridOffset,{x:.5,y:.5}))),children:d.jsx("foreignObject",{width:m.text.length*16,height:16,y:-8,x:m.align==="left"?0:m.text.length*-16,children:d.jsx(N,{noTint:!0,className:"[--scale:2] [--block:16px]",children:m.text})})})]})},bo=(t,e,r,s)=>{const n=sl(e,t[e]?.items);return n&&r===t[e].roomJson.id&&s===sg(n,t[e].roomJson)?n:void 0},rC=({campaign:t,pickupsCollected:e,gridPositions:r,currentCharacterName:s,characterRooms:n,background:i,mapBounds:a,containerWidth:o,roomsExplored:l,onPlayableClick:c})=>{const u=a.r-a.l+2*Ys,h=a.b-a.t+2*Gr,f=Object.values(r);return d.jsxs("svg",{className:"w-full",style:{minWidth:`${u}px`,height:`${h}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[i,d.jsx("g",{transform:`translate(${-a.l+Ys+(o-u)/2},${-a.t+128})`,children:f.map(A=>{const{roomId:m,subRoomId:g,gridPosition:p}=A,q=`${m}/${g}`;return d.jsx("g",{"data-id":q,transform:Pc(Tt(p)),children:d.jsx(tC,{roomGridPositionSpec:A,roomPickupsCollected:e[m]??ue,roomJson:t.rooms[m],headItemInRoom:bo(n,"head",m,g),heelsItemInRoom:bo(n,"heels",m,g),headOverHeelsItemInRoom:bo(n,"headOverHeels",m,g),currentCharacterName:s,roomVisited:l[m]??!1,onPlayableClick:c})},q)})})]})},ng=Ee("head"),ig=Ee("heels"),xi=Ee("headOverHeels"),tr=(t,e)=>t.characterRooms[e]?.items[e],FE=t=>tr(t,t.currentCharacterName),OE=t=>{if(ng(t))return t.state;if(xi(t))return t.state.head},LE=t=>{if(ig(t))return t.state;if(xi(t))return t.state.heels},sC=(t,e)=>{const r=tr(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&ng(r)||e==="heels"&&ig(r))return r.state;if(e==="head"&&xi(r))return r.state.head;if(e==="heels"&&xi(r))return r.state.heels}},DE=sC,Je={x:12,y:12,z:ae.h},nC={x:14,y:14,z:ae.h},br={x:16,y:16,z:ae.h},Jn={...Je,z:ae.h*2},ag=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:Je};case"slidingBlock":return t.config.style==="book"?{aabb:br}:{aabb:Je};case"lift":return{aabb:{...Je,z:Je.z}};case"switch":return{aabb:{...Je,z:Je.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:Je};case"charles":return{aabb:Jn};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:br};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:br};case"tower":return{aabb:{x:11,y:11,z:ae.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...Je,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:Jn};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:Je};case"turtle":return{aabb:Je};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:br};case"bubbles":return{aabb:Je};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:br};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:ae.h}:{x:15,y:3,z:ae.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:Jn}:{aabb:Je};case"emitter":return{aabb:pe};default:return{aabb:nC}}},ot={aabb:Je},iC=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,Te=en/1e3,HE={head:15e-5,heels:15e-5},GE=1e3/110,UE=240,aC=2e-4,oC={head:ae.h*2/1e3,others:ae.h*6/1e3},WE=aC*.35,YE=oC.others*.5,$E=.8,XE=.001,lC={head:Te,heels:2*Te,charles:Te,dalek:Math.SQRT2*Te,bubbleRobot:(Math.SQRT2+1)/2*Te,cyberman:1*Te,skiHead:Te,helicopterBug:Te,homingBot:2*Te,monkey:Te,elephant:Te,elephantHead:0,emperor:Te,emperorsGuardian:Math.SQRT2*Te,computerBot:Te,turtle:Te,ball:2*Te,firedDoughnut:2*Te,movingPlatform:Te,floatingText:Te},cC=(t=1)=>t*en/1e3,QE=cC(),KE=2,Af=1.1,ZE={head:ae.h*2.6+Af,heels:ae.h+Af},Fi=10,JE=6e4,uC=8,eT=750,tT=2500,rT=200,sT=.15,nT=8,hC=xt.h-xt.w/2,og=hC+2,_l=t=>{const e=Fe(t.position),{aabb:r}=ag(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:ee(e,{x:ae.w-r.x>>1,y:ae.d-r.y>>1})},Re=Number.MIN_SAFE_INTEGER,We=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Re,stoodOnUntilRoomTime:Re}),Xs=()=>({standingOnItemId:null,vels:{gravity:pe,movingFloor:pe},latentMovement:[],actedOnAt:{roomTime:Re,by:ue},collidedWith:{roomTime:Re,by:ue}}),dC=t=>{const e=up.includes(t.type);return{...We(),position:_l(t),...e?{standingOnItemId:null,vels:{gravity:pe,movingFloor:pe,...lp.includes(t.type)?{sliding:pe}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:pe}:{}},latentMovement:[],actedOnAt:{roomTime:Re,by:ue},collidedWith:{roomTime:Re,by:ue}}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:ge[t.config.startDirection]}:{facing:ge.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:ge[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:pe}}:{},...t.type==="charles"?{facing:ge.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Re,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?Js(ge[t.config.direction],lC.firedDoughnut):pe}}:{}}},wo=ae.h*2,lg=4,Dn=ae.h*lg,fC=2;function*AC(t,e){const{config:{direction:r},position:s}=t,n=tA(r),i=Pl(n),a=iC(t),o={...pe,[i]:a?-.5:0},l=1,c={[i]:a?-1:0},u=l*ae.w,h={...pe,[i]:u},f=9,A=8,m=8;{const g={[n]:A,[i]:m,z:Dn};yield{...t,...ot,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:a,part:"far"},state:{...We(),position:Fe(ee(s,{[n]:1.5},o,c)),stoodOnBy:ue},aabb:ee(g,h),renderAabb:g,renderAabbOffset:a?h:void 0}}{const g={[n]:f,[i]:m,z:Dn};yield{...t,...ot,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:a,part:"near"},state:{...We(),position:Fe(ee(s,o,c)),stoodOnBy:ue},aabb:ee(g,h),renderAabb:g,renderAabbOffset:a?h:void 0}}{const g={[n]:2*ae.w-f-A,[i]:m,z:Dn-wo};yield{...t,...ot,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:a,part:"top"},state:{...We(),position:ee(Fe(ee(s,o,c)),{[n]:f,z:wo}),stoodOnBy:ue},aabb:ee(g,h),renderAabb:g,renderAabbOffset:a?h:void 0}}yield{...t,...ot,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...We(),position:ee(Fe(ee(s,o,c)),{z:Dn}),stoodOnBy:ue},aabb:ee(Fe({[n]:2,[i]:l,z:Fi-lg-s.z}),{[i]:m}),renderAabb:pe,fixedZIndex:or},yield{...t,...ot,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Os(t.config,"toRoom","toDoor"),inHidden:a,relativePoint:Fe({...pe,[i]:a?l+.25:-.25}),direction:ge[r]},fixedZIndex:or,state:{...We(),position:ee(Fe(ee(s,{[i]:a?-.5-l:.5})),{[n]:f}),stoodOnBy:ue},aabb:{[n]:fC*ae.w-f-A,[i]:u,z:wo}},s.z!==0&&(yield{...t,...ot,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:a,style:"none",side:"away",height:s.z},renders:!0,shadowCastTexture:a?{textureId:"shadow.door.floatingThreshold.double.y",flipX:n==="x"}:void 0,state:{...We(),position:{...Fe(ee(s,o,c)),z:0}},aabb:ee(Fe({[n]:2,[i]:.5,z:s.z}),h),renderAabb:a?ee(Fe({[n]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:a?ee({[n]:0,[i]:0,z:(s.z-.5)*ae.h},{[i]:h[i]}):void 0,shadowOffset:{z:s.z*ae.h,[i]:a?h[i]:void 0}}),yield{type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:Fe({[n]:2,[i]:0,z:2}),config:{},fixedZIndex:or,state:{...We(),position:Fe(ti(s,Js(ge[r],.75))),stoodOnBy:ue}}}const qi={config:ue,shadowCastTexture:"shadow.smallRound",aabb:Je},Qs=()=>{const t=ip(be.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:ge.towards,walkStartFacing:ge.towards,walkDistance:0,vels:{walking:pe,gravity:pe,movingFloor:pe},switchedToAt:Re,lastDiedAt:Re,gameTime:0,jumpStartTime:Re,lives:t?"infinite":uC,jumpStartZ:0}},pC=(t,e)=>{const r=ap(be.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...ot,...qi,state:{...We(),...Xs(),...Qs(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Re,shieldCollectedAt:Re,doughnuts:r?"infinite":0,position:_l(t),stoodOnUntilRoomTime:Re}}:{id:e,jsonItemId:e,type:"heels",...ot,...qi,state:{...We(),...Xs(),...Qs(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Re,position:_l(t),stoodOnUntilRoomTime:Re}}},mC=t=>t==="towards"||t==="right",Ec=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),iT=t=>t.type==="wall"?Ec(t.config):UV(t)?t.config.times:void 0,kl=(t=Tl)=>({x:t.x??1,y:t.y??1,z:t.z??1}),aT=t=>({x:t.x??1,y:t.y??1}),oT=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?kl(Ec(t.config)):e(t)?kl(t.config.times):Tl},lT=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},Ks=(t,e={})=>{const r=kl(e),s=ti(gh,t);return ti(Qg(r,gh),s)},cg=1,gC=(t=Fi)=>({x:ae.w,y:ae.d*cg,z:t*ae.h}),yC={x:ae.w,y:0,z:og},xC=(t=Fi)=>({x:ae.w*cg,y:ae.d,z:t*ae.h}),qC={x:0,y:ae.d,z:og},VC=(t,e,r)=>{const{config:{direction:s},position:n}=e,i=Ec(e.config),{height:a}=r,o=tA(s),l=Pl(o),c=mC(s),u={...pe,[l]:c?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Ks(o==="y"?xC(a):gC(a),i),renderAabb:c?pe:Ks(o==="y"?qC:yC,i),fixedZIndex:c?or:void 0,state:{...We(),position:Fe(ee(n,u)),stoodOnBy:ue},shadowCastTexture:o==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0}}},bC=3,pf=10,mf=.52,gf=.5,wC=(t,e,r)=>{const{config:{times:s},position:n}=e,i=ee(n,{z:-3}),a={...s,z:bC};let o=i,l=a;const c=Ce(Tr(r.items)).filter(f=>f.type==="door");if(n.z===0){const f={};for(const A of c){const{position:m,config:{direction:g}}=A;switch(g){case"towards":!f.towards&&m.y===i.y&&(l=ee(l,{y:gf}),o=ee(o,{y:-.5}),f.towards=!0);break;case"away":!f.away&&m.y===i.y+s.y&&(l=ee(l,{y:mf}),f.away=!0);break;case"right":!f.right&&m.x===i.x&&(l=ee(l,{x:gf}),o=ee(o,{x:-.5}),f.right=!0);break;case"left":!f.left&&m.x===i.x+s.x&&(l=ee(l,{x:mf}),f.left=!0);break}}}const u=Fe(o),h=Ks(br,l);return{type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Ks(br,a),position:Fe(i)}},aabb:h,renderAabb:{...h,z:pf},renderAabbOffset:{...pe,z:h.z-pf},shadowCastTexture:"shadow.fullBlock",state:{...We(),position:u}}};function*ug(t,e,r,s=ue,n={}){if(!s[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&n[e.config.page]))switch(e.type){case"door":return yield*AC(e,t);case"player":{yield pC(e,t);return}case"wall":{yield VC(t,e,r);return}case"floor":{yield wC(t,e,r);return}case"sceneryCrown":if(!be.getState().gameMenus.planetsLiberated[e.config.planet])return;default:{const i=ag(e),a=e.config.times!==void 0?{aabb:Ks(i.aabb,e.config.times),renderAabb:void 0}:i;let o;try{o=dC(e)}catch(l){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:l})}yield{...e,...ot,...a,id:t,jsonItemId:t,fixedZIndex:e.type==="emitter"?or:void 0,shadowCastTexture:vC(e),config:e.config,state:o}}}}const vC=t=>{switch(t.type){case"lift":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:eA(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};let _C=0;const cT=({gameState:t,room:e,itemType:r,config:s,position:n})=>{const i={type:r,config:s,position:pe},a=`${r}/${_C++}`,o=Hy(ug(a,i,e.roomJson,t.pickupsCollected[e.id]??ue));if(o===void 0)throw console.error("failed to generate any items for json",a,i),new Error("failed to generate any items");return o.state.position=n,Vi({room:e,item:o}),o},Vi=({room:t,item:e})=>(t.items[e.id]=e,e),hg=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0},kC=t=>{const e=tr(t,"head"),r=tr(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},SC=t=>{const e={id:"head",type:"head",...ot,...qi,state:{...We(),...Xs(),...Qs(),...t.state.head,facing:t.state.facing,position:ee(t.state.position,{z:ae.h}),switchedToAt:Re,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...ot,...qi,state:{...We(),...Xs(),...Qs(),...t.state.heels,facing:t.state.facing,position:ee(t.state.position),switchedToAt:Re,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},CC=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...ot,shadowCastTexture:e.shadowCastTexture,config:ue,aabb:Jn,state:{...We(),...Xs(),...Qs(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...Os(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Re},heels:{...Os(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Re}}}),MC=t=>{const e=t.characterRooms.head,r=tr(t,"head"),s=tr(t,"heels"),n=CC({head:r,heels:s});Ai({room:e,item:"head"}),Ai({room:e,item:"heels"}),Vi({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},PC=(t,e)=>{const r=t.characterRooms.headOverHeels,s=tr(t,"headOverHeels"),n=e??Jo(t.previousPlayable),{head:i,heels:a}=SC(s);Ai({room:r,item:"headOverHeels"}),Vi({room:r,item:i}),Vi({room:r,item:a}),hg({above:i,below:a}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},EC=t=>{const e=tr(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},ei=(t,e)=>{kC(t)&&(!e||e===t.currentCharacterName)?MC(t):t.currentCharacterName==="headOverHeels"?PC(t,e):(!e||e!==t.currentCharacterName)&&tr(t,Jo(t.currentCharacterName))!==void 0&&(t.currentCharacterName=Jo(t.currentCharacterName)),EC(t)},TC=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(ei(t),!0):e.currentActionPress("swop.head")==="tap"?(ei(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(ei(t,"heels"),!0):!1},dg=()=>{const t=Br(),[e,r]=I.useState(t.gameState.currentCharacterName);return I.useEffect(()=>{const s=()=>{r(t.gameState.currentCharacterName)};return ct.shared.add(s),()=>{ct.shared.remove(s)}},[t.gameState]),e},IC=()=>{const t=Br();I.useEffect(()=>{const e=()=>{TC(t.gameState)};return ct.shared.add(e),()=>{ct.shared.remove(e)}},[t.gameState])},wr=({mapTitle:t,y:e=0,className:r,textOnly:s=!1})=>{const n=rn();return d.jsxs("g",{className:r,children:[s||d.jsx("rect",{y:e,width:1e4,height:1e4}),d.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:Ys,y:e+16,children:d.jsx(N,{className:`left-2 relative sprites-double-height ${xe}`,children:t})})]})},RC=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const s=rn(),n=e.r-e.l+2*Ys,i={x:-e.l+Ys+(r-n)/2,y:-e.t+Gr},a=(b,k=pe)=>ar(i,Le(Tt(ee(t[b].gridPosition,k)))),o=a("blacktooth44market/*",{x:1,z:1.5}),l=a("blacktooth44market/*",{x:1}),c=a("blacktooth45market/*"),u=a("blacktooth48market/*",{y:1}),h=a("blacktooth53market/*",{x:0,y:0,z:0}),f=a("blacktooth53market/*",{x:0,y:1,z:0}),A=a("blacktooth53market/*",{x:1,y:1,z:0}),m=a("blacktooth52market/*",{x:1,y:.5,z:0}),g=s*8*2,p="Market",q=(p.length+3)*s*8,x=s*8*2+32;return d.jsxs(d.Fragment,{children:[d.jsx("path",{className:`${nr.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${yt({x:g,y:m.y+x})}
L ${yt({x:q,y:m.y+x})}
L ${yt({x:q,y:o.y})}
L ${yt(o)}
L ${yt(l)}
L ${yt(c)}
L ${yt(u)}
L ${yt(h)}
L ${yt(f)}
L ${yt(A)}
L ${yt(m)}
L ${yt({...m,x:g})}
z`}),d.jsx(wr,{y:m.y,mapTitle:p,className:nr.market.bgClassName,textOnly:!0})]})},BC=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const s=t,n=Le(Tt({x:1,y:1,z:0})).y,i=(a,o)=>{if(s[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);if(s[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);const l=Le(Tt(s[a].gridPosition)).y,c=Le(Tt(s[o].gridPosition)).y+n;return(l+c)/2};return d.jsxs(d.Fragment,{children:[d.jsx(wr,{y:0,mapTitle:"Freedom",className:nr.freedom.bgClassName}),d.jsx(wr,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+Gr,mapTitle:"Castle Blacktooth",className:nr.blacktooth.bgClassName}),d.jsx(wr,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+Gr,mapTitle:"moonbase",className:nr.moonbase.bgClassName}),d.jsx(wr,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+Gr,mapTitle:"Blacktooth escape",className:nr.blacktooth.bgClassName}),d.jsx(RC,{mapBounds:e,originalCampaignPositions:s,containerWidth:r}),d.jsx(wr,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+Gr,mapTitle:"Jail",className:nr.jail.bgClassName})]})},fg=()=>{const t=Br(),e=dg(),r=t.gameState.characterRooms[e];return(r&&nr[r.roomJson.planet])??{bgClassName:"fill-shadow",containerClassName:""}},jC={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},zC=t=>{const{campaign:e,curRoomId:r}=t,s=e.name==="original"&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),n=fg();return s?d.jsx(BC,{...t}):d.jsx(wr,{mapTitle:jC[e.rooms[r].planet],className:n.bgClassName})},NC=t=>t.characterRooms[t.currentCharacterName],Ag=({aabb:t,state:{position:e}},{aabb:r,state:{position:s}})=>!(e.x+t.x<=s.x||e.x>=s.x+r.x)&&!(e.y+t.y<=s.y||e.y>=s.y+r.y)&&!(e.z+t.z<=s.z||e.z>=s.z+r.z),FC=(t,e)=>[...Ce(e).filter(r=>t.id!==r.id&&Ag(t,r))];function*OC(t,e){if(t.roomBelow!==void 0)for(const r of Cr(e).filter(fi)){const{config:{naturalFootprint:s}}=r;yield{...ot,type:"portal",id:"floor/portal",fixedZIndex:or,config:{toRoom:t.roomBelow,relativePoint:{x:s.aabb.x/2,y:s.aabb.y/2,z:s.aabb.z},direction:ge.down},aabb:s.aabb,state:{...We(),position:s.position},renders:!1}}if(t.roomAbove!==void 0)for(const r of Cr(e).filter(fi)){const{config:{naturalFootprint:s}}=r;yield{...ot,type:"portal",id:"ceilingPortal",fixedZIndex:or,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?Fe(t.ceilingRelativePoint):{x:s.aabb.x/2,y:s.aabb.y/2},z:-12},direction:ge.up},aabb:{...s.aabb,z:ae.h},state:{...We(),position:ee(s.position,{z:s.aabb.z},{z:ae.h*(t.height??Fi)})}}}}const LC=(t,e,r,s)=>{const n=Math.max(0,Math.min(t.x+e.x,r.x+s.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+s.y)-Math.max(t.y,r.y));return n*i},yf=({state:{position:t},aabb:e},{state:{position:r},aabb:s})=>LC(t,e,r,s),xf=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),qf={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},pg=(t,e)=>qf[t.type]-qf[e.type],uT=(t,e)=>e.toSorted((r,s)=>{const n=pg(r,s);if(n!==0)return n;const i=Oo(t,xf(t,r)),a=Oo(t,xf(t,s));return Math.abs(i-a)<1e-4?r.id<s.id?-1:1:i-a}),DC=(t,e,r=.001)=>{if(!el(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:s}}}}=t;return s>0?!1:Ag({state:{position:ee(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+Es},id:t.id},{state:{position:ee(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},HC=(t,e)=>{const s=[...Ce(e).filter(i=>DC(t,i))];return s.length===0?void 0:s.reduce((i,a)=>{const o=pg(a,i);return o<0||o===0&&yf(t,a)>yf(t,i)?a:i})};function*GC(t,e,r,s){const n=tn(t.items);for(const[i,a]of n)a.type==="player"&&!s||(yield*ug(i,a,t,e,r))}const Vf=t=>Ce(t).reduce((e,r)=>({...e,[r.id]:r}),{}),bf=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:s=!1})=>{const n=Vf(GC(t,e,r,s)),i={...Vf(OC(t,n)),...n};for(const o of Cr(i)){const c=FC(o,qp(i)).find(u=>el(o)&&el(u)&&!(o.type==="wall"&&u.type==="wall"));c!==void 0&&console.error(`in room ${t.id} item ${o.id} @${JSON.stringify(o.state.position)} #${JSON.stringify(o.aabb)} is colliding with (solid item) ${c.id} @${JSON.stringify(c.state.position)} #${JSON.stringify(c.aabb)} on loading room ${t.id}`)}for(const o of Cr(i).filter(Jl)){const l=HC(o,Cr(i).filter(c=>c.id!==o.id));l!==void 0&&hg({above:o,below:l})}return{...t,roomJson:t,items:i,roomTime:0}},wf=({state:{position:t,facing:e,autoWalk:r,action:s,vels:n}})=>({position:t,facing:e,autoWalk:r,action:s,vels:{...n}}),mg=(t,e)=>{if(e)return qA(e.gameState.characterRooms,([s,n])=>[s,n.id]);const r={};for(const s of Object.values(t.rooms))for(const n of Object.values(s.items))if(n.type==="player"){const{which:i}=n.config;r[i]=s.id}if(r.head===void 0&&r.heels===void 0)throw new Error("couldn't find either head or heels in campaign");return r},hT=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:s={}})=>{const n=mg(t,r),i={},a=r?r.gameState.characterRooms.head&&vs(r.gameState.characterRooms.head):n.head&&bf({roomJson:t.rooms[n.head],roomPickupsCollected:ue,scrollsRead:ue,isNewGame:!0}),o=n.heels===n.head?a:r?r.gameState.characterRooms.heels&&vs(r.gameState.characterRooms.heels):n.heels&&bf({roomJson:t.rooms[n.heels],roomPickupsCollected:ue,scrollsRead:ue,isNewGame:!0}),l=r?.gameState.characterRooms.headOverHeels&&vs(r.gameState.characterRooms.headOverHeels),c={head:a,heels:o,headOverHeels:l};return Object.assign(s,{inputStateTracker:e,campaign:t,gameSpeed:1,...r?vs(r?.gameState):{currentCharacterName:n.head===void 0||Ti().get("playAsHeels")==="1"?"heels":"head",entryState:{head:a===void 0?void 0:wf(sl("head",a?.items)),heels:o===void 0?void 0:wf(sl("heels",o?.items))},pickupsCollected:i,gameTime:0,progression:0},characterRooms:c})},UC=Le(Tt({x:1,y:1,z:1})).y,vf=Le(Tt({x:0,y:1,z:0})).x,WC=t=>t.reduce((e,{gridPosition:r})=>{const s=Le(Tt(r));return{t:Math.min(e.t,s.y+UC),b:Math.max(e.b,s.y),l:Math.min(e.l,s.x-vf),r:Math.max(e.r,s.x+vf)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),Hn=(t,e,r,s)=>e.some(n=>n.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:n})=>Jg(ge[t],Xg(n,s)))?"open":"wall";function*Dr(t){try{yield*YC(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*YC({roomId:t,subRoomId:e="*",campaign:r,visited:s={},vectorFromPrevious:n,previousRoomGridPosition:i=pe}){if(t==="nowhere"||s[t]?.[e])return;s[t]===void 0&&(s[t]={}),s[t][e]=!0;const a=r.rooms[t];if(a===void 0)throw new Error(`no room in the campaign with id="${t}"`);const o=[...Ce(Tr(a.items)).filter(A=>A.type==="door").filter(A=>rg(A,e,a))],l=ee(i,n===void 0?ey:n),c=a.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:Hn("left",o,c,u),right:Hn("right",o,c,u),away:Hn("away",o,c,u),towards:Hn("towards",o,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[A,{gridPosition:m}]of Ce(tn(c)))A!==e&&(yield*Dr({roomId:t,subRoomId:A,campaign:r,visited:s,vectorFromPrevious:ti({...m,z:0},u),previousRoomGridPosition:l}))}if(a.roomAbove!==void 0){const{roomAbove:A,subRoomAbove:m}=a;yield*Dr({roomId:A,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:ge.up,previousRoomGridPosition:l})}if(a.roomBelow!==void 0){const{roomBelow:A,subRoomBelow:m}=a;yield*Dr({roomId:A,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:ge.down,previousRoomGridPosition:l})}for(const A of o){const{toRoom:m}=A.config;yield*Dr({roomId:m,campaign:r,visited:s,subRoomId:A.config.meta?.toSubRoom,vectorFromPrevious:ge[A.config.direction],previousRoomGridPosition:l})}const f=a.meta?.nonContiguousRelationship;if(f!==void 0){const{with:{room:A},gridOffset:m}=f;yield*Dr({roomId:A,campaign:r,visited:s,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const $C=t=>{const r=[...t].sort(({gridPosition:s},{gridPosition:n})=>s.z!==n.z?s.z-n.z:n.x+n.y-(s.x+s.y)).map(s=>[`${s.roomId}/${s.subRoomId}`,s]);return as(r)},XC=()=>{const t=dg(),{gameState:e}=Br();return I.useMemo(()=>{try{const r=NC(e),s=r?.roomJson.id??mg(e.campaign).head;let n;if(!e)n="*";else if(!r?.roomJson.meta?.subRooms)n="*";else{const l=r?.items[t];l?n=sg(l,r.roomJson):n="*"}const i=[...Dr({campaign:e.campaign,roomId:s,subRoomId:n})],a=$C(i);return{mapBounds:WC(i),curRoomId:r?.roomJson.id,gridPositions:a,currentCharacterName:t}}catch(r){throw new Error("error getting map data",{cause:r})}},[t,e])},QC=({containerWidth:t})=>{const e=Br(),r=SV(),{campaign:s}=e;IC();const{gridPositions:n,curRoomId:i,mapBounds:a,currentCharacterName:o}=XC(),{pickupsCollected:l,characterRooms:c}=e.gameState;return d.jsx(rC,{onPlayableClick:u=>ei(e.gameState,u),background:i===void 0?null:d.jsx(zC,{curRoomId:i,campaign:s,gridPositions:n,mapBounds:a,containerWidth:t}),characterRooms:c,campaign:s,mapBounds:a,pickupsCollected:l,gridPositions:n,currentCharacterName:o,curRoomId:i,containerWidth:t,roomsExplored:r})};var vo,_f;function Tc(){if(_f)return vo;_f=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return vo=t,vo}var _o,kf;function KC(){if(kf)return _o;kf=1;var t=typeof cn=="object"&&cn&&cn.Object===Object&&cn;return _o=t,_o}var ko,Sf;function gg(){if(Sf)return ko;Sf=1;var t=KC(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return ko=r,ko}var So,Cf;function ZC(){if(Cf)return So;Cf=1;var t=gg(),e=function(){return t.Date.now()};return So=e,So}var Co,Mf;function JC(){if(Mf)return Co;Mf=1;var t=/\s/;function e(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return Co=e,Co}var Mo,Pf;function eM(){if(Pf)return Mo;Pf=1;var t=JC(),e=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(e,"")}return Mo=r,Mo}var Po,Ef;function yg(){if(Ef)return Po;Ef=1;var t=gg(),e=t.Symbol;return Po=e,Po}var Eo,Tf;function tM(){if(Tf)return Eo;Tf=1;var t=yg(),e=Object.prototype,r=e.hasOwnProperty,s=e.toString,n=t?t.toStringTag:void 0;function i(a){var o=r.call(a,n),l=a[n];try{a[n]=void 0;var c=!0}catch{}var u=s.call(a);return c&&(o?a[n]=l:delete a[n]),u}return Eo=i,Eo}var To,If;function rM(){if(If)return To;If=1;var t=Object.prototype,e=t.toString;function r(s){return e.call(s)}return To=r,To}var Io,Rf;function sM(){if(Rf)return Io;Rf=1;var t=yg(),e=tM(),r=rM(),s="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function a(o){return o==null?o===void 0?n:s:i&&i in Object(o)?e(o):r(o)}return Io=a,Io}var Ro,Bf;function nM(){if(Bf)return Ro;Bf=1;function t(e){return e!=null&&typeof e=="object"}return Ro=t,Ro}var Bo,jf;function iM(){if(jf)return Bo;jf=1;var t=sM(),e=nM(),r="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&t(n)==r}return Bo=s,Bo}var jo,zf;function aM(){if(zf)return jo;zf=1;var t=eM(),e=Tc(),r=iM(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return s;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||a.test(c)?o(c.slice(2),h?2:8):n.test(c)?s:+c}return jo=l,jo}var zo,Nf;function xg(){if(Nf)return zo;Nf=1;var t=Tc(),e=ZC(),r=aM(),s="Expected a function",n=Math.max,i=Math.min;function a(o,l,c){var u,h,f,A,m,g,p=0,q=!1,x=!1,b=!0;if(typeof o!="function")throw new TypeError(s);l=r(l)||0,t(c)&&(q=!!c.leading,x="maxWait"in c,f=x?n(r(c.maxWait)||0,l):f,b="trailing"in c?!!c.trailing:b);function k(G){var $=u,le=h;return u=h=void 0,p=G,A=o.apply(le,$),A}function P(G){return p=G,m=setTimeout(z,l),q?k(G):A}function C(G){var $=G-g,le=G-p,y=l-$;return x?i(y,f-le):y}function E(G){var $=G-g,le=G-p;return g===void 0||$>=l||$<0||x&&le>=f}function z(){var G=e();if(E(G))return B(G);m=setTimeout(z,C(G))}function B(G){return m=void 0,b&&u?k(G):(u=h=void 0,A)}function R(){m!==void 0&&clearTimeout(m),p=0,u=g=h=m=void 0}function O(){return m===void 0?A:B(e())}function K(){var G=e(),$=E(G);if(u=arguments,h=this,g=G,$){if(m===void 0)return P(g);if(x)return clearTimeout(m),m=setTimeout(z,l),k(g)}return m===void 0&&(m=setTimeout(z,l)),A}return K.cancel=R,K.flush=O,K}return zo=a,zo}var oM=xg();const lM=$e(oM);var No,Ff;function cM(){if(Ff)return No;Ff=1;var t=xg(),e=Tc(),r="Expected a function";function s(n,i,a){var o=!0,l=!0;if(typeof n!="function")throw new TypeError(r);return e(a)&&(o="leading"in a?!!a.leading:o,l="trailing"in a?!!a.trailing:l),t(n,i,{leading:o,maxWait:i,trailing:l})}return No=s,No}var uM=cM();const hM=$e(uM),dM=(t,e,r,s)=>{switch(e){case"debounce":return lM(t,r,s);case"throttle":return hM(t,r,s);default:return t}},fM=t=>{const e=I.useRef(t);return I.useEffect(()=>{e.current=t}),I.useMemo(()=>(...r)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...r)},[])},AM=t=>{const[e,r]=I.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:I.useMemo(()=>new Proxy(n=>{n!==e&&r(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,a){return i==="current"?r(a):n[i]=a,!0}}),[e]),refElement:e,setRefElement:r}},pM=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function mM({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:s,handleWidth:n=!0,handleHeight:i=!0,targetRef:a,observerOptions:o,onResize:l}={}){const c=I.useRef(t),u=fM(l),[h,f]=I.useState({width:void 0,height:void 0}),{refProxy:A,refElement:m}=AM(a),{box:g}=o||{},p=I.useCallback(x=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const b=(k,P)=>n&&k.width!==P.width||i&&k.height!==P.height;x.forEach(k=>{const P=pM(k,g);f(C=>b(C,P)?(u?.({width:P.width,height:P.height,entry:k}),P):C)})},[n,i,c,g]),q=I.useCallback(dM(p,e,r,s),[p,e,r,s]);return I.useEffect(()=>{let x;return m?(x=new window.ResizeObserver(q),x.observe(m,o)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),f({width:void 0,height:void 0})),()=>{var b,k,P;(b=x?.disconnect)===null||b===void 0||b.call(x),(P=(k=q).cancel)===null||P===void 0||P.call(k)}},[q,m]),Object.assign({ref:A},h)}const gM=()=>{const{ref:t,width:e}=mM(),r=fg(),s=Hm();return d.jsx(Ge,{children:d.jsx(Se,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${r.containerClassName}`,onClick:D(He),children:d.jsx("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 h-min",ref:s,children:e!==void 0&&d.jsx(QC,{containerWidth:e})})})})},yM=()=>{const t=oe(vV),e=oe(_V);return d.jsxs(d.Fragment,{children:[d.jsx(Ze,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:D(He)}),d.jsx(Se,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:d.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+Mc,children:[Et()&&d.jsx(on,{className:"text-highlightBeige"}),d.jsx(N,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Sound Options"}),d.jsxs(Be,{className:Cc,children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"mute",label:"Mute",valueElement:d.jsx(sr,{value:t}),onSelect:D(Bt,"userSettings.soundSettings.mute")}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"footsteps",label:"Footstep sounds",valueElement:d.jsx(sr,{value:!t&&!e}),onSelect:D(Bt,"userSettings.soundSettings.noFootsteps"),disabled:t}),d.jsx(an,{}),Et()||d.jsx(Ft,{})]}),Et()||d.jsx(ln,{className:"text-moss zx:text-zxGreen"})]})})]})},xM=()=>d.jsx(Ge,{children:d.jsxs(Se,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:D(He),children:[d.jsx(N,{className:`${xe} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You don’t go towards the light"}),d.jsx(N,{className:`${xe} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),d.jsx(N,{className:`${xe} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),d.jsx(N,{className:`${xe} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),d.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),d.jsx(Be,{className:"hidden",children:d.jsx(Ft,{})})]})}),qM=t=>t.startsWith("markdown/"),VM=t=>{const e=oe(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(qM(e.menuId))return d.jsx(Zd,{pageName:e.menuId.slice(9)});switch(e.menuId){case"controlOptions":return d.jsx(VS,{});case"crowns":return d.jsx(jk,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return d.jsx(SS,{});case"errorCaught":return d.jsx(ES,{errors:e.menuParam});case"hold":return d.jsx(Zk,{});case"inputPreset":return d.jsx(wS,{});case"installGuide":return d.jsx(Zd,{pageName:"installGuide"});case"mainMenu":return d.jsx(Dk,{});case"map":return d.jsx(gM,{});case"modernisationOptions":return d.jsx(aS,{});case"offerReincarnation":return d.jsx(Gk,{});case"proclaimEmperor":return d.jsx(vS,{});case"quitGameConfirm":return d.jsx(Uk,{});case"readTheManual":return d.jsx(vk,{});case"reincarnatedRestart":return d.jsx(xM,{});case"score":return d.jsx(Yk,{});case"sound":return d.jsx(yM,{});default:return e.menuId,d.jsx(Se,{children:d.jsx(N,{children:`unknown dialog ${e}`})})}},bM=ns(()=>ss(()=>import("./Cheats-DRjJIlbo.js"),__vite__mapDeps([7,4,5,8]))),wM=ns(()=>ss(()=>import("./gameMain-D66On8ja.js").then(t=>t.g),__vite__mapDeps([9,8,2,4,5,10]))),vM=ns(()=>ss(()=>import("./testCampaign-CmCM5bp4.js"),__vite__mapDeps([11,10,4,5]))),_M="/assets/bonus-CvVo342Z.mp3",kM="/assets/bubblesLoop-B_LY362Z.mp3",SM="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",CM="/assets/conveyorStop-D5zeg8cv.mp3",MM="/assets/conveyorLoop-CF-OA6qJ.mp3",PM="/assets/conveyorStart-CcCK4MGd.mp3",EM="/assets/destroy-CZDN4Ktz.mp3",TM="/assets/detect-D_kRR5uD.mp3",IM="data:audio/mpeg;base64,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",RM="data:audio/mpeg;base64,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",BM="/assets/headFall-rxdxTCeK.mp3",jM="/assets/headJump-GCHlCfni.mp3",zM="/assets/headWalk-B5kQ4tvC.mp3",NM="/assets/heelsFall-IsGtipMw.mp3",FM="data:audio/mpeg;base64,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",OM="/assets/heelsWalk-Bmk6WOTI.mp3",LM="/assets/helicopter-BYGzJTF2.mp3",DM="data:audio/mpeg;base64,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",HM="/assets/hushPuppyVanish-CZOUg83F.mp3",GM="/assets/jetpack-loop-1-XbLJ84YF.m4a",UM="data:audio/mpeg;base64,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Jua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",WM="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",YM="data:audio/mpeg;base64,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v//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",$M="/assets/mojo-D9S1pz9n.mp3",XM="data:audio/mp4;base64,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",QM="/assets/robotBeepingLoop-Cz0TGwJH.mp3",KM="data:audio/mpeg;base64,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",ZM="/assets/rollingBallLoop-BUA084C_.mp3",JM="/assets/servosLoop-Bn-haKck.mp3",eP="/assets/servosStart-BgsySGJF.mp3",tP="/assets/servosStop-BR1i0gi5.mp3",rP="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",sP="/assets/spring-CP3uOhml.mp3",nP="/assets/metalicScraping-BqmM5ys4.mp3",iP="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",aP="/assets/toasterPopUp-CNfTxQPs.mp3",oP="/assets/teleportIn-DZAhHW9-.mp3",lP="/assets/teleportOut-Bra-ABlh.mp3",cP="/assets/teleportWarningSiren-Boo1HoAB.mp3",uP=new window.AudioContext;let bi;const se=async t=>await uP.decodeAudioData(await(await fetch(t)).arrayBuffer()),hP=ns(async()=>({bonus:await se(_M),bubbleRobotLoop:await se(kM),carry:await se(SM),conveyorEnd:await se(CM),conveyorLoop:await se(MM),conveyorStart:await se(PM),destroy:await se(EM),detect:await se(TM),drum:await se(IM),glassClink:await se(RM),headFall:await se(BM),headJump:await se(jM),headWalk:await se(zM),heelsFall:await se(NM),heelsJump:await se(FM),heelsWalk:await se(OM),helicopter:await se(LM),hooter:await se(DM),hushPuppyVanish:await se(HM),jetpackLoop:await se(GM),jetpackTurnaround:await se(UM),landing:await se(WM),metalHit:await se(YM),mojoLoop:await se($M),mojoTurn:await se(XM),robotBeepingLoop:await se(QM),robotWhirLoop:await se(KM),rollingBallLoop:await se(ZM),servoLoop:await se(JM),servoStart:await se(eP),servoStop:await se(tP),softBump:await se(rP),springBoing:await se(sP),stepStoolScraping:await se(nP),switchClick:await se(iP),toasterPopUpSoundUrl:await se(aP),teleportIn:await se(oP),teleportOut:await se(lP),teleportWarningSiren:await se(cP)})),dP=async()=>{bi===void 0&&(bi=await hP())},dT=()=>{if(bi===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return bi},fP=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=oe(dV);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},qg=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},Of=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,AP=()=>{const t=mV(),e=oe(hV);I.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",Vt())},[]),I.useEffect(()=>{document.body.classList.remove(...Object.keys(is).map(Of)),document.body.classList.add(Of(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])};class pP extends I.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){be.dispatch(mp(qg(e)))}render(){return this.props.children}}const Vg=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const mP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gP=Array.prototype.slice.call(mP),Gn=(t=>{let e={};return t.forEach((r,s)=>e[r]=s),e})(gP),yP=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Fo=String.fromCharCode.bind(String),Lf=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),bg=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),xP=t=>{if(t=t.replace(/\s+/g,""),!yP.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",s,n;for(let i=0;i<t.length;)e=Gn[t.charAt(i++)]<<18|Gn[t.charAt(i++)]<<12|(s=Gn[t.charAt(i++)])<<6|(n=Gn[t.charAt(i++)]),r+=s===64?Fo(e>>16&255):n===64?Fo(e>>16&255,e>>8&255):Fo(e>>16&255,e>>8&255,e&255);return r},qP=typeof atob=="function"?t=>atob(bg(t)):Vg?t=>Buffer.from(t,"base64").toString("binary"):xP,VP=Vg?t=>Lf(Buffer.from(t,"base64")):t=>Lf(qP(t).split("").map(e=>e.charCodeAt(0))),bP=t=>VP(wP(t)),wP=t=>bg(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),vP="gzip",_P=async t=>{try{const e=bP(t),r=new Blob([e]),s=new DecompressionStream(vP),n=r.stream().pipeThrough(s),i=await new Response(n).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},kP=I.lazy(bM),Df=ns(t=>{const r=Ti().get("campaignData");return Promise.all([wM(),r?void 0:Wm(),t&&!r?vM():void 0,r?_P(r):void 0,ck(),dP()])}),SP=()=>{const[t,e]=I.useState(),r=Zr(),s=vc(),n=rp(),{loadingStarted:i,loadingFinished:a}=Ik();return I.useEffect(()=>{if(!r){e(void 0),Df(n);return}let o=!1,l;return(async()=>{try{i();const[u,h,f,A]=await Df(n);if(a(),!o){const m=A||h.campaign,g=n?{...m,rooms:{...m.rooms,...f?.testCampaign.rooms}}:m;l=await u.default(g,s),e(l)}}catch(u){be.dispatch(mp(qg(u)))}})(),()=>{l?.stop(),o=!0}},[n,r,s,i,a]),t},CP=()=>{const[t,e]=I.useState(null),r=rp(),s=SP(),n=oe(uV),i=fP();return AP(),I.useEffect(()=>{t===null||s===void 0||(s.renderIn(t),t.addEventListener("touchstart",a=>a.preventDefault(),{passive:!1}))},[s,t]),I.useEffect(()=>{s?.resizeTo(n)},[n,s]),d.jsxs(d.Fragment,{children:[d.jsx("div",{style:i,ref:e}),d.jsxs(PV,{gameApi:s,children:[d.jsxs(pP,{children:[d.jsx(T1,{}),d.jsx(VM,{})]}),s&&r&&d.jsx(I.Suspense,{fallback:null,children:d.jsx(kP,{})})]})]})},MP=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"loading-border"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[d.jsx("div",{className:"flex flex-col",children:$r.map(t=>d.jsx("span",{className:`sprite ${$s({action:"idle",character:"head",facingXy8:t})}`},t))}),d.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[d.jsx(N,{className:"sprites-double-height mb-1",children:"This is not the editor"}),d.jsxs(et,{className:`${xe} p-1 pt-2 text-metallicBlue`,children:[d.jsx("p",{children:"If you’re seeing this, you’re trying to access the level editor, but the web manifest is getting in the way and redirected you to the game’s client-side routing."}),d.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",d.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),d.jsx("div",{className:"flex flex-col",children:$r.toReversed().map(t=>d.jsx("span",{className:`sprite ${$s({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),PP=()=>d.jsxs(Ge,{children:[d.jsx(Ze,{className:"loading-border"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[d.jsx("div",{className:"flex flex-col",children:$r.map(t=>d.jsx("span",{className:`sprite ${$s({action:"walking",character:"head",facingXy8:t})}`},t))}),d.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[d.jsx(N,{className:"sprites-double-height",children:"404 Not found"}),d.jsx(N,{className:`${xe} p-1 pt-2 text-metallicBlue`,children:"whatever you’re looking for, it ain’t here"})]}),d.jsx("div",{className:"flex flex-col",children:$r.toReversed().map(t=>d.jsx("span",{className:`sprite ${$s({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),EP=()=>{const t=Ql();return I.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),d.jsxs(Yg,{children:[d.jsx(un,{path:"/",children:d.jsx(Ts,{children:d.jsx(C1,{children:d.jsx(Tk,{children:d.jsx(CP,{})})})})}),d.jsx(un,{path:"/sprites",children:d.jsx(MV,{})}),d.jsx(un,{path:"/editor",children:d.jsx(Ts,{children:d.jsx(MP,{})})}),d.jsx(un,{children:d.jsx(Ts,{children:d.jsx(PP,{})})})]})},TP=()=>d.jsx(Ux,{store:be,children:d.jsx(EP,{})}),fT=Object.freeze(Object.defineProperty({__proto__:null,App:TP},Symbol.toStringTag,{value:"Module"}));export{ww as $,uT as A,FC as B,qp as C,Ag as D,fE as E,el as F,qr as G,_r as H,sE as I,nT as J,BV as K,yh as L,hg as M,nE as N,Jo as O,bf as P,be as Q,ue as R,LE as S,Fe as T,ae as U,Gw as V,wf as W,bE as X,gE as Y,WV as Z,Ke as _,HP as a,ZP as a$,X as a0,ct as a1,mi as a2,Ut as a3,Ve as a4,ut as a5,nn as a6,Iv as a7,nd as a8,je as a9,Hh as aA,Ls as aB,hv as aC,Pe as aD,Me as aE,Uh as aF,Qa as aG,Yh as aH,Hw as aI,Ye as aJ,jp as aK,Dv as aL,o0 as aM,c0 as aN,A0 as aO,m0 as aP,g0 as aQ,Dm as aR,Ib as aS,Jk as aT,Br as aU,xE as aV,IE as aW,Cg as aX,N as aY,Ts as aZ,Ol as a_,jv as aa,at as ab,Ds as ac,Qn as ad,dc as ae,Wp as af,Wt as ag,am as ah,Md as ai,de as aj,a0 as ak,l0 as al,d0 as am,p0 as an,lm as ao,fc as ap,he as aq,Al as ar,cw as as,Bi as at,rm as au,x0 as av,Zt as aw,Ip as ax,zt as ay,Ow as az,rE as b,L as b$,mE as b0,vE as b1,JP as b2,sr as b3,_E as b4,NC as b5,FE as b6,sl as b7,MC as b8,tr as b9,UV as bA,iT as bB,Le as bC,ey as bD,tA as bE,ar as bF,tT as bG,lx as bH,eT as bI,rT as bJ,sT as bK,wl as bL,TE as bM,Ec as bN,Xg as bO,Jg as bP,ty as bQ,lC as bR,Re as bS,tE as bT,RV as bU,cp as bV,Ce as bW,Nl as bX,sA as bY,xt as bZ,pE as b_,hr as ba,_t as bb,Sy as bc,Ty as bd,qt as be,_e as bf,Gs as bg,Pd as bh,UP as bi,JE as bj,zl as bk,fp as bl,uk as bm,BE as bn,GP as bo,$P as bp,Tr as bq,fV as br,y1 as bs,V1 as bt,w1 as bu,nA as bv,Lo as bw,EE as bx,VA as by,Un as bz,lT as c,uP as c$,Ap as c0,yE as c1,XV as c2,VE as c3,wE as c4,OE as c5,Vi as c6,We as c7,Eb as c8,ot as c9,iE as cA,jV as cB,DE as cC,pV as cD,oC as cE,WE as cF,YE as cG,jP as cH,QE as cI,Hy as cJ,ug as cK,OP as cL,Es as cM,hE as cN,lE as cO,cE as cP,YV as cQ,AE as cR,uE as cS,gp as cT,SC as cU,CC as cV,NP as cW,FP as cX,zP as cY,SE as cZ,jl as c_,Oo as ca,aE as cb,CE as cc,LP as cd,ec as ce,KP as cf,BP as cg,ge as ch,Hr as ci,Zs as cj,$r as ck,$g as cl,Bt as cm,dE as cn,oE as co,$V as cp,aC as cq,Af as cr,KE as cs,ZE as ct,XE as cu,$E as cv,HE as cw,DC as cx,lp as cy,HC as cz,ke as d,dT as d0,Ll as d1,NE as d2,RE as d3,Fi as d4,qq as d5,ix as d6,YP as d7,AA as d8,tn as d9,lw as dA,jE as dB,A_ as dC,ym as dD,id as dE,sd as dF,Rd as dG,q_ as dH,uw as dI,pi as dJ,ql as dK,Td as dL,Vm as dM,fT as dN,aT as da,NA as db,zE as dc,Dr as dd,mC as de,Kg as df,fA as dg,HA as dh,Qx as di,qV as dj,gV as dk,TC as dl,hC as dm,Vt as dn,mp as dp,qg as dq,kE as dr,QP as ds,eE as dt,Kl as du,GE as dv,UE as dw,Ti as dx,hT as dy,qE as dz,Gt as e,Ai as f,oT as g,cT as h,OS as i,of as j,ti as k,rA as l,Js as m,Cr as n,pe as o,Pl as p,Ee as q,ee as r,WP as s,eA as t,Tl as u,Qe as v,gA as w,Zg as x,Jl as y,DP as z};
