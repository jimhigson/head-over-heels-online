const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/campaign-B180bztC.js","assets/index-C75MXpZm.js","assets/index-K2-8dons.css","assets/browserAll-6H-PA5gs.js","assets/webworkerAll-DySfygwB.js","assets/Graphics-pp0bTXBw.js","assets/colorToUniform-KTpA7KSL.js","assets/Cheats-CsPO-kvM.js","assets/ItemStateMap-BI-kCy0f.js","assets/gameMain-IVHkQnZT.js"])))=>i.map(i=>d[i]);
import{b as _s,r as C,R as Oh,g as rt,_ as fr,a as qv,i as Ui,j as p,L as wv,t as et,d as Ry,D as _e,c as io}from"./index-C75MXpZm.js";function vv(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,n,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)r=s[0],r==="*"?(o.push(r),a+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~n?n:~i?i:s.length)),a+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~n?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var dl={exports:{}},fl={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vf;function Vv(){if(vf)return fl;vf=1;var t=_s();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,d){var f=d(),m=n({inst:{value:f,getSnapshot:d}}),A=m[0].inst,g=m[1];return i(function(){A.value=f,A.getSnapshot=d,l(A)&&g({inst:A})},[h,f,d]),s(function(){return l(A)&&g({inst:A}),h(function(){l(A)&&g({inst:A})})},[h]),o(f),f}function l(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!r(h,f)}catch{return!0}}function c(h,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return fl.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,fl}var Vf;function _v(){return Vf||(Vf=1,dl.exports=Vv()),dl.exports}var Sv=_v();const kv=Oh.useInsertionEffect,Cv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pv=Cv?C.useLayoutEffect:C.useEffect,Ev=kv||Pv,My=t=>{const e=C.useRef([t,(...r)=>e[0](...r)]).current;return Ev(()=>{e[0]=t}),e[1]},Tv="popstate",Bh="pushState",zh="replaceState",Rv="hashchange",_f=[Tv,Bh,zh,Rv],Mv=t=>{for(const e of _f)addEventListener(e,t);return()=>{for(const e of _f)removeEventListener(e,t)}},Iy=(t,e)=>Sv.useSyncExternalStore(Mv,t,e),Iv=()=>location.search,jv=({ssrSearch:t=""}={})=>Iy(Iv,()=>t),Sf=()=>location.pathname,Ov=({ssrPath:t}={})=>Iy(Sf,t?()=>t:Sf),Bv=(t,{replace:e=!1,state:r=null}={})=>history[e?zh:Bh](r,"",t),zv=(t={})=>[Ov(t),Bv],kf=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[kf]>"u"){for(const t of[Bh,zh]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),n=new Event(t);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,kf,{value:!0})}const Nv=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",jy=(t="")=>t==="/"?"":t,Dv=(t,e)=>t[0]==="~"?t.slice(1):jy(e)+t,Fv=(t="",e)=>Nv(Cf(jy(t)),Cf(e)),Cf=t=>{try{return decodeURI(t)}catch{return t}},Oy={hook:zv,searchHook:jv,parser:vv,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},By=C.createContext(Oy),Fa=()=>C.useContext(By),zy={},Ny=C.createContext(zy),Lv=()=>C.useContext(Ny),Nh=t=>{const[e,r]=t.hook(t);return[Fv(t.base,e),My((n,s)=>r(Dv(n,t.base),s))]},Dy=(t,e,r,n)=>{const{pattern:s,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",n),o=s.exec(r)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,d)=>[h,l[d]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...n?[a]:[]]:[!1,null]},Uv=({children:t,...e})=>{const r=Fa(),n=e.hook?Oy:r;let s=n;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=C.useRef({}),l=a.current,c=l;for(let u in n){const h=u==="base"?n[u]+(e[u]||""):e[u]||n[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,h!==n[u]&&(s=c)}return C.createElement(By.Provider,{value:s,children:t})},Pf=({children:t,component:e},r)=>e?C.createElement(e,{params:r}):typeof t=="function"?t(r):t,Hv=t=>{let e=C.useRef(zy);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([n,s])=>s!==r[n])?t:r},oo=({path:t,nest:e,match:r,...n})=>{const s=Fa(),[i]=Nh(s),[o,a,l]=r??Dy(s.parser,t,i,e),c=Hv({...Lv(),...a});if(!o)return null;const u=l?C.createElement(Uv,{base:l},Pf(n,c)):Pf(n,c);return C.createElement(Ny.Provider,{value:c,children:u})};C.forwardRef((t,e)=>{const r=Fa(),[n,s]=Nh(r),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:d,...f}=t,m=My(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a?.(g),g.defaultPrevented||(g.preventDefault(),s(o,t)))}),A=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return l&&C.isValidElement(c)?C.cloneElement(c,{onClick:m,href:A}):C.createElement("a",{...f,onClick:m,href:A,className:u?.call?u(n===o):u,children:c,ref:e})});const Fy=t=>Array.isArray(t)?t.flatMap(e=>Fy(e&&e.type===C.Fragment?e.props.children:e)):[t],$v=({children:t,location:e})=>{const r=Fa(),[n]=Nh(r);for(const s of Fy(t)){let i=0;if(C.isValidElement(s)&&(i=Dy(r.parser,s.props.path,e||n,s.props.nest))[0])return C.cloneElement(s,{match:i})}return null},je=t=>t[Symbol.iterator](),ui=1e-4,Lr=(t,e)=>Math.abs(t-e)<ui,IF=t=>t===0?ui:Math.abs(t)<ui?ui*Math.sign(t):t,Hi=["away","towards","left","right"],Wv=["awayRight","towardsRight","towardsLeft","awayLeft"],fs=[...Hi,...Wv],Ly=t=>t==="away"||t==="towards"?"y":"x",jF=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",Uy=t=>Dh(Ly(t)),Dh=t=>t==="x"?"y":"x",Ur=(t,...e)=>e.reduce((r,n)=>({x:r.x+(n.x??0),y:r.y+(n.y??0)}),t),Gv=(t,...e)=>e.reduce((r,n)=>({x:r.x-(n.x??0),y:r.y-(n.y??0)}),t),Fh=(t,e)=>({x:t.x*e,y:t.y*e}),Lt=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),Qv=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),$i=({x:t,y:e,z:r})=>Math.hypot(t,e,r),Hy=({x:t,y:e})=>Math.hypot(t,e),Yv=({x:t,y:e,z:r})=>t**2+e**2+r**2,bn=t=>{const e=$i(t);if(e===0)throw new Error("unitVector called with zero length vector");return Lt(t,1/e)},ee=(...t)=>t.reduce(({x:e,y:r,z:n},{x:s=0,y:i=0,z:o=0})=>({x:e+s,y:r+i,z:n+o}),fe),Kv=(...t)=>t.reduce(({x:e,y:r,z:n},{x:s,y:i,z:o})=>({x:e*s,y:r*i,z:n*o}),La),Pr=(t,...e)=>e.reduce((r,n)=>({x:r.x-(n.x??0),y:r.y-(n.y??0),z:r.z-(n.z??0)}),t),Lh=({x:t,y:e,z:r},{x:n,y:s,z:i})=>t===n&&e===s&&r===i,Xv=({x:t,y:e},{x:r,y:n})=>t===r&&e===n,OF=t=>{const{x:e}=t,r=Math.round(e),n=!Number.isInteger(e)&&Lr(e,r),{y:s}=t,i=Math.round(s),o=!Number.isInteger(s)&&Lr(s,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&Lr(t.z,l);return n||o||c?{x:n?r:e,y:o?i:s,z:c?l:a}:t},BF=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),zF=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),Jv=Object.freeze({x:0,y:0}),fe=Object.freeze({x:0,y:0,z:0}),La=Object.freeze({x:1,y:1,z:1}),Zv=["x","y","z"],da=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,eV=({x:t,y:e})=>{if(!(Lr(t,0)&&Lr(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},tV=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],Uh=({x:t,y:e})=>{if(Lr(t,0)&&Lr(e,0))return;const r=Math.atan2(-e,-t),n=Math.round(8*r/(2*Math.PI))&7;return tV[n]},NF=({x:t,y:e},{x:r,y:n})=>Math.abs(r-t)**2+Math.abs(n-e)**2;var pl={exports:{}},ml={exports:{}},Ef;function Xr(){return Ef||(Ef=1,function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ml)),ml.exports}var Tf;function rV(){return Tf||(Tf=1,function(t){var e=Xr().default;function r(){t.exports=r=function(){return s},t.exports.__esModule=!0,t.exports.default=t.exports;var n,s={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(M,T,j){M[T]=j.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function d(M,T,j){return Object.defineProperty(M,T,{value:j,enumerable:!0,configurable:!0,writable:!0}),M[T]}try{d({},"")}catch{d=function(j,O,z){return j[O]=z}}function f(M,T,j,O){var z=T&&T.prototype instanceof q?T:q,F=Object.create(z.prototype),L=new k(O||[]);return a(F,"_invoke",{value:N(M,j,L)}),F}function m(M,T,j){try{return{type:"normal",arg:M.call(T,j)}}catch(O){return{type:"throw",arg:O}}}s.wrap=f;var A="suspendedStart",g="suspendedYield",y="executing",b="completed",x={};function q(){}function V(){}function _(){}var v={};d(v,c,function(){return this});var S=Object.getPrototypeOf,E=S&&S(S(P([])));E&&E!==i&&o.call(E,c)&&(v=E);var R=_.prototype=q.prototype=Object.create(v);function I(M){["next","throw","return"].forEach(function(T){d(M,T,function(j){return this._invoke(T,j)})})}function B(M,T){function j(z,F,L,W){var Y=m(M[z],M,F);if(Y.type!=="throw"){var re=Y.arg,ie=re.value;return ie&&e(ie)=="object"&&o.call(ie,"__await")?T.resolve(ie.__await).then(function(ne){j("next",ne,L,W)},function(ne){j("throw",ne,L,W)}):T.resolve(ie).then(function(ne){re.value=ne,L(re)},function(ne){return j("throw",ne,L,W)})}W(Y.arg)}var O;a(this,"_invoke",{value:function(F,L){function W(){return new T(function(Y,re){j(F,L,Y,re)})}return O=O?O.then(W,W):W()}})}function N(M,T,j){var O=A;return function(z,F){if(O===y)throw Error("Generator is already running");if(O===b){if(z==="throw")throw F;return{value:n,done:!0}}for(j.method=z,j.arg=F;;){var L=j.delegate;if(L){var W=D(L,j);if(W){if(W===x)continue;return W}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(O===A)throw O=b,j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);O=y;var Y=m(M,T,j);if(Y.type==="normal"){if(O=j.done?b:g,Y.arg===x)continue;return{value:Y.arg,done:j.done}}Y.type==="throw"&&(O=b,j.method="throw",j.arg=Y.arg)}}}function D(M,T){var j=T.method,O=M.iterator[j];if(O===n)return T.delegate=null,j==="throw"&&M.iterator.return&&(T.method="return",T.arg=n,D(M,T),T.method==="throw")||j!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+j+"' method")),x;var z=m(O,M.iterator,T.arg);if(z.type==="throw")return T.method="throw",T.arg=z.arg,T.delegate=null,x;var F=z.arg;return F?F.done?(T[M.resultName]=F.value,T.next=M.nextLoc,T.method!=="return"&&(T.method="next",T.arg=n),T.delegate=null,x):F:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,x)}function U(M){var T={tryLoc:M[0]};1 in M&&(T.catchLoc=M[1]),2 in M&&(T.finallyLoc=M[2],T.afterLoc=M[3]),this.tryEntries.push(T)}function w(M){var T=M.completion||{};T.type="normal",delete T.arg,M.completion=T}function k(M){this.tryEntries=[{tryLoc:"root"}],M.forEach(U,this),this.reset(!0)}function P(M){if(M||M===""){var T=M[c];if(T)return T.call(M);if(typeof M.next=="function")return M;if(!isNaN(M.length)){var j=-1,O=function z(){for(;++j<M.length;)if(o.call(M,j))return z.value=M[j],z.done=!1,z;return z.value=n,z.done=!0,z};return O.next=O}}throw new TypeError(e(M)+" is not iterable")}return V.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:V,configurable:!0}),V.displayName=d(_,h,"GeneratorFunction"),s.isGeneratorFunction=function(M){var T=typeof M=="function"&&M.constructor;return!!T&&(T===V||(T.displayName||T.name)==="GeneratorFunction")},s.mark=function(M){return Object.setPrototypeOf?Object.setPrototypeOf(M,_):(M.__proto__=_,d(M,h,"GeneratorFunction")),M.prototype=Object.create(R),M},s.awrap=function(M){return{__await:M}},I(B.prototype),d(B.prototype,u,function(){return this}),s.AsyncIterator=B,s.async=function(M,T,j,O,z){z===void 0&&(z=Promise);var F=new B(f(M,T,j,O),z);return s.isGeneratorFunction(T)?F:F.next().then(function(L){return L.done?L.value:F.next()})},I(R),d(R,h,"Generator"),d(R,c,function(){return this}),d(R,"toString",function(){return"[object Generator]"}),s.keys=function(M){var T=Object(M),j=[];for(var O in T)j.push(O);return j.reverse(),function z(){for(;j.length;){var F=j.pop();if(F in T)return z.value=F,z.done=!1,z}return z.done=!0,z}},s.values=P,k.prototype={constructor:k,reset:function(T){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(w),!T)for(var j in this)j.charAt(0)==="t"&&o.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=n)},stop:function(){this.done=!0;var T=this.tryEntries[0].completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(T){if(this.done)throw T;var j=this;function O(re,ie){return L.type="throw",L.arg=T,j.next=re,ie&&(j.method="next",j.arg=n),!!ie}for(var z=this.tryEntries.length-1;z>=0;--z){var F=this.tryEntries[z],L=F.completion;if(F.tryLoc==="root")return O("end");if(F.tryLoc<=this.prev){var W=o.call(F,"catchLoc"),Y=o.call(F,"finallyLoc");if(W&&Y){if(this.prev<F.catchLoc)return O(F.catchLoc,!0);if(this.prev<F.finallyLoc)return O(F.finallyLoc)}else if(W){if(this.prev<F.catchLoc)return O(F.catchLoc,!0)}else{if(!Y)throw Error("try statement without catch or finally");if(this.prev<F.finallyLoc)return O(F.finallyLoc)}}}},abrupt:function(T,j){for(var O=this.tryEntries.length-1;O>=0;--O){var z=this.tryEntries[O];if(z.tryLoc<=this.prev&&o.call(z,"finallyLoc")&&this.prev<z.finallyLoc){var F=z;break}}F&&(T==="break"||T==="continue")&&F.tryLoc<=j&&j<=F.finallyLoc&&(F=null);var L=F?F.completion:{};return L.type=T,L.arg=j,F?(this.method="next",this.next=F.finallyLoc,x):this.complete(L)},complete:function(T,j){if(T.type==="throw")throw T.arg;return T.type==="break"||T.type==="continue"?this.next=T.arg:T.type==="return"?(this.rval=this.arg=T.arg,this.method="return",this.next="end"):T.type==="normal"&&j&&(this.next=j),x},finish:function(T){for(var j=this.tryEntries.length-1;j>=0;--j){var O=this.tryEntries[j];if(O.finallyLoc===T)return this.complete(O.completion,O.afterLoc),w(O),x}},catch:function(T){for(var j=this.tryEntries.length-1;j>=0;--j){var O=this.tryEntries[j];if(O.tryLoc===T){var z=O.completion;if(z.type==="throw"){var F=z.arg;w(O)}return F}}throw Error("illegal catch attempt")},delegateYield:function(T,j,O){return this.delegate={iterator:P(T),resultName:j,nextLoc:O},this.method==="next"&&(this.arg=n),x}},s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(pl)),pl.exports}var gl,Rf;function Jr(){if(Rf)return gl;Rf=1;var t=rV()();gl=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return gl}var Rt={},Al={exports:{}},yl={exports:{}},xl={exports:{}},Mf;function nV(){return Mf||(Mf=1,function(t){var e=Xr().default;function r(n,s){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,s||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(xl)),xl.exports}var If;function $y(){return If||(If=1,function(t){var e=Xr().default,r=nV();function n(s){var i=r(s,"string");return e(i)=="symbol"?i:i+""}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(yl)),yl.exports}var jf;function sV(){return jf||(jf=1,function(t){var e=$y();function r(n,s,i){return(s=e(s))in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Al)),Al.exports}var bl={exports:{}},ql={exports:{}},wl={exports:{}},Of;function Wy(){return Of||(Of=1,function(t){function e(r,n){(n==null||n>r.length)&&(n=r.length);for(var s=0,i=Array(n);s<n;s++)i[s]=r[s];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(wl)),wl.exports}var Bf;function iV(){return Bf||(Bf=1,function(t){var e=Wy();function r(n){if(Array.isArray(n))return e(n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(ql)),ql.exports}var vl={exports:{}},zf;function oV(){return zf||(zf=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(vl)),vl.exports}var Vl={exports:{}},Nf;function Gy(){return Nf||(Nf=1,function(t){var e=Wy();function r(n,s){if(n){if(typeof n=="string")return e(n,s);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,s):void 0}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Vl)),Vl.exports}var _l={exports:{}},Df;function aV(){return Df||(Df=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(_l)),_l.exports}var Ff;function Hh(){return Ff||(Ff=1,function(t){var e=iV(),r=oV(),n=Gy(),s=aV();function i(o){return e(o)||r(o)||n(o)||s()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(bl)),bl.exports}var Sl={},kl={},Lf;function Ua(){if(Lf)return kl;Lf=1;function t(e){return typeof e<"u"}return kl.notUndefined=t,kl}var Uf;function Qy(){if(Uf)return Sl;Uf=1;var t=Ua(),e=t.notUndefined;function r(n){return n!=null&&e(n[Symbol.iterator])}return Sl.isIterable=r,Sl}var Cl={},Hf;function lV(){return Hf||(Hf=1,Cl.isLoopable=Qy().isIterable),Cl}var Pl={},$f;function cV(){if($f)return Pl;$f=1;var t=Ua(),e=t.notUndefined;function r(n){return n==null||e(n[Symbol.iterator])}return Pl.isWrappable=r,Pl}var ao={},Wf;function uV(){if(Wf)return ao;Wf=1;var t=Jr(),e=t.mark(n),r=t.mark(s);function n(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(i,"t0",1);case 1:case"end":return a.stop()}},e)}ao.wrap=n;function s(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i==null){a.next=2;break}return a.delegateYield(i,"t0",2);case 2:case"end":return a.stop()}},r)}return ao.nullableWrap=s,ao}var lo={},Gf;function hV(){if(Gf)return lo;Gf=1;var t=Hh();function e(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s.length,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return i<=l.length?s.apply(void 0,t(o).concat(l)):e(s,i-l.length,[].concat(t(o),l))}}lo.curry=e;function r(s,i){var o=s.fn,a=s.validateArgs,l=s.variadic,c=s.reduces,u=s.growRight,h=s.minArgs,d=s.maxArgs,f=s.isIterable,m=s.iterableType,A=s.applyOnIterableArgs,g=s.IterableClass;if(i.length>h){var y=!0,b=l?i.findIndex(function(E,R){return f(E)&&R>=h}):Math.min(d,i.length-1),x=l?i.length:b+1;if(l)for(var q=b;q<i.length;q++)y=y&&f(i[q]);else y=f(i[b]);if(i.length>d&&(b===-1||!y)){var V=l?"...".concat(m,"s"):m,_="".concat(o.name," takes up to ").concat(d," arguments, followed by ").concat(V,". ")+"You already passed ".concat(i.length," arguments");throw l?new Error("".concat(_," and the following arguments were not all ").concat(m,"s")):new Error("".concat(_," and the last argument was not ").concat(m))}if(b>=0&&y){for(var v=b;v<x;v++)i[v]=A(i[v]);var S=l?i.slice(b):i[b];return i.splice(b),u||i.reverse(),i.unshift(S),a(i),c?o.apply(void 0,t(i)):new g(o,i)}}return n(s,i)}function n(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];if(a.length===0)throw new Error("Cannot make a partial application with no arguments");return a.unshift.apply(a,t(i)),r(s,a)}}return lo.variadicCurryWithValidation=n,lo}var Ns={},Qf;function dV(){if(Qf)return Ns;Qf=1;var t=Symbol.for("_");Ns._=t;var e=Symbol("__iterate");Ns.__iterate=e;var r=Symbol("split");return Ns.split=r,Ns}var Yf;function Ht(){if(Yf)return Rt;Yf=1;var t=sV(),e=Hh(),r,n=Qy(),s=n.isIterable,i=lV(),o=i.isLoopable,a=cV(),l=a.isWrappable,c=uV(),u=c.nullableWrap,h=hV(),d=h.variadicCurryWithValidation,f=dV(),m=f._,A=f.__iterate;Rt.wrap=u,Rt.isIterable=s,Rt.isLoopable=o,Rt.isWrappable=l;function g(S){if(l(S))return s(S)?S:u(S);throw typeof S.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}Rt.ensureIterable=g;function y(S){"return"in S&&S.return()}Rt.callReturn=y;function b(S,E){this[m]={fn:S,args:E,staticIterator:null}}Rt.BaseIterableIterator=b,Object.assign(b.prototype,(r={constructor:b},t(r,A,function(){var S=this[m],E=S.fn,R=S.args;return E.apply(void 0,e(R))}),t(r,"next",function(){var E=this[m];return E.staticIterator=E.staticIterator||this[A](),E.staticIterator.next()}),t(r,"return",function(E){var R=this[m];return R.staticIterator=R.staticIterator||this[A](),R.staticIterator.return(E)}),t(r,"throw",function(E){var R=this[m];return R.staticIterator=R.staticIterator||this[A](),R.staticIterator.throw(E)}),r));function x(){for(var S=arguments.length,E=new Array(S),R=0;R<S;R++)E[R]=arguments[R];b.apply(this,E)}Rt.IterableIterator=x,x.prototype=Object.assign(Object.create(b.prototype),t({constructor:x},Symbol.iterator,function(){return this[A]()}));function q(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=E.validateArgs,I=R===void 0?function(F){}:R,B=E.variadic,N=B===void 0?!1:B,D=E.reduces,U=D===void 0?!1:D,w=E.growRight,k=w===void 0?!1:w,P=E.minArgs,M=P===void 0?S.length-1:P,T=E.maxArgs,j=T===void 0?S.length-1:T,O=E.applyOnIterableArgs,z=O===void 0?g:O;return{fn:S,validateArgs:I,variadic:N,reduces:U,growRight:k,minArgs:M,maxArgs:j,isIterable:l,iterableType:"iterable",applyOnIterableArgs:z,IterableClass:x}}function V(S){return e(S)}Rt.cache=V;function _(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=E.validateArgs,I=R===void 0?function(B){return B}:R;return function(){for(var B=arguments.length,N=new Array(B),D=0;D<B;D++)N[D]=arguments[D];return I(N),new x(S,N)}}Rt.wrapWithIterableIterator=_;var v=function(E,R){return d(q(E,R))};return Rt.iterableCurry=v,Rt}var El={exports:{}},Kf;function $h(){return Kf||(Kf=1,function(t){function e(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(El)),El.exports}var Tl={exports:{}},Xf;function Wh(){return Xf||(Xf=1,function(t){var e=$y();function r(s,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,e(a.key),a)}}function n(s,i,o){return i&&r(s.prototype,i),o&&r(s,o),Object.defineProperty(s,"prototype",{writable:!1}),s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Tl)),Tl.exports}var Rl={exports:{}},Ml={exports:{}},Jf;function Yy(){return Jf||(Jf=1,function(t){function e(r,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ml)),Ml.exports}var Zf;function fV(){return Zf||(Zf=1,function(t){var e=Yy();function r(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&e(n,s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Rl)),Rl.exports}var Il={exports:{}},jl={exports:{}},ep;function pV(){return ep||(ep=1,function(t){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(jl)),jl.exports}var tp;function mV(){return tp||(tp=1,function(t){var e=Xr().default,r=pV();function n(s,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Il)),Il.exports}var Ol={exports:{}},rp;function Ky(){return rp||(rp=1,function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ol)),Ol.exports}var Bl={exports:{}},zl={exports:{}},np;function gV(){return np||(np=1,function(t){function e(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!r},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(zl)),zl.exports}var sp;function AV(){return sp||(sp=1,function(t){var e=gV(),r=Yy();function n(s,i,o){if(e())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,i);var l=new(s.bind.apply(s,a));return o&&r(l,o.prototype),l}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Bl)),Bl.exports}var Nl={},ip;function yV(){if(ip)return Nl;ip=1;var t=$h(),e=Wh(),r=function(){function n(){t(this,n)}return e(n,[{key:Symbol.iterator,value:function(){return this}}]),n}();return Nl.IterableIterator=r,Nl}var Ds={},op;function Xy(){if(op)return Ds;op=1;function t(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof n=="number"&&!isNaN(n)&&isFinite(n)&&!(s&&n===0)}Ds.isInteger=t;function e(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return t(n)&&(s?n>0:n>=0)}Ds.isPositiveInteger=e;function r(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof n=="number"&&!isNaN(n)&&!(s&&n===0)}return Ds.isIntegerOrInfinite=r,Ds}var Dl={exports:{}},Fl={exports:{}},ap;function xV(){return ap||(ap=1,function(t){var e=Ky();function r(n,s){for(;!{}.hasOwnProperty.call(n,s)&&(n=e(n))!==null;);return n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Fl)),Fl.exports}var lp;function bV(){return lp||(lp=1,function(t){var e=xV();function r(){return t.exports=r=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,s,i){var o=e(n,s);if(o){var a=Object.getOwnPropertyDescriptor(o,s);return a.get?a.get.call(arguments.length<3?n:i):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(null,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Dl)),Dl.exports}var Ll={exports:{}},Ul={exports:{}},cp;function qV(){return cp||(cp=1,function(t){function e(r){if(Array.isArray(r))return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ul)),Ul.exports}var Hl={exports:{}},up;function wV(){return up||(up=1,function(t){function e(r,n){var s=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s!=null){var i,o,a,l,c=[],u=!0,h=!1;try{if(a=(s=s.call(r)).next,n===0){if(Object(s)!==s)return;u=!1}else for(;!(u=(i=a.call(s)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(d){h=!0,o=d}finally{try{if(!u&&s.return!=null&&(l=s.return(),Object(l)!==l))return}finally{if(h)throw o}}return c}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Hl)),Hl.exports}var $l={exports:{}},hp;function vV(){return hp||(hp=1,function(t){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}($l)),$l.exports}var dp;function VV(){return dp||(dp=1,function(t){var e=qV(),r=wV(),n=Gy(),s=vV();function i(o,a){return e(o)||r(o,a)||n(o,a)||s()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(Ll)),Ll.exports}var co={},fp;function _V(){if(fp)return co;fp=1;var t=Jr(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=n(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(b){throw b},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,A=!1,g;return{s:function(){h=c[Symbol.iterator]()},n:function(){var b=h.next();return m=b.done,b},e:function(b){A=!0,g=b},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(A)throw g}}}}function n(c,u){if(c){if(typeof c=="string")return s(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(c,u)}}function s(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=Ht(),o=i.iterableCurry;function a(c,u){var h,d,f,m;return t.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:h=0,d=r(c),g.prev=2,d.s();case 4:if((f=d.n()).done){g.next=10;break}return m=f.value,g.next=8,u(m,h++);case 8:g.next=4;break;case 10:g.next=15;break;case 12:g.prev=12,g.t0=g.catch(2),d.e(g.t0);case 15:return g.prev=15,d.f(),g.finish(15);case 18:case"end":return g.stop()}},e,null,[[2,12,15,18]])}co.__map=a;var l=o(a);return co.map=l,co}var uo={},pp;function SV(){if(pp)return uo;pp=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(g){throw g},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,m;return{s:function(){c=a[Symbol.iterator]()},n:function(){var g=c.next();return d=g.done,g},e:function(g){f=!0,m=g},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw m}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=Ht(),s=n.ensureIterable;function i(a){var l=[],c=t(a),u;try{for(c.s();!(u=c.n()).done;){var h=u.value;l.push(h)}}catch(d){c.e(d)}finally{c.f()}return l}uo.__toArray=i;function o(a){return i(s(a))}return uo.toArray=o,uo}var Wl={},mp;function Jy(){if(mp)return Wl;mp=1;var t=Xr();function e(r){return t(r)==="object"&&r!==null}return Wl.isObject=e,Wl}var Gl={},gp;function kV(){if(gp)return Gl;gp=1;function t(s,i){var o;if(typeof Symbol>"u"||s[Symbol.iterator]==null){if(Array.isArray(s)||(o=e(s))||i){o&&(s=o);var a=0,l=function(){};return{s:l,n:function(){return a>=s.length?{done:!0}:{done:!1,value:s[a++]}},e:function(f){throw f},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,u=!1,h;return{s:function(){o=s[Symbol.iterator]()},n:function(){var f=o.next();return c=f.done,f},e:function(f){u=!0,h=f},f:function(){try{!c&&o.return!=null&&o.return()}finally{if(u)throw h}}}}function e(s,i){if(s){if(typeof s=="string")return r(s,i);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return r(s,i)}}function r(s,i){(i==null||i>s.length)&&(i=s.length);for(var o=0,a=new Array(i);o<i;o++)a[o]=s[o];return a}function n(s,i){var o=t(s),a;try{for(o.s();!(a=o.n()).done;){var l=a.value;i(l)}}catch(c){o.e(c)}finally{o.f()}}return Gl.parallelEach=n,Gl}var Ql={},Ap;function CV(){if(Ap)return Ql;Ap=1;var t=AV(),e=$h(),r=Wh(),n=Ht(),s=n.ensureIterable,i=n.callReturn,o=Symbol.for("_"),a=function(){function c(u){e(this,c),this.peekr=u}return r(c,[{key:"next",value:function(){var h=this.peekr,d=h.current;return h.advance(),d}},{key:"return",value:function(){return this.peekr.return(),{value:void 0,done:!0}}},{key:Symbol.iterator,value:function(){return this}}]),c}(),l=function(){r(c,null,[{key:"from",value:function(h){for(var d=s(h)[Symbol.iterator](),f=d.next(),m=arguments.length,A=new Array(m>1?m-1:0),g=1;g<m;g++)A[g-1]=arguments[g];return t(this,[d,f].concat(A))}}]);function c(u,h){e(this,c),this[o]={iterator:u,current:h,index:0}}return r(c,[{key:"advance",value:function(){var h=this[o];return h.current.done||(h.index++,h.current=h.iterator.next()),this}},{key:"return",value:function(){var h=this[o];return this.done||i(h.iterator),h.current={value:void 0,done:!0},this}},{key:"asIterator",value:function(){return new a(this)}},{key:"current",get:function(){return this[o].current}},{key:"value",get:function(){return this[o].current.value}},{key:"done",get:function(){return this[o].current.done}},{key:"index",get:function(){return this[o].index}}]),c}();return Ql.Peekerator=l,Ql}var Yl={},yp;function PV(){if(yp)return Yl;yp=1;var t=Xy(),e=t.isInteger,r=Jy(),n=r.isObject,s=Ua(),i=s.notUndefined,o=function(l){return function(u){if(n(u[1])){var h=u[1],d=h.start,f=h.step;u[1]=d,u[2]=f}if(i(u[2])&&(u[2]=Number(u[2]),!e(u[2],!0)))throw new Error("step argument to ".concat(l," must be a non-zero integer"))}};return Yl.makeValidateArgs=o,Yl}var Fs={},xp;function EV(){if(xp)return Fs;xp=1;var t=Hh(),e=$h(),r=Wh(),n=bV(),s=fV(),i=mV(),o=Ky();function a(D){var U=l();return function(){var k=o(D),P;if(U){var M=o(this).constructor;P=Reflect.construct(k,arguments,M)}else P=k.apply(this,arguments);return i(this,P)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var c=Ht(),u=c.iterableCurry,h=c.callReturn,d=yV(),f=d.IterableIterator,m=kV(),A=m.parallelEach,g=CV(),y=g.Peekerator,b=_V(),x=b.__map,q=SV(),V=q.__toArray,_=Symbol.for("_"),v=Symbol.for("__advance"),S=function(D){s(w,D);var U=a(w);function w(k,P,M){var T;return e(this,w),T=U.call(this,k,P),T[_].inputSummary=M,T}return r(w,[{key:"advance",value:function(){this[_].inputSummary.advanceBuffer(this)}},{key:v,value:function(){n(o(w.prototype),"advance",this).call(this)}}]),w}(y),E=function(){function D(){e(this,D),this.buffers=[],this.notDoneBuffer=null,this.index=0}return r(D,[{key:"init",value:function(w){this.buffers=w,this.updateNotDone()}},{key:"updateNotDone",value:function(){this.notDoneBuffer=this.buffers.find(function(w){return!w.done})}},{key:"advanceBuffer",value:function(w){var k=w.done;w[v](),this.index++,!k&&w.done&&this.updateNotDone()}}]),D}(),R=function(){function D(U){e(this,D),this[_]=U}return r(D,[{key:"advance",value:function(){throw new Error("advance() is not supported on an interleave summary")}},{key:"current",get:function(){return{value:this.value,done:this.done}}},{key:"value",get:function(){return this[_].notDoneBuffer}},{key:"done",get:function(){return this[_].notDoneBuffer===void 0}},{key:"index",get:function(){return this[_].index}}]),D}();Fs.InputSummary=R;var I=function(D){s(w,D);var U=a(w);function w(k,P,M){var T;return e(this,w),T=U.call(this),T.sources=k,T.strategy=P,T.options=M,T.initialized=!1,T.inputSummary=new E(k),T}return r(w,[{key:"init",value:function(){this.initialized=!0;var P=this.strategy,M=this.options,T=this.inputSummary;this.buffers=V(x(this.sources,function(j){return S.from(j,T)})),this.iterator=P.apply(void 0,[M,new R(T)].concat(t(this.buffers))),T.init(this.buffers)}},{key:"returnBuffers",value:function(){A(this.buffers,function(P){return P.return()})}},{key:"next",value:function(){this.initialized||this.init();var P=this.iterator.next();return P.done&&this.returnBuffers(),P}},{key:"return",value:function(){return h(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}]),w}(f);function B(D,U){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new I(D,U,w)}Fs.__interleave=B;var N=u(B,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return Fs.interleave=N,Fs}var ho={},fo={},bp;function TV(){if(bp)return fo;bp=1;var t=Ht(),e=t.iterableCurry,r=t.callReturn;function n(i,o){var a=i[Symbol.iterator](),l=a.next(),c=l.value,u=l.done;return u?o:(r(a),c)}fo.__firstOr=n;var s=e(n,{reduces:!0});return fo.firstOr=s,fo}var qp;function RV(){if(qp)return ho;qp=1;var t=Ht(),e=t.iterableCurry,r=TV(),n=r.__firstOr;function s(o){return n(o,void 0)}ho.__first=s;var i=e(s,{reduces:!0});return ho.first=i,ho}var po={},wp;function MV(){if(wp)return po;wp=1;var t=Xr(),e=Jr(),r=e.mark(o),n=Ht(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,[c,l[c]];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}po.__objectEntries=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return po.objectEntries=a,po}var mo={},vp;function IV(){if(vp)return mo;vp=1;var t=Xr(),e=Jr(),r=e.mark(o),n=Ht(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,c;case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}mo.__objectKeys=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return mo.objectKeys=a,mo}var go={},Vp;function jV(){if(Vp)return go;Vp=1;var t=Xr(),e=Jr(),r=e.mark(o),n=Ht(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,l[c];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}go.__objectValues=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return go.objectValues=a,go}var Ao={},_p;function OV(){if(_p)return Ao;_p=1;var t=VV(),e=Jr(),r=e.mark(d),n=Ht(),s=n.wrapWithIterableIterator,i=Xy(),o=i.isInteger,a=i.isIntegerOrInfinite,l=Jy(),c=l.isObject,u=Ua(),h=u.notUndefined;function d(){var m,A,g,y,b=arguments;return e.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:m=b.length>0&&b[0]!==void 0?b[0]:0,A=b.length>1&&b[1]!==void 0?b[1]:1/0,g=b.length>2&&b[2]!==void 0?b[2]:1,y=m;case 4:if(!(g>0?y<A:y>A)){q.next=10;break}return q.next=7,y;case 7:y+=g,q.next=4;break;case 10:case"end":return q.stop()}},r)}Ao.__range=d;var f=s(d,{growRight:!0,validateArgs:function(A){var g=t(A,3),y=g[0],b=g[1],x=b===void 0?1/0:b,q=g[2],V;if(c(y)?(V=y.start,x=y.end,q=y.step):A.length>1?V=y:x=y,h(V)&&!o(V))throw new TypeError("The specified start was not an integer");if(h(x)&&!a(x))throw new TypeError("The specified end was not an integer or infinite");if(h(q)&&!o(q,!0))throw new TypeError("The specified step was not a non-zero integer");A[0]=V,A[1]=x,A[2]=q}});return Ao.range=f,Ao}var yo={},Sp;function BV(){if(Sp)return yo;Sp=1;var t=Jr(),e=t.mark(l),r=Ht(),n=r.iterableCurry,s=EV(),i=s.__interleave,o=PV(),a=o.makeValidateArgs;function l(h,d){var f,m,A,g,y,b,x,q=arguments;return t.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:for(f=h.start,m=h.step,A=q.length,g=new Array(A>2?A-2:0),y=2;y<A;y++)g[y-2]=q[y];f=f%g.length,b=f;case 4:if(d.done){_.next=13;break}if(x=g[b],x.done){_.next=10;break}return _.next=9,x.value;case 9:x.advance();case 10:b=(b+m)%g.length,_.next=4;break;case 13:case"end":return _.stop()}},e)}function c(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i(h,l,{start:f,step:d})}yo.__roundRobin=c;var u=n(c,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:a("roundRobin")});return yo.roundRobin=u,yo}var xo={},kp;function zV(){if(kp)return xo;kp=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(g){throw g},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,m;return{s:function(){c=a[Symbol.iterator]()},n:function(){var g=c.next();return d=g.done,g},e:function(g){f=!0,m=g},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw m}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=Ht(),s=n.ensureIterable;function i(a){var l=s(a),c=0,u=t(l),h;try{for(u.s();!(h=u.n()).done;){var d=h.value;c++}}catch(f){u.e(f)}finally{u.f()}return c}xo.__size=i;var o=i;return xo.size=o,xo}var bo={},Cp;function NV(){if(Cp)return bo;Cp=1;var t=Jr(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=n(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(b){throw b},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,A=!1,g;return{s:function(){h=c[Symbol.iterator]()},n:function(){var b=h.next();return m=b.done,b},e:function(b){A=!0,g=b},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(A)throw g}}}}function n(c,u){if(c){if(typeof c=="string")return s(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(c,u)}}function s(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=Ht(),o=i.iterableCurry;function a(c,u){var h,d,f,m;return t.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u!==0){g.next=2;break}return g.abrupt("return");case 2:h=0,d=r(c),g.prev=4,d.s();case 6:if((f=d.n()).done){g.next=14;break}return m=f.value,g.next=10,m;case 10:if(++h!==u){g.next=12;break}return g.abrupt("break",14);case 12:g.next=6;break;case 14:g.next=19;break;case 16:g.prev=16,g.t0=g.catch(4),d.e(g.t0);case 19:return g.prev=19,d.f(),g.finish(19);case 22:case"end":return g.stop()}},e,null,[[4,16,19,22]])}bo.__take=a;var l=o(a);return bo.take=l,bo}var Kl,Pp;function DV(){return Pp||(Pp=1,Kl=RV().first),Kl}var FV=DV();const LV=rt(FV);var Xl,Ep;function UV(){return Ep||(Ep=1,Xl=MV().objectEntries),Xl}var HV=UV();const Gh=rt(HV);var Jl,Tp;function $V(){return Tp||(Tp=1,Jl=IV().objectKeys),Jl}var WV=$V();const Zy=rt(WV);var Zl,Rp;function GV(){return Rp||(Rp=1,Zl=jV().objectValues),Zl}var QV=GV();const Rn=rt(QV);var ec,Mp;function YV(){return Mp||(Mp=1,ec=OV().range),ec}var KV=YV();const ex=rt(KV);var tc,Ip;function XV(){return Ip||(Ip=1,tc=BV().roundRobin),tc}var JV=XV();const ZV=rt(JV);var rc,jp;function e0(){return jp||(jp=1,rc=zV().size),rc}var t0=e0();const _u=rt(t0);var nc,Op;function r0(){return Op||(Op=1,nc=NV().take),nc}var n0=r0();const s0=rt(n0),sn=(t,{x:e,y:r},n)=>{function*s(){yield[`${t}.left`,{frame:{x:e,y:r,...n}}],yield[`${t}.away`,{frame:{x:e+n.w+1,y:r,...n}}],yield[`${t}.towards`,{frame:{x:e,y:r+n.h+1,...n}}],yield[`${t}.right`,{frame:{x:e+n.w+1,y:r+n.h+1,...n}}]}return Object.fromEntries(s())},Ee=(t,e,{x:r,y:n},s,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a%i*(s.w+1),y:n+Math.floor(a/i)*(s.h+1),...s}}]}return Object.fromEntries(o())},i0=(t,e,r,n)=>({...Ee(`${t}.left`,e,r,n),...Ee(`${t}.away`,e,Ur(r,{x:(n.w+1)*e}),n),...Ee(`${t}.towards`,e,Ur(r,{y:n.h+1}),n),...Ee(`${t}.right`,e,Ur(r,{x:(n.w+1)*e,y:n.h+1}),n)}),ei=(t,e)=>[...je(ex(1,e+1)).map(r=>`${t}.${String(r)}`)],Su={w:32,h:16},Bt={w:16,h:56},ce={w:32,h:28},G={w:24,h:24},ea={w:8,h:8},Q=t=>({x:t.x*(G.w+1)+1,y:t.y*(G.h+1)+2}),pe=t=>({x:t.x*(ce.w+1)+1,y:t.y*(ce.h+1)+396}),DF=["yellow","cyan","green","magenta","white"],Wi=25,FF=1e3/Wi,Ss={amigaHiResPal:{x:640,y:512},classicMac:{x:512,y:384},amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},o0=Object.keys(Ss),LF={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},Ae=(t,e)=>Object.assign([...t],{animationSpeed:e}),a0=.5,tx=5e3,l0=tx*2,Ls=(t,e)=>{const r=Math.round(tx/(Wi*4)),n=`head.walking.${t}.${e}`,s=`head.blinking.${t}`,i=[...new Array(r-3).fill(n),s,n,s];return Ae(i,.5)},sc=(t,e)=>{const r=Math.round(l0/(Wi*4)),n=`heels.walking.${t}.${e}`,s=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(n),...new Array(Math.ceil(r*.2)).fill(s)];return Ae(i,.5)},Bp=(t,e,r)=>{const n=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*s(){for(let i=0;i<fs.length;i++){const o=n[i];for(let a=0;a<=2;a++)yield[`${t}.walking.${o}.${a+1}`,{frame:{...Q({x:e.x+a,y:e.y+i}),...G}}];yield[`${t}.falling.${o}`,{frame:{...Q({x:e.x+3,y:e.y+i}),...G}}],r[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...Q({x:e.x+4,y:e.y+i}),...G}}])}}return Object.fromEntries(s())};function zp(t){function*e(r,n){yield`${r}.walking.${n}.1`,yield`${r}.walking.${n}.2`,yield`${r}.walking.${n}.3`,yield`${r}.walking.${n}.2`}return fs.reduce((r,n)=>({...r,[`${t}.walking.${n}`]:Ae([...e(t,n)],a0)}),{})}const c0={...Ee("bubbles.head",6,Q({x:0,y:6}),G),...Bp("head",{x:0,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},left:{noBlinking:!0}}),...Ee("bubbles.heels",6,Q({x:6,y:6}),G),...Bp("heels",{x:5,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},awayRight:{noBlinking:!0},towardsLeft:{noBlinking:!0},left:{noBlinking:!0}}),...Ee("shine",6,pe({x:8,y:-2}),ce,3),blank:{frame:{...Q({x:0,y:2}),...G}}},rx={frames:c0,animations:{...zp("head"),...zp("heels"),"heels.screenDirections":Ae(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":Ae(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":Ls("right",3),"head.idle.towards":Ls("towards",3),"head.idle.towardsRight":Ls("towardsRight",2),"head.idle.towardsLeft":Ls("towardsLeft",2),"head.idle.awayRight":Ls("awayRight",2),"heels.idle.right":sc("right",2),"heels.idle.towards":sc("towards",2),"heels.idle.towardsRight":sc("towardsRight",2),"head.fadeOut":Ae(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":Ae(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:Ae(ei("shine",6),.5),"shine.headInSymbio":Ae(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":Ae(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},u0={jail:["bars"],blacktooth:["armour","shield","plain"],bookworld:["cowboy","book"],egyptus:["sarcophagus","hieroglyphics"],market:["passage","fruits","more-fruits"],moonbase:["window1","window2","window3","coil"],penitentiary:["loop","skeleton"],safari:["window","shield","wall"]},UF=["blacktooth","penitentiary","bookworld","egyptus","safari"],ct=(t,e,r,n)=>{function*s(i,o,a){const l=u0[i],{w:c,h:u}=Bt,h=c>>1,d=l.length;let f=0;for(;f<l.length;f++)yield[`${i}${n}.wall.${l[f]}.left`,{frame:{x:o+c*f,y:a-h*f,...Bt}}],yield[`${i}${n}.wall.${l[f]}.away`,{frame:{x:o+c*((d<<1)-f-1),y:a-h*f,...Bt}}];const m=f-1;yield[`${i}${n}.floor`,{frame:{x:o+m*c,y:a-m*h+u,...Su}}]}return Object.fromEntries(s(t,e,r))},Np={w:16,h:13},Dp={w:8,h:9},h0={...ct("blacktooth",542,104,".dark"),...ct("blacktooth",542,29,""),...ct("bookworld",408,29,".dark"),...ct("bookworld",408,29,""),...ct("egyptus",475,29,""),...ct("egyptus",475,104,".dark"),...ct("jail",440,104,".dark"),...ct("jail",440,104,""),...ct("market",443,357,".dark"),...ct("market",443,357,""),...ct("moonbase",453,276,".dark"),...ct("moonbase",453,204,""),...ct("penitentiary",376,357,".dark"),...ct("penitentiary",376,357,""),...ct("safari",542,357,".dark"),...ct("safari",542,357,""),"floorEdge.right":{frame:{x:418,y:466,...Np,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...Np,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...Dp,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...Dp,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Bt.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:407,y:143,...Su}},"generic.dark.floor.deadly":{frame:{x:407,y:160,...Su}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Bt.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Bt.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Bt.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Bt.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Bt.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Bt.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Bt.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...Ee("moonbase.wall.screen.window1.away",3,{x:566,y:196},{w:10,h:7}),...Ee("moonbase.wall.screen.window2.away",2,{x:550,y:188},{w:10,h:7}),...Ee("moonbase.wall.screen.window3.away",4,{x:534,y:180},{w:10,h:7})},nx={frames:h0,animations:{"moonbase.wall.screen.window1.away":Ae(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":Ae(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":Ae(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},Gi=Object.entries,sx=Gh,ix=Object.keys,Qh=Zy,d0=Object.fromEntries,ks=Object.fromEntries,f0=(t,e)=>{const n=je(sx(t)).map(e);return d0(n)},p0={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},ox=t=>p0[t]??t,ax="",m0="",g0="",A0="",y0="",x0="",b0=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","","","","",{char:"",double:!0},{char:ax,double:!0},{char:m0,double:!0}],q0=[" ","?","!",".",",",";",":","/","\\","","","'","`","-","+","%","","","","","","","","","(",")","[","]","<",">","","","","EnterFullscreen","ExitFullscreen","Menu","*","@",g0,A0,y0,x0,"","","^","",""],Fp=(t,e)=>{function*r(){let{x:n}=e;for(let s=0;s<t.length;s++){const i=t[s],o=typeof i=="string"?i:i.char,l=(typeof i=="string"?!1:i.double)?ea.w*2:ea.w;yield[`hud.char.${ox(o)}`,{frame:{x:n,y:e.y,...ea,w:l}}],n+=l+1}}return ks(r())},w0={frames:{...Fp(b0,{x:151,y:2}),...Fp(q0,{x:151,y:11})}},zn=(t,e,r)=>{const n=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...Ur(r,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...Ur(r,{x:i+2,y:o}),w:a,h:l,pivot:c};function*s(){yield[`door.frame.${t}.${e}.whole`,{frame:{...n({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...n({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...n({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...n({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return ks(s())},v0={frames:{...zn("generic","y",{x:580,y:415}),...zn("generic","x",{x:582,y:415}),...zn("moonbase","y",{x:451,y:204}),...zn("moonbase","x",{x:582,y:204}),...zn("moonbase.dark","y",{x:451,y:276}),...zn("moonbase.dark","x",{x:582,y:276})}},V0={...Ee("dalek",2,Q({x:0,y:0}),G),"shadowMask.dalek":{frame:{...Q({x:2,y:0}),...G}},...Ee("bubbles.cold",2,Q({x:3,y:0}),G),...sn("cyberman",Q({x:1,y:1}),G),...sn("charles",Q({x:3,y:1}),G),"shadowMask.charles.away":{frame:{...Q({x:5,y:1}),...G}},"shadowMask.charles.right":{frame:{...Q({x:5,y:2}),...G}},...sn("elephant",Q({x:6,y:1}),G),"crown.blacktooth":{frame:{...Q({x:8,y:1}),...G}},"crown.safari":{frame:{...Q({x:9,y:1}),...G}},"crown.egyptus":{frame:{...Q({x:10,y:1}),...G}},"crown.penitentiary":{frame:{...Q({x:11,y:1}),...G}},"crown.bookworld":{frame:{...Q({x:12,y:1}),...G}},ball:{frame:{...Q({x:13,y:1}),...G}},"shadowMask.ball":{frame:{...Q({x:14,y:1}),...G}},sticks:{frame:{...Q({x:8,y:2}),...G}},cube:{frame:{...Q({x:9,y:2}),...G}},drum:{frame:{...Q({x:10,y:2}),...G}},hooter:{frame:{...Q({x:11,y:2}),...G}},bag:{frame:{...Q({x:12,y:2}),...G}},joystick:{frame:{...Q({x:13,y:2}),...G}},"shadowMask.joystick":{frame:{...Q({x:14,y:2}),...G}},...i0("turtle",2,Q({x:0,y:3}),G),"shadowMask.turtle.away":{frame:{...Q({x:4,y:3}),...G}},"shadowMask.turtle.right":{frame:{...Q({x:4,y:4}),...G}},...sn("monkey",Q({x:5,y:3}),G),...sn("computerBot",Q({x:7,y:3}),G),"spring.compressed":{frame:{...Q({x:9,y:3}),...G}},"spring.released":{frame:{...Q({x:10,y:3}),...G}},"switch.left":{frame:{...Q({x:11,y:3}),...G}},"switch.right":{frame:{...Q({x:12,y:3}),...G}},"shadowMask.switch":{frame:{...Q({x:13,y:3}),...G}},tower:{frame:{...Q({x:14,y:3}),...G}},"shadowMask.tower":{frame:{...Q({x:15,y:3}),...G}},scroll:{frame:{...Q({x:9,y:4}),...G,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...Q({x:10,y:4}),...G,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...Q({x:11,y:4}),...G,pivot:{x:17,y:24}}},"spikyBall.1":{frame:{...Q({x:12,y:4}),...G}},"spikyBall.2":{frame:{...Q({x:13,y:4}),...G}},puck:{frame:{...Q({x:14,y:4}),...G}},"shadow.smallRound":{frame:{...Q({x:15,y:4}),...G}},"shadowMask.smallRound":{frame:{...Q({x:16,y:4}),...G}},...Ee("helicopterBug",4,Q({x:0,y:5}),G),"barrier.x":{frame:{...Q({x:4,y:5}),...G,pivot:{x:18,y:23}}},"barrier.y":{frame:{...Q({x:5,y:5}),...G,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...Q({x:6,y:5}),...G,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...Q({x:7,y:5}),...G,pivot:{x:6,y:22}}},...Ee("bubbles.taupe",3,Q({x:8,y:5}),G),whiteRabbit:{frame:{...Q({x:11,y:5}),...G}},"shadowMask.whiteRabbit":{frame:{...Q({x:12,y:5}),...G}},...Ee("bubbles.white",3,Q({x:13,y:5}),G),...Ee("fish",2,Q({x:12,y:6}),G),doughnuts:{frame:{...Q({x:14,y:6}),...G}},"shadowMask.doughnuts":{frame:{...Q({x:15,y:6}),...G}},"lift.static":{frame:{...Q({x:10,y:7}),...G}},"shadow.smallBlock":{frame:{...Q({x:11,y:7}),...G}},"shadowMask.smallBlock":{frame:{...Q({x:12,y:7}),...G}},...Ee("lift",4,Q({x:10,y:8}),G),headlessBase:{frame:{...Q({x:14,y:8}),...G}},...Ee("headlessBase",4,Q({x:10,y:9}),G),"headlessBase.all":{frame:{...Q({x:14,y:9}),...G}},...sn("skiHead.greenAndPink",{x:251,y:252},{w:24,h:32}),...sn("skiHead.starsAndStripes",{x:301,y:252},{w:24,h:32}),"shadowMask.skiHead.away":{frame:{x:351,y:252,w:24,h:32}},"shadowMask.skiHead.right":{frame:{x:351,y:285,w:24,h:32}},"editor.cursor.xz":{frame:{...pe({x:7,y:-2}),...ce}},"editor.cursor.floor":{frame:{...pe({x:7,y:-1}),...ce}},"block.organic":{frame:{...pe({x:0,y:0}),...ce}},"block.organic.disappearing":{frame:{...pe({x:1,y:0}),...ce}},"block.organic.dark":{frame:{...pe({x:2,y:0}),...ce}},"block.organic.dark.disappearing":{frame:{...pe({x:3,y:0}),...ce}},"block.artificial":{frame:{...pe({x:4,y:0}),...ce}},"block.artificial.disappearing":{frame:{...pe({x:5,y:0}),...ce}},"book.x":{frame:{...pe({x:6,y:0}),...ce}},"book.y":{frame:{...pe({x:7,y:0}),...ce}},"shadow.fullBlock":{frame:{...pe({x:8,y:0}),...ce}},"shadowMask.fullBlock":{frame:{...pe({x:9,y:0}),...ce}},stepStool:{frame:{...pe({x:0,y:1}),...ce}},"shadowMask.stepStool":{frame:{...pe({x:1,y:1}),...ce}},"volcano.1":{frame:{...pe({x:2,y:1}),...ce}},"volcano.2":{frame:{...pe({x:3,y:1}),...ce}},"shadowMask.volcano":{frame:{...pe({x:4,y:1}),...ce}},hushPuppy:{frame:{...pe({x:5,y:1}),...ce}},"shadowMask.hushPuppy":{frame:{...pe({x:6,y:1}),...ce}},"toaster.on":{frame:{...pe({x:7,y:1}),...ce}},"toaster.off":{frame:{...pe({x:8,y:1}),...ce}},"shadowMask.toaster":{frame:{...pe({x:9,y:1}),...ce}},sandwich:{frame:{...pe({x:10,y:1}),...ce}},spikes:{frame:{...pe({x:11,y:1}),...ce}},"shadowMask.spikes":{frame:{...pe({x:12,y:1}),...ce}},...Ee("conveyor.x",7,pe({x:0,y:2}),ce),"shadowMask.conveyor":{frame:{...pe({x:7,y:2}),...ce}},button:{frame:{...pe({x:9,y:2}),...ce}},"button.pressed":{frame:{...pe({x:10,y:2}),...ce}},"button.surfaceMask":{frame:{...pe({x:11,y:2}),...ce}},...Ee("conveyor.y",7,pe({x:0,y:3}),ce),teleporter:{frame:{...pe({x:7,y:3}),...ce}},...Ee("teleporter.flashing",2,pe({x:8,y:3}),ce),"shadowMask.teleporter":{frame:{...pe({x:10,y:3}),...ce}},"shadowMask.teleporter.flashing":{frame:{...pe({x:11,y:3}),...ce}},...Ee("particle",4,{x:331,y:396},{w:9,h:11})},lx={frames:V0,animations:{"teleporter.flashing":Ae(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:Ae(["fish.1","fish.2"],.25),lift:Ae(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:Ae(["dalek.1","dalek.2"],.5),"turtle.left":Ae(["turtle.left.1","turtle.left.2"],.25),"turtle.away":Ae(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":Ae(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":Ae(["turtle.right.1","turtle.right.2"],.25),helicopterBug:Ae(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":Ae(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":Ae(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":Ae(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":Ae(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":Ae(ei("conveyor.x",7),.5),"conveyor.y":Ae(ei("conveyor.y",7),.5),volcano:Ae(ei("volcano",2),3/16),"spring.bounce":Ae(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"headlessBase.scan":Ae(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":Ae(["headlessBase.all","headlessBase"],.5),switch:Ae(["switch.left","switch.right"],.02),"particle.fade":Ae(ei("particle",4),.5)}},_0={frames:{"editor.tool.share":{frame:{w:12,h:12,x:588,y:0}},"editor.tool.save":{frame:{w:12,h:12,x:601,y:0}},"editor.tool.pointer":{frame:{w:12,h:12,x:614,y:0}},"editor.tool.eyedropper":{frame:{w:12,h:12,x:628,y:0}}}},S0={...lx.frames,...rx.frames,...nx.frames,...w0.frames,...v0.frames,..._0.frames},er={frames:S0,animations:{...rx.animations,...lx.animations,...nx.animations},meta:{scale:1}},cx="/assets/sprites-tKlsgTBU.png";var ic,Lp;function k0(){if(Lp)return ic;Lp=1;function t(n){if(Array.isArray(n))return!0;var s=n.length;return typeof s=="number"&&s>-1?s?0 in n&&s-1 in n:!0:!1}function e(n){var s=typeof n;return s==="object"?n===null?"null":t(n)?"array":n.constructor===Object?"pure-object":"object":s}function r(n,s){if(n===s||n!==n&&s!==s)return!0;var i=e(n),o=e(s);if(i!==o)return!1;if(i==="pure-object"){if(n===s)return!0;var a=Object.keys(n),l=Object.keys(s).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!s.hasOwnProperty(a[c]))return!1;var d=n[h],f=s[h];if(d===n||f===s||d===s||f===n)return d===f;if(!r(d,f))return!1}return!0}else if(i==="array"){if(n.length===s.length)for(var m=0;m<n.length;m++){var A=n[m],g=s[m];if(A===n||g===s||A===s||g===n)return A===g;if(!r(A,g))return!1}else return!1;return!0}else if(i==="object"){if(n.valueOf!==Object.prototype.valueOf()&&s.valueOf!==Object.prototype.valueOf())return n.valueOf()===s.valueOf();if(n.toString!==Object.prototype.toString()&&s.toString!==Object.prototype.toString())return n.toString()===s.toString()}return!1}return ic=r,ic}var C0=k0();const P0=rt(C0);var oc={exports:{}},ac={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function E0(){if(Up)return ac;Up=1;var t=_s();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,s=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return ac.useSyncExternalStoreWithSelector=function(l,c,u,h,d){var f=s(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=o(function(){function g(V){if(!y){if(y=!0,b=V,V=h(V),d!==void 0&&m.hasValue){var _=m.value;if(d(_,V))return x=_}return x=V}if(_=x,r(b,V))return _;var v=h(V);return d!==void 0&&d(_,v)?(b=V,_):(b=V,x=v)}var y=!1,b,x,q=u===void 0?null:u;return[function(){return g(c())},q===null?void 0:function(){return g(q())}]},[c,u,h,d]);var A=n(l,f[0],f[1]);return i(function(){m.hasValue=!0,m.value=A},[A]),a(A),A},ac}var Hp;function T0(){return Hp||(Hp=1,oc.exports=E0()),oc.exports}var R0=T0();function ux(t){t()}function M0(){let t=null,e=null;return{clear(){t=null,e=null},notify(){ux(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=e={callback:r,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!n||t===null||(n=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var $p={notify(){},get:()=>[]};function I0(t,e){let r,n=$p,s=0,i=!1;function o(A){u();const g=n.subscribe(A);let y=!1;return()=>{y||(y=!0,g(),h())}}function a(){n.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){s++,r||(r=t.subscribe(l),n=M0())}function h(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=$p)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>n};return m}var j0=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",O0=j0(),B0=()=>typeof navigator<"u"&&navigator.product==="ReactNative",z0=B0(),N0=()=>O0||z0?C.useLayoutEffect:C.useEffect,D0=N0();function Wp(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function hi(t,e){if(Wp(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(e,r[s])||!Wp(t[r[s]],e[r[s]]))return!1;return!0}var F0=Symbol.for("react-redux-context"),L0=typeof globalThis<"u"?globalThis:{};function U0(){if(!C.createContext)return{};const t=L0[F0]??=new Map;let e=t.get(C.createContext);return e||(e=C.createContext(null),t.set(C.createContext,e)),e}var Hr=U0();function H0(t){const{children:e,context:r,serverState:n,store:s}=t,i=C.useMemo(()=>{const l=I0(s);return{store:s,subscription:l,getServerState:n?()=>n:void 0}},[s,n]),o=C.useMemo(()=>s.getState(),[s]);D0(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=r||Hr;return C.createElement(a.Provider,{value:i},e)}var $0=H0;function Yh(t=Hr){return function(){return C.useContext(t)}}var hx=Yh();function dx(t=Hr){const e=t===Hr?hx:Yh(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var Kh=dx();function W0(t=Hr){const e=t===Hr?Kh:dx(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var fx=W0(),G0=(t,e)=>t===e;function Q0(t=Hr){const e=t===Hr?hx:Yh(t),r=(n,s={})=>{const{equalityFn:i=G0}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:a,subscription:l,getServerState:c}=o;C.useRef(!0);const u=C.useCallback({[n.name](d){return n(d)}}[n.name],[n]),h=R0.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return C.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var px=Q0(),Y0=ux;const Xh=fx.withTypes(),ae=px.withTypes();Kh.withTypes();const Ge={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},Gp=f0(Ge,([t,e])=>[e,t]),K0={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},X0={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},$t={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},mx=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...Hi],gx=[...mx,...Hi],ta={presses:ks(gx.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[]}},Qp=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Mn(...t){return{presses:t.reduce((e,r)=>{for(const n of gx)e[n]={keys:Qp(e[n]?.keys,r?.presses?.[n]?.keys),gamepadButtons:Qp(e[n]?.gamepadButtons,r?.presses?.[n]?.gamepadButtons)};return e},structuredClone(ta.presses)),axes:{x:Array.from(new Set([...ta.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...ta.axes.y,...t.map(e=>e.axes?.y??[]).flat()]))}}}const In={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape",""]},menu_exit:{gamepadButtons:[Ge.b]},menu_select:{keys:["Enter"],gamepadButtons:[Ge.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},Cs={inputAssignment:Mn(In,{presses:{right:{gamepadButtons:[Ge.dPadRight]},towards:{gamepadButtons:[Ge.dPadDown]},left:{gamepadButtons:[Ge.dPadLeft]},away:{gamepadButtons:[Ge.dPadUp]},jump:{gamepadButtons:[Ge.a,Ge.y]},carry:{gamepadButtons:[Ge.x,Ge.y]},fire:{gamepadButtons:[Ge.b]},swop:{gamepadButtons:[Ge.rb]},"swop.head":{gamepadButtons:[Ge.l3]},"swop.heels":{gamepadButtons:[Ge.r3]},hold:{gamepadButtons:[Ge.start]},menu_openOrExit:{gamepadButtons:[Ge.select]},map:{gamepadButtons:[Ge.lb]},toggleColourisation:{gamepadButtons:[Ge.lt]}},axes:{x:[0],y:[1]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},J0={inputAssignment:Mn(In,Cs.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},Z0={inputAssignment:Mn(In,Cs.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},e_={inputAssignment:Mn(In,Cs.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M","Tab"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},t_={inputAssignment:Mn(In,Cs.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},r_={inputAssignment:Mn(In,Cs.inputAssignment,{presses:{right:{keys:[$t.dPadRight]},towards:{keys:[$t.dPadDown]},left:{keys:[$t.dPadLeft]},away:{keys:[$t.dPadUp]},jump:{keys:[$t.a,$t.y]},carry:{keys:[$t.b,$t.y]},fire:{keys:[$t.x]},swop:{keys:[$t.rb]},hold:{keys:[$t.start]},menu_openOrExit:{keys:[$t.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that dont support controllers"},Yp=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]}}}),n_={inputAssignment:Mn(ta,In,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},Yp(K0),Yp(X0)),description:"MAME key mappings. For arcade-style control panels"},ps={default:e_,"zx spectrum":J0,amiga:Z0,mame:n_,wasd:t_," 8bitdo keyboard mode":r_," joystick":Cs},Ue=()=>St()==="mobile"||St()==="tablet",St=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},s_=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Jh={inputAssignment:ps.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:St()==="mobile"?"handheld":"zxSpectrum"},showFps:!1,onScreenControls:St()==="mobile"||St()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1,soundSettings:{mute:!1,noFootsteps:!1}},fa=(t,e)=>e.split(".").reduce((r,n)=>r[n],t),i_=(t,e,r)=>{const n=e.split(".");let s=t;for(let i=0;i<n.length-1;i++){const o=n[i];s=s[o]}s[n[n.length-1]]=r};function it(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var o_=typeof Symbol=="function"&&Symbol.observable||"@@observable",Kp=o_,lc=()=>Math.random().toString(36).substring(7).split("").join("."),a_={INIT:`@@redux/INIT${lc()}`,REPLACE:`@@redux/REPLACE${lc()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${lc()}`},pa=a_;function ms(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Zh(t,e,r){if(typeof t!="function")throw new Error(it(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(it(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(it(1));return r(Zh)(t,e)}let n=t,s=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(l)throw new Error(it(3));return s}function h(g){if(typeof g!="function")throw new Error(it(4));if(l)throw new Error(it(5));let y=!0;c();const b=a++;return o.set(b,g),function(){if(y){if(l)throw new Error(it(6));y=!1,c(),o.delete(b),i=null}}}function d(g){if(!ms(g))throw new Error(it(7));if(typeof g.type>"u")throw new Error(it(8));if(typeof g.type!="string")throw new Error(it(17));if(l)throw new Error(it(9));try{l=!0,s=n(s,g)}finally{l=!1}return(i=o).forEach(b=>{b()}),g}function f(g){if(typeof g!="function")throw new Error(it(10));n=g,d({type:pa.REPLACE})}function m(){const g=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(it(11));function b(){const q=y;q.next&&q.next(u())}return b(),{unsubscribe:g(b)}},[Kp](){return this}}}return d({type:pa.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[Kp]:m}}function l_(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:pa.INIT})>"u")throw new Error(it(12));if(typeof r(void 0,{type:pa.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(it(13))})}function ed(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let s;try{l_(r)}catch(i){s=i}return function(o={},a){if(s)throw s;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],d=r[h],f=o[h],m=d(f,a);if(typeof m>"u")throw a&&a.type,new Error(it(14));c[h]=m,l=l||m!==f}return l=l||n.length!==Object.keys(o).length,l?c:o}}function ma(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function c_(...t){return e=>(r,n)=>{const s=e(r,n);let i=()=>{throw new Error(it(15))};const o={getState:s.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=ma(...a)(s.dispatch),{...s,dispatch:i}}}function td(t){return ms(t)&&"type"in t&&typeof t.type=="string"}var rd=Symbol.for("immer-nothing"),di=Symbol.for("immer-draftable"),Ct=Symbol.for("immer-state");function at(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var _n=Object.getPrototypeOf;function hr(t){return!!t&&!!t[Ct]}function nr(t){return t?Ax(t)||Array.isArray(t)||!!t[di]||!!t.constructor?.[di]||Qi(t)||Yi(t):!1}var u_=Object.prototype.constructor.toString();function Ax(t){if(!t||typeof t!="object")return!1;const e=_n(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===u_}function h_(t){return hr(t)||at(15,t),t[Ct].base_}function qi(t,e){Sn(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function Sn(t){const e=t[Ct];return e?e.type_:Array.isArray(t)?1:Qi(t)?2:Yi(t)?3:0}function wi(t,e){return Sn(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function cc(t,e){return Sn(t)===2?t.get(e):t[e]}function yx(t,e,r){const n=Sn(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function d_(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Qi(t){return t instanceof Map}function Yi(t){return t instanceof Set}function cn(t){return t.copy_||t.base_}function ku(t,e){if(Qi(t))return new Map(t);if(Yi(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Ax(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ct];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const o=s[i],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(_n(t),n)}else{const n=_n(t);if(n!==null&&r)return{...t};const s=Object.create(n);return Object.assign(s,t)}}function nd(t,e=!1){return Ha(t)||hr(t)||!nr(t)||(Sn(t)>1&&(t.set=t.add=t.clear=t.delete=f_),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>nd(n,!0))),t}function f_(){at(2)}function Ha(t){return Object.isFrozen(t)}var Cu={};function kn(t){const e=Cu[t];return e||at(0,t),e}function p_(t,e){Cu[t]||(Cu[t]=e)}var vi;function xx(){return vi}function m_(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Xp(t,e){e&&(kn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Pu(t){Eu(t),t.drafts_.forEach(g_),t.drafts_=null}function Eu(t){t===vi&&(vi=t.parent_)}function Jp(t){return vi=m_(vi,t)}function g_(t){const e=t[Ct];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Zp(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ct].modified_&&(Pu(e),at(4)),nr(t)&&(t=ga(e,t),e.parent_||Aa(e,t)),e.patches_&&kn("Patches").generateReplacementPatches_(r[Ct].base_,t,e.patches_,e.inversePatches_)):t=ga(e,r,[]),Pu(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==rd?t:void 0}function ga(t,e,r){if(Ha(e))return e;const n=e[Ct];if(!n)return qi(e,(s,i)=>em(t,n,e,s,i,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return Aa(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,o=!1;n.type_===3&&(i=new Set(s),s.clear(),o=!0),qi(i,(a,l)=>em(t,n,s,a,l,r,o)),Aa(t,s,!1),r&&t.patches_&&kn("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function em(t,e,r,n,s,i,o){if(hr(s)){const a=i&&e&&e.type_!==3&&!wi(e.assigned_,n)?i.concat(n):void 0,l=ga(t,s,a);if(yx(r,n,l),hr(l))t.canAutoFreeze_=!1;else return}else o&&r.add(s);if(nr(s)&&!Ha(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ga(t,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Aa(t,s)}}function Aa(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&nd(e,r)}function A_(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:xx(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=sd;r&&(s=[n],i=Vi);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return n.draft_=a,n.revoke_=o,a}var sd={get(t,e){if(e===Ct)return t;const r=cn(t);if(!wi(r,e))return y_(t,r,e);const n=r[e];return t.finalized_||!nr(n)?n:n===uc(t.base_,e)?(hc(t),t.copy_[e]=Ru(n,t)):n},has(t,e){return e in cn(t)},ownKeys(t){return Reflect.ownKeys(cn(t))},set(t,e,r){const n=bx(cn(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const s=uc(cn(t),e),i=s?.[Ct];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(d_(r,s)&&(r!==void 0||wi(t.base_,e)))return!0;hc(t),Tu(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return uc(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,hc(t),Tu(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=cn(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){at(11)},getPrototypeOf(t){return _n(t.base_)},setPrototypeOf(){at(12)}},Vi={};qi(sd,(t,e)=>{Vi[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Vi.deleteProperty=function(t,e){return Vi.set.call(this,t,e,void 0)};Vi.set=function(t,e,r){return sd.set.call(this,t[0],e,r,t[0])};function uc(t,e){const r=t[Ct];return(r?cn(r):t)[e]}function y_(t,e,r){const n=bx(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function bx(t,e){if(!(e in t))return;let r=_n(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=_n(r)}}function Tu(t){t.modified_||(t.modified_=!0,t.parent_&&Tu(t.parent_))}function hc(t){t.copy_||(t.copy_=ku(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var x_=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(l=i,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&at(6),n!==void 0&&typeof n!="function"&&at(7);let s;if(nr(e)){const i=Jp(this),o=Ru(e,void 0);let a=!0;try{s=r(o),a=!1}finally{a?Pu(i):Eu(i)}return Xp(i,n),Zp(s,i)}else if(!e||typeof e!="object"){if(s=r(e),s===void 0&&(s=e),s===rd&&(s=void 0),this.autoFreeze_&&nd(s,!0),n){const i=[],o=[];kn("Patches").generateReplacementPatches_(e,s,i,o),n(i,o)}return s}else at(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let n,s;return[this.produce(e,r,(o,a)=>{n=o,s=a}),n,s]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){nr(t)||at(8),hr(t)&&(t=b_(t));const e=Jp(this),r=Ru(t,void 0);return r[Ct].isManual_=!0,Eu(e),r}finishDraft(t,e){const r=t&&t[Ct];(!r||!r.isManual_)&&at(9);const{scope_:n}=r;return Xp(n,e),Zp(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const s=e[r];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}r>-1&&(e=e.slice(r+1));const n=kn("Patches").applyPatches_;return hr(t)?n(t,e):this.produce(t,s=>n(s,e))}};function Ru(t,e){const r=Qi(t)?kn("MapSet").proxyMap_(t,e):Yi(t)?kn("MapSet").proxySet_(t,e):A_(t,e);return(e?e.scope_:xx()).drafts_.push(r),r}function b_(t){return hr(t)||at(10,t),qx(t)}function qx(t){if(!nr(t)||Ha(t))return t;const e=t[Ct];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=ku(t,e.scope_.immer_.useStrictShallowCopy_)}else r=ku(t,!0);return qi(r,(n,s)=>{yx(r,n,qx(s))}),e&&(e.finalized_=!1),r}function q_(){const e="replace",r="add",n="remove";function s(d,f,m,A){switch(d.type_){case 0:case 2:return o(d,f,m,A);case 1:return i(d,f,m,A);case 3:return a(d,f,m,A)}}function i(d,f,m,A){let{base_:g,assigned_:y}=d,b=d.copy_;b.length<g.length&&([g,b]=[b,g],[m,A]=[A,m]);for(let x=0;x<g.length;x++)if(y[x]&&b[x]!==g[x]){const q=f.concat([x]);m.push({op:e,path:q,value:h(b[x])}),A.push({op:e,path:q,value:h(g[x])})}for(let x=g.length;x<b.length;x++){const q=f.concat([x]);m.push({op:r,path:q,value:h(b[x])})}for(let x=b.length-1;g.length<=x;--x){const q=f.concat([x]);A.push({op:n,path:q})}}function o(d,f,m,A){const{base_:g,copy_:y}=d;qi(d.assigned_,(b,x)=>{const q=cc(g,b),V=cc(y,b),_=x?wi(g,b)?e:r:n;if(q===V&&_===e)return;const v=f.concat(b);m.push(_===n?{op:_,path:v}:{op:_,path:v,value:V}),A.push(_===r?{op:n,path:v}:_===n?{op:r,path:v,value:h(q)}:{op:e,path:v,value:h(q)})})}function a(d,f,m,A){let{base_:g,copy_:y}=d,b=0;g.forEach(x=>{if(!y.has(x)){const q=f.concat([b]);m.push({op:n,path:q,value:x}),A.unshift({op:r,path:q,value:x})}b++}),b=0,y.forEach(x=>{if(!g.has(x)){const q=f.concat([b]);m.push({op:r,path:q,value:x}),A.unshift({op:n,path:q,value:x})}b++})}function l(d,f,m,A){m.push({op:e,path:[],value:f===rd?void 0:f}),A.push({op:e,path:[],value:d})}function c(d,f){return f.forEach(m=>{const{path:A,op:g}=m;let y=d;for(let V=0;V<A.length-1;V++){const _=Sn(y);let v=A[V];typeof v!="string"&&typeof v!="number"&&(v=""+v),(_===0||_===1)&&(v==="__proto__"||v==="constructor")&&at(19),typeof y=="function"&&v==="prototype"&&at(19),y=cc(y,v),typeof y!="object"&&at(18,A.join("/"))}const b=Sn(y),x=u(m.value),q=A[A.length-1];switch(g){case e:switch(b){case 2:return y.set(q,x);case 3:at(16);default:return y[q]=x}case r:switch(b){case 1:return q==="-"?y.push(x):y.splice(q,0,x);case 2:return y.set(q,x);case 3:return y.add(x);default:return y[q]=x}case n:switch(b){case 1:return y.splice(q,1);case 2:return y.delete(q);case 3:return y.delete(m.value);default:return delete y[q]}default:at(17,g)}}),d}function u(d){if(!nr(d))return d;if(Array.isArray(d))return d.map(u);if(Qi(d))return new Map(Array.from(d.entries()).map(([m,A])=>[m,u(A)]));if(Yi(d))return new Set(Array.from(d).map(u));const f=Object.create(_n(d));for(const m in d)f[m]=u(d[m]);return wi(d,di)&&(f[di]=d[di]),f}function h(d){return hr(d)?u(d):d}p_("Patches",{applyPatches_:c,generatePatches_:s,generateReplacementPatches_:l})}var Ut=new x_,Ps=Ut.produce,wx=Ut.produceWithPatches.bind(Ut);Ut.setAutoFreeze.bind(Ut);Ut.setUseStrictShallowCopy.bind(Ut);var tm=Ut.applyPatches.bind(Ut);Ut.createDraft.bind(Ut);Ut.finishDraft.bind(Ut);function w_(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function v_(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function V_(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var rm=t=>Array.isArray(t)?t:[t];function __(t){const e=Array.isArray(t[0])?t[0]:t;return V_(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function S_(t,e){const r=[],{length:n}=t;for(let s=0;s<n;s++)r.push(t[s].apply(null,e));return r}var k_=class{constructor(t){this.value=t}deref(){return this.value}},C_=typeof WeakRef<"u"?WeakRef:k_,P_=0,nm=1;function qo(){return{s:P_,v:void 0,o:null,p:null}}function ya(t,e={}){let r=qo();const{resultEqualityCheck:n}=e;let s,i=0;function o(){let a=r;const{length:l}=arguments;for(let h=0,d=l;h<d;h++){const f=arguments[h];if(typeof f=="function"||typeof f=="object"&&f!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const A=m.get(f);A===void 0?(a=qo(),m.set(f,a)):a=A}else{let m=a.p;m===null&&(a.p=m=new Map);const A=m.get(f);A===void 0?(a=qo(),m.set(f,a)):a=A}}const c=a;let u;if(a.s===nm)u=a.v;else if(u=t.apply(null,arguments),i++,n){const h=s?.deref?.()??s;h!=null&&n(h,u)&&(u=h,i!==0&&i--),s=typeof u=="object"&&u!==null||typeof u=="function"?new C_(u):u}return c.s=nm,c.v=u,u}return o.clearCache=()=>{r=qo(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function E_(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...s)=>{let i=0,o=0,a,l={},c=s.pop();typeof c=="object"&&(l=c,c=s.pop()),w_(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=ya,argsMemoizeOptions:m=[]}=u,A=rm(d),g=rm(m),y=__(s),b=h(function(){return i++,c.apply(null,arguments)},...A),x=f(function(){o++;const V=S_(y,arguments);return a=b.apply(null,V),a},...g);return Object.assign(x,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:f})};return Object.assign(n,{withTypes:()=>n}),n}var id=E_(ya),T_=Object.assign((t,e=id)=>{v_(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(i=>t[i]);return e(n,(...i)=>i.reduce((o,a,l)=>(o[r[l]]=a,o),{}))},{withTypes:()=>T_});function vx(t){return({dispatch:r,getState:n})=>s=>i=>typeof i=="function"?i(r,n,t):s(i)}var R_=vx(),M_=vx,I_=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ma:ma.apply(null,arguments)},j_=t=>t&&typeof t.match=="function";function bt(t,e){function r(...n){if(e){let s=e(...n);if(!s)throw new Error(tt(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>td(n)&&n.type===t,r}var Vx=class ti extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ti.prototype)}static get[Symbol.species](){return ti}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ti(...e[0].concat(this)):new ti(...e.concat(this))}};function sm(t){return nr(t)?Ps(t,()=>{}):t}function Mu(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function O_(t){return typeof t=="boolean"}var B_=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new Vx;return r&&(O_(r)?o.push(R_):o.push(M_(r.extraArgument))),o},$a="RTK_autoBatch",Us=()=>t=>({payload:t,meta:{[$a]:!0}}),im=t=>e=>{setTimeout(e,t)},z_=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let s=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:im(10):t.type==="callback"?t.queueNotification:im(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>s&&u(),d=n.subscribe(h);return a.add(u),()=>{d(),a.delete(u)}},dispatch(u){try{return s=!u?.meta?.[$a],i=!s,i&&(o||(o=!0,l(c))),n.dispatch(u)}finally{s=!0}}})},N_=t=>function(r){const{autoBatch:n=!0}=r??{};let s=new Vx(t);return n&&s.push(z_(typeof n=="object"?n:void 0)),s};function D_(t){const e=B_(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(ms(r))a=ed(r);else throw new Error(tt(1));let l;typeof n=="function"?l=n(e):l=e();let c=ma;s&&(c=I_({trace:!1,...typeof s=="object"&&s}));const u=c_(...l),h=N_(u);let d=typeof o=="function"?o(h):h();const f=c(...d);return Zh(a,i,f)}function _x(t){const e={},r=[];let n;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(tt(28));if(a in e)throw new Error(tt(29));return e[a]=o,s},addMatcher(i,o){return r.push({matcher:i,reducer:o}),s},addDefaultCase(i){return n=i,s}};return t(s),[e,r,n]}function F_(t){return typeof t=="function"}function L_(t,e){let[r,n,s]=_x(e),i;if(F_(t))i=()=>sm(t());else{const a=sm(t);i=()=>a}function o(a=i(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[s]),c.reduce((u,h)=>{if(h)if(hr(u)){const f=h(u,l);return f===void 0?u:f}else{if(nr(u))return Ps(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return d}}return u},a)}return o.getInitialState=i,o}var Sx=(t,e)=>j_(t)?t.match(e):t(e);function Er(...t){return e=>t.some(r=>Sx(r,e))}function fi(...t){return e=>t.every(r=>Sx(r,e))}function Wa(t,e){if(!t||!t.meta)return!1;const r=typeof t.meta.requestId=="string",n=e.indexOf(t.meta.requestStatus)>-1;return r&&n}function Ki(t){return typeof t[0]=="function"&&"pending"in t[0]&&"fulfilled"in t[0]&&"rejected"in t[0]}function od(...t){return t.length===0?e=>Wa(e,["pending"]):Ki(t)?Er(...t.map(e=>e.pending)):od()(t[0])}function gs(...t){return t.length===0?e=>Wa(e,["rejected"]):Ki(t)?Er(...t.map(e=>e.rejected)):gs()(t[0])}function Ga(...t){const e=r=>r&&r.meta&&r.meta.rejectedWithValue;return t.length===0?fi(gs(...t),e):Ki(t)?fi(gs(...t),e):Ga()(t[0])}function $r(...t){return t.length===0?e=>Wa(e,["fulfilled"]):Ki(t)?Er(...t.map(e=>e.fulfilled)):$r()(t[0])}function Iu(...t){return t.length===0?e=>Wa(e,["pending","fulfilled","rejected"]):Ki(t)?Er(...t.flatMap(e=>[e.pending,e.rejected,e.fulfilled])):Iu()(t[0])}var U_="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Xi=(t=21)=>{let e="",r=t;for(;r--;)e+=U_[Math.random()*64|0];return e},H_=["name","message","stack","code"],dc=class{constructor(t,e){this.payload=t,this.meta=e}_type},om=class{constructor(t,e){this.payload=t,this.meta=e}_type},$_=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of H_)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},am="External signal was aborted",lm=(()=>{function t(e,r,n){const s=bt(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=bt(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=bt(e+"/rejected",(l,c,u,h,d)=>({payload:h,error:(n&&n.serializeError||$_)(l||"Rejected"),meta:{...d||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,d)=>{const f=n?.idGenerator?n.idGenerator(l):Xi(),m=new AbortController;let A,g;function y(x){g=x,m.abort()}c&&(c.aborted?y(am):c.addEventListener("abort",()=>y(am),{once:!0}));const b=async function(){let x;try{let V=n?.condition?.(l,{getState:h,extra:d});if(G_(V)&&(V=await V),V===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const _=new Promise((v,S)=>{A=()=>{S({name:"AbortError",message:g||"Aborted"})},m.signal.addEventListener("abort",A)});u(i(f,l,n?.getPendingMeta?.({requestId:f,arg:l},{getState:h,extra:d}))),x=await Promise.race([_,Promise.resolve(r(l,{dispatch:u,getState:h,extra:d,requestId:f,signal:m.signal,abort:y,rejectWithValue:(v,S)=>new dc(v,S),fulfillWithValue:(v,S)=>new om(v,S)})).then(v=>{if(v instanceof dc)throw v;return v instanceof om?s(v.payload,f,l,v.meta):s(v,f,l)})])}catch(V){x=V instanceof dc?o(null,f,l,V.payload,V.meta):o(V,f,l)}finally{A&&m.signal.removeEventListener("abort",A)}return n&&!n.dispatchConditionRejection&&o.match(x)&&x.meta.condition||u(x),x}();return Object.assign(b,{abort:y,requestId:f,arg:l,unwrap(){return b.then(W_)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:s,settled:Er(o,s),typePrefix:e})}return t.withTypes=()=>t,t})();function W_(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function G_(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var Q_=Symbol.for("rtk-slice-createasyncthunk");function Y_(t,e){return`${t}/${e}`}function K_({creators:t}={}){const e=t?.asyncThunk?.[Q_];return function(n){const{name:s,reducerPath:i=s}=n;if(!s)throw new Error(tt(11));const o=(typeof n.reducers=="function"?n.reducers(J_()):n.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(b,x){const q=typeof b=="string"?b:b.type;if(!q)throw new Error(tt(12));if(q in l.sliceCaseReducersByType)throw new Error(tt(13));return l.sliceCaseReducersByType[q]=x,c},addMatcher(b,x){return l.sliceMatchers.push({matcher:b,reducer:x}),c},exposeAction(b,x){return l.actionCreators[b]=x,c},exposeCaseReducer(b,x){return l.sliceCaseReducersByName[b]=x,c}};a.forEach(b=>{const x=o[b],q={reducerName:b,type:Y_(s,b),createNotation:typeof n.reducers=="function"};eS(x)?rS(q,x,c,e):Z_(q,x,c)});function u(){const[b={},x=[],q=void 0]=typeof n.extraReducers=="function"?_x(n.extraReducers):[n.extraReducers],V={...b,...l.sliceCaseReducersByType};return L_(n.initialState,_=>{for(let v in V)_.addCase(v,V[v]);for(let v of l.sliceMatchers)_.addMatcher(v.matcher,v.reducer);for(let v of x)_.addMatcher(v.matcher,v.reducer);q&&_.addDefaultCase(q)})}const h=b=>b,d=new Map;let f;function m(b,x){return f||(f=u()),f(b,x)}function A(){return f||(f=u()),f.getInitialState()}function g(b,x=!1){function q(_){let v=_[b];return typeof v>"u"&&x&&(v=A()),v}function V(_=h){const v=Mu(d,x,()=>new WeakMap);return Mu(v,_,()=>{const S={};for(const[E,R]of Object.entries(n.selectors??{}))S[E]=X_(R,_,A,x);return S})}return{reducerPath:b,getSelectors:V,get selectors(){return V(q)},selectSlice:q}}const y={name:s,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:A,...g(i),injectInto(b,{reducerPath:x,...q}={}){const V=x??i;return b.inject({reducerPath:V,reducer:m},q),{...y,...g(V,!0)}}};return y}}function X_(t,e,r,n){function s(i,...o){let a=e(i);return typeof a>"u"&&n&&(a=r()),t(a,...o)}return s.unwrapped=t,s}var wr=K_();function J_(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function Z_({type:t,reducerName:e,createNotation:r},n,s){let i,o;if("reducer"in n){if(r&&!tS(n))throw new Error(tt(17));i=n.reducer,o=n.prepare}else i=n;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?bt(t,o):bt(t))}function eS(t){return t._reducerDefinitionType==="asyncThunk"}function tS(t){return t._reducerDefinitionType==="reducerWithPrepare"}function rS({type:t,reducerName:e},r,n,s){if(!s)throw new Error(tt(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=s(t,i,u);n.exposeAction(e,h),o&&n.addCase(h.fulfilled,o),a&&n.addCase(h.pending,a),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(e,{fulfilled:o||wo,pending:a||wo,rejected:l||wo,settled:c||wo})}function wo(){}var nS="task",kx="listener",Cx="completed",ad="cancelled",sS=`task-${ad}`,iS=`task-${Cx}`,ju=`${kx}-${ad}`,oS=`${kx}-${Cx}`,Qa=class{constructor(t){this.code=t,this.message=`${nS} ${ad} (reason: ${t})`}name="TaskAbortError";message},ld=(t,e)=>{if(typeof t!="function")throw new TypeError(tt(32))},xa=()=>{},Px=(t,e=xa)=>(t.catch(e),t),Ex=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),wn=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},vn=t=>{if(t.aborted){const{reason:e}=t;throw new Qa(e)}};function Tx(t,e){let r=xa;return new Promise((n,s)=>{const i=()=>s(new Qa(t.reason));if(t.aborted){i();return}r=Ex(t,i),e.finally(()=>r()).then(n,s)}).finally(()=>{r=xa})}var aS=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Qa?"cancelled":"rejected",error:r}}finally{e?.()}},ba=t=>e=>Px(Tx(t,e).then(r=>(vn(t),r))),Rx=t=>{const e=ba(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:is}=Object,cm={},Ya="listenerMiddleware",lS=(t,e)=>{const r=n=>Ex(t,()=>wn(n,t.reason));return(n,s)=>{ld(n);const i=new AbortController;r(i);const o=aS(async()=>{vn(t),vn(i.signal);const a=await n({pause:ba(i.signal),delay:Rx(i.signal),signal:i.signal});return vn(i.signal),a},()=>wn(i,iS));return s?.autoJoin&&e.push(o.catch(xa)),{result:ba(t)(o),cancel(){wn(i,sS)}}}},cS=(t,e)=>{const r=async(n,s)=>{vn(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:n,effect:(h,d)=>{d.unsubscribe(),l([h,d.getState(),d.getOriginalState()])}});i=()=>{u(),c()}})];s!=null&&a.push(new Promise(l=>setTimeout(l,s,null)));try{const l=await Tx(e,Promise.race(a));return vn(e),l}finally{i()}};return(n,s)=>Px(r(n,s))},Mx=t=>{let{type:e,actionCreator:r,matcher:n,predicate:s,effect:i}=t;if(e)s=bt(e).match;else if(r)e=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(tt(21));return ld(i),{predicate:s,type:e,effect:i}},Ix=is(t=>{const{type:e,predicate:r,effect:n}=Mx(t);return{id:Xi(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(tt(22))}}},{withTypes:()=>Ix}),um=(t,e)=>{const{type:r,effect:n,predicate:s}=Mx(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===s)&&i.effect===n)},Ou=t=>{t.pending.forEach(e=>{wn(e,ju)})},uS=t=>()=>{t.forEach(Ou),t.clear()},hm=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},jx=is(bt(`${Ya}/add`),{withTypes:()=>jx}),hS=bt(`${Ya}/removeAll`),Ox=is(bt(`${Ya}/remove`),{withTypes:()=>Ox}),dS=(...t)=>{console.error(`${Ya}/error`,...t)},fS=(t={})=>{const e=new Map,{extra:r,onError:n=dS}=t;ld(n);const s=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Ou(u)}),i=u=>{const h=um(e,u)??Ix(u);return s(h)};is(i,{withTypes:()=>i});const o=u=>{const h=um(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Ou(h)),!!h};is(o,{withTypes:()=>o});const a=async(u,h,d,f)=>{const m=new AbortController,A=cS(i,m.signal),g=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,is({},d,{getOriginalState:f,condition:(y,b)=>A(y,b).then(Boolean),take:A,delay:Rx(m.signal),pause:ba(m.signal),extra:r,signal:m.signal,fork:lS(m.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,b,x)=>{y!==m&&(wn(y,ju),x.delete(y))})},cancel:()=>{wn(m,ju),u.pending.delete(m)},throwIfCancelled:()=>{vn(m.signal)}})))}catch(y){y instanceof Qa||hm(n,y,{raisedBy:"effect"})}finally{await Promise.all(g),wn(m,oS),u.pending.delete(m)}},l=uS(e);return{middleware:u=>h=>d=>{if(!td(d))return h(d);if(jx.match(d))return i(d.payload);if(hS.match(d)){l();return}if(Ox.match(d))return o(d.payload);let f=u.getState();const m=()=>{if(f===cm)throw new Error(tt(23));return f};let A;try{if(A=h(d),e.size>0){const g=u.getState(),y=Array.from(e.values());for(const b of y){let x=!1;try{x=b.predicate(d,g,f)}catch(q){x=!1,hm(n,q,{raisedBy:"predicate"})}x&&a(b,d,u,m)}}}finally{f=cm}return A},startListening:i,stopListening:o,clearListeners:l}},pS=t=>"reducerPath"in t&&typeof t.reducerPath=="string",mS=t=>t.flatMap(e=>pS(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),cd=Symbol.for("rtk-state-proxy-original"),gS=t=>!!t&&!!t[cd],AS=new WeakMap,yS=(t,e)=>Mu(AS,t,()=>new Proxy(t,{get:(r,n,s)=>{if(n===cd)return r;const i=Reflect.get(r,n,s);if(typeof i>"u"){const o=e[n.toString()];if(o){const a=o(void 0,{type:Xi()});if(typeof a>"u")throw new Error(tt(24));return a}}return i}})),xS=t=>{if(!gS(t))throw new Error(tt(25));return t[cd]},bS=(t={})=>t;function qS(...t){const e=Object.fromEntries(mS(t)),r=()=>Object.keys(e).length?ed(e):bS;let n=r();function s(a,l){return n(a,l)}s.withLazyLoadedSlices=()=>s;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,n=r()),s},o=Object.assign(function(l,c){return function(h,...d){return l(yS(c?c(h,...d):h,e),...d)}},{original:xS});return Object.assign(s,{inject:i,selector:o})}function tt(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const wS=t=>St()==="server"?Ss.zxSpectrum:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},ud=(t,e)=>{const r=St();return{renderAreaSize:wS(e),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio}},vS=8,Bx=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:n=St()})=>{const s=Ss[e],{renderAreaSize:i,rotate90:o}=n!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},a=Fh(i,r),l=Math.max(Math.floor(Math.min(a.x/s.x,a.y/s.y)),1),c=Math.min(vS,l),u=l/c/r,h={x:Math.floor(a.x/l),y:Math.floor(a.y/l)},d={x:Math.ceil(i.x/u),y:Math.ceil(i.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:h,canvasSize:d,rotate90:o}},VS={upscale:Bx(ud(Jh.displaySettings.emulatedResolution))},qa=wr({name:"upscale",initialState:VS,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=Bx(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:zx}=qa.actions,{selectCanvasSize:_S,selectRot90:SS,selectUpscale:kS,selectGameEngineUpscale:HF,selectTotalUpscale:CS,selectGameEngineScreenSize:$F}=qa.selectors;var Nx=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(Nx||{});function dm(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var fm=ms;function Dx(t,e){if(t===e||!(fm(t)&&fm(e)||Array.isArray(t)&&Array.isArray(e)))return e;const r=Object.keys(e),n=Object.keys(t);let s=r.length===n.length;const i=Array.isArray(e)?[]:{};for(const o of r)i[o]=Dx(t[o],e[o]),s&&(s=t[o]===i[o]);return s?t:i}function os(t){let e=0;for(const r in t)e++;return e}var pm=t=>[].concat(...t);function PS(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function wa(t){return t!=null}function ES(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}function TS(t,e,r){return t.has(e)?t.get(e):t.set(e,r).get(e)}var mm=class{constructor(t,e=void 0){this.value=t,this.meta=e}},hd=bt("__rtkq/focused"),Fx=bt("__rtkq/unfocused"),dd=bt("__rtkq/online"),Lx=bt("__rtkq/offline");function fd(t){return t.type==="query"}function RS(t){return t.type==="mutation"}function pd(t){return t.type==="infinitequery"}function md(t,e,r,n,s,i){return MS(t)?t(e,r,n,s).filter(wa).map(Bu).map(i):Array.isArray(t)?t.map(Bu).map(i):[]}function MS(t){return typeof t=="function"}function Bu(t){return typeof t=="string"?{type:t}:t}function IS(t,e){return t.catch(e)}var _i=Symbol("forceQueryFn"),zu=t=>typeof t[_i]=="function";function jS({serializeQueryArgs:t,queryThunk:e,infiniteQueryThunk:r,mutationThunk:n,api:s,context:i}){const o=new Map,a=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:u}=s.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:y,buildInitiateMutation:b,getRunningQueryThunk:h,getRunningMutationThunk:d,getRunningQueriesThunk:f,getRunningMutationsThunk:m};function h(x,q){return V=>{const _=i.endpointDefinitions[x],v=t({queryArgs:q,endpointDefinition:_,endpointName:x});return o.get(V)?.[v]}}function d(x,q){return V=>a.get(V)?.[q]}function f(){return x=>Object.values(o.get(x)||{}).filter(wa)}function m(){return x=>Object.values(a.get(x)||{}).filter(wa)}function A(x,q){const V=(_,{subscribe:v=!0,forceRefetch:S,subscriptionOptions:E,[_i]:R,...I}={})=>(B,N)=>{const D=t({queryArgs:_,endpointDefinition:q,endpointName:x});let U;const w={...I,type:"query",subscribe:v,forceRefetch:S,subscriptionOptions:E,endpointName:x,originalArgs:_,queryCacheKey:D,[_i]:R};if(fd(q))U=e(w);else{const{direction:W,initialPageParam:Y}=I;U=r({...w,direction:W,initialPageParam:Y})}const k=s.endpoints[x].select(_),P=B(U),M=k(N()),{requestId:T,abort:j}=P,O=M.requestId!==T,z=o.get(B)?.[D],F=()=>k(N()),L=Object.assign(R?P.then(F):O&&!z?Promise.resolve(M):Promise.all([z,P]).then(F),{arg:_,requestId:T,subscriptionOptions:E,queryCacheKey:D,abort:j,async unwrap(){const W=await L;if(W.isError)throw W.error;return W.data},refetch:()=>B(V(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){v&&B(l({queryCacheKey:D,requestId:T}))},updateSubscriptionOptions(W){L.subscriptionOptions=W,B(u({endpointName:x,requestId:T,queryCacheKey:D,options:W}))}});if(!z&&!O&&!R){const W=TS(o,B,{});W[D]=L,L.then(()=>{delete W[D],os(W)||o.delete(B)})}return L};return V}function g(x,q){return A(x,q)}function y(x,q){return A(x,q)}function b(x){return(q,{track:V=!0,fixedCacheKey:_}={})=>(v,S)=>{const E=n({type:"mutation",endpointName:x,originalArgs:q,track:V,fixedCacheKey:_}),R=v(E),{requestId:I,abort:B,unwrap:N}=R,D=IS(R.unwrap().then(P=>({data:P})),P=>({error:P})),U=()=>{v(c({requestId:I,fixedCacheKey:_}))},w=Object.assign(D,{arg:R.arg,requestId:I,abort:B,unwrap:N,reset:U}),k=a.get(v)||{};return a.set(v,k),k[I]=w,w.then(()=>{delete k[I],os(k)||a.delete(v)}),_&&(k[_]=w,w.then(()=>{k[_]===w&&(delete k[_],os(k)||a.delete(v))})),w}}}function OS(t){return t}var vo=(t={})=>({...t,[$a]:!0});function BS({reducerPath:t,baseQuery:e,context:{endpointDefinitions:r},serializeQueryArgs:n,api:s,assertTagType:i,selectors:o}){const a=(S,E,R,I)=>(B,N)=>{const D=r[S],U=n({queryArgs:E,endpointDefinition:D,endpointName:S});if(B(s.internalActions.queryResultPatched({queryCacheKey:U,patches:R})),!I)return;const w=s.endpoints[S].select(E)(N()),k=md(D.providesTags,w.data,void 0,E,{},i);B(s.internalActions.updateProvidedBy({queryCacheKey:U,providedTags:k}))};function l(S,E,R=0){const I=[E,...S];return R&&I.length>R?I.slice(0,-1):I}function c(S,E,R=0){const I=[...S,E];return R&&I.length>R?I.slice(1):I}const u=(S,E,R,I=!0)=>(B,N)=>{const U=s.endpoints[S].select(E)(N()),w={patches:[],inversePatches:[],undo:()=>B(s.util.patchQueryData(S,E,w.inversePatches,I))};if(U.status==="uninitialized")return w;let k;if("data"in U)if(nr(U.data)){const[P,M,T]=wx(U.data,R);w.patches.push(...M),w.inversePatches.push(...T),k=P}else k=R(U.data),w.patches.push({op:"replace",path:[],value:k}),w.inversePatches.push({op:"replace",path:[],value:U.data});return w.patches.length===0||B(s.util.patchQueryData(S,E,w.patches,I)),w},h=(S,E,R)=>I=>I(s.endpoints[S].initiate(E,{subscribe:!1,forceRefetch:!0,[_i]:()=>({data:R})})),d=(S,E)=>S.query&&S[E]?S[E]:OS,f=async(S,{signal:E,abort:R,rejectWithValue:I,fulfillWithValue:B,dispatch:N,getState:D,extra:U})=>{const w=r[S.endpointName];try{let k=d(w,"transformResponse");const P={signal:E,abort:R,dispatch:N,getState:D,extra:U,endpoint:S.endpointName,type:S.type,forced:S.type==="query"?m(S,D()):void 0,queryCacheKey:S.type==="query"?S.queryCacheKey:void 0},M=S.type==="query"?S[_i]:void 0;let T;const j=async(z,F,L,W)=>{if(F==null&&z.pages.length)return Promise.resolve({data:z});const Y={queryArg:S.originalArgs,pageParam:F},re=await O(Y),ie=W?l:c;return{data:{pages:ie(z.pages,re.data,L),pageParams:ie(z.pageParams,F,L)}}};async function O(z){let F;const{extraOptions:L}=w;if(M?F=M():w.query?F=await e(w.query(z),P,L):F=await w.queryFn(z,P,L,Y=>e(Y,P,L)),typeof process<"u",F.error)throw new mm(F.error,F.meta);const W=await k(F.data,F.meta,z);return{...F,data:W}}if(S.type==="query"&&"infiniteQueryOptions"in w){const{infiniteQueryOptions:z}=w,{maxPages:F=1/0}=z;let L;const W={pages:[],pageParams:[]},Y=o.selectQueryEntry(D(),S.queryCacheKey)?.data,ie=m(S,D())&&!S.direction||!Y?W:Y;if("direction"in S&&S.direction&&ie.pages.length){const ne=S.direction==="backward",$e=(ne?Ux:Nu)(z,ie);L=await j(ie,$e,F,ne)}else{const{initialPageParam:ne=z.initialPageParam}=S,pt=Y?.pageParams??[],$e=pt[0]??ne,nt=pt.length;L=await j(ie,$e,F),M&&(L={data:L.data.pages[0]});for(let Tt=1;Tt<nt;Tt++){const oe=Nu(z,L.data);L=await j(L.data,oe,F)}}T=L}else T=await O(S.originalArgs);return B(T.data,vo({fulfilledTimeStamp:Date.now(),baseQueryMeta:T.meta}))}catch(k){let P=k;if(P instanceof mm){let M=d(w,"transformErrorResponse");try{return I(await M(P.value,P.meta,S.originalArgs),vo({baseQueryMeta:P.meta}))}catch(T){P=T}}throw console.error(P),P}};function m(S,E){const R=o.selectQueryEntry(E,S.queryCacheKey),I=o.selectConfig(E).refetchOnMountOrArgChange,B=R?.fulfilledTimeStamp,N=S.forceRefetch??(S.subscribe&&I);return N?N===!0||(Number(new Date)-Number(B))/1e3>=N:!1}const A=()=>lm(`${t}/executeQuery`,f,{getPendingMeta({arg:E}){const R=r[E.endpointName];return vo({startedTimeStamp:Date.now(),...pd(R)?{direction:E.direction}:{}})},condition(E,{getState:R}){const I=R(),B=o.selectQueryEntry(I,E.queryCacheKey),N=B?.fulfilledTimeStamp,D=E.originalArgs,U=B?.originalArgs,w=r[E.endpointName],k=E.direction;return zu(E)?!0:B?.status==="pending"?!1:m(E,I)||fd(w)&&w?.forceRefetch?.({currentArg:D,previousArg:U,endpointState:B,state:I})?!0:!(N&&!k)},dispatchConditionRejection:!0}),g=A(),y=A(),b=lm(`${t}/executeMutation`,f,{getPendingMeta(){return vo({startedTimeStamp:Date.now()})}}),x=S=>"force"in S,q=S=>"ifOlderThan"in S,V=(S,E,R)=>(I,B)=>{const N=x(R)&&R.force,D=q(R)&&R.ifOlderThan,U=(k=!0)=>{const P={forceRefetch:k,isPrefetch:!0};return s.endpoints[S].initiate(E,P)},w=s.endpoints[S].select(E)(B());if(N)I(U());else if(D){const k=w?.fulfilledTimeStamp;if(!k){I(U());return}(Number(new Date)-Number(new Date(k)))/1e3>=D&&I(U())}else I(U(!1))};function _(S){return E=>E?.meta?.arg?.endpointName===S}function v(S,E){return{matchPending:fi(od(S),_(E)),matchFulfilled:fi($r(S),_(E)),matchRejected:fi(gs(S),_(E))}}return{queryThunk:g,mutationThunk:b,infiniteQueryThunk:y,prefetch:V,updateQueryData:u,upsertQueryData:h,patchQueryData:a,buildMatchThunkActions:v}}function Nu(t,{pages:e,pageParams:r}){const n=e.length-1;return t.getNextPageParam(e[n],e,r[n],r)}function Ux(t,{pages:e,pageParams:r}){return t.getPreviousPageParam?.(e[0],e,r[0],r)}function Hx(t,e,r,n){return md(r[t.meta.arg.endpointName][e],$r(t)?t.payload:void 0,Ga(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,n)}function Vo(t,e,r){const n=t[e];n&&r(n)}function Si(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function gm(t,e,r){const n=t[Si(e)];n&&r(n)}var Hs={};function zS({reducerPath:t,queryThunk:e,mutationThunk:r,serializeQueryArgs:n,context:{endpointDefinitions:s,apiUid:i,extractRehydrationInfo:o,hasRehydrationInfo:a},assertTagType:l,config:c}){const u=bt(`${t}/resetApiState`);function h(v,S,E,R){v[S.queryCacheKey]??={status:"uninitialized",endpointName:S.endpointName},Vo(v,S.queryCacheKey,I=>{I.status="pending",I.requestId=E&&I.requestId?I.requestId:R.requestId,S.originalArgs!==void 0&&(I.originalArgs=S.originalArgs),I.startedTimeStamp=R.startedTimeStamp;const B=s[R.arg.endpointName];pd(B)&&"direction"in S&&(I.direction=S.direction)})}function d(v,S,E,R){Vo(v,S.arg.queryCacheKey,I=>{if(I.requestId!==S.requestId&&!R)return;const{merge:B}=s[S.arg.endpointName];if(I.status="fulfilled",B)if(I.data!==void 0){const{fulfilledTimeStamp:N,arg:D,baseQueryMeta:U,requestId:w}=S;let k=Ps(I.data,P=>B(P,E,{arg:D.originalArgs,baseQueryMeta:U,fulfilledTimeStamp:N,requestId:w}));I.data=k}else I.data=E;else I.data=s[S.arg.endpointName].structuralSharing??!0?Dx(hr(I.data)?h_(I.data):I.data,E):E;delete I.error,I.fulfilledTimeStamp=S.fulfilledTimeStamp})}const f=wr({name:`${t}/queries`,initialState:Hs,reducers:{removeQueryResult:{reducer(v,{payload:{queryCacheKey:S}}){delete v[S]},prepare:Us()},cacheEntriesUpserted:{reducer(v,S){for(const E of S.payload){const{queryDescription:R,value:I}=E;h(v,R,!0,{arg:R,requestId:S.meta.requestId,startedTimeStamp:S.meta.timestamp}),d(v,{arg:R,requestId:S.meta.requestId,fulfilledTimeStamp:S.meta.timestamp,baseQueryMeta:{}},I,!0)}},prepare:v=>({payload:v.map(R=>{const{endpointName:I,arg:B,value:N}=R,D=s[I];return{queryDescription:{type:"query",endpointName:I,originalArgs:R.arg,queryCacheKey:n({queryArgs:B,endpointDefinition:D,endpointName:I})},value:N}}),meta:{[$a]:!0,requestId:Xi(),timestamp:Date.now()}})},queryResultPatched:{reducer(v,{payload:{queryCacheKey:S,patches:E}}){Vo(v,S,R=>{R.data=tm(R.data,E.concat())})},prepare:Us()}},extraReducers(v){v.addCase(e.pending,(S,{meta:E,meta:{arg:R}})=>{const I=zu(R);h(S,R,I,E)}).addCase(e.fulfilled,(S,{meta:E,payload:R})=>{const I=zu(E.arg);d(S,E,R,I)}).addCase(e.rejected,(S,{meta:{condition:E,arg:R,requestId:I},error:B,payload:N})=>{Vo(S,R.queryCacheKey,D=>{if(!E){if(D.requestId!==I)return;D.status="rejected",D.error=N??B}})}).addMatcher(a,(S,E)=>{const{queries:R}=o(E);for(const[I,B]of Object.entries(R))(B?.status==="fulfilled"||B?.status==="rejected")&&(S[I]=B)})}}),m=wr({name:`${t}/mutations`,initialState:Hs,reducers:{removeMutationResult:{reducer(v,{payload:S}){const E=Si(S);E in v&&delete v[E]},prepare:Us()}},extraReducers(v){v.addCase(r.pending,(S,{meta:E,meta:{requestId:R,arg:I,startedTimeStamp:B}})=>{I.track&&(S[Si(E)]={requestId:R,status:"pending",endpointName:I.endpointName,startedTimeStamp:B})}).addCase(r.fulfilled,(S,{payload:E,meta:R})=>{R.arg.track&&gm(S,R,I=>{I.requestId===R.requestId&&(I.status="fulfilled",I.data=E,I.fulfilledTimeStamp=R.fulfilledTimeStamp)})}).addCase(r.rejected,(S,{payload:E,error:R,meta:I})=>{I.arg.track&&gm(S,I,B=>{B.requestId===I.requestId&&(B.status="rejected",B.error=E??R)})}).addMatcher(a,(S,E)=>{const{mutations:R}=o(E);for(const[I,B]of Object.entries(R))(B?.status==="fulfilled"||B?.status==="rejected")&&I!==B?.requestId&&(S[I]=B)})}}),A=wr({name:`${t}/invalidation`,initialState:Hs,reducers:{updateProvidedBy:{reducer(v,S){const{queryCacheKey:E,providedTags:R}=S.payload;for(const I of Object.values(v))for(const B of Object.values(I)){const N=B.indexOf(E);N!==-1&&B.splice(N,1)}for(const{type:I,id:B}of R){const N=(v[I]??={})[B||"__internal_without_id"]??=[];N.includes(E)||N.push(E)}},prepare:Us()}},extraReducers(v){v.addCase(f.actions.removeQueryResult,(S,{payload:{queryCacheKey:E}})=>{for(const R of Object.values(S))for(const I of Object.values(R)){const B=I.indexOf(E);B!==-1&&I.splice(B,1)}}).addMatcher(a,(S,E)=>{const{provided:R}=o(E);for(const[I,B]of Object.entries(R))for(const[N,D]of Object.entries(B)){const U=(S[I]??={})[N||"__internal_without_id"]??=[];for(const w of D)U.includes(w)||U.push(w)}}).addMatcher(Er($r(e),Ga(e)),(S,E)=>{g(S,E)}).addMatcher(f.actions.cacheEntriesUpserted.match,(S,E)=>{for(const{queryDescription:R,value:I}of E.payload)g(S,{type:"UNKNOWN",payload:I,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:R}})})}});function g(v,S){const E=Hx(S,"providesTags",s,l),{queryCacheKey:R}=S.meta.arg;A.caseReducers.updateProvidedBy(v,A.actions.updateProvidedBy({queryCacheKey:R,providedTags:E}))}const y=wr({name:`${t}/subscriptions`,initialState:Hs,reducers:{updateSubscriptionOptions(v,S){},unsubscribeQueryResult(v,S){},internal_getRTKQSubscriptions(){}}}),b=wr({name:`${t}/internalSubscriptions`,initialState:Hs,reducers:{subscriptionsUpdated:{reducer(v,S){return tm(v,S.payload)},prepare:Us()}}}),x=wr({name:`${t}/config`,initialState:{online:ES(),focused:PS(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(v,{payload:S}){v.middlewareRegistered=v.middlewareRegistered==="conflict"||i!==S?"conflict":!0}},extraReducers:v=>{v.addCase(dd,S=>{S.online=!0}).addCase(Lx,S=>{S.online=!1}).addCase(hd,S=>{S.focused=!0}).addCase(Fx,S=>{S.focused=!1}).addMatcher(a,S=>({...S}))}}),q=ed({queries:f.reducer,mutations:m.reducer,provided:A.reducer,subscriptions:b.reducer,config:x.reducer}),V=(v,S)=>q(u.match(S)?void 0:v,S),_={...x.actions,...f.actions,...y.actions,...b.actions,...m.actions,...A.actions,resetApiState:u};return{reducer:V,actions:_}}var vr=Symbol.for("RTKQ/skipToken"),$x={status:"uninitialized"},Am=Ps($x,()=>{}),ym=Ps($x,()=>{});function NS({serializeQueryArgs:t,reducerPath:e,createSelector:r}){const n=x=>Am,s=x=>ym;return{buildQuerySelector:d,buildInfiniteQuerySelector:f,buildMutationSelector:m,selectInvalidatedBy:A,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function i(x){return{...x,...dm(x.status)}}function o(x){return x[e]}function a(x){return o(x)?.queries}function l(x,q){return a(x)?.[q]}function c(x){return o(x)?.mutations}function u(x){return o(x)?.config}function h(x,q,V){return _=>{if(_===vr)return r(n,V);const v=t({queryArgs:_,endpointDefinition:q,endpointName:x});return r(E=>l(E,v)??Am,V)}}function d(x,q){return h(x,q,i)}function f(x,q){const{infiniteQueryOptions:V}=q;function _(v){const S={...v,...dm(v.status)},{isLoading:E,isError:R,direction:I}=S,B=I==="forward",N=I==="backward";return{...S,hasNextPage:y(V,S.data),hasPreviousPage:b(V,S.data),isFetchingNextPage:E&&B,isFetchingPreviousPage:E&&N,isFetchNextPageError:R&&B,isFetchPreviousPageError:R&&N}}return h(x,q,_)}function m(){return x=>{let q;return typeof x=="object"?q=Si(x)??vr:q=x,r(q===vr?s:v=>o(v)?.mutations?.[q]??ym,i)}}function A(x,q){const V=x[e],_=new Set;for(const v of q.filter(wa).map(Bu)){const S=V.provided[v.type];if(!S)continue;let E=(v.id!==void 0?S[v.id]:pm(Object.values(S)))??[];for(const R of E)_.add(R)}return pm(Array.from(_.values()).map(v=>{const S=V.queries[v];return S?[{queryCacheKey:v,endpointName:S.endpointName,originalArgs:S.originalArgs}]:[]}))}function g(x,q){return Object.values(a(x)).filter(V=>V?.endpointName===q&&V.status!=="uninitialized").map(V=>V.originalArgs)}function y(x,q){return q?Nu(x,q)!=null:!1}function b(x,q){return!q||!x.getPreviousPageParam?!1:Ux(x,q)!=null}}var xm=WeakMap?new WeakMap:void 0,Du=({endpointName:t,queryArgs:e})=>{let r="";const n=xm?.get(e);if(typeof n=="string")r=n;else{const s=JSON.stringify(e,(i,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=ms(o)?Object.keys(o).sort().reduce((a,l)=>(a[l]=o[l],a),{}):o,o));ms(e)&&xm?.set(e,s),r=s}return`${t}(${r})`};function Wx(...t){return function(r){const n=ya(c=>r.extractRehydrationInfo?.(c,{reducerPath:r.reducerPath??"api"})),s={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:n,serializeQueryArgs(c){let u=Du;if("serializeQueryArgs"in c.endpointDefinition){const h=c.endpointDefinition.serializeQueryArgs;u=d=>{const f=h(d);return typeof f=="string"?f:Du({...d,queryArgs:f})}}else r.serializeQueryArgs&&(u=r.serializeQueryArgs);return u(c)},tagTypes:[...r.tagTypes||[]]},i={endpointDefinitions:{},batch(c){c()},apiUid:Xi(),extractRehydrationInfo:n,hasRehydrationInfo:ya(c=>n(c)!=null)},o={injectEndpoints:l,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const h of c)s.tagTypes.includes(h)||s.tagTypes.push(h);if(u)for(const[h,d]of Object.entries(u))typeof d=="function"?d(i.endpointDefinitions[h]):Object.assign(i.endpointDefinitions[h]||{},d);return o}},a=t.map(c=>c.init(o,s,i));function l(c){const u=c.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"}),infiniteQuery:h=>({...h,type:"infinitequery"})});for(const[h,d]of Object.entries(u)){if(c.overrideExisting!==!0&&h in i.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(tt(39));continue}i.endpointDefinitions[h]=d;for(const f of a)f.injectEndpoint(h,d)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function DS(){return function(){throw new Error(tt(33))}}function Ar(t,...e){return Object.assign(t,...e)}var FS=({api:t,queryThunk:e,internalState:r})=>{const n=`${t.reducerPath}/subscriptions`;let s=null,i=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=t.internalActions,l=(f,m)=>{if(o.match(m)){const{queryCacheKey:g,requestId:y,options:b}=m.payload;return f?.[g]?.[y]&&(f[g][y]=b),!0}if(a.match(m)){const{queryCacheKey:g,requestId:y}=m.payload;return f[g]&&delete f[g][y],!0}if(t.internalActions.removeQueryResult.match(m))return delete f[m.payload.queryCacheKey],!0;if(e.pending.match(m)){const{meta:{arg:g,requestId:y}}=m,b=f[g.queryCacheKey]??={};return b[`${y}_running`]={},g.subscribe&&(b[y]=g.subscriptionOptions??b[y]??{}),!0}let A=!1;if(e.fulfilled.match(m)||e.rejected.match(m)){const g=f[m.meta.arg.queryCacheKey]||{},y=`${m.meta.requestId}_running`;A||=!!g[y],delete g[y]}if(e.rejected.match(m)){const{meta:{condition:g,arg:y,requestId:b}}=m;if(g&&y.subscribe){const x=f[y.queryCacheKey]??={};x[b]=y.subscriptionOptions??x[b]??{},A=!0}}return A},c=()=>r.currentSubscriptions,d={getSubscriptions:c,getSubscriptionCount:f=>{const A=c()[f]??{};return os(A)},isRequestSubscribed:(f,m)=>!!c()?.[f]?.[m]};return(f,m)=>{if(s||(s=JSON.parse(JSON.stringify(r.currentSubscriptions))),t.util.resetApiState.match(f))return s=r.currentSubscriptions={},i=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(f))return[!1,d];const A=l(r.currentSubscriptions,f);let g=!0;if(A){i||(i=setTimeout(()=>{const x=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,q]=wx(s,()=>x);m.next(t.internalActions.subscriptionsUpdated(q)),s=x,i=null},500));const y=typeof f.type=="string"&&!!f.type.startsWith(n),b=e.rejected.match(f)&&f.meta.condition&&!!f.meta.arg.subscribe;g=!y&&!b}return[g,!1]}};function LS(t){for(const e in t)return!1;return!0}var US=2147483647/1e3-1,HS=({reducerPath:t,api:e,queryThunk:r,context:n,internalState:s,selectors:{selectQueryEntry:i,selectConfig:o}})=>{const{removeQueryResult:a,unsubscribeQueryResult:l,cacheEntriesUpserted:c}=e.internalActions,u=Er(l.match,r.fulfilled,r.rejected,c.match);function h(g){const y=s.currentSubscriptions[g];return!!y&&!LS(y)}const d={},f=(g,y,b)=>{const x=y.getState(),q=o(x);if(u(g)){let V;if(c.match(g))V=g.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=l.match(g)?g.payload:g.meta.arg;V=[_]}m(V,y,q)}if(e.util.resetApiState.match(g))for(const[V,_]of Object.entries(d))_&&clearTimeout(_),delete d[V];if(n.hasRehydrationInfo(g)){const{queries:V}=n.extractRehydrationInfo(g);m(Object.keys(V),y,q)}};function m(g,y,b){const x=y.getState();for(const q of g){const V=i(x,q);A(q,V?.endpointName,y,b)}}function A(g,y,b,x){const V=n.endpointDefinitions[y]?.keepUnusedDataFor??x.keepUnusedDataFor;if(V===1/0)return;const _=Math.max(0,Math.min(V,US));if(!h(g)){const v=d[g];v&&clearTimeout(v),d[g]=setTimeout(()=>{h(g)||b.dispatch(a({queryCacheKey:g})),delete d[g]},_*1e3)}}return f},bm=new Error("Promise never resolved before cacheEntryRemoved."),$S=({api:t,reducerPath:e,context:r,queryThunk:n,mutationThunk:s,internalState:i,selectors:{selectQueryEntry:o,selectApiState:a}})=>{const l=Iu(n),c=Iu(s),u=$r(n,s),h={};function d(y,b,x){const q=h[y];q?.valueResolved&&(q.valueResolved({data:b,meta:x}),delete q.valueResolved)}function f(y){const b=h[y];b&&(delete h[y],b.cacheEntryRemoved())}const m=(y,b,x)=>{const q=A(y);function V(_,v,S,E){const R=o(x,v),I=o(b.getState(),v);!R&&I&&g(_,E,v,b,S)}if(n.pending.match(y))V(y.meta.arg.endpointName,q,y.meta.requestId,y.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(y))for(const{queryDescription:_,value:v}of y.payload){const{endpointName:S,originalArgs:E,queryCacheKey:R}=_;V(S,R,y.meta.requestId,E),d(R,v,{})}else if(s.pending.match(y))b.getState()[e].mutations[q]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,q,b,y.meta.requestId);else if(u(y))d(q,y.payload,y.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(y)||t.internalActions.removeMutationResult.match(y))f(q);else if(t.util.resetApiState.match(y))for(const _ of Object.keys(h))f(_)};function A(y){return l(y)?y.meta.arg.queryCacheKey:c(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:t.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:t.internalActions.removeMutationResult.match(y)?Si(y.payload):""}function g(y,b,x,q,V){const _=r.endpointDefinitions[y],v=_?.onCacheEntryAdded;if(!v)return;const S={},E=new Promise(U=>{S.cacheEntryRemoved=U}),R=Promise.race([new Promise(U=>{S.valueResolved=U}),E.then(()=>{throw bm})]);R.catch(()=>{}),h[x]=S;const I=t.endpoints[y].select(_.type==="query"?b:x),B=q.dispatch((U,w,k)=>k),N={...q,getCacheEntry:()=>I(q.getState()),requestId:V,extra:B,updateCachedData:_.type==="query"?U=>q.dispatch(t.util.updateQueryData(y,b,U)):void 0,cacheDataLoaded:R,cacheEntryRemoved:E},D=v(b,N);Promise.resolve(D).catch(U=>{if(U!==bm)throw U})}return m},WS=({api:t,context:{apiUid:e},reducerPath:r})=>(n,s)=>{t.util.resetApiState.match(n)&&s.dispatch(t.internalActions.middlewareRegistered(e))},GS=({reducerPath:t,context:e,context:{endpointDefinitions:r},mutationThunk:n,queryThunk:s,api:i,assertTagType:o,refetchQuery:a,internalState:l})=>{const{removeQueryResult:c}=i.internalActions,u=Er($r(n),Ga(n)),h=Er($r(n,s),gs(n,s));let d=[];const f=(g,y)=>{u(g)?A(Hx(g,"invalidatesTags",r,o),y):h(g)?A([],y):i.util.invalidateTags.match(g)&&A(md(g.payload,void 0,void 0,void 0,void 0,o),y)};function m(g){const{queries:y,mutations:b}=g;for(const x of[y,b])for(const q in x)if(x[q]?.status==="pending")return!0;return!1}function A(g,y){const b=y.getState(),x=b[t];if(d.push(...g),x.config.invalidationBehavior==="delayed"&&m(x))return;const q=d;if(d=[],q.length===0)return;const V=i.util.selectInvalidatedBy(b,q);e.batch(()=>{const _=Array.from(V.values());for(const{queryCacheKey:v}of _){const S=x.queries[v],E=l.currentSubscriptions[v]??{};S&&(os(E)===0?y.dispatch(c({queryCacheKey:v})):S.status!=="uninitialized"&&y.dispatch(a(S)))}})}return f},QS=({reducerPath:t,queryThunk:e,api:r,refetchQuery:n,internalState:s})=>{const i={},o=(d,f)=>{(r.internalActions.updateSubscriptionOptions.match(d)||r.internalActions.unsubscribeQueryResult.match(d))&&l(d.payload,f),(e.pending.match(d)||e.rejected.match(d)&&d.meta.condition)&&l(d.meta.arg,f),(e.fulfilled.match(d)||e.rejected.match(d)&&!d.meta.condition)&&a(d.meta.arg,f),r.util.resetApiState.match(d)&&u()};function a({queryCacheKey:d},f){const m=f.getState()[t],A=m.queries[d],g=s.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y,skipPollingIfUnfocused:b}=h(g);if(!Number.isFinite(y))return;const x=i[d];x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);const q=Date.now()+y;i[d]={nextPollTimestamp:q,pollingInterval:y,timeout:setTimeout(()=>{(m.config.focused||!b)&&f.dispatch(n(A)),a({queryCacheKey:d},f)},y)}}function l({queryCacheKey:d},f){const A=f.getState()[t].queries[d],g=s.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y}=h(g);if(!Number.isFinite(y)){c(d);return}const b=i[d],x=Date.now()+y;(!b||x<b.nextPollTimestamp)&&a({queryCacheKey:d},f)}function c(d){const f=i[d];f?.timeout&&clearTimeout(f.timeout),delete i[d]}function u(){for(const d of Object.keys(i))c(d)}function h(d={}){let f=!1,m=Number.POSITIVE_INFINITY;for(let A in d)d[A].pollingInterval&&(m=Math.min(d[A].pollingInterval,m),f=d[A].skipPollingIfUnfocused||f);return{lowestPollingInterval:m,skipPollingIfUnfocused:f}}return o},YS=({api:t,context:e,queryThunk:r,mutationThunk:n})=>{const s=od(r,n),i=gs(r,n),o=$r(r,n),a={};return(c,u)=>{if(s(c)){const{requestId:h,arg:{endpointName:d,originalArgs:f}}=c.meta,m=e.endpointDefinitions[d],A=m?.onQueryStarted;if(A){const g={},y=new Promise((V,_)=>{g.resolve=V,g.reject=_});y.catch(()=>{}),a[h]=g;const b=t.endpoints[d].select(m.type==="query"?f:h),x=u.dispatch((V,_,v)=>v),q={...u,getCacheEntry:()=>b(u.getState()),requestId:h,extra:x,updateCachedData:m.type==="query"?V=>u.dispatch(t.util.updateQueryData(d,f,V)):void 0,queryFulfilled:y};A(f,q)}}else if(o(c)){const{requestId:h,baseQueryMeta:d}=c.meta;a[h]?.resolve({data:c.payload,meta:d}),delete a[h]}else if(i(c)){const{requestId:h,rejectedWithValue:d,baseQueryMeta:f}=c.meta;a[h]?.reject({error:c.payload??c.error,isUnhandledError:!d,meta:f}),delete a[h]}}},KS=({reducerPath:t,context:e,api:r,refetchQuery:n,internalState:s})=>{const{removeQueryResult:i}=r.internalActions,o=(l,c)=>{hd.match(l)&&a(c,"refetchOnFocus"),dd.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){const u=l.getState()[t],h=u.queries,d=s.currentSubscriptions;e.batch(()=>{for(const f of Object.keys(d)){const m=h[f],A=d[f];if(!A||!m)continue;(Object.values(A).some(y=>y[c]===!0)||Object.values(A).every(y=>y[c]===void 0)&&u.config[c])&&(os(A)===0?l.dispatch(i({queryCacheKey:f})):m.status!=="uninitialized"&&l.dispatch(n(m)))}})}return o};function XS(t){const{reducerPath:e,queryThunk:r,api:n,context:s}=t,{apiUid:i}=s,o={invalidateTags:bt(`${e}/invalidateTags`)},a=h=>h.type.startsWith(`${e}/`),l=[WS,HS,GS,QS,$S,YS];return{middleware:h=>{let d=!1;const m={...t,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},A=l.map(b=>b(m)),g=FS(m),y=KS(m);return b=>x=>{if(!td(x))return b(x);d||(d=!0,h.dispatch(n.internalActions.middlewareRegistered(i)));const q={...h,next:b},V=h.getState(),[_,v]=g(x,q,V);let S;if(_?S=b(x):S=v,h.getState()[e]&&(y(x,q,V),a(x)||s.hasRehydrationInfo(x)))for(const E of A)E(x,q,V);return S}},actions:o};function u(h){return t.api.endpoints[h.endpointName].initiate(h.originalArgs,{subscribe:!1,forceRefetch:!0})}}var qm=Symbol(),Gx=({createSelector:t=id}={})=>({name:qm,init(e,{baseQuery:r,tagTypes:n,reducerPath:s,serializeQueryArgs:i,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u},h){q_();const d=O=>O;Object.assign(e,{reducerPath:s,endpoints:{},internalActions:{onOnline:dd,onOffline:Lx,onFocus:hd,onFocusLost:Fx},util:{}});const f=NS({serializeQueryArgs:i,reducerPath:s,createSelector:t}),{selectInvalidatedBy:m,selectCachedArgsForQuery:A,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:b}=f;Ar(e.util,{selectInvalidatedBy:m,selectCachedArgsForQuery:A});const{queryThunk:x,infiniteQueryThunk:q,mutationThunk:V,patchQueryData:_,updateQueryData:v,upsertQueryData:S,prefetch:E,buildMatchThunkActions:R}=BS({baseQuery:r,reducerPath:s,context:h,api:e,serializeQueryArgs:i,assertTagType:d,selectors:f}),{reducer:I,actions:B}=zS({context:h,queryThunk:x,mutationThunk:V,serializeQueryArgs:i,reducerPath:s,assertTagType:d,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:s,invalidationBehavior:u}});Ar(e.util,{patchQueryData:_,updateQueryData:v,upsertQueryData:S,prefetch:E,resetApiState:B.resetApiState,upsertQueryEntries:B.cacheEntriesUpserted}),Ar(e.internalActions,B);const{middleware:N,actions:D}=XS({reducerPath:s,context:h,queryThunk:x,mutationThunk:V,infiniteQueryThunk:q,api:e,assertTagType:d,selectors:f});Ar(e.util,D),Ar(e,{reducer:I,middleware:N});const{buildInitiateQuery:U,buildInitiateInfiniteQuery:w,buildInitiateMutation:k,getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueriesThunk:T,getRunningQueryThunk:j}=jS({queryThunk:x,mutationThunk:V,infiniteQueryThunk:q,api:e,serializeQueryArgs:i,context:h});return Ar(e.util,{getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueryThunk:j,getRunningQueriesThunk:T}),{name:qm,injectEndpoint(O,z){const F=e,L=F.endpoints[O]??={};fd(z)&&Ar(L,{name:O,select:g(O,z),initiate:U(O,z)},R(x,O)),RS(z)&&Ar(L,{name:O,select:b(),initiate:k(O)},R(V,O)),pd(z)&&Ar(L,{name:O,select:y(O,z),initiate:w(O,z)},R(x,O))}}}});Gx();function _o(t){return t.replace(t[0],t[0].toUpperCase())}function JS(t){return t.type==="query"}function ZS(t){return t.type==="mutation"}function Qx(t){return t.type==="infinitequery"}function $s(t,...e){return Object.assign(t,...e)}var fc=Symbol();function wm(t,e,r,n){const s=C.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?e({queryArgs:t,endpointDefinition:r,endpointName:n}):t}),[t,e,r,n]),i=C.useRef(s);return C.useEffect(()=>{i.current.serialized!==s.serialized&&(i.current=s)},[s]),i.current.serialized===s.serialized?i.current.queryArgs:t}function So(t){const e=C.useRef(t);return C.useEffect(()=>{hi(e.current,t)||(e.current=t)},[t]),hi(e.current,t)?e.current:t}var ek=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tk=ek(),rk=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nk=rk(),sk=()=>tk||nk?C.useLayoutEffect:C.useEffect,ik=sk(),vm=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:Nx.pending}:t;function pc(t,...e){const r={};return e.forEach(n=>{r[n]=t[n]}),r}var mc=["data","status","isLoading","isSuccess","isError","error"];function ok({api:t,moduleOptions:{batch:e,hooks:{useDispatch:r,useSelector:n,useStore:s},unstable__sideEffectsInRender:i,createSelector:o},serializeQueryArgs:a,context:l}){const c=i?q=>q():C.useEffect;return{buildQueryHooks:y,buildInfiniteQueryHooks:b,buildMutationHook:x,usePrefetch:d};function u(q,V,_){if(V?.endpointName&&q.isUninitialized){const{endpointName:B}=V,N=l.endpointDefinitions[B];_!==vr&&a({queryArgs:V.originalArgs,endpointDefinition:N,endpointName:B})===a({queryArgs:_,endpointDefinition:N,endpointName:B})&&(V=void 0)}let v=q.isSuccess?q.data:V?.data;v===void 0&&(v=q.data);const S=v!==void 0,E=q.isLoading,R=(!V||V.isLoading||V.isUninitialized)&&!S&&E,I=q.isSuccess||S&&(E&&!V?.isError||q.isUninitialized);return{...q,data:v,currentData:q.data,isFetching:E,isLoading:R,isSuccess:I}}function h(q,V,_){if(V?.endpointName&&q.isUninitialized){const{endpointName:B}=V,N=l.endpointDefinitions[B];a({queryArgs:V.originalArgs,endpointDefinition:N,endpointName:B})===a({queryArgs:_,endpointDefinition:N,endpointName:B})&&(V=void 0)}let v=q.isSuccess?q.data:V?.data;v===void 0&&(v=q.data);const S=v!==void 0,E=q.isLoading,R=(!V||V.isLoading||V.isUninitialized)&&!S&&E,I=q.isSuccess||E&&S;return{...q,data:v,currentData:q.data,isFetching:E,isLoading:R,isSuccess:I}}function d(q,V){const _=r(),v=So(V);return C.useCallback((S,E)=>_(t.util.prefetch(q,S,{...v,...E})),[q,_,v])}function f(q,V,{refetchOnReconnect:_,refetchOnFocus:v,refetchOnMountOrArgChange:S,skip:E=!1,pollingInterval:R=0,skipPollingIfUnfocused:I=!1,...B}={}){const{initiate:N}=t.endpoints[q],D=r(),U=C.useRef(void 0);if(!U.current){const W=D(t.internalActions.internal_getRTKQSubscriptions());U.current=W}const w=wm(E?vr:V,Du,l.endpointDefinitions[q],q),k=So({refetchOnReconnect:_,refetchOnFocus:v,pollingInterval:R,skipPollingIfUnfocused:I}),P=C.useRef(!1),M=B.initialPageParam,T=So(M),j=C.useRef(void 0);let{queryCacheKey:O,requestId:z}=j.current||{},F=!1;O&&z&&(F=U.current.isRequestSubscribed(O,z));const L=!F&&P.current;return c(()=>{P.current=F}),c(()=>{L&&(j.current=void 0)},[L]),c(()=>{const W=j.current;if(w===vr){W?.unsubscribe(),j.current=void 0;return}const Y=j.current?.subscriptionOptions;if(!W||W.arg!==w){W?.unsubscribe();const re=D(N(w,{subscriptionOptions:k,forceRefetch:S,...Qx(l.endpointDefinitions[q])?{initialPageParam:T}:{}}));j.current=re}else k!==Y&&W.updateSubscriptionOptions(k)},[D,N,S,w,k,L,T,q]),[j,D,N,k]}function m(q,V){return(v,{skip:S=!1,selectFromResult:E}={})=>{const{select:R}=t.endpoints[q],I=wm(S?vr:v,a,l.endpointDefinitions[q],q),B=C.useRef(void 0),N=C.useMemo(()=>o([R(I),(P,M)=>M,P=>I],V,{memoizeOptions:{resultEqualityCheck:hi}}),[R,I]),D=C.useMemo(()=>E?o([N],E,{devModeChecks:{identityFunctionCheck:"never"}}):N,[N,E]),U=n(P=>D(P,B.current),hi),w=s(),k=N(w.getState(),B.current);return ik(()=>{B.current=k},[k]),U}}function A(q){C.useEffect(()=>()=>{q.current?.unsubscribe?.(),q.current=void 0},[q])}function g(q){if(!q.current)throw new Error(tt(38));return q.current.refetch()}function y(q){const V=(S,E={})=>{const[R]=f(q,S,E);return A(R),C.useMemo(()=>({refetch:()=>g(R)}),[R])},_=({refetchOnReconnect:S,refetchOnFocus:E,pollingInterval:R=0,skipPollingIfUnfocused:I=!1}={})=>{const{initiate:B}=t.endpoints[q],N=r(),[D,U]=C.useState(fc),w=C.useRef(void 0),k=So({refetchOnReconnect:S,refetchOnFocus:E,pollingInterval:R,skipPollingIfUnfocused:I});c(()=>{const j=w.current?.subscriptionOptions;k!==j&&w.current?.updateSubscriptionOptions(k)},[k]);const P=C.useRef(k);c(()=>{P.current=k},[k]);const M=C.useCallback(function(j,O=!1){let z;return e(()=>{w.current?.unsubscribe(),w.current=z=N(B(j,{subscriptionOptions:P.current,forceRefetch:!O})),U(j)}),z},[N,B]),T=C.useCallback(()=>{w.current?.queryCacheKey&&N(t.internalActions.removeQueryResult({queryCacheKey:w.current?.queryCacheKey}))},[N]);return C.useEffect(()=>()=>{w?.current?.unsubscribe()},[]),C.useEffect(()=>{D!==fc&&!w.current&&M(D,!0)},[D,M]),C.useMemo(()=>[M,D,{reset:T}],[M,D,T])},v=m(q,u);return{useQueryState:v,useQuerySubscription:V,useLazyQuerySubscription:_,useLazyQuery(S){const[E,R,{reset:I}]=_(S),B=v(R,{...S,skip:R===fc}),N=C.useMemo(()=>({lastArg:R}),[R]);return C.useMemo(()=>[E,{...B,reset:I},N],[E,B,I,N])},useQuery(S,E){const R=V(S,E),I=v(S,{selectFromResult:S===vr||E?.skip?void 0:vm,...E}),B=pc(I,...mc);return C.useDebugValue(B),C.useMemo(()=>({...I,...R}),[I,R])}}}function b(q){const V=(v,S={})=>{const[E,R,I,B]=f(q,v,S),N=C.useRef(B);c(()=>{N.current=B},[B]);const D=C.useCallback(function(U,w){let k;return e(()=>{E.current?.unsubscribe(),E.current=k=R(I(U,{subscriptionOptions:N.current,direction:w}))}),k},[E,R,I]);return A(E),C.useMemo(()=>({trigger:D,refetch:()=>g(E),fetchNextPage:()=>D(v,"forward"),fetchPreviousPage:()=>D(v,"backward")}),[E,D,v])},_=m(q,h);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:V,useInfiniteQuery(v,S){const{refetch:E,fetchNextPage:R,fetchPreviousPage:I}=V(v,S),B=_(v,{selectFromResult:v===vr||S?.skip?void 0:vm,...S}),N=pc(B,...mc,"hasNextPage","hasPreviousPage");return C.useDebugValue(N),C.useMemo(()=>({...B,fetchNextPage:R,fetchPreviousPage:I,refetch:E}),[B,R,I,E])}}}function x(q){return({selectFromResult:V,fixedCacheKey:_}={})=>{const{select:v,initiate:S}=t.endpoints[q],E=r(),[R,I]=C.useState();C.useEffect(()=>()=>{R?.arg.fixedCacheKey||R?.reset()},[R]);const B=C.useCallback(function(j){const O=E(S(j,{fixedCacheKey:_}));return I(O),O},[E,S,_]),{requestId:N}=R||{},D=C.useMemo(()=>v({fixedCacheKey:_,requestId:R?.requestId}),[_,R,v]),U=C.useMemo(()=>V?o([D],V):D,[V,D]),w=n(U,hi),k=_==null?R?.arg.originalArgs:void 0,P=C.useCallback(()=>{e(()=>{R&&I(void 0),_&&E(t.internalActions.removeMutationResult({requestId:N,fixedCacheKey:_}))})},[E,_,R,N]),M=pc(w,...mc,"endpointName");C.useDebugValue(M);const T=C.useMemo(()=>({...w,originalArgs:k,reset:P}),[w,k,P]);return C.useMemo(()=>[B,T],[B,T])}}}var ak=Symbol(),lk=({batch:t=Y0,hooks:e={useDispatch:fx,useSelector:px,useStore:Kh},createSelector:r=id,unstable__sideEffectsInRender:n=!1,...s}={})=>({name:ak,init(i,{serializeQueryArgs:o},a){const l=i,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:h,usePrefetch:d}=ok({api:i,moduleOptions:{batch:t,hooks:e,unstable__sideEffectsInRender:n,createSelector:r},serializeQueryArgs:o,context:a});return $s(l,{usePrefetch:d}),$s(a,{batch:t}),{injectEndpoint(f,m){if(JS(m)){const{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:b,useQuerySubscription:x}=c(f);$s(l.endpoints[f],{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:b,useQuerySubscription:x}),i[`use${_o(f)}Query`]=A,i[`useLazy${_o(f)}Query`]=g}if(ZS(m)){const A=h(f);$s(l.endpoints[f],{useMutation:A}),i[`use${_o(f)}Mutation`]=A}else if(Qx(m)){const{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}=u(f);$s(l.endpoints[f],{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}),i[`use${_o(f)}InfiniteQuery`]=A}}}}}),ck=Wx(Gx(),lk());const Ka=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const uk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ri=Array.prototype.slice.call(uk),ko=(t=>{let e={};return t.forEach((r,n)=>e[r]=n),e})(ri),hk=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,ra=String.fromCharCode.bind(String),Vm=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),dk=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Yx=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),fk=t=>{let e,r,n,s,i="";const o=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|s,i+=ri[e>>18&63]+ri[e>>12&63]+ri[e>>6&63]+ri[e&63]}return o?i.slice(0,o-3)+"===".substring(o):i},pk=typeof btoa=="function"?t=>btoa(t):Ka?t=>Buffer.from(t,"binary").toString("base64"):fk,_m=Ka?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let n=0,s=t.length;n<s;n+=4096)r.push(ra.apply(null,t.subarray(n,n+4096)));return pk(r.join(""))},mk=(t,e=!1)=>e?dk(_m(t)):_m(t),gk=t=>{if(t=t.replace(/\s+/g,""),!hk.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",n,s;for(let i=0;i<t.length;)e=ko[t.charAt(i++)]<<18|ko[t.charAt(i++)]<<12|(n=ko[t.charAt(i++)])<<6|(s=ko[t.charAt(i++)]),r+=n===64?ra(e>>16&255):s===64?ra(e>>16&255,e>>8&255):ra(e>>16&255,e>>8&255,e&255);return r},Ak=typeof atob=="function"?t=>atob(Yx(t)):Ka?t=>Buffer.from(t,"base64").toString("binary"):gk,yk=Ka?t=>Vm(Buffer.from(t,"base64")):t=>Vm(Ak(t).split("").map(e=>e.charCodeAt(0))),xk=t=>yk(bk(t)),bk=t=>Yx(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),qk=!0,Kx="gzip",wk=async t=>{const e=JSON.stringify(t),n=new TextEncoder().encode(e),s=new Blob([n]),i=new CompressionStream(Kx),o=s.stream().pipeThrough(i),a=await new Response(o).arrayBuffer(),l=new Uint8Array(a);return mk(l,qk)},Xx=async t=>{try{const e=xk(t),r=new Blob([e]),n=new DecompressionStream(Kx),s=r.stream().pipeThrough(n),i=await new Response(s).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},vk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>fr(async()=>{const{default:n}=await Promise.resolve().then(()=>Es);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class gd extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Vk extends gd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sm extends gd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class km extends gd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Fu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Fu||(Fu={}));var _k=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class Sk{constructor(e,{headers:r={},customFetch:n,region:s=Fu.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=vk(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return _k(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u}).catch(A=>{throw new Vk(A)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Sm(h);if(!h.ok)throw new km(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield h.json():f==="application/octet-stream"?m=yield h.blob():f==="text/event-stream"?m=h:f==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof km||s instanceof Sm?s.context:void 0}}})}}var Ke={},Nn={},Dn={},Fn={},Ln={},Un={},kk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},As=kk();const Ck=As.fetch,Jx=As.fetch.bind(As),Zx=As.Headers,Pk=As.Request,Ek=As.Response,Es=Object.freeze(Object.defineProperty({__proto__:null,Headers:Zx,Request:Pk,Response:Ek,default:Jx,fetch:Ck},Symbol.toStringTag,{value:"Module"})),Tk=qv(Es);var Co={},Cm;function eb(){if(Cm)return Co;Cm=1,Object.defineProperty(Co,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Co.default=t,Co}var Pm;function tb(){if(Pm)return Un;Pm=1;var t=Un&&Un.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Un,"__esModule",{value:!0});const e=t(Tk),r=t(eb());class n{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,m=null,A=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const V=await c.text();V===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=V:m=JSON.parse(V))}const x=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),q=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&q&&q.length>1&&(A=parseInt(q[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,A=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await c.text();try{f=JSON.parse(x),Array.isArray(f)&&c.status===404&&(m=[],f=null,g=200,y="OK")}catch{c.status===404&&x===""?(g=204,y="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,y="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:m,count:A,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Un.default=n,Un}var Em;function rb(){if(Em)return Ln;Em=1;var t=Ln&&Ln.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ln,"__esModule",{value:!0});const e=t(tb());class r extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ln.default=r,Ln}var Tm;function Ad(){if(Tm)return Fn;Tm=1;var t=Fn&&Fn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Fn,"__esModule",{value:!0});const e=t(rb());class r extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return Fn.default=r,Fn}var Rm;function nb(){if(Rm)return Dn;Rm=1;var t=Dn&&Dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Dn,"__esModule",{value:!0});const e=t(Ad());class r{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=i,this.schema=o,this.fetch=a}select(s,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const c=s.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(s)){const h=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Dn.default=r,Dn}var Ws={},Gs={},Mm;function Rk(){return Mm||(Mm=1,Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.version=void 0,Gs.version="0.0.0-automated"),Gs}var Im;function Mk(){if(Im)return Ws;Im=1,Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.DEFAULT_HEADERS=void 0;const t=Rk();return Ws.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Ws}var jm;function Ik(){if(jm)return Nn;jm=1;var t=Nn&&Nn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Nn,"__esModule",{value:!0});const e=t(nb()),r=t(Ad()),n=Mk();class s{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([A,g])=>g!==void 0).map(([A,g])=>[A,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([A,g])=>{d.searchParams.append(A,g)})):(h="POST",f=a);const m=Object.assign({},this.headers);return u&&(m.Prefer=`count=${u}`),new r.default({method:h,url:d,headers:m,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Nn.default=s,Nn}var Om;function jk(){if(Om)return Ke;Om=1;var t=Ke&&Ke.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.PostgrestError=Ke.PostgrestBuilder=Ke.PostgrestTransformBuilder=Ke.PostgrestFilterBuilder=Ke.PostgrestQueryBuilder=Ke.PostgrestClient=void 0;const e=t(Ik());Ke.PostgrestClient=e.default;const r=t(nb());Ke.PostgrestQueryBuilder=r.default;const n=t(Ad());Ke.PostgrestFilterBuilder=n.default;const s=t(rb());Ke.PostgrestTransformBuilder=s.default;const i=t(tb());Ke.PostgrestBuilder=i.default;const o=t(eb());return Ke.PostgrestError=o.default,Ke.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},Ke}var Ok=jk();const Bk=rt(Ok),{PostgrestClient:zk,PostgrestQueryBuilder:WF,PostgrestFilterBuilder:GF,PostgrestTransformBuilder:QF,PostgrestBuilder:YF,PostgrestError:KF}=Bk;function Nk(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Dk=Nk(),Fk="2.11.15",Lk=`realtime-js/${Fk}`,Uk="1.0.0",sb=1e4,Hk=1e3;var pi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(pi||(pi={}));var ut;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ut||(ut={}));var Zt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Zt||(Zt={}));var Lu;(function(t){t.websocket="websocket"})(Lu||(Lu={}));var gn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(gn||(gn={}));class $k{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class ib{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ve;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ve||(ve={}));const Bm=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=Wk(o,t,e,s),i),{})},Wk=(t,e,r,n)=>{const s=e.find(a=>a.name===t),i=s?.type,o=r[t];return i&&!n.includes(i)?ob(i,o):Uu(o)},ob=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Kk(e,r)}switch(t){case ve.bool:return Gk(e);case ve.float4:case ve.float8:case ve.int2:case ve.int4:case ve.int8:case ve.numeric:case ve.oid:return Qk(e);case ve.json:case ve.jsonb:return Yk(e);case ve.timestamp:return Xk(e);case ve.abstime:case ve.date:case ve.daterange:case ve.int4range:case ve.int8range:case ve.money:case ve.reltime:case ve.text:case ve.time:case ve.timestamptz:case ve.timetz:case ve.tsrange:case ve.tstzrange:return Uu(e);default:return Uu(e)}},Uu=t=>t,Gk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Qk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Yk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Kk=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ob(e,a))}return t},Xk=t=>typeof t=="string"?t.replace(" ","T"):t,ab=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class gc{constructor(e,r,n={},s=sb){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var zm;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(zm||(zm={}));class mi{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mi.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=mi.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=mi.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),A=h.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),A.length>0&&(l[c]=A)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}n(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Nm;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Nm||(Nm={}));var Dm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Dm||(Dm={}));var qr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qr||(qr={}));class yd{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new gc(this,Zt.join,this.params,this.timeout),this.rejoinTimer=new ib(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ut.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new mi(this),this.broadcastEndpointURL=ab(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ut.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(qr.CHANNEL_ERROR,u)),this._onClose(()=>e?.(qr.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(qr.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,m=[];for(let A=0;A<f;A++){const g=d[A],{filter:{event:y,schema:b,table:x,filter:q}}=g,V=u&&u[A];if(V&&V.event===y&&V.schema===b&&V.table===x&&V.filter===q)m.push(Object.assign(Object.assign({},g),{id:V.id}));else{this.unsubscribe(),this.state=ut.errored,e?.(qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(qr.SUBSCRIBED);return}}).receive("error",u=>{this.state=ut.errored,e?.(qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ut.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new gc(this,Zt.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new gc(this,e,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Zt;if(n&&[a,l,c,u].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var m,A,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(A=f.filter)===null||A===void 0?void 0:A.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,n)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var m,A,g,y,b,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const q=f.id,V=(m=f.filter)===null||m===void 0?void 0:m.event;return q&&((A=r.ids)===null||A===void 0?void 0:A.includes(q))&&(V==="*"||V?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const q=(b=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return q==="*"||q===((x=r?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:A,table:g,commit_timestamp:y,type:b,errors:x}=m;d=Object.assign(Object.assign({},{schema:A,table:g,commit_timestamp:y,eventType:b,new:{},old:{},errors:x}),this._getPayloadRecords(m))}f.callback(d,n)})}_isClosed(){return this.state===ut.closed}_isJoined(){return this.state===ut.joined}_isJoining(){return this.state===ut.joining}_isLeaving(){return this.state===ut.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&yd.isEqual(s.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Zt.close,{},e)}_onError(e){this._on(Zt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ut.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Bm(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Bm(e.columns,e.old_record)),r}}const Fm=()=>{},Jk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Zk{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=sb,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fm,this.ref=0,this.logger=Fm,this.conn=null,this.sendBuffer=[],this.serializer=new $k,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>fr(async()=>{const{default:l}=await Promise.resolve().then(()=>Es);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Lu.websocket}`,this.httpEndpoint=ab(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r?.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ib(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Dk),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Uk}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pi.connecting:return gn.Connecting;case pi.open:return gn.Open;case pi.closing:return gn.Closing;default:return gn.Closed}}isConnected(){return this.connectionState()===gn.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new yd(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Lk};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Zt.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Hk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:s,payload:i,ref:o}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Zt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Jk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class xd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Je(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class e1 extends xd{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Hu extends xd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var t1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const lb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>fr(async()=>{const{default:n}=await Promise.resolve().then(()=>Es);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},r1=()=>t1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fr(()=>Promise.resolve().then(()=>Es),void 0)).Response:Response}),$u=t=>{if(Array.isArray(t))return t.map(r=>$u(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=$u(n)}),e};var jn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const Ac=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),n1=(t,e,r)=>jn(void 0,void 0,void 0,function*(){const n=yield r1();t instanceof n&&!r?.noResolveJson?t.json().then(s=>{e(new e1(Ac(s),t.status||500))}).catch(s=>{e(new Hu(Ac(s),s))}):e(new Hu(Ac(t),t))}),s1=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Ji(t,e,r,n,s,i){return jn(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,s1(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>n1(l,a,n))})})}function va(t,e,r,n){return jn(this,void 0,void 0,function*(){return Ji(t,"GET",e,r,n)})}function Br(t,e,r,n,s){return jn(this,void 0,void 0,function*(){return Ji(t,"POST",e,n,s,r)})}function i1(t,e,r,n,s){return jn(this,void 0,void 0,function*(){return Ji(t,"PUT",e,n,s,r)})}function o1(t,e,r,n){return jn(this,void 0,void 0,function*(){return Ji(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function cb(t,e,r,n,s){return jn(this,void 0,void 0,function*(){return Ji(t,"DELETE",e,n,s,r)})}var qt=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const a1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Lm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class l1{constructor(e,r={},n,s){this.url=e,this.headers=r,this.bucketId=n,this.fetch=lb(s)}uploadOrUpdate(e,r,n,s){return qt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Lm),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Je(i))return{data:null,error:i};throw i}})}upload(e,r,n){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return qt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Lm.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(Je(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return qt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const i=yield Br(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new xd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}update(e,r,n){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return qt(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}copy(e,r,n){return qt(this,void 0,void 0,function*(){try{return{data:{path:(yield Br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return qt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Br(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return qt(this,void 0,void 0,function*(){try{const s=yield Br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}download(e,r){return qt(this,void 0,void 0,function*(){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield va(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Je(a))return{data:null,error:a};throw a}})}info(e){return qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield va(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:$u(n),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}exists(e){return qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield o1(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Je(n)&&n instanceof Hu){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return qt(this,void 0,void 0,function*(){try{return{data:yield cb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}list(e,r,n){return qt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},a1),r),{prefix:e||""});return{data:yield Br(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Je(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const c1="2.7.1",u1={"X-Client-Info":`storage-js/${c1}`};var Hn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class h1{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},u1),r),this.fetch=lb(n)}listBuckets(){return Hn(this,void 0,void 0,function*(){try{return{data:yield va(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Je(e))return{data:null,error:e};throw e}})}getBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield va(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Hn(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Hn(this,void 0,void 0,function*(){try{return{data:yield i1(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield cb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Je(r))return{data:null,error:r};throw r}})}}class d1 extends h1{constructor(e,r={},n){super(e,r,n)}from(e){return new l1(this.url,this.headers,e,this.fetch)}}const f1="2.51.0";let ni="";typeof Deno<"u"?ni="deno":typeof document<"u"?ni="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ni="react-native":ni="node";const p1={"X-Client-Info":`supabase-js-${ni}/${f1}`},m1={headers:p1},g1={schema:"public"},A1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},y1={};var x1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const b1=t=>{let e;return t?e=t:typeof fetch>"u"?e=Jx:e=fetch,(...r)=>e(...r)},q1=()=>typeof Headers>"u"?Zx:Headers,w1=(t,e,r)=>{const n=b1(r),s=q1();return(i,o)=>x1(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new s(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:c}))})};var v1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};function V1(t){return t.endsWith("/")?t:t+"/"}function _1(t,e){var r,n;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=a?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>v1(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const ub="2.71.0",Zn=30*1e3,Wu=3,yc=Wu*Zn,S1="http://localhost:9999",k1="supabase.auth.token",C1={"X-Client-Info":`gotrue-js/${ub}`},Gu="X-Supabase-Api-Version",hb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,E1=10*60*1e3;class bd extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function se(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class T1 extends bd{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function R1(t){return se(t)&&t.name==="AuthApiError"}class db extends bd{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Zr extends bd{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Or extends Zr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function M1(t){return se(t)&&t.name==="AuthSessionMissingError"}class Po extends Zr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Eo extends Zr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class To extends Zr{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function I1(t){return se(t)&&t.name==="AuthImplicitGrantRedirectError"}class Um extends Zr{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qu extends Zr{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function xc(t){return se(t)&&t.name==="AuthRetryableFetchError"}class Hm extends Zr{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Yu extends Zr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Va="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$m=` 	
\r=`.split(""),j1=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<$m.length;e+=1)t[$m[e].charCodeAt(0)]=-2;for(let e=0;e<Va.length;e+=1)t[Va[e].charCodeAt(0)]=e;return t})();function Wm(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Va[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Va[n]),e.queuedBits-=6}}function fb(t,e,r){const n=j1[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Gm(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{z1(o,n,r)};for(let o=0;o<t.length;o+=1)fb(t.charCodeAt(o),s,i);return e.join("")}function O1(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function B1(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}O1(n,e)}}function z1(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function N1(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)fb(t.charCodeAt(s),r,n);return new Uint8Array(e)}function D1(t){const e=[];return B1(t,r=>e.push(r)),new Uint8Array(e)}function F1(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>Wm(s,r,n)),Wm(null,r,n),e.join("")}function L1(t){return Math.round(Date.now()/1e3)+t}function U1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Jt=()=>typeof window<"u"&&typeof document<"u",on={tested:!1,writable:!1},pb=()=>{if(!Jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(on.tested)return on.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),on.tested=!0,on.writable=!0}catch{on.tested=!0,on.writable=!1}return on.writable};function H1(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const mb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>fr(async()=>{const{default:n}=await Promise.resolve().then(()=>Es);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},$1=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",es=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},an=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ir=async(t,e)=>{await t.removeItem(e)};class Xa{constructor(){this.promise=new Xa.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Xa.promiseConstructor=Promise;function bc(t){const e=t.split(".");if(e.length!==3)throw new Yu("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!P1.test(e[n]))throw new Yu("JWT not in base64url format");return{header:JSON.parse(Gm(e[0])),payload:JSON.parse(Gm(e[1])),signature:N1(e[2]),raw:{header:e[0],payload:e[1]}}}async function W1(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function G1(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Q1(t){return("0"+t.toString(16)).substr(-2)}function Y1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Q1).join("")}async function K1(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function X1(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await K1(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $n(t,e,r=!1){const n=Y1();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await es(t,`${e}-code-verifier`,s);const i=await X1(n);return[i,n===i?"plain":"s256"]}const J1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Z1(t){const e=t.headers.get(Gu);if(!e||!e.match(J1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function eC(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function tC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wn(t){if(!rC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function qc(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var nC=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const un=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),sC=[502,503,504];async function Qm(t){var e;if(!$1(t))throw new Qu(un(t),0);if(sC.includes(t.status))throw new Qu(un(t),t.status);let r;try{r=await t.json()}catch(i){throw new db(un(i),i)}let n;const s=Z1(t);if(s&&s.getTime()>=hb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Hm(un(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Or}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Hm(un(r),t.status,r.weak_password.reasons);throw new T1(un(r),t.status||500,n)}const iC=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function de(t,e,r,n){var s;const i=Object.assign({},n?.headers);i[Gu]||(i[Gu]=hb["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await oC(t,e,r+a,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function oC(t,e,r,n,s,i){const o=iC(e,n,s,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new Qu(un(l),0)}if(a.ok||await Qm(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await Qm(l)}}function br(t){var e;let r=null;uC(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=L1(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Ym(t){const e=br(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function zr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function aC(t){return{data:t,error:null}}function lC(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,o=nC(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function cC(t){return t}function uC(t){return t.access_token&&t.refresh_token&&t.expires_in}const wc=["global","local","others"];var hC=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class dC{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=mb(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=wc[0]){if(wc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wc.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:zr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=hC(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:lC,redirectTo:r?.redirectTo})}catch(r){if(se(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:zr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:cC});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const A=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=A}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(se(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Wn(e);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:zr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Wn(e);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:zr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Wn(e);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:zr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Wn(e.userId);try{const{data:r,error:n}=await de(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(se(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Wn(e.userId),Wn(e.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}}function Km(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function fC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Gn={debug:!!(globalThis&&pb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gb extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class pC extends gb{}async function mC(t,e,r){Gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Gn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{Gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Gn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new pC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Gn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}fC();const gC={url:S1,storageKey:k1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:C1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Xm(t,e,r){return await r()}const Qn={};class ki{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ki.nextInstanceID,ki.nextInstanceID+=1,this.instanceID>0&&Jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},gC),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new dC({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=mb(s.fetch),this.lock=s.lock||Xm,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Jt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=mC:this.lock=Xm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:pb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Km(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Km(this.memoryStorage)),Jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Qn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Qn[this.storageKey]=Object.assign(Object.assign({},Qn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Qn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qn[this.storageKey]=Object.assign(Object.assign({},Qn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ub}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=H1(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Jt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),I1(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return se(r)?{error:r}:{error:new db("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:br}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await $n(this.storage,this.storageKey)),i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},xform:br})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d?.data)!==null&&n!==void 0?n:{},channel:(s=d?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:br})}else throw new Eo("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Ym})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Ym})}else throw new Eo("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Po}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,i,o,a,l,c,u,h,d,f;let m,A;if("message"in e)m=e.message,A=e.signature;else{const{chain:g,wallet:y,statement:b,options:x}=e;let q;if(Jt())if(typeof y=="object")q=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))q=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=y}const V=new URL((r=x?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in q&&q.signIn){const _=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),b?{statement:b}:null));let v;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")v=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)v=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in v&&"signature"in v&&(typeof v.signedMessage=="string"||v.signedMessage instanceof Uint8Array)&&v.signature instanceof Uint8Array)m=typeof v.signedMessage=="string"?v.signedMessage:new TextDecoder().decode(v.signedMessage),A=v.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${V.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(s=(n=x?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(v=>`- ${v}`)]:[]].join(`
`);const _=await q.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=_}}try{const{data:g,error:y}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:F1(A)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:br});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Po}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(se(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await an(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:br});if(await Ir(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Po}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(se(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=e,a=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:br}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Po}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await $n(this.storage,this.storageKey));const{error:h}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Eo("You must provide either an email or phone number.")}catch(a){if(se(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:br});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(se(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await $n(this.storage,this.storageKey)),await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:aC})}catch(i){if(se(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Or;const{error:s}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(se(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await de(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await de(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new Eo("You must provide either an email or phone number and a type")}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await an(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<yc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await an(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=qc()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:zr}):await this._useSession(async r=>{var n,s,i;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Or}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:zr})})}catch(r){if(se(r))return M1(r)&&(await this._removeSession(),await Ir(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Or;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await $n(this.storage,this.storageKey));const{data:c,error:u}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:zr});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Or;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=bc(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(se(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Or;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Jt())throw new To("No browser detected.");if(e.error||e.error_description||e.error_code)throw new To(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Um("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new To("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Um("No code detected.");const{data:b,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new To("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=Zn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:A,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(n){if(se(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await an(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(R1(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Ir(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=U1(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await $n(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(se(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Jt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(se(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await G1(async s=>(s>0&&await W1(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:br})),(s,i)=>{const o=200*Math.pow(2,s);return i&&xc(i)&&Date.now()+o-n<Zn})}catch(n){if(this._debug(r,"error",n),se(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Jt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await an(this.storage,this.storageKey);if(s&&this.userStorage){let o=await an(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await es(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:qc()}else if(s&&!s.user&&!s.user){const o=await an(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await Ir(this.storage,this.storageKey+"-user"),await es(this.storage,this.storageKey,s)):s.user=qc()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<yc;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${yc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),xc(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Or;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Xa;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Or;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),se(i)){const o={session:null,error:i};return xc(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await es(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=structuredClone(s);await es(this.storage,this.storageKey,i)}else{const s=structuredClone(r);await es(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Ir(this.storage,this.storageKey),await Ir(this.storage,this.storageKey+"-code-verifier"),await Ir(this.storage,this.storageKey+"-user"),this.userStorage&&await Ir(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Jt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Zn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Zn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Zn}ms, refresh threshold is ${Wu} ticks`),s<=Wu&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof gb)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await $n(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await de(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await de(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l?.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=bc(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+E1>s)return n;const{data:i,error:o}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:f,error:m}=await this.getSession();if(m||!f.session)return{data:null,error:m};n=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=bc(n);r?.allowExpired||eC(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=tC(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,D1(`${a}.${l}`)))throw new Yu("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}}}ki.nextInstanceID=0;const AC=ki;class yC extends AC{constructor(e){super(e)}}var xC=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class bC{constructor(e,r,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=V1(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:g1,realtime:y1,auth:Object.assign(Object.assign({},A1),{storageKey:c}),global:m1},h=_1(n??{},u);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=w1(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new zk(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new Sk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new d1(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return xC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yC({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Zk(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const qC=(t,e,r)=>new bC(t,e,r),qd=qC("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),wC=async t=>{const e=await qd.rpc("save_campaign_version",{p_name:t.locator.campaignName,p_data:await wk(t)});if(e.error)throw new Error(`error saving to db ${e.error.message} ${e.error.details}`,{cause:e.error});return e.data},vC=async t=>{const e=await qd.rpc("get_latest_campaign",{p_campaign_name:t.campaignName,p_user_id:t.userId,p_version:t.version===-1?void 0:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const r=await Xx(e.data.data);return Object.values(r.rooms).forEach(n=>{delete n.size}),r.locator===void 0&&(r.locator={userId:t.userId||"upgraded, unknown",campaignName:t.campaignName,version:e.data.version}),delete r.name,r},VC=async()=>{const t=await qd.rpc("get_all_users_latest_campaigns");if(t.error)throw new Error("could not get user campaigns",{cause:t.error});return t.data},_C=Ui(()=>fr(()=>import("./campaign-B180bztC.js"),__vite__mapDeps([0,1,2]))),Cn=ck({reducerPath:"campaignsApi",baseQuery:DS(),endpoints:t=>({getCampaign:t.query({async queryFn(e){try{return e.userId==="@@original"&&e.campaignName==="original"?{data:(await _C()).campaign}:e.campaignName.startsWith("data:")?{data:await Xx(e.campaignName.substring(5))}:{data:await vC(e)}}catch(r){return{error:new Error(`getCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`)}}}}),getAllUsersLatestCampaigns:t.query({async queryFn(){try{return{data:await VC()}}catch(e){return{error:new Error(`getAllUsersLatestCampaigns queryFn() failed: ${e}`)}}}}),saveCampaign:t.mutation({async queryFn(e){try{return{data:await wC(e)}}catch(r){return{error:new Error(`saveCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`)}}}})})}),{useGetAllUsersLatestCampaignsQuery:SC}=Cn,kC=Cn.endpoints.getCampaign.select,CC=(t,e)=>kC(e)(t).data,Ab=t=>()=>ae(t),Pt=t=>e=>fa(e.gameMenus.userSettings,t)??fa(Jh,t),Zi=()=>ae(CS),_a=Pt("inputAssignment"),XF=t=>t.gameMenus.openMenus.length>0,PC=()=>ae(t=>t.gameMenus.cheatsOn),yb=t=>t.gameMenus.assigningInput!==void 0,xb=()=>ae(yb),EC=t=>{for(const[e,r]of je(sx(ps)))if(P0(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},ys=()=>ae(t=>t.gameMenus.gameRunning),TC=Pt("showFps"),Ja=Pt("displaySettings.emulatedResolution"),RC=()=>ae(Ja),MC=Pt("displaySettings.uncolourised"),wd=()=>ae(MC),IC=Pt("displaySettings.crtFilter"),bb=Pt("infiniteLivesPoke"),qb=Pt("infiniteDoughnutsPoke"),JF=t=>t.gameMenus.gameInPlay.planetsLiberated.egyptus&&t.gameMenus.gameInPlay.planetsLiberated.bookworld&&t.gameMenus.gameInPlay.planetsLiberated.penitentiary&&t.gameMenus.gameInPlay.planetsLiberated.safari,Sa=()=>ae(t=>t.gameMenus.userSettings.screenRelativeControl),vd=Pt("inputDirectionMode"),wb=()=>ae(vd),jC=t=>_u(je(Rn(t.gameMenus.gameInPlay.planetsLiberated)).filter(Boolean)),OC=Pt("displaySettings.showBoundingBoxes"),ZF=()=>ae(OC),BC=Pt("displaySettings.showShadowMasks"),eL=()=>ae(BC),zC=Pt("screenRelativeControl"),NC=Pt("onScreenControls"),DC=Pt("soundSettings.mute"),FC=Pt("soundSettings.noFootsteps"),tL=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??Jh.onScreenControls)&&e.upscale.rotate90===!1,LC=()=>ae(NC),rL=(t,e)=>!!fa(t.gameMenus,e),UC=()=>ae(t=>t.gameMenus.gameInPlay.roomsExplored),vb=t=>{const e=HC(t);if(!e)throw new Error(`No current campaign. Campaign locator is:
${JSON.stringify(t.gameMenus.gameInPlay.campaignLocator,null,2)}`);return e},Vb=Ab(vb),HC=t=>{const e=t.gameMenus.gameInPlay.campaignLocator;return e===void 0?void 0:CC(t,e)},as=({children:t,scaleFactor:e})=>{const r=Zi();return p.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},Ku=4,Ro=20,$C=()=>{const t=Object.keys(er.frames).sort();return p.jsxs(p.Fragment,{children:[p.jsx("img",{src:cx,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),p.jsx("title",{children:"Sprites"}),p.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:t.map(e=>{const{frame:r}=er.frames[e],n=r;return p.jsxs("div",{className:"bg-shadow m-[8px] p-[16px] text-center flex flex-col",children:[p.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border-1 mb-1 box-content mx-auto w-min",style:{"--x":`${er.frames[e].frame.x}px`,"--y":`${er.frames[e].frame.y}px`,"--h":`${er.frames[e].frame.h}px`,"--w":`${er.frames[e].frame.w}px`},children:n.pivot?p.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${Ro}px`,height:`${Ro}px`,left:`${n.pivot.x*Ku-Ro/2}px`,top:`${n.pivot.y*Ku-Ro/2}px`}}):null}),p.jsx("div",{className:"flex-grow"}),p.jsx("div",{className:"text-moss",children:e}),p.jsxs("div",{className:"text-lightGrey",children:[r.w,"x",r.h]}),p.jsx("div",{className:"text-midRed",children:n.pivot?p.jsxs(p.Fragment,{children:["pivot: (",n.pivot.x,",",n.pivot.y,")"]}):"no pivot"}),p.jsxs("div",{className:"text-midGrey",children:["@(",r.x,",",r.y,")"]})]},e)})})]})},WC=()=>p.jsx(as,{scaleFactor:Ku,children:p.jsx($C,{})}),Vd=C.createContext(null),GC=({gameApi:t,children:e})=>p.jsx(Vd,{value:t,children:e}),Ts=()=>{const t=C.useContext(Vd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},QC=()=>{const t=C.useContext(Vd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},Ci=(t,...e)=>{const r={};for(const n of e)r[n]=t[n];return r},nL=(t,...e)=>{const r={...t};for(const n of e)delete r[n];return r};function YC(t){var e="";return r(t),e;function r(s){if(s===null||typeof s!="object"||s.toJSON!=null)e+=JSON.stringify(s);else if(Array.isArray(s)){e+="[";var i=!1;s.forEach(function(a){i&&(e+=","),i=!0,a===void 0&&(a=null),r(a)}),e+="]"}else{e+="{";var o=Object.keys(s).filter(function(a){return s[a]!==void 0}).sort();o.forEach(function(a,l){return n(s,a,l)}),e+="}"}}function n(s,i,o){o>0&&(e+=","),e+=JSON.stringify(i),e+=":",r(s[i])}}const Xu=t=>JSON.parse(JSON.stringify(t)),KC=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],XC=(t,e)=>je(Qh(t)).map(r=>{const n=e.items[r];if(n===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return n});function _b(t,e){return t===null?null:e.items[t]}const ue={w:16,d:16,h:12},Jm={x:16,y:16,z:12},JC=["head","heels"],ZC=[...JC,"headOverHeels"],ls=t=>t==="head"?"heels":"head",Sb="@@original",eP="original",tP={userId:Sb,campaignName:eP,version:-1},Re=(...t)=>e=>t.includes(e.type),rP=Re("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),nP=(t,e)=>rP(t)||ts(t)&&(e!==void 0&&Pb(e)||t.config.direction.z!==0)||Ju(t)&&t.config.floorType==="none",Pi=(t,e)=>!nP(t,e),sP=t=>t.type==="movingPlatform"||t.type==="pushableBlock",kb=(t,e,r=!1)=>cs(e)&&!(!r&&Pb(e)&&e.state.autoWalk)&&!(hP(t)&&sP(e))&&!(_d(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),Cb=["ball","slidingBlock","slidingDeadly"],iP=Re(...Cb),oP=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],aP=["dalek","turtle","elephantHead","homingBot","helicopterBug"],sL=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?aP.includes(t.config.which):oP.includes(t.type),Pb=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function cs(t){return Eb.includes(t.type)}const Eb=[...ZC,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],lP=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],cP=Re(...lP),iL=t=>_d(t)&&!t.state.activated?!1:cP(t)||t.type==="floor"&&t.config.floorType==="deadly",uP=t=>t.config.times!==void 0,ts=Re("portal"),oL=Re("teleporter");Re("heels");Re("head");const aL=Re("heels","headOverHeels"),lL=Re("head","headOverHeels"),hP=Re("lift"),cL=Re("emitter"),_d=Re("monster"),Ju=Re("floor"),dP=Re("pickup"),uL=t=>dP(t)&&t.config.gives==="crown",hL=Re("spring"),dL=Re("joystick"),fL=Re("monster","movingPlatform"),pL=t=>_d(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,Zu=(t,e)=>{if(t.state.standingOnItemId!==null){const r=_b(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime}},Pn=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;cs(r)&&Zu(r,t);for(const n of XC(r.state.stoodOnBy,t))Zu(n,t);typeof e=="string"?delete t.items[e]:delete t.items[r.id]},fP=(t,e,r)=>{const n=Xu({saveTime:Date.now(),gameState:Ci(t,...KC),store:{gameMenus:{gameInPlay:e.gameMenus.gameInPlay}}});if(r!==void 0){const s=n.gameState,i=s.characterRooms[s.currentCharacterName];if(!i)throw new Error("how are we saving from a pickup if there is no current room?");Pn({room:i,item:i.items[r]})}return n},Zm=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]};var Sd="persist:",kd="persist/FLUSH",eo="persist/REHYDRATE",Cd="persist/PAUSE",Pd="persist/PERSIST",Ed="persist/PURGE",Td="persist/REGISTER",Tb=-1;function na(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?na=function(r){return typeof r}:na=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},na(t)}function eg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function pP(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eg(r,!0).forEach(function(n){mP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eg(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mP(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gP(t,e,r,n){n.debug;var s=pP({},r);return t&&na(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(s[i]=t[i])}),s}function AP(t){var e=t.blacklist||null,r=t.whitelist||null,n=t.transforms||[],s=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:Sd).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(V){return V}:typeof t.serialize=="function"?a=t.serialize:a=yP;var l=t.writeFailHandler||null,c={},u={},h=[],d=null,f=null,m=function(V){Object.keys(V).forEach(function(_){y(_)&&c[_]!==V[_]&&h.indexOf(_)===-1&&h.push(_)}),Object.keys(c).forEach(function(_){V[_]===void 0&&y(_)&&h.indexOf(_)===-1&&c[_]!==void 0&&h.push(_)}),d===null&&(d=setInterval(A,s)),c=V};function A(){if(h.length===0){d&&clearInterval(d),d=null;return}var q=h.shift(),V=n.reduce(function(_,v){return v.in(_,q,c)},c[q]);if(V!==void 0)try{u[q]=a(V)}catch(_){console.error("redux-persist/createPersistoid: error serializing state",_)}else delete u[q];h.length===0&&g()}function g(){Object.keys(u).forEach(function(q){c[q]===void 0&&delete u[q]}),f=o.setItem(i,a(u)).catch(b)}function y(q){return!(r&&r.indexOf(q)===-1&&q!=="_persist"||e&&e.indexOf(q)!==-1)}function b(q){l&&l(q)}var x=function(){for(;h.length!==0;)A();return f||Promise.resolve()};return{update:m,flush:x}}function yP(t){return JSON.stringify(t)}function xP(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Sd).concat(t.key),n=t.storage;t.debug;var s;return t.deserialize===!1?s=function(o){return o}:typeof t.deserialize=="function"?s=t.deserialize:s=bP,n.getItem(r).then(function(i){if(i)try{var o={},a=s(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},s(a[l]))}),o}catch(l){throw l}else return})}function bP(t){return JSON.parse(t)}function qP(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Sd).concat(t.key);return e.removeItem(r,wP)}function wP(t){}function tg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tg(r,!0).forEach(function(n){vP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tg(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vP(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VP(t,e){if(t==null)return{};var r=_P(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function _P(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}var SP=5e3;function kP(t,e){var r=t.version!==void 0?t.version:Tb;t.debug;var n=t.stateReconciler===void 0?gP:t.stateReconciler,s=t.getStoredState||xP,i=t.timeout!==void 0?t.timeout:SP,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var d=u||{},f=d._persist,m=VP(d,["_persist"]),A=m;if(h.type===Pd){var g=!1,y=function(S,E){g||(h.rehydrate(t.key,S,E),g=!0)};if(i&&setTimeout(function(){!g&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=AP(t)),f)return yr({},e(A,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),s(t).then(function(v){var S=t.migrate||function(E,R){return Promise.resolve(E)};S(v,r).then(function(E){y(E)},function(E){y(void 0,E)})},function(v){y(void 0,v)}),yr({},e(A,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===Ed)return a=!0,h.result(qP(t)),yr({},e(A,h),{_persist:f});if(h.type===kd)return h.result(o&&o.flush()),yr({},e(A,h),{_persist:f});if(h.type===Cd)l=!0;else if(h.type===eo){if(a)return yr({},A,{_persist:yr({},f,{rehydrated:!0})});if(h.key===t.key){var b=e(A,h),x=h.payload,q=n!==!1&&x!==void 0?n(x,u,b,t):b,V=yr({},q,{_persist:yr({},f,{rehydrated:!0})});return c(V)}}}if(!f)return e(u,h);var _=e(A,h);return _===A?u:c(yr({},_,{_persist:f}))}}function rg(t){return EP(t)||PP(t)||CP()}function CP(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function PP(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function EP(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function ng(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function eh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ng(r,!0).forEach(function(n){TP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ng(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TP(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Rb={registry:[],bootstrapped:!1},RP=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rb,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Td:return eh({},e,{registry:[].concat(rg(e.registry),[r.key])});case eo:var n=e.registry.indexOf(r.key),s=rg(e.registry);return s.splice(n,1),eh({},e,{registry:s,bootstrapped:s.length===0});default:return e}};function MP(t,e,r){var n=Zh(RP,Rb,void 0),s=function(l){n.dispatch({type:Td,key:l})},i=function(l,c,u){var h={type:eo,payload:c,err:u,key:l};t.dispatch(h),n.dispatch(h)},o=eh({},n,{purge:function(){var l=[];return t.dispatch({type:Ed,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:kd,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:Cd})},persist:function(){t.dispatch({type:Pd,register:s,rehydrate:i})}});return o.persist(),o}function IP(t,e){return function(r,n){if(!r)return Promise.resolve(void 0);var s=r._persist&&r._persist.version!==void 0?r._persist.version:Tb;if(s===n||s>n)return Promise.resolve(r);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return n>=a&&a>s}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},r);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const Mb=[],Ib=new Set,mL=new Map;Ib.add=()=>{throw new Error("emptySet.add")};Ib.clear=()=>{throw new Error("emptySet.clear")};const ye=Object.freeze({}),Rs=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t),Rd=()=>Rs().get("campaignName")?.startsWith("data:"),gL=["none","non-wall","all"],Mo=t=>YC(Ci(t,"userId","campaignName")),jP=["4-way","8-way","analogue"],OP=St()!=="server",BP=OP?Rs().has("cheats"):!1,zP={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},jb={planetsLiberated:zP,roomsExplored:{},scrollsRead:{},reincarnationPoint:void 0},th={userSettings:{displaySettings:{},soundSettings:{}},gameRunning:!1,gameInPlay:jb,openMenus:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ye}],assigningInput:void 0,cheatsOn:BP,savedGames:{saves:{}}},to=wr({name:"gameMenus",initialState:th,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=Zm(o0,Ja({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},scrollRead(t,{payload:e}){e.source==="manual"?(t.gameInPlay.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:ye}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=Zm(jP,vd({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(o,a)=>{o.includes(a)||o.push(a)},{presses:n,axes:s,action:i}=t.assigningInput;switch(e.type){case"key":r(n.keys,e.input);break;case"gamepadButtons":r(n.gamepadButtons,e.input);break;case"gamepadAxes":{Hi.includes(i)&&r(s,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:n}=t.assigningInput,s=r.keys.length+r.gamepadButtons.length+n.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(ps.default.inputAssignment):t.userSettings.inputAssignment;s>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=n),(e==="towards"||e==="away")&&(i.axes.y=n)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ye}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},closeAllMenus(t){t.openMenus=[]},gameStarted(t,{payload:{campaignLocator:e,noShowCrowns:r}}){if(t.gameRunning)throw new Error("game is already running");t.openMenus=r?[]:[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.gameInPlay={...jb,campaignLocator:e}},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=ps[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[n]=t.openMenus;n.focussedItemId=e,n.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:ye}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:ye}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){i_(t,e,!fa(t,e))},crownCollected(t,{payload:e}){t.gameInPlay.planetsLiberated[e]=!0;const r=Object.values(t.gameInPlay.planetsLiberated).every(s=>s),n={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:ye},n]:t.openMenus=[n]},roomExplored(t,{payload:e}){t.gameInPlay.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){if(e&&t.gameInPlay.reincarnationPoint!==void 0)t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ye},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:ye}];else{t.gameRunning=!1,delete t.gameInPlay.reincarnationPoint;const r=t.gameInPlay.campaignLocator;delete t.savedGames.saves[Mo(r)],delete t.savedGames.lastSavedCampaignLocator,t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ye},{menuId:"mainMenu",scrollableSelection:!0,menuParam:ye}]}},reincarnationFishEaten(t,{payload:e}){t.gameInPlay.reincarnationPoint=e},reincarnationAccepted(t){delete t.gameInPlay.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:ye}]},saveGame(t,{payload:e}){const r=t.gameInPlay.campaignLocator;if(r===void 0)throw new Error("trying to save a game, but seems like there's no campaign to save against");if(Rd())throw new Error("shouldn't be saving in playtest mode");t.savedGames.saves[Mo(r)]=e,t.savedGames.lastSavedCampaignLocator=r},gameRestoreFromSave(t,{payload:e}){t.gameInPlay=e},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,th),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){}},extraReducers(t){t.addCase(eo,(e,r)=>{if(Rs().get("campaignName")?.startsWith("data:"))return;const n=r.payload?.savedGames,s=n?.lastSavedCampaignLocator,i=s&&n.saves[Mo(s)];i&&(e.gameRunning=!0,e.gameInPlay=i.store.gameMenus.gameInPlay,e.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:ye}])})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")},selectSaveForCampaign(t,e){return t.savedGames.saves[Mo(e)]}}}),{assignInputStart:Mt,backToParentMenu:Oe,characterRoomChange:NP,closeAllMenus:DP,crownCollected:AL,debugItemClicked:FP,doneAssigningInput:LP,errorCaught:Ob,errorDismissed:sg,gameOver:Bb,gameRestoreFromSave:yL,gameStarted:ka,goToSubmenu:yt,holdPressed:zb,inputAddedDuringAssignment:UP,keyAssignmentPresetChosen:HP,mapPressed:$P,menuOpenOrExitPressed:ig,nextInputDirectionMode:WP,reincarnationAccepted:Nb,reincarnationFishEaten:xL,roomExplored:GP,saveGame:QP,scrollRead:bL,setEmulatedResolution:Md,setFocussedMenuItemId:Id,setShowBoundingBoxes:qL,setShowShadowMasks:wL,toggleBoolean:tr}=to.actions,{selectHasError:vL}=to.selectors,VL=to.selectors.selectSaveForCampaign,Db=fS(),YP=Db.startListening.withTypes(),KP=()=>{St()!=="server"&&YP({actionCreator:Md,effect(t,{dispatch:e,getState:r}){const{emulatedResolution:n}=r().gameMenus.userSettings.displaySettings;n!==void 0&&e(zx(ud(n)))}})},XP={count:0},Ca=wr({name:"manualLoading",initialState:XP,reducers:{manualLoadingStarted(t){t.count++},manualLoadingFinished(t){t.count=Math.max(0,t.count-1)}},selectors:{selectManualLoadingCount(t){return t.count}}}),{manualLoadingStarted:JP,manualLoadingFinished:og}=Ca.actions,{selectManualLoadingCount:ZP}=Ca.selectors,st=t=>{const e=th.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},eE=IP({1:st,2:st,3:st,4:st,5:st,6:st,7:st,8:st,9:st,10:st,11:st,12:st,13:st,14:st,15:st,16:st,17:st});var Qs={},Io={},jo={},ag;function tE(){if(ag)return jo;ag=1,jo.__esModule=!0,jo.default=s;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function n(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function s(i){var o="".concat(i,"Storage");return n(o)?self[o]:r}return jo}var lg;function rE(){if(lg)return Io;lg=1,Io.__esModule=!0,Io.default=r;var t=e(tE());function e(n){return n&&n.__esModule?n:{default:n}}function r(n){var s=(0,t.default)(n);return{getItem:function(o){return new Promise(function(a,l){a(s.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(s.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(s.removeItem(o))})}}}return Io}var cg;function nE(){if(cg)return Qs;cg=1,Qs.__esModule=!0,Qs.default=void 0;var t=e(rE());function e(n){return n&&n.__esModule?n:{default:n}}var r=(0,t.default)("local");return Qs.default=r,Qs}var sE=nE();const iE=rt(sE),oE=["userSettings","savedGames"],aE=17,lE={key:"hohol/gameMenus/userSettings",version:aE,migrate:eE,storage:iE,whitelist:oE},cE=kP(lE,to.reducer),rh=qS({[to.reducerPath]:cE,[qa.reducerPath]:qa.reducer,[Cn.reducerPath]:Cn.reducer,[Ca.reducerPath]:Ca.reducer}).withLazyLoadedSlices();rh.inject;const uE=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?rh(void 0,e):rh(t,e),be=D_({reducer:uE,middleware:t=>t({serializableCheck:{ignoredActions:[kd,eo,Cd,Pd,Ed,Td,FP.type]}}).prepend(Db.middleware).concat(Cn.middleware)});KP();const hE=MP(be),dE=()=>{const t=Xh(),e=QC();C.useEffect(()=>{if(e===void 0)return;const r=()=>{Rd()||(t(QP(fP(e.gameState,be.getState()))),hE.flush())},n=()=>{document.visibilityState==="hidden"&&(t(zb("hold")),r())};return document.addEventListener("visibilitychange",n),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",n),window.removeEventListener("beforeunload",r)}},[t,e])},fE=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape",""],pE=t=>fE.includes(t);let mE=1;const gE=()=>mE++,AE=3,ug=({key:t,location:e,repeat:r})=>{if(r)return;const n=t.length===1?t.toUpperCase():t,s=e===AE?`Numpad${n}`:n;if(pE(s))return s;console.warn("unrecognised key",t)},yE=()=>new Map,xE=t=>{const e=s=>{const i=ug(s);i!==void 0&&t.set(i,gE())},r=s=>{const i=ug(s);i!==void 0&&t.delete(i)},n=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",n,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",n,!1)}},Fb=t=>t==="left"?{axis:"x",direction:-1}:t==="right"?{axis:"x",direction:1}:t==="towards"?{axis:"y",direction:1}:t==="away"?{axis:"y",direction:-1}:void 0;var te=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(te||{});const nh=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Oo=(t,e)=>nh(t).priority??e,kt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(nh).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(nh).forEach(e=>{e.type.forEach(r=>{const n=this._addHandlers,s=this._queue;n[r]?n[r]?.(e):(s[r]=s[r]||[],s[r]?.push(e))})}),this},handle(t,e,r){const n=this._addHandlers,s=this._removeHandlers;if(n[t]||s[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,s[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,n=>{e.findIndex(i=>i.name===n.name)>=0||(e.push({name:n.name,value:n.ref}),e.sort((i,o)=>Oo(o.value,r)-Oo(i.value,r)))},n=>{const s=e.findIndex(i=>i.name===n.name);s!==-1&&e.splice(s,1)})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((s,i)=>Oo(i,r)-Oo(s,r)))},n=>{const s=e.indexOf(n.ref);s!==-1&&e.splice(s,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},bE={extension:{type:te.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await fr(()=>import("./browserAll-6H-PA5gs.js"),__vite__mapDeps([3,4,5,6,1,2]))}},qE={extension:{type:te.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await fr(()=>import("./webworkerAll-DySfygwB.js"),__vite__mapDeps([4,5,6,1,2]))}};class zt{constructor(e,r,n){this._x=r||0,this._y=n||0,this._observer=e}clone(e){return new zt(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var vc={exports:{}},hg;function wE(){return hg||(hg=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,h||l,d),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,m=new Array(f);d<f;d++)m[d]=h[d].fn;return m},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,m){var A=r?r+c:c;if(!this._events[A])return!1;var g=this._events[A],y=arguments.length,b,x;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,d),!0;case 5:return g.fn.call(g.context,u,h,d,f),!0;case 6:return g.fn.call(g.context,u,h,d,f,m),!0}for(x=1,b=new Array(y-1);x<y;x++)b[x-1]=arguments[x];g.fn.apply(g.context,b)}else{var q=g.length,V;for(x=0;x<q;x++)switch(g[x].once&&this.removeListener(c,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,u);break;case 3:g[x].fn.call(g[x].context,u,h);break;case 4:g[x].fn.call(g[x].context,u,h,d);break;default:if(!b)for(V=1,b=new Array(y-1);V<y;V++)b[V-1]=arguments[V];g[x].fn.apply(g[x].context,b)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var A=0,g=[],y=m.length;A<y;A++)(m[A].fn!==u||d&&!m[A].once||h&&m[A].context!==h)&&g.push(m[A]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(vc)),vc.exports}var vE=wE();const pr=rt(vE),VE=Math.PI*2,_E=180/Math.PI,SE=Math.PI/180;class ft{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new ft(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Vc.x=0,Vc.y=0,Vc}}const Vc=new ft;class ge{constructor(e=1,r=0,n=0,s=1,i=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=s,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,s,i,o){return this.a=e,this.b=r,this.c=n,this.d=s,this.tx=i,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new ft;const n=e.x,s=e.y;return r.x=this.a*n+this.c*s+this.tx,r.y=this.b*n+this.d*s+this.ty,r}applyInverse(e,r){r=r||new ft;const n=this.a,s=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(n*o+i*-s),u=e.x,h=e.y;return r.x=o*c*u+-i*c*h+(l*i-a*o)*c,r.y=n*c*h+-s*c*u+(-l*n+a*s)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),s=this.a,i=this.c,o=this.tx;return this.a=s*r-this.b*n,this.b=s*n+this.b*r,this.c=i*r-this.d*n,this.d=i*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,s=this.c,i=this.d;return this.a=e.a*r+e.b*s,this.b=e.a*n+e.b*i,this.c=e.c*r+e.d*s,this.d=e.c*n+e.d*i,this.tx=e.tx*r+e.ty*s+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this}appendFrom(e,r){const n=e.a,s=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,d=r.d;return this.a=n*c+s*h,this.b=n*u+s*d,this.c=i*c+o*h,this.d=i*u+o*d,this.tx=a*c+l*h+r.tx,this.ty=a*u+l*d+r.ty,this}setTransform(e,r,n,s,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+s*this.c),this.ty=r-(n*this.b+s*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,s=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,s=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-s,i),l=Math.atan2(n,r),c=Math.abs(a+l);return c<1e-5||Math.abs(VE-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(s*s+i*i),e.position.x=this.tx+(o.x*r+o.y*s),e.position.y=this.ty+(o.x*n+o.y*i),e}invert(){const e=this.a,r=this.b,n=this.c,s=this.d,i=this.tx,o=e*s-r*n;return this.a=s/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-s*i)/o,this.ty=-(e*this.ty-r*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ge;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return CE.identity()}static get shared(){return kE.identity()}}const kE=new ge,CE=new ge,hn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],dn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],fn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],pn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],sh=[],Lb=[],Bo=Math.sign;function PE(){for(let t=0;t<16;t++){const e=[];sh.push(e);for(let r=0;r<16;r++){const n=Bo(hn[t]*hn[r]+fn[t]*dn[r]),s=Bo(dn[t]*hn[r]+pn[t]*dn[r]),i=Bo(hn[t]*fn[r]+fn[t]*pn[r]),o=Bo(dn[t]*fn[r]+pn[t]*pn[r]);for(let a=0;a<16;a++)if(hn[a]===n&&dn[a]===s&&fn[a]===i&&pn[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new ge;e.set(hn[t],dn[t],fn[t],pn[t],0,0),Lb.push(e)}}PE();const Se={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>hn[t],uY:t=>dn[t],vX:t=>fn[t],vY:t=>pn[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>sh[t][e],sub:(t,e)=>sh[t][Se.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Se.S:Se.N:Math.abs(e)*2<=Math.abs(t)?t>0?Se.E:Se.W:e>0?t>0?Se.SE:Se.SW:t>0?Se.NE:Se.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const s=Lb[Se.inv(e)];s.tx=r,s.ty=n,t.append(s)}},zo=[new ft,new ft,new ft,new ft];class Fe{constructor(e=0,r=0,n=0,s=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Fe(0,0,0,0)}clone(){return new Fe(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,n,s=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=n*(1-s),u=n-c,h=a-c,d=a+i+c,f=l-c,m=l+o+c,A=a+u,g=a+i-u,y=l+u,b=l+o-u;return e>=h&&e<=d&&r>=f&&r<=m&&!(e>A&&e<g&&r>y&&r<b)}intersects(e,r){if(!r){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const n=this.left,s=this.right,i=this.top,o=this.bottom;if(s<=n||o<=i)return!1;const a=zo[0].set(e.left,e.top),l=zo[1].set(e.left,e.bottom),c=zo[2].set(e.right,e.top),u=zo[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=n||Math.min(a.x,l.x,c.x,u.x)>=s||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),m=d*n+f*i,A=d*s+f*i,g=d*n+f*o,y=d*s+f*o;if(Math.max(m,A,g,y)<=d*a.x+f*a.y||Math.min(m,A,g,y)>=d*u.x+f*u.y)return!1;const b=h*(a.y-c.y),x=h*(c.x-a.x),q=b*n+x*i,V=b*s+x*i,_=b*n+x*o,v=b*s+x*o;return!(Math.max(q,V,_,v)<=b*a.x+x*a.y||Math.min(q,V,_,v)>=b*u.x+x*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=s,this.height=Math.max(i-s,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,s=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=s-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=s,this.height=i-s,this}getBounds(e){return e||(e=new Fe),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,n=e.y,s=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height&&s>=this.x&&s<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const _c={default:-1};function Le(t="default"){return _c[t]===void 0&&(_c[t]=-1),++_c[t]}const dg={},dt="8.0.0",EE="8.3.4";function Ie(t,e,r=3){if(dg[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),dg[e]=!0}const Ub=()=>{};function Pa(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function fg(t){return!(t&t-1)&&!!t}function Hb(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const pg=Object.create(null);function TE(t){const e=pg[t];return e===void 0&&(pg[t]=Le("resource")),e}const $b=class Wb extends pr{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...Wb.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){Ie(dt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=TE(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};$b.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let RE=$b;const Gb=class Qb extends pr{constructor(e={}){super(),this.options=e,this.uid=Le("textureSource"),this._resourceType="textureSource",this._resourceId=Le("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...Qb.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new RE(Hb(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Le("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,n){n||(n=this._resolution),e||(e=this.width),r||(r=this.height);const s=Math.round(e*n),i=Math.round(r*n);return this.width=s/n,this.height=i/n,this._resolution=n,this.pixelWidth===s&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=i,this.emit("resize",this),this._resourceId=Le("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=fg(this.pixelWidth)&&fg(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};Gb.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let mr=Gb;class jd extends mr{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let n=e.format;n||(r instanceof Float32Array?n="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?n="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?n="rgba16uint":(r instanceof Int8Array,n="bgra8unorm")),super({...e,resource:r,format:n}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}jd.extension=te.TextureSource;const mg=new ge;class ME{constructor(e,r){this.mapCoord=new ge,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let s=0;s<e.length;s+=2){const i=e[s],o=e[s+1];r[s]=i*n.a+o*n.c+n.tx,r[s+1]=i*n.b+o*n.d+n.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const n=e.orig,s=e.trim;s&&(mg.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(mg));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class me extends pr{constructor({source:e,label:r,frame:n,orig:s,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=Le("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Fe,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new mr,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=s||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ME(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:n,height:s}=this._source,i=r.x/n,o=r.y/s,a=r.width/n,l=r.height/s;let c=this.rotate;if(c){const u=a/2,h=l/2,d=i+u,f=o+h;c=Se.add(c,Se.NW),e.x0=d+u*Se.uX(c),e.y0=f+h*Se.uY(c),c=Se.add(c,2),e.x1=d+u*Se.uX(c),e.y1=f+h*Se.uY(c),c=Se.add(c,2),e.x2=d+u*Se.uX(c),e.y2=f+h*Se.uY(c),c=Se.add(c,2),e.x3=d+u*Se.uX(c),e.y3=f+h*Se.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Ie(dt,"Texture.baseTexture is now Texture.source"),this._source}}me.EMPTY=new me({label:"EMPTY",source:new mr({label:"EMPTY"})});me.EMPTY.destroy=Ub;me.WHITE=new me({source:new jd({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});me.WHITE.destroy=Ub;function IE(t,e,r){const{width:n,height:s}=r.orig,i=r.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*n,t.maxX=t.minX+o,t.minY=i.y-e._y*s,t.maxY=t.minY+a}else t.minX=-e._x*n,t.maxX=t.minX+n,t.minY=-e._y*s,t.maxY=t.minY+s}const gg=new ge;class sr{constructor(e=1/0,r=1/0,n=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=gg,this.minX=e,this.minY=r,this.maxX=n,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Fe);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=gg,this}set(e,r,n,s){this.minX=e,this.minY=r,this.maxX=n,this.maxY=s}addFrame(e,r,n,s,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let d=this.minX,f=this.minY,m=this.maxX,A=this.maxY,g=o*e+l*r+u,y=a*e+c*r+h;g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*n+l*r+u,y=a*n+c*r+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*e+l*s+u,y=a*e+c*s+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*n+l*s+u,y=a*n+c*s+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),this.minX=d,this.minY=f,this.maxX=m,this.maxY=A}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,n=this.minY,s=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let d=o*r+l*n+u,f=a*r+c*n+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*s+l*n+u,f=a*s+c*n+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+l*i+u,f=a*r+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*s+l*i+u,f=a*s+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,n,s){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<n&&(this.minY=n),this.maxY>s&&(this.maxY=s),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new sr(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,n,s){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;s||(s=this.matrix);const c=s.a,u=s.b,h=s.c,d=s.d,f=s.tx,m=s.ty;for(let A=r;A<n;A+=2){const g=e[A],y=e[A+1],b=c*g+h*y+f,x=u*g+d*y+m;i=b<i?b:i,o=x<o?x:o,a=b>a?b:a,l=x>l?x:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var jE={grad:.9,turn:360,rad:360/(2*Math.PI)},xr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Ze=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Yt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},Yb=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Ag=function(t){return{r:Yt(t.r,0,255),g:Yt(t.g,0,255),b:Yt(t.b,0,255),a:Yt(t.a)}},Sc=function(t){return{r:Ze(t.r),g:Ze(t.g),b:Ze(t.b),a:Ze(t.a,3)}},OE=/^#([0-9a-f]{3,8})$/i,No=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Kb=function(t){var e=t.r,r=t.g,n=t.b,s=t.a,i=Math.max(e,r,n),o=i-Math.min(e,r,n),a=o?i===e?(r-n)/o:i===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:s}},Xb=function(t){var e=t.h,r=t.s,n=t.v,s=t.a;e=e/360*6,r/=100,n/=100;var i=Math.floor(e),o=n*(1-r),a=n*(1-(e-i)*r),l=n*(1-(1-e+i)*r),c=i%6;return{r:255*[n,a,o,o,l,n][c],g:255*[l,n,n,a,o,o][c],b:255*[o,o,l,n,n,a][c],a:s}},yg=function(t){return{h:Yb(t.h),s:Yt(t.s,0,100),l:Yt(t.l,0,100),a:Yt(t.a)}},xg=function(t){return{h:Ze(t.h),s:Ze(t.s),l:Ze(t.l),a:Ze(t.a,3)}},bg=function(t){return Xb((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},gi=function(t){return{h:(e=Kb(t)).h,s:(s=(200-(r=e.s))*(n=e.v)/100)>0&&s<200?r*n/100/(s<=100?s:200-s)*100:0,l:s/2,a:e.a};var e,r,n,s},BE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,zE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,NE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,DE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ih={string:[[function(t){var e=OE.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Ze(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Ze(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=NE.exec(t)||DE.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Ag({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=BE.exec(t)||zE.exec(t);if(!e)return null;var r,n,s=yg({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(jE[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return bg(s)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,s=t.a,i=s===void 0?1:s;return xr(e)&&xr(r)&&xr(n)?Ag({r:Number(e),g:Number(r),b:Number(n),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,s=t.a,i=s===void 0?1:s;if(!xr(e)||!xr(r)||!xr(n))return null;var o=yg({h:Number(e),s:Number(r),l:Number(n),a:Number(i)});return bg(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,s=t.a,i=s===void 0?1:s;if(!xr(e)||!xr(r)||!xr(n))return null;var o=function(a){return{h:Yb(a.h),s:Yt(a.s,0,100),v:Yt(a.v,0,100),a:Yt(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(i)});return Xb(o)},"hsv"]]},qg=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},FE=function(t){return typeof t=="string"?qg(t.trim(),ih.string):typeof t=="object"&&t!==null?qg(t,ih.object):[null,void 0]},kc=function(t,e){var r=gi(t);return{h:r.h,s:Yt(r.s+100*e,0,100),l:r.l,a:r.a}},Cc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},wg=function(t,e){var r=gi(t);return{h:r.h,s:r.s,l:Yt(r.l+100*e,0,100),a:r.a}},oh=function(){function t(e){this.parsed=FE(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Ze(Cc(this.rgba),2)},t.prototype.isDark=function(){return Cc(this.rgba)<.5},t.prototype.isLight=function(){return Cc(this.rgba)>=.5},t.prototype.toHex=function(){return e=Sc(this.rgba),r=e.r,n=e.g,s=e.b,o=(i=e.a)<1?No(Ze(255*i)):"","#"+No(r)+No(n)+No(s)+o;var e,r,n,s,i,o},t.prototype.toRgb=function(){return Sc(this.rgba)},t.prototype.toRgbString=function(){return e=Sc(this.rgba),r=e.r,n=e.g,s=e.b,(i=e.a)<1?"rgba("+r+", "+n+", "+s+", "+i+")":"rgb("+r+", "+n+", "+s+")";var e,r,n,s,i},t.prototype.toHsl=function(){return xg(gi(this.rgba))},t.prototype.toHslString=function(){return e=xg(gi(this.rgba)),r=e.h,n=e.s,s=e.l,(i=e.a)<1?"hsla("+r+", "+n+"%, "+s+"%, "+i+")":"hsl("+r+", "+n+"%, "+s+"%)";var e,r,n,s,i},t.prototype.toHsv=function(){return e=Kb(this.rgba),{h:Ze(e.h),s:Ze(e.s),v:Ze(e.v),a:Ze(e.a,3)};var e},t.prototype.invert=function(){return lr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),lr(kc(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),lr(kc(this.rgba,-e))},t.prototype.grayscale=function(){return lr(kc(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),lr(wg(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),lr(wg(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?lr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Ze(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=gi(this.rgba);return typeof e=="number"?lr({h:e,s:r.s,l:r.l,a:r.a}):Ze(r.h)},t.prototype.isEqual=function(e){return this.toHex()===lr(e).toHex()},t}(),lr=function(t){return t instanceof oh?t:new oh(t)},vg=[],LE=function(t){t.forEach(function(e){vg.indexOf(e)<0&&(e(oh,ih),vg.push(e))})};function UE(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var s in r)n[r[s]]=s;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=n[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,d="black";if(!i.length)for(var f in r)i[f]=new t(r[f]).toRgb();for(var m in r){var A=(a=u,l=i[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<h&&(h=A,d=m)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}LE([UE]);const xs=class si{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof si)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,o)=>i===r[o]);if(e!==null&&r!==null){const i=Object.keys(e),o=Object.keys(r);return i.length!==o.length?!1:i.every(a=>e[a]===r[a])}return e===r}toRgba(){const[e,r,n,s]=this._components;return{r:e,g:r,b:n,a:s}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(s*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,n,s,i]=this._components;return e[0]=r,e[1]=n,e[2]=s,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,n,s]=this._components;return e[0]=r,e[1]=n,e[2]=s,e}toNumber(){return this._int}toBgrNumber(){const[e,r,n]=this.toUint8RgbArray();return(n<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,s,i]=si._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=s,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,s=this._int>>8&255,i=this._int&255;return r&&(n=n*e+.5|0,s=s*e+.5|0,i=i*e+.5|0),(e*255<<24)+(n<<16)+(s<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,n,s,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,s=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,s,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,s,i=255]=e,r/=255,n/=255,s/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=si.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=lr(e);o.isValid()&&({r,g:n,b:s,a:i}=o.rgba,r/=255,n/=255,s/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=s,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((s,i)=>{e[i]=Math.min(Math.max(s,r),n)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof si||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};xs.shared=new xs;xs._temp=new xs;xs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let lt=xs;const HE={cullArea:null,cullable:!1,cullableChildren:!0};class Od{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class $E{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Od(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const n=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[n]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const kr=new $E,WE={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){Ie("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function GE(t,e,r){const n=t.length;let s;if(e>=n||r===0)return;r=e+r>n?n-e:r;const i=n-r;for(s=e;s<i;++s)t[s]=t[s+r];t.length=i}const QE={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,n=r-t,s=[];if(n>0&&n<=r){for(let o=r-1;o>=t;o--){const a=this.children[o];a&&(s.push(a),a.parent=null)}GE(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(s);for(let o=0;o<s.length;++o)this.emit("childRemoved",s[o],this,o),s[o].emit("removed",this);return s.length>0&&this._didViewChangeTick++,s}else if(n===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||Ie(dt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const s=t.parent.children.indexOf(t);if(t.parent===this&&s===e)return t;s!==-1&&t.parent.children.splice(s,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const n=this.worldTransform.clone();return n.invert(),r.prepend(n),t.setFromMatrix(r),t}},YE={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const n=this.children,s=n.length;for(let i=0;i<s;i++)n[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:n}=e;for(let s=0;s<this.effects.length;s++){const i=this.effects[s];n[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let s=this.effects.length-1;s>=0;s--){const i=this.effects[s];n[i.pipe].pop(i,this,t)}}};class Vg{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class KE{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const n=this._tests[r];if(n.test(e))return kr.get(n.maskClass,e)}return e}returnMaskEffect(e){kr.return(e)}}const ah=new KE;kt.handleByList(te.MaskEffect,ah._effectClasses);const XE={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,n)=>r.priority-n.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),ah.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=ah.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Vg);t=t;const r=t?.length>0,n=e.filters?.length>0,s=r!==n;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),s&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Vg),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},JE={label:null,get name(){return Ie(dt,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){Ie(dt,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let n=0;n<r.length;n++){const s=r[n];if(s.label===t||t instanceof RegExp&&t.test(s.label))return s}if(e)for(let n=0;n<r.length;n++){const i=r[n].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const n=this.children;for(let s=0;s<n.length;s++){const i=n[s];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let s=0;s<n.length;s++)n[s].getChildrenByLabel(t,!0,r);return r}},xt=new Od(ge),Cr=new Od(sr),ZE=new ge,eT={getFastGlobalBounds(t,e){e||(e=new sr),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let n=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const s=!!this.effects.length;if((this.renderGroup||s)&&(n=Cr.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;n.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,n,r)}if(s){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,n.applyMatrix(o.worldTransform)),this.effects[a].addBounds(n,!0));i&&(n.applyMatrix(o.worldTransform.copyTo(ZE).invert()),e.addBounds(n,this.relativeGroupTransform)),e.addBounds(n),Cr.return(n)}else this.renderGroup&&(e.addBounds(n,this.relativeGroupTransform),Cr.return(n))}};function Jb(t,e,r){r.clear();let n,s;return t.parent?e?n=t.parent.worldTransform:(s=xt.get().identity(),n=Bd(t,s)):n=ge.IDENTITY,Zb(t,r,n,e),s&&xt.return(s),r.isValid||r.set(0,0,0,0),r}function Zb(t,e,r,n){if(!t.visible||!t.measurable)return;let s;n?s=t.worldTransform:(t.updateLocalTransform(),s=xt.get(),s.appendFrom(t.localTransform,r));const i=e,o=!!t.effects.length;if(o&&(e=Cr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,s);else{t.bounds&&(e.matrix=s,e.addBounds(t.bounds));for(let a=0;a<t.children.length;a++)Zb(t.children[a],e,s,n)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,ge.IDENTITY),Cr.return(e)}n||xt.return(s)}function Bd(t,e){const r=t.parent;return r&&(Bd(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function eq(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,n=t>>8&255,s=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=r*i/255|0,c=n*o/255|0,u=s*a/255|0;return(l<<16)+(c<<8)+u}const _g=16777215;function Sg(t,e){return t===_g?e:e===_g?t:eq(t,e)}function sa(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const tT={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=Bd(this,xt.get().identity());return t.appendFrom(this.localTransform,r),xt.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?sa(this.renderGroup.worldColor):this.parentRenderGroup?sa(Sg(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=Sg(e,r.localColor),r=r.parent;return sa(e)}};let Pc=0;const kg=500;function ke(...t){Pc!==kg&&(Pc++,Pc===kg?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function tq(t,e,r){return e.clear(),r||(r=ge.IDENTITY),rq(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function rq(t,e,r,n,s){let i;if(s)i=xt.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=xt.get(),i.appendFrom(l,r)}const o=e,a=!!t.effects.length;if(a&&(e=Cr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)rq(l[c],e,i,n,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,n);o.addBounds(e,ge.IDENTITY),Cr.return(e)}xt.return(i)}function nq(t,e){const r=t.children;for(let n=0;n<r.length;n++){const s=r[n],i=s.uid,o=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,s.children.length&&nq(s,e)}return e.didChange}const rT=new ge,nT={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new sr});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),nq(this,t),t.didChange&&tq(this,t.localBounds,rT),t.localBounds},getBounds(t,e){return Jb(this,t,e||new sr)}},sT={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},iT={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(oT))}};function oT(t,e){return t._zIndex-e._zIndex}const aT={getGlobalPosition(t=new ft,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const n=this.getGlobalTransform(xt.get(),r);return e=n.apply(t,e),xt.return(n),e},toLocal(t,e,r,n){e&&(t=e.toGlobal(t,r,n));const s=this.getGlobalTransform(xt.get(),n);return r=s.applyInverse(t,r),xt.return(s),r}};class sq{constructor(){this.uid=Le("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let lT=0;class cT{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,n){const s=new mr({...this.textureOptions,width:e,height:r,resolution:1,antialias:n,autoGarbageCollect:!1});return new me({source:s,label:`texturePool_${lT++}`})}getOptimalTexture(e,r,n=1,s){let i=Math.ceil(e*n-1e-6),o=Math.ceil(r*n-1e-6);i=Pa(i),o=Pa(o);const a=(i<<17)+(o<<1)+(s?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,s)),l.source._resolution=n,l.source.width=i/n,l.source.height=o/n,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,r=!1){const n=e.source;return this.getOptimalTexture(e.width,e.height,n._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const n=this._texturePool[r];if(n)for(let s=0;s<n.length;s++)n[s].destroy(!0)}this._texturePool={}}}const uT=new cT;class hT{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ge,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new sq,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let n=0;n<r.length;n++){const s=r[n];s._updateFlags=15,this.addChild(s)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(uT.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let n=0;n<r.length;n++)this.addChild(r[n])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let n=0;n<r.length;n++)this.removeChild(r[n])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let n=0;n<r.length;n++)this._getChildren(r[n],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const n=e.children;for(let s=0;s<n.length;s++)this._getChildren(n[s],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new ge),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new ge),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new ge),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function dT(t,e,r={}){for(const n in e)!r[n]&&e[n]!==void 0&&(t[n]=e[n])}const Ec=new zt(null),Tc=new zt(null),Rc=new zt(null,1,1),Cg=1,fT=2,Mc=4;class ro extends pr{constructor(e={}){super(),this.uid=Le("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ge,this.relativeGroupTransform=new ge,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new zt(this,0,0),this._scale=Rc,this._pivot=Tc,this._skew=Ec,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],dT(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){Ie("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),kt.mixin(ro,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||Ie(dt,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let s=0;s<e.length;s++)this.addChild(e[s]);return e[0]}const r=e[0],n=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),n&&(n.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,n&&n.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let s=0;s<e.length;s++)this.removeChild(e[s]);return e[0]}const r=e[0],n=this.children.indexOf(r);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,n),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=kr.get(hT,this),this.groupTransform=ge.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),kr.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ge),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*_E}set angle(e){this.rotation=e*SE}get pivot(){return this._pivot===Tc&&(this._pivot=new zt(this,0,0)),this._pivot}set pivot(e){this._pivot===Tc&&(this._pivot=new zt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Ec&&(this._skew=new zt(this,0,0)),this._skew}set skew(e){this._skew===Ec&&(this._skew=new zt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Rc&&(this._scale=new zt(this,1,1)),this._scale}set scale(e){this._scale===Rc&&(this._scale=new zt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const n=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,n.width),r!==void 0&&this._setHeight(r,n.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,n=this._scale,s=this._pivot,i=this._position,o=n._x,a=n._y,l=s._x,c=s._y;r.a=this._cx*o,r.b=this._sx*o,r.c=this._cy*a,r.d=this._sy*a,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Cg,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const n=lt.shared.setValue(e??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=Cg,this._onUpdate())}get tint(){return sa(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=fT,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Mc,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Mc,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Mc,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let s=0;s<r.length;++s)r[s].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}kt.mixin(ro,QE,eT,aT,sT,nT,XE,JE,iT,HE,WE,tT,YE);class pT extends ro{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new sr(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:n,y:s}=e;return n>=r.minX&&n<=r.maxX&&s>=r.minY&&s<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,n){const{renderPipes:s,renderableGC:i}=r;s.blendMode.setBlendMode(this,this.groupBlendMode,e),s[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const a=this.children,l=a.length;for(let c=0;c<l;c++)a[c].collectRenderables(e,r,n)}}class Ei extends pT{constructor(e=me.EMPTY){e instanceof me&&(e={texture:e});const{texture:r=me.EMPTY,anchor:n,roundPixels:s,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new zt({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=s??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,r=!1){return e instanceof me?new Ei(e):new Ei(me.from(e,r))}set texture(e){e||(e=me.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return IE(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Ie("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,n=this._bounds,{width:s,height:i}=r.orig;n.minX=-e._x*s,n.maxX=n.minX+s,n.minY=-e._y*i,n.maxY=n.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const mT=new sr;function iq(t,e,r){const n=mT;t.measurable=!0,Jb(t,r,n),e.addBoundsMask(n),t.measurable=!1}function oq(t,e,r){const n=Cr.get();t.measurable=!0;const s=xt.get().identity(),i=aq(t,r,s);tq(t,n,i),t.measurable=!1,e.addBoundsMask(n),xt.return(s),Cr.return(n)}function aq(t,e,r){return t?(t!==e&&(aq(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(ke("Mask bounds, renderable is not inside the root container"),r)}class lq{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Ei),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||iq(this.mask,e,r)}addLocalBounds(e,r){oq(this.mask,e,r)}containsPoint(e,r){const n=this.mask;return r(n,e)}destroy(){this.reset()}static test(e){return e instanceof Ei}}lq.extension=te.MaskEffect;class cq{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}cq.extension=te.MaskEffect;class uq{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){iq(this.mask,e,r)}addLocalBounds(e,r){oq(this.mask,e,r)}containsPoint(e,r){const n=this.mask;return r(n,e)}destroy(){this.reset()}static test(e){return e instanceof ro}}uq.extension=te.MaskEffect;const gT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let Pg=gT;const Ye={get(){return Pg},set(t){Pg=t}};class hq extends mr{constructor(e){e.resource||(e.resource=Ye.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,n=this._resolution){const s=super.resize(e,r,n);return s&&this.resizeCanvas(),s}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}hq.extension=te.TextureSource;class En extends mr{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=Ye.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,ke("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}En.extension=te.TextureSource;var Ea=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ea||{});class Ic{constructor(e,r=null,n=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=n,this._once=s}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const dq=class jt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ic(null,null,1/0),this.deltaMS=1/jt.targetFPMS,this.elapsedMS=1/jt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Ea.NORMAL){return this._addListener(new Ic(e,r,n))}addOnce(e,r,n=Ea.NORMAL){return this._addListener(new Ic(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*jt.targetFPMS;const n=this._head;let s=n.next;for(;s;)s=s.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,jt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!jt._shared){const e=jt._shared=new jt;e.autoStart=!0,e._protected=!0}return jt._shared}static get system(){if(!jt._system){const e=jt._system=new jt;e.autoStart=!0,e._protected=!0}return jt._system}};dq.targetFPMS=.06;let _t=dq,jc;async function fq(){return jc??(jc=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!r)return"premultiply-alpha-on-upload";const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(s),e.deleteTexture(n),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),jc}const Za=class pq extends mr{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...pq.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=_t.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await fq(),this._load=new Promise((n,s)=>{this.isValid?n(this):(this._resolve=n,this._reject=s,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(_t.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_t.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_t.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Za.extension=te.TextureSource;Za.defaultOptions={...mr.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Za.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ia=Za;const rr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t);class AT{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||ke(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=rr(e);let s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){s=c.getCacheableAssets(n,r);break}}const i=new Map(Object.entries(s||{}));s||n.forEach(l=>{i.set(l,r)});const o=[...i.keys()],a={cacheKeys:o,keys:n};n.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=s?s[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&ke("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){ke(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(s=>{this._cache.delete(s)}),r.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Te=new AT,lh=[];kt.handleByList(te.TextureSource,lh);function mq(t={}){const e=t&&t.resource,r=e?t.resource:t,n=e?t:{resource:t};for(let s=0;s<lh.length;s++){const i=lh[s];if(i.test(r))return new i(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function yT(t={},e=!1){const r=t&&t.resource,n=r?t.resource:t,s=r?t:{resource:t};if(!e&&Te.has(n))return Te.get(n);const i=new me({source:mq(s)});return i.on("destroy",()=>{Te.has(n)&&Te.remove(n)}),e||Te.set(n,i),i}function xT(t,e=!1){return typeof t=="string"?Te.get(t):t instanceof mr?new me({source:t}):yT(t,e)}me.from=xT;mr.from=mq;kt.add(lq,cq,uq,ia,En,hq,jd);var en=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(en||{});function Xt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Ys(t){return t.split("?")[0].split("#")[0]}function bT(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function qT(t,e,r){return t.replace(new RegExp(bT(e),"g"),r)}function wT(t,e){let r="",n=0,s=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),s=a,i=0;continue}}else if(r.length===2||r.length===1){r="",n=0,s=a,i=0;continue}}}else r.length>0?r+=`/${t.slice(s+1,a)}`:r=t.slice(s+1,a),n=a-s-1;s=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}const Dt={toPosix(t){return qT(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Xt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(Xt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=Ys(this.toPosix(e??Ye.get().getBaseUrl())),s=Ys(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?Dt.join(s,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(Xt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=wT(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Xt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(Xt(n),n.length>0)if(e===void 0)e=n;else{const s=t[r-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Xt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,s=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!s){n=a;break}}else s=!1;return n===-1?r?"/":this.isUrl(o)?i+t:i:r&&n===1?"//":i+t.slice(0,n)},rootname(t){Xt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Xt(t),e&&Xt(e),t=Ys(this.toPosix(t));let r=0,n=-1,s=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!s){r=i+1;break}}else a===-1&&(s=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=i):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!s){r=i+1;break}}else n===-1&&(s=!1,n=i+1);return n===-1?"":t.slice(r,n)},extname(t){Xt(t),t=Ys(this.toPosix(t));let e=-1,r=0,n=-1,s=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!s){r=o+1;break}continue}n===-1&&(s=!1,n=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||n===-1||i===0||i===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){Xt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Ys(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let s;e.root=this.rootname(t),n||this.hasProtocol(t)?s=1:s=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=s;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function gq(t,e,r,n,s){const i=e[r];for(let o=0;o<i.length;o++){const a=i[o];r<e.length-1?gq(t.replace(n[r],a),e,r+1,n,s):s.push(t.replace(n[r],a))}}function vT(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const s=[];r.forEach(i=>{const o=i.substring(1,i.length-1).split(",");s.push(o)}),gq(t,s,0,r,n)}else n.push(t);return n}const Ta=t=>!Array.isArray(t);class Ms{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,src:n}=e;return rr(r||n,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&ke("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];let s=r;Array.isArray(r)||(s=Object.entries(r).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),s.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);n.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));n.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=n}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let n;n=i=>{this.hasKey(i)&&ke(`[Resolver] already has key: ${i} overwriting`)},rr(r).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c}=i;const u=rr(o).map(f=>typeof f=="string"?vT(f):Array.isArray(f)?f:[f]),h=this.getAlias(i);Array.isArray(h)?h.forEach(n):n(h);const d=[];u.forEach(f=>{f.forEach(m=>{let A={};if(typeof m!="object"){A.src=m;for(let g=0;g<this._parsers.length;g++){const y=this._parsers[g];if(y.test(m)){A=y.parse(m);break}}}else a=m.data??a,l=m.format??l,c=m.loadParser??c,A={...A,...m};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${A.src}`);A=this._buildResolvedAsset(A,{aliases:h,data:a,format:l,loadParser:c}),d.push(A)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const r=Ta(e);e=rr(e);const n={};return e.forEach(s=>{const i=this._bundles[s];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(s,l)]=c}n[s]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const s in r)n[s]=r[s].src;return n}return r.src}resolve(e){const r=Ta(e);e=rr(e);const n={};return e.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let i=this._assetMap[s];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[s]=i[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});n[s]=this._resolverHash[s]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[r],s=this._preferredOrder.find(i=>i.params.format.includes(n.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:n,data:s,loadParser:i,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=Dt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...s||{},...e.data},e.loadParser=i??e.loadParser,e.format=o??e.format??VT(e.src),e}}Ms.RETINA_PREFIX=/@([0-9\.]+)x/;function VT(t){return t.split(".").pop().split("?").shift().split("#").shift()}const ch=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},Aq=class ii{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof me?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const n=parseFloat(r.meta.scale);n?(this.resolution=n,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ii.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=ii.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const s=this._frameKeys[r],i=this._frames[s],o=i.frame;if(o){let a=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Fe(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?a=new Fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Fe(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new me({source:this.textureSource,frame:a,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:s.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const s=e[r][n];this.animations[r].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ii.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ii.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Aq.BATCH_SIZE=1e3;let uh=Aq;const _T=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function yq(t,e,r){const n={};if(t.forEach(s=>{n[s]=e}),Object.keys(e.textures).forEach(s=>{n[s]=e.textures[s]}),!r){const s=Dt.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=yq([`${s}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(n,a)})}return n}const ST={extension:te.Asset,cache:{test:t=>t instanceof uh,getCacheableAssets:(t,e)=>yq(t,e,!1)},resolver:{extension:{type:te.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),n=r.pop(),s=r.pop();return n==="json"&&_T.includes(s)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Ms.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:te.LoadParser,priority:en.Normal,name:"spritesheetLoader"},async testParse(t,e){return Dt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:n,imageFilename:s,textureOptions:i}=e?.data??{};let o=Dt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n instanceof me)a=n;else{const u=ch(o+(s??t.meta.image),e.src);a=(await r.load([{src:u,data:i}]))[u]}const l=new uh(a.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const d of c){if(typeof d!="string")continue;let f=o+d;e.data?.ignoreMultiPack||(f=ch(f,e.src),u.push(r.load({src:f,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(d=>{d.linkedSheets=[l].concat(l.linkedSheets.filter(f=>f!==d))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};kt.add(ST);const Oc=Object.create(null),Eg=Object.create(null);function zd(t,e){let r=Eg[t];return r===void 0&&(Oc[e]===void 0&&(Oc[e]=1),Eg[t]=r=Oc[e]++),r}let Do;function xq(){return(!Do||Do?.isContextLost())&&(Do=Ye.get().createCanvas().getContext("webgl",{})),Do}let Fo;function kT(){if(!Fo){Fo="mediump";const t=xq();t&&t.getShaderPrecisionFormat&&(Fo=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return Fo}function CT(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function PT(t,e,r){const n=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let s=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return s==="highp"&&n!=="highp"&&(s="mediump"),`precision ${s} float;
${t}`}else if(n!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function ET(t,e){return e?`#version 300 es
${t}`:t}const TT={},RT={};function MT(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const n=r?TT:RT;return n[e]?(n[e]++,e+=`-${n[e]}`):n[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function IT(t,e){return e?t.replace("#version 300 es",""):t}const Bc={stripVersion:IT,ensurePrecision:PT,addProgramDefines:CT,setProgramName:MT,insertVersion:ET},zc=Object.create(null),bq=class hh{constructor(e){e={...hh.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:kT()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let s=e.fragment,i=e.vertex;Object.keys(Bc).forEach(o=>{const a=n[o];s=Bc[o](s,a,!0),i=Bc[o](i,a,!1)}),this.fragment=s,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=zd(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return zc[r]||(zc[r]=new hh(e)),zc[r]}};bq.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let qq=bq;const Tg={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function jT(t){return Tg[t]??Tg.float32}const OT={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function BT({source:t,entryPoint:e}){const r={},n=t.indexOf(`fn ${e}`);if(n!==-1){const s=t.indexOf("->",n);if(s!==-1){const i=t.substring(n,s),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=OT[a[3]]??"float32";r[a[2]]={location:parseInt(a[1],10),format:l,stride:jT(l).stride,offset:0,instance:!1,start:0}}}}return r}function Nc(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,s=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(n)[1],10),name:h.match(s)[2],isUniform:h.match(s)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((m,A)=>{const[g,y]=A.split(":");return m[g.trim()]=y.trim(),m},{});return f?{name:d,members:f}:null}).filter(({name:h})=>c.some(d=>d.type===h))??[];return{groups:c,structs:u}}var oi=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(oi||{});function zT({groups:t}){const e=[];for(let r=0;r<t.length;r++){const n=t[r];e[n.group]||(e[n.group]=[]),n.isUniform?e[n.group].push({binding:n.binding,visibility:oi.VERTEX|oi.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?e[n.group].push({binding:n.binding,visibility:oi.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&e[n.group].push({binding:n.binding,visibility:oi.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function NT({groups:t}){const e=[];for(let r=0;r<t.length;r++){const n=t[r];e[n.group]||(e[n.group]={}),e[n.group][n.name]=n.binding}return e}function DT(t,e){const r=new Set,n=new Set,s=[...t.structs,...e.structs].filter(o=>r.has(o.name)?!1:(r.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return n.has(a)?!1:(n.add(a),!0)});return{structs:s,groups:i}}const Dc=Object.create(null);class el{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:n,layout:s,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=r,this.vertex=n,r.source===n.source){const a=Nc(r.source);this.structsAndGroups=a}else{const a=Nc(n.source),l=Nc(r.source);this.structsAndGroups=DT(a,l)}this.layout=s??NT(this.structsAndGroups),this.gpuLayout=i??zT(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,n=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=zd(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=BT(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return Dc[r]||(Dc[r]=new el(e)),Dc[r]}}const wq=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],FT=wq.reduce((t,e)=>(t[e]=!0,t),{});function LT(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const vq=class Vq{constructor(e,r){this._touched=0,this.uid=Le("uniform"),this._resourceType="uniformGroup",this._resourceId=Le("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...Vq.defaultOptions,...r},this.uniformStructures=e;const n={};for(const s in e){const i=e[s];if(i.name=s,i.size=i.size??1,!FT[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${wq.join(", ")}`);i.value??(i.value=LT(i.type,i.size)),n[s]=i.value}this.uniforms=n,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=zd(Object.keys(n).map(s=>`${s}-${e[s].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};vq.defaultOptions={ubo:!1,isStatic:!1};let _q=vq;class oa{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const n in e){const s=e[n];this.setResource(s,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const n in this.resources)e[r++]=this.resources[n]._resourceId;this._key=e.join("|")}setResource(e,r){const n=this.resources[r];e!==n&&(n&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const n in r)r[n]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const n in r)r[n]===e&&(r[n]=null)}else this._updateKey()}}var dh=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(dh||{});class Nd extends pr{constructor(e){super(),this.uid=Le("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:n,groups:s,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=r,this.glProgram=n,o===void 0&&(o=0,r&&(o|=dh.WEBGPU),n&&(o|=dh.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!s&&(i={}),i&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&s&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&s&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&s&&!a){const c=r.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){s={},a={},r&&r.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(s[99]||(s[99]=new oa,this._ownedBindGroups.push(s[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let d=i[u];!d.source&&!d._resourceType&&(d=new _q(d));const f=l[h];f&&(s[f.group]||(s[f.group]=new oa,this._ownedBindGroups.push(s[f.group])),s[f.group].setResource(d,f.binding))}}this.groups=s,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(s,l)}addResource(e,r,n){var s,i;(s=this._uniformBindMap)[r]||(s[r]={}),(i=this._uniformBindMap[r])[n]||(i[n]=e),this.groups[r]||(this.groups[r]=new oa,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const n={};for(const s in r){const i=r[s];Object.defineProperty(n,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return n}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:n,...s}=e;let i,o;return r&&(i=el.from(r)),n&&(o=qq.from(n)),new Nd({gpuProgram:i,glProgram:o,...s})}}var Lo={exports:{}},Rg;function UT(){if(Rg)return Lo.exports;Rg=1,Lo.exports=t,Lo.exports.default=t;function t(w,k,P){P=P||2;var M=k&&k.length,T=M?k[0]*P:w.length,j=e(w,0,T,P,!0),O=[];if(!j||j.next===j.prev)return O;var z,F,L,W,Y,re,ie;if(M&&(j=l(w,k,j,P)),w.length>80*P){z=L=w[0],F=W=w[1];for(var ne=P;ne<T;ne+=P)Y=w[ne],re=w[ne+1],Y<z&&(z=Y),re<F&&(F=re),Y>L&&(L=Y),re>W&&(W=re);ie=Math.max(L-z,W-F),ie=ie!==0?32767/ie:0}return n(j,O,P,z,F,ie,0),O}function e(w,k,P,M,T){var j,O;if(T===U(w,k,P,M)>0)for(j=k;j<P;j+=M)O=B(j,w[j],w[j+1],O);else for(j=P-M;j>=k;j-=M)O=B(j,w[j],w[j+1],O);return O&&q(O,O.next)&&(N(O),O=O.next),O}function r(w,k){if(!w)return w;k||(k=w);var P=w,M;do if(M=!1,!P.steiner&&(q(P,P.next)||x(P.prev,P,P.next)===0)){if(N(P),P=k=P.prev,P===P.next)break;M=!0}else P=P.next;while(M||P!==k);return k}function n(w,k,P,M,T,j,O){if(w){!O&&j&&f(w,M,T,j);for(var z=w,F,L;w.prev!==w.next;){if(F=w.prev,L=w.next,j?i(w,M,T,j):s(w)){k.push(F.i/P|0),k.push(w.i/P|0),k.push(L.i/P|0),N(w),w=L.next,z=L.next;continue}if(w=L,w===z){O?O===1?(w=o(r(w),k,P),n(w,k,P,M,T,j,2)):O===2&&a(w,k,P,M,T,j):n(r(w),k,P,M,T,j,1);break}}}}function s(w){var k=w.prev,P=w,M=w.next;if(x(k,P,M)>=0)return!1;for(var T=k.x,j=P.x,O=M.x,z=k.y,F=P.y,L=M.y,W=T<j?T<O?T:O:j<O?j:O,Y=z<F?z<L?z:L:F<L?F:L,re=T>j?T>O?T:O:j>O?j:O,ie=z>F?z>L?z:L:F>L?F:L,ne=M.next;ne!==k;){if(ne.x>=W&&ne.x<=re&&ne.y>=Y&&ne.y<=ie&&y(T,z,j,F,O,L,ne.x,ne.y)&&x(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function i(w,k,P,M){var T=w.prev,j=w,O=w.next;if(x(T,j,O)>=0)return!1;for(var z=T.x,F=j.x,L=O.x,W=T.y,Y=j.y,re=O.y,ie=z<F?z<L?z:L:F<L?F:L,ne=W<Y?W<re?W:re:Y<re?Y:re,pt=z>F?z>L?z:L:F>L?F:L,$e=W>Y?W>re?W:re:Y>re?Y:re,nt=A(ie,ne,k,P,M),Tt=A(pt,$e,k,P,M),oe=w.prevZ,xe=w.nextZ;oe&&oe.z>=nt&&xe&&xe.z<=Tt;){if(oe.x>=ie&&oe.x<=pt&&oe.y>=ne&&oe.y<=$e&&oe!==T&&oe!==O&&y(z,W,F,Y,L,re,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,xe.x>=ie&&xe.x<=pt&&xe.y>=ne&&xe.y<=$e&&xe!==T&&xe!==O&&y(z,W,F,Y,L,re,xe.x,xe.y)&&x(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;oe&&oe.z>=nt;){if(oe.x>=ie&&oe.x<=pt&&oe.y>=ne&&oe.y<=$e&&oe!==T&&oe!==O&&y(z,W,F,Y,L,re,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;xe&&xe.z<=Tt;){if(xe.x>=ie&&xe.x<=pt&&xe.y>=ne&&xe.y<=$e&&xe!==T&&xe!==O&&y(z,W,F,Y,L,re,xe.x,xe.y)&&x(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function o(w,k,P){var M=w;do{var T=M.prev,j=M.next.next;!q(T,j)&&V(T,M,M.next,j)&&E(T,j)&&E(j,T)&&(k.push(T.i/P|0),k.push(M.i/P|0),k.push(j.i/P|0),N(M),N(M.next),M=w=j),M=M.next}while(M!==w);return r(M)}function a(w,k,P,M,T,j){var O=w;do{for(var z=O.next.next;z!==O.prev;){if(O.i!==z.i&&b(O,z)){var F=I(O,z);O=r(O,O.next),F=r(F,F.next),n(O,k,P,M,T,j,0),n(F,k,P,M,T,j,0);return}z=z.next}O=O.next}while(O!==w)}function l(w,k,P,M){var T=[],j,O,z,F,L;for(j=0,O=k.length;j<O;j++)z=k[j]*M,F=j<O-1?k[j+1]*M:w.length,L=e(w,z,F,M,!1),L===L.next&&(L.steiner=!0),T.push(g(L));for(T.sort(c),j=0;j<T.length;j++)P=u(T[j],P);return P}function c(w,k){return w.x-k.x}function u(w,k){var P=h(w,k);if(!P)return k;var M=I(P,w);return r(M,M.next),r(P,P.next)}function h(w,k){var P=k,M=w.x,T=w.y,j=-1/0,O;do{if(T<=P.y&&T>=P.next.y&&P.next.y!==P.y){var z=P.x+(T-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(z<=M&&z>j&&(j=z,O=P.x<P.next.x?P:P.next,z===M))return O}P=P.next}while(P!==k);if(!O)return null;var F=O,L=O.x,W=O.y,Y=1/0,re;P=O;do M>=P.x&&P.x>=L&&M!==P.x&&y(T<W?M:j,T,L,W,T<W?j:M,T,P.x,P.y)&&(re=Math.abs(T-P.y)/(M-P.x),E(P,w)&&(re<Y||re===Y&&(P.x>O.x||P.x===O.x&&d(O,P)))&&(O=P,Y=re)),P=P.next;while(P!==F);return O}function d(w,k){return x(w.prev,w,k.prev)<0&&x(k.next,w,w.next)<0}function f(w,k,P,M){var T=w;do T.z===0&&(T.z=A(T.x,T.y,k,P,M)),T.prevZ=T.prev,T.nextZ=T.next,T=T.next;while(T!==w);T.prevZ.nextZ=null,T.prevZ=null,m(T)}function m(w){var k,P,M,T,j,O,z,F,L=1;do{for(P=w,w=null,j=null,O=0;P;){for(O++,M=P,z=0,k=0;k<L&&(z++,M=M.nextZ,!!M);k++);for(F=L;z>0||F>0&&M;)z!==0&&(F===0||!M||P.z<=M.z)?(T=P,P=P.nextZ,z--):(T=M,M=M.nextZ,F--),j?j.nextZ=T:w=T,T.prevZ=j,j=T;P=M}j.nextZ=null,L*=2}while(O>1);return w}function A(w,k,P,M,T){return w=(w-P)*T|0,k=(k-M)*T|0,w=(w|w<<8)&16711935,w=(w|w<<4)&252645135,w=(w|w<<2)&858993459,w=(w|w<<1)&1431655765,k=(k|k<<8)&16711935,k=(k|k<<4)&252645135,k=(k|k<<2)&858993459,k=(k|k<<1)&1431655765,w|k<<1}function g(w){var k=w,P=w;do(k.x<P.x||k.x===P.x&&k.y<P.y)&&(P=k),k=k.next;while(k!==w);return P}function y(w,k,P,M,T,j,O,z){return(T-O)*(k-z)>=(w-O)*(j-z)&&(w-O)*(M-z)>=(P-O)*(k-z)&&(P-O)*(j-z)>=(T-O)*(M-z)}function b(w,k){return w.next.i!==k.i&&w.prev.i!==k.i&&!S(w,k)&&(E(w,k)&&E(k,w)&&R(w,k)&&(x(w.prev,w,k.prev)||x(w,k.prev,k))||q(w,k)&&x(w.prev,w,w.next)>0&&x(k.prev,k,k.next)>0)}function x(w,k,P){return(k.y-w.y)*(P.x-k.x)-(k.x-w.x)*(P.y-k.y)}function q(w,k){return w.x===k.x&&w.y===k.y}function V(w,k,P,M){var T=v(x(w,k,P)),j=v(x(w,k,M)),O=v(x(P,M,w)),z=v(x(P,M,k));return!!(T!==j&&O!==z||T===0&&_(w,P,k)||j===0&&_(w,M,k)||O===0&&_(P,w,M)||z===0&&_(P,k,M))}function _(w,k,P){return k.x<=Math.max(w.x,P.x)&&k.x>=Math.min(w.x,P.x)&&k.y<=Math.max(w.y,P.y)&&k.y>=Math.min(w.y,P.y)}function v(w){return w>0?1:w<0?-1:0}function S(w,k){var P=w;do{if(P.i!==w.i&&P.next.i!==w.i&&P.i!==k.i&&P.next.i!==k.i&&V(P,P.next,w,k))return!0;P=P.next}while(P!==w);return!1}function E(w,k){return x(w.prev,w,w.next)<0?x(w,k,w.next)>=0&&x(w,w.prev,k)>=0:x(w,k,w.prev)<0||x(w,w.next,k)<0}function R(w,k){var P=w,M=!1,T=(w.x+k.x)/2,j=(w.y+k.y)/2;do P.y>j!=P.next.y>j&&P.next.y!==P.y&&T<(P.next.x-P.x)*(j-P.y)/(P.next.y-P.y)+P.x&&(M=!M),P=P.next;while(P!==w);return M}function I(w,k){var P=new D(w.i,w.x,w.y),M=new D(k.i,k.x,k.y),T=w.next,j=k.prev;return w.next=k,k.prev=w,P.next=T,T.prev=P,M.next=P,P.prev=M,j.next=M,M.prev=j,M}function B(w,k,P,M){var T=new D(w,k,P);return M?(T.next=M.next,T.prev=M,M.next.prev=T,M.next=T):(T.prev=T,T.next=T),T}function N(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function D(w,k,P){this.i=w,this.x=k,this.y=P,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(w,k,P,M){var T=k&&k.length,j=T?k[0]*P:w.length,O=Math.abs(U(w,0,j,P));if(T)for(var z=0,F=k.length;z<F;z++){var L=k[z]*P,W=z<F-1?k[z+1]*P:w.length;O-=Math.abs(U(w,L,W,P))}var Y=0;for(z=0;z<M.length;z+=3){var re=M[z]*P,ie=M[z+1]*P,ne=M[z+2]*P;Y+=Math.abs((w[re]-w[ne])*(w[ie+1]-w[re+1])-(w[re]-w[ie])*(w[ne+1]-w[re+1]))}return O===0&&Y===0?0:Math.abs((Y-O)/O)};function U(w,k,P,M){for(var T=0,j=k,O=P-M;j<P;j+=M)T+=(w[O]-w[j])*(w[j+1]+w[O+1]),O=j;return T}return t.flatten=function(w){for(var k=w[0][0].length,P={vertices:[],holes:[],dimensions:k},M=0,T=0;T<w.length;T++){for(var j=0;j<w[T].length;j++)for(var O=0;O<k;O++)P.vertices.push(w[T][j][O]);T>0&&(M+=w[T-1].length,P.holes.push(M))}return P},Lo.exports}var HT=UT();const $T=rt(HT);class Sq extends pr{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Ie(dt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Ie(dt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Ie(dt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Ie(dt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Ie(dt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Mg=[{offset:0,color:"white"},{offset:1,color:"black"}],Dd=class fh{constructor(...e){this.uid=Le("fillGradient"),this.type="linear",this.colorStops=[];let r=WT(e);r={...r.type==="radial"?fh.defaultRadialOptions:fh.defaultLinearOptions,...Hb(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(s=>{this.addColorStop(s.offset,s.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:lt.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Mg,r=this._textureSize,{canvas:n,context:s}=jg(r,1),i=s.createLinearGradient(0,0,this._textureSize,0);Ig(i,e),s.fillStyle=i,s.fillRect(0,0,r,1),this.texture=new me({source:new En({resource:n})});const{x:o,y:a}=this.start,{x:l,y:c}=this.end,u=new ge,h=l-o,d=c-a,f=Math.sqrt(h*h+d*d),m=Math.atan2(d,h);u.scale(f/r,1),u.rotate(m),u.translate(o,a),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Mg,r=this._textureSize,{canvas:n,context:s}=jg(r,r),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,d=l-u,f=r/(u*2),m=(i-h)*f,A=(o-d)*f,g=s.createRadialGradient(m,A,c*f,(a-h)*f,(l-d)*f,u*f);Ig(g,e),s.fillStyle=e[e.length-1].color,s.fillRect(0,0,r,r),s.fillStyle=g,s.translate(m,A),s.rotate(this.rotation),s.scale(1,this.scale),s.translate(-m,-A),s.fillRect(0,0,r,r),this.texture=new me({source:new En({resource:n,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const y=new ge;y.scale(1/f,1/f),y.translate(h,d),this.textureSpace==="local"&&y.scale(r,r),this.transform=y}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};Dd.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};Dd.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let Wr=Dd;function Ig(t,e){for(let r=0;r<e.length;r++){const n=e[r];t.addColorStop(n.offset,n.color)}}function jg(t,e){const r=Ye.get().createCanvas(t,e),n=r.getContext("2d");return{canvas:r,context:n}}function WT(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(Ie("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??Wr.defaultLinearOptions.textureSize}),e}const Og={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class tl{constructor(e,r){this.uid=Le("fillPattern"),this.transform=new ge,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=Og[r].addressModeU,e.source.style.addressModeV=Og[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Fc,Bg;function GT(){if(Bg)return Fc;Bg=1,Fc=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=s(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(i){var o=i.match(n);return o?o.map(Number):[]}return Fc}var QT=GT();const YT=rt(QT);function KT(t,e){const r=YT(t),n=[];let s=null,i=0,o=0;for(let a=0;a<r.length;a++){const l=r[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),n.length>0&&(s=n.pop(),s?(i=s.startX,o=s.startY):(i=0,o=0)),s=null;break;default:ke(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&s===null&&(s={startX:i,startY:o},n.push(s))}return e}class Fd{constructor(e=0,r=0,n=0){this.type="circle",this.x=e,this.y=r,this.radius=n}clone(){return new Fd(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let s=this.x-e,i=this.y-r;return s*=s,i*=i,s+i<=n}strokeContains(e,r,n,s=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-r,a=this.radius,l=(1-s)*n,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(n-l)}getBounds(e){return e||(e=new Fe),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ld{constructor(e=0,r=0,n=0,s=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=n,this.halfHeight=s}clone(){return new Ld(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(e-this.x)/this.halfWidth,s=(r-this.y)/this.halfHeight;return n*=n,s*=s,n+s<=1}strokeContains(e,r,n,s=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=n*(1-s),l=n-a,c=i-l,u=o-l,h=i+a,d=o+a,f=e-this.x,m=r-this.y,A=f*f/(c*c)+m*m/(u*u),g=f*f/(h*h)+m*m/(d*d);return A>1&&g<=1}getBounds(e){return e||(e=new Fe),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function XT(t,e,r,n,s,i){const o=t-r,a=e-n,l=s-r,c=i-n,u=o*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,m;d<0?(f=r,m=n):d>1?(f=s,m=i):(f=r+d*l,m=n+d*c);const A=t-f,g=e-m;return A*A+g*g}let JT,ZT;class Ai{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let s=0,i=r.length;s<i;s++)n.push(r[s].x,r[s].y);r=n}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,n=r.length;for(let s=0;s<n;s+=2){const i=r[s],o=r[s+1],a=r[(s+2)%n],l=r[(s+3)%n];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const r=this.getBounds(JT),n=e.getBounds(ZT);if(!r.containsRect(n))return!1;const s=e.points;for(let i=0;i<s.length;i+=2){const o=s[i],a=s[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),r=new Ai(e);return r.closePath=this.closePath,r}contains(e,r){let n=!1;const s=this.points.length/2;for(let i=0,o=s-1;i<s;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(n=!n)}return n}strokeContains(e,r,n,s=.5){const i=n*n,o=i*(1-s),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],d=l[u+1],f=l[(u+2)%l.length],m=l[(u+3)%l.length],A=XT(e,r,h,d,f,m),g=Math.sign((f-h)*(r-d)-(m-d)*(e-h));if(A<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new Fe);const r=this.points;let n=1/0,s=-1/0,i=1/0,o=-1/0;for(let a=0,l=r.length;a<l;a+=2){const c=r[a],u=r[a+1];n=c<n?c:n,s=c>s?c:s,i=u<i?u:i,o=u>o?u:o}return e.x=n,e.width=s-n,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Uo=(t,e,r,n,s,i,o)=>{const a=t-r,l=e-n,c=Math.sqrt(a*a+l*l);return c>=s-i&&c<=s+o};class Ud{constructor(e=0,r=0,n=0,s=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=n,this.height=s,this.radius=i}getBounds(e){return e||(e=new Fe),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Ud(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let s=e-(this.x+n),i=r-(this.y+n);const o=n*n;if(s*s+i*i<=o||(s=e-(this.x+this.width-n),s*s+i*i<=o)||(i=r-(this.y+this.height-n),s*s+i*i<=o)||(s=e-(this.x+n),s*s+i*i<=o))return!0}return!1}strokeContains(e,r,n,s=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=n*(1-s),h=n-u,d=i+c,f=o+c,m=a-c*2,A=l-c*2,g=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=g-h&&e<=g+u)&&r>=f&&r<=f+A||(r>=o-u&&r<=o+h||r>=y-h&&r<=y+u)&&e>=d&&e<=d+m?!0:e<d&&r<f&&Uo(e,r,d,f,c,h,u)||e>g-c&&r<f&&Uo(e,r,g-c,f,c,h,u)||e>g-c&&r>y-c&&Uo(e,r,g-c,y-c,c,h,u)||e<d&&r>y-c&&Uo(e,r,d,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const eR=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function tR(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function rR(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const n=eR.replace(/%forloop%/gi,tR(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let Yn=null;function kq(){if(Yn)return Yn;const t=xq();return Yn=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Yn=rR(Yn,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Yn}const Cq={};function nR(t,e){let r=2166136261;for(let n=0;n<e;n++)r^=t[n].uid,r=Math.imul(r,16777619),r>>>=0;return Cq[r]||sR(t,e,r)}let Lc=0;function sR(t,e,r){const n={};let s=0;Lc||(Lc=kq());for(let o=0;o<Lc;o++){const a=o<e?t[o]:me.EMPTY.source;n[s++]=a.source,n[s++]=a.style}const i=new oa(n);return Cq[r]=i,i}class zg{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Ng(t,e){const r=t.byteLength/8|0,n=new Float64Array(t,0,r);new Float64Array(e,0,r).set(n);const i=t.byteLength-r*8;if(i>0){const o=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(o)}}const iR={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var oR=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(oR||{});function Dg(t,e){return e.alphaMode==="no-premultiply-alpha"&&iR[t]||t}class aR{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class lR{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new aR,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Pq=[];let ph=0;function Fg(){return ph>0?Pq[--ph]:new lR}function Lg(t){Pq[ph++]=t}let Ks=0;const Eq=class aa{constructor(e={}){this.uid=Le("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],aa.defaultOptions.maxTextures=aa.defaultOptions.maxTextures??kq(),e={...aa.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:n,indicesInitialSize:s}=e;this.attributeBuffer=new zg(n*4),this.indexBuffer=new Uint16Array(s),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Lg(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const n=e._batch.textures.ids[r._source.uid];return!n&&n!==0?!1:(e._textureId=n,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let n=Fg(),s=n.textures;s.clear();const i=r[this.elementStart];let o=Dg(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const m=this.maxTextures;for(let A=this.elementStart;A<this.elementSize;++A){const g=r[A];r[A]=null;const b=g.texture._source,x=Dg(g.blendMode,b),q=o!==x||a!==g.topology;if(b._batchTick===Ks&&!q){g._textureId=b._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=n;continue}b._batchTick=Ks,(s.count>=m||q)&&(this._finishBatch(n,d,h-d,s,o,a,e,f),f="renderBatch",d=h,o=x,a=g.topology,n=Fg(),s=n.textures,s.clear(),++Ks),g._textureId=b._textureBindLocation=s.count,s.ids[b.uid]=s.count,s.textures[s.count++]=b,g._batch=n,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}s.count>0&&(this._finishBatch(n,d,h-d,s,o,a,e,f),d=h,++Ks),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=h}_finishBatch(e,r,n,s,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=s,e.blendMode=i,e.topology=o,e.start=r,e.size=n,++Ks,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),n=new zg(r);Ng(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(e){const r=this.indexBuffer;let n=Math.max(e,r.length*1.5);n+=n%2;const s=n>65535?new Uint32Array(n):new Uint16Array(n);if(s.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)s[i]=r[i];else Ng(r.buffer,s.buffer);this.indexBuffer=s}packQuadIndex(e,r,n){e[r]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3}packIndex(e,r,n,s){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)r[n++]=s+i[c+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)Lg(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Eq.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let cR=Eq;var Vt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(Vt||{});let Ti=class extends pr{constructor(e){let{data:r,size:n}=e;const{usage:s,label:i,shrinkToFit:o}=e;super(),this.uid=Le("buffer"),this._resourceType="buffer",this._resourceId=Le("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,n??(n=r?.byteLength);const a=!!r;this.descriptor={size:n,usage:s,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Vt.STATIC)}set static(e){e?this.descriptor.usage|=Vt.STATIC:this.descriptor.usage&=~Vt.STATIC}setDataWithSize(e,r,n){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){n&&this.emit("update",this);return}const s=this._data;if(this._data=e,this._dataInt32=null,!s||s.length!==e.length){!this.shrinkToFit&&s&&e.byteLength<s.byteLength?n&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Le("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Tq(t,e){if(!(t instanceof Ti)){let r=e?Vt.INDEX:Vt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=Vt.INDEX|Vt.COPY_DST):(t=new Float32Array(t),r=Vt.VERTEX|Vt.COPY_DST)),t=new Ti({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function uR(t,e,r){const n=t.getAttribute(e);if(!n)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const s=n.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=s.BYTES_PER_ELEMENT,u=(n.offset||0)/c,h=(n.stride||2*4)/c;for(let d=u;d<s.length;d+=h){const f=s[d],m=s[d+1];f>a&&(a=f),m>l&&(l=m),f<i&&(i=f),m<o&&(o=m)}return r.minX=i,r.minY=o,r.maxX=a,r.maxY=l,r}function hR(t){return(t instanceof Ti||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Tq(t.buffer,!1),t}class dR extends pr{constructor(e={}){super(),this.uid=Le("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new sr,this._boundsDirty=!0;const{attributes:r,indexBuffer:n,topology:s}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,n&&this.addIndex(n),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const n=hR(r);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=n}addIndex(e){this.indexBuffer=Tq(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,uR(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const fR=new Float32Array(1),pR=new Uint32Array(1);class mR extends dR{constructor(){const r=new Ti({data:fR,label:"attribute-batch-buffer",usage:Vt.VERTEX|Vt.COPY_DST,shrinkToFit:!1}),n=new Ti({data:pR,label:"index-batch-buffer",usage:Vt.INDEX|Vt.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:s,offset:0},aUV:{buffer:r,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:r,format:"unorm8x4",stride:s,offset:4*4},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:s,offset:5*4}},indexBuffer:n})}}function Ug(t,e,r){if(t)for(const n in t){const s=n.toLocaleLowerCase(),i=e[s];if(i){let o=t[n];n==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(o)}else ke(`${n} placement hook does not exist in shader`)}}const gR=/\{\{(.*?)\}\}/g;function Hg(t){const e={};return(t.match(gR)?.map(n=>n.replace(/[{()}]/g,""))??[]).forEach(n=>{e[n]=[]}),e}function $g(t,e){let r;const n=/@in\s+([^;]+);/g;for(;(r=n.exec(t))!==null;)e.push(r[1])}function Wg(t,e,r=!1){const n=[];$g(e,n),t.forEach(a=>{a.header&&$g(a.header,n)});const s=n;r&&s.sort();const i=s.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Gg(t,e){let r;const n=/@out\s+([^;]+);/g;for(;(r=n.exec(t))!==null;)e.push(r[1])}function AR(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function yR(t){const e=/@.*?\s+/g;return t.replace(e,"")}function xR(t,e){const r=[];Gg(e,r),t.forEach(l=>{l.header&&Gg(l.header,r)});let n=0;const s=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${n++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${yR(l)};`).join(`
`),o=`return VSOutput(
            ${r.sort().map(l=>` ${AR(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${s}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Qg(t,e){let r=t;for(const n in e){const s=e[n];s.join(`
`).length?r=r.replace(`{{${n}}}`,`//-----${n} START-----//
${s.join(`
`)}
//----${n} FINISH----//`):r=r.replace(`{{${n}}}`,"")}return r}const Fr=Object.create(null),Uc=new Map;let bR=0;function qR({template:t,bits:e}){const r=Rq(t,e);if(Fr[r])return Fr[r];const{vertex:n,fragment:s}=vR(t,e);return Fr[r]=Mq(n,s,e),Fr[r]}function wR({template:t,bits:e}){const r=Rq(t,e);return Fr[r]||(Fr[r]=Mq(t.vertex,t.fragment,e)),Fr[r]}function vR(t,e){const r=e.map(o=>o.vertex).filter(o=>!!o),n=e.map(o=>o.fragment).filter(o=>!!o);let s=Wg(r,t.vertex,!0);s=xR(r,s);const i=Wg(n,t.fragment,!0);return{vertex:s,fragment:i}}function Rq(t,e){return e.map(r=>(Uc.has(r)||Uc.set(r,bR++),Uc.get(r))).sort((r,n)=>r-n).join("-")+t.vertex+t.fragment}function Mq(t,e,r){const n=Hg(t),s=Hg(e);return r.forEach(i=>{Ug(i.vertex,n,i.name),Ug(i.fragment,s,i.name)}),{vertex:Qg(t,n),fragment:Qg(e,s)}}const VR=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,_R=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,SR=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,kR=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,CR={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},PR={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function ER({bits:t,name:e}){const r=qR({template:{fragment:_R,vertex:VR},bits:[CR,...t]});return el.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function TR({bits:t,name:e}){return new qq({name:e,...wR({template:{vertex:SR,fragment:kR},bits:[PR,...t]})})}const RR={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},MR={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Hc={};function IR(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let n=0;n<t;n++)e.push(`@group(1) @binding(${r++}) var textureSource${n+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${n+1}: sampler;`)}return e.join(`
`)}function jR(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function OR(t){return Hc[t]||(Hc[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${IR(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${jR(t)}
            `}}),Hc[t]}const $c={};function BR(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function zR(t){return $c[t]||($c[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${BR(t)}
            `}}),$c[t]}const NR={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},DR={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Yg={};function FR(t){let e=Yg[t];if(e)return e;const r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=n;return e=Yg[t]=new _q({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class LR extends Nd{constructor(e){const r=TR({name:"batch",bits:[MR,zR(e),DR]}),n=ER({name:"batch",bits:[RR,OR(e),NR]});super({glProgram:r,gpuProgram:n,resources:{batchSamplers:FR(e)}})}}let Kg=null;const Iq=class jq extends cR{constructor(){super(...arguments),this.geometry=new mR,this.shader=Kg||(Kg=new LR(this.maxTextures)),this.name=jq.extension.name,this.vertexSize=6}packAttributes(e,r,n,s,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,{positions:m,uvs:A}=e,g=e.color,y=e.attributeOffset,b=y+e.attributeSize;for(let x=y;x<b;x++){const q=x*2,V=m[q],_=m[q+1];r[s++]=l*V+u*_+d,r[s++]=h*_+c*V+f,r[s++]=A[q],r[s++]=A[q+1],n[s++]=g,n[s++]=o}}packQuadAttributes(e,r,n,s,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,m=e.bounds,A=m.maxX,g=m.minX,y=m.maxY,b=m.minY,x=o.uvs,q=e.color,V=i<<16|e.roundPixels&65535;r[s+0]=l*g+u*b+d,r[s+1]=h*b+c*g+f,r[s+2]=x.x0,r[s+3]=x.y0,n[s+4]=q,n[s+5]=V,r[s+6]=l*A+u*b+d,r[s+7]=h*b+c*A+f,r[s+8]=x.x1,r[s+9]=x.y1,n[s+10]=q,n[s+11]=V,r[s+12]=l*A+u*y+d,r[s+13]=h*y+c*A+f,r[s+14]=x.x2,r[s+15]=x.y2,n[s+16]=q,n[s+17]=V,r[s+18]=l*g+u*y+d,r[s+19]=h*y+c*g+f,r[s+20]=x.x3,r[s+21]=x.y3,n[s+22]=q,n[s+23]=V}};Iq.extension={type:[te.Batcher],name:"default"};let UR=Iq;function HR(t,e,r,n,s,i,o,a=null){let l=0;r*=e,s*=i;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,m=a.ty;for(;l<o;){const A=t[r],g=t[r+1];n[s]=c*A+h*g+f,n[s+1]=u*A+d*g+m,s+=i,r+=e,l++}}function $R(t,e,r,n){let s=0;for(e*=r;s<n;)t[e]=0,t[e+1]=0,e+=r,s++}function Oq(t,e,r,n,s){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),n||(n=2),s||(s=t.length/n-r);let h=r*n;for(let d=0;d<s;d++){const f=t[h],m=t[h+1];t[h]=i*f+a*m+c,t[h+1]=o*f+l*m+u,h+=n}}const WR=new ge;class Bq{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,n=this.renderable;return n?eq(r,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||WR}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Ri={extension:{type:te.ShapeBuilder,name:"circle"},build(t,e){let r,n,s,i,o,a;if(t.type==="circle"){const q=t;r=q.x,n=q.y,o=a=q.radius,s=i=0}else if(t.type==="ellipse"){const q=t;r=q.x,n=q.y,o=q.halfWidth,a=q.halfHeight,s=i=0}else{const q=t,V=q.width/2,_=q.height/2;r=q.x+V,n=q.y+_,o=a=Math.max(0,Math.min(q.radius,Math.min(V,_))),s=V-o,i=_-a}if(!(o>=0&&a>=0&&s>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(s?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+s,e[1]=e[3]=n+i,e[2]=e[4]=r-s,e[5]=e[7]=n-i,e;let u=0,h=l*4+(s?2:0)+2,d=h,f=c,m=s+o,A=i,g=r+m,y=r-m,b=n+A;if(e[u++]=g,e[u++]=b,e[--h]=b,e[--h]=y,i){const q=n-A;e[d++]=y,e[d++]=q,e[--f]=q,e[--f]=g}for(let q=1;q<l;q++){const V=Math.PI/2*(q/l),_=s+Math.cos(V)*o,v=i+Math.sin(V)*a,S=r+_,E=r-_,R=n+v,I=n-v;e[u++]=S,e[u++]=R,e[--h]=R,e[--h]=E,e[d++]=E,e[d++]=I,e[--f]=I,e[--f]=S}m=s,A=i+a,g=r+m,y=r-m,b=n+A;const x=n-A;return e[u++]=g,e[u++]=b,e[--f]=x,e[--f]=g,s&&(e[u++]=y,e[u++]=b,e[--f]=x,e[--f]=y),e},triangulate(t,e,r,n,s,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=n;e[l*r]=o,e[l*r+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(s[i++]=l,s[i++]=c,s[i++]=l-1),l++;s[i++]=c+1,s[i++]=c,s[i++]=l-1}},GR={...Ri,extension:{...Ri.extension,name:"ellipse"}},QR={...Ri,extension:{...Ri.extension,name:"roundedRectangle"}},zq=1e-4,Xg=1e-4;function YR(t){const e=t.length;if(e<6)return 1;let r=0;for(let n=0,s=t[e-2],i=t[e-1];n<e;n+=2){const o=t[n],a=t[n+1];r+=(o-s)*(a+i),s=o,i=a}return r<0?-1:1}function Jg(t,e,r,n,s,i,o,a){const l=t-r*s,c=e-n*s,u=t+r*i,h=e+n*i;let d,f;o?(d=n,f=-r):(d=-n,f=r);const m=l+d,A=c+f,g=u+d,y=h+f;return a.push(m,A),a.push(g,y),2}function ln(t,e,r,n,s,i,o,a){const l=r-t,c=n-e;let u=Math.atan2(l,c),h=Math.atan2(s-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,m=Math.abs(f),A=Math.sqrt(l*l+c*c),g=(15*m*Math.sqrt(A)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(t,e),o.push(r,n);for(let b=1,x=d;b<g;b++,x+=y)o.push(t,e),o.push(t+Math.sin(x)*A,e+Math.cos(x)*A);o.push(t,e),o.push(s,i)}else{o.push(r,n),o.push(t,e);for(let b=1,x=d;b<g;b++,x+=y)o.push(t+Math.sin(x)*A,e+Math.cos(x)*A),o.push(t,e);o.push(s,i),o.push(t,e)}return g*2}function KR(t,e,r,n,s,i){const o=zq;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let M=YR(t);l=(l-.5)*M+.5}const c=new ft(t[0],t[1]),u=new ft(t[t.length-2],t[t.length-1]),h=n,d=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),d&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const M=(c.x+u.x)*.5,T=(u.y+c.y)*.5;t.unshift(M,T),t.push(M,T)}const f=s,m=t.length/2;let A=t.length;const g=f.length/2,y=a.width/2,b=y*y,x=a.miterLimit*a.miterLimit;let q=t[0],V=t[1],_=t[2],v=t[3],S=0,E=0,R=-(V-v),I=q-_,B=0,N=0,D=Math.sqrt(R*R+I*I);R/=D,I/=D,R*=y,I*=y;const U=l,w=(1-U)*2,k=U*2;h||(a.cap==="round"?A+=ln(q-R*(w-k)*.5,V-I*(w-k)*.5,q-R*w,V-I*w,q+R*k,V+I*k,f,!0)+2:a.cap==="square"&&(A+=Jg(q,V,R,I,w,k,!0,f))),f.push(q-R*w,V-I*w),f.push(q+R*k,V+I*k);for(let M=1;M<m-1;++M){q=t[(M-1)*2],V=t[(M-1)*2+1],_=t[M*2],v=t[M*2+1],S=t[(M+1)*2],E=t[(M+1)*2+1],R=-(V-v),I=q-_,D=Math.sqrt(R*R+I*I),R/=D,I/=D,R*=y,I*=y,B=-(v-E),N=_-S,D=Math.sqrt(B*B+N*N),B/=D,N/=D,B*=y,N*=y;const T=_-q,j=V-v,O=_-S,z=E-v,F=T*O+j*z,L=j*O-z*T,W=L<0;if(Math.abs(L)<.001*Math.abs(F)){f.push(_-R*w,v-I*w),f.push(_+R*k,v+I*k),F>=0&&(a.join==="round"?A+=ln(_,v,_-R*w,v-I*w,_-B*w,v-N*w,f,!1)+4:A+=2,f.push(_-B*k,v-N*k),f.push(_+B*w,v+N*w));continue}const Y=(-R+q)*(-I+v)-(-R+_)*(-I+V),re=(-B+S)*(-N+v)-(-B+_)*(-N+E),ie=(T*re-O*Y)/L,ne=(z*Y-j*re)/L,pt=(ie-_)*(ie-_)+(ne-v)*(ne-v),$e=_+(ie-_)*w,nt=v+(ne-v)*w,Tt=_-(ie-_)*k,oe=v-(ne-v)*k,xe=Math.min(T*T+j*j,O*O+z*z),wf=W?w:k,bv=xe+wf*wf*b;pt<=bv?a.join==="bevel"||pt/b>x?(W?(f.push($e,nt),f.push(_+R*k,v+I*k),f.push($e,nt),f.push(_+B*k,v+N*k)):(f.push(_-R*w,v-I*w),f.push(Tt,oe),f.push(_-B*w,v-N*w),f.push(Tt,oe)),A+=2):a.join==="round"?W?(f.push($e,nt),f.push(_+R*k,v+I*k),A+=ln(_,v,_+R*k,v+I*k,_+B*k,v+N*k,f,!0)+4,f.push($e,nt),f.push(_+B*k,v+N*k)):(f.push(_-R*w,v-I*w),f.push(Tt,oe),A+=ln(_,v,_-R*w,v-I*w,_-B*w,v-N*w,f,!1)+4,f.push(_-B*w,v-N*w),f.push(Tt,oe)):(f.push($e,nt),f.push(Tt,oe)):(f.push(_-R*w,v-I*w),f.push(_+R*k,v+I*k),a.join==="round"?W?A+=ln(_,v,_+R*k,v+I*k,_+B*k,v+N*k,f,!0)+2:A+=ln(_,v,_-R*w,v-I*w,_-B*w,v-N*w,f,!1)+2:a.join==="miter"&&pt/b<=x&&(W?(f.push(Tt,oe),f.push(Tt,oe)):(f.push($e,nt),f.push($e,nt)),A+=2),f.push(_-B*w,v-N*w),f.push(_+B*k,v+N*k),A+=2)}q=t[(m-2)*2],V=t[(m-2)*2+1],_=t[(m-1)*2],v=t[(m-1)*2+1],R=-(V-v),I=q-_,D=Math.sqrt(R*R+I*I),R/=D,I/=D,R*=y,I*=y,f.push(_-R*w,v-I*w),f.push(_+R*k,v+I*k),h||(a.cap==="round"?A+=ln(_-R*(w-k)*.5,v-I*(w-k)*.5,_-R*w,v-I*w,_+R*k,v+I*k,f,!1)+2:a.cap==="square"&&(A+=Jg(_,v,R,I,w,k,!1,f)));const P=Xg*Xg;for(let M=g;M<A+g-2;++M)q=f[M*2],V=f[M*2+1],_=f[(M+1)*2],v=f[(M+1)*2+1],S=f[(M+2)*2],E=f[(M+2)*2+1],!(Math.abs(q*(v-E)+_*(E-V)+S*(V-v))<P)&&i.push(M,M+1,M+2)}function XR(t,e,r,n){const s=zq;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<s&&Math.abs(o-l)<s,u=r,h=t.length/2,d=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)n.push(d+f,d+f+1);c&&n.push(d+h-1,d)}function Nq(t,e,r,n,s,i,o){const a=$T(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+s,i[o++]=a[c+1]+s,i[o++]=a[c+2]+s;let l=s*n;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=n}const JR=[],ZR={extension:{type:te.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,n,s,i){Nq(t,JR,e,r,n,s,i)}},eM={extension:{type:te.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,n=r.x,s=r.y,i=r.width,o=r.height;return i>=0&&o>=0&&(e[0]=n,e[1]=s,e[2]=n+i,e[3]=s,e[4]=n+i,e[5]=s+o,e[6]=n,e[7]=s+o),e},triangulate(t,e,r,n,s,i){let o=0;n*=r,e[n+o]=t[0],e[n+o+1]=t[1],o+=r,e[n+o]=t[2],e[n+o+1]=t[3],o+=r,e[n+o]=t[6],e[n+o+1]=t[7],o+=r,e[n+o]=t[4],e[n+o+1]=t[5],o+=r;const a=n/r;s[i++]=a,s[i++]=a+1,s[i++]=a+2,s[i++]=a+1,s[i++]=a+3,s[i++]=a+2}},tM={extension:{type:te.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,n,s,i){let o=0;n*=r,e[n+o]=t[0],e[n+o+1]=t[1],o+=r,e[n+o]=t[2],e[n+o+1]=t[3],o+=r,e[n+o]=t[4],e[n+o+1]=t[5];const a=n/r;s[i++]=a,s[i++]=a+1,s[i++]=a+2}},rM=new ge,nM=new Fe;function sM(t,e,r,n){const s=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(nM);s.translate(-i.x,-i.y),s.scale(1/i.width,1/i.height)}else{s.translate(e.texture.frame.x,e.texture.frame.y),s.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return n&&s.append(rM.copyFrom(n).invert()),s}const rl={};kt.handleByMap(te.ShapeBuilder,rl);kt.add(eM,ZR,tM,Ri,GR,QR);const iM=new Fe,oM=new ge;function aM(t,e){const{geometryData:r,batches:n}=e;n.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let s=0;s<t.instructions.length;s++){const i=t.instructions[s];if(i.action==="texture")lM(i.data,n,r);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&Zg(c.shapePath,l,!0,n,r),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Zg(a,l,o,n,r)}}}function lM(t,e,r){const{vertices:n,uvs:s,indices:i}=r,o=i.length,a=n.length/2,l=[],c=rl.rectangle,u=iM,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const d=t.transform;c.build(u,l),d&&Oq(l,d),c.triangulate(l,n,2,a,i,o);const f=h.uvs;s.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const m=kr.get(Bq);m.indexOffset=o,m.indexSize=i.length-o,m.attributeOffset=a,m.attributeSize=n.length/2-a,m.baseColor=t.style,m.alpha=t.alpha,m.texture=h,m.geometryData=r,e.push(m)}function Zg(t,e,r,n,s){const{vertices:i,uvs:o,indices:a}=s;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=a.length,d=i.length/2,f=[],m=rl[l.type];let A="triangle-list";if(m.build(l,f),c&&Oq(f,c),r){const x=l.closePath??!0,q=e;q.pixelLine?(XR(f,x,i,a),A="line-list"):KR(f,q,!1,x,i,a)}else if(u){const x=[],q=f.slice();cM(u).forEach(_=>{x.push(q.length/2),q.push(..._)}),Nq(q,x,i,2,d,a,h)}else m.triangulate(f,i,2,d,a,h);const g=o.length/2,y=e.texture;if(y!==me.WHITE){const x=sM(oM,e,l,c);HR(i,2,d,o,g,2,i.length/2-d,x)}else $R(o,g,2,i.length/2-d);const b=kr.get(Bq);b.indexOffset=h,b.indexSize=a.length-h,b.attributeOffset=d,b.attributeSize=i.length/2-d,b.baseColor=e.color,b.alpha=e.alpha,b.texture=y,b.geometryData=s,b.topology=A,n.push(b)})}function cM(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r].shape,s=[];rl[n.type].build(n,s),e.push(s)}return e}class uM{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class hM{constructor(){this.batcher=new UR,this.instructions=new sq}init(){this.instructions.reset()}get geometry(){return Ie(EE,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Hd=class mh{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){mh.defaultOptions.bezierSmoothness=e?.bezierSmoothness??mh.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),aM(e,r);const n=e.batchMode;e.customShader||n==="no-batch"?r.isBatchable=!1:n==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=kr.get(hM),{batches:n,geometryData:s}=this._gpuContextHash[e.uid],i=s.vertices.length,o=s.indices.length;for(let u=0;u<n.length;u++)n[u].applyTransform=!1;const a=r.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let u=0;u<n.length;u++){const h=n[u];a.add(h)}a.finish(r.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=nR(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new uM;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(kr.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(n=>{kr.return(n)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};Hd.extension={type:[te.WebGLSystem,te.WebGPUSystem,te.CanvasSystem],name:"graphicsContext"};Hd.defaultOptions={bezierSmoothness:.5};let Dq=Hd;const dM=8,Ho=11920929e-14,fM=1;function Fq(t,e,r,n,s,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??Dq.defaultOptions.bezierSmoothness));let d=(fM-h)/1;return d*=d,pM(e,r,n,s,i,o,a,l,t,d),t}function pM(t,e,r,n,s,i,o,a,l,c){gh(t,e,r,n,s,i,o,a,l,c,0),l.push(o,a)}function gh(t,e,r,n,s,i,o,a,l,c,u){if(u>dM)return;const h=(t+r)/2,d=(e+n)/2,f=(r+s)/2,m=(n+i)/2,A=(s+o)/2,g=(i+a)/2,y=(h+f)/2,b=(d+m)/2,x=(f+A)/2,q=(m+g)/2,V=(y+x)/2,_=(b+q)/2;if(u>0){let v=o-t,S=a-e;const E=Math.abs((r-o)*S-(n-a)*v),R=Math.abs((s-o)*S-(i-a)*v);if(E>Ho&&R>Ho){if((E+R)*(E+R)<=c*(v*v+S*S)){l.push(V,_);return}}else if(E>Ho){if(E*E<=c*(v*v+S*S)){l.push(V,_);return}}else if(R>Ho){if(R*R<=c*(v*v+S*S)){l.push(V,_);return}}else if(v=V-(t+o)/2,S=_-(e+a)/2,v*v+S*S<=c){l.push(V,_);return}}gh(t,e,h,d,y,b,V,_,l,c,u+1),gh(V,_,x,q,A,g,o,a,l,c,u+1)}const mM=8,gM=11920929e-14,AM=1;function yM(t,e,r,n,s,i,o,a){const c=Math.min(.99,Math.max(0,a??Dq.defaultOptions.bezierSmoothness));let u=(AM-c)/1;return u*=u,xM(e,r,n,s,i,o,t,u),t}function xM(t,e,r,n,s,i,o,a){Ah(o,t,e,r,n,s,i,a,0),o.push(s,i)}function Ah(t,e,r,n,s,i,o,a,l){if(l>mM)return;const c=(e+n)/2,u=(r+s)/2,h=(n+i)/2,d=(s+o)/2,f=(c+h)/2,m=(u+d)/2;let A=i-e,g=o-r;const y=Math.abs((n-i)*g-(s-o)*A);if(y>gM){if(y*y<=a*(A*A+g*g)){t.push(f,m);return}}else if(A=f-(e+i)/2,g=m-(r+o)/2,A*A+g*g<=a){t.push(f,m);return}Ah(t,e,r,c,u,f,m,a,l+1),Ah(t,f,m,h,d,i,o,a,l+1)}function Lq(t,e,r,n,s,i,o,a){let l=Math.abs(s-i);(!o&&s>i||o&&i>s)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=s;c*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),m=e+d*n,A=r+f*n;t.push(m,A),u+=c}}function bM(t,e,r,n,s,i){const o=t[t.length-2],l=t[t.length-1]-r,c=o-e,u=s-r,h=n-e,d=Math.abs(l*h-c*u);if(d<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const f=l*l+c*c,m=u*u+h*h,A=l*u+c*h,g=i*Math.sqrt(f)/d,y=i*Math.sqrt(m)/d,b=g*A/f,x=y*A/m,q=g*h+y*c,V=g*u+y*l,_=c*(y+b),v=l*(y+b),S=h*(g+x),E=u*(g+x),R=Math.atan2(v-V,_-q),I=Math.atan2(E-V,S-q);Lq(t,q+e,V+r,i,R,I,c*u>h*l)}const yi=Math.PI*2,Wc={centerX:0,centerY:0,ang1:0,ang2:0},Gc=({x:t,y:e},r,n,s,i,o,a,l)=>{t*=r,e*=n;const c=s*t-i*e,u=i*t+s*e;return l.x=c+o,l.y=u+a,l};function qM(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=e===1.5707963267948966?.551915024494:r,s=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:s-i*n,y:i+s*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const eA=(t,e,r,n)=>{const s=t*n-e*r<0?-1:1;let i=t*r+e*n;return i>1&&(i=1),i<-1&&(i=-1),s*Math.acos(i)},wM=(t,e,r,n,s,i,o,a,l,c,u,h,d)=>{const f=Math.pow(s,2),m=Math.pow(i,2),A=Math.pow(u,2),g=Math.pow(h,2);let y=f*m-f*g-m*A;y<0&&(y=0),y/=f*g+m*A,y=Math.sqrt(y)*(o===a?-1:1);const b=y*s/i*h,x=y*-i/s*u,q=c*b-l*x+(t+r)/2,V=l*b+c*x+(e+n)/2,_=(u-b)/s,v=(h-x)/i,S=(-u-b)/s,E=(-h-x)/i,R=eA(1,0,_,v);let I=eA(_,v,S,E);a===0&&I>0&&(I-=yi),a===1&&I<0&&(I+=yi),d.centerX=q,d.centerY=V,d.ang1=R,d.ang2=I};function vM(t,e,r,n,s,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*yi/360),h=Math.cos(a*yi/360),d=h*(e-n)/2+u*(r-s)/2,f=-u*(e-n)/2+h*(r-s)/2;if(d===0&&f===0)return;i=Math.abs(i),o=Math.abs(o);const m=Math.pow(d,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(o,2);m>1&&(i*=Math.sqrt(m),o*=Math.sqrt(m)),wM(e,r,n,s,i,o,l,c,u,h,d,f,Wc);let{ang1:A,ang2:g}=Wc;const{centerX:y,centerY:b}=Wc;let x=Math.abs(g)/(yi/4);Math.abs(1-x)<1e-7&&(x=1);const q=Math.max(Math.ceil(x),1);g/=q;let V=t[t.length-2],_=t[t.length-1];const v={x:0,y:0};for(let S=0;S<q;S++){const E=qM(A,g),{x:R,y:I}=Gc(E[0],i,o,h,u,y,b,v),{x:B,y:N}=Gc(E[1],i,o,h,u,y,b,v),{x:D,y:U}=Gc(E[2],i,o,h,u,y,b,v);Fq(t,V,_,R,I,B,N,D,U),V=D,_=U,A+=g}}function VM(t,e,r){const n=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},s=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??r;if(l<=0){s(o,a),i=a;continue}const c=e[(o+1)%e.length],u=n(a,i),h=n(a,c);if(u.len<1e-4||h.len<1e-4){s(o,a),i=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,m=!0):d>0&&(f=-1,m=!0);const A=d/2;let g,y=Math.abs(Math.cos(A)*l/Math.sin(A));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),g=Math.abs(y*Math.sin(A)/Math.cos(A))):g=l;const b=a.x+h.nx*y+-h.ny*g*f,x=a.y+h.ny*y+h.nx*g*f,q=Math.atan2(u.ny,u.nx)+Math.PI/2*f,V=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&t.moveTo(b+Math.cos(q)*g,x+Math.sin(q)*g),t.arc(b,x,g,q,V,m),i=a}}function _M(t,e,r,n){const s=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??r;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],d=s(u,l);let f;if(d<1e-4)f=l;else{const g=Math.min(d/2,c);f=i(l,u,g/d)}const m=s(h,l);let A;if(m<1e-4)A=l;else{const g=Math.min(m/2,c);A=i(l,h,g/m)}a===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,A.x,A.y,n)}}const SM=new Fe;class kM{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new sr,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const n=this._currentPoly.points,s=n[n.length-2],i=n[n.length-1];return(s!==e||i!==r)&&n.push(e,r),this}arc(e,r,n,s,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Lq(a,e,r,n,s,i,o),this}arcTo(e,r,n,s,i){this._ensurePoly();const o=this._currentPoly.points;return bM(o,e,r,n,s,i),this}arcToSvg(e,r,n,s,i,o,a){const l=this._currentPoly.points;return vM(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,r,n,s,i),this}bezierCurveTo(e,r,n,s,i,o,a){this._ensurePoly();const l=this._currentPoly;return Fq(this._currentPoly.points,l.lastX,l.lastY,e,r,n,s,i,o,a),this}quadraticCurveTo(e,r,n,s,i){this._ensurePoly();const o=this._currentPoly;return yM(this._currentPoly.points,o.lastX,o.lastY,e,r,n,s,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const n=this.shapePrimitives,s=n.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&n.length-s>1){let i=null;for(let o=s;o<n.length;o++){const a=n[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),n.copyWithin(o,o+1),n.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,n,s,i){return this.drawShape(new Fe(e,r,n,s),i),this}circle(e,r,n,s){return this.drawShape(new Fd(e,r,n),s),this}poly(e,r,n){const s=new Ai(e);return s.closePath=r,this.drawShape(s,n),this}regularPoly(e,r,n,s,i=0,o){s=Math.max(s|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/s,c=[];for(let u=0;u<s;u++){const h=a-u*l;c.push(e+n*Math.cos(h),r+n*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,r,n,s,i,o=0,a){if(s=Math.max(s|0,3),i<=0)return this.regularPoly(e,r,n,s,o);const l=n*Math.sin(Math.PI/s)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/s,h=(s-2)*Math.PI/s/2;for(let d=0;d<s;d++){const f=d*u+c,m=e+n*Math.cos(f),A=r+n*Math.sin(f),g=f+Math.PI+h,y=f-Math.PI-h,b=m+i*Math.cos(g),x=A+i*Math.sin(g),q=m+i*Math.cos(y),V=A+i*Math.sin(y);d===0?this.moveTo(b,x):this.lineTo(b,x),this.quadraticCurveTo(m,A,q,V,a)}return this.closePath()}roundShape(e,r,n=!1,s){return e.length<3?this:(n?_M(this,e,r,s):VM(this,e,r),this.closePath())}filletRect(e,r,n,s,i){if(i===0)return this.rect(e,r,n,s);const o=Math.min(n,s)/2,a=Math.min(o,Math.max(-o,i)),l=e+n,c=r+s,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+n-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,n,s,i,o){if(i<=0)return this.rect(e,r,n,s);const a=Math.min(i,Math.min(n,s)/2),l=e+n,c=r+s,u=[e+a,r,l-a,r,l,r+a,l,c-a,l-a,c,e+a,c,e,c-a,e,r+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,r,n,s,i){return this.drawShape(new Ld(e,r,n,s),i),this}roundRect(e,r,n,s,i,o){return this.drawShape(new Ud(e,r,n,s,i),o),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let n=this._currentPoly;return n&&this.endPoly(),n=new Ai,n.points.push(e,r),this._currentPoly=n,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Ai,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let n=r.shape.x,s=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,o=n;n=i.a*n+i.c*s+i.tx,s=i.b*o+i.d*s+i.ty}this._currentPoly.points.push(n,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const n=e.instructions[r];this[n.action](...n.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let n=0;n<r.length;n++){const s=r[n],i=s.shape.getBounds(SM);s.transform?e.addRect(i,s.transform):e.addRect(i)}return e}}class bs{constructor(e,r=!1){this.instructions=[],this.uid=Le("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?KT(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new kM(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,n,s,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(ft.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,n,s,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,n){const s=this.instructions[this.instructions.length-1],i=this.getLastPoint(ft.shared);let o=0,a=0;if(!s||s.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=s.data[0],a=s.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,r,n]}),this._dirty=!0,this}rect(e,r,n,s,i){return this.instructions.push({action:"rect",data:[e,r,n,s,i]}),this._dirty=!0,this}circle(e,r,n,s){return this.instructions.push({action:"circle",data:[e,r,n,s]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,n,s,i,o,a){i||(i=s/2);const l=-1*Math.PI/2+o,c=n*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?i:s,m=d*u+l;h.push(e+f*Math.cos(m),r+f*Math.sin(m))}return this.poly(h,!0,a),this}clone(e=!1){const r=new bs;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const s=this.instructions[n];r.instructions.push({action:s.action,data:s.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,n=e.b,s=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,m=0,A=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],b=y.data;switch(y.action){case"moveTo":case"lineTo":l=b[0],c=b[1],b[0]=r*l+s*c+o,b[1]=n*l+i*c+a;break;case"bezierCurveTo":u=b[0],h=b[1],d=b[2],f=b[3],l=b[4],c=b[5],b[0]=r*u+s*h+o,b[1]=n*u+i*h+a,b[2]=r*d+s*f+o,b[3]=n*d+i*f+a,b[4]=r*l+s*c+o,b[5]=n*l+i*c+a;break;case"quadraticCurveTo":u=b[0],h=b[1],l=b[2],c=b[3],b[0]=r*u+s*h+o,b[1]=n*u+i*h+a,b[2]=r*l+s*c+o,b[3]=n*l+i*c+a;break;case"arcToSvg":l=b[5],c=b[6],m=b[0],A=b[1],b[0]=r*m+s*A,b[1]=n*m+i*A,b[5]=r*l+s*c+o,b[6]=n*l+i*c+a;break;case"circle":b[4]=Xs(b[3],e);break;case"rect":b[4]=Xs(b[4],e);break;case"ellipse":b[8]=Xs(b[8],e);break;case"roundRect":b[5]=Xs(b[5],e);break;case"addPath":b[0].transform(e);break;case"poly":b[2]=Xs(b[2],e);break;default:ke("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,n=this.instructions[r];if(!n)return e.x=0,e.y=0,e;for(;n.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;n=this.instructions[r]}switch(n.action){case"moveTo":case"lineTo":e.x=n.data[0],e.y=n.data[1];break;case"quadraticCurveTo":e.x=n.data[2],e.y=n.data[3];break;case"bezierCurveTo":e.x=n.data[4],e.y=n.data[5];break;case"arc":case"arcToSvg":e.x=n.data[5],e.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(e);break}return e}}function Xs(t,e){return t?t.prepend(e):e.clone()}function Pe(t,e,r){const n=t.getAttribute(e);return n?Number(n):r}function CM(t,e){const r=t.querySelectorAll("defs");for(let n=0;n<r.length;n++){const s=r[n];for(let i=0;i<s.children.length;i++){const o=s.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=PM(o);break;case"radialgradient":e.defs[o.id]=EM();break}}}}function PM(t){const e=Pe(t,"x1",0),r=Pe(t,"y1",0),n=Pe(t,"x2",1),s=Pe(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new Wr(e,r,n,s,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Pe(l,"offset",0),u=lt.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function EM(t){return ke("[SVG Parser] Radial gradients are not yet supported"),new Wr(0,0,1,0)}function tA(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const rA={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Uq(t,e){const r=t.getAttribute("style"),n={},s={},i={strokeStyle:n,fillStyle:s,useFill:!1,useStroke:!1};for(const o in rA){const a=t.getAttribute(o);a&&nA(e,i,o,a.trim())}if(r){const o=r.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");rA[c]&&nA(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?n:null,fillStyle:i.useFill?s:null,useFill:i.useFill,useStroke:i.useStroke}}function nA(t,e,r,n){switch(r){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const s=tA(n);e.strokeStyle.fill=t.defs[s]}else e.strokeStyle.color=lt.shared.setValue(n).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const s=tA(n);e.fillStyle.fill=t.defs[s]}else e.fillStyle.color=lt.shared.setValue(n).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(n);break;case"stroke-opacity":e.strokeStyle.alpha=Number(n);break;case"opacity":e.fillStyle.alpha=Number(n),e.strokeStyle.alpha=Number(n);break}}function TM(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const r={context:e,defs:{},path:new bs};CM(t,r);const n=t.children,{fillStyle:s,strokeStyle:i}=Uq(t,r);for(let o=0;o<n.length;o++){const a=n[o];a.nodeName.toLowerCase()!=="defs"&&Hq(a,r,s,i)}return e}function Hq(t,e,r,n){const s=t.children,{fillStyle:i,strokeStyle:o}=Uq(t,e);i&&r?r={...r,...i}:i&&(r=i),o&&n?n={...n,...o}:o&&(n=o);const a=!r&&!n;a&&(r={color:0});let l,c,u,h,d,f,m,A,g,y,b,x,q,V,_,v,S;switch(t.nodeName.toLowerCase()){case"path":V=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&ke("SVG Evenodd fill rule not supported, your svg may render incorrectly"),_=new bs(V,!0),e.context.path(_),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"circle":m=Pe(t,"cx",0),A=Pe(t,"cy",0),g=Pe(t,"r",0),e.context.ellipse(m,A,g,g),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"rect":l=Pe(t,"x",0),c=Pe(t,"y",0),v=Pe(t,"width",0),S=Pe(t,"height",0),y=Pe(t,"rx",0),b=Pe(t,"ry",0),y||b?e.context.roundRect(l,c,v,S,y||b):e.context.rect(l,c,v,S),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"ellipse":m=Pe(t,"cx",0),A=Pe(t,"cy",0),y=Pe(t,"rx",0),b=Pe(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,A,y,b),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"line":u=Pe(t,"x1",0),h=Pe(t,"y1",0),d=Pe(t,"x2",0),f=Pe(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(d,f),n&&e.context.stroke(n);break;case"polygon":q=t.getAttribute("points"),x=q.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!0),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"polyline":q=t.getAttribute("points"),x=q.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!1),n&&e.context.stroke(n);break;case"g":case"svg":break;default:{ke(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(r=null);for(let E=0;E<s.length;E++)Hq(s[E],e,r,n)}function RM(t){return lt.isColorLike(t)}function sA(t){return t instanceof tl}function iA(t){return t instanceof Wr}function MM(t){return t instanceof me}function IM(t,e,r){const n=lt.shared.setValue(e??0);return t.color=n.toNumber(),t.alpha=n.alpha===1?r.alpha:n.alpha,t.texture=me.WHITE,{...r,...t}}function jM(t,e,r){return t.texture=e,{...r,...t}}function oA(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function aA(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function OM(t,e){const r={...e,...t},n=lt.shared.setValue(r.color);return r.alpha*=n.alpha,r.color=n.toNumber(),r}function qn(t,e){if(t==null)return null;const r={},n=t;return RM(t)?IM(r,t,e):MM(t)?jM(r,t,e):sA(t)?oA(r,t,e):iA(t)?aA(r,t,e):n.fill&&sA(n.fill)?oA(n,n.fill,e):n.fill&&iA(n.fill)?aA(n,n.fill,e):OM(n,e)}function Ra(t,e){const{width:r,alignment:n,miterLimit:s,cap:i,join:o,pixelLine:a,...l}=e,c=qn(t,l);return c?{width:r,alignment:n,miterLimit:s,cap:i,join:o,pixelLine:a,...c}:null}const BM=new ft,lA=new ge,$d=class cr extends pr{constructor(){super(...arguments),this.uid=Le("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new bs,this._transform=new ge,this._fillStyle={...cr.defaultFillStyle},this._strokeStyle={...cr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new sr,this._boundsDirty=!0}clone(){const e=new cr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=qn(e,cr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Ra(e,cr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=qn(e,cr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=qn(e,cr.defaultStrokeStyle),this}texture(e,r,n,s,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:n||0,dy:s||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?lt.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new bs,this}fill(e,r){let n;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="stroke"?n=s.data.path:n=this._activePath.clone(),n?(e!=null&&(r!==void 0&&typeof e=="number"&&(Ie(dt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=qn(e,cr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(ft.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?r=n.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=Ra(e,cr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],n=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(n);else{r.data.hole=n;break}}return this._initNextPathLocation(),this}arc(e,r,n,s,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,n,s,i,o),this}arcTo(e,r,n,s,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*n+o.c*s+o.tx,o.b*n+o.d*s+o.ty,i),this}arcToSvg(e,r,n,s,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,n,s,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,r,n,s,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*n+l.c*s+l.tx,l.b*n+l.d*s+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,n,s){return this._tick++,this._activePath.ellipse(e,r,n,s,this._transform.clone()),this}circle(e,r,n){return this._tick++,this._activePath.circle(e,r,n,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*e+n.c*r+n.tx,n.b*e+n.d*r+n.ty),this}moveTo(e,r){this._tick++;const n=this._transform,s=this._activePath.instructions,i=n.a*e+n.c*r+n.tx,o=n.b*e+n.d*r+n.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=i,s[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,r,n,s,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*n+o.c*s+o.tx,o.b*n+o.d*s+o.ty,i),this}rect(e,r,n,s){return this._tick++,this._activePath.rect(e,r,n,s,this._transform.clone()),this}roundRect(e,r,n,s,i){return this._tick++,this._activePath.roundRect(e,r,n,s,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,n,s,i=0,o){return this._tick++,this._activePath.regularPoly(e,r,n,s,i,o),this}roundPoly(e,r,n,s,i,o){return this._tick++,this._activePath.roundPoly(e,r,n,s,i,o),this}roundShape(e,r,n,s){return this._tick++,this._activePath.roundShape(e,r,n,s),this}filletRect(e,r,n,s,i){return this._tick++,this._activePath.filletRect(e,r,n,s,i),this}chamferRect(e,r,n,s,i,o){return this._tick++,this._activePath.chamferRect(e,r,n,s,i,o),this}star(e,r,n,s,i=0,o=0){return this._tick++,this._activePath.star(e,r,n,s,i,o,this._transform.clone()),this}svg(e){return this._tick++,TM(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,n,s,i,o){return e instanceof ge?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,n,s,i,o),this)}transform(e,r,n,s,i,o){return e instanceof ge?(this._transform.append(e),this):(lA.set(e,r,n,s,i,o),this._transform.append(lA),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const n=this.instructions[r],s=n.action;if(s==="fill"){const i=n.data;e.addBounds(i.path.bounds)}else if(s==="texture"){const i=n.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(s==="stroke"){const i=n.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let n=!1;for(let s=0;s<r.length;s++){const i=r[s],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const d=c[u].transform,f=d?d.applyInverse(e,BM):e;if(i.action==="fill")n=h.contains(f.x,f.y);else{const A=l;n=h.strokeContains(f.x,f.y,A.width,A.alignment)}const m=o.hole;if(m){const A=m.shapePath?.shapePrimitives;if(A)for(let g=0;g<A.length;g++)A[g].shape.contains(f.x,f.y)&&(n=!1)}if(n)return!0}}return n}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(n),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(n)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};$d.defaultFillStyle={color:16777215,alpha:1,texture:me.WHITE,matrix:null,fill:null,textureSpace:"local"};$d.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:me.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let mn=$d;const cA=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function zM(t){const e=[];let r=0;for(let n=0;n<cA.length;n++){const s=`_${cA[n]}`;e[r++]=t[s]}return r=$q(t._fill,e,r),r=NM(t._stroke,e,r),r=DM(t.dropShadow,e,r),e.join("-")}function $q(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function NM(t,e,r){return t&&(r=$q(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function DM(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=lt.shared.setValue(t.color).toNumber()),r}const Wd=class rs extends pr{constructor(e={}){super(),FM(e);const r={...rs.defaultTextStyle,...e};for(const n in r){const s=n;this[s]=r[n]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...rs.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...rs.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...mn.defaultFillStyle,...e},()=>{this._fill=qn({...this._originalFill},mn.defaultFillStyle)})),this._fill=qn(e===0?"black":e,mn.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...mn.defaultStrokeStyle,...e},()=>{this._stroke=Ra({...this._originalStroke},mn.defaultStrokeStyle)})),this._stroke=Ra(e,mn.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=zM(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=rs.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new rs({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(n),this._originalFill?.texture&&this._originalFill.texture.destroy(n),this._stroke?.texture&&this._stroke.texture.destroy(n),this._originalStroke?.texture&&this._originalStroke.texture.destroy(n)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(n,s,i)=>(n[s]=i,r?.(s,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(lt.isColorLike(e)||e instanceof Wr||e instanceof tl)}};Wd.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Wd.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Mi=Wd;function FM(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=Mi.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){Ie(dt,"strokeThickness is now a part of stroke");const r=e.stroke;let n={};if(lt.isColorLike(r))n.color=r;else if(r instanceof Wr||r instanceof tl)n.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))n=r;else throw new Error("Invalid stroke value.");t.stroke={...n,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){Ie(dt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=Mi.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const n=new Wr({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),s=e.fillGradientStops.map(i=>lt.shared.setValue(i).toNumber());s.forEach((i,o)=>{const a=o/(s.length-1);n.addColorStop(a,i)}),t.fill={fill:n}}}class LM{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const n=Ye.get().createCanvas();n.width=e,n.height=r;const s=n.getContext("2d");return{canvas:n,context:s}}getOptimalCanvasAndContext(e,r,n=1){e=Math.ceil(e*n-1e-6),r=Math.ceil(r*n-1e-6),e=Pa(e),r=Pa(r);const s=(e<<17)+(r<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let i=this._canvasPool[s].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:n,height:s}=r,i=(n<<17)+(s<<1);e.context.clearRect(0,0,n,s),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const uA=new LM,UM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function yh(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let s=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!UM.includes(s)&&(s=`"${s}"`),r[n]=s}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const Qc={willReadFrequently:!0},ar=class K{static get experimentalLetterSpacingSupported(){let e=K._experimentalLetterSpacingSupported;if(e!==void 0){const r=Ye.get().getCanvasRenderingContext2D().prototype;e=K._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,s,i,o,a,l,c){this.text=e,this.style=r,this.width=n,this.height=s,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,n=K._canvas,s=r.wordWrap){const i=`${e}:${r.styleKey}`;if(K._measurementCache[i])return K._measurementCache[i];const o=yh(r),a=K.measureFont(o);a.fontSize===0&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const l=K.__context;l.font=o;const u=(s?K._wordWrap(e,r,n):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let b=0;b<u.length;b++){const x=K._measureText(u[b],r.letterSpacing,l);h[b]=x,d=Math.max(d,x)}const f=r._stroke?.width||0;let m=d+f;r.dropShadow&&(m+=r.dropShadow.distance);const A=r.lineHeight||a.fontSize;let g=Math.max(A,a.fontSize+f)+(u.length-1)*(A+r.leading);return r.dropShadow&&(g+=r.dropShadow.distance),new K(e,r,m,g,u,h,A+r.leading,d,a)}static _measureText(e,r,n){let s=!1;K.experimentalLetterSpacingSupported&&(K.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,s=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const i=n.measureText(e);let o=i.width;const a=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-a;if(o>0)if(s)o-=r,c-=r;else{const u=(K.graphemeSegmenter(e).length-1)*r;o+=u,c+=u}return Math.max(o,c)}static _wordWrap(e,r,n=K._canvas){const s=n.getContext("2d",Qc);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=K._collapseSpaces(u),d=K._collapseNewlines(u);let f=!h;const m=r.wordWrapWidth+c,A=K._tokenize(e);for(let g=0;g<A.length;g++){let y=A[g];if(K._isNewline(y)){if(!d){a+=K._addLine(o),f=!h,o="",i=0;continue}y=" "}if(h){const x=K.isBreakingSpace(y),q=K.isBreakingSpace(o[o.length-1]);if(x&&q)continue}const b=K._getFromCache(y,c,l,s);if(b>m)if(o!==""&&(a+=K._addLine(o),o="",i=0),K.canBreakWords(y,r.breakWords)){const x=K.wordWrapSplit(y);for(let q=0;q<x.length;q++){let V=x[q],_=V,v=1;for(;x[q+v];){const E=x[q+v];if(!K.canBreakChars(_,E,y,q,r.breakWords))V+=E;else break;_=E,v++}q+=v-1;const S=K._getFromCache(V,c,l,s);S+i>m&&(a+=K._addLine(o),f=!1,o="",i=0),o+=V,i+=S}}else{o.length>0&&(a+=K._addLine(o),o="",i=0);const x=g===A.length-1;a+=K._addLine(y,!x),f=!1,o="",i=0}else b+i>m&&(f=!1,a+=K._addLine(o),o="",i=0),(o.length>0||!K.isBreakingSpace(y)||f)&&(o+=y,i+=b)}return a+=K._addLine(o,!1),a}static _addLine(e,r=!0){return e=K._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,n,s){let i=n[e];return typeof i!="number"&&(i=K._measureText(e,r,s)+r,n[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!K.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:K._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:K._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let s=0;s<e.length;s++){const i=e[s],o=e[s+1];if(K.isBreakingSpace(i,o)||K._isNewline(i)){n!==""&&(r.push(n),n=""),r.push(i);continue}n+=i}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,s,i){return!0}static wordWrapSplit(e){return K.graphemeSegmenter(e)}static measureFont(e){if(K._fonts[e])return K._fonts[e];const r=K._context;r.font=e;const n=r.measureText(K.METRICS_STRING+K.BASELINE_SYMBOL),s={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return K._fonts[e]=s,s}static clearMetrics(e=""){e?delete K._fonts[e]:K._fonts={}}static get _canvas(){if(!K.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Qc)?.measureText)return K.__canvas=r,r;e=Ye.get().createCanvas()}catch{e=Ye.get().createCanvas()}e.width=e.height=10,K.__canvas=e}return K.__canvas}static get _context(){return K.__context||(K.__context=K._canvas.getContext("2d",Qc)),K.__context}};ar.METRICS_STRING="|q";ar.BASELINE_SYMBOL="M";ar.BASELINE_MULTIPLIER=1.4;ar.HEIGHT_MULTIPLIER=2;ar.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();ar.experimentalLetterSpacing=!1;ar._fonts={};ar._newlines=[10,13];ar._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ar._measurementCache={};let hA=ar;const dA=1e5;function fA(t,e,r,n=0){if(t.texture===me.WHITE&&!t.fill)return lt.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof tl){const s=t.fill,i=e.createPattern(s.texture.source.resource,"repeat"),o=s.transform.copyTo(ge.shared);return o.scale(s.texture.frame.width,s.texture.frame.height),i.setTransform(o),i}else if(t.fill instanceof Wr){const s=t.fill,i=s.type==="linear",o=s.textureSpace==="local";let a=1,l=1;o&&r&&(a=r.width+n,l=r.height+n);let c,u=!1;if(i){const{start:h,end:d}=s;c=e.createLinearGradient(h.x*a,h.y*l,d.x*a,d.y*l),u=Math.abs(d.x-h.x)<Math.abs((d.y-h.y)*.1)}else{const{center:h,innerRadius:d,outerCenter:f,outerRadius:m}=s;c=e.createRadialGradient(h.x*a,h.y*l,d*a,f.x*a,f.y*l,m*a)}if(u&&o&&r){const h=r.lineHeight/l;for(let d=0;d<r.lines.length;d++){const f=(d*r.lineHeight+n/2)/l;s.colorStops.forEach(m=>{const A=f+m.offset*h;c.addColorStop(Math.floor(A*dA)/dA,lt.shared.setValue(m.color).toHex())})}}else s.colorStops.forEach(h=>{c.addColorStop(h.offset,lt.shared.setValue(h.color).toHex())});return c}}else{const s=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(ge.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),s.setTransform(i),s}return ke("FillStyle not recognised",t),"red"}function Wq(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const s=t[r];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(s[0].length===0||s[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(s))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Gq=class Qq extends Sq{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...Qq.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const n=r.style.clone();r.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=me.WHITE,n._fill.fill=null),this.applyFillAsTint=r.overrideFill;const s=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const i=yh(n);r.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/s):n.fontSize=this.baseRenderedFontSize=s,this._style=n,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=hA.measureFont(i),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(e){const r=Wq(e).filter(g=>!this._currentChars.includes(g)).filter((g,y,b)=>b.indexOf(g)===y);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let n;this._currentPageIndex===-1?n=this._nextPage():n=this.pages[this._currentPageIndex];let{canvas:s,context:i}=n.canvasAndContext,o=n.texture.source;const a=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let d=0,f=!1;const m=s.width/this.resolution,A=s.height/this.resolution;for(let g=0;g<r.length;g++){const y=r[g],b=hA.measureText(y,a,s,!1);b.lineHeight=b.height;const x=b.width*u,q=Math.ceil((a.fontStyle==="italic"?2:1)*x),V=b.height*u,_=q+h*2,v=V+h*2;if(f=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(f=!0,d=Math.ceil(Math.max(v,d))),l+_>m&&(c+=d,d=v,l=0,c+d>A)){o.update();const E=this._nextPage();s=E.canvasAndContext.canvas,i=E.canvasAndContext.context,o=E.texture.source,c=0}const S=x/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:S,kerning:{}},f){this._drawGlyph(i,b,l+h,c+h,u,a);const E=o.width*u,R=o.height*u,I=new Fe(l/E*o.width,c/R*o.height,_/E*o.width,v/R*o.height);this.chars[y].texture=new me({source:o,frame:I}),l+=Math.ceil(_)}}o.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return Ie(dt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const n=this._measureCache;for(let s=0;s<e.length;s++){const i=e[s];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=n[i];l||(l=n[i]=r.measureText(i).width);let c=n[a];c||(c=n[a]=r.measureText(a).width);let u=r.measureText(i+a).width,h=u-(l+c);h&&(this.chars[i].kerning[a]=h),u=r.measureText(i+a).width,h=u-(l+c),h&&(this.chars[a].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=uA.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const n=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),s=new me({source:new En({resource:r.canvas,resolution:n,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:s};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,n){r.fontSize=this.baseRenderedFontSize,e.scale(n,n),e.font=yh(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const s=r._stroke,i=s?.width??0;if(s&&(e.lineWidth=i,e.lineJoin=s.join,e.miterLimit=s.miterLimit,e.strokeStyle=fA(s,e)),r._fill&&(e.fillStyle=fA(r._fill,e)),r.dropShadow){const o=r.dropShadow,a=lt.shared.setValue(o.color).toArray(),l=o.blur*n,c=o.distance*n;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*c,e.shadowOffsetY=Math.sin(o.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,n,s,i,o){const a=r.text,l=r.fontProperties,u=(o._stroke?.width??0)*i,h=n+u/2,d=s-u/2,f=l.descent*i,m=r.lineHeight*i;o.stroke&&u&&e.strokeText(a,h,d+m-f),o._fill&&e.fillText(a,h,d+m-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:n}=this.pages[e];uA.returnCanvasAndContext(r),n.destroy(!0)}this.pages=null}};Gq.defaultOptions={textureSize:512,style:new Mi,mipmap:!0};let pA=Gq;function HM(t,e,r,n){const s={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=r.baseLineOffset;let i=s.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=m=>{const A=i.width;for(let g=0;g<l.index;g++){const y=m.positions[g];i.chars.push(m.chars[g]),i.charPositions.push(y+A)}i.width+=m.width,a=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let m=i.chars.length-1;if(n){let A=i.chars[m];for(;A===" ";)i.width-=r.chars[A].xAdvance,A=i.chars[--m]}s.width=Math.max(s.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,s.lines.push(i),s.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let m=0;m<t.length+1;m++){let A;const g=m===t.length;g||(A=t[m]);const y=r.chars[A]||r.chars[" "];if(/(?:\s)/.test(A)||A==="\r"||A===`
`||g){if(!a&&e.wordWrap&&i.width+l.width-d>f?(u(),c(l),g||i.charPositions.push(0)):(l.start=i.width,c(l),g||i.charPositions.push(0)),A==="\r"||A===`
`)i.width!==0&&u();else if(!g){const V=y.xAdvance+(y.kerning[o]||0)+d;i.width+=V,i.spaceWidth=V,i.spacesIndex.push(i.charPositions.length),i.chars.push(A)}}else{const q=y.kerning[o]||0,V=y.xAdvance+q+d;l.positions[l.index++]=l.width+q,l.chars.push(A),l.width+=V}o=A}return u(),e.align==="center"?$M(s):e.align==="right"?WM(s):e.align==="justify"&&GM(s),s}function $M(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],n=t.width/2-r.width/2;for(let s=0;s<r.charPositions.length;s++)r.charPositions[s]+=n}}function WM(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],n=t.width-r.width;for(let s=0;s<r.charPositions.length;s++)r.charPositions[s]+=n}}function GM(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const n=t.lines[r];let s=0,i=n.spacesIndex[s++],o=0;const a=n.spacesIndex.length,c=(e-n.width)/a;for(let u=0;u<n.charPositions.length;u++)u===i&&(i=n.spacesIndex[s++],o+=c),n.charPositions[u]+=o}}let $o=0;class QM{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let n=`${r.fontFamily}-bitmap`,s=!0;if(r._fill.fill&&!r._stroke)n+=r._fill.fill.styleKey,s=!1;else if(r._stroke||r.dropShadow){let o=r.styleKey;o=o.substring(0,o.lastIndexOf("-")),n=`${o}-bitmap`,s=!1}if(!Te.has(n)){const o=new pA({style:r,overrideFill:s,overrideSize:!0,...this.defaultOptions});$o++,$o>50&&ke("BitmapText",`You have dynamically created ${$o} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{$o--,Te.remove(n)}),Te.set(n,o)}const i=Te.get(n);return i.ensureCharacters?.(e),i}getLayout(e,r,n=!0){const s=this.getFont(e,r);return HM([...e],r,s,n)}measureText(e,r,n=!0){return this.getLayout(e,r,n)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},Ie(dt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=r?.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const s=r.style,i=s instanceof Mi?s:new Mi(s),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new pA({style:i,overrideFill:o,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=Wq(r.chars);return a.ensureCharacters(l.join("")),Te.set(`${n}-bitmap`,a),a.once("destroy",()=>Te.remove(`${n}-bitmap`)),a}uninstall(e){const r=`${e}-bitmap`,n=Te.get(r);n&&n.destroy()}}const mA=new QM;class Yq extends Sq{constructor(e,r){super();const{textures:n,data:s}=e;Object.keys(s.pages).forEach(i=>{const o=s.pages[parseInt(i,10)],a=n[o.id];this.pages.push({texture:a})}),Object.keys(s.chars).forEach(i=>{const o=s.chars[i],{frame:a,source:l}=n[o.page],c=new Fe(o.x+a.x,o.y+a.y,o.width,o.height),u=new me({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:u}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){mA.install(e)}static uninstall(e){mA.uninstall(e)}}const Yc={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const A in f){const g=f[A].split("="),y=g[0],b=g[1].replace(/"/gm,""),x=parseFloat(b),q=isNaN(x)?b:x;m[y]=q}r[d].push(m)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=r.info,[i]=r.common,[o]=r.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(s.size,10),n.fontFamily=s.face,n.lineHeight=parseInt(i.lineHeight,10);const a=r.page;for(let h=0;h<a.length;h++)n.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let m=d.letter??d.char??String.fromCharCode(f);m==="space"&&(m=" "),l[f]=m,n.chars[m]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),m=parseInt(u[h].amount,10);n.chars[l[f]].kerning[l[d]]=m}return n}},gA={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],n=t.getElementsByTagName("common")[0],s=t.getElementsByTagName("distanceField")[0];s&&(e.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(n.getAttribute("base"),10);for(let c=0;c<o.length;c++){const u=o[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const u=parseInt(a[c].getAttribute("first"),10),h=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},AA={test(t){return typeof t=="string"&&t.includes("<font>")?gA.test(Ye.get().parseXML(t)):!1},parse(t){return gA.parse(Ye.get().parseXML(t))}},YM=[".xml",".fnt"],KM={extension:{type:te.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof Yq,getCacheableAssets(t,e){const r={};return t.forEach(n=>{r[n]=e,r[`${n}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},XM={extension:{type:te.LoadParser,priority:en.Normal},name:"loadBitmapFont",test(t){return YM.includes(Dt.extname(t).toLowerCase())},async testParse(t){return Yc.test(t)||AA.test(t)},async parse(t,e,r){const n=Yc.test(t)?Yc.parse(t):AA.parse(t),{src:s}=e,{pages:i}=n,o=[],a=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const d=i[h].file;let f=Dt.join(Dt.dirname(s),d);f=ch(f,s),o.push({src:f,data:a})}const l=await r.load(o),c=o.map(h=>l[h.src]);return new Yq({data:n,textures:c},s)},async load(t,e){return await(await Ye.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(n=>r.unload(n.texture.source._sourceOrigin))),t.destroy()}};class JM{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const ZM={extension:{type:te.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof me),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((s,i)=>{r[n+(i===0?"":i+1)]=s})}),r}};async function Kq(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const eI={extension:{type:te.DetectionParser,priority:1},test:async()=>Kq("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},yA=["png","jpg","jpeg"],tI={extension:{type:te.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...yA],remove:async t=>t.filter(e=>!yA.includes(e))},rI="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Gd(t){return rI?!1:document.createElement("video").canPlayType(t)!==""}const nI={extension:{type:te.DetectionParser,priority:0},test:async()=>Gd("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},sI={extension:{type:te.DetectionParser,priority:0},test:async()=>Gd("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},iI={extension:{type:te.DetectionParser,priority:0},test:async()=>Gd("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},oI={extension:{type:te.DetectionParser,priority:0},test:async()=>Kq("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class aI{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{let s=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||ke(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,r,this)){i=a;break}}if(!i)return ke(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await i.load(e,r,this),n.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(s,r,this)&&(s=await a.parse(s,r,this)||s,n.parser=a)}return s})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const s={},i=Ta(e),o=rr(e,c=>({alias:[c],src:c,data:{}})),a=o.length,l=o.map(async c=>{const u=Dt.toAbsolute(c.src);if(!s[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),s[c.src]=await this.promiseCache[u].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[u],delete s[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?s[o[0].src]:s}async unload(e){const n=rr(e,s=>({alias:[s],src:s})).map(async s=>{const i=Dt.toAbsolute(s.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,s,this)}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&ke(`[Assets] loadParser name conflict "${r.name}"`):ke("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function Is(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function js(t,e){const r=t.split("?")[0],n=Dt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const lI=".json",cI="application/json",uI={extension:{type:te.LoadParser,priority:en.Low},name:"loadJson",test(t){return Is(t,cI)||js(t,lI)},async load(t){return await(await Ye.get().fetch(t)).json()}},hI=".txt",dI="text/plain",fI={name:"loadTxt",extension:{type:te.LoadParser,priority:en.Low,name:"loadTxt"},test(t){return Is(t,dI)||js(t,hI)},async load(t){return await(await Ye.get().fetch(t)).text()}},pI=["normal","bold","100","200","300","400","500","600","700","800","900"],mI=[".ttf",".otf",".woff",".woff2"],gI=["font/ttf","font/otf","font/woff","font/woff2"],AI=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function yI(t){const e=Dt.extname(t),s=Dt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=s.length>0;for(const a of s)if(!a.match(AI)){i=!1;break}let o=s.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const xI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function bI(t){return xI.test(t)?t:encodeURI(t)}const qI={extension:{type:te.LoadParser,priority:en.Low},name:"loadWebFont",test(t){return Is(t,gI)||js(t,mI)},async load(t,e){const r=Ye.get().getFontFaceSet();if(r){const n=[],s=e.data?.family??yI(t),i=e.data?.weights?.filter(a=>pI.includes(a))??["normal"],o=e.data??{};for(let a=0;a<i.length;a++){const l=i[a],c=new FontFace(s,`url(${bI(t)})`,{...o,weight:l});await c.load(),r.add(c),n.push(c)}return Te.set(`${s}-and-url`,{url:t,fontFaces:n}),n.length===1?n[0]:n}return ke("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{Te.remove(`${e.family}-and-url`),Ye.get().getFontFaceSet().delete(e)})}};function Qd(t,e=1){const r=Ms.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function Yd(t,e,r){t.label=r,t._sourceOrigin=r;const n=new me({source:t,label:r}),s=()=>{delete e.promiseCache[r],Te.has(r)&&Te.remove(r)};return n.source.once("destroy",()=>{e.promiseCache[r]&&(ke("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),n.once("destroy",()=>{t.destroyed||(ke("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),n}const wI=".svg",vI="image/svg+xml",VI={extension:{type:te.LoadParser,priority:en.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return Is(t,vI)||js(t,wI)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?SI(t):_I(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function _I(t,e,r,n){const i=await(await Ye.get().fetch(t)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=n,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||Qd(t),h=e.data?.width??a.width,d=e.data?.height??a.height;l.width=h*u,l.height=d*u,c.drawImage(a,0,0,h*u,d*u);const{parseAsGraphicsContext:f,...m}=e.data??{},A=new En({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...m});return Yd(A,r,t)}async function SI(t){const r=await(await Ye.get().fetch(t)).text(),n=new mn;return n.svg(r),n}const kI=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let us=null,xh=class{constructor(){us||(us=URL.createObjectURL(new Blob([kI],{type:"application/javascript"}))),this.worker=new Worker(us)}};xh.revokeObjectURL=function(){us&&(URL.revokeObjectURL(us),us=null)};const CI=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let hs=null;class Xq{constructor(){hs||(hs=URL.createObjectURL(new Blob([CI],{type:"application/javascript"}))),this.worker=new Worker(hs)}}Xq.revokeObjectURL=function(){hs&&(URL.revokeObjectURL(hs),hs=null)};let xA=0,Kc;class PI{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new xh;r.addEventListener("message",n=>{r.terminate(),xh.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Kc===void 0&&(Kc=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Kc&&(this._createdWorkers++,e=new Xq().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((s,i)=>{this._queue.push({id:e,arguments:r,resolve:s,reject:i})});return this._next(),n}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),n=r.id;this._resolveHash[xA]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:xA++,id:n})}}const bA=new PI,EI=[".jpeg",".jpg",".png",".webp",".avif"],TI=["image/jpeg","image/png","image/webp","image/avif"];async function RI(t,e){const r=await Ye.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const n=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}const Jq={name:"loadTextures",extension:{type:te.LoadParser,priority:en.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Is(t,TI)||js(t,EI)},async load(t,e,r){let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await bA.isImageBitmapSupported()?n=await bA.loadImageBitmap(t,e):n=await RI(t,e):n=await new Promise((i,o)=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=t,n.complete?i(n):(n.onload=()=>{i(n)},n.onerror=o)});const s=new En({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||Qd(t),...e.data});return Yd(s,r,t)},unload(t){t.destroy(!0)}},Zq=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],MI=Zq.map(t=>`video/${t.substring(1)}`);function II(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=OI(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function jI(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",n),t.addEventListener("error",s),t.load();function n(){i(),e()}function s(o){i(),r(o)}function i(){t.removeEventListener("canplaythrough",n),t.removeEventListener("error",s)}})}function OI(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const BI={name:"loadVideo",extension:{type:te.LoadParser,name:"loadVideo"},test(t){const e=Is(t,MI),r=js(t,Zq);return e||r},async load(t,e,r){const n={...ia.defaultOptions,resolution:e.data?.resolution||Qd(t),alphaMode:e.data?.alphaMode||await fq(),...e.data},s=document.createElement("video"),i={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&s.setAttribute(l,c)}),n.muted===!0&&(s.muted=!0),II(s,t,n.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=ia.MIME_TYPES[l]||`video/${l}`}return o.src=t,a&&(o.type=a),new Promise(l=>{const c=async()=>{const u=new ia({...n,resource:s});s.removeEventListener("canplay",c),e.data.preload&&await jI(s),l(Yd(u,r,t))};s.addEventListener("canplay",c),s.appendChild(o)})},unload(t){t.destroy(!0)}},ew={extension:{type:te.ResolveParser,name:"resolveTexture"},test:Jq.test,parse:t=>({resolution:parseFloat(Ms.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},zI={extension:{type:te.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Ms.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:ew.parse};class NI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ms,this.loader=new aI,this.cache=Te,this._backgroundLoader=new JM(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){ke("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,n=typeof r=="number"?[r]:r,s=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const n=Ta(e),s=rr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(s),o=await this._mapLoadToResolve(i,r);return n?o[s[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const s=this.resolver.resolveBundle(e),i={},o=Object.keys(s);let a=0,l=0;const c=()=>{r?.(++a/l)},u=o.map(h=>{const d=s[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{i[h]=f})});return await Promise.all(u),n?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Te.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=Te.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const i={};return n.forEach(o=>{const a=s[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(c=>{i[c]=a}),Te.set(l,a)}),i}async unload(e){this._initialized||await this.init();const r=rr(e).map(s=>typeof s!="string"?s.src:s),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=rr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(s=>this._unloadFromResolved(r[s]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{Te.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,s)=>r.indexOf(n)===s),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const ai=new NI;kt.handleByList(te.LoadParser,ai.loader.parsers).handleByList(te.ResolveParser,ai.resolver.parsers).handleByList(te.CacheParser,ai.cache.parsers).handleByList(te.DetectionParser,ai.detections);kt.add(ZM,tI,eI,oI,nI,sI,iI,uI,fI,qI,VI,Jq,BI,XM,KM,ew,zI);const qA={loader:te.LoadParser,resolver:te.ResolveParser,cache:te.CacheParser,detection:te.DetectionParser};kt.handle(te.Asset,t=>{const e=t.ref;Object.entries(qA).filter(([r])=>!!e[r]).forEach(([r,n])=>kt.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(qA).filter(r=>!!e[r]).forEach(r=>kt.remove(e[r]))});kt.add(bE,qE);const Xc={x:1,y:0,z:0},Jc={x:-1,y:0,z:0},Zc={x:0,y:-1,z:0},eu={x:0,y:1,z:0},qe={away:eu,left:Xc,right:Jc,towards:Zc,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:bn(ee(eu,Jc)),towardsRight:bn(ee(Zc,Jc)),towardsLeft:bn(ee(Zc,Xc)),awayLeft:bn(ee(eu,Xc))},DI=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),FI=Math.cos(13*(Math.PI/180)),wA=-Math.PI/4,tw=t=>{const e=Math.cos(wA),r=Math.sin(wA);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};bn({x:1,y:2,z:0});bn({x:-1,y:2,z:0});const LI=t=>{const e=eV(t);return e===void 0?fe:qe[e]},UI=t=>{const e=Uh(t);return e===void 0?fe:qe[e]},HI=(t,e=FI)=>{const{x:r,y:n}=t,s=Math.sqrt(r*r+n*n);if(s===0)return fe;const i=r/s,o=n/s,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(r)*s,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(n)*s,z:0};return t},$I={"4-way":LI,"8-way":UI,analogue:HI},WI=.2,GI=45,QI=(t,e)=>!!t.keyboardState.has(e),rw=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},bh=.5,nw=(t,e,r)=>{for(const n of t.gamepads)if(!(n===null||n.axes.length<=e)){if(r===void 0){if(Math.abs(n.axes[e])>bh)return!0}else if(n.axes[e]*r>bh)return!0}return!1},Wo=(t,e,r=!0)=>{const n=_a(be.getState()),s=n.presses[e];if(t.hudInputState[e])return!0;for(const i of s.keys)if(QI(t,i))return!0;for(const i of s.gamepadButtons)if(rw(t,i))return!0;if(r){const i=Fb(e);if(i!==void 0){const o=n.axes[i.axis];for(const a of o)if(nw(t,a,i.direction))return!0}}return!1};class YI{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=fe;actionsHandled=new Set;#n=()=>{let e,r,n,s;switch("tap"){case(e=this.currentActionPress("left")):return qe.left;case(r=this.currentActionPress("right")):return qe.right;case(n=this.currentActionPress("away")):return qe.away;case(s=this.currentActionPress("towards")):return qe.towards}const i=(e!=="released"?1:0)+(r!=="released"?1:0)+(n!=="released"?1:0)+(s!=="released"?1:0);if(i>1)return this.#t;if(i===1)switch("hold"){case e:return qe.left;case r:return qe.right;case n:return qe.away;case s:return qe.towards}return fe};#s(){const e=this.#e.at(0);if(e===void 0)return fe;function*r(o){for(const a of Hi)Wo(o,a,!1)&&(yield qe[a])}function*n(o){const{axes:{x:a,y:l}}=_a(be.getState());for(const c of o.gamepads){if(c===null)continue;let u=0,h=0;for(const f of a)c.axes.length<=f||(u-=c.axes[f]);for(const f of l)c.axes.length<=f||(h-=c.axes[f]);const d={x:u,y:h,z:0};$i(d)>WI&&(yield d)}}let s=[...r(e)],i;if(s.length===1){const[o]=s,a=[...je(this.#e).drop(1).map(l=>[...r(l)])];e:for(const l of a){if(l.length>2)break e;if(l.length===2&&l.some(c=>Lh(c,o))){const c=l.find(u=>da(u,o)<.001);if(c!==void 0){i=c;break e}}}if(!i)for(const l of a)l.length===0&&(s=Mb)}return ee(i??fe,...s,...n(e))}#r=({lastTime:e})=>{const r=vd(be.getState()),i=zC(be.getState())&&r?tw:h=>h,o=$I[r](ee(i(r==="4-way"?this.#n():this.#s()),this.hudInputState.directionVector)),a=Hy(o);this.#t={...a>1?Fh(o,1/a):o,z:0};const l={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:DI(navigator.getGamepads()),atTime:e};this.#e.unshift(l);const c=e-GI,u=this.#e.findIndex(h=>h.atTime<c);u!==-1&&this.#e.splice(u+1);for(const h of this.actionsHandled)Wo(l,h)||this.actionsHandled.delete(h)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const n=Wo(r,e);if(this.actionsHandled.has(e))return"released";if(n){const s=this.#e.at(1);return(s===void 0?!1:Wo(s,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const n of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(n))return{type:"key",input:n};for(const n of e.gamepads)if(n!==null){for(const[s,i]of n.buttons.entries())if(i.pressed&&(r===void 0||!rw(r,s)))return{type:"gamepadButtons",input:s};for(const[s,i]of n.axes.entries())if(Math.abs(i)>bh&&(r===void 0||!nw(r,s)))return{type:"gamepadAxes",input:s}}}}get directionVector(){return this.#t}startTicking(){_t.shared.add(this.#r,void 0,Ea.INTERACTION)}stopTicking(){_t.shared.remove(this.#r)}}const KI=()=>({directionVector:fe,...ks(mx.map(t=>[t,!1]))}),sw=C.createContext(null),XI=({children:t})=>{const[e]=C.useState(yE),[r]=C.useState(()=>new YI(e,KI()));return C.useEffect(()=>{const n=xE(e);return r.startTicking(),()=>{n(),r.stopTicking()}},[r,e]),p.jsx(sw,{value:r,children:t})},Kd=()=>{const t=C.useContext(sw);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},At=({handler:t,action:e,disabled:r=!1})=>{const n=C.useMemo(()=>Array.isArray(e)?e:[e],[e]),s=Kd();C.useEffect(()=>{if(r)return;const i=()=>{for(const o of n)if(s.currentActionPress(o)==="tap"){if(!t(o))for(const c of n)s.actionsHandled.add(c);break}};return _t.shared.add(i),()=>{_t.shared.remove(i)}},[n,r,s,t])},JI=({handler:t,disabled:e=!1})=>{const r=Kd();C.useEffect(()=>{if(e)return;const n=()=>{const s=r.inputTap();s!==void 0&&t(s,r)};return _t.shared.add(n),()=>{_t.shared.remove(n)}},[e,t,r])};function $(t,e){const r=Xh();return C.useCallback(()=>{r(t(e))},[t,r,e])}const ZI=()=>{const t=ae(r=>r.gameMenus.assigningInput!==void 0),e=ae(r=>r.gameMenus.openMenus.length>0);At({action:"menu_openOrExit",handler:C.useCallback(()=>{Rd()&&window.close(),be.dispatch(ig())},[]),disabled:t}),At({action:"menu_exit",handler:$(ig),disabled:!e}),At({action:"toggleShowFps",handler:$(tr,"userSettings.showFps"),disabled:e}),At({action:"hold",handler:$(zb,"toggle"),disabled:t}),At({action:"map",handler:$($P),disabled:t}),C.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),At({action:"toggleColourisation",handler:$(tr,"userSettings.displaySettings.uncolourised"),disabled:t}),At({action:"cycleResolution",handler:$(Md,void 0),disabled:t})},vA=(t,e)=>{be.dispatch(zx(ud(Ja(be.getState()),e)))},ej=(t,e)=>{const r=Xh();C.useLayoutEffect(()=>{vA()},[]),C.useLayoutEffect(()=>{const n=()=>vA(t,e);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r,e,t])},tj=()=>(ej(),ZI(),dE(),null),rj=t=>{const{queries:e}=t[Cn.reducerPath],{mutations:r}=t[Cn.reducerPath],n=Object.values(e??{}).some(o=>o?.status==="pending"),s=Object.values(r??{}).some(o=>o?.status==="pending"),i=ZP(t)>0;return n||s||i},iw=Ab(rj),He=({className:t,onClick:e})=>iw()?p.jsx(wv,{}):p.jsx("div",{className:`fixed inset-0 z-border ${t??""}`,onClick:e}),nj=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bags icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,sj=`## BLACKTOOTH

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,ij=`## BOOK WORLD

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,oj=`## CONVEYOR BELTS

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,aj=`## CREDITS

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
1987 Ocean Software Limited.

### Remake

Remake by Jim Higson
Playtesting, ideas, map design, and general support by my brother, Tom Higson
Playtesting, moral support, and `,lj=`## CROWNS

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,cj=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
if you pick them up while head and heels are joined, they get *two each*

## Iron pills ![](texture-hud_shield?sprite-tinted&text-metallicBlue&sprites-normal-height)

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud_bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height) Jump higher bunny 

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud_fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height) Go faster bunny 
![](texture-animated-head_idle_right?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,uj=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so dont waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,hj=`## EGYPTUS

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,dj=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,fj=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heelss evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,pj=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_walking_towards_2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelss bag and Heads hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the others back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Heads jumps and Heelss jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you cant understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,mj=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown_blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_walking_right_2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,gj=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,Aj=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Heads race, they disappear and wont return until they are sure the coast is
clear.

> Head Over Heels Manual
`,yj=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,xj=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,bj=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* To the right of the address bar, click the **install icon: **
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock **
* **Head over heels** is now installed on your mac
* If you dont want to keep the game in the Dock, right-click the doc icon and uncheck **Options  keep in doc**. It is still available in Applications

`,qj=`## Supported platforms

Almost anything with an up-to-date browser can play

Heres some Ive tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,wj=`## SAFARI

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,vj=`## SPRINGS

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,Vj=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Head Over Heels Manual, revised for remake
`,_j=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,Sj=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minions back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyll never get this far!

*> Your humble minion*
`,kj=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,Cj=`## THE EMPERORS GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,Pj=`## THE GAME

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain keep fit equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,we=Object.assign({"./bag.md":nj,"./blacktooth.md":sj,"./bookWorld.md":ij,"./conveyorBelts.md":oj,"./credits.md":aj,"./crowns.md":lj,"./cuddlyStuffedWhiteRabbits.md":cj,"./doughnuts.md":uj,"./egyptus.md":hj,"./head.md":dj,"./heels.md":fj,"./hintsAndTips.md":pj,"./historyOfTheBlacktoothEmpire.md":mj,"./hooter.md":gj,"./hushPuppies.md":Aj,"./penitentiary.md":yj,"./reincarnationFish.md":xj,"./remake/installGuide.md":bj,"./remake/supportedPlatforms.md":qj,"./safari.md":wj,"./springs.md":vj,"./switches.md":Vj,"./swopKey.md":_j,"./teleportBack.md":Sj,"./teleports.md":kj,"./theEmperorsGuardian.md":Cj,"./theGame.md":Pj}),Xd={historyOfTheBlacktoothEmpire:we["./historyOfTheBlacktoothEmpire.md"],theGame:we["./theGame.md"],egyptus:we["./egyptus.md"],penitentiary:we["./penitentiary.md"],safari:we["./safari.md"],bookWorld:we["./bookWorld.md"],blacktooth:we["./blacktooth.md"],head:we["./head.md"],heels:we["./heels.md"],reincarnationFish:we["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:we["./cuddlyStuffedWhiteRabbits.md"],hooter:we["./hooter.md"],doughnuts:we["./doughnuts.md"],bag:we["./bag.md"],crowns:we["./crowns.md"],teleports:we["./teleports.md"],springs:we["./springs.md"],switches:we["./switches.md"],conveyorBelts:we["./conveyorBelts.md"],hushPuppies:we["./hushPuppies.md"],theEmperorsGuardian:we["./theEmperorsGuardian.md"],swopKey:we["./swopKey.md"],hintsAndTips:we["./hintsAndTips.md"],credits:we["./credits.md"],installGuide:we["./remake/installGuide.md"]},Ej={...Xd,teleportBack:we["./teleportBack.md"]},Tj=/^##\s+(.*)$/m,Rj=t=>{const e=t.match(Tj);if(e===null)return"no title found";const[,r]=e;return r};function kL(t){if(!qh(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(er.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function qh(t){return er.frames[t]!==void 0}function CL(t){return er.animations[t]!==void 0}let xi;const Mj=async()=>{if(xi!==void 0)return xi;let t;try{t=await ai.load(cx)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=me.EMPTY}const e=new uh(t,er);return await e.parse(),e.textureSource.scaleMode="nearest",xi=e,e},Ij=()=>{if(xi===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return xi},jj=({className:t,children:e})=>t?p.jsx("div",{className:`contents ${t}`,children:e}):e,Oj=t=>t.replaceAll(/(?<!\.)\./g,"_"),H=({children:t,className:e,noSlitWords:r,classnameCycle:n,onClick:s,noTint:i=!1,TagName:o="span"})=>{const a=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(a.length===0)return null;const l=r?[a.toUpperCase()]:a.toUpperCase().split(/\s+/);return p.jsxs(o,{className:e,onClick:s,children:[p.jsx("span",{className:"sr-only",children:a}),l.map((c,u)=>p.jsx("span",{className:et("text-nowrap inline-block",u===l.length-1?"":"me-1"),children:Array.from(c).map((h,d)=>{const f=`hud.char.${ox(h)}`;return qh(f)||console.error("no texture for char",h,h.charCodeAt(0),f,"we have:",Object.keys(Ij().textures)),p.jsx("span",{className:`sprite ${qh(f)?`texture-${Oj(f)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${n===void 0?"":n[d%n.length]}`},d)})},u))]})},Bj=t=>t.props.children!==void 0,gt=({children:t,className:e})=>p.jsx(jj,{className:e,children:Array.isArray(t)?t.map((r,n)=>p.jsx(gt,{children:r},n)):typeof t=="number"?p.jsx(H,{children:String(t)}):typeof t=="string"?p.jsx(H,{children:t}):C.isValidElement(t)?t.type===H||t.type===gt?t:Bj(t)?C.cloneElement(t,void 0,typeof t.props.children=="string"?p.jsx(H,{children:`${t.props.children}`}):p.jsx(gt,{children:t.props.children})):t:t}),zj=({flip:t=!1,focussed:e=!1})=>p.jsx(H,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":""),children:e?"":""});var Wt={},Kn={},Xn={},VA;function nl(){if(VA)return Xn;VA=1;var t=Xn&&Xn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xn,"__esModule",{value:!0});const r=t(_s()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return Xn.default=r,Xn}var _A;function Nj(){if(_A)return Kn;_A=1;var t=Kn&&Kn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Kn,"__esModule",{value:!0});const e=t(_s()),r=t(Ry()),n=t(nl()),s=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(n.default),c=a[i],u=l[i];return c?u?r.default.createPortal(u(o),c,i):r.default.createPortal(o,c,i):null};return Kn.default=s,Kn}var Jn={},SA;function Dj(){if(SA)return Jn;SA=1;var t=Jn&&Jn.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Jn,"__esModule",{value:!0});const e=t(_s()),r=t(nl()),n=({id:s,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(s,c.current,i),()=>l(s)),[s,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${s}`,o].filter(u=>!!u).join(" "),ref:c})};return Jn.default=n,Jn}var jr={},kA;function Fj(){if(kA)return jr;kA=1;var t=jr&&jr.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=jr&&jr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(jr,"__esModule",{value:!0});const r=e(_s()),n=e(nl()),s=({children:i})=>{const[o,a]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((f,m,A)=>{a(g=>Object.assign(Object.assign({},g),{[f]:m})),c(g=>Object.assign(Object.assign({},g),{[f]:A}))},[]),h=r.default.useCallback(f=>{a(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])}),c(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])})},[]),d=r.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return r.default.createElement(n.default.Provider,{value:d},i)};return jr.default=s,jr}var CA;function Lj(){if(CA)return Wt;CA=1;var t=Wt&&Wt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Context=Wt.Placeholder=Wt.Provider=void 0;const e=t(Nj()),r=t(Dj()),n=t(Fj()),s=t(nl());Wt.Provider=n.default,Wt.Placeholder=r.default,Wt.Context=s.default;const i=e.default;return i.Context=s.default,i.Placeholder=r.default,i.Provider=n.default,Wt.default=i,Wt}var Uj=Lj();const tn=rt(Uj),Ve="leading-none [&_[class*='texture-hud']]:mb-oneScaledPix",Hj=["menu_select","swop","jump"],Ii="data-menuitem_id",ow="data-menuitem_hidden",aw="data-menuitem_disabled",$j=()=>{},Z=({id:t,label:e,valueElement:r,flipLeader:n=!1,doubleHeightWhenFocussed:s,onSelect:i=$j,hidden:o=!1,disabled:a=!1,hintInline:l=!1,className:c,hint:u,leader:h})=>{const d=C.useRef(!0),f=ae(g=>g.gameMenus.openMenus.at(0)?.scrollableSelection??!1),m=ae(g=>g.gameMenus.openMenus.at(0)?.focussedItemId===t);At({action:Hj,handler:i,disabled:!m||o||a});const A=p.jsxs("li",{[Ii]:t,[ow]:o,[aw]:a,tabIndex:0,className:et("contents",o?"hidden":"",s&&m?"sprites-double-height":"",m?"selectedMenuItem":"",c),onMouseMove:$(Id,{focussedItemId:t,scrollableSelection:!1}),onClick:a?void 0:i,children:[h||p.jsx(zj,{flip:n,focussed:m}),p.jsx("div",{ref:g=>{m&&f&&g?.scrollIntoView({behavior:d.current?"instant":"smooth",block:"center"}),d.current=!1},className:et(r===void 0?"col-span-2":""),children:typeof e=="string"?p.jsx(p.Fragment,{children:p.jsx(H,{children:e})}):e}),r!==void 0&&r,!m||u===void 0||l?null:p.jsx(tn,{children:typeof u=="string"?p.jsx(H,{className:Ve,children:u}):u})]});return l&&u?p.jsxs(p.Fragment,{children:[A,p.jsx("div",{className:"col-span-2 col-start-2 mb-2",children:u})]}):A},Et=({customLabel:t})=>p.jsx(Z,{id:"back",label:t||"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:$(Oe)}),Os=t=>p.jsx("div",{className:`col-span-3 h-1 ${t}`}),lw=()=>{const t=document.body.querySelectorAll(`[${Ii}]`);return Array.from(t)},PA=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=be.getState();if(e===void 0)return!0;const r=lw();if(r.length<=1)return!0;const n=r.findIndex(i=>i.getAttribute(Ii)===e);if(n===-1)return!0;let s=n;do s=(s+t+r.length)%r.length;while(r[s].getAttribute(ow)==="true"||r[s].getAttribute(aw)==="true");return be.dispatch(Id({focussedItemId:r[s].getAttribute(Ii),scrollableSelection:!0})),!1},Wj=t=>{const e=xb();At({action:"away",handler:C.useCallback(()=>{if(t.current!==null)return PA(-1)},[t]),disabled:e}),At({action:"towards",handler:C.useCallback(()=>{if(t.current!==null)return PA(1)},[t]),disabled:e})},Ce=({className:t="",children:e})=>{const r=C.useRef(null);return C.useEffect(()=>{if(r.current===null||be.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const n=lw();be.dispatch(Id({focussedItemId:n[0].getAttribute(Ii),scrollableSelection:!0}))},[]),Wj(r),p.jsx("menu",{ref:r,className:et("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})};var sl=Ry();const Gj=rt(sl),Be=({children:t})=>sl.createPortal(p.jsx(as,{children:t}),document.body),rn=({className:t})=>p.jsxs("div",{className:et("text-redShadow zx:text-zxMagenta sprites-double-height flex flex-row gap-1",t),children:[p.jsx(H,{className:"inline-block scale-[-1]",onClick:$(Oe),children:""}),p.jsx(H,{className:"inline-block",onClick:$(Oe),children:"Back"})]}),Qj=({pageName:t})=>{const e=Xd[t],r=Rj(e),n=St()==="desktop";return p.jsx(Z,{id:`markdown/${t}`,label:r,onSelect:$(yt,`markdown/${t}`),doubleHeightWhenFocussed:n})},Yj=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midGrey zx:bg-zxCyan",onClick:$(Oe)}),p.jsx(_e,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:p.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${Ve} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[Ue()&&p.jsx(rn,{className:"mb-1"}),p.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[p.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),p.jsx(H,{className:"sprites-double-height mx-1",children:"Read the manual"}),p.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),p.jsxs(Ce,{children:[[...je(Qh(Xd)).map(t=>p.jsx(Qj,{pageName:t},t))],p.jsx(Os,{}),Ue()||p.jsx(Et,{})]})]})})]}),Kj={"":C.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},EA=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),Xj=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),tu=t=>t.replace(/^\s+|\s+$/g," "),Xe=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),li=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,n=0;const s=Xe("");let i,o;e?(i=Xe("p"),o=[s,i],s.c.push(i)):(i=s,o=[s]);let a;const l=(h,d=!0)=>(d&&o.push(h),i.c.push(h),d&&(i=h),h),c=h=>{const d=o.findIndex(f=>f.t===h);o=o.slice(0,d),i=o.at(-1)};for(;a=r.exec(t);){const h=t.substring(n,a.index);if(n=r.lastIndex,h!=="")if(i===s&&e){const d=Xe("p",tu(h));s.c.push(d),o=[s,d],i=d}else i.c.push(tu(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const d=Xe("pre",a[4]?EA(a[4]):Xe("code",EA(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));s.c.push(d),o=[s],i=s}else if(a[6]){const d=a[6],f=d!==">",m=!!d.match(/\./),A=f?m?"ol":"ul":"blockquote",g=a[5].split(`
`).map(b=>b.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(b=>b.trim()!==""),y=Xe(A,f?g.map(b=>Xe("li",li(b).c)):li(g.join(`
`)).c);s.c.push(y),o=[s,y],i=s}else if(a[8]){const d=Xe("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===s){const f=Xe("p",d);s.c.push(f),i=f,o=[s,f]}else l(d,!1)}else if(a[10]){const d=o.find(f=>f.t==="a");d&&(d.p.href=a[11])}else if(a[9])l(Xe("a"));else if(a[14]){const d="h"+a[14].length;s.c.push(Xe(d,li(a[15]).c)),o=[s],i=s}else if(a[13])s.c.push(Xe("h1",li(a[12]).c)),o=[s],i=s;else if(a[16])l(Xe("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const m=s.c;let A;for(A=m.length-1;A>=0&&!Xj(m[A]);A--);if(A!==s.c.length-1){const g=s.c.splice(A+1);s.c.push(Xe("p",g))}}const f=Xe("p");s.c.push(f),o=[s,f],i=f}else if(a[1])s.c.push(Xe("hr")),o=[s],i=s;else if(a[17]){const d=a[17].length===2?"strong":"em";o.findIndex(m=>m.t===d)===-1?l(Xe(d)):c(d)}}}const u=tu(t.substring(n));if(u.length){const h=s.c.at(-1);let d;h?.t==="p"?d=h:e?(d=Xe("p"),s.c.push(d)):d=s,d.c.push(u)}return s.c=s.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),s},Jj=(t,e={})=>{const r={...Kj,...e},n=(s,i=0)=>{const o=s.t===""?C.Fragment:r[s.t];return C.createElement(o,{...s.p,key:i},s.c.length===0?void 0:s.c.map((a,l)=>typeof a=="string"?a:n(a,l)))};return n(li(t,!0))},Zj=({markdown:t,customComponents:e})=>Jj(t,e),eO={h2:function({children:e}){return p.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${Ve}`,children:p.jsx(gt,{children:e})})},h3:function({children:e}){return p.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:p.jsx(gt,{children:e})})},blockquote:function({children:e}){return p.jsx("blockquote",{className:`${Ve} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:p.jsxs(gt,{children:["> ",e]})})},p:function({children:e}){return p.jsx("div",{className:`mb-1 last:mb-0 ${Ve}`,children:p.jsx(gt,{children:e})})},a:function({children:e,href:r}){return p.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:p.jsx(gt,{children:e})})},li:function({children:e}){return p.jsx("div",{className:`mb-1 clear-both ${Ve}`,children:p.jsxs(gt,{children:[p.jsx(H,{className:"text-metallicBlue zx:text-zxYellow",children:""}),e]})})},strong:function({children:e}){return p.jsx(gt,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return p.jsx(gt,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=Zi();if(e===void 0)throw new Error("image without src");const n=e.split(/\?|&/);return p.jsx("span",{style:{"--scale":r*2},children:p.jsx("span",{className:et("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",n.join(" "))})})},hr:function(){return p.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},Ne=({markdown:t,className:e})=>p.jsx("div",{className:`contents ${e}`,children:p.jsx(Zj,{customComponents:eO,markdown:t})}),TA=4,RA=ea.h,cw=()=>{const t=Zi(),e=C.useRef(null),r=C.useCallback(n=>{if(e.current===null)return;const{scrollTop:s,scrollLeft:i}=e.current,o=qe[n],a=s+t*TA*-o.y*RA,l=i+t*TA*o.x*RA;e.current.scrollTo({left:l,top:a,behavior:"instant"})},[t]);return At({handler:C.useCallback(()=>{r("towards")},[r]),action:"towards"}),At({handler:C.useCallback(()=>{r("away")},[r]),action:"away"}),At({handler:C.useCallback(()=>{r("left")},[r]),action:"left"}),At({handler:C.useCallback(()=>{r("right")},[r]),action:"right"}),e},ru=t=>{const e=t.source==="manual"?Ej[t.pageName]:t.markdown,r=cw();return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Oe)}),p.jsxs(_e,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:$(Oe),children:[p.jsxs("div",{className:et("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[Ue()&&p.jsx(rn,{className:"pb-1"}),p.jsx(Ne,{markdown:e})]}),p.jsx(Ce,{className:"hidden",children:p.jsx(Et,{})})]})]})},he=t=>t,MA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},tO={egyptus:he("texture-crown_egyptus"),blacktooth:he("texture-crown_blacktooth"),bookworld:he("texture-crown_bookworld"),penitentiary:he("texture-crown_penitentiary"),safari:he("texture-crown_safari")},Js=({planet:t,className:e,label:r=t})=>{const n=ae(i=>i.gameMenus.gameInPlay.planetsLiberated[t]),s=!wd();return p.jsxs("div",{className:`flex flex-col ${e}`,children:[p.jsx("span",{className:`sprite block ${tO[t]} ${n?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),p.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${n?"":"colourised:brightness-halfBrite"} ${MA[t][0]}`}),p.jsx(H,{classnameCycle:s?MA[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${n?"":"colourised:brightness-halfBrite"}`,children:r})]})},rO=()=>p.jsxs(p.Fragment,{children:[p.jsx(H,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),p.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[p.jsx(Js,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(Js,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(Js,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(Js,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(Js,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),nO="/assets/rock-C4e7VvX5.mp3",sO=({playMusic:t=!1})=>{const e=iw(),r=$(Oe);return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsxs(_e,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,children:[t&&p.jsx("audio",{src:nO,autoPlay:!0,loop:!0}),p.jsx(rO,{}),p.jsx(Ce,{className:"hidden",children:!e&&p.jsx(Et,{})})]})]})},Vr=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],iO=()=>p.jsx(p.Fragment,{children:p.jsxs("div",{className:"flex justify-center gap-2 resHandheld:gap-1 leading-none",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Vr,children:"Jon"}),p.jsx(H,{classnameCycle:Vr,children:"Ritman"})]}),p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Vr,children:"Bernie"}),p.jsx(H,{classnameCycle:Vr,children:"Drummand"})]})]})]}),p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),p.jsx("address",{className:"flex",children:p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Vr,children:"Jim"}),p.jsx(H,{classnameCycle:Vr,children:"Higson"})]})})]})]})}),qs=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return he("texture-animated-head_walking_away");case"towards":return he("texture-animated-head_walking_towards");case"left":return he("texture-animated-head_walking_left");case"right":return he("texture-animated-head_walking_right");case"awayRight":return he("texture-animated-head_walking_awayRight");case"towardsRight":return he("texture-animated-head_walking_towardsRight");case"towardsLeft":return he("texture-animated-head_walking_towardsLeft");case"awayLeft":return he("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return he("texture-animated-head_idle_towards");case"right":return he("texture-animated-head_idle_right");case"awayRight":return he("texture-animated-head_idle_awayRight");case"towardsRight":return he("texture-animated-head_idle_towardsRight");case"towardsLeft":return he("texture-animated-head_idle_towardsLeft");case"away":return he("texture-head_walking_away_2");case"left":return he("texture-head_walking_left_2");case"awayLeft":return he("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return he("texture-animated-heels_walking_away");case"towards":return he("texture-animated-heels_walking_towards");case"left":return he("texture-animated-heels_walking_left");case"right":return he("texture-animated-heels_walking_right");case"awayRight":return he("texture-animated-heels_walking_awayRight");case"towardsRight":return he("texture-animated-heels_walking_towardsRight");case"towardsLeft":return he("texture-animated-heels_walking_towardsLeft");case"awayLeft":return he("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return he("texture-heels_walking_towards_2");case"right":return he("texture-heels_walking_right_2");case"awayRight":return he("texture-heels_walking_awayRight_2");case"towardsRight":return he("texture-heels_walking_towardsRight_2");case"towardsLeft":return he("texture-heels_walking_towardsLeft_2");case"away":return he("texture-heels_walking_away_2");case"left":return he("texture-heels_walking_left_2");case"awayLeft":return he("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},oO=(t,e,r)=>{const n=t.getBoundingClientRect(),s=n.left+n.width/2,i=n.top+n.height/2,o=s-e,a=i-r,c=tw({x:o,y:a});return Uh(c)},IA=({character:t,defaultFacing:e,className:r=""})=>{const[n,s]=C.useState(e),[i,o]=C.useState(!1),a=C.useRef(null);C.useEffect(()=>{const d=m=>{a.current&&s(oO(a.current,m.clientX,m.clientY)||"right")},f=()=>{s(e),o(!1)};return window.addEventListener("mousemove",d),document.addEventListener("mouseleave",f),()=>{window.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",f)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=qs({character:t,facingXy8:n,action:i?"walking":"idle"});return p.jsxs("div",{ref:a,className:`relative ${r}`,onMouseEnter:l,onMouseLeave:c,children:[p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),p.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})},uw=({noSubtitle:t,className:e})=>p.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[p.jsxs("h1",{className:"flex",children:[p.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[p.jsx(H,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),p.jsx(IA,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),p.jsx(H,{classnameCycle:Vr,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),p.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[p.jsx(H,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),p.jsx(IA,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||p.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[p.jsx(H,{className:"text-midRed zx:text-zxCyan",children:"block"}),p.jsx(H,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),p.jsx(H,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),p.jsx(H,{className:"text-moss zx:text-zxWhite",children:"ing"}),p.jsx(H,{classnameCycle:Vr,children:" remake"})]})]}),aO=()=>{const[t,e]=C.useReducer(r=>!r,!1);return p.jsxs("div",{onClick:e,className:"flex bg-metallicBlueHalfbrite text-metallicBlue justify-end absolute bottom-0 right-2 z-dialog",children:[!t&&p.jsx(H,{children:"*"}),t&&p.jsxs(H,{children:["cd04591","2025-08-16"]})]})},lO=()=>{const t=ys(),e=$(DP),r=$(yt,"whichGame");return t?p.jsx(Z,{id:"playGame",label:p.jsx(H,{children:"Resume the game"}),doubleHeightWhenFocussed:!0,onSelect:e}):p.jsx(Z,{id:"playGame",label:p.jsx(H,{children:"Play the game"}),doubleHeightWhenFocussed:!0,onSelect:r})},cO=()=>p.jsx(Z,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:$(yt,"installGuide")}),uO=()=>p.jsx(Z,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:$(yt,"sureWantEditor")}),hO=()=>{const t=ys(),e=ae(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0);return p.jsx(Z,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:$(yt,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},jA="https://discord.gg/Se5Jznc2jm",dO=t=>{const e=ys(),r=$(yt,"crowns"),n=$(yt,"score"),s=C.useCallback(()=>{r(),n()},[r,n]);return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),p.jsxs(_e,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[p.jsx(uw,{noSubtitle:e,className:e?"resHandheld:hidden":""}),p.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[p.jsxs(Ce,{className:"w-24 mx-auto",children:[p.jsx(lO,{}),!e&&St()==="desktop"&&p.jsx(uO,{}),p.jsx(Z,{id:"map",label:"use the Map",onSelect:$(yt,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),p.jsx(Z,{id:"viewCrowns",label:"Progress so far",onSelect:s,doubleHeightWhenFocussed:!0,hidden:!e})]}),p.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[p.jsxs(Ce,{children:[p.jsx(Z,{id:"modernisationOptions",label:"Options",doubleHeightWhenFocussed:!0,onSelect:$(yt,"modernisationOptions")}),p.jsx(Z,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:$(yt,"readTheManual")})]}),p.jsxs(Ce,{children:[s_()||p.jsx(cO,{}),p.jsx(Z,{id:"discord",leader:p.jsx(H,{children:ax}),label:p.jsx("a",{href:jA,target:"_blank",children:p.jsx(H,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:C.useCallback(()=>{window.open(jA,"_blank")},[])})]})]}),p.jsx(Ce,{className:"w-24 mx-auto",children:p.jsx(hO,{})})]}),!e&&p.jsx(iO,{})]}),p.jsx(aO,{})]})},On=({className:t})=>p.jsx("div",{className:et("contents",t),children:p.jsx(tn.Placeholder,{})}),hw=t=>{t.reincarnateFrom(be.getState().gameMenus.gameInPlay.reincarnationPoint),be.dispatch(Nb())},fO="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",pO=()=>{const t=Ts();return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midRed zx:bg-zxYellow"}),p.jsxs(_e,{className:"bg-white zx:bg-zxRed px-1",children:[p.jsx(H,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),p.jsx(Ne,{markdown:fO,className:"text-redShadow zx:text-zxWhite"}),p.jsxs(Ce,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{hw(t)}}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:$(Bb,{offerReincarnation:!1})})]})]})]})},Me="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow",mO=()=>{const t=ae(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0),e=Ts();return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midRed zx:bg-zxYellow"}),p.jsx(_e,{className:"bg-white zx:bg-zxRed px-1",children:p.jsx(tn.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[p.jsx(H,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),p.jsxs(Ce,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:p.jsx("span",{className:`${Me} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:$(Oe),hint:"Back to the game"}),t&&p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:p.jsx("span",{className:`${Me} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>hw(e),hint:"Go back and continue from the last reincarnation fish you ate"}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:$(Bb,{offerReincarnation:!1}),leader:p.jsx("span",{className:`${Me} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ne,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"})})]}),p.jsx(On,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},Zs=94e3,OA=(t,e)=>t*160+e*1e4,gO=[{upToProportion:8e3/Zs,label:"beginner"},{upToProportion:2e4/Zs,label:"novice"},{upToProportion:3e4/Zs,label:"spy"},{upToProportion:55e3/Zs,label:"master-spy"},{upToProportion:84e3/Zs,label:"hero"},{upToProportion:1,label:"liberator"},{upToProportion:1/0,label:"completionist"}],AO=(t,e)=>{const r=t/e;for(const{upToProportion:n,label:s}of gO)if(r<n)return s;return"completionist"},yO=()=>{const t=Vb(),e=ae(jC),r=ae(({gameMenus:{gameInPlay:{roomsExplored:a}}})=>_u(je(Rn(a)))),n=OA(r,e),s=_u(Zy(t.rooms)),i=OA(s,5),o=AO(n,i);return p.jsxs(p.Fragment,{children:[p.jsx(uw,{noSubtitle:!0,className:"resHandheld:hidden"}),p.jsx(H,{classnameCycle:Vr,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:o}),p.jsxs("div",{className:`contents ${Ve}`,children:[p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",n.toLocaleString()]}),p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",s," rooms"," ",`(${(100*r/s).toFixed(1)}%)`]}),p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),p.jsx(Ce,{className:"hidden",children:p.jsx(Et,{})})]})]})},xO=()=>p.jsx(Be,{children:p.jsxs(C.Suspense,{fallback:p.jsxs(p.Fragment,{children:[p.jsx(He,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(_e,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[p.jsx(He,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(_e,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:$(Oe),children:p.jsx(yO,{})})]})}),An="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",bO=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:An,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:An,children:"Cursor"}),""]});case"ArrowUp":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:An,children:"Cursor"}),""]});case"ArrowLeft":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:An,children:"Cursor"}),""]});case"ArrowRight":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:An,children:"Cursor"}),""]});default:return t}},qO=t=>t===0?"":t===1?"":`axis${t}`,wO=t=>{switch(Gp[t]){case"dPadDown":return"d-Pad";case"dPadUp":return"d-Pad";case"dPadLeft":return"d-Pad";case"dPadRight":return"d-Pad";case"a":return p.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return p.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return p.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return p.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return Gp[t]??t},Jd=({action:t,keyClassName:e,className:r,flashingCursor:n=!1})=>{const s=ae(o=>o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput?.presses:_a(o).presses[t]),i=ae(o=>{const a=Fb(t);return a===void 0?Mb:o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput.axes:_a(o).axes[a.axis]});return p.jsxs("div",{className:r,children:[s.keys.map(o=>p.jsx("span",{className:et("text-nowrap",e),children:p.jsx(gt,{children:bO(o)})},`key:${o}`)),i.map(o=>p.jsx("span",{className:et("text-nowrap",e),children:p.jsxs(gt,{children:[p.jsx("span",{className:An,children:""}),qO(o)]})},`gamePadAxis:${o}`)),s.gamepadButtons.map(o=>p.jsx("span",{className:et("text-nowrap",e),children:p.jsxs(gt,{children:[p.jsx("span",{className:An,children:""}),wO(o)]})},`gamePadButton:${o}`)),n&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]})},vO=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>p.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:St()==="desktop"?p.jsxs(p.Fragment,{children:[p.jsx(H,{className:"me-1",children:"Press"}),p.jsx(H,{className:et("me-1",r),children:t}),p.jsx(H,{children:"to continue"}),p.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[p.jsx(H,{children:"("}),p.jsx(Jd,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),p.jsx(H,{children:")"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx(H,{className:et("me-1",r),children:"Tap"}),p.jsx(H,{children:"to continue"})]})}),VO=()=>p.jsx(Be,{children:p.jsxs(_e,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:$(Oe),children:[p.jsx(H,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),p.jsx("span",{className:"zx",children:p.jsx(vO,{className:`${Ve} px-1`,action:"hold"})})]})});function dw(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=dw(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function fw(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=dw(t))&&(n&&(n+=" "),n+=e);return n}function _O(...t){return et(fw(t))}const SO=/^(?<modifiers>[^]*)(?<key>.+)$/,kO=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},CO=(t,e,r)=>{const n=t?.join(" ");C.useEffect(()=>{if(!t||t.length===0)return;const s=i=>{if(i.target.closest(".monaco-editor")===null)for(const l of t){const c=l.match(SO);if(!c||!c.groups)continue;const{modifiers:u,key:h}=c.groups;if(kO(u)){console.warn(`Invalid shortcut "${l}": duplicate modifiers`);continue}const d=u.includes("^"),f=u.includes(""),m=u.includes(""),A=u.includes(""),g=d||f||m||A,y=d===i.ctrlKey&&f===i.metaKey&&m===i.shiftKey&&A===i.altKey&&(g||!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey);if((A&&i.altKey?i.code.replace(/^Key/,"").toLowerCase():i.key.toLowerCase())===h.toLowerCase()&&y){e||r?.(),i.preventDefault();break}}};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[e,r,n])};function _r(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t?.(s),r===!1||!s.defaultPrevented)return e?.(s)}}function BA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function pw(...t){return e=>{let r=!1;const n=t.map(s=>{const i=BA(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():BA(t[s],null)}}}}function Bn(...t){return C.useCallback(pw(...t),t)}function mw(t,e=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:d,children:f,...m}=h,A=d?.[t]?.[l]||a,g=C.useMemo(()=>m,Object.values(m));return p.jsx(A.Provider,{value:g,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,m=C.useContext(f);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=a?.[t]||i;return C.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[n,PO(s,...e)]}function PO(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function EO(t){const e=TO(t),r=C.forwardRef((n,s)=>{const{children:i,...o}=n,a=C.Children.toArray(i),l=a.find(MO);if(l){const c=l.props.children,u=a.map(h=>h===l?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:h);return p.jsx(e,{...o,ref:s,children:C.isValidElement(c)?C.cloneElement(c,void 0,u):null})}return p.jsx(e,{...o,ref:s,children:i})});return r.displayName=`${t}.Slot`,r}function TO(t){const e=C.forwardRef((r,n)=>{const{children:s,...i}=r;if(C.isValidElement(s)){const o=jO(s),a=IO(i,s.props);return s.type!==C.Fragment&&(a.ref=n?pw(n,o):o),C.cloneElement(s,a)}return C.Children.count(s)>1?C.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var gw=Symbol("radix.slottable");function RO(t){const e=({children:r})=>p.jsx(p.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=gw,e}function MO(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===gw}function IO(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function jO(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var OO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],nn=OO.reduce((t,e)=>{const r=EO(`Primitive.${e}`),n=C.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...a,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function BO(t,e){t&&sl.flushSync(()=>t.dispatchEvent(e))}function il(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...r)=>e.current?.(...r),[])}function zO(t,e=globalThis?.document){const r=il(t);C.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var NO="DismissableLayer",wh="dismissableLayer.update",DO="dismissableLayer.pointerDownOutside",FO="dismissableLayer.focusOutside",zA,Aw=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),yw=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=C.useContext(Aw),[u,h]=C.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=C.useState({}),m=Bn(e,v=>h(v)),A=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=A.indexOf(g),b=u?A.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,q=b>=y,V=HO(v=>{const S=v.target,E=[...c.branches].some(R=>R.contains(S));!q||E||(s?.(v),o?.(v),v.defaultPrevented||a?.())},d),_=$O(v=>{const S=v.target;[...c.branches].some(R=>R.contains(S))||(i?.(v),o?.(v),v.defaultPrevented||a?.())},d);return zO(v=>{b===c.layers.size-1&&(n?.(v),!v.defaultPrevented&&a&&(v.preventDefault(),a()))},d),C.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(zA=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),NA(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=zA)}},[u,d,r,c]),C.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),NA())},[u,c]),C.useEffect(()=>{const v=()=>f({});return document.addEventListener(wh,v),()=>document.removeEventListener(wh,v)},[]),p.jsx(nn.div,{...l,ref:m,style:{pointerEvents:x?q?"auto":"none":void 0,...t.style},onFocusCapture:_r(t.onFocusCapture,_.onFocusCapture),onBlurCapture:_r(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:_r(t.onPointerDownCapture,V.onPointerDownCapture)})});yw.displayName=NO;var LO="DismissableLayerBranch",UO=C.forwardRef((t,e)=>{const r=C.useContext(Aw),n=C.useRef(null),s=Bn(e,n);return C.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),p.jsx(nn.div,{...t,ref:s})});UO.displayName=LO;function HO(t,e=globalThis?.document){const r=il(t),n=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let l=function(){xw(DO,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function $O(t,e=globalThis?.document){const r=il(t),n=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!n.current&&xw(FO,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function NA(){const t=new CustomEvent(wh);document.dispatchEvent(t)}function xw(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?BO(s,i):s.dispatchEvent(i)}var Gr=globalThis?.document?C.useLayoutEffect:()=>{},WO=Oh[" useId ".trim().toString()]||(()=>{}),GO=0;function QO(t){const[e,r]=C.useState(WO());return Gr(()=>{r(n=>n??String(GO++))},[t]),e?`radix-${e}`:""}const YO=["top","right","bottom","left"],Qr=Math.min,Nt=Math.max,Ma=Math.round,Go=Math.floor,ur=t=>({x:t,y:t}),KO={left:"right",right:"left",bottom:"top",top:"bottom"},XO={start:"end",end:"start"};function vh(t,e,r){return Nt(t,Qr(e,r))}function Tr(t,e){return typeof t=="function"?t(e):t}function Rr(t){return t.split("-")[0]}function Bs(t){return t.split("-")[1]}function Zd(t){return t==="x"?"y":"x"}function ef(t){return t==="y"?"height":"width"}function Yr(t){return["top","bottom"].includes(Rr(t))?"y":"x"}function tf(t){return Zd(Yr(t))}function JO(t,e,r){r===void 0&&(r=!1);const n=Bs(t),s=tf(t),i=ef(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Ia(o)),[o,Ia(o)]}function ZO(t){const e=Ia(t);return[Vh(t),e,Vh(e)]}function Vh(t){return t.replace(/start|end/g,e=>XO[e])}function eB(t,e,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?i:o;default:return[]}}function tB(t,e,r,n){const s=Bs(t);let i=eB(Rr(t),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Vh)))),i}function Ia(t){return t.replace(/left|right|bottom|top/g,e=>KO[e])}function rB(t){return{top:0,right:0,bottom:0,left:0,...t}}function bw(t){return typeof t!="number"?rB(t):{top:t,right:t,bottom:t,left:t}}function ja(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function DA(t,e,r){let{reference:n,floating:s}=t;const i=Yr(e),o=tf(e),a=ef(o),l=Rr(e),c=i==="y",u=n.x+n.width/2-s.width/2,h=n.y+n.height/2-s.height/2,d=n[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:n.y-s.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:h};break;case"left":f={x:n.x-s.width,y:h};break;default:f={x:n.x,y:n.y}}switch(Bs(e)){case"start":f[o]-=d*(r&&c?-1:1);break;case"end":f[o]+=d*(r&&c?-1:1);break}return f}const nB=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=DA(c,n,l),d=n,f={},m=0;for(let A=0;A<a.length;A++){const{name:g,fn:y}=a[A],{x:b,y:x,data:q,reset:V}=await y({x:u,y:h,initialPlacement:n,placement:d,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=b??u,h=x??h,f={...f,[g]:{...f[g],...q}},V&&m<=50&&(m++,typeof V=="object"&&(V.placement&&(d=V.placement),V.rects&&(c=V.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):V.rects),{x:u,y:h}=DA(c,d,l)),A=-1)}return{x:u,y:h,placement:d,strategy:s,middlewareData:f}};async function ji(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=Tr(e,t),m=bw(f),g=a[d?h==="floating"?"reference":"floating":h],y=ja(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=h==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),q=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},V=ja(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:x,strategy:l}):b);return{top:(y.top-V.top+m.top)/q.y,bottom:(V.bottom-y.bottom+m.bottom)/q.y,left:(y.left-V.left+m.left)/q.x,right:(V.right-y.right+m.right)/q.x}}const sB=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Tr(t,e)||{};if(c==null)return{};const h=bw(u),d={x:r,y:n},f=tf(s),m=ef(f),A=await o.getDimensions(c),g=f==="y",y=g?"top":"left",b=g?"bottom":"right",x=g?"clientHeight":"clientWidth",q=i.reference[m]+i.reference[f]-d[f]-i.floating[m],V=d[f]-i.reference[f],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let v=_?_[x]:0;(!v||!await(o.isElement==null?void 0:o.isElement(_)))&&(v=a.floating[x]||i.floating[m]);const S=q/2-V/2,E=v/2-A[m]/2-1,R=Qr(h[y],E),I=Qr(h[b],E),B=R,N=v-A[m]-I,D=v/2-A[m]/2+S,U=vh(B,D,N),w=!l.arrow&&Bs(s)!=null&&D!==U&&i.reference[m]/2-(D<B?R:I)-A[m]/2<0,k=w?D<B?D-B:D-N:0;return{[f]:d[f]+k,data:{[f]:U,centerOffset:D-U-k,...w&&{alignmentOffset:k}},reset:w}}}),iB=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:A=!0,...g}=Tr(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Rr(s),b=Yr(a),x=Rr(a)===a,q=await(l.isRTL==null?void 0:l.isRTL(c.floating)),V=d||(x||!A?[Ia(a)]:ZO(a)),_=m!=="none";!d&&_&&V.push(...tB(a,A,m,q));const v=[a,...V],S=await ji(e,g),E=[];let R=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&E.push(S[y]),h){const D=JO(s,o,q);E.push(S[D[0]],S[D[1]])}if(R=[...R,{placement:s,overflows:E}],!E.every(D=>D<=0)){var I,B;const D=(((I=i.flip)==null?void 0:I.index)||0)+1,U=v[D];if(U)return{data:{index:D,overflows:R},reset:{placement:U}};let w=(B=R.filter(k=>k.overflows[0]<=0).sort((k,P)=>k.overflows[1]-P.overflows[1])[0])==null?void 0:B.placement;if(!w)switch(f){case"bestFit":{var N;const k=(N=R.filter(P=>{if(_){const M=Yr(P.placement);return M===b||M==="y"}return!0}).map(P=>[P.placement,P.overflows.filter(M=>M>0).reduce((M,T)=>M+T,0)]).sort((P,M)=>P[1]-M[1])[0])==null?void 0:N[0];k&&(w=k);break}case"initialPlacement":w=a;break}if(s!==w)return{reset:{placement:w}}}return{}}}};function FA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function LA(t){return YO.some(e=>t[e]>=0)}const oB=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=Tr(t,e);switch(n){case"referenceHidden":{const i=await ji(e,{...s,elementContext:"reference"}),o=FA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:LA(o)}}}case"escaped":{const i=await ji(e,{...s,altBoundary:!0}),o=FA(i,r.floating);return{data:{escapedOffsets:o,escaped:LA(o)}}}default:return{}}}}};async function aB(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Rr(r),a=Bs(r),l=Yr(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=Tr(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const lB=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await aB(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},cB=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:b}=g;return{x:y,y:b}}},...l}=Tr(t,e),c={x:r,y:n},u=await ji(e,l),h=Yr(Rr(s)),d=Zd(h);let f=c[d],m=c[h];if(i){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=f+u[g],x=f-u[y];f=vh(b,f,x)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",b=m+u[g],x=m-u[y];m=vh(b,m,x)}const A=a.fn({...e,[d]:f,[h]:m});return{...A,data:{x:A.x-r,y:A.y-n,enabled:{[d]:i,[h]:o}}}}}},uB=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Tr(t,e),u={x:r,y:n},h=Yr(s),d=Zd(h);let f=u[d],m=u[h];const A=Tr(a,e),g=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=d==="y"?"height":"width",q=i.reference[d]-i.floating[x]+g.mainAxis,V=i.reference[d]+i.reference[x]-g.mainAxis;f<q?f=q:f>V&&(f=V)}if(c){var y,b;const x=d==="y"?"width":"height",q=["top","left"].includes(Rr(s)),V=i.reference[h]-i.floating[x]+(q&&((y=o.offset)==null?void 0:y[h])||0)+(q?0:g.crossAxis),_=i.reference[h]+i.reference[x]+(q?0:((b=o.offset)==null?void 0:b[h])||0)-(q?g.crossAxis:0);m<V?m=V:m>_&&(m=_)}return{[d]:f,[h]:m}}}},hB=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Tr(t,e),u=await ji(e,c),h=Rr(s),d=Bs(s),f=Yr(s)==="y",{width:m,height:A}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=d==="end"?"top":"bottom");const b=A-u.top-u.bottom,x=m-u.left-u.right,q=Qr(A-u[g],b),V=Qr(m-u[y],x),_=!e.middlewareData.shift;let v=q,S=V;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(S=x),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(v=b),_&&!d){const R=Nt(u.left,0),I=Nt(u.right,0),B=Nt(u.top,0),N=Nt(u.bottom,0);f?S=m-2*(R!==0||I!==0?R+I:Nt(u.left,u.right)):v=A-2*(B!==0||N!==0?B+N:Nt(u.top,u.bottom))}await l({...e,availableWidth:S,availableHeight:v});const E=await o.getDimensions(a.floating);return m!==E.width||A!==E.height?{reset:{rects:!0}}:{}}}};function ol(){return typeof window<"u"}function zs(t){return qw(t)?(t.nodeName||"").toLowerCase():"#document"}function Ft(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function gr(t){var e;return(e=(qw(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function qw(t){return ol()?t instanceof Node||t instanceof Ft(t).Node:!1}function ir(t){return ol()?t instanceof Element||t instanceof Ft(t).Element:!1}function dr(t){return ol()?t instanceof HTMLElement||t instanceof Ft(t).HTMLElement:!1}function UA(t){return!ol()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ft(t).ShadowRoot}function no(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=or(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function dB(t){return["table","td","th"].includes(zs(t))}function al(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function rf(t){const e=nf(),r=ir(t)?or(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function fB(t){let e=Kr(t);for(;dr(e)&&!ws(e);){if(rf(e))return e;if(al(e))return null;e=Kr(e)}return null}function nf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ws(t){return["html","body","#document"].includes(zs(t))}function or(t){return Ft(t).getComputedStyle(t)}function ll(t){return ir(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Kr(t){if(zs(t)==="html")return t;const e=t.assignedSlot||t.parentNode||UA(t)&&t.host||gr(t);return UA(e)?e.host:e}function ww(t){const e=Kr(t);return ws(e)?t.ownerDocument?t.ownerDocument.body:t.body:dr(e)&&no(e)?e:ww(e)}function Oi(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=ww(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),o=Ft(s);if(i){const a=_h(o);return e.concat(o,o.visualViewport||[],no(s)?s:[],a&&r?Oi(a):[])}return e.concat(s,Oi(s,[],r))}function _h(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function vw(t){const e=or(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=dr(t),i=s?t.offsetWidth:r,o=s?t.offsetHeight:n,a=Ma(r)!==i||Ma(n)!==o;return a&&(r=i,n=o),{width:r,height:n,$:a}}function sf(t){return ir(t)?t:t.contextElement}function ds(t){const e=sf(t);if(!dr(e))return ur(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=vw(e);let o=(i?Ma(r.width):r.width)/n,a=(i?Ma(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const pB=ur(0);function Vw(t){const e=Ft(t);return!nf()||!e.visualViewport?pB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function mB(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ft(t)?!1:e}function Tn(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=sf(t);let o=ur(1);e&&(n?ir(n)&&(o=ds(n)):o=ds(t));const a=mB(i,r,n)?Vw(i):ur(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const d=Ft(i),f=n&&ir(n)?Ft(n):n;let m=d,A=_h(m);for(;A&&n&&f!==m;){const g=ds(A),y=A.getBoundingClientRect(),b=or(A),x=y.left+(A.clientLeft+parseFloat(b.paddingLeft))*g.x,q=y.top+(A.clientTop+parseFloat(b.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=x,c+=q,m=Ft(A),A=_h(m)}}return ja({width:u,height:h,x:l,y:c})}function of(t,e){const r=ll(t).scrollLeft;return e?e.left+r:Tn(gr(t)).left+r}function _w(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:of(t,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function gB(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",o=gr(n),a=e?al(e.floating):!1;if(n===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=ur(1);const u=ur(0),h=dr(n);if((h||!h&&!i)&&((zs(n)!=="body"||no(o))&&(l=ll(n)),dr(n))){const f=Tn(n);c=ds(n),u.x=f.x+n.clientLeft,u.y=f.y+n.clientTop}const d=o&&!h&&!i?_w(o,l,!0):ur(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function AB(t){return Array.from(t.getClientRects())}function yB(t){const e=gr(t),r=ll(t),n=t.ownerDocument.body,s=Nt(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Nt(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+of(t);const a=-r.scrollTop;return or(n).direction==="rtl"&&(o+=Nt(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function xB(t,e){const r=Ft(t),n=gr(t),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=nf();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function bB(t,e){const r=Tn(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=dr(t)?ds(t):ur(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=n*i.y;return{width:o,height:a,x:l,y:c}}function HA(t,e,r){let n;if(e==="viewport")n=xB(t,r);else if(e==="document")n=yB(gr(t));else if(ir(e))n=bB(e,r);else{const s=Vw(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return ja(n)}function Sw(t,e){const r=Kr(t);return r===e||!ir(r)||ws(r)?!1:or(r).position==="fixed"||Sw(r,e)}function qB(t,e){const r=e.get(t);if(r)return r;let n=Oi(t,[],!1).filter(a=>ir(a)&&zs(a)!=="body"),s=null;const i=or(t).position==="fixed";let o=i?Kr(t):t;for(;ir(o)&&!ws(o);){const a=or(o),l=rf(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||no(o)&&!l&&Sw(t,o))?n=n.filter(u=>u!==o):s=a,o=Kr(o)}return e.set(t,n),n}function wB(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const o=[...r==="clippingAncestors"?al(e)?[]:qB(e,this._c):[].concat(r),n],a=o[0],l=o.reduce((c,u)=>{const h=HA(e,u,s);return c.top=Nt(h.top,c.top),c.right=Qr(h.right,c.right),c.bottom=Qr(h.bottom,c.bottom),c.left=Nt(h.left,c.left),c},HA(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function vB(t){const{width:e,height:r}=vw(t);return{width:e,height:r}}function VB(t,e,r){const n=dr(e),s=gr(e),i=r==="fixed",o=Tn(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ur(0);if(n||!n&&!i)if((zs(e)!=="body"||no(s))&&(a=ll(e)),n){const d=Tn(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else s&&(l.x=of(s));const c=s&&!n&&!i?_w(s,a):ur(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function nu(t){return or(t).position==="static"}function $A(t,e){if(!dr(t)||or(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return gr(t)===r&&(r=r.ownerDocument.body),r}function kw(t,e){const r=Ft(t);if(al(t))return r;if(!dr(t)){let s=Kr(t);for(;s&&!ws(s);){if(ir(s)&&!nu(s))return s;s=Kr(s)}return r}let n=$A(t,e);for(;n&&dB(n)&&nu(n);)n=$A(n,e);return n&&ws(n)&&nu(n)&&!rf(n)?r:n||fB(t)||r}const _B=async function(t){const e=this.getOffsetParent||kw,r=this.getDimensions,n=await r(t.floating);return{reference:VB(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function SB(t){return or(t).direction==="rtl"}const kB={convertOffsetParentRelativeRectToViewportRelativeRect:gB,getDocumentElement:gr,getClippingRect:wB,getOffsetParent:kw,getElementRects:_B,getClientRects:AB,getDimensions:vB,getScale:ds,isElement:ir,isRTL:SB};function Cw(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function CB(t,e){let r=null,n;const s=gr(t);function i(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const m=Go(h),A=Go(s.clientWidth-(u+d)),g=Go(s.clientHeight-(h+f)),y=Go(u),x={rootMargin:-m+"px "+-A+"px "+-g+"px "+-y+"px",threshold:Nt(0,Qr(1,l))||1};let q=!0;function V(_){const v=_[0].intersectionRatio;if(v!==l){if(!q)return o();v?o(!1,v):n=setTimeout(()=>{o(!1,1e-7)},1e3)}v===1&&!Cw(c,t.getBoundingClientRect())&&o(),q=!1}try{r=new IntersectionObserver(V,{...x,root:s.ownerDocument})}catch{r=new IntersectionObserver(V,x)}r.observe(t)}return o(!0),i}function PB(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=sf(t),u=s||i?[...c?Oi(c):[],...Oi(e)]:[];u.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const h=c&&a?CB(c,r):null;let d=-1,f=null;o&&(f=new ResizeObserver(y=>{let[b]=y;b&&b.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let m,A=l?Tn(t):null;l&&g();function g(){const y=Tn(t);A&&!Cw(A,y)&&r(),A=y,m=requestAnimationFrame(g)}return r(),()=>{var y;u.forEach(b=>{s&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),h?.(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const EB=lB,TB=cB,RB=iB,MB=hB,IB=oB,WA=sB,jB=uB,OB=(t,e,r)=>{const n=new Map,s={platform:kB,...r},i={...s.platform,_c:n};return nB(t,e,{...s,platform:i})};var la=typeof document<"u"?C.useLayoutEffect:C.useEffect;function Oa(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!Oa(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!Oa(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function Pw(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function GA(t,e){const r=Pw(t);return Math.round(e*r)/r}function su(t){const e=C.useRef(t);return la(()=>{e.current=t}),e}function BB(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=C.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=C.useState(n);Oa(d,n)||f(n);const[m,A]=C.useState(null),[g,y]=C.useState(null),b=C.useCallback(P=>{P!==_.current&&(_.current=P,A(P))},[]),x=C.useCallback(P=>{P!==v.current&&(v.current=P,y(P))},[]),q=i||m,V=o||g,_=C.useRef(null),v=C.useRef(null),S=C.useRef(u),E=l!=null,R=su(l),I=su(s),B=su(c),N=C.useCallback(()=>{if(!_.current||!v.current)return;const P={placement:e,strategy:r,middleware:d};I.current&&(P.platform=I.current),OB(_.current,v.current,P).then(M=>{const T={...M,isPositioned:B.current!==!1};D.current&&!Oa(S.current,T)&&(S.current=T,sl.flushSync(()=>{h(T)}))})},[d,e,r,I,B]);la(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,h(P=>({...P,isPositioned:!1})))},[c]);const D=C.useRef(!1);la(()=>(D.current=!0,()=>{D.current=!1}),[]),la(()=>{if(q&&(_.current=q),V&&(v.current=V),q&&V){if(R.current)return R.current(q,V,N);N()}},[q,V,N,R,E]);const U=C.useMemo(()=>({reference:_,floating:v,setReference:b,setFloating:x}),[b,x]),w=C.useMemo(()=>({reference:q,floating:V}),[q,V]),k=C.useMemo(()=>{const P={position:r,left:0,top:0};if(!w.floating)return P;const M=GA(w.floating,u.x),T=GA(w.floating,u.y);return a?{...P,transform:"translate("+M+"px, "+T+"px)",...Pw(w.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:M,top:T}},[r,a,w.floating,u.x,u.y]);return C.useMemo(()=>({...u,update:N,refs:U,elements:w,floatingStyles:k}),[u,N,U,w,k])}const zB=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?WA({element:n.current,padding:s}).fn(r):{}:n?WA({element:n,padding:s}).fn(r):{}}}},NB=(t,e)=>({...EB(t),options:[t,e]}),DB=(t,e)=>({...TB(t),options:[t,e]}),FB=(t,e)=>({...jB(t),options:[t,e]}),LB=(t,e)=>({...RB(t),options:[t,e]}),UB=(t,e)=>({...MB(t),options:[t,e]}),HB=(t,e)=>({...IB(t),options:[t,e]}),$B=(t,e)=>({...zB(t),options:[t,e]});var WB="Arrow",Ew=C.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return p.jsx(nn.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});Ew.displayName=WB;var GB=Ew;function QB(t){const[e,r]=C.useState(void 0);return Gr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var af="Popper",[Tw,Rw]=mw(af),[YB,Mw]=Tw(af),Iw=t=>{const{__scopePopper:e,children:r}=t,[n,s]=C.useState(null);return p.jsx(YB,{scope:e,anchor:n,onAnchorChange:s,children:r})};Iw.displayName=af;var jw="PopperAnchor",Ow=C.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=Mw(jw,r),o=C.useRef(null),a=Bn(e,o);return C.useEffect(()=>{i.onAnchorChange(n?.current||o.current)}),n?null:p.jsx(nn.div,{...s,ref:a})});Ow.displayName=jw;var lf="PopperContent",[KB,XB]=Tw(lf),Bw=C.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:m,...A}=t,g=Mw(lf,r),[y,b]=C.useState(null),x=Bn(e,Y=>b(Y)),[q,V]=C.useState(null),_=QB(q),v=_?.width??0,S=_?.height??0,E=n+(i!=="center"?"-"+i:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(c)?c:[c],B=I.length>0,N={padding:R,boundary:I.filter(ZB),altBoundary:B},{refs:D,floatingStyles:U,placement:w,isPositioned:k,middlewareData:P}=BB({strategy:"fixed",placement:E,whileElementsMounted:(...Y)=>PB(...Y,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[NB({mainAxis:s+S,alignmentAxis:o}),l&&DB({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?FB():void 0,...N}),l&&LB({...N}),UB({...N,apply:({elements:Y,rects:re,availableWidth:ie,availableHeight:ne})=>{const{width:pt,height:$e}=re.reference,nt=Y.floating.style;nt.setProperty("--radix-popper-available-width",`${ie}px`),nt.setProperty("--radix-popper-available-height",`${ne}px`),nt.setProperty("--radix-popper-anchor-width",`${pt}px`),nt.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),q&&$B({element:q,padding:a}),e2({arrowWidth:v,arrowHeight:S}),d&&HB({strategy:"referenceHidden",...N})]}),[M,T]=Dw(w),j=il(m);Gr(()=>{k&&j?.()},[k,j]);const O=P.arrow?.x,z=P.arrow?.y,F=P.arrow?.centerOffset!==0,[L,W]=C.useState();return Gr(()=>{y&&W(window.getComputedStyle(y).zIndex)},[y]),p.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:k?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[P.transformOrigin?.x,P.transformOrigin?.y].join(" "),...P.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(KB,{scope:r,placedSide:M,onArrowChange:V,arrowX:O,arrowY:z,shouldHideArrow:F,children:p.jsx(nn.div,{"data-side":M,"data-align":T,...A,ref:x,style:{...A.style,animation:k?void 0:"none"}})})})});Bw.displayName=lf;var zw="PopperArrow",JB={top:"bottom",right:"left",bottom:"top",left:"right"},Nw=C.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=XB(zw,n),o=JB[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(GB,{...s,ref:r,style:{...s.style,display:"block"}})})});Nw.displayName=zw;function ZB(t){return t!==null}var e2=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:s}=e,o=s.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Dw(r),h={start:"0%",center:"50%",end:"100%"}[u],d=(s.arrow?.x??0)+a/2,f=(s.arrow?.y??0)+l/2;let m="",A="";return c==="bottom"?(m=o?h:`${d}px`,A=`${-l}px`):c==="top"?(m=o?h:`${d}px`,A=`${n.floating.height+l}px`):c==="right"?(m=`${-l}px`,A=o?h:`${f}px`):c==="left"&&(m=`${n.floating.width+l}px`,A=o?h:`${f}px`),{data:{x:m,y:A}}}});function Dw(t){const[e,r="center"]=t.split("-");return[e,r]}var t2=Iw,r2=Ow,n2=Bw,s2=Nw,i2="Portal",Fw=C.forwardRef((t,e)=>{const{container:r,...n}=t,[s,i]=C.useState(!1);Gr(()=>i(!0),[]);const o=r||s&&globalThis?.document?.body;return o?Gj.createPortal(p.jsx(nn.div,{...n,ref:e}),o):null});Fw.displayName=i2;function o2(t,e){return C.useReducer((r,n)=>e[r][n]??r,t)}var cf=t=>{const{present:e,children:r}=t,n=a2(e),s=typeof r=="function"?r({present:n.isPresent}):C.Children.only(r),i=Bn(n.ref,l2(s));return typeof r=="function"||n.isPresent?C.cloneElement(s,{ref:i}):null};cf.displayName="Presence";function a2(t){const[e,r]=C.useState(),n=C.useRef(null),s=C.useRef(t),i=C.useRef("none"),o=t?"mounted":"unmounted",[a,l]=o2(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=Qo(n.current);i.current=a==="mounted"?c:"none"},[a]),Gr(()=>{const c=n.current,u=s.current;if(u!==t){const d=i.current,f=Qo(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Gr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const A=Qo(n.current).includes(f.animationName);if(f.target===e&&A&&(l("ANIMATION_END"),!s.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},d=f=>{f.target===e&&(i.current=Qo(n.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function Qo(t){return t?.animationName||"none"}function l2(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var c2=Oh[" useInsertionEffect ".trim().toString()]||Gr;function u2({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,i,o]=h2({defaultProp:e,onChange:r}),a=t!==void 0,l=a?t:s;{const u=C.useRef(t!==void 0);C.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,n])}const c=C.useCallback(u=>{if(a){const h=d2(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function h2({defaultProp:t,onChange:e}){const[r,n]=C.useState(t),s=C.useRef(r),i=C.useRef(e);return c2(()=>{i.current=e},[e]),C.useEffect(()=>{s.current!==r&&(i.current?.(r),s.current=r)},[r,s]),[r,n,i]}function d2(t){return typeof t=="function"}var f2=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),p2="VisuallyHidden",Lw=C.forwardRef((t,e)=>p.jsx(nn.span,{...t,ref:e,style:{...f2,...t.style}}));Lw.displayName=p2;var m2=Lw,[cl,PL]=mw("Tooltip",[Rw]),ul=Rw(),g2="TooltipProvider",Sh="tooltip.open",[EL,uf]=cl(g2),Bi="Tooltip",[A2,so]=cl(Bi),Uw=t=>{const{__scopeTooltip:e,children:r,open:n,defaultOpen:s,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=uf(Bi,t.__scopeTooltip),c=ul(e),[u,h]=C.useState(null),d=QO(),f=C.useRef(0),m=o??l.disableHoverableContent,A=a??l.delayDuration,g=C.useRef(!1),[y,b]=u2({prop:n,defaultProp:s??!1,onChange:v=>{v?(l.onOpen(),document.dispatchEvent(new CustomEvent(Sh))):l.onClose(),i?.(v)},caller:Bi}),x=C.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),q=C.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g.current=!1,b(!0)},[b]),V=C.useCallback(()=>{window.clearTimeout(f.current),f.current=0,b(!1)},[b]),_=C.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{g.current=!0,b(!0),f.current=0},A)},[A,b]);return C.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),p.jsx(t2,{...c,children:p.jsx(A2,{scope:e,contentId:d,open:y,stateAttribute:x,trigger:u,onTriggerChange:h,onTriggerEnter:C.useCallback(()=>{l.isOpenDelayedRef.current?_():q()},[l.isOpenDelayedRef,_,q]),onTriggerLeave:C.useCallback(()=>{m?V():(window.clearTimeout(f.current),f.current=0)},[V,m]),onOpen:q,onClose:V,disableHoverableContent:m,children:r})})};Uw.displayName=Bi;var kh="TooltipTrigger",Hw=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=so(kh,r),i=uf(kh,r),o=ul(r),a=C.useRef(null),l=Bn(e,a,s.onTriggerChange),c=C.useRef(!1),u=C.useRef(!1),h=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),p.jsx(r2,{asChild:!0,...o,children:p.jsx(nn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:_r(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:_r(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:_r(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:_r(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:_r(t.onBlur,s.onClose),onClick:_r(t.onClick,s.onClose)})})});Hw.displayName=kh;var hf="TooltipPortal",[y2,x2]=cl(hf,{forceMount:void 0}),$w=t=>{const{__scopeTooltip:e,forceMount:r,children:n,container:s}=t,i=so(hf,e);return p.jsx(y2,{scope:e,forceMount:r,children:p.jsx(cf,{present:r||i.open,children:p.jsx(Fw,{asChild:!0,container:s,children:n})})})};$w.displayName=hf;var vs="TooltipContent",Ww=C.forwardRef((t,e)=>{const r=x2(vs,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,o=so(vs,t.__scopeTooltip);return p.jsx(cf,{present:n||o.open,children:o.disableHoverableContent?p.jsx(Gw,{side:s,...i,ref:e}):p.jsx(b2,{side:s,...i,ref:e})})}),b2=C.forwardRef((t,e)=>{const r=so(vs,t.__scopeTooltip),n=uf(vs,t.__scopeTooltip),s=C.useRef(null),i=Bn(e,s),[o,a]=C.useState(null),{trigger:l,onClose:c}=r,u=s.current,{onPointerInTransitChange:h}=n,d=C.useCallback(()=>{a(null),h(!1)},[h]),f=C.useCallback((m,A)=>{const g=m.currentTarget,y={x:m.clientX,y:m.clientY},b=_2(y,g.getBoundingClientRect()),x=S2(y,b),q=k2(A.getBoundingClientRect()),V=P2([...x,...q]);a(V),h(!0)},[h]);return C.useEffect(()=>()=>d(),[d]),C.useEffect(()=>{if(l&&u){const m=g=>f(g,u),A=g=>f(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",A)}}},[l,u,f,d]),C.useEffect(()=>{if(o){const m=A=>{const g=A.target,y={x:A.clientX,y:A.clientY},b=l?.contains(g)||u?.contains(g),x=!C2(y,o);b?d():x&&(d(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,d]),p.jsx(Gw,{...t,ref:i})}),[q2,w2]=cl(Bi,{isInside:!1}),v2=RO("TooltipContent"),Gw=C.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=so(vs,r),c=ul(r),{onClose:u}=l;return C.useEffect(()=>(document.addEventListener(Sh,u),()=>document.removeEventListener(Sh,u)),[u]),C.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),p.jsx(yw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:p.jsxs(n2,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(v2,{children:n}),p.jsx(q2,{scope:r,isInside:!0,children:p.jsx(m2,{id:l.contentId,role:"tooltip",children:s||n})})]})})});Ww.displayName=vs;var Qw="TooltipArrow",V2=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=ul(r);return w2(Qw,r).isInside?null:p.jsx(s2,{...s,...n,ref:e})});V2.displayName=Qw;function _2(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function S2(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function k2(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function C2(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>n!=d>n&&r<(h-c)*(n-u)/(d-u)+c&&(s=!s)}return s}function P2(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),E2(e)}function E2(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var T2=Uw;const R2=({triggerContent:t,tooltipContent:e})=>e?p.jsxs(T2,{children:[p.jsx(Hw,{asChild:!0,children:t}),p.jsx($w,{children:p.jsx(as,{scaleFactor:2,children:p.jsx(Ww,{side:"bottom",align:"end",className:"bg-highlightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?p.jsx("div",{className:"max-w-16",children:p.jsx(Ne,{markdown:e})}):e})})})]}):t,Yw=t=>t.replace(/ArrowLeft/g,"").replace(/ArrowRight/g,"").replace(/ArrowUp/g,"").replace(/ArrowDown/g,""),M2=t=>{const e=t.map(Yw);return e.length===1?`

Hotkey: **${e[0]}**`:`

Hotkeys: ${e.map(r=>`**${r}**`).join(" or ")}`},I2=(t,e)=>{if(!e)return t;if(t)return`${t}${M2(e)}`;const r=e.map(Yw);return r.length===1?`Hotkey: **${r[0]}**`:`Hotkeys: ${r.map(n=>`**${n}**`).join(" or ")}`},Nr=({className:t,value:e,onChange:r,trueLabel:n="ON",falseLabel:s="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(n.length,s.length)+1,c=n.padStart(l," "),u=s.padEnd(l," ");CO(o,!1,()=>{r?.(!e,void 0)});const h=p.jsxs("span",{onClick:f=>r?.(!e,f),className:_O("inline-flex justify-between",t),children:[i&&p.jsx(H,{className:"inline-block mr-1 text-lightGrey",noSlitWords:!0,children:i}),p.jsx(H,{className:fw("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),d=I2(typeof a=="string"?a:void 0,o)??a;return p.jsx(R2,{triggerContent:h,tooltipContent:d})},df="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",ff="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",iu="[&_.em]:text-lightBeige zx:[&_.em]:text-zxCyan",j2=`![](texture-animated-head_walking_towards?float-right)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,O2=`pokes cant be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,B2="everything to *select the keys* and other input settings",z2=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Oe)}),p.jsx(_e,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsx(tn.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+ff,children:[Ue()&&p.jsx(rn,{className:"text-highlightBeige"}),p.jsx(H,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),p.jsxs(Ce,{className:df,children:[p.jsx(Z,{id:"controlOptions",label:"Control options",doubleHeightWhenFocussed:!0,onSelect:$(yt,"controlOptions"),hint:p.jsx(Ne,{className:iu,markdown:B2})}),p.jsx(Z,{id:"sound",label:"Sound options",doubleHeightWhenFocussed:!0,onSelect:$(yt,"sound")}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:p.jsx(Nr,{value:!wd()}),onSelect:$(tr,"userSettings.displaySettings.uncolourised"),hint:p.jsx(Ne,{className:iu,markdown:j2})}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"livesModel",label:" Lives poke",hint:p.jsx(Ne,{className:iu,markdown:O2}),valueElement:p.jsx(Nr,{value:ae(bb)}),onSelect:$(tr,"userSettings.infiniteLivesPoke"),disabled:ys()}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"infiniteDoughnutsPoke",label:" doughnuts poke",valueElement:p.jsx(Nr,{value:ae(qb)}),onSelect:$(tr,"userSettings.infiniteDoughnutsPoke"),disabled:ys()}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"showFps",label:"Show FPS",valueElement:p.jsx(Nr,{value:ae(TC)}),onSelect:$(tr,"userSettings.showFps"),hint:"show frame rate (frames per second) in the top-right corner"}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"crtFilter",label:"CRT TV effect",valueElement:p.jsx(Nr,{value:ae(IC)}),onSelect:$(tr,"userSettings.displaySettings.crtFilter"),hint:"Subtle screen glow a bit like an old tv"}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:$(yt,"emulatedResolution")}),p.jsx(Os,{}),Ue()||p.jsx(Et,{})]}),Ue()||p.jsx(On,{className:"text-moss zx:text-zxGreen"})]})})})]}),QA="text-pink zx:text-zxCyan",N2=()=>{const t=ae(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:p.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${Ve} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[p.jsx(H,{children:"Press "}),p.jsx(Jd,{className:`inline ${QA}`,action:"menu_openOrExit",keyClassName:"me-1"}),p.jsx(H,{children:"when done selecting keys for "}),p.jsx(H,{className:QA,children:t})]})},D2="**world**: Control is relative to directions in the isometric world",F2=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but requires inputting diagonals a lot`,L2=({className:t})=>p.jsxs("span",{children:[p.jsx(H,{className:et("text-nowrap me-1","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:Sa()?"screen":"world"}),p.jsx(H,{className:et("text-nowrap","text-moss zx:text-zxBlue selectedMenuItem:text-mossHalfbrite zx:selectedMenuItem:text-zxBlue",t),children:Sa()?"   ":"   "})]}),U2=()=>{const t=Sa();return p.jsx(Z,{id:"screenRelativeControl",label:"input axes",leader:p.jsx("span",{className:`${Me} ${t?"texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections":"texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_worldDirections"}`}),valueElement:p.jsx(L2,{}),onSelect:$(tr,"userSettings.screenRelativeControl"),hintInline:!0,hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:t?F2:D2})})},Kw="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",H2="**4-way**: true to the 1987 original - move in x directions only",$2="**8-way**: the original with *4-way* movement, plus *diagonals*",W2="**analogue**: move in *any* direction with analogue stick",G2=()=>{const t=wb();return p.jsx(Z,{id:"analogueControl",label:"Directions",leader:p.jsx("span",{className:`${Me} texture-joystick`}),valueElement:p.jsx(H,{className:Kw,children:t}),onSelect:$(WP),hintInline:!0,hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:t==="analogue"?W2:t==="8-way"?$2:H2})})},It=({className:t,action:e})=>{const r=ae(n=>n.gameMenus.assigningInput?.action===e);return p.jsx(Jd,{className:et("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:Kw,flashingCursor:r})},Q2=({className:t})=>{const e=ae(EC);return p.jsx(H,{className:et("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},Y2=()=>{const t=Sa();return p.jsxs(p.Fragment,{children:[p.jsx(Z,{id:"preset",label:p.jsx(H,{className:`inline-block w-6 ${Ve}`,children:"key/ button preset"}),valueElement:p.jsx(Q2,{}),onSelect:$(yt,"inputPreset")}),p.jsx(Z,{id:"left",label:`Left ${t?"":""}`,leader:p.jsx("span",{className:`${Me} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:p.jsx(It,{action:"left"}),onSelect:$(Mt,"left")}),p.jsx(Z,{id:"right",label:`Right ${t?"":""}`,leader:p.jsx("span",{className:`${Me} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:p.jsx(It,{action:"right"}),onSelect:$(Mt,"right")}),p.jsx(Z,{id:"up",label:`Up ${t?"":""}`,leader:p.jsx("span",{className:`${Me} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:p.jsx(It,{action:"away"}),onSelect:$(Mt,"away")}),p.jsx(Z,{id:"down",label:`Down ${t?"":""}`,leader:p.jsx("span",{className:`${Me} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:p.jsx(It,{action:"towards"}),onSelect:$(Mt,"towards")}),p.jsxs("div",{className:`${Ve} col-span-3`,children:[p.jsx(H,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),p.jsx(H,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),p.jsx(Z,{id:"jump",label:"Jump",leader:p.jsx("span",{className:`${Me} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:p.jsx(It,{action:"jump"}),onSelect:$(Mt,"jump")}),p.jsx(Z,{id:"carry",label:"Carry",leader:p.jsx("span",{className:`${Me} texture-bag`}),valueElement:p.jsx(It,{action:"carry"}),onSelect:$(Mt,"carry"),hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:"**carrying is heels only**. requires the bag"}),hintInline:!0}),p.jsx(Z,{id:"fire",label:p.jsx(H,{className:`inline-block w-6 ${Ve}`,children:"fire dough- nuts"}),leader:p.jsx("span",{className:`${Me} texture-doughnuts`}),hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:"**firing doughnuts is head only**. requires the hooter"}),hintInline:!0,valueElement:p.jsx(It,{action:"fire"}),onSelect:$(Mt,"fire")}),p.jsx(Z,{id:"swop",label:"Swop",valueElement:p.jsx(It,{action:"swop"}),onSelect:$(Mt,"swop"),hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:p.jsxs("span",{className:`${Me} texture-blank relative overflow-hidden`,children:[p.jsx("span",{className:`${Me} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),p.jsx("span",{className:`${Me} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),p.jsx(Z,{id:"swopHead",label:p.jsx(H,{className:`inline-block w-6 ${Ve}`,children:"Swop to head"}),valueElement:p.jsx(It,{action:"swop.head"}),onSelect:$(Mt,"swop.head"),hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Me} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),p.jsx(Z,{id:"swopHeels",label:p.jsxs("div",{className:`w-6 ${Ve}`,children:[p.jsx(H,{className:"me-1",children:"Swop to"}),p.jsx(H,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:p.jsx(It,{action:"swop.heels"}),onSelect:$(Mt,"swop.heels"),hint:p.jsx(Ne,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Me} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),p.jsx(Z,{id:"map",label:"Map",valueElement:p.jsx(It,{action:"map"}),onSelect:$(Mt,"map"),leader:p.jsx("span",{className:`${Me} texture-scroll`})}),p.jsx(Z,{id:"hold",label:"Pause",valueElement:p.jsx(It,{action:"hold"}),onSelect:$(Mt,"hold")}),p.jsx(Z,{id:"toggleColourisation",label:p.jsx(H,{className:`inline-block w-6 ${Ve}`,children:"toggle colour- isation"}),valueElement:p.jsx(It,{action:"toggleColourisation"}),onSelect:$(Mt,"toggleColourisation")})]})},K2=()=>p.jsx(Z,{id:"controlOptions",label:"on-screen controls",valueElement:p.jsx(Nr,{value:LC()}),onSelect:$(tr,"userSettings.onScreenControls")}),X2=()=>{const t=!xb();At({action:"menu_openOrExit",handler:C.useCallback(()=>{be.dispatch(LP())},[]),disabled:t}),JI({handler:C.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&yb(be.getState())&&be.dispatch(UP(e))},[]),disabled:t})},J2=({showAll:t})=>p.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[p.jsx(H,{className:`block mb-1 ${Ve}`,children:"Detected that you are on a phone or tablet"}),p.jsx(H,{className:`block mb-1 ${Ve}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),p.jsx(H,{className:`block mb-1 text-midRed zx:text-zxRed ${Ve} mb-1`,onClick:t,children:"Tap here to show all settings"})]}),YA=df+" !gap-y-1 !sprites-normal-height",Z2=()=>{X2();const[t,e]=C.useState(!Ue()),r=wb();return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Oe)}),p.jsxs(_e,{tall:!0,wide:!0,className:"bg-white zx:bg-zxWhite pr-0 pl-1",children:[p.jsxs("div",{className:"flex flex-col gap-y-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+ff,children:[Ue()&&p.jsx(rn,{className:"mb-1"}),p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block",children:"control options"}),p.jsxs(Ce,{className:YA,children:[p.jsx(G2,{}),p.jsx(K2,{}),r!=="4-way"&&t&&p.jsx(U2,{})]}),t?p.jsxs(p.Fragment,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),p.jsxs(Ce,{className:YA,children:[p.jsx(Y2,{}),Ue()||p.jsx(Et,{})]})]}):p.jsx(p.Fragment,{children:p.jsx(J2,{showAll:()=>e(!0)})})]}),p.jsx(N2,{})]})]})},ez=({presetName:t})=>p.jsx(Z,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:ps[t].description,onSelect:$(HP,t)},t),tz=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Oe)}),p.jsx(_e,{className:"bg-white pl-1",children:p.jsxs(tn.Provider,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),p.jsxs(Ce,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[ix(ps).map(t=>p.jsx(ez,{presetName:t},t)),p.jsx(Os,{}),p.jsx(Et,{})]}),p.jsx(On,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),rz=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsx(_e,{className:"bg-pureBlack w-zx h-full block p-0",onClick:$(Oe),children:p.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[p.jsxs("div",{className:"flex gap-7",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),p.jsxs("div",{className:"flex flex-col items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_walking_towards_2 hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),p.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[p.jsx(H,{children:"The people salute your heroism"}),p.jsx(H,{children:"and proclaim you"})]}),p.jsx(H,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),p.jsx(Ce,{className:"hidden",children:p.jsx(Et,{})})]})})]}),nz=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),sz=({resolutionName:t})=>{const e=ae(Ja),r=Ss[t];return p.jsx(Z,{id:t,label:`${e===t?"* ":""}${nz(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:$(Md,t)},t)},iz=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Oe)}),p.jsx(_e,{className:"bg-white pl-1",children:p.jsxs(tn.Provider,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),p.jsxs(Ce,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[ix(Ss).map(t=>p.jsx(sz,{resolutionName:t})),p.jsx(Os,{}),p.jsx(Et,{})]}),p.jsx(On,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),oz="/Users/jim/dev/hohjs",az=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),n=[...t.matchAll(e)],s=[];return r.forEach((i,o)=>{s.push(i);const a=n[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){s.push(l);return}const u=`${oz}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),d=h?`:${h[1]}:${h[2]}`:"",f=`vscode://file${u}${d}`;s.push(p.jsx("a",{href:f,target:"_blank",children:c.pathname},o))}catch{s.push(a[0])}}),p.jsx(C.Fragment,{children:s})},lz=t=>{const{message:e,stack:r}=t;if(!r)return{message:e,sanitizedStack:""};const n=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,s=n.test(r);let i=r;s&&(i=i.replace(n,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},cz=`##The game crashed!
You could:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord server](https://discord.gg/XmV9QNWY)
* play [the msx remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,uz=({errors:t})=>{const e=ae(o=>o.gameMenus.gameInPlay.reincarnationPoint!==void 0),[r,n]=C.useState(!1),s=$(Nb),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=lz(o);return`
${a}

${l}
  `}).join(`
    

 ERROR        CAUGHT, WRAPPED, & RETHROWN 


`);return p.jsxs(Be,{children:[p.jsx(He,{className:"loading-border"}),p.jsx(_e,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,children:p.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[p.jsx(Ne,{markdown:cz}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsxs(Ce,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${Ve}`,children:[p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:$(sg,"ignore")}),e&&p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:s}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:$(sg,"clearAllData")}),r?p.jsx(H,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>n(!0))})]}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsx(H,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),p.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max min-w-full",children:p.jsx(az,{children:i})})]})})]})};var ou,KA;function pf(){if(KA)return ou;KA=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return ou=t,ou}var au,XA;function hz(){if(XA)return au;XA=1;var t=typeof io=="object"&&io&&io.Object===Object&&io;return au=t,au}var lu,JA;function Xw(){if(JA)return lu;JA=1;var t=hz(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return lu=r,lu}var cu,ZA;function dz(){if(ZA)return cu;ZA=1;var t=Xw(),e=function(){return t.Date.now()};return cu=e,cu}var uu,ey;function fz(){if(ey)return uu;ey=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return uu=e,uu}var hu,ty;function pz(){if(ty)return hu;ty=1;var t=fz(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return hu=r,hu}var du,ry;function Jw(){if(ry)return du;ry=1;var t=Xw(),e=t.Symbol;return du=e,du}var fu,ny;function mz(){if(ny)return fu;ny=1;var t=Jw(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,s=t?t.toStringTag:void 0;function i(o){var a=r.call(o,s),l=o[s];try{o[s]=void 0;var c=!0}catch{}var u=n.call(o);return c&&(a?o[s]=l:delete o[s]),u}return fu=i,fu}var pu,sy;function gz(){if(sy)return pu;sy=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return pu=r,pu}var mu,iy;function Az(){if(iy)return mu;iy=1;var t=Jw(),e=mz(),r=gz(),n="[object Null]",s="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?s:n:i&&i in Object(a)?e(a):r(a)}return mu=o,mu}var gu,oy;function yz(){if(oy)return gu;oy=1;function t(e){return e!=null&&typeof e=="object"}return gu=t,gu}var Au,ay;function xz(){if(ay)return Au;ay=1;var t=Az(),e=yz(),r="[object Symbol]";function n(s){return typeof s=="symbol"||e(s)&&t(s)==r}return Au=n,Au}var yu,ly;function bz(){if(ly)return yu;ly=1;var t=pz(),e=pf(),r=xz(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return n;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):s.test(c)?n:+c}return yu=l,yu}var xu,cy;function Zw(){if(cy)return xu;cy=1;var t=pf(),e=dz(),r=bz(),n="Expected a function",s=Math.max,i=Math.min;function o(a,l,c){var u,h,d,f,m,A,g=0,y=!1,b=!1,x=!0;if(typeof a!="function")throw new TypeError(n);l=r(l)||0,t(c)&&(y=!!c.leading,b="maxWait"in c,d=b?s(r(c.maxWait)||0,l):d,x="trailing"in c?!!c.trailing:x);function q(N){var D=u,U=h;return u=h=void 0,g=N,f=a.apply(U,D),f}function V(N){return g=N,m=setTimeout(S,l),y?q(N):f}function _(N){var D=N-A,U=N-g,w=l-D;return b?i(w,d-U):w}function v(N){var D=N-A,U=N-g;return A===void 0||D>=l||D<0||b&&U>=d}function S(){var N=e();if(v(N))return E(N);m=setTimeout(S,_(N))}function E(N){return m=void 0,x&&u?q(N):(u=h=void 0,f)}function R(){m!==void 0&&clearTimeout(m),g=0,u=A=h=m=void 0}function I(){return m===void 0?f:E(e())}function B(){var N=e(),D=v(N);if(u=arguments,h=this,A=N,D){if(m===void 0)return V(A);if(b)return clearTimeout(m),m=setTimeout(S,l),q(A)}return m===void 0&&(m=setTimeout(S,l)),f}return B.cancel=R,B.flush=I,B}return xu=o,xu}var qz=Zw();const wz=rt(qz);var bu,uy;function vz(){if(uy)return bu;uy=1;var t=Zw(),e=pf(),r="Expected a function";function n(s,i,o){var a=!0,l=!0;if(typeof s!="function")throw new TypeError(r);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(s,i,{leading:a,maxWait:i,trailing:l})}return bu=n,bu}var Vz=vz();const _z=rt(Vz),Sz=(t,e,r,n)=>{switch(e){case"debounce":return wz(t,r,n);case"throttle":return _z(t,r,n);default:return t}},kz=t=>{const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...r)=>{var n;return(n=e.current)===null||n===void 0?void 0:n.call(e,...r)},[])},Cz=t=>{const[e,r]=C.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:C.useMemo(()=>new Proxy(s=>{s!==e&&r(s)},{get(s,i){return i==="current"?e:s[i]},set(s,i,o){return i==="current"?r(o):s[i]=o,!0}}),[e]),refElement:e,setRefElement:r}},Pz=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function Ez({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:n,handleWidth:s=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=C.useRef(t),u=kz(l),[h,d]=C.useState({width:void 0,height:void 0}),{refProxy:f,refElement:m}=Cz(o),{box:A}=a||{},g=C.useCallback(b=>{if(!s&&!i)return;if(c.current){c.current=!1;return}const x=(q,V)=>s&&q.width!==V.width||i&&q.height!==V.height;b.forEach(q=>{const V=Pz(q,A);d(_=>x(_,V)?(u?.({width:V.width,height:V.height,entry:q}),V):_)})},[s,i,c,A]),y=C.useCallback(Sz(g,e,r,n),[g,e,r,n]);return C.useEffect(()=>{let b;return m?(b=new window.ResizeObserver(y),b.observe(m,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),d({width:void 0,height:void 0})),()=>{var x,q,V;(x=b?.disconnect)===null||x===void 0||x.call(b),(V=(q=y).cancel)===null||V===void 0||V.call(q)}},[y,m]),Object.assign({ref:f},h)}const ev=Re("head"),tv=Re("heels"),Ba=Re("headOverHeels"),Mr=(t,e)=>t.characterRooms[e]?.items[e],TL=t=>Mr(t,t.currentCharacterName),RL=t=>{if(ev(t))return t.state;if(Ba(t))return t.state.head},Tz=t=>{if(tv(t))return t.state;if(Ba(t))return t.state.heels},Rz=(t,e)=>{const r=Mr(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&ev(r)||e==="heels"&&tv(r))return r.state;if(e==="head"&&Ba(r))return r.state.head;if(e==="heels"&&Ba(r))return r.state.heels}},ML=Rz,mt={x:12,y:12,z:ue.h},Mz={x:14,y:14,z:ue.h},yn={x:16,y:16,z:ue.h},ca={...mt,z:ue.h*2},rv=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:mt};case"slidingBlock":return t.config.style==="book"?{aabb:yn}:{aabb:mt};case"lift":return{aabb:{...mt,z:mt.z}};case"switch":return{aabb:{...mt,z:mt.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:mt};case"charles":return{aabb:ca};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:yn};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:yn};case"tower":return{aabb:{x:11,y:11,z:ue.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...mt,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:ca};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:mt};case"turtle":return{aabb:mt};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:yn};case"bubbles":return{aabb:mt};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:yn};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:ue.h}:{x:15,y:3,z:ue.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:ca}:{aabb:mt};case"emitter":return{aabb:fe};default:return{aabb:Mz}}},ht={aabb:mt,castsShadowWhileStoodOn:!1},Iz=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,IL=({x:t=0,y:e=0})=>e-t,Qe=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),ze=({x:t=0,y:e=0,z:r=0})=>({x:t*ue.w,y:e*ue.d,z:r*ue.h}),jL=t=>Qe(ze(t)),Ch=t=>{const e=ze(t.position),{aabb:r}=rv(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:ee(e,{x:ue.w-r.x>>1,y:ue.d-r.y>>1})},De=Number.MIN_SAFE_INTEGER,We=Wi/1e3,OL={head:15e-5,heels:15e-5},BL=1e3/110,zL=240,jz=2e-4,Oz={head:ue.h*2/1e3,others:ue.h*6/1e3},NL=jz*.35,DL=Oz.others*.5,FL=.8,LL=.001,Bz={head:We,heels:2*We,charles:We,dalek:Math.SQRT2*We,bubbleRobot:(Math.SQRT2+1)/2*We,cyberman:1*We,skiHead:We,helicopterBug:We,homingBot:2*We,monkey:We,elephant:We,elephantHead:0,emperor:We,emperorsGuardian:Math.SQRT2*We,computerBot:We,turtle:We,ball:2*We,firedDoughnut:2*We,movingPlatform:We,floatingText:We},zz=(t=1)=>t*Wi/1e3,UL=zz(),HL=2,hy=1.1,$L={head:ue.h*2.6+hy,heels:ue.h+hy},Nz=10,WL=6e4,Dz=8,GL=750,QL=2500,YL=200,KL=.15,Fz=8,Lz=Bt.h-Bt.w/2,nv=Lz+2,mf=9999,ot=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:De,stoodOnUntilRoomTime:De}),zi=()=>({standingOnItemId:null,vels:{gravity:fe,movingFloor:fe},latentMovement:[],actedOnAt:{roomTime:De,by:ye},collidedWith:{roomTime:De,by:ye},controlledWithJoystickAtRoomTime:De}),Uz=t=>{const e=Eb.includes(t.type);return{...ot(),position:Ch(t),...e?{standingOnItemId:null,vels:{gravity:fe,movingFloor:fe,...Cb.includes(t.type)?{sliding:fe}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:fe}:{}},latentMovement:[],actedOnAt:{roomTime:De,by:ye},collidedWith:{roomTime:De,by:ye}}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:qe[t.config.startDirection]}:{facing:qe.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:qe[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:fe}}:{},...t.type==="charles"?{facing:qe.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:De,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?Lt(qe[t.config.direction],Bz.firedDoughnut):fe}}:{}}},XL=1e3,Vn=-2,qu=ue.h*2,Hz=4,Yo=ue.h*Hz,$z=2,Wz=.5,dy=2;function*Gz(t,e){const{config:{direction:r},position:n}=t,s=Uy(r),i=Dh(s),o=Iz(t),a={...fe,[i]:o?-.5:0},l=1,c={[i]:o?-1:0},u=l*ue.w,h={...fe,[i]:u},d=9,f=8,m=8;{const A={[s]:f,[i]:m,z:Yo};yield{...t,...ht,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...ot(),position:ze(ee(n,{[s]:1.5},a,c)),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[s]:d,[i]:m,z:Yo};yield{...t,...ht,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...ot(),position:ze(ee(n,a,c)),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[s]:2*ue.w-d-f,[i]:m,z:Yo-qu};yield{...t,...ht,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...ot(),position:ee(ze(ee(n,a,c)),{[s]:d,z:qu}),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}yield{...t,...ht,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...ot(),position:ee(ze(ee(n,a,c)),{z:Yo}),stoodOnBy:ye},aabb:ee(ze({[s]:2,[i]:l,z:mf}),{[i]:m}),renderAabb:fe,fixedZIndex:Vn},yield{...t,...ht,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Ci(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:ze({...fe,[i]:o?l+.25:-.25}),direction:qe[r]},fixedZIndex:Vn,state:{...ot(),position:ee(ze(ee(n,{[i]:o?-.5-l:.5})),{[s]:d}),stoodOnBy:ye},aabb:{[s]:$z*ue.w-d-f,[i]:u,z:qu}},n.z!==0&&(yield{...t,...ht,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:n.z},renders:!0,shadowCastTexture:o?{textureId:"shadow.door.floatingThreshold.double.y",flipX:s==="x"}:void 0,castsShadowWhileStoodOn:o,state:{...ot(),position:{...ze(ee(n,a,c)),z:0}},aabb:ee(ze({[s]:2,[i]:.5,z:n.z}),h),renderAabb:o?ee(ze({[s]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?ee({[s]:0,[i]:0,z:(n.z-.5)*ue.h},{[i]:h[i]}):void 0,shadowOffset:{z:n.z*ue.h,[i]:o?h[i]:void 0}}),yield{...ht,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:ze({[s]:2,[i]:dy,z:2}),config:{},fixedZIndex:Vn,state:{...ot(),position:ze(Pr(n,Lt(qe[r],Wz),o?fe:{[i]:dy})),stoodOnBy:ye}}}const za={config:ye,shadowCastTexture:"shadow.smallRound",castsShadowWhileStoodOn:!0,aabb:mt},Ni=()=>{const t=bb(be.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:qe.towards,walkStartFacing:qe.towards,walkDistance:0,vels:{walking:fe,gravity:fe,movingFloor:fe},switchedToAt:De,lastDiedAt:De,gameTime:0,jumpStartTime:De,lives:t?"infinite":Dz,jumpStartZ:0}},Qz=(t,e)=>{const r=qb(be.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...ht,...za,state:{...ot(),...zi(),...Ni(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:De,shieldCollectedAt:De,doughnuts:r?"infinite":0,position:Ch(t),stoodOnUntilRoomTime:De}}:{id:e,jsonItemId:e,type:"heels",...ht,...za,state:{...ot(),...zi(),...Ni(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:De,position:Ch(t),stoodOnUntilRoomTime:De}}},Yz=t=>t==="towards"||t==="right",gf=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),JL=t=>t.type==="wall"?gf(t.config):uP(t)?t.config.times:void 0,Ph=(t=La)=>({x:t.x??1,y:t.y??1,z:t.z??1}),ZL=t=>({x:t.x??1,y:t.y??1}),fy=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?Ph(gf(t.config)):e(t)?Ph(t.config.times):La},eU=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},Di=(t,e={})=>{const r=Ph(e),n=Pr(Jm,t);return Pr(Qv(r,Jm),n)},sv=1,Kz={x:ue.w,y:ue.d*sv,z:mf},Xz={x:ue.w,y:0,z:nv},Jz={x:ue.w*sv,y:ue.d,z:mf},Zz={x:0,y:ue.d,z:nv},eN=(t,e)=>{const{config:{direction:r},position:n}=e,s=gf(e.config),i=Uy(r),o=Dh(i),a=Yz(r),l={...fe,[o]:a?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Di(i==="y"?Jz:Kz,s),renderAabb:a?fe:Di(i==="y"?Zz:Xz,s),fixedZIndex:a?Vn:void 0,state:{...ot(),position:ze(ee(n,l)),stoodOnBy:ye},shadowCastTexture:i==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0},castsShadowWhileStoodOn:a}},tN=3,py=10,my=.52,gy=.5,rN=(t,e,r)=>{const{config:{times:n},position:s}=e,i=ee(s,{z:-3}),o={...n,z:tN};let a=i,l=o;const c=je(Rn(r.items)).filter(d=>d.type==="door");if(s.z===0){const d={};for(const f of c){const{position:m,config:{direction:A}}=f;switch(A){case"towards":!d.towards&&m.y===i.y&&m.x>=i.x&&m.x<=i.x+n.x-2&&(l=ee(l,{y:gy}),a=ee(a,{y:-.5}),d.towards=!0);break;case"away":!d.away&&m.y===i.y+n.y&&m.x>=i.x&&m.x<=i.x+n.x-2&&(l=ee(l,{y:my}),d.away=!0);break;case"right":!d.right&&m.x===i.x&&m.y>=i.y&&m.y<=i.y+n.y-2&&(l=ee(l,{x:gy}),a=ee(a,{x:-.5}),d.right=!0);break;case"left":!d.left&&m.x===i.x+n.x&&m.y>=i.y&&m.y<=i.y+n.y-2&&(l=ee(l,{x:my}),d.left=!0);break}}}const u=ze(a),h=Di(yn,l);return{...ht,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Di(yn,o),position:ze(i)}},aabb:h,renderAabb:{...h,z:py},renderAabbOffset:{...fe,z:h.z-py},shadowCastTexture:"shadow.fullBlock",state:{...ot(),position:u}}};function*Af(t,e,r,n=ye,s={},i=""){if(!n[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&s[e.config.page]))switch(!0){case e.type==="door":return yield*Gz(e,t);case e.type==="player":{yield Qz(e,t);return}case e.type==="wall":{yield eN(t,e);return}case e.type==="floor":{yield rN(t,e,r);return}case(e.type==="block"&&e.config.disappearing!==void 0&&$i(fy(e))>=2):{const o=fy(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=Ps(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=La});yield*Af(t,u,r,n,s,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!be.getState().gameMenus.gameInPlay.planetsLiberated[e.config.planet]):return;default:{const o=rv(e),a=e.config.times!==void 0?{aabb:Di(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=Uz(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...ht,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Vn:void 0,shadowCastTexture:nN(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const nN=t=>{switch(t.type){case"lift":case"switch":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Ly(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};let sN=0;const iN=({gameState:t,room:e,itemType:r,config:n,position:s})=>{const i={type:r,config:n,position:fe},o=`${r}/${sN++}`,a=LV(Af(o,i,e.roomJson,t.pickupsCollected[e.id]??ye));if(a===void 0)throw console.error("failed to generate any items for json",o,i),new Error("failed to generate any items");return a.state.position=s,Na({room:e,item:a}),a},Na=({room:t,item:e})=>(t.items[e.id]=e,e),yf=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0},oN=t=>{const e=Mr(t,"head"),r=Mr(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},aN=t=>{const e={id:"head",type:"head",...ht,...za,state:{...ot(),...zi(),...Ni(),...t.state.head,facing:t.state.facing,position:ee(t.state.position,{z:ue.h}),switchedToAt:De,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...ht,...za,state:{...ot(),...zi(),...Ni(),...t.state.heels,facing:t.state.facing,position:ee(t.state.position),switchedToAt:De,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},lN=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...ht,shadowCastTexture:e.shadowCastTexture,config:ye,aabb:ca,state:{...ot(),...zi(),...Ni(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...Ci(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:De},heels:{...Ci(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:De}}}),cN=t=>{const e=t.characterRooms.head,r=Mr(t,"head"),n=Mr(t,"heels"),s=lN({head:r,heels:n});Pn({room:e,item:"head"}),Pn({room:e,item:"heels"}),Na({room:e,item:s}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},uN=(t,e)=>{const r=t.characterRooms.headOverHeels,n=Mr(t,"headOverHeels"),s=e??ls(t.previousPlayable),{head:i,heels:o}=aN(n);Pn({room:r,item:"headOverHeels"}),Na({room:r,item:i}),Na({room:r,item:o}),yf({above:i,below:o}),t.currentCharacterName=s,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},hN=t=>{const e=Mr(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},ua=(t,e)=>{oN(t)&&(!e||e===t.currentCharacterName)?cN(t):t.currentCharacterName==="headOverHeels"?uN(t,e):(!e||e!==t.currentCharacterName)&&Mr(t,ls(t.currentCharacterName))!==void 0&&(t.currentCharacterName=ls(t.currentCharacterName)),hN(t)},dN=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(ua(t),!0):e.currentActionPress("swop.head")==="tap"?(ua(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(ua(t,"heels"),!0):!1},fN=()=>{const t=Ts(),[e,r]=C.useState(t.gameState.currentCharacterName);return C.useEffect(()=>{const n=()=>{r(t.gameState.currentCharacterName)};return _t.shared.add(n),()=>{_t.shared.remove(n)}},[t.gameState]),e},pN=()=>{const t=Ts();C.useEffect(()=>{const e=()=>{dN(t.gameState)};return _t.shared.add(e),()=>{_t.shared.remove(e)}},[t.gameState])},J=48,Sr=36,Fi=.55,vt=J*((1-Fi)/2),wt=J-vt,Li=8,ss=128,Vs=t=>Math.round(t*10)/10,xf=t=>{const e=Qe(t);return`translate(${Vs(e.x)},${Vs(e.y)})`},X=t=>{const e=Qe(t);return Ot(e)},Ot=t=>`${Vs(t.x)},${Vs(t.y)}`,iv=({svg:t=!1,smooth:e=!1})=>{const r=C.useRef(null);return C.useLayoutEffect(()=>{r.current?.scrollIntoView({behavior:e?"smooth":"instant",block:"center"})}),t?p.jsx("g",{ref:r}):p.jsx("div",{ref:r})},ha=({className:t,scrollTo:e=!1,onClick:r,yAdjust:n=0})=>p.jsxs("foreignObject",{x:-50,y:-100+n,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[p.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r,style:r?{pointerEvents:"all"}:{}}),e&&p.jsx(iv,{})]}),ci=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:n=!1,yAdjust:s=0,onClick:i})=>p.jsx(ha,{className:`${n?"[--scale:2.5]":"[--scale:1.5]"}
                ${qs({character:t,action:r?"walking":"idle",facingXy8:Uh(e)??"towards"})}`,scrollTo:r,yAdjust:s,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),mN=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return p.jsxs(p.Fragment,{children:[p.jsx(ha,{className:`${r} texture-lift_static`}),p.jsx(ha,{className:`${r} texture-lift_2`})]});const n=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return p.jsx(ha,{className:`${r} ${n}`})},gN=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],AN=({x:t,y:e},{x:r,y:n})=>(t-r)**2+(e-n)**2,yN=(t,e)=>{const r=t%3,n=Math.floor(t/3),s=e%3,i=Math.floor(e/3);return Math.abs(r-s)<=1&&Math.abs(n-i)<=1&&t!==e},Ay=t=>t.some((e,r)=>t.slice(r+1).some(n=>yN(e,n))),bi=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...n]=t;return[...bi(n,e),...bi(n,e-1).map(s=>[r,...s])]},ov=t=>t.length<=1?[t]:t.flatMap((e,r)=>ov([...t.slice(0,r),...t.slice(r+1)]).map(n=>[e,...n])),yy={1:bi([...Array(9).keys()],1),2:bi([...Array(9).keys()],2).filter(t=>!Ay(t)),3:bi([...Array(9).keys()],3).filter(t=>!Ay(t))},Eh=3,av=({items:t,itemNormalisedPosition:e})=>{const r=Gi(t),n=r.length;if(n===0)return ye;if(n>Eh)throw new Error(`roomItemPositions supports up to ${Eh} items, but got ${n}: ${Object.keys(t).join(", ")}`);const s=r.map(([a,l])=>({id:a,pos:e(l)}));let i=ye,o=1/0;if(yy[n]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${n}`);for(const a of yy[n]){const l=a.map(c=>gN[c]);for(const c of ov(l)){const u={};let h=0;for(let d=0;d<n;d++){const{id:f,pos:m}=s[d],A=c[d];u[f]=A,h+=AN(m,A)}h<o&&(o=h,i=u)}}return i},xN={x:1,y:1,z:1},Th=t=>ee(t.state.position,Lt(t.aabb,.5)),tU=t=>t,bN=t=>Rn(t.items),qN=t=>Gh(t),wN=t=>je(bN(t)),rU=(t,...e)=>{const r=je(qN(t));return e.length===0?r:r.filter(([,n])=>e.includes(n.type))},Rh=(t,e)=>e?.[t],hl=t=>Rn(t),Qt=t=>je(hl(t)),nU=t=>je(Gh(t)),sU=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),vN={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},iU=t=>Qt(t.items).reduce((e,r)=>{if(r.type==="floor"){const{config:{naturalFootprint:n},state:{position:s},renderAabb:i,renderAabbOffset:o,aabb:a}=r,l=Qe(ee(n.position,{x:n.aabb.x,z:n.aabb.z})).x,c=Qe(ee(n.position,{y:n.aabb.y,z:n.aabb.z})).x,u=Qe(ee(n.position,n.aabb)).y,h=Qe(ee(s,o??fe,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const n=Qe(ee(r.state.position,r.renderAabb??r.aabb??fe,r.renderAabbOffset??fe)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,n)},floors:e.floors}}},vN),VN={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},lv=t=>{const e=wN(t).filter(r=>r.type==="floor").reduce((r,n)=>{const{position:s,config:{times:i}}=n;return{from:{x:Math.min(r.from.x,s.x),y:Math.min(r.from.y,s.y),z:Math.min(r.from.z,s.z)},to:{x:Math.max(r.to.x,s.x+i.x),y:Math.max(r.to.y,s.y+i.y),z:Math.max(r.to.z,s.z)}}},VN);if(isFinite(e.from.x))return e},xy=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),cv=({items:t,positions:e,ItemComponent:r})=>p.jsx("g",{"data-class":"items",children:Gi(e).sort(([n,s],[i,o])=>o.y-s.y+(o.x-s.x)).map(([n,s])=>p.jsx("g",{"data-position":JSON.stringify(s),transform:`${xf(Fh(s,J*.5))} translate(0,-3)`,children:p.jsx(r,{item:t[n]})},n))}),_N=(t,e)=>{if(t==="*"){const r=lv(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},SN=({items:t,roomJson:e,subRoomId:r})=>{const n=C.useMemo(()=>av({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??ye,...xN},a=Ur(i.position,Lt(o,.5)),l=_N(r,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return p.jsx(cv,{ItemComponent:mN,items:t,positions:n})},kN=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:n,onClick:s})=>{const i=C.useMemo(()=>({item:{type:l,state:{facing:c}}})=>p.jsx(ci,{characterName:l,facing:c,isCurrent:n===l,onlyPlayableInRoom:!1,onClick:s}),[n,s]),o=C.useMemo(()=>({head:t,heels:e}),[t,e]),a=C.useMemo(()=>av({items:o,itemNormalisedPosition:c=>{const u=Th(c),h=Kv(Th(c),{x:1/ue.w,y:1/ue.d,z:1}),d=lv(r);if(d===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:xy(h.x,d.from.x,d.to.x),y:xy(u.y,d.from.y,d.to.y)}}}),[o,r]);return p.jsx(cv,{ItemComponent:i,items:o,positions:a})},Dr={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},CN=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.lightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},uv=t=>(t&&Dr[t])??{bgClassName:"fill-shadow",containerClassName:""},Kt=t=>({x:(t.x??0)*J,y:(t.y??0)*J,z:(t.z??0)*Sr}),hv=.15,Ko=Qe(Kt({x:.5,y:.5,z:0})),by=Qe(Kt({x:hv,y:0,z:0})),qy=Qe(Kt({x:hv*1.66,y:0,z:0})),PN=({className:t})=>p.jsxs(p.Fragment,{children:[p.jsx("ellipse",{className:"fill-white",cx:Ko.x,cy:Ko.y,rx:Math.abs(qy.x),ry:Math.abs(qy.y)}),p.jsx("ellipse",{className:t,cx:Ko.x,cy:Ko.y,rx:Math.abs(by.x),ry:Math.abs(by.y)})]}),EN=(t,e,r)=>{if(e==="*")return!0;const n=r.meta.subRooms[e];return t.x>=n.physicalPosition.from.x&&t.y>=n.physicalPosition.from.y&&t.x<=n.physicalPosition.to.x&&t.y<=n.physicalPosition.to.y},dv=({position:t},e,r)=>EN(t,e,r),TN=(t,e,r)=>{if(e==="*")return 0;const n=r.meta.subRooms[e],{from:s,to:i}=n.physicalPosition;if(t.x>=s.x&&t.y>=s.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<s.x?o=s.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<s.y?a=s.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},fv=(t,e,r)=>{const n=r.meta?.subRooms;if(n===void 0)return"*";let s,i=1/0;const o=e==="fine"?{x:t.x/ue.w,y:t.y/ue.d}:t;for(const a of Qh(n)){const l=TN(o,a,r);if(l===0)return a;l<i&&(i=l,s=a)}if(s===void 0)throw new Error(`item not found in any subroom of ${r.id}
      item at  ${JSON.stringify(o)}
      subrooms ${JSON.stringify(r.meta?.subRooms,null,2)}`);return s},RN=(t,e,r)=>dv(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),MN=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const n=Object.groupBy(r,i=>i[1].type),s=s0(e,ZV(...Rn(n)));return Object.fromEntries(s)},IN=(t,e,r)=>C.useMemo(()=>{let n=!1,s=!1;const i=je(Gi(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(n)return!1;n=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(s)return!1;s=!0}return!0}).filter(o=>RN(o[1],r,t));return MN(ks(i),Eh)},[t,e,r]),Gt=3,wy=Hy(Qe({x:J,y:0})),Xo={wall:void 0,open:"0,999",doorway:`${Vs(wy*((1-Fi)/2)-Gt/2)}, ${Vs(wy*Fi+Gt)}, 999`},wu=`
M ${X({})}
L ${X({y:J})}
L ${X({x:J,y:J})}
L ${X({x:J})}
z`,Jo=(t,e=Fi)=>{const r=J*((1-e)/2),n=J-r,s=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${X({x:r,y:r})}`;return a&&(l+=`L${X({x:0,y:r})} L${X({x:0,y:n})}`),l+=`L${X({x:r,y:n})}`,s&&(l+=`L${X({x:r,y:J})} L${X({x:n,y:J})}`),l+=`L${X({x:n,y:n})}`,o&&(l+=`L${X({x:J,y:n})} L${X({x:J,y:r})}`),l+=`L${X({x:n,y:r})}`,i&&(l+=`L${X({x:n,y:0})} L${X({x:r,y:0})}`),l+="z",l},vu=4,jN=je(ex(vu)).map(t=>`
M${X({x:J*((t+.5)/vu),y:0})}
L${X({x:J*((t+.5)/vu),y:J})}`).toArray().join(""),vy=t=>{const e=`
M${X({x:0,y:J})}
L${X({x:0,y:J,z:Sr})}
L${X({x:J,y:J,z:Sr})}
L${X({x:J,y:J})}
z
`;return t?e+`
M${X({x:vt,y:J})}
L${X({x:vt,y:J,z:Sr})}
L${X({x:wt,y:J,z:Sr})}
L${X({x:wt,y:J})}
L${X({x:vt,y:J})}`:e},ON=`            
M${X({x:J,y:J,z:Sr})}            
L${X({x:J,y:J})}            
M${X({x:J,y:0,z:Sr})}            
L${X({x:J,y:0})}            
M${X({x:0,y:J,z:Sr})}            
L${X({x:0,y:J})}            
`,BN=`            
M${X({x:0,y:0,z:Sr})}            
L0, 0            
`,zN=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:n,roomVisited:s,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:d,color:f,items:m}=n,A=n.meta?.label,g=IN(n,r,e),y=Object.values(m).filter(q=>q.type==="floor"),b=y.every(q=>q.config.floorType==="none"),x=y.some(q=>q.config.floorType==="deadly");return p.jsxs("g",{"data-room-id":h,strokeWidth:Gt,className:CN(f),children:[b?p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${wu} ${Jo(t)}`}),p.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${Jo(t)} ${Jo(t,Fi*.7)}`})]}):p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:wu}),p.jsx("path",{className:"fill-white",d:Jo(t)}),x&&p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:jN})]}),n.id==="blacktooth11"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${X({x:vt,y:vt})}
L${X({x:wt,y:vt})}
L${X({x:wt,y:vt-Gt*2})}
L${X({x:vt,y:vt-Gt*2})}
z
M${X({x:vt,y:wt})}
L${X({x:wt,y:wt})}
L${X({x:wt,y:wt+Gt*2})}
L${X({x:vt,y:wt+Gt*2})}
z
`}):n.id==="moonbase20"||n.id==="moonbase23"?p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Gt*2,d:`
M${X({x:vt,y:J/2})}
L${X({x:wt,y:J/2})}

M${X({x:J/2,y:vt})}
L${X({x:wt,y:J/2})}

M${X({x:J/2,y:wt})}
L${X({x:wt,y:J/2})}
`}):n.id==="blacktooth77"||n.id==="safari26"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${X({x:J/2-Gt,y:0})}
L${X({x:J/2+Gt,y:0})}
L${X({x:J/2+Gt,y:J})}
L${X({x:J/2-Gt,y:J})}
z
`}):null,d&&p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:vy(t.away==="doorway")}),p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:vy(t.left==="doorway")})]}),p.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[p.jsx("path",{d:`M${X({x:0,y:J})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:Xo[t.right]}),p.jsx("path",{d:`M${X({x:J,y:0})} L${X({x:J,y:J})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:Xo[t.left]}),p.jsx("path",{d:`M${X({x:J,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:Xo[t.towards]}),p.jsx("path",{d:`M${X({x:0,y:J})} L${X({x:J,y:J})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:Xo[t.away]})]}),s&&p.jsx(PN,{className:"fill-[var(--roomHintColor)]"}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:ON}),i&&o?p.jsx(kN,{roomJson:n,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?p.jsx(ci,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?p.jsx(ci,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?p.jsxs(p.Fragment,{children:[p.jsx(ci,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),p.jsx(ci,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):p.jsx(SN,{roomJson:n,subRoomId:e,items:g}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:BN}),A&&p.jsx("g",{transform:xf(Kt(Ur(A.gridOffset,{x:.5,y:.5}))),children:p.jsx("foreignObject",{width:A.text.length*16,height:16,y:-8,x:A.align==="left"?0:A.text.length*-16,children:p.jsx(H,{noTint:!0,className:"[--scale:2] [--block:16px]",children:A.text})})}),u?p.jsx("path",{className:"fill-transparent cursor-pointer",d:wu,onClick:()=>{u(h)}}):null]})},xn=({mapTitle:t,y:e=0,className:r,textOnly:n=!1})=>{const s=Zi();return p.jsxs("g",{className:r,children:[n||p.jsx("rect",{y:e,width:1e4,height:1e4}),p.jsx("foreignObject",{width:s*(t.length+3)*8,height:s*16*3,x:Li,y:e+16,children:p.jsx(H,{className:`left-2 relative sprites-double-height ${Ve}`,children:t})})]})},NN=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const n=Zi(),s=e.r-e.l+2*Li,i={x:-e.l+Li+(r-s)/2,y:-e.t+ss},o=(x,q=fe)=>Ur(i,Qe(Kt(ee(t[x].gridPosition,q)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),d=o("blacktooth53market/*",{x:0,y:1,z:0}),f=o("blacktooth53market/*",{x:1,y:1,z:0}),m=o("blacktooth52market/*",{x:1,y:.5,z:0}),A=n*8*2,g="Market",y=(g.length+3)*n*8,b=n*8*2+32;return p.jsxs(p.Fragment,{children:[p.jsx("path",{className:`${Dr.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Ot({x:A,y:m.y+b})}
L ${Ot({x:y,y:m.y+b})}
L ${Ot({x:y,y:a.y})}
L ${Ot(a)}
L ${Ot(l)}
L ${Ot(c)}
L ${Ot(u)}
L ${Ot(h)}
L ${Ot(d)}
L ${Ot(f)}
L ${Ot(m)}
L ${Ot({...m,x:A})}
z`}),p.jsx(xn,{y:m.y,mapTitle:g,className:Dr.market.bgClassName,textOnly:!0})]})},DN=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const n=t,s=Qe(Kt({x:1,y:1,z:0})).y,i=(o,a)=>{if(n[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(n[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=Qe(Kt(n[o].gridPosition)).y,c=Qe(Kt(n[a].gridPosition)).y+s;return(l+c)/2};return p.jsxs(p.Fragment,{children:[p.jsx(xn,{y:0,mapTitle:"Freedom",className:Dr.freedom.bgClassName}),p.jsx(xn,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+ss,mapTitle:"Castle Blacktooth",className:Dr.blacktooth.bgClassName}),p.jsx(xn,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+ss,mapTitle:"moonbase",className:Dr.moonbase.bgClassName}),p.jsx(xn,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+ss,mapTitle:"Blacktooth escape",className:Dr.blacktooth.bgClassName}),p.jsx(NN,{mapBounds:e,originalCampaignPositions:n,containerWidth:r}),p.jsx(xn,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+ss,mapTitle:"Jail",className:Dr.jail.bgClassName})]})},FN={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},LN=t=>{const{campaign:e,curRoomId:r}=t,n=e.locator.userId===Sb&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),s=uv(t.curRoomScenery);return n?p.jsx(DN,{...t}):p.jsx(xn,{mapTitle:FN[e.rooms[r].planet],className:s.bgClassName})},Vu=(t,e,r,n)=>{const s=Rh(e,t[e]?.items);return s&&r===t[e].roomJson.id&&n===fv(s.state.position,"fine",t[e].roomJson)?s:void 0},UN=t=>{const{campaign:e,pickupsCollected:r,gridPositions:n,currentCharacterName:s,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const d=o.r-o.l+2*Li,f=o.b-o.t+2*ss,m=Object.values(n);return p.jsxs("svg",{className:"w-full",style:{minWidth:`${d}px`,height:`${f}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:p.jsx(LN,{...t,curRoomId:u,containerWidth:a}),p.jsx("g",{transform:`translate(${-o.l+Li+(a-d)/2},${-o.t+128})`,children:m.map(A=>{const{roomId:g,subRoomId:y,gridPosition:b}=A,x=`${g}/${y}`;return p.jsxs("g",{"data-id":x,transform:xf(Kt(b)),children:[p.jsx(zN,{roomGridPositionSpec:A,roomPickupsCollected:r[g]??ye,roomJson:e.rooms[g],headItemInRoom:Vu(i,"head",g,y),heelsItemInRoom:Vu(i,"heels",g,y),headOverHeelsItemInRoom:Vu(i,"headOverHeels",g,y),currentCharacterName:s,roomVisited:l[g]??!1,onPlayableClick:c,onRoomClick:h}),u===g?p.jsx(iv,{svg:!0,smooth:!0}):null]},x)})})]})},HN=t=>t.characterRooms[t.currentCharacterName],bf=({aabb:t,state:{position:e}},{aabb:r,state:{position:n}})=>!(e.x+t.x<=n.x||e.x>=n.x+r.x)&&!(e.y+t.y<=n.y||e.y>=n.y+r.y)&&!(e.z+t.z<=n.z||e.z>=n.z+r.z),qf=(t,e)=>[...je(e).filter(r=>t.id!==r.id&&bf(t,r))];function*$N(t,e){if(t.roomBelow!==void 0)for(const r of Qt(e).filter(Ju)){const{config:{naturalFootprint:n}}=r;yield{...ht,type:"portal",id:"floor/portal",fixedZIndex:Vn,config:{toRoom:t.roomBelow,relativePoint:{x:n.aabb.x/2,y:n.aabb.y/2,z:n.aabb.z},direction:qe.down},aabb:n.aabb,state:{...ot(),position:n.position},renders:!1}}if(t.roomAbove!==void 0)for(const r of Qt(e).filter(Ju)){const{config:{naturalFootprint:n}}=r;yield{...ht,type:"portal",id:`${r.id}/ceilingPortal`,fixedZIndex:Vn,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?ze(t.ceilingRelativePoint):{x:n.aabb.x/2,y:n.aabb.y/2},z:-12},direction:qe.up},aabb:{...n.aabb,z:ue.h},state:{...ot(),position:ee(n.position,{z:n.aabb.z},{z:ue.h*(t.height??Nz)})}}}}const WN=(t,e,r,n)=>{const s=Math.max(0,Math.min(t.x+e.x,r.x+n.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+n.y)-Math.max(t.y,r.y));return s*i},Vy=({state:{position:t},aabb:e},{state:{position:r},aabb:n})=>WN(t,e,r,n),_y=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),Sy={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},pv=(t,e)=>Sy[t.type]-Sy[e.type],GN=(t,e)=>e.toSorted((r,n)=>{const s=pv(r,n);if(s!==0)return s;const i=da(t,_y(t,r)),o=da(t,_y(t,n));return Math.abs(i-o)<1e-4?r.id<n.id?-1:1:i-o}),QN=(t,e,r=.001)=>{if(!Pi(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:n}}}}=t;return n>0?!1:bf({state:{position:ee(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+ui},id:t.id},{state:{position:ee(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},YN=(t,e)=>{const n=[...je(e).filter(i=>QN(t,i))];return n.length===0?void 0:n.reduce((i,o)=>{const a=pv(o,i);return a<0||a===0&&Vy(t,o)>Vy(t,i)?o:i})};function*KN(t,e,r,n){const s=Gi(t.items);for(const[i,o]of s)o.type==="player"&&!n||(yield*Af(i,o,t,e,r))}const ky=t=>je(t).reduce((e,r)=>({...e,[r.id]:r}),{}),Mh=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:n=!1})=>{const s=ky(KN(t,e,r,n)),i={...ky($N(t,s)),...s};for(const a of Qt(i)){const c=qf(a,hl(i)).find(u=>Pi(a)&&Pi(u)&&!(a.type==="wall"&&u.type==="wall"));c!==void 0&&console.error(`in room ${t.id} item ${a.id} @${JSON.stringify(a.state.position)} #${JSON.stringify(a.aabb)} is colliding with (solid item) ${c.id} @${JSON.stringify(c.state.position)} #${JSON.stringify(c.aabb)} on loading room ${t.id}`)}for(const a of Qt(i).filter(cs)){const l=YN(a,Qt(i).filter(c=>c.id!==a.id));l!==void 0&&yf({above:a,below:l})}return{...t,roomJson:t,items:i,roomTime:0}},Ih=({state:{position:t,facing:e,autoWalk:r,action:n,vels:s}})=>({position:t,facing:e,autoWalk:r,action:n,vels:{...s}}),XN=()=>Rs().get("cheats")==="1",JN=(t,e)=>{const r=new URL(e),n=r.hash.substring(1);if(n!==""&&t.rooms[n]!==void 0)return r.hash.substring(1)},ZN=1e3/25,mv=t=>{const e=er.animations[t],r=e.length,{animationSpeed:n}=e;return r*ZN/n};mv("bubbles.white");const eD=mv("head.fadeOut"),tD=({touchedItem:t,room:e,gameState:r})=>{Pn({room:e,item:t});const n=iN({itemType:"bubbles",config:{style:"white",was:t.type==="pickup"?{type:"pickup",gives:t.config.gives}:t.type==="hushPuppy"?{type:"hushPuppy"}:{type:"disappearing"}},position:fe,room:e,gameState:r}),s=Th(t);n.state.position=Pr(s,Lt(n.aabb,.5)),n.state.expires=e.roomTime+eD},rD=(t,e)=>{const r=Qt(t.items).filter(Re("hushPuppy"));for(const n of r)tD({touchedItem:n,gameState:e,room:t})},nD=.5,sD=(t,e,r,n)=>t.x<r.x+n.x&&t.x+e.x>r.x&&t.y<r.y+n.y&&t.y+e.y>r.y&&t.z<r.z+n.z&&t.z+e.z>r.z,iD=(t,e,r,n,s)=>{if($i(s)<1e-4)return{x:0,y:0,z:0};const o=bn(s);if(!sD(t,e,r,n))return{x:0,y:0,z:0};let a=-1/0,l=1/0;for(const c of Zv){const u=o[c];if(Math.abs(u)<1e-4){const x=t[c],q=t[c]+e[c],V=r[c],_=r[c]+n[c];if(q<=V||x>=_)return{x:0,y:0,z:0};continue}const h=r[c],d=r[c]+n[c],f=t[c],m=t[c]+e[c],A=(h-m)/u,g=(d-f)/u,y=Math.min(A,g),b=Math.max(A,g);a=Math.max(a,y),l=Math.min(l,b)}return a>l?{x:0,y:0,z:0}:l>0&&(a>=0||l<-a)?Lt(o,l):a<0?Lt(o,a):{x:0,y:0,z:0}},jh=(t,e,r,n)=>{const s=r.x+n.x-t.x,i=r.y+n.y-t.y,o=r.z+n.z-t.z,a=t.x+e.x-r.x,l=t.y+e.y-r.y,c=t.z+e.z-r.z,u=Math.abs(s)<Math.abs(a)?s:-a,h=Math.abs(i)<Math.abs(l)?i:-l,d=Math.abs(o)<Math.abs(c)?o:-c,f=Math.abs(u),m=Math.abs(h),A=Math.abs(d)*nD;return f<m&&f<A?{x:u,y:0,z:0}:m<A?{x:0,y:h,z:0}:{x:0,y:0,z:d}},oD=(t,e,r)=>{const{actedOnAt:n}=e.state;n.roomTime===r.roomTime?t&&(n.by[t.id]=!0):(n.by=t?{[t.id]:!0}:{},n.roomTime=r.roomTime)},aD=(t,e,r,n)=>{const s=kb(t,e,r),i=jh(t.state.position,t.aabb,e.state.position,e.aabb);if(s&&i.z===0){const o=Pr(n,t.state.position),a=Yv(o);if(da(i,o)/a>.44)return iD(t.state.position,t.aabb,e.state.position,e.aabb,{...o,z:0})}return i},gv=({subjectItem:t,posDelta:e,gameState:r,room:n,pusher:s,deltaMS:i,forceful:o=Re("lift")(t)&&s===void 0,recursionDepth:a=0,onTouch:l})=>{if(Lh(e,fe))return;const{state:{position:c}}=t;t.state.position=ee(c,e),cs(t)&&oD(s,t,n);const u=GN(e,qf(t,hl(n.items)));for(const h of u){if(!bf(t,h))continue;if(s!==h&&l!==void 0&&l({movingItem:t,touchedItem:h,movementVector:Pr(t.state.position,c),gameState:r,deltaMS:i,room:n,recursionDepth:a+1}),n.items[t.id]===void 0)return;if(n.items[h.id]===void 0||!Pi(h,t)||!Pi(t))continue;const d=kb(t,h,o),f=aD(t,h,o,c),m=Lr($i(jh(c,t.aabb,h.state.position,h.aabb)),0);if(d&&h!==s){const A=o||iP(h)?-1:-.5,g=Lt(f,A);if(t.state.position=ee(t.state.position,f,g),a<Fz?gv({subjectItem:h,posDelta:g,pusher:t,gameState:r,room:n,deltaMS:i,forceful:o,recursionDepth:a+1,onTouch:l}):console.warn("hit recursion depth limit",new Error),n.items[h.id]===void 0)continue;t.state.position=ee(t.state.position,jh(t.state.position,t.aabb,h.state.position,h.aabb))}else t.state.position=ee(t.state.position,f);if(cs(t)&&f.z>0&&(t.state.standingOnItemId===null||!u.includes(_b(t.state.standingOnItemId,n)))&&(Zu(t,n),yf({above:t,below:h})),cs(t)&&!m){const{collidedWith:A}=t.state;A.roomTime===n.roomTime?s&&(A.by[h.id]=!0):(A.by={[h.id]:!0},A.roomTime=n.roomTime)}}},lD=(t,e,{changeType:r,sourceItem:n})=>{switch(r){case"portal":return Qt(t.items).find(s=>ts(s)&&s.config.toRoom===e.id&&(n.config.toDoor===void 0||s.jsonItemId===n.config.toDoor)&&Lh(Lt(n.config.direction,-1),s.config.direction));case"level-select":return Qt(t.items).find(s=>ts(s)&&s.config.toRoom===e.id&&s.config.direction.z===0)??Qt(t.items).find(s=>ts(s)&&s.config.direction.z===0)??Qt(t.items).find(s=>ts(s)&&s.config.direction.z>0)??Qt(t.items).find(ts)}},cD=(t,e,r,n)=>{const s=1*ue.w;t.state.position=ee(t.state.position,Lt(e,s));for(let i=0;i<s;i++)gv({subjectItem:t,posDelta:Lt(e,-1),gameState:r,room:n,deltaMS:16,forceful:!0,onTouch:void 0})},uD=t=>{const{playableItem:e,gameState:r,toRoomId:n,changeType:s,sourceItem:i}=t,o=r.characterRooms[e.id];if(o===void 0)throw new Error(`${e.id} is not in a room on the gameState`);if(n===o.id)throw new Error(`Can't move ${e.id} to the same room "${n}""`);let a;switch(s){case"portal":{const{config:{relativePoint:m},state:{position:A}}=i;a=Pr(e.state.position,ee(A,m));break}case"teleport":{const{state:{position:m}}=i;a=Pr(e.state.position,m);break}case"level-select":a={x:0,y:0,z:0};break;default:throw new Error}const l=e.type==="headOverHeels"?void 0:r.characterRooms[ls(e.id)],u=vb(be.getState()).rooms[n];if(u===void 0)throw new Error(`room ${n} does not exist in campaign`);const h=l?.id===n?l:Mh({roomJson:u,roomPickupsCollected:r.pickupsCollected[n]??ye,scrollsRead:be.getState().gameMenus.gameInPlay.scrollsRead});Pn({room:o,item:e});const d=Tz(e);if(d!==void 0&&(d.carrying=null),e.state.latentMovement=[],(e.type==="head"||e.type==="headOverHeels")&&rD(h,r),Pn({room:h,item:e}),h.items[e.id]=e,r.characterRooms[e.id]=h,t.changeType==="teleport"){const{config:{toPosition:m}}=t.sourceItem;e.state.position=ee(ze(m),a)}else{const m=lD(h,o,t);if(console.log("putting",e.id,"into",n,"at portal",m,"because",s,"sourceportal",i),m===void 0)if(t.changeType==="level-select")e.state.position=ze({x:1,y:1,z:8});else throw new Error(`trying to move ${e.id} from ${o.id} --to-> ${n} but no destination portal found to locate with`);else{e.state.position=ee(m.state.position,m.config.relativePoint,a,s==="portal"&&i.config.direction.z>0?{z:ue.h}:{});const{config:{direction:A}}=m;A.z===0&&(e.state.autoWalk=!0,e.state.facing=Lt(A,-1),e.state.action==="idle"&&(e.state.action="moving"),cD(e,A,r,h))}}const f=qf(e,je(hl(h.items)).filter(m=>m.type!=="portal"));f.length>0&&console.warn("on entering room",n,"character",e.id,"at",e.state.position,"collides with",f),r.entryState[e.id]=Ih(e),e.id==="headOverHeels"?(delete r.entryState.head,delete r.entryState.heels):(r.entryState[ls(e.id)]||(r.entryState[ls(e.id)]=r.entryState.headOverHeels),delete r.entryState.headOverHeels),be.dispatch(GP(n)),be.dispatch(NP({characterName:e.type,roomId:n}))},Av=t=>{const e={};for(const r of Object.values(t.rooms))for(const n of Object.values(r.items))if(n.type==="player"){const{which:s}=n.config;if(e[s]!==void 0)throw new Error(`Campaign has duplicate starting rooms for ${s}`);e[s]=r.id}return e},hD=t=>{const e=Av(t),r={...e};if(e.head===void 0&&e.heels===void 0)throw new Error("couldn't find either head or heels in campaign");let n=Rs().get("playAsHeels")==="1"?"heels":e.head!==void 0?"head":"heels";const s=XN()?JN(t,window.location.href):void 0;return s!==void 0&&(r[n]=s),r.head===void 0&&(n="heels"),{campaignStartingRoomIds:e,startingRoomIds:r,startAs:n,changedCharacterRoomFromCampaign:s!==void 0&&e[n]!==r[n]}},dD=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:n={}})=>{if(r){const m=r.gameState.characterRooms,A=Xu(m);return m.head!==void 0&&m.head?.id===m.heels?.id&&(A.heels=A.head),Object.assign(n,{inputStateTracker:e,gameSpeed:1,...Xu(r.gameState),characterRooms:A})}const{startAs:s,startingRoomIds:i,campaignStartingRoomIds:o,changedCharacterRoomFromCampaign:a}=hD(t),l={roomPickupsCollected:ye,scrollsRead:ye,isNewGame:!0},c=o.head&&Mh({roomJson:t.rooms[o.head],...l}),u=o.heels===o.head?c:o.heels&&Mh({roomJson:t.rooms[o.heels],...l}),h=c===void 0?void 0:Rh("head",c?.items),d=u===void 0?void 0:Rh("heels",u?.items),f=Object.assign(n,{inputStateTracker:e,gameSpeed:1,currentCharacterName:s,entryState:{head:h===void 0?void 0:Ih(h),heels:d===void 0?void 0:Ih(d)},pickupsCollected:{},gameTime:0,progression:0,characterRooms:{head:c,heels:u,headOverHeels:void 0}});return a&&uD({changeType:"level-select",gameState:f,playableItem:s==="head"?h:d,toRoomId:i[s],sourceItem:void 0}),f},oU=t=>{try{return dD(t)}catch(e){throw new Error("failed to load game state",{cause:e})}},fD=Qe(Kt({x:1,y:1,z:1})).y,Cy=Qe(Kt({x:0,y:1,z:0})).x,pD=t=>t.reduce((e,{gridPosition:r})=>{const n=Qe(Kt(r));return{t:Math.min(e.t,n.y+fD),b:Math.max(e.b,n.y),l:Math.min(e.l,n.x-Cy),r:Math.max(e.r,n.x+Cy)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),Zo=(t,e,r,n)=>e.some(s=>s.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:s})=>Xv(qe[t],Gv(s,n)))?"open":"wall";function*ns(t){try{yield*mD(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*mD({roomId:t,subRoomId:e="*",campaign:r,visited:n={},vectorFromPrevious:s,previousRoomGridPosition:i=fe}){if(t==="nowhere"||n[t]?.[e])return;n[t]===void 0&&(n[t]={}),n[t][e]=!0;const o=r.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...je(Rn(o.items)).filter(f=>f.type==="door").filter(f=>dv(f,e,o))],l=ee(i,s===void 0?Jv:s),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:Zo("left",a,c,u),right:Zo("right",a,c,u),away:Zo("away",a,c,u),towards:Zo("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:m}]of je(Gi(c)))f!==e&&(yield*ns({roomId:t,subRoomId:f,campaign:r,visited:n,vectorFromPrevious:Pr({...m,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:m}=o;yield*ns({roomId:f,subRoomId:m,campaign:r,visited:n,vectorFromPrevious:qe.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:m}=o;yield*ns({roomId:f,subRoomId:m,campaign:r,visited:n,vectorFromPrevious:qe.down,previousRoomGridPosition:l})}for(const f of a){const{toRoom:m}=f.config;try{yield*ns({roomId:m,campaign:r,visited:n,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:qe[f.config.direction],previousRoomGridPosition:l})}catch(A){throw new Error(`error while traversing door ${JSON.stringify(f,null,2)} in room ${t} to room ${m}`,{cause:A})}}const d=o.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:f},gridOffset:m}=d;yield*ns({roomId:f,campaign:r,visited:n,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const gD=t=>{const r=[...t].sort(({gridPosition:n},{gridPosition:s})=>n.z!==s.z?n.z-s.z:s.x+s.y-(n.x+n.y)).map(n=>[`${n.roomId}/${n.subRoomId}`,n]);return ks(r)},AD=()=>{const t=fN(),e=UC(),{gameState:r}=Ts(),n=Vb();return C.useMemo(()=>{try{const s=HN(r),i=s?.roomJson.id??Av(n).head;let o;if(!r)o="*";else if(!s?.roomJson.meta?.subRooms)o="*";else{const u=s?.items[t];u?o=fv(u.state.position,"fine",s.roomJson):o="*"}const a=[...ns({campaign:n,roomId:i,subRoomId:o})],l=gD(a);return{mapBounds:pD(a),curRoomId:s?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:r.pickupsCollected,characterRooms:r.characterRooms,campaign:n,roomsExplored:e,curRoomScenery:s?.planet}}catch(s){throw new Error("error getting map data",{cause:s})}},[n,t,r,e])},yD=()=>{const{ref:t,width:e}=Ez(),r=cw(),n=Ts();pN();const s=AD(),i=uv(s.curRoomScenery);return p.jsx(Be,{children:p.jsx(_e,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:$(Oe),children:p.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:r,children:p.jsx(UN,{onPlayableClick:o=>ua(n.gameState,o),containerWidth:e,...s})})})})},xD=()=>{const t=ae(DC),e=ae(FC);return p.jsxs(p.Fragment,{children:[p.jsx(He,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Oe)}),p.jsx(_e,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+ff,children:[Ue()&&p.jsx(rn,{className:"text-highlightBeige"}),p.jsx(H,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Sound Options"}),p.jsxs(Ce,{className:df,children:[p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"mute",label:"Mute",valueElement:p.jsx(Nr,{value:t}),onSelect:$(tr,"userSettings.soundSettings.mute")}),p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"footsteps",label:"Footstep sounds",valueElement:p.jsx(Nr,{value:!t&&!e}),onSelect:$(tr,"userSettings.soundSettings.noFootsteps"),disabled:t}),p.jsx(Os,{}),Ue()||p.jsx(Et,{})]}),Ue()||p.jsx(On,{className:"text-moss zx:text-zxGreen"})]})})]})},bD=()=>p.jsx(Be,{children:p.jsxs(_e,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:$(Oe),children:[p.jsx(H,{className:`${Ve} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You dont go towards the light"}),p.jsx(H,{className:`${Ve} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),p.jsx(H,{className:`${Ve} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),p.jsx(H,{className:`${Ve} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),p.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),p.jsx(Ce,{className:"hidden",children:p.jsx(Et,{})})]})}),qD=`##*HoH-ed * The Level editor
I built an *editor* so I could make the **sequel levels**

![](texture-headlessBase?float-left)**Make puzzles**!

*Challenge* others to **solve them**!

**in beta**; expect occasional crashes and *frequent confusion*`,wD=()=>{const t=C.useCallback(()=>{window.location.href="/editor/"},[]);return p.jsxs(Be,{children:[p.jsx(He,{className:"bg-pureBlack zx:bg-zxBlack",onClick:$(Oe)}),p.jsx(_e,{className:"bg-shadowHalfbrite zx:bg-zxBlack px-1",children:p.jsx(tn.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[Ue()&&p.jsx(rn,{className:"text-midGrey zx:text-zxWhite"}),p.jsx("div",{children:p.jsx(Ne,{className:"text-midGrey zx:text-zxWhite",markdown:qD})}),p.jsxs(Ce,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[p.jsx(Z,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),Ue()||p.jsx(Et,{customLabel:"Im scared, go back"})]}),Ue()||p.jsx(On,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},vD="2924c962-99f1-4dd2-9b9c-fef832dc991b",VD=t=>p.jsxs(Be,{children:[p.jsx(He,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:$(Oe)}),p.jsx(_e,{tall:!0,className:"bg-metallicBlueHalfbrite text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:p.jsxs(tn.Provider,{children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[Ue()&&p.jsx(rn,{className:"text-highlightBeige"}),p.jsx(H,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-4",children:"Select which game"})]}),p.jsx("div",{className:"zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:p.jsxs(Ce,{className:"gap-y-1",children:[p.jsx(Z,{id:"originalGame",label:"original remastered",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(ka,{campaignLocator:tP}),leader:p.jsx("span",{className:`${Me} sprite texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ne,{className:"text-lightGrey sprites-normal-height",markdown:"remaster of the **300-some** rooms from the original game"})}),p.jsx(Z,{id:"remake",label:"Sequel (Beta)",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(ka,{campaignLocator:{userId:vD,campaignName:"sequel",version:-1}}),leader:p.jsx("span",{className:`${Me} sprite texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ne,{className:"text-lightGrey sprites-normal-height",markdown:"the story continues **38 years later**: All-new levels designed for the remake"})}),p.jsx(Z,{id:"community",label:"Community contributed",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(yt,"communityGames"),leader:p.jsx("span",{className:`${Me} sprite texture-charles_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ne,{className:"text-lightGrey sprites-normal-height",markdown:"check out what people have made in the editor"})}),p.jsx(Os,{}),Ue()||p.jsx(Et,{})]})}),Ue()||p.jsx(On,{className:"text-highlightBeige zx:text-zxCyan text-center max-w-32 mx-auto"})]})})]}),_D=({userId:t,campaignName:e,label:r})=>p.jsx(Z,{id:`campaign-${t}-${e}`,label:r,doubleHeightWhenFocussed:!0,onSelect:$(ka,{campaignLocator:{userId:t,campaignName:e,version:-1}})}),SD=({campaigns:t})=>p.jsx(p.Fragment,{children:p.jsx("div",{className:"zx:text-zxCyan  resHandheld:mt-half flex flex-col gap-2",children:Object.values(t).flatMap(e=>p.jsxs("div",{className:"flex flex-col gap-half",children:[p.jsx(H,{className:"text-metallicBlue",children:e.user.username}),Object.values(e.campaigns).map(r=>p.jsxs(p.Fragment,{children:[p.jsx(Ce,{children:p.jsx(_D,{userId:e.user.id,campaignName:r.name,label:`'${r.name}'`})}),p.jsx("div",{className:"pl-3",children:p.jsx(Ne,{className:"text-midGrey",markdown:` ${new Date(r.created_at).toLocaleDateString()} v${r.version}`})})]},r.name))]},e.user.id))})}),kD=({text:t})=>p.jsxs("div",{className:"flex flex-col h-full items-center justify-center gap-y-1",children:[p.jsx("span",{className:"sprite texture-animated-dalek"}),p.jsx(H,{children:t})]}),CD=()=>p.jsx("div",{className:"flex h-full items-center justify-center loading-border zx:zx-loading-border",children:p.jsx("span",{className:"sprite texture-animated-head_walking_right"})}),PD=t=>{const{data:e,error:r,isLoading:n,refetch:s}=SC();return C.useEffect(()=>{s()},[s]),p.jsxs(Be,{children:[p.jsx(He,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:$(Oe)}),p.jsxs(_e,{tall:!0,className:"bg-metallicBlueHalfbrite selectedMenuItem:text-white text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[Ue()&&p.jsx(rn,{className:"text-highlightBeige"}),p.jsx(H,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-3",children:"Community Contributed"})]}),r!==void 0?p.jsx(kD,{text:"Failed to load campaigns"}):null,n?p.jsx(CD,{}):null,e!==void 0?p.jsx(SD,{campaigns:e}):null,Ue()||p.jsx(Ce,{children:p.jsx(Et,{})})]})]})},ED=t=>t.startsWith("markdown/"),TD=t=>{const e=ae(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(ED(e.menuId))return e.menuId==="markdown/inline"?p.jsx(ru,{source:"inline",markdown:e.menuParam.markdown}):p.jsx(ru,{source:"manual",pageName:e.menuId.slice(9)});switch(e.menuId){case"communityGames":return p.jsx(PD,{});case"controlOptions":return p.jsx(Z2,{});case"crowns":return p.jsx(sO,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return p.jsx(iz,{});case"errorCaught":return p.jsx(uz,{errors:e.menuParam});case"hold":return p.jsx(VO,{});case"inputPreset":return p.jsx(tz,{});case"installGuide":return p.jsx(ru,{source:"manual",pageName:"installGuide"});case"mainMenu":return p.jsx(dO,{});case"map":return p.jsx(yD,{});case"modernisationOptions":return p.jsx(z2,{});case"offerReincarnation":return p.jsx(pO,{});case"proclaimEmperor":return p.jsx(rz,{});case"quitGameConfirm":return p.jsx(mO,{});case"readTheManual":return p.jsx(Yj,{});case"reincarnatedRestart":return p.jsx(bD,{});case"score":return p.jsx(xO,{});case"sound":return p.jsx(xD,{});case"sureWantEditor":return p.jsx(wD,{});case"whichGame":return p.jsx(VD,{});default:return e.menuId,p.jsx(_e,{children:p.jsx(H,{children:`unknown dialog ${e}`})})}},RD=Ui(()=>fr(()=>import("./Cheats-CsPO-kvM.js"),__vite__mapDeps([7,1,2,8]))),MD=Ui(()=>fr(()=>import("./gameMain-IVHkQnZT.js").then(t=>t.g),__vite__mapDeps([9,5,8,1,2]))),ID="/assets/bonus-CvVo342Z.mp3",jD="/assets/bubblesLoop-B_LY362Z.mp3",OD="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",BD="/assets/conveyorStop-D5zeg8cv.mp3",zD="/assets/conveyorLoop-CF-OA6qJ.mp3",ND="/assets/conveyorStart-CcCK4MGd.mp3",DD="/assets/destroy-CZDN4Ktz.mp3",FD="/assets/detect-D_kRR5uD.mp3",LD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAARAAALSQBAQEBAQFZWVlZWVmNjY2NjY3FxcXFxcX5+fn5+fomJiYmJiZSUlJSUlJ6enp6enqmpqamptLS0tLS0v7+/v7+/ysrKysrK1NTU1NTU39/f39/f6urq6urq9fX19fX1//////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAZAQQABuAAAC0mIpRnOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABGwBW7QAACH6lCs/NvBI1AAbSkgF4ABRZcPlz4Pg+D4IROD74Pn+q3wQ/KOwQOQQBAMAAOJTDmiIJGRsnW4gAAAAGHBw0GGr6h1QsZCJmtI5hYgmsYoAR0Ag4JBUuUZAsPJMg6JJglclhHUckcsioTqgczgUZ3kIHEq4rEwqNkFsLgn2Y+C3J43WE3Xo9BYGhDDkPxFE+X4CQuplOyOZfBxw0udCrX3zOQVmZoMIXhedAAJChVEEU7wAEGTZdNwgH7mWw5DSFJLPdV2KNnLuOzSTEqBeEAdPlZlTEwHqxNqs1LMcxMM1a1djNU425jGjLFpvdlvuYsfO+n1l+gAR6tolOGFYmwQBCMWKqZ1qMDBIZELiWfE5pVNre897tRKIpRXrvmoG1vegftCy+Kzbj//LZEz9fMoQA2aXZklv4AAYkhwMhQNKHAIx0Fw6iMOQxEpgKZZPRYJ8qBGb7ZHoZqcMofVh2ktwoGiAkzC8VF9v2AAkLDsqNzd5lQAV49Xg4qgYi4La1Xx8Tg0zFyPZIkpbTT7GNSxffKqESjUh0B0DZvlpu/0wBWqpZVsm4AAVjWOro4yB/tqpNY8ZjQNFXPky40t8krDdfZpDHvm58XRUg0XCIpf4nF7nTcVfLwQBXeXdXlvCymVErYmUA1UDNKRHROOh7OHcKWss9aNWDMxPfS5VDJocqMY8plQWcUpemgAGiJhlSS8AABLZawwON1FlnaA2kBuSB6H4eRSYmC0sEFJ6AoX2k5armpKStllLC7mA2Ui/iAAsTEyzX/hw2PKNiagjPDYWlUyDk62rR+41nJr50i0hS0p5W1D/+1DE3YBJfKlV/ZQAKOYGqrWNMBWNB1CoYU2F1bm1AEiIiHeP/wAAGeu00cmu3GAFjOSBwqEpNHHeS+xC60FPuHFcS+ddde3vq92QACKzvDvtwGIfpxBPjpjH+mmJx5JgBEY8FLXit5bva+ElTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVEBiZgJkAAAAFhBRpzk2oF9X2Vys7kT6VmBXM0AAAqVgiMgd0ljw7xocqTEFNRTMuMTAwqqqqqqqqqqqq//sgxPgAR1RxXeywY2jRjir9lIldqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoQSXcAAAAAADsYgVwgUZnVIPsgaXAKRyFrIA7uFp1MQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7IMT3AEcIR1PsvMMoyQ5p/ZYMdVVVVVVVVVVVVVVVVVVVVVUiUAAABiblGtCRdQPwAdAVA2HQVHNLqkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqhPQAAAO8d7/+yDE+ABGtHNJ7LBlKLsNKX2GDHRUNQVKqAeAFALgMUhOTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIoAAABVRRqMgKxqApRNAYEQONA1MQU1FMy4xMDBVVVVV//sQxPwARZQhSewwZmiDgmj894QUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUwAAABgK0HQWBEQADnZgKHRLExBTUUzLjEwMKqqqqr/+xDE6wDDBBlNxj2AYEQCajjEsAWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIgAAACRH2BRkK4jAAqJ6MYhqTEFNRTMuMTAwqqqqqv/7EMTlAcJAEUnGMeAoLoJpuLYEFKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqjQAAABWHpJWVawACtQ6Yp1MQU1FMy4xMDBVVVVV//sQxOGBwWQNQoY9YCAsAihQxawEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWAAAAoBIFQJYcX1UxBTUUzLjEwMFVVVVX/+xDE4AHBgA1Ah72AKB8BaJDGLARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVXCAQAAAAAA4GyRY0NlTjf/5362Fc93KTEFNRTMuMTAwqqqqqv/7EMTgAcE0Cz6HvMAgKQGn0PYkBaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN8BwTQLOQesQCAhAaeQ9IgEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE3wHBRA04h6RAIB2BZxC2CASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTeAcEoCTEGPAAoGYFmIMeEBKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNuBwPAHKqYcACgMASVCkgAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE4YACzBk0mYAAAAAAP8OAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",UD="data:audio/mpeg;base64,SUQzAwAAAAABZlRZRVIAAAALAAAAMjAxOS0wNy0yMlREUkMAAAALAAAAMjAxOS0wNy0yMlRJVDIAAAARAAAASGl0IEdsYXNzIEJvdHRsZVRBTEIAAAAlAAAAR2xhc3MgRXNzZW50aWFscyBmb3IgU291bmQgRGVzaWduZXJzVFJDSwAAAAQAAAA3OTdDT01NAAAAKAAAAAAAAABIaXR0aW5nIEdsYXNzIEJvdHRsZSwgU2luZ2xlLCBDbGlua0NPTU0AAAAoAAAAWFhYAEhpdHRpbmcgR2xhc3MgQm90dGxlLCBTaW5nbGUsIENsaW5r//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAOAAAJ3QBLS0tLS0tLZWVlZWVlZXR0dHR0dHSBgYGBgYGBjo6Ojo6Ojpqampqampqnp6enp6entLS0tLS0tLTAwMDAwMDAzc3Nzc3Nzdra2tra2trm5ubm5ubm8/Pz8/Pz8/////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAXAQQABuAAACd1hx+LLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAAA5wBYfQAACIEmGp/N6ABmZYgAzErrwAAAfB8cQKLB83lwfD5c+X6w/BM/y8XQAAAAAAABkLQ3wlAAAAEQCwAwww0+WFa3dKgv4UAX3JSIKgDXzlh5HA2onSwloqV6WFcNjBcHO5I/A2nao/IO7QNDrL5DEV7sGilCECu5N2ZdD6x5VWsTCGjFa9mHHFiEu5P37Hf9oTWJXUhuJbi0f3jf/////Kx/6w1IqXWNbDPhkACAABbeAAglG0QILxOnB7jM6izYniEZDiombEIbu2UDNAsCoiDAR8RMrHzFdtSTKSlIhwndIvEFQJoni8dPVGKK060UeUVmT39aE/l8mXwVKPLZsuYARADU+sYvG5LsvtYZ1nAN6GjBlThtPbQ41qaNRKnLBREVTK3U1235+UqDZrLmni127D6GP7hQP7esoGjUNUiyqt5YQVQCibgADqFMeHg1YBC+v1Uf8WImfCX2fb7uOELxKpF7Zo0YMEJXiHq9QV1GuBcuGQ1oIy1R5Yyaq4EFYAiXvMoZmtw887IpW1j30JKl6XVIj/aMvP6BTW7aIDIRXh8oxbkyFCdKLvuxAmEf7gAACUdZaUJZc/MUygMRlgX4rXomhjhgAI61iUMeob/9VyliVmmGAHcGncdaLpwYClXWFmpAllZeRCMRufXVZ9fSZpuIF6SzMlVALqhB5WdwAAAKqjzk1H9osoBA0+eS2xDa9B7PvtMmf9YBVVYZdVwAMnzjOLOixgcJ+o4iHkTm4Ghzqw+dUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVQC6tguqngAAACpVR4j+BDEUApT/+1DE34BKpKlb/YkAIQkVa32VnlRNmgn05U6qyId3/pItAN3GDc4OCrmmUNA+BOcus1KXqDolTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAJiVCAgAAACCtZrSkAaFXbQN8xwByrKrBKAC3GVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUAWg0A//sgxPEAR1hjU+ZgpaC5CGo9l5WUPFJEWDoMAGAGAMAKSkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoEAAWFJYIvgAC3XiY3TEFNRTMuMTAwqqqqqv/7EMTzAMVIXVvg4QNgk4hpOBykZKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoAMAAAg8N5aA1MQU1FMy4xMDCqqqqq//sQxPSARBQ/T+BhIyBviCq8B6hsqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpRlYUFXUxBTUUzLjEwMFVVVVX/+xDE8IDEAEFT4D0jYFMGK7gEoG1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUF9aTEFNRTMuMTAwqqqqqv/7EMTkgMIYG0/ACYJgMQOo0AQsXaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN6AwTwdQIAFZGgaA6jgACQeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjEwMKqqqqr/+xDE3IHA5B82oAGA8BeDp1AAPByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTag8D4HTUAKeggBQNmQAAcJKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNiDwFAdKACB4SAJg6WAECQkqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE14PALBsuAIBBIAUAZoAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA/wAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNYDwAAB/gAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",HD="/assets/headFall-rxdxTCeK.mp3",$D="/assets/headJump-GCHlCfni.mp3",WD="/assets/headWalk-B5kQ4tvC.mp3",GD="/assets/heelsFall-IsGtipMw.mp3",QD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAANvQA8PDw8PDw8PFFRUVFRUVFRYGBgYGBgYGBtbW1tbW1tbW2Dg4ODg4ODg5SUlJSUlJSUpaWlpaWlpaWltra2tra2trbFxcXFxcXFxeTk5OTk5OTk5PX19fX19fX1//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAP3QQABuAAADb3ce6y6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBabQAACL+Jyq/M5AAAATd0rslm3BwuD4PvKAgCEMYIAmD4Pg+fiAEDivB//BB2CYP8EPlHQfB8PygIfUcwfD+CAYAAU4EERahmVG1qTLSTRQACHQxwMcMsQaNBDJykQAnheOVsEjpbtBSluhY8aLnhkR3SqInu5pvluoCGSNeIPEP7PIsMVAof8vqJIx+WjoAGziDvEiannoTqQJv+0KPDobqTKkIbRlSwicofK9BcD9jj2flFuRxqG4IZpVoIx+cf3jH3bymJbbxuRDmnwwrxLmpba+3O/ErHaWc5hR9j1FX+EfSxTtJf5Xw7U3zPLtX93P13n8q0H8rc1fcf/2L9C1KBFc4gxM3ZCYJmGinxCyQF6IUdQ+jRISyQlcGwEOLFUWAlRJGCxiiZGykUUUVOsZRsxqgbLdYXQljEukqSpKi1RH0CbCYiMlaKRuVF4rBUmhlRRMaI9x4osiymzPfWyRkizL17nqukpI37b1Ge+cSSMm1qSMlXb1mySRvqU6jZJX5hhAoPEGrCrl7RMBc4xmIkmS2dx0kvlSGcyItAQ7CyS/Im6bufIFqiY2tBakdJ/EMFq2Y8EqwmDkowf3YIWW1NR58qp/W7OkvEWr123iWK4i96wY5eleVa7basASy6Q4hZ3I4etRFgbWA2XHZiHG+y+QF2HYI4TiV1JEWkxrXwwxLraLURInnGvIxrj7qZAZf79rQT06eVSprKvhjzbStl/25YYBkc4lld1tgADlzyqygh+XOi5b8cqWXJOiCP7izoTNBbakKzalazLiaPx0MIQUFDj5qZnDbNvW2IU+d2jMC5bmOa8HfWbaEuoX7/ofcHaTKCaoIKVk2lFU+TQADpM9RDdyAlEXAlK6OnRKRHINRFtwMUFl3Ww9da+P2qv+f9wJyyJoxE4yTEFEzrrqIhw+nan+4Rr4+fSdsUW2CB/VrcgGS3iLl3+/+YAKdlIf/+2DE6IAQdVFb/PaAKUGVLDz0HfSlDIIgrA4H92yr5cAuKkFkhW7a1rZDWricNKm+oQmq25qlRr91S79meUexMW6rst5aLH/u71fzQAASKHmP0cFUb7VH5vUUppI9RQrVs0alF94d2ECivnfDHRKkw9EiSy+l0e9T0ZWd9/+VdAkigRcGdFAl0okAoEAYAGo0SOObDj4QAiD0ej4AgBlyt9sGDiq7XKjYyg9chwAXABM+F9A2wiAZ2BFwwv6A8DLkTGIKBDZQJ/qw48QoSwtg54XyHPC5AKQRD8+M2TQ4BKBASSJMTwOk2E8/zcn0jQuNEZFAQmFpEaFknP+ybn0GZOVxKBb/+0DE9oAKEM1b56BxoUaZ6j2HoHzIsM2LgLJoOP/+yC001MhOmyJkTpkiXjUC/9Px8VpHYGaDBR8uiAKF8r1kDRHDX4oVTRp+YZj9/B+amUqE46DOi2iMgeRvJRI0UbIol0GwSzzNFnNjzwVsLijM2QdMjvDbESjW1pamwzi0XV5/MiX/mmkX/6G5mv9B8w8lZyVnElvL/WTmDRAgheNxEAEpQIGsN80TuDtnMlnLCfqHrw9W6v/7MMT1gAmoqUvsMWkg9hKqfPYcfN6tr/F+M71h8j3JG2a6y9rzqELFmDWmPrNcwiQ3x9Yx5d7yYJeaTwdV93Lez9HjRkfpuBZ9+T4gf8k+Ofwyb/wZcF/jSPK0VRZQmIIVTzbNFgy35L0whBPTi0mVYsmen3JU+67Wsf3+vqmmtSMcfb6BjyXvzl3rN6V+dzRCgGviO9U/CAFSYf/7YMTzgAcggUW1gYAijidqvzUgQMuLnVQWVPiV9H5VjRT+l4F/loQ7f2y/1//HSPI0C6Arwaur2vcIA1LBQ1CmHEbm/92uTTvv7VilrsRcXsK1podo2HzUrH28/H2+s2xDoV7j4OrbvFiq45nCusWz8+uDvOmIzTwab00QnIdiifcX+1rm//wUyqAZ+Y55mmFp3cW+r60EQodkND92jYAHly9vYGehmTdM7jmwO2uF1uEPasNO/xbMbdfbC2q3jC4RpNQZtty5YosXMHWHuWZnGnLj3xjbbDzokInKmkiNVQwC2u+qOiCn+WaVJAHULvSc1/1e5YSQGimpk5emQAJmsIhLFf/7UMT9AAytA2H9hoAhkyVrfPOLzJ5Dq4L0DQ7J62Vxt8JluDcoVZzyxqZ/vK7D0v3Vy3vmW98ZlT8pHDMyplRSBo1RDRa19VLISV72ThYEndXbNx8RnOPmsqocxH+YuO3/+Q5K3pUdP/A++awgAFaY1HlRQE1pyZC4MNyGrFsX1Rk4g8uOQDy8migDCo2qNSQJkdzViTxUPc1as8PHZeyNmD329Pyw+W2dr28AAACXPUDhVn4l8Krv/KY7A1uJOFqxOElu6aP/XB4yPrLtiJn/+1DE9QALhSth56y6YZKdKr2HofzIIFy1rTeWqGGuSgIXr6P3ff/22dn/6/QqeAmgqWaTeECCoYEAIAAAAFx64msnKFFjiqafYSTbc7jgMvUbJcvn2WWYebpAZ1KBr1dlseUBqw4bKBhRfoGjmgWVgZAIGFBc/f8G5geoRACwMPQ//C6gWcHqE4JzEYf/44BZZsaDliC4yf//5qQMiYsggh4Zgihp///5EzhcK9Zd///B8PA+CAADH////0gRAAPWKgvFMiPaNosABEAHoAl0//tQxPIAC+TRTew9TeGBnWi9hJ8MSKp0muQGavaZwAYYcqcx4NWwzRUyBVtEChJaWRYSccwPwYGPXRGDgriBR0rsBHi4miGPAaDyCpmAyZmwBGiik74hC1I0kNEgq0+y0YFAQVFhpSX9SsFcooM3eyd5LciIoQXmEASMEoABlYV0/ADR1PU+P0cRUY/SZLkBAmw2bgB3uSmFZaoKeSPi/FXCCp1cESzkj+R2rWhqnz5q9Tf+qb/1yd39yD3Qy+MyyNy2rlF9Svf8nZnuvqXrH//7QMTvgAf0oUesNKzhBg3n9rCwBPq3U//3dpu3LwPSVTb6tbitOoA2ukN5JkSUlAYEHAkImfuZKXlcalg2WtxgSRyynjiOaVCSKxNdDDxfaS3FUFgWr/1qggwvnORt7jEkVEEK3/fkP/u2Vb/ouhP9cs7yMQ/PWeppkGmHU1dd1YgNOQoHEnhLKEyJ4q2cuajZ1ezv45cQpiPGANEEFppumtSaaA7BL2rOpvbQ4sUXetNNabGJ//uAxP8AEdUxU/maAEN8KSq/NbIAoaDkBwDWbz5s6epY8E1piGSZRghd6ytqAzpb/qd0zMna/6HX/6noGC9vzqDiKkYFYKYBUCQBUFBAGAwAAADvUU0NTsnI/zOjRFNNZI7/EV6cC3lMf9MQEvCS4LEcRMLC6P3JYepIl0TIdxfC6+XhxDGNZNJUT4yNvuXR7D2TOf/pGJqTVP//zpdJFJR1EW/56W2KTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1DE9AAKYOtn/YUAIamnrD6e0AWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sgxPKADKDVUfmWggAAADSDgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",YD="/assets/heelsWalk-Bmk6WOTI.mp3",KD="/assets/helicopter-BYGzJTF2.mp3",XD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAAMtwBBQUFBQUFBQVlZWVlZWVlZbGxsbGxsbGx+fn5+fn5+fn6Pj4+Pj4+Pj6KioqKioqKisrKysrKysrKyxcXFxcXFxcXV1dXV1dXV1ePj4+Pj4+Pj4/b29vb29vb2//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJASdQQABuAAADLeLlBWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBYbQAACJ3neu/MYIARAV1lrd0u4AfKAgGHA+8EAQB8Hwf4gBB2D4fygIO5cHHcH+UDH+oEAQdic/lAQBAHz+BAxoAQBSAwTDAgNkVT1nptAgAY0GGiYh7PCRB7DVx5YfkOOROSqQUSkYfHnOLhrEBoy3a5IOd+kTrUdfJXD4SqC23fdhrDn9VGu+Qt0nmCOG6FaA4Ae1uz4xaWQfGZLemJfSQmknrk/Sbv07+xC9L5HMUtuU1Z2IWbs/K5fqB5uzEpTRT0owszM/3m/13/pM963rffzrw+CDbv8oNBhIDE6rYGQNTY0KMcsuARgjTREBw4Ri4lBZ+m7rPl2FVO9Pq/kQ4BaQPIVXUKQENMSs4tYXKPuiQMhXx8Eia0h0D0uidKzaBOkTmQyhqtjMmzY+qs2ugouvY8esZuYoqRL5s6a2WgiyJcNs6bpJoGR5lMsxVTWpVajya1S+gtkEKa6k3pmakUy2aqnjiVBBJddqmzCMI+j4M53RLH3dr+TYQYGiM7BLic4Eo1vSFBQHNUD7gA7zX+eZpX/cgD8G5e0Aiykc7yJof/8qNc77txu/HHXJpxv1HGzQozYRplB3VRUOpE5BFOINWjpk9L0nTn/SMyKfmfY94QSU9P4JHMjMRbGE+VP+vc3EYseEuQRzpwWcUP1S6128evAlRtUZ2GCGlx9iSNLeJR73naPocpt+dCjFKam+tERuTgd3X1CJg1b+jOpjB+y8U3EeTz+F6hvN7e3v0IdXVj1S27Iys96P1br/29/T7f16yuznaZnRLUY52tV20UJIr14XBsyPEEAbe5M2jVjT0bJYkSst1YAV9QsBlIMsO420Vg3RFs0KkLW0T89yeZ+J6n9/Tze3t0P0Xq/QvX0/6U7ps3t0/vEzK2GAWU5xQGFIs71p31HkDDNVsDTRZJmyrDjWPDvT0PZ0eYWm5QFdneDMKSaLz5v82JA7nkUz/+2DE+QATXVdp/YmAKeew7jzzjuXvVgAmb8f43qGvqIdS+f29/+LdD9X4w5E1botnbanUfp//fSmWaLWXxRdb4Fg7oqyjEC5KUFvVVSNicwizxubAxpbaJEgc4fE0K6beiDOD+eQxEdoE7y3kTbh89FHuyUffVviXPW1On5d0/S6GpvEtT0sozsS7ez7f33VobykDRRNpAA7tweNRCwUpRA8TjHZszi8fHMMpd2wWVP8lndHsHk1AfbUT/Hvv5fRu93uk68hvhupsNwFWcpoZIyodR2duivvqW1DGKbJzwUhHSO8lCcm5RC1A69cnygdbFgWDl+KyHFStDWHLqwBAlUNItbj/+1DE5oAMBZt57LxH6WAlr/2GiTQMep4YoZGdlTlAcef7+WxXdBGt8PVDJN5d0jU+Q83vukqDKnO3SaN9tVs3iZlalUwZIEMiSJgFJ02unBmHeFs3iCULufW9bJig6ZlFPe/gKmS+kPtQEosYaOz4j6UDhepvTpbQf29eD9W4Z0jvUyrbXXtqXTjqPukiTPZURy3A72GCaqjPGzFI8E5tsJme5qpARahVmLv2NwroO9ktPvW6hfpUnoC2q4Ys7wHod8ls5vbq2gRV2Jx3fU3V//tQxOeACdTHf+essmFFje89h6i8LkZughomPzcg5KKXwPs693/8Kmt2K0btqo0bB0xEkpBIzcmxus0lWdT0kc/jYXLy3pPwtc97LrhYFTbzQEq1ig7CFXwhtGdG7mbQP+3VtxL0Tl9S8YLyzpCJP6KnsZRQaUUMKeOKyz1EXLc/WSlYq6+hyIolpBwBHU3ZRac/EQ8hsjZQLw39Gat+9BZgVjNTQXwzN4wUDlLWpdnlGAHNTK+XbkegidC9W4IX0V9m6jcEnt0bovL7+qf5W//7QMT1AAmscXfnoVIBU5HvvYWc9NNbaq7FKMIrPqI1L3KxbX+SqgYAJCViAAC/R5CDjKFMyod7VAJ3owRV6tUkYiFq1LMpdwYgF5UNM+DDSvAqXVTQs2o0U1YufUdbiU/X/ne3Kt0/5zccO/2+/+vufspHUwxTZc5BX7k/8hrVFAggckSAAAu8TzVmHJLlQu6Ro9dwE2f1VIAlvWSReDGSvEKzsoep7UMZJdZNPdN+N1Auo3iv//tQxPQACgzHdeesUKFQGS889QpMtqXp9fN09N5m5fXyFupO6M1TEWYpN6loJG307mHqigcARERIIUjOCbmQrBhghVs8Alr8FwKrW8mCl4uciKnnrwUL7rH9a3lJHW+Kr99wwwNYqoNej9RHQB6k6epOrdH6N0p//K+z9D8j5o3ZmePjKHdDWEAMqCGwQUnwpOQw8q5F1T9KtGfIUKixhTdWStnxrTQ/i4Z1A0/UBpPjZuJvAvP5upeYM3X05VbKnN6fGXp7dX/1+3X6mxINlv/7QMT/AAt4tXfsMLBhXSVuvPOKlDSXnp8LBm5prFKy8ASXKlJrkaq9yDqsE40hao+rGAJISmPYaBjasuyzLBdxYBKDOr5JU3fRuj8L5PL5NVZrba/ty+/QaoN0uUQt3W16KHwYBmlXSRJW8AEXpGg6hBRrB0mdOMovLTXRYw8rWsFkt+9wzCt17HdbQVB6rEQYTIvzPzdH8vl9PL4NtX6N0N0CG5+nxttGdvpqShcCOjZ2y7cA//tQxPYACz0ra+w85eFOpW09honkCvyYY3iQkUX0uU57GJb3KEkarUaAhhO03QDsJObmZfCfjZxxJayme5efo/fr9LWmXmIDcRPtkt8Q7bazoRABQCAQUH8uLYAAAADVy4BE4GkD9DAk+0dUxRax4cC0Njc941/ykiERi5N1kFqSAvTfcJhhS4f4hA61y9QEFSWOlMqpOHkkXAt2FiEUrLIp8Hi1LJ+UjMmViBO5x5HTBikJ5qFjG9Z/+frWv4B4Mgh/3mb//3k7V//99weuKf/7QMT8gAp1K2nnrFEhMaWsvYOJ5NMhHICZLKAAVQEg1BqA04KwNjJawIQlCUTicfLlgYCYGgaUDQNYNA0e8Gg5lgaBVygaBnxKCrsSgqpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//swxP0ACWDJa+w8R+ElHiy884qMqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPYACKyNYfT2gCH6F2o3MPAIqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTxg8csL028wYAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",JD="/assets/hushPuppyVanish-CZOUg83F.mp3",ZD="/assets/jetpack-loop-1-XbLJ84YF.m4a",eF="data:audio/mpeg;base64,SUQzAwAAAAABJlRZRVIAAAALAAAAMjAxMC0wMy0xMlREUkMAAAALAAAAMjAxMC0wMy0xMlRJVDIAAAATAAAARGlzYXBwZWFyaW5nIGFjdCAxQ09NTQAAABUAAAAAAAAAd3d3LmJsYXp6bmV0LmNvbUNPTU0AAAAVAAAAWFhYAHd3dy5ibGF6em5ldC5jb21UQ09OAAAAFwAAAFNGWCBwcm9kdWN0aW9uIGVsZW1lbnT/+5BkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYaW5nAAAADwAAAAkAAAzXAEpKSkpKSkpKSkpKYWFhYWFhYWFhYWF5eXl5eXl5eXl5eZCQkJCQkJCQkJCQrKysrKysrKysrKzDw8PDw8PDw8PDw9/f39/f39/f39/f9vb29vb29vb29vb//////////////wAAAChMQU1FMy4xMDAEpQAAAAAAAAAANSAkBqtNAAG4AAAM17UwrB8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+9BkAAACtwDY7QQACj7AGq2ggAFNOH9J+aeAATUMKT8w8AEMl2x223XXYDXgACBOHh4eGCMAAADw8PDwwAAAAADw//0AAAAAB4eHh6QAd/h4eHh4YAAAAIDw8PD0gAACPDw8PDwwAAAAADw8PD0gAAAAgPDw8/AAABARKUssltuoAAp4eHgAAYAAYeHh4eACAAARh4eHjwAAAAADDx/+7wAAAw8P/YAAAAABh4eHjwAAAABGHh4fOAARoKg7m7q6w7fVgAAAAAAGVKJXHUQiRk6oIINAoes5bwJAnhHlxWSwCXhBQ4eYKkPgwBYAjh/EQSIvJdVKdKtimtsHgLcGcQpNLbPBbVFBjQTRQliNKZ1AxndK/MbMEYe///////////1mAojQbrDKzs7a0AAAAAAAB7QJFv27F509ww88gEd4/eNh1yFVTUcCJrEChbRFDkUKUUMJucGNVq023rZFZbsyxDy2QG1zkZoQKMR8sHoBBtNuO78AAAElR0jwLGOESSdqKEepFF9W1Oo451rAyxzhrsgmsz7mnMl0D8i1tkwUVjFzNVCPnf5YRjd4hoDKVyPf4AAASJEoONd/pWjpJ8pLpZp6aT8QEHzBGb0DFf7Q4wE4lEe6McUGC0yHgQTrtuh2bXAAIDG6r9xMwDkvQmgw2IUkUjltYRzNqJIYlSM76znywZCgohD3yXY2XqjBQ6wWPg0GDi4lv7SDBckyAxuy7cKELMpl0jVcWNjXdF684oREQm1IzzVBysxBAYZvB9u478ju+v+kb+t1ACZNdUu+4AEOkhKBm7axdX8Gmw9GBeGbK5SSamYgKsmjRLPttZMyFZ1U+4yxCD6yZEILmJqp7F5FT6JIpmAOSq34AAIebpRB0lUf5c5QGQHz8ioSLPpHVp5C5x+qR5CPRbQ//ERuuky8/jnf0BGEJUt78BQVZzncUifJYTRzMg5z8STzEJDzVlETIKRNS7NXeGx8pmLKI3TMjIGVOgRuxpZvU69awVWAkSjf8AASnYk4DvsrXiFkPJbUwQOdD2PF0tSYVTOpCdis1f6a3ZZ3ETuzFpyvI4lyRjKk0AFGNLv/AAFRFhLJmSoUNFAcIIlhArCocHTs//tgZOkBEewa0+88wAo3Q2p954wBRxBdU6exBWC4h6p09IzdOAPemIppHGks/UH26Xud1aZ9w0aovRKm0/lgzsFRytntsc/wPEARgAFl34AABUD1nUwG7orCEBICgIUGiChKs4wUS4Yxe2/f1gfV/CdaHlge/oz+92AZLa++U3B6DMDOM2CK6ZZzoo/IB/yqVffKmEiTsqSaKKXyM8GLEJEsKMMNOuAw8JRc/LmzyIYM72zERskwE4Sy09vyBSxKzA2w1En4fDTARJQlmi4Ioje5PJR3P3KlQSClMFAQoXnuhs/DOU5ELNIVIc5rvAAAgLu3AATAOolOC/CEl72SNCijGyYA//tgZOuBAd4XVWsMMbgwwnqdPMI9Rxh1VaeYbKDakuo1hIkcIFLhOTmJNFrC9faW29ON3mIP7ZQlkP5uXkU6wQ4o5miMQZp9fQyLSeRk62+lEmgdpgFEVZfgACLCcOcZ6V0+eU0o0guqtj2s0lNaTapUPbHIDcnKk1//e/0uftMYOS4Fn47N2AJQSijL/8ADfA0TkLINJaN8Xc4xkSjXBIlabPkTR5sksFELBPcisaGNdznE18177gRISF6tY7Zxn0pE1fv6te1oH/sMWtwsqb+gABtmKfhJZ1MHyWhRmoXE0w7QGC4IohhpEBl0UXuXY413LLQe6F0Qe7IKlVRvBtchTL+V//tgZO4BEfod1NMMQTowIVqNPSMzR6RfVUw8waDeEiq1hIzlYVIRRae++AAdZFieIeStBCTCu7NA90eEq09CBLmkkaKTjUTY3Xms3lu9/WztuTjBsz+3kPQKO/DQyA+o9bvmZ+mdh/2A+EWZxoubf4AA4C3eITqgthPRnJExAmEb4jgEPC1Q4bSnmEd6lJBw7Kkd5ioUITYeX7Jg1sgEQ5MzsGUE0GTCr/9wAp4VAXcXmsPDIPGtNt32gFzmTShwXkSokUmjaS1NdHH/772KE3LG8aqBYfWIyd4xRD9zuUIRrg5YH0Mb26XktEB5v7d/6AdzkDit34ABsdkgl2JwKUSkUpeS//twZOyAAjwuVNMMGnozJFqqPCODSGxRWaekaqjljys09g1NaWLaY7EfyhhU3aeWJfyt97VaQ6GO4KTZZJSm3OycuQgFEHJ1vSogyRS5t+AEKHoLwLeU6eHUa4blkSQXLANPQia6oxNbKoUtHItxEF57mT0/+f8OlD6acz3HR4hOmV/db5jOOTn/scnAK6SCCk3/ACoJEoQcx3YKI42Ukj5DUahEYwFIsauzFsNku/6+kY8zUFx2w6AFi944gDSQGWNoaOMAPTYRf1HALAKClvwAgkhctZTpqkPhKIghFcSARBseLlpnY8/1hy/WYIHlnmZsZGluCM3ROlwWhS5/5KR+WEEhND33hzbc9lIgkgAMUCU3fbxCpX1wTFQYhiTQJh0IIiXLaf1jqT2jVXGo7U9GZz10tOEfCP/7YGT7AAIvGtdp7DKKOeQK7T2DRUmgm2GsJG1o5pHr9PCOlMChiAIimDe8XfTYbSSCzxp3Ypz2UCdJGiCKUAAZPPgAYAgQryPVAywACUqiL4W5DkdvCec14MFi+HSFZWe5jILCuYxjFazTKWUrvsaispjP0KUpHlURBIGh6Ni3LO4rJAINwgAKeegBLCbCPClLon4DqOldGiwHVDTp+KJtagg4nJjCjBS1JtmhrD9UJua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",tF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",rF="data:audio/mpeg;base64,SUQzAwAAAAACQFRQRTEAAAAOAAAAU21hcnRTb3VuZCBGWFRDT04AAAAHAAAASW1wYWN0Q09NTQAAAFcAAAAAAAAASW1wYWN0IG9uIGEgbWV0YWwgb2JqZWN0LCBjbGFuZ2luZyBzb3VuZC4gSGl0LCBJbXBhY3QsIENsYW5nLCBSYXR0bGUsIFJpbmcsIE1ldGFsLkNPTU0AAABXAAAAWFhYAEltcGFjdCBvbiBhIG1ldGFsIG9iamVjdCwgY2xhbmdpbmcgc291bmQuIEhpdCwgSW1wYWN0LCBDbGFuZywgUmF0dGxlLCBSaW5nLCBNZXRhbC5USVQyAAAAIQAAAElNUEFDVCBNRVRBTCBDbGFuZyBNZWRpdW0gMDMud2F2VFlFUgAAAAsAAAAyMDE5LTA2LTEzVERSQwAAAAsAAAAyMDE5LTA2LTEz//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAALAAALmQBJSUlJSUlJSUloaGhoaGhoaGh6enp6enp6enqNjY2NjY2NjY2fn5+fn5+fn5+xsbGxsbGxsbHDw8PDw8PDw8PT09PT09PT09Pl5eXl5eXl5eX19fX19fX19fX///////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJARIQQABuAAAC5m46ML8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB3gBcfQAACNdsy4/NPAAl3qJ2XMAAC5OFAgGFg4cLvKVlz8HwfeUB9QIHCgIAgGIIAgCDso7+Jw/8oGP6wfB8P/+fUclwfB8H/B+ZaZhnZ1QlUiApNnQ2Dw/ssBgMUS/OXDzBIYWCSMzRsxIovmBgqNiagGjBYWEBEzx/goyZdThDkwYJPk8hAWCGkxMpmP4BjK2KpwLQ9cFcqhCLEHYY20YVFrd0bJ0KFFGS0502YTUVvfKatEy5rW4NECdEKaZrXZ4bisksivixZZWF24f/UaLiBRgmW4fhMEGTLOrJZ8Xis7yDnWV1BgX7x5RngUYPGeUS0VzbMQ9SvI00kBthYzvXtX4zrxXBAN7HHxSLSBqlJbbf7iQM4h23qLA////9IqqlmW1dnVYCUkZmwP1KhxCSn+4ksNY9lhKlsa4LYlHMaIh4WDCoLTcwYPuGHxyTXRx1KQw9imHe0Q1rFXzBOURdSQIVyOpLHUYP4mxZ0YgfE7VbuMtqPfMEoxtmafQfWqra9Lt916Hr2k+trS98vExN21LdznsscrwPtumUtJ2zvdQ6MyTRAe0QEZW7Nye5yY401/mTv06Tc5dnjKpOtRAIV0E9S/85zK0YGqO2xsafTMy8tWKmc+G3PRezL36p1/qvmuV1TIyzv32WYCC4dIkVgyoWHITzw3pdZV3Z5mFVjZbISnjk1J+hIZGa4UBG6QlgNl5NbQvW0zrFub02qHmz/+VJ9wt+MSFCp5MCJNdDpELPxTTvtXUPrAo20gVmWiw/zqP/0fX/oqGWGhWUSiiQjmgfCkMlDy2FewHwttKMGyi4ZRImur10U2ZN6mehHCx9wIsOUUVcGwEHlB1R448XMNPuUdZHiY1zHGnxOkmFQUgGdMAr3//0F/Tv+ru77bNEEghzjUAgaR9BlIliQHghLyiTokNMXj84BMDKOpyBL9CnxDSqNLU7PS/sqNVt0V9xHD/+3DE2QAPrXV5/PQAAXAkb/2BifgKGiN0B1WPt3YZCJ1C1g6Fk3qraXWl7f4Rjnr9Tw0vUw6EgmDLupxvkAIAICojjUqF4jGA5lRglrF/vawwSwMfHCfSTmd4YOhi+GTnzLJPL525eU//ar/nCyPPlOmhw9NN78PNXaF5rhUsrcK4c+4pDesrX0//69f/vrCAUAAvBLYOxiRaHgKJrYiiC8TzMc4TNVW8n8ElLmcvasOAyFsUFYafMlr3KZVLenGOeZ3vcgrWElJPPJfiIUoON5JPQyr/9LP93VCM7s6qgEFJF3wh5hyOIsEYRQdBqdjt7ZLM9L+Q0BozlPNULoYuEQ2art2/xC/vMu5blVT2bvfo4bKLGE0Lvf4Bc4Ue5RUCx9EK5JC3G2bPT3+l0v2/sQARJT4LiOAg//tAxP4ACbCBe+ewY8FSDC789I1YqCWQACDyMCgRLkQzEo7fI6txjQO1wfAbH9XLQw7Duad79D0nmKj9itp70qzmWyHs6q/XWJ61NvJOcxjxlyEKubdN/q/uuQrPTNEMiANNKUGIExOH9AQR1AwIGDktJktNL1a1uWqFq8tPUPX8mZar8xTbY9dabezppbC7qbmKIlCYa3NSyZIUu6cov/4TthD5aqpdhcimNDR1eIeJUhILTdr/+0DE/YAKTJ9zpgxPQWqkLrz2DDgN4pB1MJOjAOqIijGLjCVLtHJA5NHuSKncLrGx87CKeWMUymQHpQkoN1M0it6HW16EaC9WU59DnXM9nkr+VnzZBb31SRjiWUmC0u8qswoiDYi5sMhiIYYZ0Jg/5jmykmZPQlyhbMGeNmjwTmzBnxCnXGMSTTpXdGXewchcHkkFCdih4gOxa0/1yR2eaho7c+yIl2WZciATkmARhCqgzy6nUv/7QMT3gAnMrXOnsGVhSZXuvPYMNBy7OuAhO3sijMsLhPD2R2i72/bKbGOZWugJk0RmfbRHz3Ei3K11K11bLoeRKtefSb/m6LKNyYou+uSKWokEkmgDkUBQEhIHFsbjsOpOyNiYmOtV2hAsJqxaeKwSjdIxf31SXEMAhrOWh5WlIqsnaxu3VV8N3N9uy9f/6Kg5b0kjrUAViXhniWMglLdwAvVAPHcGhKOBNC6ACsJu6TEM/UQW//tAxPeACkzXcaYMUOFGJG58wItkxMQCpKaRU4R9EsLIm5ulAeQmEhK4Bx40ILVCY0Xa05WJdzVkTzxdArVtKvEQxw7AABil4AtjafKpVCFWJWXCMivtWJ0gkIDHthgt3tezV4lUgaKkPkzvz6g7GZ0yL/Dcj9X9bcGNJCjBR08IlN1sDTFuE2xJZ7WD1XapQ2kxIB2bYAT5jO1JEuZyVnSdLEifjCFWjMLY1AXd6yoXiBJ0tc//+0DE9gBKTRNx55hNIRqR7jjxicx4p5/8hJumdLTUsjCchlDpUKfwLaBs6tf0dByzqaOogArLwAYbQUpeixNzITAhOi3UppYdtstEGriUYpioeztQLHOVZi55yo5jN+qGOdW1EfTHdN85Bx3dH/+Zj3bSTEFNRTMuMTAwqqqqqpxgGAgGAOMBQGAAAAAAG0E6MWwG0AmfBbSD5iJb4HqYnvx3DtJU4kqrxhRxF8vL/84YqcyNv//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",nF="/assets/mojo-D9S1pz9n.mp3",sF="data:audio/mp4;base64,AAAAGGZ0eXBNNEEgAAACAGlzb21pc28yAAAACGZyZWUAAAlobWRhdN4CAExhdmM1OC41NC4xMDAAQlWf9//8AAEpcYIhBFqBGRQAAAA97ly4/W7ly4EMAr/I3BeMvTftX4WZhy4eZzkGiJpIQdAJpikETSZbmQrGQ9ASwuBIs5sT79jSHhnziR7YAlgsuQ3EQlPYQxkfA4hCfEJrWQS4mF1aJqNVvDqEn8b7j8dyjvbrC89mU/YHX1WltsXR1mPUZdxh3qNKbGvRyG0E4PywN1Og9Z9qEhMwYGXgaVGju3eGzZG9yAKgsXDXrRipQopEpC14TqqRFcx5dEfVOcou6R6Cjpwnnqii/bz0oKLILvDqfOAAAAHvcuXJAAAfMgeYTNdaHZPHGH9DwRZWxw+f9PuAAAAAAA4hTGycB+B+B+BKXBW62TGArVJOBNtuCQDx1ersONau7/PfHkvrjrJ/r4+pOvb4Gw1XKTHhalzUhLJ4X1DFmVFX4jvrfVYDTunTfnyIMPRdJ3IWBG/D/0e5fR6L6c7zIh/L4ax/LWHw1gNYAs0k7c/O3XREBLXu5AlTNVny9RUDwrvQVUiNCrn1UxG+TaG1NLKDAwNellBmc3RSgwMDGwYGBgYGBgYGBgYGBtDAwMDAwMDSygwMDA17PVU9HO7euUdYVFduSw1C68jtMj5X20/nXy++7Xup3U10101t8vlPOqZUpaGbiNkZ+tIhX62T/APHV3qw40BnfHkgOfH1J1lMgNWUSZMfYuXAdbuZt2Lf8nI/QMYxAAGUTHsEc7kftclvf1XtsqR2ErdUACl804UU0XxFEOAhesvPq74AAIikWZkoYiil6a2ADW9cRckqJcgulzLCazMmzY05StZ3E4mNcJuVfViQSkktJQ5JKhZJYTPktP34nouaEcniyNeaRiOIoHrVUiVPT1T09RbwR8MMMMJBOlmZmYCd3fBxNsccWQHevDB3EGpxxmZABf+KCqCv+UFLBQUFUFBRQ5Ch2KTgqXIi6GsCoaQUFWYGjT/GS1uz30Fk+DHHv7g/x8Cz30A/x4hPvCD15gn39w8PJbL1MPhMGAxYTdIcgOIyE+NTzWV5RlKC9OP2MFoMPYyXhEwEiWo1/F4a2AA1xmrkklISkpTLGDhZ/f3hnm2bZirU1NS0eUblrVeQ86S63GJRgEig/jevESh+02SkPFioYs1HjYZv+VwjCdK5r/yulRKE+ijEA1BsX4AhGsp7u/wBAHNkWRiohzEcSqmQrfPb46tUAfPd8W1SUpSqACjksHNJo1aOHH0ueIMeMbBKRsyXQ/hkS/BP1Ul2bAS+1kd6unVn9Pxxqm4RwoGhbeaGkL1p+u0wpsqgfK6XmCHpKVfrWFE6stGD8ACe+2NeFbDnOkvoN+06RrYHV6KtPYvd5866OOxvl6DKvPa9/aDywOVzQXP+GWTxjnwIwRf90/lhRSTQZhElIAVKHFxdHgvp+4OpypkSIeICyhtJhnbKj3Ox0RgrKAqFgB4pNjgqIc3jIPocUhT124+rAD1yvUVLq6maqhyFaiEqMsmIozFMleoGCjoU01vkQcGI1/tSQ9c/SIhj9DtA0aqZaJuaUmCTZUYExQwTgwM93e1JCbPbufUzRc25vAPsi8xmy0mCjRiZ+KAQmvW96w6m23Y39scOG7rYbtitSTh7Dq9iuNhDp6yzsB06Ur6vRMfUzbDwSJQnHyI+I/6OIRrP/7/8AAByoKHsqMc5IEbcQJ/Z/OgAeubuXahSlB00iI+4ZrzXmrGNgQvs4TGYnM5yS9t8cu7Pe9LKcLiWVbbiwzXkFLp6mNKygBXjsZNoYoNBy7MmJEd0UHfHMCkycmUFR+bp48WW7mjHrDV2q8U6dJejtOPidbtX6+KdTnM/RTd+LmjfyMCPaup7GcVTwKpSaltVRnhmwzyvev3h6snhPRQT3QtjK2P5rWNHS7LDy/aU+cnZMr5ngSszmKB6D1iHSximUpCkf9HhKexMdI8VZ5iS8G+2QREub2PEQJ/Z8fQAPHc4apE3eWmxvp/CjLjx08qn3hWVZq2b/fo/pFWeZYkzJzYh+OZcqdW4SIvLr4l8jQ9+t44tdevmvxRdC9E2z9zNkgEU+eX2mqiR6GjcGitv40gegfxuFPfWmCDuvfs+uOxm+nJHWy1uHLLmONgv4uZ4Omy0uaGr2mNV1dxfF0mbqdNOfqohn30Csk8hGsiX+AUAAHK2Q1DCx+klRm+S/jTcSVK19pUk1V71UmOOWmGSP/zDYJJDwTea2igh3mDJEQhlH6P2r/HmH6vVvweO+mMeBrWTXfciC+aEIDsVzWrVDw1EJloRLufgxEasr7He8vP2Hgb/d0u4i8OvuLSXjpbQnLj5GJZ46W0Jq36ESXPQqA1ZdCJTnwMLbPQITLgYhniYDTLkTD9QfxDWUDBtBy8YBhRXf8pV0S1ylCXAJzHSABkQArMdioHLW38MYt5QCYotM0qcAFZMzQjAWlFSZnmT/LTCCZZVJ1IC84zlLGopYD9cWV4lD69D4WlVV+JyX8aRJpjPWHVcZQFPWDsPeGPB8+kxj6q+T1HkMVThrQGPB99EClzEQAPfedEfuLTQTiRSR8WQT8JyPaPg0Tx+xu5xBaPHP4fh+Ga059x+HL33DgH2PrfdHYFe8Xuq221GDg+fx5+NeVHZLllfKN0XhEDfLeiKQEYAUXgE8LndAKMRerzoo3ReoIajEKpT+tUoMYArABO01XBfripv4ZchGsgP8F5QAHOE2MxM5B6ERaEQ6ERaEQ6J3KbzkF+c0l6yx4rzvT83qJyzV4LrGGzA0XUvXU6jNwVKGVHm2Qfu37sjKwpHJYwjXZbDaQ/ggyO9/hGFXXo7sL/CMFxmrkpxjAcaK3Zic8UrkZq8BZHNkrkNocWSvBWJxZidmLAaUrkp83ha4A7njjM2MxPg74YOAAbMNif8EVJHVhQV/NBXzrRVlV6o1TsijyAA8QS8QBEAeYDLgeqRZIMiGIYvEIfCIfEIfDoRC5VVAL8+YAN6qUajOWHhQwuNmTyedWWZdIvr1YoPFM8RjT4Ll4iKKQkhJaXmBLrXUSXHcvj9PZtzfeucVDbDovcK2k2tztZm6fua1oqGa5Q/tX3qiBYgW1baCUZaIKKDSSUk1WCsApLEuxo0Kw1r/xT6/NoIQr8n89ryBT5sWAGSvDCvHHHHHHHHHHr82OOGGGEjiFfd2vXhhh/evvr+9dK5onw4W9whjeFjfwhjAD+EAJfwhwAABB9tb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAAnQABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACQXRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAnQAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAIUAAAQAAAEAAAAAAbltZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAa+FXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAFkbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEoc3RibAAAAGpzdHNkAAAAAAAAAAEAAABabXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAA2ZXNkcwAAAAADgICAJQABAASAgIAXQBUAAAAAAfQAAAHfEQWAgIAFEhBW5QAGgICAAQIAAAAgc3R0cwAAAAAAAAACAAAABgAABAAAAAABAAAC+AAAABxzdHNjAAAAAAAAAAEAAAABAAAABwAAAAEAAAAwc3RzegAAAAAAAAAAAAAABwAAAQ8AAAE1AAABMgAAAWwAAAFwAAABkgAAAXwAAAAUc3RjbwAAAAAAAAABAAAAKAAAABpzZ3BkAQAAAHJvbGwAAAACAAAAAf//AAAAHHNiZ3AAAAAAcm9sbAAAAAEAAAAHAAAAAQAAAWp1ZHRhAAABYm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAABNWlsc3QAAAArqW5hbQAAACNkYXRhAAAAAQAAAABNTUJlZXBfQlcuMjE2Mzcud2F2AAAAJKlBUlQAAAAcZGF0YQAAAAEAAAAAQmxhc3R3YXZlIEZYAAAAIqlkYXkAAAAaZGF0YQAAAAEAAAAAMjAxNS0wNS0zMQAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1OC4yOS4xMDAAAAAcqWNtdAAAABRkYXRhAAAAAQAAAABCZWVwAAAAHalnZW4AAAAVZGF0YQAAAAEAAAAAQmVlcHMAAABeY3BydAAAAFZkYXRhAAAAAQAAAAAyMDE1IFBybyBTb3VuZCBFZmZlY3RzIChCbGFzdGRyaXZlIDMuMCkgaHR0cDovL3d3dy5wcm9zb3VuZGVmZmVjdHMuY29t",iF="/assets/robotBeepingLoop-Cz0TGwJH.mp3",oF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAFAAAHBgCHh4eHh4eHh4eHh4eHh4eHh4eHpKSkpKSkpKSkpKSkpKSkpKSkpKTBwcHBwcHBwcHBwcHBwcHBwcHBwdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ//////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAM2QQABuAAABwbVZvomAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAACbQNZ7QwACnxFem3NvABAAAb/0m/2/DnECCBGAgAAHfHfAVjn/mAGf+YeHv9AI/9/mHh4AAAAABh4eHj3Sf6MPH////7zDw8PAAAAAAMPDw8PAAAAAFY4ef4AAAAAACAJLlcmslzaAAAAA2dhA8cuNgUzOZEQCemOB48SmLBSXoBIB4bRWLmodWkIyM3KQbxTk5MgkxYg5TEmKcVImoNot5fXBIMZ6wUILqZqPRipgksX3ycRsY3WhpPFfXD9wjP2WCzWi4Z9M1lU4rrEJyfbg4tf5nlSFyl9BDltdXPvf+ALefotw91Kg4XKLrKnrM7XFKkPlm0r62lQG0SkaIee1fdc3yedKObrKqLVO1Tt+09AQj4eK79+e/bVR/unc8uLTcn34t3eGbDHckkUd3K0+q+QaU3nU3EvM2q0GCgoYcv1QP5+7LldGULYTd9qYJKpfHTDNTWlWkCVxEXsA0NJe8kpbGX1Q1lrpG7f/wAFfElzwgk5nDf0u0JoQI2sRE3BsCSljdGmx70Q5Yg/U20rsJ0NItx4T1FXM2t7V2/dZ76daq/iuwEHOUVVLy7f8AGSoqMcpzEIGFVQPIdxGC1g8eyzUJPB/m+Vs40oU0Ln1rchVwreG7jwtkrzwk2XyO1OjltCtYM8yWuSW38AFFsUh7NgmT2ISQn6LxK5lZATETo/wgKuhIPbwWTCUA+ZF4ZAKFIVcWqQvTeka0Plby4pSVnEKmgzDXm45rtwAUOrrpafToPNcaq3bO4tWy+kVpIIrlC3c+YfE4bc9y8bUa2N0mmqfTltWw+ALkINOReTXarVeRKPhu81QCgSjCUVpZ2R/d7LQIAgAAESQ6DJhyCwQEJtFbpvkLRAB6vDAgDTBYBzU1CDEMllappkMZMWwCMNhdXkshDm11YEBBJYB5BLIsRiSvE0FyqJQbB1edgF+H3iZhEhOTOBh3ebtKNyZ/40/D/Qw//+zDE/gBJ6HVjvYWAKPOObHWGCVwKxYYhmDMqGV0sjpqeHI3F5XTO1EpE6NWHdd33HPcYpoxbkErn9b1lrtX/////+vlSZWM7FcLhJQUAvy5QGCQfCwlYIiJ07/dd0KUFAKVYWZ////50YkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+zDE+wAH+IllqLyhqPyJrL0nrByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+yDE/wAH8EtjrDxjoQyNbHawYASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPQAGFTpVfncAEAAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",aF="/assets/rollingBallLoop-BUA084C_.mp3",lF="/assets/servosLoop-Bn-haKck.mp3",cF="/assets/servosStart-BgsySGJF.mp3",uF="/assets/servosStop-BR1i0gi5.mp3",hF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",dF="/assets/spring-CP3uOhml.mp3",fF="/assets/metalicScraping-BqmM5ys4.mp3",pF="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",mF="/assets/toasterPopUp-CNfTxQPs.mp3",gF="/assets/teleportIn-DZAhHW9-.mp3",AF="/assets/teleportOut-Bra-ABlh.mp3",yF="/assets/teleportWarningSiren-Boo1HoAB.mp3",xF=new window.AudioContext;let Da;const le=async t=>await xF.decodeAudioData(await(await fetch(t)).arrayBuffer()),bF=Ui(async()=>({bonus:await le(ID),bubbleRobotLoop:await le(jD),carry:await le(OD),conveyorEnd:await le(BD),conveyorLoop:await le(zD),conveyorStart:await le(ND),destroy:await le(DD),detect:await le(FD),drum:await le(LD),glassClink:await le(UD),headFall:await le(HD),headJump:await le($D),headWalk:await le(WD),heelsFall:await le(GD),heelsJump:await le(QD),heelsWalk:await le(YD),helicopter:await le(KD),hooter:await le(XD),hushPuppyVanish:await le(JD),jetpackLoop:await le(ZD),jetpackTurnaround:await le(eF),landing:await le(tF),metalHit:await le(rF),mojoLoop:await le(nF),mojoTurn:await le(sF),robotBeepingLoop:await le(iF),robotWhirLoop:await le(oF),rollingBallLoop:await le(aF),servoLoop:await le(lF),servoStart:await le(cF),servoStop:await le(uF),softBump:await le(hF),springBoing:await le(dF),stepStoolScraping:await le(fF),switchClick:await le(pF),toasterPopUpSoundUrl:await le(mF),teleportIn:await le(gF),teleportOut:await le(AF),teleportWarningSiren:await le(yF)})),qF=async()=>{Da===void 0&&(Da=await bF())},aU=()=>{if(Da===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Da},wF=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=ae(kS);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},yv=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},Py=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,vF=()=>{const t=RC(),e=ae(SS);C.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",St())},[]),C.useEffect(()=>{document.body.classList.remove(...Object.keys(Ss).map(Py)),document.body.classList.add(Py(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])};class VF extends C.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("Error caught in DispatchingErrorBoundary:",e),be.dispatch(Ob(yv(e)))}render(){return this.props.children}}const _F=C.lazy(RD),Ey=Ui(()=>Promise.all([MD(),Mj(),qF()])),SF=()=>{const[t,e]=C.useState(),r=ys(),n=ae(i=>i.gameMenus.gameInPlay.campaignLocator),s=Kd();return C.useEffect(()=>{if(!r){e(void 0),Ey();return}let i=!1,o;return(async()=>{let l=!1;try{if(n===void 0)throw new Error("game is marked as running, but we have no campaign locator, no way to know which campaign to load");l=!0,be.dispatch(JP());const[{default:c}]=await Ey();be.dispatch(og()),i||(o=await c(n,s),e(o))}catch(c){l&&be.dispatch(og()),console.error(c),be.dispatch(Ob(yv(new Error("error in loading game assets or state",{cause:c}))))}})(),()=>{o?.stop(),i=!0}},[r,s,n]),t},kF=()=>{const[t,e]=C.useState(null),r=PC(),n=SF(),s=ae(_S),i=wF();return vF(),C.useEffect(()=>{t===null||n===void 0||(n.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[n,t]),C.useEffect(()=>{n?.resizeTo(s)},[s,n]),p.jsxs(p.Fragment,{children:[p.jsx("div",{tabIndex:0,style:i,ref:e}),p.jsxs(GC,{gameApi:n,children:[p.jsxs(VF,{children:[p.jsx(tj,{}),p.jsx(TD,{})]}),n&&r&&p.jsx(C.Suspense,{fallback:null,children:p.jsx(_F,{})})]})]})},CF=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"loading-border"}),p.jsxs(_e,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:fs.map(t=>p.jsx("span",{className:`sprite ${qs({action:"idle",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(H,{className:"sprites-double-height mb-1",children:"This is not the editor"}),p.jsxs(gt,{className:`${Ve} p-1 pt-2 text-metallicBlue`,children:[p.jsx("p",{children:"If youre seeing this, youre trying to access the level editor, but the web manifest is getting in the way and redirected you to the games client-side routing."}),p.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",p.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),p.jsx("div",{className:"flex flex-col",children:fs.toReversed().map(t=>p.jsx("span",{className:`sprite ${qs({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),PF=()=>p.jsxs(Be,{children:[p.jsx(He,{className:"loading-border"}),p.jsxs(_e,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:fs.map(t=>p.jsx("span",{className:`sprite ${qs({action:"walking",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(H,{className:"sprites-double-height",children:"404 Not found"}),p.jsx(H,{className:`${Ve} p-1 pt-2 text-metallicBlue`,children:"whatever youre looking for, it aint here"})]}),p.jsx("div",{className:"flex flex-col",children:fs.toReversed().map(t=>p.jsx("span",{className:`sprite ${qs({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),xv=Rs(),Ty=xv.get("campaignName");Ty!==null&&be.dispatch(ka({campaignLocator:{userId:xv.get("campaignAuthorUserId")||"editorUser",campaignName:Ty,version:-1},noShowCrowns:!0}));const EF=()=>{const t=wd();return C.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),p.jsxs($v,{children:[p.jsx(oo,{path:"/",children:p.jsx(as,{children:p.jsx(XI,{children:p.jsx(kF,{})})})}),p.jsx(oo,{path:"/sprites",children:p.jsx(WC,{})}),p.jsx(oo,{path:"/editor",children:p.jsx(as,{children:p.jsx(CF,{})})}),p.jsx(oo,{children:p.jsx(as,{children:p.jsx(PF,{})})})]})},TF=()=>p.jsx($0,{store:be,children:p.jsx(EF,{})}),lU=Object.freeze(Object.defineProperty({__proto__:null,App:TF},Symbol.toStringTag,{value:"Module"}));export{dR as $,UR as A,Vt as B,ro as C,Ye as D,te as E,kr as F,mn as G,Jb as H,sr as I,uT as J,Vg as K,jT as L,ge as M,Le as N,Fe as O,ft as P,Sg as Q,dh as R,Ei as S,_t as T,Ea as U,pT as V,Mc as W,Cg as X,fT as Y,lt as Z,tq as _,pr as a,FF as a$,TR as a0,MR as a1,zR as a2,DR as a3,FR as a4,sl as a5,YP as a6,NP as a7,JN as a8,CO as a9,Nr as aA,wL as aB,TL as aC,HN as aD,ls as aE,Rh as aF,uD as aG,cN as aH,Mr as aI,iN as aJ,ue as aK,Jr as aL,Ht as aM,SV as aN,TV as aO,zt as aP,Te as aQ,Mi as aR,hA as aS,LF as aT,WL as aU,sx as aV,Mb as aW,Ph as aX,$i as aY,jL as aZ,Ij as a_,_O as aa,I2 as ab,R2 as ac,Ts as ad,FP as ae,Re as af,cs as ag,BB as ah,NB as ai,DB as aj,LB as ak,UB as al,$B as am,HB as an,FB as ao,PB as ap,Gj as aq,Sv as ar,ye as as,H as at,as as au,Xh as av,ZF as aw,gL as ax,qL as ay,eL as az,oR as b,XL as b$,er as b0,f0 as b1,HF as b2,be as b3,Rn as b4,fe as b5,CS as b6,tw as b7,HI as b8,Lt as b9,Xv as bA,eV as bB,Bz as bC,De as bD,rL as bE,eD as bF,XC as bG,Pb as bH,je as bI,Qh as bJ,dL as bK,Hy as bL,Bt as bM,pL as bN,G as bO,Ib as bP,mL as bQ,AL as bR,fP as bS,xL as bT,bL as bU,Tz as bV,RL as bW,Th as bX,ee as bY,Na as bZ,ot as b_,WI as ba,Uh as bb,_u as bc,kL as bd,ox as be,ea as bf,uP as bg,JL as bh,HC as bi,Qe as bj,Jv as bk,Uy as bl,Dh as bm,Ur as bn,QL as bo,a0 as bp,GL as bq,YL as br,KL as bs,qh as bt,CL as bu,Qt as bv,gf as bw,Ly as bx,Pr as by,Gv as bz,Ti as c,lN as c$,ht as c0,da as c1,iL as c2,sU as c3,NF as c4,_d as c5,JF as c6,Pi as c7,IF as c8,qe as c9,sL as cA,hl as cB,gv as cC,Pn as cD,qf as cE,JC as cF,ML as cG,TC as cH,Oz as cI,NL as cJ,DL as cK,jF as cL,UL as cM,LV as cN,Af as cO,Zv as cP,ui as cQ,uL as cR,aL as cS,lL as cT,hP as cU,fL as cV,cL as cW,Bb as cX,aN as cY,Ih as cZ,bf as c_,bn as ca,Lh as cb,jh as cc,Hi as cd,fs as ce,Wv as cf,tr as cg,ZN as ch,Fz as ci,oD as cj,_b as ck,hL as cl,oL as cm,dP as cn,jz as co,hy as cp,HL as cq,$L as cr,LL as cs,FL as ct,OL as cu,QN as cv,yf as cw,tD as cx,Cb as cy,YN as cz,Ie as d,Dg as d$,vb as d0,Mh as d1,rD as d2,Zu as d3,BF as d4,zF as d5,OF as d6,nU as d7,Lr as d8,mf as d9,Yz as dA,Kv as dB,wN as dC,Zy as dD,wr as dE,px as dF,OC as dG,MC as dH,dN as dI,St as dJ,Ob as dK,yv as dL,vL as dM,XF as dN,tL as dO,vd as dP,BL as dQ,Cn as dR,zL as dS,VL as dT,oU as dU,yL as dV,GP as dW,RE as dX,tU as dY,zM as dZ,Bq as d_,Gh as da,xF as db,aU as dc,Jh as dd,iU as de,IL as df,Nz as dg,id as dh,Ps as di,b_ as dj,s0 as dk,UF as dl,ex as dm,DF as dn,Gi as dp,ZL as dq,fv as dr,rU as ds,ns as dt,La as du,fy as dv,Jm as dw,YC as dx,nL as dy,eU as dz,kt as e,zg as e0,mA as e1,HM as e2,IE as e3,Pa as e4,yh as e5,fA as e6,Dq as e7,lU as e8,Ng as f,nR as g,oa as h,zd as i,hq as j,mr as k,_q as l,uA as m,ER as n,RR as o,OR as p,NR as q,GE as r,kq as s,Nd as t,me as u,dt as v,ke as w,ME as x,el as y,qq as z};
