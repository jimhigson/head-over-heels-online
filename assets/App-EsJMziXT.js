const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-B1gBJBkp.js","assets/webworkerAll-DQ7-C1L0.js","assets/Graphics-CewduW3m.js","assets/colorToUniform-KTpA7KSL.js","assets/index-Dzpo5HOe.js","assets/index-CgvoYggz.css","assets/campaign-CtabydHx.js","assets/RoomJson-CtsDLeft.js","assets/Cheats--Y1ORWcN.js","assets/changeCharacterRoom-jBfPcV0f.js","assets/gameMain-B0mEwjD2.js","assets/testCampaign-D29I7Sb6.js"])))=>i.map(i=>d[i]);
import{b as $r,r as I,R as tp,g as Ze,j as d,_ as Kr,t as Oe,d as $h,B as gt,D as De,L as Kh,i as Qr,c as Ds}from"./index-Dzpo5HOe.js";function rp(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,a=[],o="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(a.push(r),o+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),a.push(n.substring(1,~s?s:~i?i:n.length)),o+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~s?"?":"")+"\\"+n.substring(i))):o+="/"+n;return{keys:a,pattern:new RegExp("^"+o+(e?"(?=$|/)":"/?$"),"i")}}var ci={exports:{}},ui={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xl;function sp(){if(xl)return ui;xl=1;var t=$r();function e(h,A){return h===A&&(h!==0||1/h===1/A)||h!==h&&A!==A}var r=typeof Object.is=="function"?Object.is:e,s=t.useState,n=t.useEffect,i=t.useLayoutEffect,a=t.useDebugValue;function o(h,A){var f=A(),p=s({inst:{value:f,getSnapshot:A}}),g=p[0].inst,m=p[1];return i(function(){g.value=f,g.getSnapshot=A,l(g)&&m({inst:g})},[h,f,A]),n(function(){return l(g)&&m({inst:g}),h(function(){l(g)&&m({inst:g})})},[h]),a(f),f}function l(h){var A=h.getSnapshot;h=h.value;try{var f=A();return!r(h,f)}catch{return!0}}function c(h,A){return A()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return ui.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,ui}var yl;function np(){return yl||(yl=1,ci.exports=sp()),ci.exports}var ip=np();const ap=tp.useInsertionEffect,op=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lp=op?I.useLayoutEffect:I.useEffect,cp=ap||lp,Qh=t=>{const e=I.useRef([t,(...r)=>e[0](...r)]).current;return cp(()=>{e[0]=t}),e[1]},up="popstate",vo="pushState",_o="replaceState",hp="hashchange",Vl=[up,vo,_o,hp],dp=t=>{for(const e of Vl)addEventListener(e,t);return()=>{for(const e of Vl)removeEventListener(e,t)}},Zh=(t,e)=>ip.useSyncExternalStore(dp,t,e),fp=()=>location.search,Ap=({ssrSearch:t=""}={})=>Zh(fp,()=>t),bl=()=>location.pathname,pp=({ssrPath:t}={})=>Zh(bl,t?()=>t:bl),mp=(t,{replace:e=!1,state:r=null}={})=>history[e?_o:vo](r,"",t),gp=(t={})=>[pp(t),mp],ql=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[ql]>"u"){for(const t of[vo,_o]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,ql,{value:!0})}const xp=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Jh=(t="")=>t==="/"?"":t,yp=(t,e)=>t[0]==="~"?t.slice(1):Jh(e)+t,Vp=(t="",e)=>xp(wl(Jh(t)),wl(e)),wl=t=>{try{return decodeURI(t)}catch{return t}},ed={hook:gp,searchHook:Ap,parser:rp,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},td=I.createContext(ed),ko=()=>I.useContext(td),rd={},sd=I.createContext(rd),bp=()=>I.useContext(sd),nd=t=>{const[e,r]=t.hook(t);return[Vp(t.base,e),Qh((s,n)=>r(yp(s,t.base),n))]},qp=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),a=n.exec(r)||[],[o,...l]=a;return o!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,A)=>[h,l[A]])):a.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[o]:[]]:[!1,null]},wp=({children:t,...e})=>{const r=ko(),s=e.hook?ed:r;let n=s;const[i,a]=e.ssrPath?.split("?")??[];a&&(e.ssrSearch=a,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let o=I.useRef({}),l=o.current,c=l;for(let u in s){const h=u==="base"?s[u]+(e[u]||""):e[u]||s[u];l===c&&h!==c[u]&&(o.current=c={...c}),c[u]=h,h!==s[u]&&(n=c)}return I.createElement(td.Provider,{value:n,children:t})},vl=({children:t,component:e},r)=>e?I.createElement(e,{params:r}):typeof t=="function"?t(r):t,vp=t=>{let e=I.useRef(rd);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},_l=({path:t,nest:e,match:r,...s})=>{const n=ko(),[i]=nd(n),[a,o,l]=r??qp(n.parser,t,i,e),c=vp({...bp(),...o});if(!a)return null;const u=l?I.createElement(wp,{base:l},vl(s,c)):vl(s,c);return I.createElement(sd.Provider,{value:c,children:u})};I.forwardRef((t,e)=>{const r=ko(),[s,n]=nd(r),{to:i="",href:a=i,onClick:o,asChild:l,children:c,className:u,replace:h,state:A,...f}=t,p=Qh(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(o?.(m),m.defaultPrevented||(m.preventDefault(),n(a,t)))}),g=r.hrefs(a[0]==="~"?a.slice(1):r.base+a,r);return l&&I.isValidElement(c)?I.cloneElement(c,{onClick:p,href:g}):I.createElement("a",{...f,onClick:p,href:g,className:u?.call?u(s===a):u,children:c,ref:e})});const Ue=t=>t[Symbol.iterator](),_p=1e-4,Vr=(t,e)=>Math.abs(t-e)<_p,Ke=Number.MIN_SAFE_INTEGER,zs=["away","towards","left","right"],kp=["awayRight","towardsRight","towardsLeft","awayLeft"],Sp=[...zs,...kp],So=t=>t==="away"||t==="towards"?"y":"x",Sk=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",Co=t=>Mo(So(t)),Mo=t=>t==="x"?"y":"x",Xe=(t,...e)=>e.reduce((r,s)=>({x:r.x+(s.x??0),y:r.y+(s.y??0)}),t),Cp=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0)}),t),id=(t,e)=>({x:t.x*e,y:t.y*e}),ad=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),Mp=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),od=({x:t,y:e,z:r})=>Math.sqrt(t*t+e*e+r*r),ld=({x:t,y:e})=>Math.sqrt(t*t+e*e),Or=t=>ad(t,1/od(t)),Ae=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n=0,y:i=0,z:a=0})=>({x:e+n,y:r+i,z:s+a}),ge),Mn=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0),z:r.z-(s.z??0)}),t),Pp=({x:t,y:e,z:r},{x:s,y:n,z:i})=>t===s&&e===n&&r===i,Tp=({x:t,y:e},{x:r,y:s})=>t===r&&e===s,Ck=t=>{const{x:e}=t,r=Math.round(e),s=!Number.isInteger(e)&&Vr(e,r),{y:n}=t,i=Math.round(n),a=!Number.isInteger(n)&&Vr(n,i),{z:o}=t,l=Math.round(o),c=!Number.isInteger(o)&&Vr(t.z,l);return s||a||c?{x:s?r:e,y:a?i:n,z:c?l:o}:t},Mk=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),Pk=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),cd=Object.freeze({x:0,y:0}),ge=Object.freeze({x:0,y:0,z:0}),Tk=["x","y","z"],Ep=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,Ip=({x:t,y:e})=>{if(!(Vr(t,0)&&Vr(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},Rp=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],Vn=({x:t,y:e})=>{if(Vr(t,0)&&Vr(e,0))return;const r=Math.atan2(-e,-t),s=Math.round(8*r/(2*Math.PI))&7;return Rp[s]},Ek=({x:t,y:e},{x:r,y:s})=>Math.abs(r-t)**2+Math.abs(s-e)**2;var hi={exports:{}},di={exports:{}},kl;function _r(){return kl||(kl=1,function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(di)),di.exports}var Sl;function Bp(){return Sl||(Sl=1,function(t){var e=_r().default;function r(){t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var s,n={},i=Object.prototype,a=i.hasOwnProperty,o=Object.defineProperty||function(w,b,k){w[b]=k.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function A(w,b,k){return Object.defineProperty(w,b,{value:k,enumerable:!0,configurable:!0,writable:!0}),w[b]}try{A({},"")}catch{A=function(k,M,E){return k[M]=E}}function f(w,b,k,M){var E=b&&b.prototype instanceof S?b:S,z=Object.create(E.prototype),L=new v(M||[]);return o(z,"_invoke",{value:W(w,k,L)}),z}function p(w,b,k){try{return{type:"normal",arg:w.call(b,k)}}catch(M){return{type:"throw",arg:M}}}n.wrap=f;var g="suspendedStart",m="suspendedYield",V="executing",y="completed",q={};function S(){}function P(){}function C(){}var T={};A(T,c,function(){return this});var j=Object.getPrototypeOf,B=j&&j(j(_([])));B&&B!==i&&a.call(B,c)&&(T=B);var R=C.prototype=S.prototype=Object.create(T);function D(w){["next","throw","return"].forEach(function(b){A(w,b,function(k){return this._invoke(b,k)})})}function K(w,b){function k(E,z,L,X){var $=p(w[E],w,z);if($.type!=="throw"){var Z=$.arg,he=Z.value;return he&&e(he)=="object"&&a.call(he,"__await")?b.resolve(he.__await).then(function(ee){k("next",ee,L,X)},function(ee){k("throw",ee,L,X)}):b.resolve(he).then(function(ee){Z.value=ee,L(Z)},function(ee){return k("throw",ee,L,X)})}X($.arg)}var M;o(this,"_invoke",{value:function(z,L){function X(){return new b(function($,Z){k(z,L,$,Z)})}return M=M?M.then(X,X):X()}})}function W(w,b,k){var M=g;return function(E,z){if(M===V)throw Error("Generator is already running");if(M===y){if(E==="throw")throw z;return{value:s,done:!0}}for(k.method=E,k.arg=z;;){var L=k.delegate;if(L){var X=te(L,k);if(X){if(X===q)continue;return X}}if(k.method==="next")k.sent=k._sent=k.arg;else if(k.method==="throw"){if(M===g)throw M=y,k.arg;k.dispatchException(k.arg)}else k.method==="return"&&k.abrupt("return",k.arg);M=V;var $=p(w,b,k);if($.type==="normal"){if(M=k.done?y:m,$.arg===q)continue;return{value:$.arg,done:k.done}}$.type==="throw"&&(M=y,k.method="throw",k.arg=$.arg)}}}function te(w,b){var k=b.method,M=w.iterator[k];if(M===s)return b.delegate=null,k==="throw"&&w.iterator.return&&(b.method="return",b.arg=s,te(w,b),b.method==="throw")||k!=="return"&&(b.method="throw",b.arg=new TypeError("The iterator does not provide a '"+k+"' method")),q;var E=p(M,w.iterator,b.arg);if(E.type==="throw")return b.method="throw",b.arg=E.arg,b.delegate=null,q;var z=E.arg;return z?z.done?(b[w.resultName]=z.value,b.next=w.nextLoc,b.method!=="return"&&(b.method="next",b.arg=s),b.delegate=null,q):z:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,q)}function Me(w){var b={tryLoc:w[0]};1 in w&&(b.catchLoc=w[1]),2 in w&&(b.finallyLoc=w[2],b.afterLoc=w[3]),this.tryEntries.push(b)}function x(w){var b=w.completion||{};b.type="normal",delete b.arg,w.completion=b}function v(w){this.tryEntries=[{tryLoc:"root"}],w.forEach(Me,this),this.reset(!0)}function _(w){if(w||w===""){var b=w[c];if(b)return b.call(w);if(typeof w.next=="function")return w;if(!isNaN(w.length)){var k=-1,M=function E(){for(;++k<w.length;)if(a.call(w,k))return E.value=w[k],E.done=!1,E;return E.value=s,E.done=!0,E};return M.next=M}}throw new TypeError(e(w)+" is not iterable")}return P.prototype=C,o(R,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:P,configurable:!0}),P.displayName=A(C,h,"GeneratorFunction"),n.isGeneratorFunction=function(w){var b=typeof w=="function"&&w.constructor;return!!b&&(b===P||(b.displayName||b.name)==="GeneratorFunction")},n.mark=function(w){return Object.setPrototypeOf?Object.setPrototypeOf(w,C):(w.__proto__=C,A(w,h,"GeneratorFunction")),w.prototype=Object.create(R),w},n.awrap=function(w){return{__await:w}},D(K.prototype),A(K.prototype,u,function(){return this}),n.AsyncIterator=K,n.async=function(w,b,k,M,E){E===void 0&&(E=Promise);var z=new K(f(w,b,k,M),E);return n.isGeneratorFunction(b)?z:z.next().then(function(L){return L.done?L.value:z.next()})},D(R),A(R,h,"Generator"),A(R,c,function(){return this}),A(R,"toString",function(){return"[object Generator]"}),n.keys=function(w){var b=Object(w),k=[];for(var M in b)k.push(M);return k.reverse(),function E(){for(;k.length;){var z=k.pop();if(z in b)return E.value=z,E.done=!1,E}return E.done=!0,E}},n.values=_,v.prototype={constructor:v,reset:function(b){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(x),!b)for(var k in this)k.charAt(0)==="t"&&a.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=s)},stop:function(){this.done=!0;var b=this.tryEntries[0].completion;if(b.type==="throw")throw b.arg;return this.rval},dispatchException:function(b){if(this.done)throw b;var k=this;function M(Z,he){return L.type="throw",L.arg=b,k.next=Z,he&&(k.method="next",k.arg=s),!!he}for(var E=this.tryEntries.length-1;E>=0;--E){var z=this.tryEntries[E],L=z.completion;if(z.tryLoc==="root")return M("end");if(z.tryLoc<=this.prev){var X=a.call(z,"catchLoc"),$=a.call(z,"finallyLoc");if(X&&$){if(this.prev<z.catchLoc)return M(z.catchLoc,!0);if(this.prev<z.finallyLoc)return M(z.finallyLoc)}else if(X){if(this.prev<z.catchLoc)return M(z.catchLoc,!0)}else{if(!$)throw Error("try statement without catch or finally");if(this.prev<z.finallyLoc)return M(z.finallyLoc)}}}},abrupt:function(b,k){for(var M=this.tryEntries.length-1;M>=0;--M){var E=this.tryEntries[M];if(E.tryLoc<=this.prev&&a.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var z=E;break}}z&&(b==="break"||b==="continue")&&z.tryLoc<=k&&k<=z.finallyLoc&&(z=null);var L=z?z.completion:{};return L.type=b,L.arg=k,z?(this.method="next",this.next=z.finallyLoc,q):this.complete(L)},complete:function(b,k){if(b.type==="throw")throw b.arg;return b.type==="break"||b.type==="continue"?this.next=b.arg:b.type==="return"?(this.rval=this.arg=b.arg,this.method="return",this.next="end"):b.type==="normal"&&k&&(this.next=k),q},finish:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var M=this.tryEntries[k];if(M.finallyLoc===b)return this.complete(M.completion,M.afterLoc),x(M),q}},catch:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var M=this.tryEntries[k];if(M.tryLoc===b){var E=M.completion;if(E.type==="throw"){var z=E.arg;x(M)}return z}}throw Error("illegal catch attempt")},delegateYield:function(b,k,M){return this.delegate={iterator:_(b),resultName:k,nextLoc:M},this.method==="next"&&(this.arg=s),q}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(hi)),hi.exports}var fi,Cl;function js(){if(Cl)return fi;Cl=1;var t=Bp()();fi=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return fi}var lt={},Ai={exports:{}},pi={exports:{}},mi={exports:{}},Ml;function zp(){return Ml||(Ml=1,function(t){var e=_r().default;function r(s,n){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,n||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(mi)),mi.exports}var Pl;function jp(){return Pl||(Pl=1,function(t){var e=_r().default,r=zp();function s(n){var i=r(n,"string");return e(i)=="symbol"?i:i+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(pi)),pi.exports}var Tl;function Fp(){return Tl||(Tl=1,function(t){var e=jp();function r(s,n,i){return(n=e(n))in s?Object.defineProperty(s,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[n]=i,s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ai)),Ai.exports}var gi={exports:{}},xi={exports:{}},yi={exports:{}},El;function ud(){return El||(El=1,function(t){function e(r,s){(s==null||s>r.length)&&(s=r.length);for(var n=0,i=Array(s);n<s;n++)i[n]=r[n];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(yi)),yi.exports}var Il;function Np(){return Il||(Il=1,function(t){var e=ud();function r(s){if(Array.isArray(s))return e(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(xi)),xi.exports}var Vi={exports:{}},Rl;function Op(){return Rl||(Rl=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Vi)),Vi.exports}var bi={exports:{}},Bl;function hd(){return Bl||(Bl=1,function(t){var e=ud();function r(s,n){if(s){if(typeof s=="string")return e(s,n);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,n):void 0}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(bi)),bi.exports}var qi={exports:{}},zl;function Lp(){return zl||(zl=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(qi)),qi.exports}var jl;function dd(){return jl||(jl=1,function(t){var e=Np(),r=Op(),s=hd(),n=Lp();function i(a){return e(a)||r(a)||s(a)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(gi)),gi.exports}var wi={},vi={},Fl;function Po(){if(Fl)return vi;Fl=1;function t(e){return typeof e<"u"}return vi.notUndefined=t,vi}var Nl;function fd(){if(Nl)return wi;Nl=1;var t=Po(),e=t.notUndefined;function r(s){return s!=null&&e(s[Symbol.iterator])}return wi.isIterable=r,wi}var _i={},Ol;function Dp(){return Ol||(Ol=1,_i.isLoopable=fd().isIterable),_i}var ki={},Ll;function Hp(){if(Ll)return ki;Ll=1;var t=Po(),e=t.notUndefined;function r(s){return s==null||e(s[Symbol.iterator])}return ki.isWrappable=r,ki}var Hs={},Dl;function Gp(){if(Dl)return Hs;Dl=1;var t=js(),e=t.mark(s),r=t.mark(n);function s(i){return t.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.delegateYield(i,"t0",1);case 1:case"end":return o.stop()}},e)}Hs.wrap=s;function n(i){return t.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(i==null){o.next=2;break}return o.delegateYield(i,"t0",2);case 2:case"end":return o.stop()}},r)}return Hs.nullableWrap=n,Hs}var Gs={},Hl;function Wp(){if(Hl)return Gs;Hl=1;var t=dd();function e(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.length,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return i<=l.length?n.apply(void 0,t(a).concat(l)):e(n,i-l.length,[].concat(t(a),l))}}Gs.curry=e;function r(n,i){var a=n.fn,o=n.validateArgs,l=n.variadic,c=n.reduces,u=n.growRight,h=n.minArgs,A=n.maxArgs,f=n.isIterable,p=n.iterableType,g=n.applyOnIterableArgs,m=n.IterableClass;if(i.length>h){var V=!0,y=l?i.findIndex(function(B,R){return f(B)&&R>=h}):Math.min(A,i.length-1),q=l?i.length:y+1;if(l)for(var S=y;S<i.length;S++)V=V&&f(i[S]);else V=f(i[y]);if(i.length>A&&(y===-1||!V)){var P=l?"...".concat(p,"s"):p,C="".concat(a.name," takes up to ").concat(A," arguments, followed by ").concat(P,". ")+"You already passed ".concat(i.length," arguments");throw l?new Error("".concat(C," and the following arguments were not all ").concat(p,"s")):new Error("".concat(C," and the last argument was not ").concat(p))}if(y>=0&&V){for(var T=y;T<q;T++)i[T]=g(i[T]);var j=l?i.slice(y):i[y];return i.splice(y),u||i.reverse(),i.unshift(j),o(i),c?a.apply(void 0,t(i)):new m(a,i)}}return s(n,i)}function s(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];if(o.length===0)throw new Error("Cannot make a partial application with no arguments");return o.unshift.apply(o,t(i)),r(n,o)}}return Gs.variadicCurryWithValidation=s,Gs}var ns={},Gl;function Up(){if(Gl)return ns;Gl=1;var t=Symbol.for("_");ns._=t;var e=Symbol("__iterate");ns.__iterate=e;var r=Symbol("split");return ns.split=r,ns}var Wl;function kr(){if(Wl)return lt;Wl=1;var t=Fp(),e=dd(),r,s=fd(),n=s.isIterable,i=Dp(),a=i.isLoopable,o=Hp(),l=o.isWrappable,c=Gp(),u=c.nullableWrap,h=Wp(),A=h.variadicCurryWithValidation,f=Up(),p=f._,g=f.__iterate;lt.wrap=u,lt.isIterable=n,lt.isLoopable=a,lt.isWrappable=l;function m(j){if(l(j))return n(j)?j:u(j);throw typeof j.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}lt.ensureIterable=m;function V(j){"return"in j&&j.return()}lt.callReturn=V;function y(j,B){this[p]={fn:j,args:B,staticIterator:null}}lt.BaseIterableIterator=y,Object.assign(y.prototype,(r={constructor:y},t(r,g,function(){var j=this[p],B=j.fn,R=j.args;return B.apply(void 0,e(R))}),t(r,"next",function(){var B=this[p];return B.staticIterator=B.staticIterator||this[g](),B.staticIterator.next()}),t(r,"return",function(B){var R=this[p];return R.staticIterator=R.staticIterator||this[g](),R.staticIterator.return(B)}),t(r,"throw",function(B){var R=this[p];return R.staticIterator=R.staticIterator||this[g](),R.staticIterator.throw(B)}),r));function q(){for(var j=arguments.length,B=new Array(j),R=0;R<j;R++)B[R]=arguments[R];y.apply(this,B)}lt.IterableIterator=q,q.prototype=Object.assign(Object.create(y.prototype),t({constructor:q},Symbol.iterator,function(){return this[g]()}));function S(j){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=B.validateArgs,D=R===void 0?function(z){}:R,K=B.variadic,W=K===void 0?!1:K,te=B.reduces,Me=te===void 0?!1:te,x=B.growRight,v=x===void 0?!1:x,_=B.minArgs,w=_===void 0?j.length-1:_,b=B.maxArgs,k=b===void 0?j.length-1:b,M=B.applyOnIterableArgs,E=M===void 0?m:M;return{fn:j,validateArgs:D,variadic:W,reduces:Me,growRight:v,minArgs:w,maxArgs:k,isIterable:l,iterableType:"iterable",applyOnIterableArgs:E,IterableClass:q}}function P(j){return e(j)}lt.cache=P;function C(j){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=B.validateArgs,D=R===void 0?function(K){return K}:R;return function(){for(var K=arguments.length,W=new Array(K),te=0;te<K;te++)W[te]=arguments[te];return D(W),new q(j,W)}}lt.wrapWithIterableIterator=C;var T=function(B,R){return A(S(B,R))};return lt.iterableCurry=T,lt}var is={},Ul;function Yp(){if(Ul)return is;Ul=1;function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&isFinite(s)&&!(n&&s===0)}is.isInteger=t;function e(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return t(s)&&(n?s>0:s>=0)}is.isPositiveInteger=e;function r(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&!(n&&s===0)}return is.isIntegerOrInfinite=r,is}var Si={exports:{}},Ci={exports:{}},Yl;function Xp(){return Yl||(Yl=1,function(t){function e(r){if(Array.isArray(r))return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ci)),Ci.exports}var Mi={exports:{}},Xl;function $p(){return Xl||(Xl=1,function(t){function e(r,s){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,o,l,c=[],u=!0,h=!1;try{if(o=(n=n.call(r)).next,s===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=o.call(n)).done)&&(c.push(i.value),c.length!==s);u=!0);}catch(A){h=!0,a=A}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(h)throw a}}return c}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Mi)),Mi.exports}var Pi={exports:{}},$l;function Kp(){return $l||($l=1,function(t){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Pi)),Pi.exports}var Kl;function Qp(){return Kl||(Kl=1,function(t){var e=Xp(),r=$p(),s=hd(),n=Kp();function i(a,o){return e(a)||r(a,o)||s(a,o)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(Si)),Si.exports}var Ti={},Ql;function Zp(){if(Ql)return Ti;Ql=1;var t=_r();function e(r){return t(r)==="object"&&r!==null}return Ti.isObject=e,Ti}var Ws={},Us={},Zl;function Jp(){if(Zl)return Us;Zl=1;var t=kr(),e=t.iterableCurry,r=t.callReturn;function s(i,a){var o=i[Symbol.iterator](),l=o.next(),c=l.value,u=l.done;return u?a:(r(o),c)}Us.__firstOr=s;var n=e(s,{reduces:!0});return Us.firstOr=n,Us}var Jl;function em(){if(Jl)return Ws;Jl=1;var t=kr(),e=t.iterableCurry,r=Jp(),s=r.__firstOr;function n(a){return s(a,void 0)}Ws.__first=n;var i=e(n,{reduces:!0});return Ws.first=i,Ws}var Ys={},ec;function tm(){if(ec)return Ys;ec=1;var t=_r(),e=js(),r=e.mark(a),s=kr(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,[c,l[c]];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Ys.__objectEntries=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return Ys.objectEntries=o,Ys}var Xs={},tc;function rm(){if(tc)return Xs;tc=1;var t=_r(),e=js(),r=e.mark(a),s=kr(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,c;case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Xs.__objectKeys=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return Xs.objectKeys=o,Xs}var $s={},rc;function sm(){if(rc)return $s;rc=1;var t=_r(),e=js(),r=e.mark(a),s=kr(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function a(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,l[c];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}$s.__objectValues=a;var o=n(a,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return $s.objectValues=o,$s}var Ks={},sc;function nm(){if(sc)return Ks;sc=1;var t=Qp(),e=js(),r=e.mark(A),s=kr(),n=s.wrapWithIterableIterator,i=Yp(),a=i.isInteger,o=i.isIntegerOrInfinite,l=Zp(),c=l.isObject,u=Po(),h=u.notUndefined;function A(){var p,g,m,V,y=arguments;return e.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:p=y.length>0&&y[0]!==void 0?y[0]:0,g=y.length>1&&y[1]!==void 0?y[1]:1/0,m=y.length>2&&y[2]!==void 0?y[2]:1,V=p;case 4:if(!(m>0?V<g:V>g)){S.next=10;break}return S.next=7,V;case 7:V+=m,S.next=4;break;case 10:case"end":return S.stop()}},r)}Ks.__range=A;var f=n(A,{growRight:!0,validateArgs:function(g){var m=t(g,3),V=m[0],y=m[1],q=y===void 0?1/0:y,S=m[2],P;if(c(V)?(P=V.start,q=V.end,S=V.step):g.length>1?P=V:q=V,h(P)&&!a(P))throw new TypeError("The specified start was not an integer");if(h(q)&&!o(q))throw new TypeError("The specified end was not an integer or infinite");if(h(S)&&!a(S,!0))throw new TypeError("The specified step was not a non-zero integer");g[0]=P,g[1]=q,g[2]=S}});return Ks.range=f,Ks}var Qs={},nc;function im(){if(nc)return Qs;nc=1;function t(o,l){var c;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(c=e(o))||l){c&&(o=c);var u=0,h=function(){};return{s:h,n:function(){return u>=o.length?{done:!0}:{done:!1,value:o[u++]}},e:function(m){throw m},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A=!0,f=!1,p;return{s:function(){c=o[Symbol.iterator]()},n:function(){var m=c.next();return A=m.done,m},e:function(m){f=!0,p=m},f:function(){try{!A&&c.return!=null&&c.return()}finally{if(f)throw p}}}}function e(o,l){if(o){if(typeof o=="string")return r(o,l);var c=Object.prototype.toString.call(o).slice(8,-1);if(c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set")return Array.from(o);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(o,l)}}function r(o,l){(l==null||l>o.length)&&(l=o.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=o[c];return u}var s=kr(),n=s.ensureIterable;function i(o){var l=n(o),c=0,u=t(l),h;try{for(u.s();!(h=u.n()).done;){var A=h.value;c++}}catch(f){u.e(f)}finally{u.f()}return c}Qs.__size=i;var a=i;return Qs.size=a,Qs}var Ei,ic;function am(){return ic||(ic=1,Ei=em().first),Ei}var om=am();const lm=Ze(om);var Ii,ac;function cm(){return ac||(ac=1,Ii=tm().objectEntries),Ii}var um=cm();const To=Ze(um);var Ri,oc;function hm(){return oc||(oc=1,Ri=rm().objectKeys),Ri}var dm=hm();const Ad=Ze(dm);var Bi,lc;function fm(){return lc||(lc=1,Bi=sm().objectValues),Bi}var Am=fm();const Yn=Ze(Am);var zi,cc;function pm(){return cc||(cc=1,zi=nm().range),zi}var mm=pm();const gm=Ze(mm);var ji,uc;function xm(){return uc||(uc=1,ji=im().size),ji}var ym=xm();const Ga=Ze(ym),cr=(t,{x:e,y:r},s)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:r,...s}}],yield[`${t}.away`,{frame:{x:e+s.w+1,y:r,...s}}],yield[`${t}.towards`,{frame:{x:e,y:r+s.h+1,...s}}],yield[`${t}.right`,{frame:{x:e+s.w+1,y:r+s.h+1,...s}}]}return Object.fromEntries(n())},oe=(t,e,{x:r,y:s},n)=>{function*i(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a*(n.w+1),y:s,...n}}]}return Object.fromEntries(i())},Vm=(t,e,r,s)=>({...oe(`${t}.left`,e,r,s),...oe(`${t}.away`,e,Xe(r,{x:(s.w+1)*e}),s),...oe(`${t}.towards`,e,Xe(r,{y:s.h+1}),s),...oe(`${t}.right`,e,Xe(r,{x:(s.w+1)*e,y:s.h+1}),s)}),Wa=(t,e)=>[...Ue(gm(1,e+1)).map(r=>`${t}.${String(r)}`)],ds={w:32,h:16},Ft={w:16,h:56},ue={w:32,h:28},F={w:24,h:24},kt={w:8,h:8},N=t=>({x:t.x*(F.w+1)+1,y:t.y*(F.h+1)+2}),de=t=>({x:t.x*(ue.w+1)+1,y:t.y*(ue.h+1)+396}),Ik=["yellow","cyan","green","magenta","white"],Rk=["basic","dimmed"],Xn=25,Bk=1e3/Xn,Sr={amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},bm=Object.keys(Sr),zk={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},xe=(t,e)=>Object.assign([...t],{animationSpeed:e}),qm=.5,as=(t,e)=>{const s=Math.round(5e3/(Xn*4))-3,n=[...new Array(s).fill(`head.walking.${t}.${e}`),`head.blinking.${t}`,`head.walking.${t}.${e}`,`head.blinking.${t}`];return xe(n,.5)};function hc(t){function*e(r,s){yield`${r}.walking.${s}.1`,yield`${r}.walking.${s}.2`,yield`${r}.walking.${s}.3`,yield`${r}.walking.${s}.2`}return Sp.reduce((r,s)=>({...r,[`${t}.walking.${s}`]:xe([...e(t,s)],qm)}),{})}const wm={...oe("bubbles.head",6,N({x:0,y:6}),F),...oe("head.walking.towards",3,N({x:1,y:11}),F),...oe("head.walking.right",3,N({x:4,y:11}),F),...oe("head.walking.left",3,N({x:1,y:9}),F),...oe("head.walking.away",3,N({x:4,y:9}),F),...oe("head.walking.towardsRight",3,N({x:2,y:12}),F),...oe("head.walking.towardsLeft",3,N({x:1,y:10}),F),...oe("head.walking.awayRight",3,N({x:4,y:10}),F),...oe("head.walking.awayLeft",3,N({x:2,y:8}),F),"head.blinking.towards":{frame:{...N({x:0,y:12}),...F}},"head.blinking.right":{frame:{...N({x:7,y:12}),...F}},"head.blinking.towardsRight":{frame:{...N({x:5,y:12}),...F}},"head.blinking.awayRight":{frame:{...N({x:7,y:9}),...F}},"head.blinking.towardsLeft":{frame:{...N({x:0,y:9}),...F}},"head.falling.left":{frame:{...N({x:1,y:8}),...F}},"head.falling.away":{frame:{...N({x:6,y:8}),...F}},"head.falling.awayLeft":{frame:{...N({x:3,y:7}),...F}},"head.falling.towards":{frame:{...N({x:0,y:11}),...F}},"head.falling.right":{frame:{...N({x:7,y:11}),...F}},"head.falling.towardsRight":{frame:{...N({x:6,y:12}),...F}},"head.falling.awayRight":{frame:{...N({x:7,y:10}),...F}},"head.falling.towardsLeft":{frame:{...N({x:0,y:10}),...F}},...oe("bubbles.heels",6,N({x:6,y:6}),F),...oe("heels.walking.towards",3,N({x:8,y:11}),F),...oe("heels.walking.right",3,N({x:11,y:11}),F),...oe("heels.walking.left",3,N({x:8,y:9}),F),...oe("heels.walking.away",3,N({x:11,y:9}),F),...oe("heels.walking.towardsRight",3,N({x:10,y:12}),F),...oe("heels.walking.towardsLeft",3,N({x:8,y:10}),F),...oe("heels.walking.awayRight",3,N({x:11,y:10}),F),...oe("heels.walking.awayLeft",3,N({x:10,y:8}),F),...oe("shine",6,de({x:4,y:-1}),ue),blank:{frame:{...N({x:14,y:6}),...F}}},pd={frames:wm,animations:{...hc("head"),...hc("heels"),"heels.screenDirections":xe(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":xe(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":as("right",3),"head.idle.towards":as("towards",3),"head.idle.towardsRight":as("towardsRight",2),"head.idle.towardsLeft":as("towardsLeft",2),"head.idle.awayRight":as("awayRight",2),"head.fadeOut":xe(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":xe(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:xe(Wa("shine",6),.5),"shine.headInSymbio":xe(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":xe(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},md={jail:{walls:["bars"]},blacktooth:{walls:["armour","shield","plain"]},bookworld:{walls:["cowboy","book"]},egyptus:{walls:["sarcophagus","hieroglyphics"]},market:{walls:["passage","fruits","more-fruits"]},moonbase:{walls:["window1","window2","window3","coil"]},penitentiary:{walls:["loop","skeleton"]},safari:{walls:["window","shield","wall"]}},jk=Object.keys(md),He=(t,e,r,s)=>{function*n(i,a,o){const{walls:l}=md[i],{w:c,h:u}=Ft,h=c>>1,A=l.length;let f=0;for(;f<l.length;f++)yield[`${i}${s}.wall.${l[f]}.left`,{frame:{x:a+c*f,y:o-h*f,...Ft}}],yield[`${i}${s}.wall.${l[f]}.away`,{frame:{x:a+c*((A<<1)-f-1),y:o-h*f,...Ft}}];const p=f-1;yield[`${i}${s}.floor`,{frame:{x:a+p*c,y:o-p*h+u,...ds}}]}return Object.fromEntries(n(t,e,r))},dc={w:16,h:13},fc={w:8,h:9},vm={...He("blacktooth",542,104,".dark"),...He("blacktooth",542,29,""),...He("bookworld",408,29,".dark"),...He("bookworld",408,29,""),...He("egyptus",475,29,""),...He("egyptus",475,104,".dark"),...He("jail",440,104,".dark"),...He("jail",440,104,""),...He("market",443,356,".dark"),...He("market",443,356,""),...He("moonbase",453,276,".dark"),...He("moonbase",453,204,""),...He("penitentiary",376,357,".dark"),...He("penitentiary",376,357,""),...He("safari",542,357,".dark"),...He("safari",542,357,""),"floorEdge.right":{frame:{x:418,y:466,...dc,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...dc,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...fc,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...fc,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:435,y:452,w:Ft.w,h:ds.h*2}},"floorOverdraw.behindDoor":{frame:{x:452,y:452,w:Ft.w,h:ds.h*2}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:407,y:143,...ds}},"generic.dark.floor.deadly":{frame:{x:407,y:160,...ds}},"generic.door.legs.pillar":{frame:{x:524,y:476,w:Ft.w,h:12}},"generic.door.legs.base":{frame:{x:524,y:488,w:Ft.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Ft.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Ft.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Ft.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:496,y:477,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:469,y:477,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:24,y:28}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}}},_m={frames:vm},gd=Object.entries,xd=To,yd=Object.keys,Eo=Ad,km=Object.fromEntries,Fs=Object.fromEntries,Vd=(t,e)=>{const s=Ue(xd(t)).map(e);return km(s)},Sm={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},bd=t=>Sm[t]??t,qd="ï‡¿",Cm="î©¸",Mm="ï”Ž",Pm="ó±‚©",Tm="ï‘—",Em=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"],Im=[" ","?","!",".",",",";",":","/","\\","â€˜","â€™","'","`","-","+","%","â¬…","âž¡","â¬†","â¬‡","â†–","â†˜","â†—","â†™","(",")","[","]","<",">","â©","âŒ","â","EnterFullscreen","ExitFullscreen","Menu","*","@",Cm,Mm,Pm,Tm,"â€¢"],Ac=(t,e)=>{function*r(){for(let s=0;s<t.length;s++){const n=t[s];yield[`hud.char.${bd(n)}`,{frame:{x:e.x+s*(kt.w+1),y:e.y,...kt}}]}}return Fs(r())},Rm={frames:{...Ac(Em,{x:151,y:2}),...Ac(Im,{x:151,y:11}),"hud.fastSteps":{frame:{x:475,y:2,...kt}},"hud.shield":{frame:{x:484,y:2,...kt}},"hud.bigJumps":{frame:{x:493,y:2,...kt}},"hud.char.ðŸ•¹":{frame:{x:502,y:2,...kt}},"hud.char.âˆž":{frame:{x:511,y:2,w:kt.w*2,h:kt.h}},[`hud.char.${qd}`]:{frame:{x:527,y:2,w:kt.w*2,h:kt.h}}}},Pr=(t,e,r)=>{const s=({x:i,y:a,w:o,h:l,pivot:c})=>e==="x"?{...Xe(r,{x:-i-o-1,y:a}),w:o,h:l,pivot:{x:o-c.x,y:c.y}}:{...Xe(r,{x:i+2,y:a}),w:o,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.far`,{frame:{...s({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...s({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...s({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return Fs(n())},Bm={frames:{...Pr("generic","y",{x:580,y:415}),...Pr("generic","x",{x:582,y:415}),...Pr("moonbase","y",{x:451,y:204}),...Pr("moonbase","x",{x:582,y:204}),...Pr("moonbase.dark","y",{x:451,y:276}),...Pr("moonbase.dark","x",{x:582,y:276})}},zm={...oe("dalek",2,N({x:0,y:0}),F),"shadowMask.dalek":{frame:{...N({x:2,y:0}),...F}},...oe("bubbles.cold",2,N({x:3,y:0}),F),homingBot:{frame:{...N({x:5,y:0}),...F}},ball:{frame:{...N({x:0,y:1}),...F}},...cr("cyberman",N({x:1,y:1}),F),...cr("charles",N({x:4,y:1}),F),...cr("elephant",N({x:6,y:1}),F),"crown.blacktooth":{frame:{...N({x:8,y:1}),...F}},"crown.safari":{frame:{...N({x:9,y:1}),...F}},"crown.egyptus":{frame:{...N({x:10,y:1}),...F}},"crown.penitentiary":{frame:{...N({x:11,y:1}),...F}},"crown.bookworld":{frame:{...N({x:12,y:1}),...F}},"crown.dark":{frame:{...N({x:13,y:1}),...F}},sticks:{frame:{...N({x:8,y:2}),...F}},cube:{frame:{...N({x:9,y:2}),...F}},drum:{frame:{...N({x:10,y:2}),...F}},hooter:{frame:{...N({x:11,y:2}),...F}},bag:{frame:{...N({x:12,y:2}),...F}},joystick:{frame:{...N({x:13,y:2}),...F}},"shadowMask.joystick":{frame:{...N({x:14,y:2}),...F}},...Vm("turtle",2,N({x:0,y:3}),F),...cr("monkey",N({x:4,y:3}),F),...cr("computerBot",N({x:6,y:3}),F),"spring.compressed":{frame:{...N({x:8,y:3}),...F}},"spring.released":{frame:{...N({x:9,y:3}),...F}},"switch.left":{frame:{...N({x:10,y:3}),...F}},"switch.right":{frame:{...N({x:11,y:3}),...F}},"shadowMask.switch":{frame:{...N({x:12,y:3}),...F}},tower:{frame:{...N({x:13,y:3}),...F}},"shadowMask.tower":{frame:{...N({x:14,y:3}),...F}},scroll:{frame:{...N({x:8,y:4}),...F,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...N({x:9,y:4}),...F,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...N({x:10,y:4}),...F,pivot:{x:17,y:24}}},puck:{frame:{...N({x:11,y:4}),...F}},"puck.deadly":{frame:{...N({x:12,y:4}),...F}},"shadow.smallRound":{frame:{...N({x:13,y:4}),...F}},"shadowMask.smallRound":{frame:{...N({x:14,y:4}),...F}},...oe("helicopterBug",4,N({x:0,y:5}),F),"barrier.x":{frame:{...N({x:4,y:5}),...F,pivot:{x:18,y:23}}},"barrier.y":{frame:{...N({x:5,y:5}),...F,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...N({x:6,y:5}),...F,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...N({x:7,y:5}),...F,pivot:{x:6,y:22}}},doughnuts:{frame:{...N({x:8,y:5}),...F}},...oe("bubbles.taupe",3,N({x:9,y:5}),F),whiteRabbit:{frame:{...N({x:12,y:5}),...F}},...oe("bubbles.white",3,N({x:13,y:5}),F),...oe("fish",2,N({x:12,y:6}),F),blank:{frame:{...N({x:14,y:6}),...F}},...oe("lift",4,N({x:7,y:7}),F),"lift.static":{frame:{...N({x:11,y:7}),...F}},"shadow.smallBlock":{frame:{...N({x:12,y:7}),...F}},"shadowMask.smallBlock":{frame:{...N({x:13,y:7}),...F}},...cr("skiHead.greenAndPink",{x:1,y:327},{w:24,h:32}),...cr("skiHead.starsAndStripes",{x:51,y:327},{w:24,h:32}),"block.organic":{frame:{...de({x:0,y:0}),...ue}},"block.organic.disappearing":{frame:{...de({x:1,y:0}),...ue}},"block.organic.dark":{frame:{...de({x:2,y:0}),...ue}},"block.organic.dark.disappearing":{frame:{...de({x:3,y:0}),...ue}},"block.artificial":{frame:{...de({x:4,y:0}),...ue}},"block.artificial.disappearing":{frame:{...de({x:5,y:0}),...ue}},"book.x":{frame:{...de({x:6,y:0}),...ue}},"book.y":{frame:{...de({x:7,y:0}),...ue}},"shadow.fullBlock":{frame:{...de({x:8,y:0}),...ue}},"shadowMask.fullBlock":{frame:{...de({x:9,y:0}),...ue}},stepStool:{frame:{...de({x:0,y:1}),...ue}},"shadowMask.stepStool":{frame:{...de({x:1,y:1}),...ue}},volcano:{frame:{...de({x:2,y:1}),...ue}},"shadowMask.volcano":{frame:{...de({x:3,y:1}),...ue}},hushPuppy:{frame:{...de({x:4,y:1}),...ue}},"shadowMask.hushPuppy":{frame:{...de({x:5,y:1}),...ue}},toaster:{frame:{...de({x:6,y:1}),...ue}},sandwich:{frame:{...de({x:7,y:1}),...ue}},spikes:{frame:{...de({x:8,y:1}),...ue}},"shadowMask.spikes":{frame:{...de({x:9,y:1}),...ue}},...oe("conveyor.x",7,de({x:0,y:2}),ue),"shadowMask.conveyor":{frame:{...de({x:7,y:2}),...ue}},button:{frame:{...de({x:9,y:2}),...ue}},"button.pressed":{frame:{...de({x:10,y:2}),...ue}},"button.surfaceMask":{frame:{...de({x:11,y:2}),...ue}},...oe("conveyor.y",7,de({x:0,y:3}),ue),teleporter:{frame:{...de({x:7,y:3}),...ue}},...oe("teleporter.flashing",2,de({x:8,y:3}),ue),"shadowMask.teleporter":{frame:{...de({x:10,y:3}),...ue}}},wd={frames:zm,animations:{"teleporter.flashing":xe(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:xe(["fish.1","fish.2"],.25),lift:xe(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:xe(["dalek.1","dalek.2"],.5),"turtle.left":xe(["turtle.left.1","turtle.left.2"],.25),"turtle.away":xe(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":xe(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":xe(["turtle.right.1","turtle.right.2"],.25),helicopterBug:xe(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":xe(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":xe(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.doughnut":xe(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":xe(Wa("conveyor.x",7),.5),"conveyor.y":xe(Wa("conveyor.y",7),.5),"spring.bounce":xe(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),switch:xe(["switch.left","switch.right"],.02)}},jm={...wd.frames,...pd.frames,..._m.frames,...Rm.frames,...Bm.frames},Gt={frames:jm,animations:{...pd.animations,...wd.animations},meta:{scale:1}},Fm=()=>{const t=Object.keys(Gt.frames).sort();return d.jsxs("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:[d.jsx("title",{children:"Sprites"}),t.map(e=>{const{frame:r}=Gt.frames[e];return d.jsxs("div",{className:"bg-shadow m-[8px] p-[16px]",children:[d.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border border-4 mb-1 box-content",style:{"--x":`${Gt.frames[e].frame.x}px`,"--y":`${Gt.frames[e].frame.y}px`,"--h":`${Gt.frames[e].frame.h}px`,"--w":`${Gt.frames[e].frame.w}px`}}),d.jsx("div",{className:"text-moss",children:e}),d.jsxs("div",{className:"text-lightGrey",children:[r.w,"Â xÂ ",r.h]}),d.jsxs("div",{className:"text-midGrey",children:["(",r.x,",",r.y,")"]})]},e)})]})};var Fi={exports:{}},Ni={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pc;function Nm(){if(pc)return Ni;pc=1;var t=$r();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,a=t.useMemo,o=t.useDebugValue;return Ni.useSyncExternalStoreWithSelector=function(l,c,u,h,A){var f=n(null);if(f.current===null){var p={hasValue:!1,value:null};f.current=p}else p=f.current;f=a(function(){function m(P){if(!V){if(V=!0,y=P,P=h(P),A!==void 0&&p.hasValue){var C=p.value;if(A(C,P))return q=C}return q=P}if(C=q,r(y,P))return C;var T=h(P);return A!==void 0&&A(C,T)?(y=P,C):(y=P,q=T)}var V=!1,y,q,S=u===void 0?null:u;return[function(){return m(c())},S===null?void 0:function(){return m(S())}]},[c,u,h,A]);var g=s(l,f[0],f[1]);return i(function(){p.hasValue=!0,p.value=g},[g]),o(g),g},Ni}var mc;function Om(){return mc||(mc=1,Fi.exports=Nm()),Fi.exports}var Lm=Om();function Dm(t){t()}function Hm(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Dm(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var gc={notify(){},get:()=>[]};function Gm(t,e){let r,s=gc,n=0,i=!1;function a(g){u();const m=s.subscribe(g);let V=!1;return()=>{V||(V=!0,m(),h())}}function o(){s.notify()}function l(){p.onStateChange&&p.onStateChange()}function c(){return i}function u(){n++,r||(r=t.subscribe(l),s=Hm())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=gc)}function A(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const p={addNestedSub:a,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:A,tryUnsubscribe:f,getListeners:()=>s};return p}var Wm=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Um=Wm(),Ym=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Xm=Ym(),$m=()=>Um||Xm?I.useLayoutEffect:I.useEffect,Km=$m(),Qm=Symbol.for("react-redux-context"),Zm=typeof globalThis<"u"?globalThis:{};function Jm(){if(!I.createContext)return{};const t=Zm[Qm]??=new Map;let e=t.get(I.createContext);return e||(e=I.createContext(null),t.set(I.createContext,e)),e}var ar=Jm();function eg(t){const{children:e,context:r,serverState:s,store:n}=t,i=I.useMemo(()=>{const l=Gm(n);return{store:n,subscription:l,getServerState:s?()=>s:void 0}},[n,s]),a=I.useMemo(()=>n.getState(),[n]);Km(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,a]);const o=r||ar;return I.createElement(o.Provider,{value:i},e)}var tg=eg;function Io(t=ar){return function(){return I.useContext(t)}}var vd=Io();function _d(t=ar){const e=t===ar?vd:Io(t),r=()=>{const{store:s}=e();return s};return Object.assign(r,{withTypes:()=>r}),r}var kd=_d();function rg(t=ar){const e=t===ar?kd:_d(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var sg=rg(),ng=(t,e)=>t===e;function ig(t=ar){const e=t===ar?vd:Io(t),r=(s,n={})=>{const{equalityFn:i=ng}=typeof n=="function"?{equalityFn:n}:n,a=e(),{store:o,subscription:l,getServerState:c}=a;I.useRef(!0);const u=I.useCallback({[s.name](A){return s(A)}}[s.name],[s]),h=Lm.useSyncExternalStoreWithSelector(l.addNestedSub,o.getState,c||o.getState,u,i);return I.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var ag=ig(),Oi,xc;function og(){if(xc)return Oi;xc=1;function t(s){if(Array.isArray(s))return!0;var n=s.length;return typeof n=="number"&&n>-1?n?0 in s&&n-1 in s:!0:!1}function e(s){var n=typeof s;return n==="object"?s===null?"null":t(s)?"array":s.constructor===Object?"pure-object":"object":n}function r(s,n){if(s===n||s!==s&&n!==n)return!0;var i=e(s),a=e(n);if(i!==a)return!1;if(i==="pure-object"){if(s===n)return!0;var o=Object.keys(s),l=Object.keys(n).length;if(o.length!==l)return!1;for(var c=0,u=o.length;c<u;c++){var h=o[c];if(!n.hasOwnProperty(o[c]))return!1;var A=s[h],f=n[h];if(A===s||f===n||A===n||f===s)return A===f;if(!r(A,f))return!1}return!0}else if(i==="array"){if(s.length===n.length)for(var p=0;p<s.length;p++){var g=s[p],m=n[p];if(g===s||m===n||g===n||m===s)return g===m;if(!r(g,m))return!1}else return!1;return!0}else if(i==="object"){if(s.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return s.valueOf()===n.valueOf();if(s.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return s.toString()===n.toString()}return!1}return Oi=r,Oi}var lg=og();const cg=Ze(lg),Ro=sg.withTypes(),ae=ag.withTypes();kd.withTypes();const Pe={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},yc=Vd(Pe,([t,e])=>[e,t]),ug={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},hg={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},xt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},Sd=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...zs],Cd=[...Sd,...zs],bn={presses:Fs(Cd.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[]}},Vc=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Cr(...t){return{presses:t.reduce((e,r)=>{for(const s of Cd)e[s]={keys:Vc(e[s]?.keys,r?.presses?.[s]?.keys),gamepadButtons:Vc(e[s]?.gamepadButtons,r?.presses?.[s]?.gamepadButtons)};return e},structuredClone(bn.presses)),axes:{x:Array.from(new Set([...bn.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...bn.axes.y,...t.map(e=>e.axes?.y??[]).flat()]))}}}const Mr={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape","Tab","Â§"]},menu_exit:{gamepadButtons:[Pe.b]},menu_select:{keys:["Enter"],gamepadButtons:[Pe.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},Zr={inputAssignment:Cr(Mr,{presses:{right:{gamepadButtons:[Pe.dPadRight]},towards:{gamepadButtons:[Pe.dPadDown]},left:{gamepadButtons:[Pe.dPadLeft]},away:{gamepadButtons:[Pe.dPadUp]},jump:{gamepadButtons:[Pe.a,Pe.y]},carry:{gamepadButtons:[Pe.x,Pe.y]},fire:{gamepadButtons:[Pe.b]},swop:{gamepadButtons:[Pe.rb]},"swop.head":{gamepadButtons:[Pe.l3]},"swop.heels":{gamepadButtons:[Pe.r3]},hold:{gamepadButtons:[Pe.start]},menu_openOrExit:{gamepadButtons:[Pe.select]},map:{gamepadButtons:[Pe.lb]},toggleColourisation:{gamepadButtons:[Pe.lt]}},axes:{x:[0],y:[1]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},dg={inputAssignment:Cr(Mr,Zr.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},fg={inputAssignment:Cr(Mr,Zr.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},Ag={inputAssignment:Cr(Mr,Zr.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},pg={inputAssignment:Cr(Mr,Zr.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},mg={inputAssignment:Cr(Mr,Zr.inputAssignment,{presses:{right:{keys:[xt.dPadRight]},towards:{keys:[xt.dPadDown]},left:{keys:[xt.dPadLeft]},away:{keys:[xt.dPadUp]},jump:{keys:[xt.a,xt.y]},carry:{keys:[xt.b,xt.y]},fire:{keys:[xt.x]},swop:{keys:[xt.rb]},hold:{keys:[xt.start]},menu_openOrExit:{keys:[xt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that donâ€™t support controllers"},bc=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[2]]}}}),gg={inputAssignment:Cr(bn,Mr,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},bc(ug),bc(hg)),description:"MAME key mappings. For arcade-style control panels"},Hr={default:Ag,"zx spectrum":dg,amiga:fg,mame:gg,wasd:pg,"ðŸ•¹ 8bitdo keyboard mode":mg,"ðŸ•¹ joystick":Zr},Xt=()=>ft()==="mobile"||ft()==="tablet",ft=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},xg=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,at={inputAssignment:Hr.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:ft()==="mobile"?"handheld":"zxSpectrum"},showFps:!1,onScreenControls:ft()==="mobile"||ft()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1},Md=(t,e)=>e.split(".").reduce((r,s)=>r[s],t),yg=(t,e,r)=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){const a=s[i];n=n[a]}n[s[s.length-1]]=r},Vg=t=>{const{gameMenus:{upscale:{cssUpscale:e,gameEngineUpscale:r}}}=t;return e*r},Ns=()=>ae(Vg),Pn=t=>t.gameMenus.userSettings.inputAssignment??at.inputAssignment,Fk=t=>t.gameMenus.openMenus.length>0,Pd=()=>ae(t=>t.gameMenus.cheatsOn),Td=t=>t.gameMenus.assigningInput!==void 0,Ed=()=>ae(Td),bg=t=>{for(const[e,r]of Ue(xd(Hr)))if(cg(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},qg=t=>t.gameMenus.userSettings.showFps??at.showFps,$n=t=>t.gameMenus.userSettings.displaySettings.emulatedResolution??at.displaySettings.emulatedResolution,wg=()=>ae($n),Gr=()=>ae(t=>t.gameMenus.gameRunning),vg=t=>!(t.gameMenus.userSettings.displaySettings.uncolourised??at.displaySettings.uncolourised),Bo=()=>ae(vg),_g=t=>t.gameMenus.userSettings.displaySettings.crtFilter??at.displaySettings.crtFilter,Id=t=>t.gameMenus.userSettings.infiniteLivesPoke??at.infiniteLivesPoke,Rd=t=>t.gameMenus.userSettings.infiniteDoughnutsPoke??at.infiniteDoughnutsPoke,Nk=t=>t.gameMenus.planetsLiberated.egyptus&&t.gameMenus.planetsLiberated.bookworld&&t.gameMenus.planetsLiberated.penitentiary&&t.gameMenus.planetsLiberated.safari,Tn=()=>ae(t=>t.gameMenus.userSettings.screenRelativeControl),zo=t=>t.gameMenus.userSettings.inputDirectionMode??at.inputDirectionMode,Bd=()=>ae(zo),kg=t=>Ga(Ue(Yn(t.gameMenus.planetsLiberated)).filter(Boolean)),Sg=t=>t.gameMenus.userSettings.displaySettings.showBoundingBoxes??at.displaySettings.showBoundingBoxes,Ok=()=>ae(Sg),Lk=()=>ae(t=>t.gameMenus.userSettings.displaySettings.showShadowMasks??at.displaySettings.showShadowMasks),Cg=t=>t.gameMenus.userSettings.screenRelativeControl??at.screenRelativeControl,Mg=t=>t.gameMenus.userSettings.onScreenControls??at.onScreenControls,Dk=({gameMenus:t})=>(t.userSettings.onScreenControls??at.onScreenControls)&&t.upscale.rotate90===!1,Pg=()=>ae(Mg),Hk=(t,e)=>!!Md(t.gameMenus,e),Tg=()=>ae(t=>t.gameMenus.roomsExplored),zd=({children:t,scaleFactor:e})=>{const r=Ns();return d.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},jo=I.createContext(null),Eg=({gameApi:t,children:e})=>d.jsx(jo,{value:t,children:e}),Jr=()=>{const t=I.useContext(jo);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},Ig=()=>{const t=I.useContext(jo);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},En=(t,...e)=>{const r={};for(const s of e)r[s]=t[s];return r},Gk=(t,...e)=>{const r={...t};for(const s of e)delete r[s];return r},fs=t=>JSON.parse(JSON.stringify(t)),Rg=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],Bg=["planetsLiberated","scrollsRead","roomsExplored","reincarnationPoint"],zg=(t,e)=>fs({saveTime:Date.now(),screenshotBase64:"IAMANIMAGE",campaignId:"original",gameState:En(t,...Rg),store:{gameMenus:En(e.gameMenus,...Bg)}});function ze(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var jg=typeof Symbol=="function"&&Symbol.observable||"@@observable",qc=jg,Li=()=>Math.random().toString(36).substring(7).split("").join("."),Fg={INIT:`@@redux/INIT${Li()}`,REPLACE:`@@redux/REPLACE${Li()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Li()}`},In=Fg;function Fo(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function No(t,e,r){if(typeof t!="function")throw new Error(ze(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ze(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ze(1));return r(No)(t,e)}let s=t,n=e,i=new Map,a=i,o=0,l=!1;function c(){a===i&&(a=new Map,i.forEach((m,V)=>{a.set(V,m)}))}function u(){if(l)throw new Error(ze(3));return n}function h(m){if(typeof m!="function")throw new Error(ze(4));if(l)throw new Error(ze(5));let V=!0;c();const y=o++;return a.set(y,m),function(){if(V){if(l)throw new Error(ze(6));V=!1,c(),a.delete(y),i=null}}}function A(m){if(!Fo(m))throw new Error(ze(7));if(typeof m.type>"u")throw new Error(ze(8));if(typeof m.type!="string")throw new Error(ze(17));if(l)throw new Error(ze(9));try{l=!0,n=s(n,m)}finally{l=!1}return(i=a).forEach(y=>{y()}),m}function f(m){if(typeof m!="function")throw new Error(ze(10));s=m,A({type:In.REPLACE})}function p(){const m=h;return{subscribe(V){if(typeof V!="object"||V===null)throw new Error(ze(11));function y(){const S=V;S.next&&S.next(u())}return y(),{unsubscribe:m(y)}},[qc](){return this}}}return A({type:In.INIT}),{dispatch:A,subscribe:h,getState:u,replaceReducer:f,[qc]:p}}function Ng(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:In.INIT})>"u")throw new Error(ze(12));if(typeof r(void 0,{type:In.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ze(13))})}function Og(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const a=e[i];typeof t[a]=="function"&&(r[a]=t[a])}const s=Object.keys(r);let n;try{Ng(r)}catch(i){n=i}return function(a={},o){if(n)throw n;let l=!1;const c={};for(let u=0;u<s.length;u++){const h=s[u],A=r[h],f=a[h],p=A(f,o);if(typeof p>"u")throw o&&o.type,new Error(ze(14));c[h]=p,l=l||p!==f}return l=l||s.length!==Object.keys(a).length,l?c:a}}function Rn(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function Lg(...t){return e=>(r,s)=>{const n=e(r,s);let i=()=>{throw new Error(ze(15))};const a={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},o=t.map(l=>l(a));return i=Rn(...o)(n.dispatch),{...n,dispatch:i}}}function Dg(t){return Fo(t)&&"type"in t&&typeof t.type=="string"}var jd=Symbol.for("immer-nothing"),wc=Symbol.for("immer-draftable"),pt=Symbol.for("immer-state");function St(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Wr=Object.getPrototypeOf;function br(t){return!!t&&!!t[pt]}function Jt(t){return t?Fd(t)||Array.isArray(t)||!!t[wc]||!!t.constructor?.[wc]||Qn(t)||Zn(t):!1}var Hg=Object.prototype.constructor.toString();function Fd(t){if(!t||typeof t!="object")return!1;const e=Wr(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Hg}function Bn(t,e){Kn(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,s)=>e(s,r,t))}function Kn(t){const e=t[pt];return e?e.type_:Array.isArray(t)?1:Qn(t)?2:Zn(t)?3:0}function Ua(t,e){return Kn(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Nd(t,e,r){const s=Kn(t);s===2?t.set(e,r):s===3?t.add(r):t[e]=r}function Gg(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Qn(t){return t instanceof Map}function Zn(t){return t instanceof Set}function hr(t){return t.copy_||t.base_}function Ya(t,e){if(Qn(t))return new Map(t);if(Zn(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Fd(t);if(e===!0||e==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[pt];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const a=n[i],o=s[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(s[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[a]})}return Object.create(Wr(t),s)}else{const s=Wr(t);if(s!==null&&r)return{...t};const n=Object.create(s);return Object.assign(n,t)}}function Oo(t,e=!1){return Jn(t)||br(t)||!Jt(t)||(Kn(t)>1&&(t.set=t.add=t.clear=t.delete=Wg),Object.freeze(t),e&&Object.entries(t).forEach(([r,s])=>Oo(s,!0))),t}function Wg(){St(2)}function Jn(t){return Object.isFrozen(t)}var Ug={};function qr(t){const e=Ug[t];return e||St(0,t),e}var ks;function Od(){return ks}function Yg(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vc(t,e){e&&(qr("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Xa(t){$a(t),t.drafts_.forEach(Xg),t.drafts_=null}function $a(t){t===ks&&(ks=t.parent_)}function _c(t){return ks=Yg(ks,t)}function Xg(t){const e=t[pt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function kc(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[pt].modified_&&(Xa(e),St(4)),Jt(t)&&(t=zn(e,t),e.parent_||jn(e,t)),e.patches_&&qr("Patches").generateReplacementPatches_(r[pt].base_,t,e.patches_,e.inversePatches_)):t=zn(e,r,[]),Xa(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==jd?t:void 0}function zn(t,e,r){if(Jn(e))return e;const s=e[pt];if(!s)return Bn(e,(n,i)=>Sc(t,s,e,n,i,r)),e;if(s.scope_!==t)return e;if(!s.modified_)return jn(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,a=!1;s.type_===3&&(i=new Set(n),n.clear(),a=!0),Bn(i,(o,l)=>Sc(t,s,n,o,l,r,a)),jn(t,n,!1),r&&t.patches_&&qr("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function Sc(t,e,r,s,n,i,a){if(br(n)){const o=i&&e&&e.type_!==3&&!Ua(e.assigned_,s)?i.concat(s):void 0,l=zn(t,n,o);if(Nd(r,s,l),br(l))t.canAutoFreeze_=!1;else return}else a&&r.add(n);if(Jt(n)&&!Jn(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;zn(t,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,s)&&jn(t,n)}}function jn(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Oo(e,r)}function $g(t,e){const r=Array.isArray(t),s={type_:r?1:0,scope_:e?e.scope_:Od(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=Lo;r&&(n=[s],i=Ss);const{revoke:a,proxy:o}=Proxy.revocable(n,i);return s.draft_=o,s.revoke_=a,o}var Lo={get(t,e){if(e===pt)return t;const r=hr(t);if(!Ua(r,e))return Kg(t,r,e);const s=r[e];return t.finalized_||!Jt(s)?s:s===Di(t.base_,e)?(Hi(t),t.copy_[e]=Qa(s,t)):s},has(t,e){return e in hr(t)},ownKeys(t){return Reflect.ownKeys(hr(t))},set(t,e,r){const s=Ld(hr(t),e);if(s?.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const n=Di(hr(t),e),i=n?.[pt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Gg(r,n)&&(r!==void 0||Ua(t.base_,e)))return!0;Hi(t),Ka(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Di(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Hi(t),Ka(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=hr(t),s=Reflect.getOwnPropertyDescriptor(r,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:r[e]}},defineProperty(){St(11)},getPrototypeOf(t){return Wr(t.base_)},setPrototypeOf(){St(12)}},Ss={};Bn(Lo,(t,e)=>{Ss[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ss.deleteProperty=function(t,e){return Ss.set.call(this,t,e,void 0)};Ss.set=function(t,e,r){return Lo.set.call(this,t[0],e,r,t[0])};function Di(t,e){const r=t[pt];return(r?hr(r):t)[e]}function Kg(t,e,r){const s=Ld(e,r);return s?"value"in s?s.value:s.get?.call(t.draft_):void 0}function Ld(t,e){if(!(e in t))return;let r=Wr(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,e);if(s)return s;r=Wr(r)}}function Ka(t){t.modified_||(t.modified_=!0,t.parent_&&Ka(t.parent_))}function Hi(t){t.copy_||(t.copy_=Ya(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Qg=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,s)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const a=this;return function(l=i,...c){return a.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&St(6),s!==void 0&&typeof s!="function"&&St(7);let n;if(Jt(e)){const i=_c(this),a=Qa(e,void 0);let o=!0;try{n=r(a),o=!1}finally{o?Xa(i):$a(i)}return vc(i,s),kc(n,i)}else if(!e||typeof e!="object"){if(n=r(e),n===void 0&&(n=e),n===jd&&(n=void 0),this.autoFreeze_&&Oo(n,!0),s){const i=[],a=[];qr("Patches").generateReplacementPatches_(e,n,i,a),s(i,a)}return n}else St(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let s,n;return[this.produce(e,r,(a,o)=>{s=a,n=o}),s,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Jt(t)||St(8),br(t)&&(t=Zg(t));const e=_c(this),r=Qa(t,void 0);return r[pt].isManual_=!0,$a(e),r}finishDraft(t,e){const r=t&&t[pt];(!r||!r.isManual_)&&St(9);const{scope_:s}=r;return vc(s,e),kc(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(e=e.slice(r+1));const s=qr("Patches").applyPatches_;return br(t)?s(t,e):this.produce(t,n=>s(n,e))}};function Qa(t,e){const r=Qn(t)?qr("MapSet").proxyMap_(t,e):Zn(t)?qr("MapSet").proxySet_(t,e):$g(t,e);return(e?e.scope_:Od()).drafts_.push(r),r}function Zg(t){return br(t)||St(10,t),Dd(t)}function Dd(t){if(!Jt(t)||Jn(t))return t;const e=t[pt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ya(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Ya(t,!0);return Bn(r,(s,n)=>{Nd(r,s,Dd(n))}),e&&(e.finalized_=!1),r}var mt=new Qg,Hd=mt.produce;mt.produceWithPatches.bind(mt);mt.setAutoFreeze.bind(mt);mt.setUseStrictShallowCopy.bind(mt);mt.applyPatches.bind(mt);mt.createDraft.bind(mt);mt.finishDraft.bind(mt);function Gd(t){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,t):n(i)}var Jg=Gd(),ex=Gd,tx=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Rn:Rn.apply(null,arguments)};function Cc(t,e){function r(...s){if(e){let n=e(...s);if(!n)throw new Error($t(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>Dg(s)&&s.type===t,r}var Wd=class As extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,As.prototype)}static get[Symbol.species](){return As}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new As(...e[0].concat(this)):new As(...e.concat(this))}};function Mc(t){return Jt(t)?Hd(t,()=>{}):t}function Pc(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function rx(t){return typeof t=="boolean"}var sx=()=>function(e){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let a=new Wd;return r&&(rx(r)?a.push(Jg):a.push(ex(r.extraArgument))),a},nx="RTK_autoBatch",Tc=t=>e=>{setTimeout(e,t)},ix=(t={type:"raf"})=>e=>(...r)=>{const s=e(...r);let n=!0,i=!1,a=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Tc(10):t.type==="callback"?t.queueNotification:Tc(t.timeout),c=()=>{a=!1,i&&(i=!1,o.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const h=()=>n&&u(),A=s.subscribe(h);return o.add(u),()=>{A(),o.delete(u)}},dispatch(u){try{return n=!u?.meta?.[nx],i=!n,i&&(a||(a=!0,l(c))),s.dispatch(u)}finally{n=!0}}})},ax=t=>function(r){const{autoBatch:s=!0}=r??{};let n=new Wd(t);return s&&n.push(ix(typeof s=="object"?s:void 0)),n};function ox(t){const e=sx(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:a=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Fo(r))o=Og(r);else throw new Error($t(1));let l;typeof s=="function"?l=s(e):l=e();let c=Rn;n&&(c=tx({trace:!1,...typeof n=="object"&&n}));const u=Lg(...l),h=ax(u);let A=typeof a=="function"?a(h):h();const f=c(...A);return No(o,i,f)}function Ud(t){const e={},r=[];let s;const n={addCase(i,a){const o=typeof i=="string"?i:i.type;if(!o)throw new Error($t(28));if(o in e)throw new Error($t(29));return e[o]=a,n},addMatcher(i,a){return r.push({matcher:i,reducer:a}),n},addDefaultCase(i){return s=i,n}};return t(n),[e,r,s]}function lx(t){return typeof t=="function"}function cx(t,e){let[r,s,n]=Ud(e),i;if(lx(t))i=()=>Mc(t());else{const o=Mc(t);i=()=>o}function a(o=i(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(br(u)){const f=h(u,l);return f===void 0?u:f}else{if(Jt(u))return Hd(u,A=>h(A,l));{const A=h(u,l);if(A===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return u},o)}return a.getInitialState=i,a}var ux=Symbol.for("rtk-slice-createasyncthunk");function hx(t,e){return`${t}/${e}`}function dx({creators:t}={}){const e=t?.asyncThunk?.[ux];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error($t(11));const a=(typeof s.reducers=="function"?s.reducers(px()):s.reducers)||{},o=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(y,q){const S=typeof y=="string"?y:y.type;if(!S)throw new Error($t(12));if(S in l.sliceCaseReducersByType)throw new Error($t(13));return l.sliceCaseReducersByType[S]=q,c},addMatcher(y,q){return l.sliceMatchers.push({matcher:y,reducer:q}),c},exposeAction(y,q){return l.actionCreators[y]=q,c},exposeCaseReducer(y,q){return l.sliceCaseReducersByName[y]=q,c}};o.forEach(y=>{const q=a[y],S={reducerName:y,type:hx(n,y),createNotation:typeof s.reducers=="function"};gx(q)?yx(S,q,c,e):mx(S,q,c)});function u(){const[y={},q=[],S=void 0]=typeof s.extraReducers=="function"?Ud(s.extraReducers):[s.extraReducers],P={...y,...l.sliceCaseReducersByType};return cx(s.initialState,C=>{for(let T in P)C.addCase(T,P[T]);for(let T of l.sliceMatchers)C.addMatcher(T.matcher,T.reducer);for(let T of q)C.addMatcher(T.matcher,T.reducer);S&&C.addDefaultCase(S)})}const h=y=>y,A=new Map;let f;function p(y,q){return f||(f=u()),f(y,q)}function g(){return f||(f=u()),f.getInitialState()}function m(y,q=!1){function S(C){let T=C[y];return typeof T>"u"&&q&&(T=g()),T}function P(C=h){const T=Pc(A,q,()=>new WeakMap);return Pc(T,C,()=>{const j={};for(const[B,R]of Object.entries(s.selectors??{}))j[B]=fx(R,C,g,q);return j})}return{reducerPath:y,getSelectors:P,get selectors(){return P(S)},selectSlice:S}}const V={name:n,reducer:p,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g,...m(i),injectInto(y,{reducerPath:q,...S}={}){const P=q??i;return y.inject({reducerPath:P,reducer:p},S),{...V,...m(P,!0)}}};return V}}function fx(t,e,r,s){function n(i,...a){let o=e(i);return typeof o>"u"&&s&&(o=r()),t(o,...a)}return n.unwrapped=t,n}var Ax=dx();function px(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function mx({type:t,reducerName:e,createNotation:r},s,n){let i,a;if("reducer"in s){if(r&&!xx(s))throw new Error($t(17));i=s.reducer,a=s.prepare}else i=s;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,a?Cc(t,a):Cc(t))}function gx(t){return t._reducerDefinitionType==="asyncThunk"}function xx(t){return t._reducerDefinitionType==="reducerWithPrepare"}function yx({type:t,reducerName:e},r,s,n){if(!n)throw new Error($t(18));const{payloadCreator:i,fulfilled:a,pending:o,rejected:l,settled:c,options:u}=r,h=n(t,i,u);s.exposeAction(e,h),a&&s.addCase(h.fulfilled,a),o&&s.addCase(h.pending,o),l&&s.addCase(h.rejected,l),c&&s.addMatcher(h.settled,c),s.exposeCaseReducer(e,{fulfilled:a||Zs,pending:o||Zs,rejected:l||Zs,settled:c||Zs})}function Zs(){}function $t(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Vx=4,Yd=(t,e,r)=>{const s=Sr[e],{renderAreaSize:n,rotate90:i}=ft()!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},a=id(n,r),o=Math.floor(Math.min(a.x/s.x,a.y/s.y)),l={x:Math.floor(a.x/o),y:Math.floor(a.y/o)},c=Math.min(Vx,o),u=o/c/r,h={x:Math.ceil(n.x/u),y:Math.ceil(n.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:l,canvasSize:h,rotate90:i}},bx=()=>ft()==="server"?Sr.zxSpectrum:{x:window.innerWidth,y:window.innerHeight},Xd=t=>{const e=ft();return Yd(bx(),t,e==="server"?1:window.devicePixelRatio)},Ec=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]};var Do="persist:",Ho="persist/FLUSH",Os="persist/REHYDRATE",Go="persist/PAUSE",Wo="persist/PERSIST",Uo="persist/PURGE",Yo="persist/REGISTER",$d=-1;function qn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qn=function(r){return typeof r}:qn=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},qn(t)}function Ic(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function qx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ic(r,!0).forEach(function(s){wx(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ic(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function wx(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vx(t,e,r,s){s.debug;var n=qx({},r);return t&&qn(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(n[i]=t[i])}),n}function _x(t){var e=t.blacklist||null,r=t.whitelist||null,s=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:Do).concat(t.key),a=t.storage,o;t.serialize===!1?o=function(P){return P}:typeof t.serialize=="function"?o=t.serialize:o=kx;var l=t.writeFailHandler||null,c={},u={},h=[],A=null,f=null,p=function(P){Object.keys(P).forEach(function(C){V(C)&&c[C]!==P[C]&&h.indexOf(C)===-1&&h.push(C)}),Object.keys(c).forEach(function(C){P[C]===void 0&&V(C)&&h.indexOf(C)===-1&&c[C]!==void 0&&h.push(C)}),A===null&&(A=setInterval(g,n)),c=P};function g(){if(h.length===0){A&&clearInterval(A),A=null;return}var S=h.shift(),P=s.reduce(function(C,T){return T.in(C,S,c)},c[S]);if(P!==void 0)try{u[S]=o(P)}catch(C){console.error("redux-persist/createPersistoid: error serializing state",C)}else delete u[S];h.length===0&&m()}function m(){Object.keys(u).forEach(function(S){c[S]===void 0&&delete u[S]}),f=a.setItem(i,o(u)).catch(y)}function V(S){return!(r&&r.indexOf(S)===-1&&S!=="_persist"||e&&e.indexOf(S)!==-1)}function y(S){l&&l(S)}var q=function(){for(;h.length!==0;)g();return f||Promise.resolve()};return{update:p,flush:q}}function kx(t){return JSON.stringify(t)}function Sx(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Do).concat(t.key),s=t.storage;t.debug;var n;return t.deserialize===!1?n=function(a){return a}:typeof t.deserialize=="function"?n=t.deserialize:n=Cx,s.getItem(r).then(function(i){if(i)try{var a={},o=n(i);return Object.keys(o).forEach(function(l){a[l]=e.reduceRight(function(c,u){return u.out(c,l,o)},n(o[l]))}),a}catch(l){throw l}else return})}function Cx(t){return JSON.parse(t)}function Mx(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Do).concat(t.key);return e.removeItem(r,Px)}function Px(t){}function Rc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Dt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rc(r,!0).forEach(function(s){Tx(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rc(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Tx(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ex(t,e){if(t==null)return{};var r=Ix(t,e),s,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Ix(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}var Rx=5e3;function Bx(t,e){var r=t.version!==void 0?t.version:$d;t.debug;var s=t.stateReconciler===void 0?vx:t.stateReconciler,n=t.getStoredState||Sx,i=t.timeout!==void 0?t.timeout:Rx,a=null,o=!1,l=!0,c=function(h){return h._persist.rehydrated&&a&&!l&&a.update(h),h};return function(u,h){var A=u||{},f=A._persist,p=Ex(A,["_persist"]),g=p;if(h.type===Wo){var m=!1,V=function(j,B){m||(h.rehydrate(t.key,j,B),m=!0)};if(i&&setTimeout(function(){!m&&V(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,a||(a=_x(t)),f)return Dt({},e(g,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(T){var j=t.migrate||function(B,R){return Promise.resolve(B)};j(T,r).then(function(B){V(B)},function(B){V(void 0,B)})},function(T){V(void 0,T)}),Dt({},e(g,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===Uo)return o=!0,h.result(Mx(t)),Dt({},e(g,h),{_persist:f});if(h.type===Ho)return h.result(a&&a.flush()),Dt({},e(g,h),{_persist:f});if(h.type===Go)l=!0;else if(h.type===Os){if(o)return Dt({},g,{_persist:Dt({},f,{rehydrated:!0})});if(h.key===t.key){var y=e(g,h),q=h.payload,S=s!==!1&&q!==void 0?s(q,u,y,t):y,P=Dt({},S,{_persist:Dt({},f,{rehydrated:!0})});return c(P)}}}if(!f)return e(u,h);var C=e(g,h);return C===g?u:c(Dt({},C,{_persist:f}))}}function Bc(t){return Fx(t)||jx(t)||zx()}function zx(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function jx(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function Fx(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function zc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Za(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zc(r,!0).forEach(function(s){Nx(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zc(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Nx(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Kd={registry:[],bootstrapped:!1},Ox=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kd,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Yo:return Za({},e,{registry:[].concat(Bc(e.registry),[r.key])});case Os:var s=e.registry.indexOf(r.key),n=Bc(e.registry);return n.splice(s,1),Za({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function Lx(t,e,r){var s=No(Ox,Kd,void 0),n=function(l){s.dispatch({type:Yo,key:l})},i=function(l,c,u){var h={type:Os,payload:c,err:u,key:l};t.dispatch(h),s.dispatch(h)},a=Za({},s,{purge:function(){var l=[];return t.dispatch({type:Uo,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:Ho,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:Go})},persist:function(){t.dispatch({type:Wo,register:n,rehydrate:i})}});return a.persist(),a}function Dx(t,e){return function(r,s){if(!r)return Promise.resolve(void 0);var n=r._persist&&r._persist.version!==void 0?r._persist.version:$d;if(n===s||n>s)return Promise.resolve(r);var i=Object.keys(t).map(function(o){return parseInt(o)}).filter(function(o){return s>=o&&o>n}).sort(function(o,l){return o-l});try{var a=i.reduce(function(o,l){return t[l](o)},r);return Promise.resolve(a)}catch(o){return Promise.reject(o)}}}const Fn=[],Qd=new Set;Qd.add=()=>{throw new Error("emptySet.add")};Qd.clear=()=>{throw new Error("emptySet.clear")};const pe=Object.freeze({}),Hx=["4-way","8-way","analogue"],Zd=ft()!=="server",Gi=Zd?new URLSearchParams(window.location.search).has("cheats"):!1,Jd={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},Ja={userSettings:{displaySettings:{}},upscale:Yd(Zd?{x:globalThis.window.innerWidth,y:globalThis.window.innerHeight}:Sr.zxSpectrum,at.displaySettings.emulatedResolution,1),planetsLiberated:Jd,roomsExplored:{},scrollsRead:{},gameRunning:Gi,openMenus:Gi?[]:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:pe}],assigningInput:void 0,cheatsOn:Gi,currentGame:void 0,reincarnationPoint:void 0},Xo=Ax({name:"gameMenus",initialState:Ja,reducers:{setUpscale(t,{payload:e}){t.upscale=e},setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=Ec(bm,$n({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r,ft()!=="server"&&(t.upscale=Xd(r))},scrollRead(t,{payload:e}){t.scrollsRead[e]=!0,t.openMenus=[{menuId:`markdown/${e}`,scrollableSelection:!1,menuParam:pe}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=Ec(Hx,zo({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(a,o)=>{a.includes(o)||a.push(o)},{presses:s,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":r(s.keys,e.input);break;case"gamepadButtons":r(s.gamepadButtons,e.input);break;case"gamepadAxes":{zs.includes(i)&&r(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:s}=t.assigningInput,n=r.keys.length+r.gamepadButtons.length+s.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(Hr.default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=s),(e==="towards"||e==="away")&&(i.axes.y=s)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:pe}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},gameStarted(t){t.gameRunning?t.openMenus=[]:(t.openMenus=[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.planetsLiberated=Jd,t.roomsExplored={},t.scrollsRead={})},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=Hr[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[s]=t.openMenus;s.focussedItemId=e,s.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:pe}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:pe}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){yg(t,e,!Md(t,e))},crownCollected(t,{payload:e}){t.planetsLiberated[e]=!0;const r=Object.values(t.planetsLiberated).every(n=>n),s={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:pe},s]:t.openMenus=[s]},roomExplored(t,{payload:e}){t.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){e&&t.reincarnationPoint!==void 0?t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:pe},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:pe}]:(t.gameRunning=!1,delete t.reincarnationPoint,delete t.currentGame,t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:pe},{menuId:"mainMenu",scrollableSelection:!0,menuParam:pe}])},reincarnationFishEaten(t,{payload:e}){t.reincarnationPoint=e},reincarnationAccepted(t){delete t.reincarnationPoint,t.openMenus=[]},saveCurrentGame(t,{payload:e}){t.currentGame=e},gameRestoreFromSave(t,{payload:e}){Object.assign(t,e)},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,Ja),t.gameRunning=!1;break}}},extraReducers(t){t.addCase(Os,(e,r)=>{r.payload?.currentGame&&(e.gameRunning=!0,e.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:pe}])})}}),{assignInputStart:yt,backToParentMenu:Ye,crownCollected:Wk,doneAssigningInput:Gx,errorCaught:ef,errorDismissed:jc,gameOver:tf,gameRestoreFromSave:Uk,gameStarted:Wx,goToSubmenu:Ct,holdPressed:rf,inputAddedDuringAssignment:Ux,keyAssignmentPresetChosen:Yx,mapPressed:Xx,menuOpenOrExitPressed:Fc,nextInputDirectionMode:$x,reincarnationAccepted:sf,reincarnationFishEaten:Yk,roomExplored:Xk,saveCurrentGame:Kx,scrollRead:$k,setEmulatedResolution:nf,setFocussedMenuItemId:$o,setShowBoundingBoxes:Kk,setShowShadowMasks:Qk,setUpscale:Qx,toggleBoolean:Ut}=Xo.actions;var os={},Js={},en={},Nc;function Zx(){if(Nc)return en;Nc=1,en.__esModule=!0,en.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(o){return typeof o}:t=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function s(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var a=self[i],o="redux-persist ".concat(i," test");a.setItem(o,"test"),a.getItem(o),a.removeItem(o)}catch{return!1}return!0}function n(i){var a="".concat(i,"Storage");return s(a)?self[a]:r}return en}var Oc;function Jx(){if(Oc)return Js;Oc=1,Js.__esModule=!0,Js.default=r;var t=e(Zx());function e(s){return s&&s.__esModule?s:{default:s}}function r(s){var n=(0,t.default)(s);return{getItem:function(a){return new Promise(function(o,l){o(n.getItem(a))})},setItem:function(a,o){return new Promise(function(l,c){l(n.setItem(a,o))})},removeItem:function(a){return new Promise(function(o,l){o(n.removeItem(a))})}}}return Js}var Lc;function ey(){if(Lc)return os;Lc=1,os.__esModule=!0,os.default=void 0;var t=e(Jx());function e(s){return s&&s.__esModule?s:{default:s}}var r=(0,t.default)("local");return os.default=r,os}var ty=ey();const ry=Ze(ty),Vt=t=>{const e=Ja.userSettings;return console.log("migrating state: persisted is:",t,"am reverting to initial/default state:",e),e},sy={key:"hohol/gameMenus/userSettings",version:12,migrate:Dx({1:Vt,2:Vt,3:Vt,4:Vt,5:Vt,6:Vt,7:Vt,8:Vt,9:Vt,10:Vt,11:Vt,12:Vt}),storage:ry,whitelist:["userSettings","currentGame"]},ny=Bx(sy,Xo.reducer),be=ox({reducer:{[Xo.reducerPath]:ny},middleware:t=>t({serializableCheck:{ignoredActions:[Ho,Os,Go,Wo,Uo,Yo]}})}),iy=Lx(be),ay=()=>{const t=Ro(),e=Ig();I.useEffect(()=>{if(e===void 0)return;const r=()=>{console.log("saving current game"),t(Kx(zg(e.gameState,be.getState()))),iy.flush()},s=()=>{document.visibilityState==="hidden"&&(console.log("pausing due to visibilityState=hidden"),t(rf("hold")),r())};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",r)}},[t,e])},oy=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Ã…","Ã„","Ã–","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape","Â§"],ly=t=>oy.includes(t);let cy=1;const uy=()=>cy++,hy=3,Dc=({key:t,location:e,repeat:r})=>{if(r)return;const s=t.length===1?t.toUpperCase():t,n=e===hy?`Numpad${s}`:s;if(ly(n))return n;console.warn("unrecognised key",t)},dy=()=>new Map,fy=t=>{const e=n=>{const i=Dc(n);i!==void 0&&t.set(i,uy())},r=n=>{const i=Dc(n);i!==void 0&&t.delete(i)},s=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",s,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",s,!1)}},af=t=>t==="left"?{axis:"x",direction:-1}:t==="right"?{axis:"x",direction:1}:t==="towards"?{axis:"y",direction:1}:t==="away"?{axis:"y",direction:-1}:void 0;var U=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(U||{});const eo=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},tn=(t,e)=>eo(t).priority??e,it={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(eo).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(eo).forEach(e=>{e.type.forEach(r=>{const s=this._addHandlers,n=this._queue;s[r]?s[r]?.(e):(n[r]=n[r]||[],n[r]?.push(e))})}),this},handle(t,e,r){const s=this._addHandlers,n=this._removeHandlers;if(s[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,n[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(a=>e(a)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,s=>{e.findIndex(i=>i.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((i,a)=>tn(a.value,r)-tn(i.value,r)))},s=>{const n=e.findIndex(i=>i.name===s.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,r=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((n,i)=>tn(i,r)-tn(n,r)))},s=>{const n=e.indexOf(s.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},Ay={extension:{type:U.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Kr(()=>import("./browserAll-B1gBJBkp.js"),__vite__mapDeps([0,1,2,3,4,5]))}},py={extension:{type:U.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Kr(()=>import("./webworkerAll-DQ7-C1L0.js"),__vite__mapDeps([1,2,3,4,5]))}};class ut{constructor(e,r,s){this._x=r||0,this._y=s||0,this._observer=e}clone(e){return new ut(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Wi={exports:{}},Hc;function my(){return Hc||(Hc=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,A){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,h||l,A),p=r?r+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var A=0,f=h.length,p=new Array(f);A<f;A++)p[A]=h[A].fn;return p},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,A,f,p){var g=r?r+c:c;if(!this._events[g])return!1;var m=this._events[g],V=arguments.length,y,q;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),V){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,h),!0;case 4:return m.fn.call(m.context,u,h,A),!0;case 5:return m.fn.call(m.context,u,h,A,f),!0;case 6:return m.fn.call(m.context,u,h,A,f,p),!0}for(q=1,y=new Array(V-1);q<V;q++)y[q-1]=arguments[q];m.fn.apply(m.context,y)}else{var S=m.length,P;for(q=0;q<S;q++)switch(m[q].once&&this.removeListener(c,m[q].fn,void 0,!0),V){case 1:m[q].fn.call(m[q].context);break;case 2:m[q].fn.call(m[q].context,u);break;case 3:m[q].fn.call(m[q].context,u,h);break;case 4:m[q].fn.call(m[q].context,u,h,A);break;default:if(!y)for(P=1,y=new Array(V-1);P<V;P++)y[P-1]=arguments[P];m[q].fn.apply(m[q].context,y)}}return!0},o.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,A){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!A||p.once)&&(!h||p.context===h)&&a(this,f);else{for(var g=0,m=[],V=p.length;g<V;g++)(p[g].fn!==u||A&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:a(this,f)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&a(this,u)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o}(Wi)),Wi.exports}var gy=my();const Nt=Ze(gy),xy=Math.PI*2,yy=180/Math.PI,Vy=Math.PI/180;class We{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new We(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Ui.x=0,Ui.y=0,Ui}}const Ui=new We;class ie{constructor(e=1,r=0,s=0,n=1,i=0,a=0){this.array=null,this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,s,n,i,a){return this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=a,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,r){r=r||new We;const s=e.x,n=e.y;return r.x=this.a*s+this.c*n+this.tx,r.y=this.b*s+this.d*n+this.ty,r}applyInverse(e,r){r=r||new We;const s=this.a,n=this.b,i=this.c,a=this.d,o=this.tx,l=this.ty,c=1/(s*a+i*-n),u=e.x,h=e.y;return r.x=a*c*u+-i*c*h+(l*i-o*a)*c,r.y=s*c*h+-n*c*u+(-l*s+o*n)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),n=this.a,i=this.c,a=this.tx;return this.a=n*r-this.b*s,this.b=n*s+this.b*r,this.c=i*r-this.d*s,this.d=i*s+this.d*r,this.tx=a*r-this.ty*s,this.ty=a*s+this.ty*r,this}append(e){const r=this.a,s=this.b,n=this.c,i=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*s+e.b*i,this.c=e.c*r+e.d*n,this.d=e.c*s+e.d*i,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*i+this.ty,this}appendFrom(e,r){const s=e.a,n=e.b,i=e.c,a=e.d,o=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,A=r.d;return this.a=s*c+n*h,this.b=s*u+n*A,this.c=i*c+a*h,this.d=i*u+a*A,this.tx=o*c+l*h+r.tx,this.ty=o*u+l*A+r.ty,this}setTransform(e,r,s,n,i,a,o,l,c){return this.a=Math.cos(o+c)*i,this.b=Math.sin(o+c)*i,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=e-(s*this.a+n*this.c),this.ty=r-(s*this.b+n*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,s=this.b,n=this.c,i=this.d,a=e.pivot,o=-Math.atan2(-n,i),l=Math.atan2(s,r),c=Math.abs(o+l);return c<1e-5||Math.abs(xy-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(r*r+s*s),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(a.x*r+a.y*n),e.position.y=this.ty+(a.x*s+a.y*i),e}invert(){const e=this.a,r=this.b,s=this.c,n=this.d,i=this.tx,a=e*n-r*s;return this.a=n/a,this.b=-r/a,this.c=-s/a,this.d=e/a,this.tx=(s*this.ty-n*i)/a,this.ty=-(e*this.ty-r*i)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ie;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return qy.identity()}static get shared(){return by.identity()}}const by=new ie,qy=new ie,dr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],fr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ar=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],pr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],to=[],of=[],rn=Math.sign;function wy(){for(let t=0;t<16;t++){const e=[];to.push(e);for(let r=0;r<16;r++){const s=rn(dr[t]*dr[r]+Ar[t]*fr[r]),n=rn(fr[t]*dr[r]+pr[t]*fr[r]),i=rn(dr[t]*Ar[r]+Ar[t]*pr[r]),a=rn(fr[t]*Ar[r]+pr[t]*pr[r]);for(let o=0;o<16;o++)if(dr[o]===s&&fr[o]===n&&Ar[o]===i&&pr[o]===a){e.push(o);break}}}for(let t=0;t<16;t++){const e=new ie;e.set(dr[t],fr[t],Ar[t],pr[t],0,0),of.push(e)}}wy();const ye={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>dr[t],uY:t=>fr[t],vX:t=>Ar[t],vY:t=>pr[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>to[t][e],sub:(t,e)=>to[t][ye.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?ye.S:ye.N:Math.abs(e)*2<=Math.abs(t)?t>0?ye.E:ye.W:e>0?t>0?ye.SE:ye.SW:t>0?ye.NE:ye.NW,matrixAppendRotationInv:(t,e,r=0,s=0)=>{const n=of[ye.inv(e)];n.tx=r,n.ty=s,t.append(n)}},sn=[new We,new We,new We,new We];class ke{constructor(e=0,r=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ke(0,0,0,0)}clone(){return new ke(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,s,n=.5){const{width:i,height:a}=this;if(i<=0||a<=0)return!1;const o=this.x,l=this.y,c=s*(1-n),u=s-c,h=o-c,A=o+i+c,f=l-c,p=l+a+c,g=o+u,m=o+i-u,V=l+u,y=l+a-u;return e>=h&&e<=A&&r>=f&&r<=p&&!(e>g&&e<m&&r>V&&r<y)}intersects(e,r){if(!r){const j=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=j)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const s=this.left,n=this.right,i=this.top,a=this.bottom;if(n<=s||a<=i)return!1;const o=sn[0].set(e.left,e.top),l=sn[1].set(e.left,e.bottom),c=sn[2].set(e.right,e.top),u=sn[3].set(e.right,e.bottom);if(c.x<=o.x||l.y<=o.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(o,o),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(o.x,l.x,c.x,u.x)<=s||Math.min(o.x,l.x,c.x,u.x)>=n||Math.max(o.y,l.y,c.y,u.y)<=i||Math.min(o.y,l.y,c.y,u.y)>=a))return!1;const A=h*(l.y-o.y),f=h*(o.x-l.x),p=A*s+f*i,g=A*n+f*i,m=A*s+f*a,V=A*n+f*a;if(Math.max(p,g,m,V)<=A*o.x+f*o.y||Math.min(p,g,m,V)>=A*u.x+f*u.y)return!1;const y=h*(o.y-c.y),q=h*(c.x-o.x),S=y*s+q*i,P=y*n+q*i,C=y*s+q*a,T=y*n+q*a;return!(Math.max(S,P,C,T)<=y*o.x+q*o.y||Math.min(S,P,C,T)>=y*u.x+q*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(s-r,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,r=.001){const s=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=s-this.x,this.height=n-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=s-r,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new ke),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,s=e.y,n=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Yi={default:-1};function Se(t="default"){return Yi[t]===void 0&&(Yi[t]=-1),++Yi[t]}const Gc={},Ge="8.0.0",vy="8.3.4";function _e(t,e,r=3){if(Gc[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(s=s.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(s))),Gc[e]=!0}const lf=()=>{};function Nn(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Wc(t){return!(t&t-1)&&!!t}function cf(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const Uc=Object.create(null);function _y(t){const e=Uc[t];return e===void 0&&(Uc[t]=Se("resource")),e}const uf=class hf extends Nt{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...hf.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){_e(Ge,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=_y(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};uf.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let ky=uf;const df=class ff extends Nt{constructor(e={}){super(),this.options=e,this.uid=Se("textureSource"),this._resourceType="textureSource",this._resourceId=Se("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...ff.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new ky(cf(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Se("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,s){s||(s=this._resolution),e||(e=this.width),r||(r=this.height);const n=Math.round(e*s),i=Math.round(r*s);return this.width=n/s,this.height=i/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=Se("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Wc(this.pixelWidth)&&Wc(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};df.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Ot=df;class Ko extends Ot{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(r instanceof Float32Array?s="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?s="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?s="rgba16uint":(r instanceof Int8Array,s="bgra8unorm")),super({...e,resource:r,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}Ko.extension=U.TextureSource;const Yc=new ie;class Sy{constructor(e,r){this.mapCoord=new ie,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],a=e[n+1];r[n]=i*s.a+a*s.c+s.tx,r[n+1]=i*s.b+a*s.d+s.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(Yc.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Yc));const i=e.source,a=this.uClampFrame,o=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return a[0]=(e.frame.x+o+l)/i.width,a[1]=(e.frame.y+o+l)/i.height,a[2]=(e.frame.x+e.frame.width-o+l)/i.width,a[3]=(e.frame.y+e.frame.height-o+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class ne extends Nt{constructor({source:e,label:r,frame:s,orig:n,trim:i,defaultAnchor:a,defaultBorders:o,rotate:l,dynamic:c}={}){if(super(),this.uid=Se("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ke,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new Ot,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Sy(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:s,height:n}=this._source,i=r.x/s,a=r.y/n,o=r.width/s,l=r.height/n;let c=this.rotate;if(c){const u=o/2,h=l/2,A=i+u,f=a+h;c=ye.add(c,ye.NW),e.x0=A+u*ye.uX(c),e.y0=f+h*ye.uY(c),c=ye.add(c,2),e.x1=A+u*ye.uX(c),e.y1=f+h*ye.uY(c),c=ye.add(c,2),e.x2=A+u*ye.uX(c),e.y2=f+h*ye.uY(c),c=ye.add(c,2),e.x3=A+u*ye.uX(c),e.y3=f+h*ye.uY(c)}else e.x0=i,e.y0=a,e.x1=i+o,e.y1=a,e.x2=i+o,e.y2=a+l,e.x3=i,e.y3=a+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return _e(Ge,"Texture.baseTexture is now Texture.source"),this._source}}ne.EMPTY=new ne({label:"EMPTY",source:new Ot({label:"EMPTY"})});ne.EMPTY.destroy=lf;ne.WHITE=new ne({source:new Ko({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});ne.WHITE.destroy=lf;function Cy(t,e,r){const{width:s,height:n}=r.orig,i=r.trim;if(i){const a=i.width,o=i.height;t.minX=i.x-e._x*s,t.maxX=t.minX+a,t.minY=i.y-e._y*n,t.maxY=t.minY+o}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*n,t.maxY=t.minY+n}const Xc=new ie;class Pt{constructor(e=1/0,r=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xc,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ke);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Xc,this}set(e,r,s,n){this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(e,r,s,n,i){i||(i=this.matrix);const a=i.a,o=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let A=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=a*e+l*r+u,V=o*e+c*r+h;m<A&&(A=m),V<f&&(f=V),m>p&&(p=m),V>g&&(g=V),m=a*s+l*r+u,V=o*s+c*r+h,m<A&&(A=m),V<f&&(f=V),m>p&&(p=m),V>g&&(g=V),m=a*e+l*n+u,V=o*e+c*n+h,m<A&&(A=m),V<f&&(f=V),m>p&&(p=m),V>g&&(g=V),m=a*s+l*n+u,V=o*s+c*n+h,m<A&&(A=m),V<f&&(f=V),m>p&&(p=m),V>g&&(g=V),this.minX=A,this.minY=f,this.maxX=p,this.maxY=g}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,s=this.minY,n=this.maxX,i=this.maxY,{a,b:o,c:l,d:c,tx:u,ty:h}=e;let A=a*r+l*s+u,f=o*r+c*s+h;this.minX=A,this.minY=f,this.maxX=A,this.maxY=f,A=a*n+l*s+u,f=o*n+c*s+h,this.minX=A<this.minX?A:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=A>this.maxX?A:this.maxX,this.maxY=f>this.maxY?f:this.maxY,A=a*r+l*i+u,f=o*r+c*i+h,this.minX=A<this.minX?A:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=A>this.maxX?A:this.maxX,this.maxY=f>this.maxY?f:this.maxY,A=a*n+l*i+u,f=o*n+c*i+h,this.minX=A<this.minX?A:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=A>this.maxX?A:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,s,n){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Pt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,s,n){let i=this.minX,a=this.minY,o=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,A=n.d,f=n.tx,p=n.ty;for(let g=r;g<s;g+=2){const m=e[g],V=e[g+1],y=c*m+h*V+f,q=u*m+A*V+p;i=y<i?y:i,a=q<a?q:a,o=y>o?y:o,l=q>l?q:l}this.minX=i,this.minY=a,this.maxX=o,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var My={grad:.9,turn:360,rad:360/(2*Math.PI)},Ht=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Be=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},wt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},Af=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},$c=function(t){return{r:wt(t.r,0,255),g:wt(t.g,0,255),b:wt(t.b,0,255),a:wt(t.a)}},Xi=function(t){return{r:Be(t.r),g:Be(t.g),b:Be(t.b),a:Be(t.a,3)}},Py=/^#([0-9a-f]{3,8})$/i,nn=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},pf=function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=Math.max(e,r,s),a=i-Math.min(e,r,s),o=a?i===e?(r-s)/a:i===r?2+(s-e)/a:4+(e-r)/a:0;return{h:60*(o<0?o+6:o),s:i?a/i*100:0,v:i/255*100,a:n}},mf=function(t){var e=t.h,r=t.s,s=t.v,n=t.a;e=e/360*6,r/=100,s/=100;var i=Math.floor(e),a=s*(1-r),o=s*(1-(e-i)*r),l=s*(1-(1-e+i)*r),c=i%6;return{r:255*[s,o,a,a,l,s][c],g:255*[l,s,s,o,a,a][c],b:255*[a,a,l,s,s,o][c],a:n}},Kc=function(t){return{h:Af(t.h),s:wt(t.s,0,100),l:wt(t.l,0,100),a:wt(t.a)}},Qc=function(t){return{h:Be(t.h),s:Be(t.s),l:Be(t.l),a:Be(t.a,3)}},Zc=function(t){return mf((r=(e=t).s,{h:e.h,s:(r*=((s=e.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:e.a}));var e,r,s},bs=function(t){return{h:(e=pf(t)).h,s:(n=(200-(r=e.s))*(s=e.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,s,n},Ty=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ey=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Iy=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ry=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ro={string:[[function(t){var e=Py.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Be(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Be(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=Iy.exec(t)||Ry.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:$c({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=Ty.exec(t)||Ey.exec(t);if(!e)return null;var r,s,n=Kc({h:(r=e[1],s=e[2],s===void 0&&(s="deg"),Number(r)*(My[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Zc(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=n===void 0?1:n;return Ht(e)&&Ht(r)&&Ht(s)?$c({r:Number(e),g:Number(r),b:Number(s),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,s=t.l,n=t.a,i=n===void 0?1:n;if(!Ht(e)||!Ht(r)||!Ht(s))return null;var a=Kc({h:Number(e),s:Number(r),l:Number(s),a:Number(i)});return Zc(a)},"hsl"],[function(t){var e=t.h,r=t.s,s=t.v,n=t.a,i=n===void 0?1:n;if(!Ht(e)||!Ht(r)||!Ht(s))return null;var a=function(o){return{h:Af(o.h),s:wt(o.s,0,100),v:wt(o.v,0,100),a:wt(o.a)}}({h:Number(e),s:Number(r),v:Number(s),a:Number(i)});return mf(a)},"hsv"]]},Jc=function(t,e){for(var r=0;r<e.length;r++){var s=e[r][0](t);if(s)return[s,e[r][1]]}return[null,void 0]},By=function(t){return typeof t=="string"?Jc(t.trim(),ro.string):typeof t=="object"&&t!==null?Jc(t,ro.object):[null,void 0]},$i=function(t,e){var r=bs(t);return{h:r.h,s:wt(r.s+100*e,0,100),l:r.l,a:r.a}},Ki=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},eu=function(t,e){var r=bs(t);return{h:r.h,s:r.s,l:wt(r.l+100*e,0,100),a:r.a}},so=function(){function t(e){this.parsed=By(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Be(Ki(this.rgba),2)},t.prototype.isDark=function(){return Ki(this.rgba)<.5},t.prototype.isLight=function(){return Ki(this.rgba)>=.5},t.prototype.toHex=function(){return e=Xi(this.rgba),r=e.r,s=e.g,n=e.b,a=(i=e.a)<1?nn(Be(255*i)):"","#"+nn(r)+nn(s)+nn(n)+a;var e,r,s,n,i,a},t.prototype.toRgb=function(){return Xi(this.rgba)},t.prototype.toRgbString=function(){return e=Xi(this.rgba),r=e.r,s=e.g,n=e.b,(i=e.a)<1?"rgba("+r+", "+s+", "+n+", "+i+")":"rgb("+r+", "+s+", "+n+")";var e,r,s,n,i},t.prototype.toHsl=function(){return Qc(bs(this.rgba))},t.prototype.toHslString=function(){return e=Qc(bs(this.rgba)),r=e.h,s=e.s,n=e.l,(i=e.a)<1?"hsla("+r+", "+s+"%, "+n+"%, "+i+")":"hsl("+r+", "+s+"%, "+n+"%)";var e,r,s,n,i},t.prototype.toHsv=function(){return e=pf(this.rgba),{h:Be(e.h),s:Be(e.s),v:Be(e.v),a:Be(e.a,3)};var e},t.prototype.invert=function(){return zt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),zt($i(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),zt($i(this.rgba,-e))},t.prototype.grayscale=function(){return zt($i(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),zt(eu(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),zt(eu(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?zt({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Be(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=bs(this.rgba);return typeof e=="number"?zt({h:e,s:r.s,l:r.l,a:r.a}):Be(r.h)},t.prototype.isEqual=function(e){return this.toHex()===zt(e).toHex()},t}(),zt=function(t){return t instanceof so?t:new so(t)},tu=[],zy=function(t){t.forEach(function(e){tu.indexOf(e)<0&&(e(so,ro),tu.push(e))})};function jy(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in r)s[r[n]]=n;var i={};t.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,c=s[this.toHex()];if(c)return c;if(a?.closest){var u=this.toRgb(),h=1/0,A="black";if(!i.length)for(var f in r)i[f]=new t(r[f]).toRgb();for(var p in r){var g=(o=u,l=i[p],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));g<h&&(h=g,A=p)}return A}},e.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":r[o];return l?new t(l).toRgb():null},"name"])}zy([jy]);const Ur=class ps{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof ps)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const s=typeof e;if(s!==typeof r)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,a)=>i===r[a]);if(e!==null&&r!==null){const i=Object.keys(e),a=Object.keys(r);return i.length!==a.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,s,n]=this._components;return{r:e,g:r,b:s,a:n}}toRgb(){const[e,r,s]=this._components;return{r:e,g:r,b:s}}toRgbaString(){const[e,r,s]=this.toUint8RgbArray();return`rgba(${e},${r},${s},${this.alpha})`}toUint8RgbArray(e){const[r,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(s*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,s,n,i]=this._components;return e[0]=r,e[1]=s,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,s,n]=this._components;return e[0]=r,e[1]=s,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,r,s]=this.toUint8RgbArray();return(s<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,s,n,i]=ps._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=s,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return r&&(s=s*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,s,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;r=(a>>16&255)/255,s=(a>>8&255)/255,n=(a&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,s,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,s,n,i=255]=e,r/=255,s/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=ps.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const a=zt(e);a.isValid()&&({r,g:s,b:n,a:i}=a.rgba,r/=255,s/=255,n/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=s,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,s]=this._components;this._int=(e*255<<16)+(r*255<<8)+(s*255|0)}_clamp(e,r=0,s=1){return typeof e=="number"?Math.min(Math.max(e,r),s):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,r),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof ps||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Ur.shared=new Ur;Ur._temp=new Ur;Ur.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Le=Ur;const Fy={cullArea:null,cullable:!1,cullableChildren:!0};class Qo{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Ny{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Qo(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const s=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[s]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const Kt=new Ny,Oy={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){_e("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function Ly(t,e,r){const s=t.length;let n;if(e>=s||r===0)return;r=e+r>s?s-e:r;const i=s-r;for(n=e;n<i;++n)t[n]=t[n+r];t.length=i}const Dy={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,s=r-t,n=[];if(s>0&&s<=r){for(let a=r-1;a>=t;a--){const o=this.children[a];o&&(n.push(o),o.parent=null)}Ly(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let a=0;a<n.length;++a)this.emit("childRemoved",n[a],this,a),n[a].emit("removed",this);return n.length>0&&this._didViewChangeTick++,n}else if(s===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||_e(Ge,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),r.prepend(s),t.setFromMatrix(r),t}},Hy={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const s=this.children,n=s.length;for(let i=0;i<n;i++)s[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:s}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];s[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];s[i.pipe].pop(i,this,t)}}};class ru{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class Gy{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const s=this._tests[r];if(s.test(e))return Kt.get(s.maskClass,e)}return e}returnMaskEffect(e){Kt.return(e)}}const no=new Gy;it.handleByList(U.MaskEffect,no._effectClasses);const Wy={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,s)=>r.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),no.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=no.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new ru);t=t;const r=t?.length>0,s=e.filters?.length>0,n=r!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new ru),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},Uy={label:null,get name(){return _e(Ge,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){_e(Ge,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let s=0;s<r.length;s++){const n=r[s];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let s=0;s<r.length;s++){const i=r[s].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const s=this.children;for(let n=0;n<s.length;n++){const i=s[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let n=0;n<s.length;n++)s[n].getChildrenByLabel(t,!0,r);return r}},Qe=new Qo(ie),Qt=new Qo(Pt),Yy=new ie,Xy={getFastGlobalBounds(t,e){e||(e=new Pt),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(s=Qt.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;s.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const i=this.children;for(let a=0;a<i.length;a++)i[a]._getGlobalBoundsRecursive(t,s,r)}if(n){let i=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(i||(i=!0,s.applyMatrix(a.worldTransform)),this.effects[o].addBounds(s,!0));i&&(s.applyMatrix(a.worldTransform.copyTo(Yy).invert()),e.addBounds(s,this.relativeGroupTransform)),e.addBounds(s),Qt.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Qt.return(s))}};function gf(t,e,r){r.clear();let s,n;return t.parent?e?s=t.parent.worldTransform:(n=Qe.get().identity(),s=Zo(t,n)):s=ie.IDENTITY,xf(t,r,s,e),n&&Qe.return(n),r.isValid||r.set(0,0,0,0),r}function xf(t,e,r,s){if(!t.visible||!t.measurable)return;let n;s?n=t.worldTransform:(t.updateLocalTransform(),n=Qe.get(),n.appendFrom(t.localTransform,r));const i=e,a=!!t.effects.length;if(a&&(e=Qt.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{t.bounds&&(e.matrix=n,e.addBounds(t.bounds));for(let o=0;o<t.children.length;o++)xf(t.children[o],e,n,s)}if(a){for(let o=0;o<t.effects.length;o++)t.effects[o].addBounds?.(e);i.addBounds(e,ie.IDENTITY),Qt.return(e)}s||Qe.return(n)}function Zo(t,e){const r=t.parent;return r&&(Zo(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function yf(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,s=t>>8&255,n=t&255,i=e>>16&255,a=e>>8&255,o=e&255,l=r*i/255|0,c=s*a/255|0,u=n*o/255|0;return(l<<16)+(c<<8)+u}const su=16777215;function nu(t,e){return t===su?e:e===su?t:yf(t,e)}function wn(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const $y={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=Zo(this,Qe.get().identity());return t.appendFrom(this.localTransform,r),Qe.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?wn(this.renderGroup.worldColor):this.parentRenderGroup?wn(nu(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=nu(e,r.localColor),r=r.parent;return wn(e)}};let Qi=0;const iu=500;function Ve(...t){Qi!==iu&&(Qi++,Qi===iu?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function Vf(t,e,r){return e.clear(),r||(r=ie.IDENTITY),bf(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function bf(t,e,r,s,n){let i;if(n)i=Qe.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=Qe.get(),i.appendFrom(l,r)}const a=e,o=!!t.effects.length;if(o&&(e=Qt.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)bf(l[c],e,i,s,!1)}if(o){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);a.addBounds(e,ie.IDENTITY),Qt.return(e)}Qe.return(i)}function qf(t,e){const r=t.children;for(let s=0;s<r.length;s++){const n=r[s],i=n.uid,a=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,o=e.index;(e.data[o]!==i||e.data[o+1]!==a)&&(e.data[e.index]=i,e.data[e.index+1]=a,e.didChange=!0),e.index=o+2,n.children.length&&qf(n,e)}return e.didChange}const Ky=new ie,Qy={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Pt});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),qf(this,t),t.didChange&&Vf(this,t.localBounds,Ky),t.localBounds},getBounds(t,e){return gf(this,t,e||new Pt)}},Zy={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},Jy={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(eV))}};function eV(t,e){return t._zIndex-e._zIndex}const tV={getGlobalPosition(t=new We,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const s=this.getGlobalTransform(Qe.get(),r);return e=s.apply(t,e),Qe.return(s),e},toLocal(t,e,r,s){e&&(t=e.toGlobal(t,r,s));const n=this.getGlobalTransform(Qe.get(),s);return r=n.applyInverse(t,r),Qe.return(n),r}};class wf{constructor(){this.uid=Se("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let rV=0;class sV{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,s){const n=new Ot({...this.textureOptions,width:e,height:r,resolution:1,antialias:s,autoGarbageCollect:!1});return new ne({source:n,label:`texturePool_${rV++}`})}getOptimalTexture(e,r,s=1,n){let i=Math.ceil(e*s-1e-6),a=Math.ceil(r*s-1e-6);i=Nn(i),a=Nn(a);const o=(i<<17)+(a<<1)+(n?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let l=this._texturePool[o].pop();return l||(l=this.createTexture(i,a,n)),l.source._resolution=s,l.source.width=i/s,l.source.height=a/s,l.source.pixelWidth=i,l.source.pixelHeight=a,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=o,l}getSameSizeTexture(e,r=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const s=this._texturePool[r];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const nV=new sV;class iV{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ie,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new wf,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let s=0;s<r.length;s++){const n=r[s];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(nV.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let s=0;s<r.length;s++)this.addChild(r[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let s=0;s<r.length;s++)this.removeChild(r[s])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const s=e.children;for(let n=0;n<s.length;n++)this._getChildren(s[n],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new ie),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new ie),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new ie),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function aV(t,e,r={}){for(const s in e)!r[s]&&e[s]!==void 0&&(t[s]=e[s])}const Zi=new ut(null),Ji=new ut(null),ea=new ut(null,1,1),au=1,oV=2,ta=4;class Ls extends Nt{constructor(e={}){super(),this.uid=Se("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ie,this.relativeGroupTransform=new ie,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ut(this,0,0),this._scale=ea,this._pivot=Ji,this._skew=Zi,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],aV(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){_e("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),it.mixin(Ls,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||_e(Ge,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const r=e[0],s=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),s&&(s.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,s&&s.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const r=e[0],s=this.children.indexOf(r);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,s),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Kt.get(iV,this),this.groupTransform=ie.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Kt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ie),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*yy}set angle(e){this.rotation=e*Vy}get pivot(){return this._pivot===Ji&&(this._pivot=new ut(this,0,0)),this._pivot}set pivot(e){this._pivot===Ji&&(this._pivot=new ut(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Zi&&(this._skew=new ut(this,0,0)),this._skew}set skew(e){this._skew===Zi&&(this._skew=new ut(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===ea&&(this._scale=new ut(this,1,1)),this._scale}set scale(e){this._scale===ea&&(this._scale=new ut(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const s=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,s=this._scale,n=this._pivot,i=this._position,a=s._x,o=s._y,l=n._x,c=n._y;r.a=this._cx*a,r.b=this._sx*a,r.c=this._cy*o,r.d=this._sy*o,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=au,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=Le.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=au,this._onUpdate())}get tint(){return wn(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=oV,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ta,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ta,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=ta,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let n=0;n<r.length;++n)r[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}it.mixin(Ls,Dy,Xy,tV,Zy,Qy,Wy,Uy,Jy,Fy,Oy,$y,Hy);class lV extends Ls{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new Pt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:s,y:n}=e;return s>=r.minX&&s<=r.maxX&&n>=r.minY&&n<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,s){const{renderPipes:n,renderableGC:i}=r;n.blendMode.setBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const o=this.children,l=o.length;for(let c=0;c<l;c++)o[c].collectRenderables(e,r,s)}}class Cs extends lV{constructor(e=ne.EMPTY){e instanceof ne&&(e={texture:e});const{texture:r=ne.EMPTY,anchor:s,roundPixels:n,width:i,height:a,...o}=e;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ut({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),a!==void 0&&(this.height=a)}static from(e,r=!1){return e instanceof ne?new Cs(e):new Cs(ne.from(e,r))}set texture(e){e||(e=ne.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Cy(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return _e("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,s=this._bounds,{width:n,height:i}=r.orig;s.minX=-e._x*n,s.maxX=s.minX+n,s.minY=-e._y*i,s.maxY=s.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const cV=new Pt;function vf(t,e,r){const s=cV;t.measurable=!0,gf(t,r,s),e.addBoundsMask(s),t.measurable=!1}function _f(t,e,r){const s=Qt.get();t.measurable=!0;const n=Qe.get().identity(),i=kf(t,r,n);Vf(t,s,i),t.measurable=!1,e.addBoundsMask(s),Qe.return(n),Qt.return(s)}function kf(t,e,r){return t?(t!==e&&(kf(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(Ve("Mask bounds, renderable is not inside the root container"),r)}class Sf{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Cs),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||vf(this.mask,e,r)}addLocalBounds(e,r){_f(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Cs}}Sf.extension=U.MaskEffect;class Cf{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Cf.extension=U.MaskEffect;class Mf{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){vf(this.mask,e,r)}addLocalBounds(e,r){_f(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Ls}}Mf.extension=U.MaskEffect;const uV={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let ou=uV;const Ee={get(){return ou},set(t){ou=t}};class Pf extends Ot{constructor(e){e.resource||(e.resource=Ee.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,s=this._resolution){const n=super.resize(e,r,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Pf.extension=U.TextureSource;class wr extends Ot{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=Ee.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,Ve("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}wr.extension=U.TextureSource;var On=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(On||{});class ra{constructor(e,r=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=s,this._once=n}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Tf=class ct{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ra(null,null,1/0),this.deltaMS=1/ct.targetFPMS,this.elapsedMS=1/ct.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,s=On.NORMAL){return this._addListener(new ra(e,r,s))}addOnce(e,r,s=On.NORMAL){return this._addListener(new ra(e,r,s,!0))}_addListener(e){let r=this._head.next,s=this._head;if(!r)e.connect(s);else{for(;r;){if(e.priority>r.priority){e.connect(s);break}s=r,r=r.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,r){let s=this._head.next;for(;s;)s.match(e,r)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*ct.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,r)/1e3,ct.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!ct._shared){const e=ct._shared=new ct;e.autoStart=!0,e._protected=!0}return ct._shared}static get system(){if(!ct._system){const e=ct._system=new ct;e.autoStart=!0,e._protected=!0}return ct._system}};Tf.targetFPMS=.06;let nt=Tf,sa;async function Ef(){return sa??(sa=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(a=>{const o=document.createElement("video");o.onloadeddata=()=>a(o),o.onerror=()=>a(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!r)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),sa}const ei=class If extends Ot{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...If.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=nt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await Ef(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(nt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(nt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(nt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};ei.extension=U.TextureSource;ei.defaultOptions={...Ot.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ei.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let vn=ei;const Mt=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||r?e(s):s):t);class hV{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||Ve(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const s=Mt(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(s,r);break}}const i=new Map(Object.entries(n||{}));n||s.forEach(l=>{i.set(l,r)});const a=[...i.keys()],o={cacheKeys:a,keys:s};s.forEach(l=>{this._cacheMap.set(l,o)}),a.forEach(l=>{const c=n?n[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&Ve("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){Ve(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const we=new hV,io=[];it.handleByList(U.TextureSource,io);function Rf(t={}){const e=t&&t.resource,r=e?t.resource:t,s=e?t:{resource:t};for(let n=0;n<io.length;n++){const i=io[n];if(i.test(r))return new i(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function dV(t={},e=!1){const r=t&&t.resource,s=r?t.resource:t,n=r?t:{resource:t};if(!e&&we.has(s))return we.get(s);const i=new ne({source:Rf(n)});return i.on("destroy",()=>{we.has(s)&&we.remove(s)}),e||we.set(s,i),i}function fV(t,e=!1){return typeof t=="string"?we.get(t):t instanceof Ot?new ne({source:t}):dV(t,e)}ne.from=fV;Ot.from=Rf;it.add(Sf,Cf,Mf,vn,wr,Pf,Ko);var lr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(lr||{});function vt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function ls(t){return t.split("?")[0].split("#")[0]}function AV(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function pV(t,e,r){return t.replace(new RegExp(AV(e),"g"),r)}function mV(t,e){let r="",s=0,n=-1,i=0,a=-1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",s=0):(r=r.slice(0,l),s=r.length-1-r.lastIndexOf("/")),n=o,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,n=o,i=0;continue}}}else r.length>0?r+=`/${t.slice(n+1,o)}`:r=t.slice(n+1,o),s=o-n-1;n=o,i=0}else a===46&&i!==-1?++i:i=-1}return r}const At={toPosix(t){return pV(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){vt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(vt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=ls(this.toPosix(e??Ee.get().getBaseUrl())),n=ls(this.toPosix(r??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?At.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(vt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=mV(t),t.length>0&&s&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return vt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const s=t[r];if(vt(s),s.length>0)if(e===void 0)e=s;else{const n=t[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(vt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let s=-1,n=!0;const i=this.getProtocol(t),a=t;t=t.slice(i.length);for(let o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),e===47){if(!n){s=o;break}}else n=!1;return s===-1?r?"/":this.isUrl(a)?i+t:i:r&&s===1?"//":i+t.slice(0,s)},rootname(t){vt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){vt(t),e&&vt(e),t=ls(this.toPosix(t));let r=0,s=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){r=i+1;break}}else o===-1&&(n=!1,o=i+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(s=i):(a=-1,s=o))}return r===s?s=o:s===-1&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){r=i+1;break}}else s===-1&&(n=!1,s=i+1);return s===-1?"":t.slice(r,s)},extname(t){vt(t),t=ls(this.toPosix(t));let e=-1,r=0,s=-1,n=!0,i=0;for(let a=t.length-1;a>=0;--a){const o=t.charCodeAt(a);if(o===47){if(!n){r=a+1;break}continue}s===-1&&(n=!1,s=a+1),o===46?e===-1?e=a:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||s===-1||i===0||i===1&&e===s-1&&e===r+1?"":t.slice(e,s)},parse(t){vt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=ls(this.toPosix(t));let r=t.charCodeAt(0);const s=this.isAbsolute(t);let n;e.root=this.rootname(t),s||this.hasProtocol(t)?n=1:n=0;let i=-1,a=0,o=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!l){a=c+1;break}continue}o===-1&&(l=!1,o=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||o===-1||u===0||u===1&&i===o-1&&i===a+1?o!==-1&&(a===0&&s?e.base=e.name=t.slice(1,o):e.base=e.name=t.slice(a,o)):(a===0&&s?(e.name=t.slice(1,i),e.base=t.slice(1,o)):(e.name=t.slice(a,i),e.base=t.slice(a,o)),e.ext=t.slice(i,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Bf(t,e,r,s,n){const i=e[r];for(let a=0;a<i.length;a++){const o=i[a];r<e.length-1?Bf(t.replace(s[r],o),e,r+1,s,n):n.push(t.replace(s[r],o))}}function gV(t){const e=/\{(.*?)\}/g,r=t.match(e),s=[];if(r){const n=[];r.forEach(i=>{const a=i.substring(1,i.length-1).split(",");n.push(a)}),Bf(t,n,0,r,s)}else s.push(t);return s}const Ln=t=>!Array.isArray(t);class es{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}getAlias(e){const{alias:r,src:s}=e;return Mt(r||s,i=>typeof i=="string"?i:Array.isArray(i)?i.map(a=>a?.src??a):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&Ve("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const s=[];let n=r;Array.isArray(r)||(n=Object.entries(r).map(([i,a])=>typeof a=="string"||Array.isArray(a)?{alias:i,src:a}:{alias:i,...a})),n.forEach(i=>{const a=i.src,o=i.alias;let l;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);s.push(c),l=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));s.push(...c),l=[...o,...c]}this.add({...i,alias:l,src:a})}),this._bundles[e]=s}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let s;s=i=>{this.hasKey(i)&&Ve(`[Resolver] already has key: ${i} overwriting`)},Mt(r).forEach(i=>{const{src:a}=i;let{data:o,format:l,loadParser:c}=i;const u=Mt(a).map(f=>typeof f=="string"?gV(f):Array.isArray(f)?f:[f]),h=this.getAlias(i);Array.isArray(h)?h.forEach(s):s(h);const A=[];u.forEach(f=>{f.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const V=this._parsers[m];if(V.test(p)){g=V.parse(p);break}}}else o=p.data??o,l=p.format??l,c=p.loadParser??c,g={...g,...p};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:h,data:o,format:l,loadParser:c}),A.push(g)})}),h.forEach(f=>{this._assetMap[f]=A})})}resolveBundle(e){const r=Ln(e);e=Mt(e);const s={};return e.forEach(n=>{const i=this._bundles[n];if(i){const a=this.resolve(i),o={};for(const l in a){const c=a[l];o[this._extractAssetIdFromBundle(n,l)]=c}s[n]=o}}),r?s[e[0]]:s}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const s={};for(const n in r)s[n]=r[n].src;return s}return r.src}resolve(e){const r=Ln(e);e=Mt(e);const s={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const a=this._getPreferredOrder(i);a?.priority.forEach(o=>{a.params[o].forEach(l=>{const c=i.filter(u=>u[o]?u[o]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),r?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const s=e[r],n=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:s,data:n,loadParser:i,format:a}=r;return(this._basePath||this._rootPath)&&(e.src=At.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.format=a??e.format??xV(e.src),e}}es.RETINA_PREFIX=/@([0-9\.]+)x/;function xV(t){return t.split(".").pop().split("?").shift().split("#").shift()}const ao=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},zf=class ms{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof ne?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const s=parseFloat(r.meta.scale);s?(this.resolution=s,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ms.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const s=ms.BATCH_SIZE;for(;r-e<s&&r<this._frameKeys.length;){const n=this._frameKeys[r],i=this._frames[n],a=i.frame;if(a){let o=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new ke(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?o=new ke(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new ke(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new ke(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new ne({source:this.textureSource,frame:o,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let s=0;s<e[r].length;s++){const n=e[r][s];this.animations[r].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ms.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ms.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};zf.BATCH_SIZE=1e3;let oo=zf;const yV=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function jf(t,e,r){const s={};if(t.forEach(n=>{s[n]=e}),Object.keys(e.textures).forEach(n=>{s[n]=e.textures[n]}),!r){const n=At.dirname(t[0]);e.linkedSheets.forEach((i,a)=>{const o=jf([`${n}/${e.data.meta.related_multi_packs[a]}`],i,!0);Object.assign(s,o)})}return s}const VV={extension:U.Asset,cache:{test:t=>t instanceof oo,getCacheableAssets:(t,e)=>jf(t,e,!1)},resolver:{extension:{type:U.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),s=r.pop(),n=r.pop();return s==="json"&&yV.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(es.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:U.LoadParser,priority:lr.Normal,name:"spritesheetLoader"},async testParse(t,e){return At.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:s,imageFilename:n,textureOptions:i}=e?.data??{};let a=At.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let o;if(s instanceof ne)o=s;else{const u=ao(a+(n??t.meta.image),e.src);o=(await r.load([{src:u,data:i}]))[u]}const l=new oo(o.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const A of c){if(typeof A!="string")continue;let f=a+A;e.data?.ignoreMultiPack||(f=ao(f,e.src),u.push(r.load({src:f,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(A=>{A.linkedSheets=[l].concat(l.linkedSheets.filter(f=>f!==A))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};it.add(VV);const na=Object.create(null),lu=Object.create(null);function Jo(t,e){let r=lu[t];return r===void 0&&(na[e]===void 0&&(na[e]=1),lu[t]=r=na[e]++),r}let an;function Ff(){return(!an||an?.isContextLost())&&(an=Ee.get().createCanvas().getContext("webgl",{})),an}let on;function bV(){if(!on){on="mediump";const t=Ff();t&&t.getShaderPrecisionFormat&&(on=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return on}function qV(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function wV(t,e,r){const s=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&s!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function vV(t,e){return e?`#version 300 es
${t}`:t}const _V={},kV={};function SV(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const s=r?_V:kV;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function CV(t,e){return e?t.replace("#version 300 es",""):t}const ia={stripVersion:CV,ensurePrecision:wV,addProgramDefines:qV,setProgramName:SV,insertVersion:vV},aa=Object.create(null),Nf=class lo{constructor(e){e={...lo.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:bV()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let n=e.fragment,i=e.vertex;Object.keys(ia).forEach(a=>{const o=s[a];n=ia[a](n,o,!0),i=ia[a](i,o,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=Jo(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return aa[r]||(aa[r]=new lo(e)),aa[r]}};Nf.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Of=Nf;const cu={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function MV(t){return cu[t]??cu.float32}const PV={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function TV({source:t,entryPoint:e}){const r={},s=t.indexOf(`fn ${e}`);if(s!==-1){const n=t.indexOf("->",s);if(n!==-1){const i=t.substring(s,n),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(i))!==null;){const l=PV[o[3]]??"float32";r[o[2]]={location:parseInt(o[1],10),format:l,stride:MV(l).stride,offset:0,instance:!1,start:0}}}}return r}function oa(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(a)?.map(h=>{const A=h.match(l)[1],f=h.match(o).reduce((p,g)=>{const[m,V]=g.split(":");return p[m.trim()]=V.trim(),p},{});return f?{name:A,members:f}:null}).filter(({name:h})=>c.some(A=>A.type===h))??[];return{groups:c,structs:u}}var gs=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(gs||{});function EV({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:gs.VERTEX|gs.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:gs.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:gs.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function IV({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function RV(t,e){const r=new Set,s=new Set,n=[...t.structs,...e.structs].filter(a=>r.has(a.name)?!1:(r.add(a.name),!0)),i=[...t.groups,...e.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return s.has(o)?!1:(s.add(o),!0)});return{structs:n,groups:i}}const la=Object.create(null);class ti{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:s,layout:n,gpuLayout:i,name:a}=e;if(this.name=a,this.fragment=r,this.vertex=s,r.source===s.source){const o=oa(r.source);this.structsAndGroups=o}else{const o=oa(s.source),l=oa(r.source);this.structsAndGroups=RV(o,l)}this.layout=n??IV(this.structsAndGroups),this.gpuLayout=i??EV(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,s=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=Jo(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=TV(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return la[r]||(la[r]=new ti(e)),la[r]}}const Lf=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],BV=Lf.reduce((t,e)=>(t[e]=!0,t),{});function zV(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Df=class Hf{constructor(e,r){this._touched=0,this.uid=Se("uniform"),this._resourceType="uniformGroup",this._resourceId=Se("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...Hf.defaultOptions,...r},this.uniformStructures=e;const s={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!BV[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${Lf.join(", ")}`);i.value??(i.value=zV(i.type,i.size)),s[n]=i.value}this.uniforms=s,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=Jo(Object.keys(s).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Df.defaultOptions={ubo:!1,isStatic:!1};let Gf=Df;class _n{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const s in e){const n=e[s];this.setResource(n,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const s in this.resources)e[r++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,r){const s=this.resources[r];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const s in r)r[s]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const s in r)r[s]===e&&(r[s]=null)}else this._updateKey()}}var co=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(co||{});class el extends Nt{constructor(e){super(),this.uid=Se("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:s,groups:n,resources:i,compatibleRenderers:a,groupMap:o}=e;this.gpuProgram=r,this.glProgram=s,a===void 0&&(a=0,r&&(a|=co.WEBGPU),s&&(a|=co.WEBGL)),this.compatibleRenderers=a;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&n&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&n&&o)for(const c in o)for(const u in o[c]){const h=o[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&n&&!o){const c=r.structsAndGroups.groups;o={},c.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},o={},r&&r.structsAndGroups.groups.forEach(h=>{o[h.group]=o[h.group]||{},o[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new _n,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},o[99]=o[99]||{},o[99][c]=u,c++);for(const u in i){const h=u;let A=i[u];!A.source&&!A._resourceType&&(A=new Gf(A));const f=l[h];f&&(n[f.group]||(n[f.group]=new _n,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(A,f.binding))}}this.groups=n,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(n,l)}addResource(e,r,s){var n,i;(n=this._uniformBindMap)[r]||(n[r]={}),(i=this._uniformBindMap[r])[s]||(i[s]=e),this.groups[r]||(this.groups[r]=new _n,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const s={};for(const n in r){const i=r[n];Object.defineProperty(s,i.name,{get(){return e[i.group].getResource(i.binding)},set(a){e[i.group].setResource(a,i.binding)}})}return s}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:s,...n}=e;let i,a;return r&&(i=ti.from(r)),s&&(a=Of.from(s)),new el({gpuProgram:i,glProgram:a,...n})}}var ln={exports:{}},uu;function jV(){if(uu)return ln.exports;uu=1,ln.exports=t,ln.exports.default=t;function t(x,v,_){_=_||2;var w=v&&v.length,b=w?v[0]*_:x.length,k=e(x,0,b,_,!0),M=[];if(!k||k.next===k.prev)return M;var E,z,L,X,$,Z,he;if(w&&(k=l(x,v,k,_)),x.length>80*_){E=L=x[0],z=X=x[1];for(var ee=_;ee<b;ee+=_)$=x[ee],Z=x[ee+1],$<E&&(E=$),Z<z&&(z=Z),$>L&&(L=$),Z>X&&(X=Z);he=Math.max(L-E,X-z),he=he!==0?32767/he:0}return s(k,M,_,E,z,he,0),M}function e(x,v,_,w,b){var k,M;if(b===Me(x,v,_,w)>0)for(k=v;k<_;k+=w)M=K(k,x[k],x[k+1],M);else for(k=_-w;k>=v;k-=w)M=K(k,x[k],x[k+1],M);return M&&S(M,M.next)&&(W(M),M=M.next),M}function r(x,v){if(!x)return x;v||(v=x);var _=x,w;do if(w=!1,!_.steiner&&(S(_,_.next)||q(_.prev,_,_.next)===0)){if(W(_),_=v=_.prev,_===_.next)break;w=!0}else _=_.next;while(w||_!==v);return v}function s(x,v,_,w,b,k,M){if(x){!M&&k&&f(x,w,b,k);for(var E=x,z,L;x.prev!==x.next;){if(z=x.prev,L=x.next,k?i(x,w,b,k):n(x)){v.push(z.i/_|0),v.push(x.i/_|0),v.push(L.i/_|0),W(x),x=L.next,E=L.next;continue}if(x=L,x===E){M?M===1?(x=a(r(x),v,_),s(x,v,_,w,b,k,2)):M===2&&o(x,v,_,w,b,k):s(r(x),v,_,w,b,k,1);break}}}}function n(x){var v=x.prev,_=x,w=x.next;if(q(v,_,w)>=0)return!1;for(var b=v.x,k=_.x,M=w.x,E=v.y,z=_.y,L=w.y,X=b<k?b<M?b:M:k<M?k:M,$=E<z?E<L?E:L:z<L?z:L,Z=b>k?b>M?b:M:k>M?k:M,he=E>z?E>L?E:L:z>L?z:L,ee=w.next;ee!==v;){if(ee.x>=X&&ee.x<=Z&&ee.y>=$&&ee.y<=he&&V(b,E,k,z,M,L,ee.x,ee.y)&&q(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function i(x,v,_,w){var b=x.prev,k=x,M=x.next;if(q(b,k,M)>=0)return!1;for(var E=b.x,z=k.x,L=M.x,X=b.y,$=k.y,Z=M.y,he=E<z?E<L?E:L:z<L?z:L,ee=X<$?X<Z?X:Z:$<Z?$:Z,Lt=E>z?E>L?E:L:z>L?z:L,ot=X>$?X>Z?X:Z:$>Z?$:Z,Et=g(he,ee,v,_,w),It=g(Lt,ot,v,_,w),re=x.prevZ,ce=x.nextZ;re&&re.z>=Et&&ce&&ce.z<=It;){if(re.x>=he&&re.x<=Lt&&re.y>=ee&&re.y<=ot&&re!==b&&re!==M&&V(E,X,z,$,L,Z,re.x,re.y)&&q(re.prev,re,re.next)>=0||(re=re.prevZ,ce.x>=he&&ce.x<=Lt&&ce.y>=ee&&ce.y<=ot&&ce!==b&&ce!==M&&V(E,X,z,$,L,Z,ce.x,ce.y)&&q(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;re&&re.z>=Et;){if(re.x>=he&&re.x<=Lt&&re.y>=ee&&re.y<=ot&&re!==b&&re!==M&&V(E,X,z,$,L,Z,re.x,re.y)&&q(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;ce&&ce.z<=It;){if(ce.x>=he&&ce.x<=Lt&&ce.y>=ee&&ce.y<=ot&&ce!==b&&ce!==M&&V(E,X,z,$,L,Z,ce.x,ce.y)&&q(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function a(x,v,_){var w=x;do{var b=w.prev,k=w.next.next;!S(b,k)&&P(b,w,w.next,k)&&B(b,k)&&B(k,b)&&(v.push(b.i/_|0),v.push(w.i/_|0),v.push(k.i/_|0),W(w),W(w.next),w=x=k),w=w.next}while(w!==x);return r(w)}function o(x,v,_,w,b,k){var M=x;do{for(var E=M.next.next;E!==M.prev;){if(M.i!==E.i&&y(M,E)){var z=D(M,E);M=r(M,M.next),z=r(z,z.next),s(M,v,_,w,b,k,0),s(z,v,_,w,b,k,0);return}E=E.next}M=M.next}while(M!==x)}function l(x,v,_,w){var b=[],k,M,E,z,L;for(k=0,M=v.length;k<M;k++)E=v[k]*w,z=k<M-1?v[k+1]*w:x.length,L=e(x,E,z,w,!1),L===L.next&&(L.steiner=!0),b.push(m(L));for(b.sort(c),k=0;k<b.length;k++)_=u(b[k],_);return _}function c(x,v){return x.x-v.x}function u(x,v){var _=h(x,v);if(!_)return v;var w=D(_,x);return r(w,w.next),r(_,_.next)}function h(x,v){var _=v,w=x.x,b=x.y,k=-1/0,M;do{if(b<=_.y&&b>=_.next.y&&_.next.y!==_.y){var E=_.x+(b-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(E<=w&&E>k&&(k=E,M=_.x<_.next.x?_:_.next,E===w))return M}_=_.next}while(_!==v);if(!M)return null;var z=M,L=M.x,X=M.y,$=1/0,Z;_=M;do w>=_.x&&_.x>=L&&w!==_.x&&V(b<X?w:k,b,L,X,b<X?k:w,b,_.x,_.y)&&(Z=Math.abs(b-_.y)/(w-_.x),B(_,x)&&(Z<$||Z===$&&(_.x>M.x||_.x===M.x&&A(M,_)))&&(M=_,$=Z)),_=_.next;while(_!==z);return M}function A(x,v){return q(x.prev,x,v.prev)<0&&q(v.next,x,x.next)<0}function f(x,v,_,w){var b=x;do b.z===0&&(b.z=g(b.x,b.y,v,_,w)),b.prevZ=b.prev,b.nextZ=b.next,b=b.next;while(b!==x);b.prevZ.nextZ=null,b.prevZ=null,p(b)}function p(x){var v,_,w,b,k,M,E,z,L=1;do{for(_=x,x=null,k=null,M=0;_;){for(M++,w=_,E=0,v=0;v<L&&(E++,w=w.nextZ,!!w);v++);for(z=L;E>0||z>0&&w;)E!==0&&(z===0||!w||_.z<=w.z)?(b=_,_=_.nextZ,E--):(b=w,w=w.nextZ,z--),k?k.nextZ=b:x=b,b.prevZ=k,k=b;_=w}k.nextZ=null,L*=2}while(M>1);return x}function g(x,v,_,w,b){return x=(x-_)*b|0,v=(v-w)*b|0,x=(x|x<<8)&16711935,x=(x|x<<4)&252645135,x=(x|x<<2)&858993459,x=(x|x<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,x|v<<1}function m(x){var v=x,_=x;do(v.x<_.x||v.x===_.x&&v.y<_.y)&&(_=v),v=v.next;while(v!==x);return _}function V(x,v,_,w,b,k,M,E){return(b-M)*(v-E)>=(x-M)*(k-E)&&(x-M)*(w-E)>=(_-M)*(v-E)&&(_-M)*(k-E)>=(b-M)*(w-E)}function y(x,v){return x.next.i!==v.i&&x.prev.i!==v.i&&!j(x,v)&&(B(x,v)&&B(v,x)&&R(x,v)&&(q(x.prev,x,v.prev)||q(x,v.prev,v))||S(x,v)&&q(x.prev,x,x.next)>0&&q(v.prev,v,v.next)>0)}function q(x,v,_){return(v.y-x.y)*(_.x-v.x)-(v.x-x.x)*(_.y-v.y)}function S(x,v){return x.x===v.x&&x.y===v.y}function P(x,v,_,w){var b=T(q(x,v,_)),k=T(q(x,v,w)),M=T(q(_,w,x)),E=T(q(_,w,v));return!!(b!==k&&M!==E||b===0&&C(x,_,v)||k===0&&C(x,w,v)||M===0&&C(_,x,w)||E===0&&C(_,v,w))}function C(x,v,_){return v.x<=Math.max(x.x,_.x)&&v.x>=Math.min(x.x,_.x)&&v.y<=Math.max(x.y,_.y)&&v.y>=Math.min(x.y,_.y)}function T(x){return x>0?1:x<0?-1:0}function j(x,v){var _=x;do{if(_.i!==x.i&&_.next.i!==x.i&&_.i!==v.i&&_.next.i!==v.i&&P(_,_.next,x,v))return!0;_=_.next}while(_!==x);return!1}function B(x,v){return q(x.prev,x,x.next)<0?q(x,v,x.next)>=0&&q(x,x.prev,v)>=0:q(x,v,x.prev)<0||q(x,x.next,v)<0}function R(x,v){var _=x,w=!1,b=(x.x+v.x)/2,k=(x.y+v.y)/2;do _.y>k!=_.next.y>k&&_.next.y!==_.y&&b<(_.next.x-_.x)*(k-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next;while(_!==x);return w}function D(x,v){var _=new te(x.i,x.x,x.y),w=new te(v.i,v.x,v.y),b=x.next,k=v.prev;return x.next=v,v.prev=x,_.next=b,b.prev=_,w.next=_,_.prev=w,k.next=w,w.prev=k,w}function K(x,v,_,w){var b=new te(x,v,_);return w?(b.next=w.next,b.prev=w,w.next.prev=b,w.next=b):(b.prev=b,b.next=b),b}function W(x){x.next.prev=x.prev,x.prev.next=x.next,x.prevZ&&(x.prevZ.nextZ=x.nextZ),x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function te(x,v,_){this.i=x,this.x=v,this.y=_,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(x,v,_,w){var b=v&&v.length,k=b?v[0]*_:x.length,M=Math.abs(Me(x,0,k,_));if(b)for(var E=0,z=v.length;E<z;E++){var L=v[E]*_,X=E<z-1?v[E+1]*_:x.length;M-=Math.abs(Me(x,L,X,_))}var $=0;for(E=0;E<w.length;E+=3){var Z=w[E]*_,he=w[E+1]*_,ee=w[E+2]*_;$+=Math.abs((x[Z]-x[ee])*(x[he+1]-x[Z+1])-(x[Z]-x[he])*(x[ee+1]-x[Z+1]))}return M===0&&$===0?0:Math.abs(($-M)/M)};function Me(x,v,_,w){for(var b=0,k=v,M=_-w;k<_;k+=w)b+=(x[M]-x[k])*(x[k+1]+x[M+1]),M=k;return b}return t.flatten=function(x){for(var v=x[0][0].length,_={vertices:[],holes:[],dimensions:v},w=0,b=0;b<x.length;b++){for(var k=0;k<x[b].length;k++)for(var M=0;M<v;M++)_.vertices.push(x[b][k][M]);b>0&&(w+=x[b-1].length,_.holes.push(w))}return _},ln.exports}var FV=jV();const NV=Ze(FV);class Wf extends Nt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return _e(Ge,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return _e(Ge,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return _e(Ge,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return _e(Ge,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return _e(Ge,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const hu=[{offset:0,color:"white"},{offset:1,color:"black"}],tl=class uo{constructor(...e){this.uid=Se("fillGradient"),this.type="linear",this.colorStops=[];let r=OV(e);r={...r.type==="radial"?uo.defaultRadialOptions:uo.defaultLinearOptions,...cf(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:Le.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:hu,r=this._textureSize,{canvas:s,context:n}=fu(r,1),i=n.createLinearGradient(0,0,this._textureSize,0);du(i,e),n.fillStyle=i,n.fillRect(0,0,r,1),this.texture=new ne({source:new wr({resource:s})});const{x:a,y:o}=this.start,{x:l,y:c}=this.end,u=new ie,h=l-a,A=c-o,f=Math.sqrt(h*h+A*A),p=Math.atan2(A,h);u.scale(f/r,1),u.rotate(p),u.translate(a,o),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:hu,r=this._textureSize,{canvas:s,context:n}=fu(r,r),{x:i,y:a}=this.center,{x:o,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=o-u,A=l-u,f=r/(u*2),p=(i-h)*f,g=(a-A)*f,m=n.createRadialGradient(p,g,c*f,(o-h)*f,(l-A)*f,u*f);du(m,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,r,r),n.fillStyle=m,n.translate(p,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-p,-g),n.fillRect(0,0,r,r),this.texture=new ne({source:new wr({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const V=new ie;V.scale(1/f,1/f),V.translate(h,A),this.textureSpace==="local"&&V.scale(r,r),this.transform=V}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};tl.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};tl.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let or=tl;function du(t,e){for(let r=0;r<e.length;r++){const s=e[r];t.addColorStop(s.offset,s.color)}}function fu(t,e){const r=Ee.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}function OV(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(_e("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??or.defaultLinearOptions.textureSize}),e}const Au={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ri{constructor(e,r){this.uid=Se("fillPattern"),this.transform=new ie,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=Au[r].addressModeU,e.source.style.addressModeV=Au[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var ca,pu;function LV(){if(pu)return ca;pu=1,ca=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var a=[];return i.replace(e,function(o,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(a.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),a.push(c);if(c.length<t[u])throw new Error("malformed path data");a.push([l].concat(c.splice(0,t[u])))}}),a}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var a=i.match(s);return a?a.map(Number):[]}return ca}var DV=LV();const HV=Ze(DV);function GV(t,e){const r=HV(t),s=[];let n=null,i=0,a=0;for(let o=0;o<r.length;o++){const l=r[o],c=l[0],u=l;switch(c){case"M":i=u[1],a=u[2],e.moveTo(i,a);break;case"m":i+=u[1],a+=u[2],e.moveTo(i,a);break;case"H":i=u[1],e.lineTo(i,a);break;case"h":i+=u[1],e.lineTo(i,a);break;case"V":a=u[1],e.lineTo(i,a);break;case"v":a+=u[1],e.lineTo(i,a);break;case"L":i=u[1],a=u[2],e.lineTo(i,a);break;case"l":i+=u[1],a+=u[2],e.lineTo(i,a);break;case"C":i=u[5],a=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,a);break;case"c":e.bezierCurveTo(i+u[1],a+u[2],i+u[3],a+u[4],i+u[5],a+u[6]),i+=u[5],a+=u[6];break;case"S":i=u[3],a=u[4],e.bezierCurveToShort(u[1],u[2],i,a);break;case"s":e.bezierCurveToShort(i+u[1],a+u[2],i+u[3],a+u[4]),i+=u[3],a+=u[4];break;case"Q":i=u[3],a=u[4],e.quadraticCurveTo(u[1],u[2],i,a);break;case"q":e.quadraticCurveTo(i+u[1],a+u[2],i+u[3],a+u[4]),i+=u[3],a+=u[4];break;case"T":i=u[1],a=u[2],e.quadraticCurveToShort(i,a);break;case"t":i+=u[1],a+=u[2],e.quadraticCurveToShort(i,a);break;case"A":i=u[6],a=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,a);break;case"a":i+=u[6],a+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,a);break;case"Z":case"z":e.closePath(),s.length>0&&(n=s.pop(),n?(i=n.startX,a=n.startY):(i=0,a=0)),n=null;break;default:Ve(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:a},s.push(n))}return e}class rl{constructor(e=0,r=0,s=0){this.type="circle",this.x=e,this.y=r,this.radius=s}clone(){return new rl(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-e,i=this.y-r;return n*=n,i*=i,n+i<=s}strokeContains(e,r,s,n=.5){if(this.radius===0)return!1;const i=this.x-e,a=this.y-r,o=this.radius,l=(1-n)*s,c=Math.sqrt(i*i+a*a);return c<=o+l&&c>o-(s-l)}getBounds(e){return e||(e=new ke),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class sl{constructor(e=0,r=0,s=0,n=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=s,this.halfHeight=n}clone(){return new sl(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,n=(r-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(e,r,s,n=.5){const{halfWidth:i,halfHeight:a}=this;if(i<=0||a<=0)return!1;const o=s*(1-n),l=s-o,c=i-l,u=a-l,h=i+o,A=a+o,f=e-this.x,p=r-this.y,g=f*f/(c*c)+p*p/(u*u),m=f*f/(h*h)+p*p/(A*A);return g>1&&m<=1}getBounds(e){return e||(e=new ke),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function WV(t,e,r,s,n,i){const a=t-r,o=e-s,l=n-r,c=i-s,u=a*l+o*c,h=l*l+c*c;let A=-1;h!==0&&(A=u/h);let f,p;A<0?(f=r,p=s):A>1?(f=n,p=i):(f=r+A*l,p=s+A*c);const g=t-f,m=e-p;return g*g+m*m}let UV,YV;class qs{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const s=[];for(let n=0,i=r.length;n<i;n++)s.push(r[n].x,r[n].y);r=s}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,s=r.length;for(let n=0;n<s;n+=2){const i=r[n],a=r[n+1],o=r[(n+2)%s],l=r[(n+3)%s];e+=(o-i)*(l+a)}return e<0}containsPolygon(e){const r=this.getBounds(UV),s=e.getBounds(YV);if(!r.containsRect(s))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const a=n[i],o=n[i+1];if(!this.contains(a,o))return!1}return!0}clone(){const e=this.points.slice(),r=new qs(e);return r.closePath=this.closePath,r}contains(e,r){let s=!1;const n=this.points.length/2;for(let i=0,a=n-1;i<n;a=i++){const o=this.points[i*2],l=this.points[i*2+1],c=this.points[a*2],u=this.points[a*2+1];l>r!=u>r&&e<(c-o)*((r-l)/(u-l))+o&&(s=!s)}return s}strokeContains(e,r,s,n=.5){const i=s*s,a=i*(1-n),o=i-a,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],A=l[u+1],f=l[(u+2)%l.length],p=l[(u+3)%l.length],g=WV(e,r,h,A,f,p),m=Math.sign((f-h)*(r-A)-(p-A)*(e-h));if(g<=(m<0?o:a))return!0}return!1}getBounds(e){e||(e=new ke);const r=this.points;let s=1/0,n=-1/0,i=1/0,a=-1/0;for(let o=0,l=r.length;o<l;o+=2){const c=r[o],u=r[o+1];s=c<s?c:s,n=c>n?c:n,i=u<i?u:i,a=u>a?u:a}return e.x=s,e.width=n-s,e.y=i,e.height=a-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const cn=(t,e,r,s,n,i,a)=>{const o=t-r,l=e-s,c=Math.sqrt(o*o+l*l);return c>=n-i&&c<=n+a};class nl{constructor(e=0,r=0,s=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=s,this.height=n,this.radius=i}getBounds(e){return e||(e=new ke),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new nl(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let n=e-(this.x+s),i=r-(this.y+s);const a=s*s;if(n*n+i*i<=a||(n=e-(this.x+this.width-s),n*n+i*i<=a)||(i=r-(this.y+this.height-s),n*n+i*i<=a)||(n=e-(this.x+s),n*n+i*i<=a))return!0}return!1}strokeContains(e,r,s,n=.5){const{x:i,y:a,width:o,height:l,radius:c}=this,u=s*(1-n),h=s-u,A=i+c,f=a+c,p=o-c*2,g=l-c*2,m=i+o,V=a+l;return(e>=i-u&&e<=i+h||e>=m-h&&e<=m+u)&&r>=f&&r<=f+g||(r>=a-u&&r<=a+h||r>=V-h&&r<=V+u)&&e>=A&&e<=A+p?!0:e<A&&r<f&&cn(e,r,A,f,c,h,u)||e>m-c&&r<f&&cn(e,r,m-c,f,c,h,u)||e>m-c&&r>V-c&&cn(e,r,m-c,V-c,c,h,u)||e<A&&r>V-c&&cn(e,r,A,V-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const XV=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function $V(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function KV(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=XV.replace(/%forloop%/gi,$V(t));if(e.shaderSource(r,s),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let Tr=null;function Uf(){if(Tr)return Tr;const t=Ff();return Tr=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Tr=KV(Tr,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Tr}const Yf={};function QV(t,e){let r=2166136261;for(let s=0;s<e;s++)r^=t[s].uid,r=Math.imul(r,16777619),r>>>=0;return Yf[r]||ZV(t,e,r)}let ua=0;function ZV(t,e,r){const s={};let n=0;ua||(ua=Uf());for(let a=0;a<ua;a++){const o=a<e?t[a]:ne.EMPTY.source;s[n++]=o.source,s[n++]=o.style}const i=new _n(s);return Yf[r]=i,i}class mu{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function gu(t,e){const r=t.byteLength/8|0,s=new Float64Array(t,0,r);new Float64Array(e,0,r).set(s);const i=t.byteLength-r*8;if(i>0){const a=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(a)}}const JV={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var eb=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(eb||{});function xu(t,e){return e.alphaMode==="no-premultiply-alpha"&&JV[t]||t}class tb{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class rb{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new tb,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Xf=[];let ho=0;function yu(){return ho>0?Xf[--ho]:new rb}function Vu(t){Xf[ho++]=t}let cs=0;const $f=class kn{constructor(e={}){this.uid=Se("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],kn.defaultOptions.maxTextures=kn.defaultOptions.maxTextures??Uf(),e={...kn.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:s,indicesInitialSize:n}=e;this.attributeBuffer=new mu(s*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Vu(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const s=e._batch.textures.ids[r._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let s=yu(),n=s.textures;n.clear();const i=r[this.elementStart];let a=xu(i.blendMode,i.texture._source),o=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,A=this._batchIndexStart,f="startBatch";const p=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=r[g];r[g]=null;const y=m.texture._source,q=xu(m.blendMode,y),S=a!==q||o!==m.topology;if(y._batchTick===cs&&!S){m._textureId=y._textureBindLocation,h+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,c,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,c,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=s;continue}y._batchTick=cs,(n.count>=p||S)&&(this._finishBatch(s,A,h-A,n,a,o,e,f),f="renderBatch",A=h,a=q,o=m.topology,s=yu(),n=s.textures,n.clear(),++cs),m._textureId=y._textureBindLocation=n.count,n.ids[y.uid]=n.count,n.textures[n.count++]=y,m._batch=s,h+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,c,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,c,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(s,A,h-A,n,a,o,e,f),A=h,++cs),this.elementStart=this.elementSize,this._batchIndexStart=A,this._batchIndexSize=h}_finishBatch(e,r,s,n,i,a,o,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=a,e.start=r,e.size=s,++cs,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),s=new mu(r);gu(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const r=this.indexBuffer;let s=Math.max(e,r.length*1.5);s+=s%2;const n=s>65535?new Uint32Array(s):new Uint16Array(s);if(n.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)n[i]=r[i];else gu(r.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,r,s){e[r]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+3]=s+0,e[r+4]=s+2,e[r+5]=s+3}packIndex(e,r,s,n){const i=e.indices,a=e.indexSize,o=e.indexOffset,l=e.attributeOffset;for(let c=0;c<a;c++)r[s++]=n+i[c+o]-l}destroy(){for(let e=0;e<this.batches.length;e++)Vu(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};$f.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let sb=$f;var st=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(st||{});class Ms extends Nt{constructor(e){let{data:r,size:s}=e;const{usage:n,label:i,shrinkToFit:a}=e;super(),this.uid=Se("buffer"),this._resourceType="buffer",this._resourceId=Se("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,s??(s=r?.byteLength);const o=!!r;this.descriptor={size:s,usage:n,mappedAtCreation:o,label:i},this.shrinkToFit=a??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&st.STATIC)}set static(e){e?this.descriptor.usage|=st.STATIC:this.descriptor.usage&=~st.STATIC}setDataWithSize(e,r,s){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Se("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Kf(t,e){if(!(t instanceof Ms)){let r=e?st.INDEX:st.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=st.INDEX|st.COPY_DST):(t=new Float32Array(t),r=st.VERTEX|st.COPY_DST)),t=new Ms({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function nb(t,e,r){const s=t.getAttribute(e);if(!s)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const n=s.buffer.data;let i=1/0,a=1/0,o=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(s.offset||0)/c,h=(s.stride||2*4)/c;for(let A=u;A<n.length;A+=h){const f=n[A],p=n[A+1];f>o&&(o=f),p>l&&(l=p),f<i&&(i=f),p<a&&(a=p)}return r.minX=i,r.minY=a,r.maxX=o,r.maxY=l,r}function ib(t){return(t instanceof Ms||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Kf(t.buffer,!1),t}class ab extends Nt{constructor(e={}){super(),this.uid=Se("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Pt,this._boundsDirty=!0;const{attributes:r,indexBuffer:s,topology:n}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const s=ib(r);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=Kf(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,nb(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const ob=new Float32Array(1),lb=new Uint32Array(1);class cb extends ab{constructor(){const r=new Ms({data:ob,label:"attribute-batch-buffer",usage:st.VERTEX|st.COPY_DST,shrinkToFit:!1}),s=new Ms({data:lb,label:"index-batch-buffer",usage:st.INDEX|st.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:n,offset:0},aUV:{buffer:r,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:r,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:s})}}function bu(t,e,r){if(t)for(const s in t){const n=s.toLocaleLowerCase(),i=e[n];if(i){let a=t[s];s==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(a)}else Ve(`${s} placement hook does not exist in shader`)}}const ub=/\{\{(.*?)\}\}/g;function qu(t){const e={};return(t.match(ub)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function wu(t,e){let r;const s=/@in\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function vu(t,e,r=!1){const s=[];wu(e,s),t.forEach(o=>{o.header&&wu(o.header,s)});const n=s;r&&n.sort();const i=n.map((o,l)=>`       @location(${l}) ${o},`).join(`
`);let a=e.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${i}
`),a}function _u(t,e){let r;const s=/@out\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function hb(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function db(t){const e=/@.*?\s+/g;return t.replace(e,"")}function fb(t,e){const r=[];_u(e,r),t.forEach(l=>{l.header&&_u(l.header,r)});let s=0;const n=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${db(l)};`).join(`
`),a=`return VSOutput(
            ${r.sort().map(l=>` ${hb(l)}`).join(`,
`)});`;let o=e.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${n}
`),o=o.replace("{{start}}",`
${i}
`),o=o.replace("{{return}}",`
${a}
`),o}function ku(t,e){let r=t;for(const s in e){const n=e[s];n.join(`
`).length?r=r.replace(`{{${s}}}`,`//-----${s} START-----//
${n.join(`
`)}
//----${s} FINISH----//`):r=r.replace(`{{${s}}}`,"")}return r}const ir=Object.create(null),ha=new Map;let Ab=0;function pb({template:t,bits:e}){const r=Qf(t,e);if(ir[r])return ir[r];const{vertex:s,fragment:n}=gb(t,e);return ir[r]=Zf(s,n,e),ir[r]}function mb({template:t,bits:e}){const r=Qf(t,e);return ir[r]||(ir[r]=Zf(t.vertex,t.fragment,e)),ir[r]}function gb(t,e){const r=e.map(a=>a.vertex).filter(a=>!!a),s=e.map(a=>a.fragment).filter(a=>!!a);let n=vu(r,t.vertex,!0);n=fb(r,n);const i=vu(s,t.fragment,!0);return{vertex:n,fragment:i}}function Qf(t,e){return e.map(r=>(ha.has(r)||ha.set(r,Ab++),ha.get(r))).sort((r,s)=>r-s).join("-")+t.vertex+t.fragment}function Zf(t,e,r){const s=qu(t),n=qu(e);return r.forEach(i=>{bu(i.vertex,s,i.name),bu(i.fragment,n,i.name)}),{vertex:ku(t,s),fragment:ku(e,n)}}const xb=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,yb=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Vb=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,bb=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,qb={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},wb={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function vb({bits:t,name:e}){const r=pb({template:{fragment:yb,vertex:xb},bits:[qb,...t]});return ti.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function _b({bits:t,name:e}){return new Of({name:e,...mb({template:{vertex:Vb,fragment:bb},bits:[wb,...t]})})}const kb={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Sb={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},da={};function Cb(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${r++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function Mb(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function Pb(t){return da[t]||(da[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Cb(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Mb(t)}
            `}}),da[t]}const fa={};function Tb(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function Eb(t){return fa[t]||(fa[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${Tb(t)}
            `}}),fa[t]}const Ib={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Rb={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Su={};function Bb(t){let e=Su[t];if(e)return e;const r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=s;return e=Su[t]=new Gf({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class zb extends el{constructor(e){const r=_b({name:"batch",bits:[Sb,Eb(e),Rb]}),s=vb({name:"batch",bits:[kb,Pb(e),Ib]});super({glProgram:r,gpuProgram:s,resources:{batchSamplers:Bb(e)}})}}let Cu=null;const Jf=class eA extends sb{constructor(){super(...arguments),this.geometry=new cb,this.shader=Cu||(Cu=new zb(this.maxTextures)),this.name=eA.extension.name,this.vertexSize=6}packAttributes(e,r,s,n,i){const a=i<<16|e.roundPixels&65535,o=e.transform,l=o.a,c=o.b,u=o.c,h=o.d,A=o.tx,f=o.ty,{positions:p,uvs:g}=e,m=e.color,V=e.attributeOffset,y=V+e.attributeSize;for(let q=V;q<y;q++){const S=q*2,P=p[S],C=p[S+1];r[n++]=l*P+u*C+A,r[n++]=h*C+c*P+f,r[n++]=g[S],r[n++]=g[S+1],s[n++]=m,s[n++]=a}}packQuadAttributes(e,r,s,n,i){const a=e.texture,o=e.transform,l=o.a,c=o.b,u=o.c,h=o.d,A=o.tx,f=o.ty,p=e.bounds,g=p.maxX,m=p.minX,V=p.maxY,y=p.minY,q=a.uvs,S=e.color,P=i<<16|e.roundPixels&65535;r[n+0]=l*m+u*y+A,r[n+1]=h*y+c*m+f,r[n+2]=q.x0,r[n+3]=q.y0,s[n+4]=S,s[n+5]=P,r[n+6]=l*g+u*y+A,r[n+7]=h*y+c*g+f,r[n+8]=q.x1,r[n+9]=q.y1,s[n+10]=S,s[n+11]=P,r[n+12]=l*g+u*V+A,r[n+13]=h*V+c*g+f,r[n+14]=q.x2,r[n+15]=q.y2,s[n+16]=S,s[n+17]=P,r[n+18]=l*m+u*V+A,r[n+19]=h*V+c*m+f,r[n+20]=q.x3,r[n+21]=q.y3,s[n+22]=S,s[n+23]=P}};Jf.extension={type:[U.Batcher],name:"default"};let jb=Jf;function Fb(t,e,r,s,n,i,a,o=null){let l=0;r*=e,n*=i;const c=o.a,u=o.b,h=o.c,A=o.d,f=o.tx,p=o.ty;for(;l<a;){const g=t[r],m=t[r+1];s[n]=c*g+h*m+f,s[n+1]=u*g+A*m+p,n+=i,r+=e,l++}}function Nb(t,e,r,s){let n=0;for(e*=r;n<s;)t[e]=0,t[e+1]=0,e+=r,n++}function tA(t,e,r,s,n){const i=e.a,a=e.b,o=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),s||(s=2),n||(n=t.length/s-r);let h=r*s;for(let A=0;A<n;A++){const f=t[h],p=t[h+1];t[h]=i*f+o*p+c,t[h+1]=a*f+l*p+u,h+=s}}const Ob=new ie;class rA{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?yf(r,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||Ob}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Ps={extension:{type:U.ShapeBuilder,name:"circle"},build(t,e){let r,s,n,i,a,o;if(t.type==="circle"){const S=t;r=S.x,s=S.y,a=o=S.radius,n=i=0}else if(t.type==="ellipse"){const S=t;r=S.x,s=S.y,a=S.halfWidth,o=S.halfHeight,n=i=0}else{const S=t,P=S.width/2,C=S.height/2;r=S.x+P,s=S.y+C,a=o=Math.max(0,Math.min(S.radius,Math.min(P,C))),n=P-a,i=C-o}if(!(a>=0&&o>=0&&n>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(a+o)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+n,e[1]=e[3]=s+i,e[2]=e[4]=r-n,e[5]=e[7]=s-i,e;let u=0,h=l*4+(n?2:0)+2,A=h,f=c,p=n+a,g=i,m=r+p,V=r-p,y=s+g;if(e[u++]=m,e[u++]=y,e[--h]=y,e[--h]=V,i){const S=s-g;e[A++]=V,e[A++]=S,e[--f]=S,e[--f]=m}for(let S=1;S<l;S++){const P=Math.PI/2*(S/l),C=n+Math.cos(P)*a,T=i+Math.sin(P)*o,j=r+C,B=r-C,R=s+T,D=s-T;e[u++]=j,e[u++]=R,e[--h]=R,e[--h]=B,e[A++]=B,e[A++]=D,e[--f]=D,e[--f]=j}p=n,g=i+o,m=r+p,V=r-p,y=s+g;const q=s-g;return e[u++]=m,e[u++]=y,e[--f]=q,e[--f]=m,n&&(e[u++]=V,e[u++]=y,e[--f]=q,e[--f]=V),e},triangulate(t,e,r,s,n,i){if(t.length===0)return;let a=0,o=0;for(let u=0;u<t.length;u+=2)a+=t[u],o+=t[u+1];a/=t.length/2,o/=t.length/2;let l=s;e[l*r]=a,e[l*r+1]=o;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},Lb={...Ps,extension:{...Ps.extension,name:"ellipse"}},Db={...Ps,extension:{...Ps.extension,name:"roundedRectangle"}},sA=1e-4,Mu=1e-4;function Hb(t){const e=t.length;if(e<6)return 1;let r=0;for(let s=0,n=t[e-2],i=t[e-1];s<e;s+=2){const a=t[s],o=t[s+1];r+=(a-n)*(o+i),n=a,i=o}return r<0?-1:1}function Pu(t,e,r,s,n,i,a,o){const l=t-r*n,c=e-s*n,u=t+r*i,h=e+s*i;let A,f;a?(A=s,f=-r):(A=-s,f=r);const p=l+A,g=c+f,m=u+A,V=h+f;return o.push(p,g),o.push(m,V),2}function ur(t,e,r,s,n,i,a,o){const l=r-t,c=s-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);o&&u<h?u+=Math.PI*2:!o&&u>h&&(h+=Math.PI*2);let A=u;const f=h-u,p=Math.abs(f),g=Math.sqrt(l*l+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,V=f/m;if(A+=V,o){a.push(t,e),a.push(r,s);for(let y=1,q=A;y<m;y++,q+=V)a.push(t,e),a.push(t+Math.sin(q)*g,e+Math.cos(q)*g);a.push(t,e),a.push(n,i)}else{a.push(r,s),a.push(t,e);for(let y=1,q=A;y<m;y++,q+=V)a.push(t+Math.sin(q)*g,e+Math.cos(q)*g),a.push(t,e);a.push(n,i),a.push(t,e)}return m*2}function Gb(t,e,r,s,n,i){const a=sA;if(t.length===0)return;const o=e;let l=o.alignment;if(e.alignment!==.5){let w=Hb(t);l=(l-.5)*w+.5}const c=new We(t[0],t[1]),u=new We(t[t.length-2],t[t.length-1]),h=s,A=Math.abs(c.x-u.x)<a&&Math.abs(c.y-u.y)<a;if(h){t=t.slice(),A&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const w=(c.x+u.x)*.5,b=(u.y+c.y)*.5;t.unshift(w,b),t.push(w,b)}const f=n,p=t.length/2;let g=t.length;const m=f.length/2,V=o.width/2,y=V*V,q=o.miterLimit*o.miterLimit;let S=t[0],P=t[1],C=t[2],T=t[3],j=0,B=0,R=-(P-T),D=S-C,K=0,W=0,te=Math.sqrt(R*R+D*D);R/=te,D/=te,R*=V,D*=V;const Me=l,x=(1-Me)*2,v=Me*2;h||(o.cap==="round"?g+=ur(S-R*(x-v)*.5,P-D*(x-v)*.5,S-R*x,P-D*x,S+R*v,P+D*v,f,!0)+2:o.cap==="square"&&(g+=Pu(S,P,R,D,x,v,!0,f))),f.push(S-R*x,P-D*x),f.push(S+R*v,P+D*v);for(let w=1;w<p-1;++w){S=t[(w-1)*2],P=t[(w-1)*2+1],C=t[w*2],T=t[w*2+1],j=t[(w+1)*2],B=t[(w+1)*2+1],R=-(P-T),D=S-C,te=Math.sqrt(R*R+D*D),R/=te,D/=te,R*=V,D*=V,K=-(T-B),W=C-j,te=Math.sqrt(K*K+W*W),K/=te,W/=te,K*=V,W*=V;const b=C-S,k=P-T,M=C-j,E=B-T,z=b*M+k*E,L=k*M-E*b,X=L<0;if(Math.abs(L)<.001*Math.abs(z)){f.push(C-R*x,T-D*x),f.push(C+R*v,T+D*v),z>=0&&(o.join==="round"?g+=ur(C,T,C-R*x,T-D*x,C-K*x,T-W*x,f,!1)+4:g+=2,f.push(C-K*v,T-W*v),f.push(C+K*x,T+W*x));continue}const $=(-R+S)*(-D+T)-(-R+C)*(-D+P),Z=(-K+j)*(-W+T)-(-K+C)*(-W+B),he=(b*Z-M*$)/L,ee=(E*$-k*Z)/L,Lt=(he-C)*(he-C)+(ee-T)*(ee-T),ot=C+(he-C)*x,Et=T+(ee-T)*x,It=C-(he-C)*v,re=T-(ee-T)*v,ce=Math.min(b*b+k*k,M*M+E*E),gl=X?x:v,ep=ce+gl*gl*y;Lt<=ep?o.join==="bevel"||Lt/y>q?(X?(f.push(ot,Et),f.push(C+R*v,T+D*v),f.push(ot,Et),f.push(C+K*v,T+W*v)):(f.push(C-R*x,T-D*x),f.push(It,re),f.push(C-K*x,T-W*x),f.push(It,re)),g+=2):o.join==="round"?X?(f.push(ot,Et),f.push(C+R*v,T+D*v),g+=ur(C,T,C+R*v,T+D*v,C+K*v,T+W*v,f,!0)+4,f.push(ot,Et),f.push(C+K*v,T+W*v)):(f.push(C-R*x,T-D*x),f.push(It,re),g+=ur(C,T,C-R*x,T-D*x,C-K*x,T-W*x,f,!1)+4,f.push(C-K*x,T-W*x),f.push(It,re)):(f.push(ot,Et),f.push(It,re)):(f.push(C-R*x,T-D*x),f.push(C+R*v,T+D*v),o.join==="round"?X?g+=ur(C,T,C+R*v,T+D*v,C+K*v,T+W*v,f,!0)+2:g+=ur(C,T,C-R*x,T-D*x,C-K*x,T-W*x,f,!1)+2:o.join==="miter"&&Lt/y<=q&&(X?(f.push(It,re),f.push(It,re)):(f.push(ot,Et),f.push(ot,Et)),g+=2),f.push(C-K*x,T-W*x),f.push(C+K*v,T+W*v),g+=2)}S=t[(p-2)*2],P=t[(p-2)*2+1],C=t[(p-1)*2],T=t[(p-1)*2+1],R=-(P-T),D=S-C,te=Math.sqrt(R*R+D*D),R/=te,D/=te,R*=V,D*=V,f.push(C-R*x,T-D*x),f.push(C+R*v,T+D*v),h||(o.cap==="round"?g+=ur(C-R*(x-v)*.5,T-D*(x-v)*.5,C-R*x,T-D*x,C+R*v,T+D*v,f,!1)+2:o.cap==="square"&&(g+=Pu(C,T,R,D,x,v,!1,f)));const _=Mu*Mu;for(let w=m;w<g+m-2;++w)S=f[w*2],P=f[w*2+1],C=f[(w+1)*2],T=f[(w+1)*2+1],j=f[(w+2)*2],B=f[(w+2)*2+1],!(Math.abs(S*(T-B)+C*(B-P)+j*(P-T))<_)&&i.push(w,w+1,w+2)}function Wb(t,e,r,s){const n=sA;if(t.length===0)return;const i=t[0],a=t[1],o=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-o)<n&&Math.abs(a-l)<n,u=r,h=t.length/2,A=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)s.push(A+f,A+f+1);c&&s.push(A+h-1,A)}function nA(t,e,r,s,n,i,a){const o=NV(t,e,2);if(!o)return;for(let c=0;c<o.length;c+=3)i[a++]=o[c]+n,i[a++]=o[c+1]+n,i[a++]=o[c+2]+n;let l=n*s;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=s}const Ub=[],Yb={extension:{type:U.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,s,n,i){nA(t,Ub,e,r,s,n,i)}},Xb={extension:{type:U.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,s=r.x,n=r.y,i=r.width,a=r.height;return i>=0&&a>=0&&(e[0]=s,e[1]=n,e[2]=s+i,e[3]=n,e[4]=s+i,e[5]=n+a,e[6]=s,e[7]=n+a),e},triangulate(t,e,r,s,n,i){let a=0;s*=r,e[s+a]=t[0],e[s+a+1]=t[1],a+=r,e[s+a]=t[2],e[s+a+1]=t[3],a+=r,e[s+a]=t[6],e[s+a+1]=t[7],a+=r,e[s+a]=t[4],e[s+a+1]=t[5],a+=r;const o=s/r;n[i++]=o,n[i++]=o+1,n[i++]=o+2,n[i++]=o+1,n[i++]=o+3,n[i++]=o+2}},$b={extension:{type:U.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,s,n,i){let a=0;s*=r,e[s+a]=t[0],e[s+a+1]=t[1],a+=r,e[s+a]=t[2],e[s+a+1]=t[3],a+=r,e[s+a]=t[4],e[s+a+1]=t[5];const o=s/r;n[i++]=o,n[i++]=o+1,n[i++]=o+2}},Kb=new ie,Qb=new ke;function Zb(t,e,r,s){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(Qb);n.translate(-i.x,-i.y),n.scale(1/i.width,1/i.height)}else{n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return s&&n.append(Kb.copyFrom(s).invert()),n}const si={};it.handleByMap(U.ShapeBuilder,si);it.add(Xb,Yb,$b,Ps,Lb,Db);const Jb=new ke,eq=new ie;function tq(t,e){const{geometryData:r,batches:s}=e;s.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")rq(i.data,s,r);else if(i.action==="fill"||i.action==="stroke"){const a=i.action==="stroke",o=i.data.path.shapePath,l=i.data.style,c=i.data.hole;a&&c&&Tu(c.shapePath,l,!0,s,r),c&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Tu(o,l,a,s,r)}}}function rq(t,e,r){const{vertices:s,uvs:n,indices:i}=r,a=i.length,o=s.length/2,l=[],c=si.rectangle,u=Jb,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const A=t.transform;c.build(u,l),A&&tA(l,A),c.triangulate(l,s,2,o,i,a);const f=h.uvs;n.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=Kt.get(rA);p.indexOffset=a,p.indexSize=i.length-a,p.attributeOffset=o,p.attributeSize=s.length/2-o,p.baseColor=t.style,p.alpha=t.alpha,p.texture=h,p.geometryData=r,e.push(p)}function Tu(t,e,r,s,n){const{vertices:i,uvs:a,indices:o}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=o.length,A=i.length/2,f=[],p=si[l.type];let g="triangle-list";if(p.build(l,f),c&&tA(f,c),r){const q=l.closePath??!0,S=e;S.pixelLine?(Wb(f,q,i,o),g="line-list"):Gb(f,S,!1,q,i,o)}else if(u){const q=[],S=f.slice();sq(u).forEach(C=>{q.push(S.length/2),S.push(...C)}),nA(S,q,i,2,A,o,h)}else p.triangulate(f,i,2,A,o,h);const m=a.length/2,V=e.texture;if(V!==ne.WHITE){const q=Zb(eq,e,l,c);Fb(i,2,A,a,m,2,i.length/2-A,q)}else Nb(a,m,2,i.length/2-A);const y=Kt.get(rA);y.indexOffset=h,y.indexSize=o.length-h,y.attributeOffset=A,y.attributeSize=i.length/2-A,y.baseColor=e.color,y.alpha=e.alpha,y.texture=V,y.geometryData=n,y.topology=g,s.push(y)})}function sq(t){const e=[];for(let r=0;r<t.length;r++){const s=t[r].shape,n=[];si[s.type].build(s,n),e.push(n)}return e}class nq{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class iq{constructor(){this.batcher=new jb,this.instructions=new wf}init(){this.instructions.reset()}get geometry(){return _e(vy,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const il=class fo{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){fo.defaultOptions.bezierSmoothness=e?.bezierSmoothness??fo.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),tq(e,r);const s=e.batchMode;e.customShader||s==="no-batch"?r.isBatchable=!1:s==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=Kt.get(iq),{batches:s,geometryData:n}=this._gpuContextHash[e.uid],i=n.vertices.length,a=n.indices.length;for(let u=0;u<s.length;u++)s[u].applyTransform=!1;const o=r.batcher;o.ensureAttributeBuffer(i),o.ensureIndexBuffer(a),o.begin();for(let u=0;u<s.length;u++){const h=s[u];o.add(h)}o.finish(r.instructions);const l=o.geometry;l.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),l.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const c=o.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=QV(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new nq;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(Kt.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(s=>{Kt.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};il.extension={type:[U.WebGLSystem,U.WebGPUSystem,U.CanvasSystem],name:"graphicsContext"};il.defaultOptions={bezierSmoothness:.5};let iA=il;const aq=8,un=11920929e-14,oq=1;function aA(t,e,r,s,n,i,a,o,l,c){const h=Math.min(.99,Math.max(0,c??iA.defaultOptions.bezierSmoothness));let A=(oq-h)/1;return A*=A,lq(e,r,s,n,i,a,o,l,t,A),t}function lq(t,e,r,s,n,i,a,o,l,c){Ao(t,e,r,s,n,i,a,o,l,c,0),l.push(a,o)}function Ao(t,e,r,s,n,i,a,o,l,c,u){if(u>aq)return;const h=(t+r)/2,A=(e+s)/2,f=(r+n)/2,p=(s+i)/2,g=(n+a)/2,m=(i+o)/2,V=(h+f)/2,y=(A+p)/2,q=(f+g)/2,S=(p+m)/2,P=(V+q)/2,C=(y+S)/2;if(u>0){let T=a-t,j=o-e;const B=Math.abs((r-a)*j-(s-o)*T),R=Math.abs((n-a)*j-(i-o)*T);if(B>un&&R>un){if((B+R)*(B+R)<=c*(T*T+j*j)){l.push(P,C);return}}else if(B>un){if(B*B<=c*(T*T+j*j)){l.push(P,C);return}}else if(R>un){if(R*R<=c*(T*T+j*j)){l.push(P,C);return}}else if(T=P-(t+a)/2,j=C-(e+o)/2,T*T+j*j<=c){l.push(P,C);return}}Ao(t,e,h,A,V,y,P,C,l,c,u+1),Ao(P,C,q,S,g,m,a,o,l,c,u+1)}const cq=8,uq=11920929e-14,hq=1;function dq(t,e,r,s,n,i,a,o){const c=Math.min(.99,Math.max(0,o??iA.defaultOptions.bezierSmoothness));let u=(hq-c)/1;return u*=u,fq(e,r,s,n,i,a,t,u),t}function fq(t,e,r,s,n,i,a,o){po(a,t,e,r,s,n,i,o,0),a.push(n,i)}function po(t,e,r,s,n,i,a,o,l){if(l>cq)return;const c=(e+s)/2,u=(r+n)/2,h=(s+i)/2,A=(n+a)/2,f=(c+h)/2,p=(u+A)/2;let g=i-e,m=a-r;const V=Math.abs((s-i)*m-(n-a)*g);if(V>uq){if(V*V<=o*(g*g+m*m)){t.push(f,p);return}}else if(g=f-(e+i)/2,m=p-(r+a)/2,g*g+m*m<=o){t.push(f,p);return}po(t,e,r,c,u,f,p,o,l+1),po(t,f,p,h,A,i,a,o,l+1)}function oA(t,e,r,s,n,i,a,o){let l=Math.abs(n-i);(!a&&n>i||a&&i>n)&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),o=Math.max(o,3);let c=l/o,u=n;c*=a?-1:1;for(let h=0;h<o+1;h++){const A=Math.cos(u),f=Math.sin(u),p=e+A*s,g=r+f*s;t.push(p,g),u+=c}}function Aq(t,e,r,s,n,i){const a=t[t.length-2],l=t[t.length-1]-r,c=a-e,u=n-r,h=s-e,A=Math.abs(l*h-c*u);if(A<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const f=l*l+c*c,p=u*u+h*h,g=l*u+c*h,m=i*Math.sqrt(f)/A,V=i*Math.sqrt(p)/A,y=m*g/f,q=V*g/p,S=m*h+V*c,P=m*u+V*l,C=c*(V+y),T=l*(V+y),j=h*(m+q),B=u*(m+q),R=Math.atan2(T-P,C-S),D=Math.atan2(B-P,j-S);oA(t,S+e,P+r,i,R,D,c*u>h*l)}const ws=Math.PI*2,Aa={centerX:0,centerY:0,ang1:0,ang2:0},pa=({x:t,y:e},r,s,n,i,a,o,l)=>{t*=r,e*=s;const c=n*t-i*e,u=i*t+n*e;return l.x=c+a,l.y=u+o,l};function pq(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:r,n=Math.cos(t),i=Math.sin(t),a=Math.cos(t+e),o=Math.sin(t+e);return[{x:n-i*s,y:i+n*s},{x:a+o*s,y:o-a*s},{x:a,y:o}]}const Eu=(t,e,r,s)=>{const n=t*s-e*r<0?-1:1;let i=t*r+e*s;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},mq=(t,e,r,s,n,i,a,o,l,c,u,h,A)=>{const f=Math.pow(n,2),p=Math.pow(i,2),g=Math.pow(u,2),m=Math.pow(h,2);let V=f*p-f*m-p*g;V<0&&(V=0),V/=f*m+p*g,V=Math.sqrt(V)*(a===o?-1:1);const y=V*n/i*h,q=V*-i/n*u,S=c*y-l*q+(t+r)/2,P=l*y+c*q+(e+s)/2,C=(u-y)/n,T=(h-q)/i,j=(-u-y)/n,B=(-h-q)/i,R=Eu(1,0,C,T);let D=Eu(C,T,j,B);o===0&&D>0&&(D-=ws),o===1&&D<0&&(D+=ws),A.centerX=S,A.centerY=P,A.ang1=R,A.ang2=D};function gq(t,e,r,s,n,i,a,o=0,l=0,c=0){if(i===0||a===0)return;const u=Math.sin(o*ws/360),h=Math.cos(o*ws/360),A=h*(e-s)/2+u*(r-n)/2,f=-u*(e-s)/2+h*(r-n)/2;if(A===0&&f===0)return;i=Math.abs(i),a=Math.abs(a);const p=Math.pow(A,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(a,2);p>1&&(i*=Math.sqrt(p),a*=Math.sqrt(p)),mq(e,r,s,n,i,a,l,c,u,h,A,f,Aa);let{ang1:g,ang2:m}=Aa;const{centerX:V,centerY:y}=Aa;let q=Math.abs(m)/(ws/4);Math.abs(1-q)<1e-7&&(q=1);const S=Math.max(Math.ceil(q),1);m/=S;let P=t[t.length-2],C=t[t.length-1];const T={x:0,y:0};for(let j=0;j<S;j++){const B=pq(g,m),{x:R,y:D}=pa(B[0],i,a,h,u,V,y,T),{x:K,y:W}=pa(B[1],i,a,h,u,V,y,T),{x:te,y:Me}=pa(B[2],i,a,h,u,V,y,T);aA(t,P,C,R,D,K,W,te,Me),P=te,C=Me,g+=m}}function xq(t,e,r){const s=(a,o)=>{const l=o.x-a.x,c=o.y-a.y,u=Math.sqrt(l*l+c*c),h=l/u,A=c/u;return{len:u,nx:h,ny:A}},n=(a,o)=>{a===0?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)};let i=e[e.length-1];for(let a=0;a<e.length;a++){const o=e[a%e.length],l=o.radius??r;if(l<=0){n(a,o),i=o;continue}const c=e[(a+1)%e.length],u=s(o,i),h=s(o,c);if(u.len<1e-4||h.len<1e-4){n(a,o),i=o;continue}let A=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,p=!1;u.nx*h.nx-u.ny*-h.ny<0?A<0?A=Math.PI+A:(A=Math.PI-A,f=-1,p=!0):A>0&&(f=-1,p=!0);const g=A/2;let m,V=Math.abs(Math.cos(g)*l/Math.sin(g));V>Math.min(u.len/2,h.len/2)?(V=Math.min(u.len/2,h.len/2),m=Math.abs(V*Math.sin(g)/Math.cos(g))):m=l;const y=o.x+h.nx*V+-h.ny*m*f,q=o.y+h.ny*V+h.nx*m*f,S=Math.atan2(u.ny,u.nx)+Math.PI/2*f,P=Math.atan2(h.ny,h.nx)-Math.PI/2*f;a===0&&t.moveTo(y+Math.cos(S)*m,q+Math.sin(S)*m),t.arc(y,q,m,S,P,p),i=o}}function yq(t,e,r,s){const n=(o,l)=>Math.sqrt((o.x-l.x)**2+(o.y-l.y)**2),i=(o,l,c)=>({x:o.x+(l.x-o.x)*c,y:o.y+(l.y-o.y)*c}),a=e.length;for(let o=0;o<a;o++){const l=e[(o+1)%a],c=l.radius??r;if(c<=0){o===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[o],h=e[(o+2)%a],A=n(u,l);let f;if(A<1e-4)f=l;else{const m=Math.min(A/2,c);f=i(l,u,m/A)}const p=n(h,l);let g;if(p<1e-4)g=l;else{const m=Math.min(p/2,c);g=i(l,h,m/p)}o===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,g.x,g.y,s)}}const Vq=new ke;class bq{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Pt,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],i=s[s.length-1];return(n!==e||i!==r)&&s.push(e,r),this}arc(e,r,s,n,i,a){this._ensurePoly(!1);const o=this._currentPoly.points;return oA(o,e,r,s,n,i,a),this}arcTo(e,r,s,n,i){this._ensurePoly();const a=this._currentPoly.points;return Aq(a,e,r,s,n,i),this}arcToSvg(e,r,s,n,i,a,o){const l=this._currentPoly.points;return gq(l,this._currentPoly.lastX,this._currentPoly.lastY,a,o,e,r,s,n,i),this}bezierCurveTo(e,r,s,n,i,a,o){this._ensurePoly();const l=this._currentPoly;return aA(this._currentPoly.points,l.lastX,l.lastY,e,r,s,n,i,a,o),this}quadraticCurveTo(e,r,s,n,i){this._ensurePoly();const a=this._currentPoly;return dq(this._currentPoly.points,a.lastX,a.lastY,e,r,s,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const s=this.shapePrimitives,n=s.length;for(let i=0;i<e.instructions.length;i++){const a=e.instructions[i];this[a.action](...a.data)}if(e.checkForHoles&&s.length-n>1){let i=null;for(let a=n;a<s.length;a++){const o=s[a];if(o.shape.type==="polygon"){const l=o.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(o),s.copyWithin(a,a+1),s.length--,a--):i=o}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,s,n,i){return this.drawShape(new ke(e,r,s,n),i),this}circle(e,r,s,n){return this.drawShape(new rl(e,r,s),n),this}poly(e,r,s){const n=new qs(e);return n.closePath=r,this.drawShape(n,s),this}regularPoly(e,r,s,n,i=0,a){n=Math.max(n|0,3);const o=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=o-u*l;c.push(e+s*Math.cos(h),r+s*Math.sin(h))}return this.poly(c,!0,a),this}roundPoly(e,r,s,n,i,a=0,o){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,r,s,n,a);const l=s*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+a,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let A=0;A<n;A++){const f=A*u+c,p=e+s*Math.cos(f),g=r+s*Math.sin(f),m=f+Math.PI+h,V=f-Math.PI-h,y=p+i*Math.cos(m),q=g+i*Math.sin(m),S=p+i*Math.cos(V),P=g+i*Math.sin(V);A===0?this.moveTo(y,q):this.lineTo(y,q),this.quadraticCurveTo(p,g,S,P,o)}return this.closePath()}roundShape(e,r,s=!1,n){return e.length<3?this:(s?yq(this,e,r,n):xq(this,e,r),this.closePath())}filletRect(e,r,s,n,i){if(i===0)return this.rect(e,r,s,n);const a=Math.min(s,n)/2,o=Math.min(a,Math.max(-a,i)),l=e+s,c=r+n,u=o<0?-o:0,h=Math.abs(o);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+s-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,s,n,i,a){if(i<=0)return this.rect(e,r,s,n);const o=Math.min(i,Math.min(s,n)/2),l=e+s,c=r+n,u=[e+o,r,l-o,r,l,r+o,l,c-o,l-o,c,e+o,c,e,c-o,e,r+o];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,a)}ellipse(e,r,s,n,i){return this.drawShape(new sl(e,r,s,n),i),this}roundRect(e,r,s,n,i,a){return this.drawShape(new nl(e,r,s,n,i),a),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let s=this._currentPoly;return s&&this.endPoly(),s=new qs,s.points.push(e,r),this._currentPoly=s,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new qs,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let s=r.shape.x,n=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,a=s;s=i.a*s+i.c*n+i.tx,n=i.b*a+i.d*n+i.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const s=e.instructions[r];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let s=0;s<r.length;s++){const n=r[s],i=n.shape.getBounds(Vq);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class Yr{constructor(e,r=!1){this.instructions=[],this.uid=Se("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?GV(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new bq(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,s,n,i){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(We.shared);let l=0,c=0;if(!a||a.action!=="bezierCurveTo")l=o.x,c=o.y;else{l=a.data[2],c=a.data[3];const u=o.x,h=o.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,s,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,s){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(We.shared);let a=0,o=0;if(!n||n.action!=="quadraticCurveTo")a=i.x,o=i.y;else{a=n.data[0],o=n.data[1];const l=i.x,c=i.y;a=l+(l-a),o=c+(c-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,e,r,s]}),this._dirty=!0,this}rect(e,r,s,n,i){return this.instructions.push({action:"rect",data:[e,r,s,n,i]}),this._dirty=!0,this}circle(e,r,s,n){return this.instructions.push({action:"circle",data:[e,r,s,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,s,n,i,a,o){i||(i=n/2);const l=-1*Math.PI/2+a,c=s*2,u=Math.PI*2/c,h=[];for(let A=0;A<c;A++){const f=A%2?i:n,p=A*u+l;h.push(e+f*Math.cos(p),r+f*Math.sin(p))}return this.poly(h,!0,o),this}clone(e=!1){const r=new Yr;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];r.instructions.push({action:n.action,data:n.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,s=e.b,n=e.c,i=e.d,a=e.tx,o=e.ty;let l=0,c=0,u=0,h=0,A=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const V=this.instructions[m],y=V.data;switch(V.action){case"moveTo":case"lineTo":l=y[0],c=y[1],y[0]=r*l+n*c+a,y[1]=s*l+i*c+o;break;case"bezierCurveTo":u=y[0],h=y[1],A=y[2],f=y[3],l=y[4],c=y[5],y[0]=r*u+n*h+a,y[1]=s*u+i*h+o,y[2]=r*A+n*f+a,y[3]=s*A+i*f+o,y[4]=r*l+n*c+a,y[5]=s*l+i*c+o;break;case"quadraticCurveTo":u=y[0],h=y[1],l=y[2],c=y[3],y[0]=r*u+n*h+a,y[1]=s*u+i*h+o,y[2]=r*l+n*c+a,y[3]=s*l+i*c+o;break;case"arcToSvg":l=y[5],c=y[6],p=y[0],g=y[1],y[0]=r*p+n*g,y[1]=s*p+i*g,y[5]=r*l+n*c+a,y[6]=s*l+i*c+o;break;case"circle":y[4]=us(y[3],e);break;case"rect":y[4]=us(y[4],e);break;case"ellipse":y[8]=us(y[8],e);break;case"roundRect":y[5]=us(y[5],e);break;case"addPath":y[0].transform(e);break;case"poly":y[2]=us(y[2],e);break;default:Ve("unknown transform action",V.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,s=this.instructions[r];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;s=this.instructions[r]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function us(t,e){return t?t.prepend(e):e.clone()}function qe(t,e,r){const s=t.getAttribute(e);return s?Number(s):r}function qq(t,e){const r=t.querySelectorAll("defs");for(let s=0;s<r.length;s++){const n=r[s];for(let i=0;i<n.children.length;i++){const a=n.children[i];switch(a.nodeName.toLowerCase()){case"lineargradient":e.defs[a.id]=wq(a);break;case"radialgradient":e.defs[a.id]=vq();break}}}}function wq(t){const e=qe(t,"x1",0),r=qe(t,"y1",0),s=qe(t,"x2",1),n=qe(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",a=new or(e,r,s,n,i==="objectBoundingBox"?"local":"global");for(let o=0;o<t.children.length;o++){const l=t.children[o],c=qe(l,"offset",0),u=Le.shared.setValue(l.getAttribute("stop-color")).toNumber();a.addColorStop(c,u)}return a}function vq(t){return Ve("[SVG Parser] Radial gradients are not yet supported"),new or(0,0,1,0)}function Iu(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Ru={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function lA(t,e){const r=t.getAttribute("style"),s={},n={},i={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const a in Ru){const o=t.getAttribute(a);o&&Bu(e,i,a,o.trim())}if(r){const a=r.split(";");for(let o=0;o<a.length;o++){const l=a[o].trim(),[c,u]=l.split(":");Ru[c]&&Bu(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?s:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function Bu(t,e,r,s){switch(r){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=Iu(s);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=Le.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=Iu(s);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=Le.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function _q(t,e){if(typeof t=="string"){const a=document.createElement("div");a.innerHTML=t.trim(),t=a.querySelector("svg")}const r={context:e,defs:{},path:new Yr};qq(t,r);const s=t.children,{fillStyle:n,strokeStyle:i}=lA(t,r);for(let a=0;a<s.length;a++){const o=s[a];o.nodeName.toLowerCase()!=="defs"&&cA(o,r,n,i)}return e}function cA(t,e,r,s){const n=t.children,{fillStyle:i,strokeStyle:a}=lA(t,e);i&&r?r={...r,...i}:i&&(r=i),a&&s?s={...s,...a}:a&&(s=a);const o=!r&&!s;o&&(r={color:0});let l,c,u,h,A,f,p,g,m,V,y,q,S,P,C,T,j;switch(t.nodeName.toLowerCase()){case"path":P=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&Ve("SVG Evenodd fill rule not supported, your svg may render incorrectly"),C=new Yr(P,!0),e.context.path(C),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"circle":p=qe(t,"cx",0),g=qe(t,"cy",0),m=qe(t,"r",0),e.context.ellipse(p,g,m,m),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"rect":l=qe(t,"x",0),c=qe(t,"y",0),T=qe(t,"width",0),j=qe(t,"height",0),V=qe(t,"rx",0),y=qe(t,"ry",0),V||y?e.context.roundRect(l,c,T,j,V||y):e.context.rect(l,c,T,j),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"ellipse":p=qe(t,"cx",0),g=qe(t,"cy",0),V=qe(t,"rx",0),y=qe(t,"ry",0),e.context.beginPath(),e.context.ellipse(p,g,V,y),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"line":u=qe(t,"x1",0),h=qe(t,"y1",0),A=qe(t,"x2",0),f=qe(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(A,f),s&&e.context.stroke(s);break;case"polygon":S=t.getAttribute("points"),q=S.match(/\d+/g).map(B=>parseInt(B,10)),e.context.poly(q,!0),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"polyline":S=t.getAttribute("points"),q=S.match(/\d+/g).map(B=>parseInt(B,10)),e.context.poly(q,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{Ve(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}o&&(r=null);for(let B=0;B<n.length;B++)cA(n[B],e,r,s)}function kq(t){return Le.isColorLike(t)}function zu(t){return t instanceof ri}function ju(t){return t instanceof or}function Sq(t){return t instanceof ne}function Cq(t,e,r){const s=Le.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?r.alpha:s.alpha,t.texture=ne.WHITE,{...r,...t}}function Mq(t,e,r){return t.texture=e,{...r,...t}}function Fu(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function Nu(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function Pq(t,e){const r={...e,...t},s=Le.shared.setValue(r.color);return r.alpha*=s.alpha,r.color=s.toNumber(),r}function yr(t,e){if(t==null)return null;const r={},s=t;return kq(t)?Cq(r,t,e):Sq(t)?Mq(r,t,e):zu(t)?Fu(r,t,e):ju(t)?Nu(r,t,e):s.fill&&zu(s.fill)?Fu(s,s.fill,e):s.fill&&ju(s.fill)?Nu(s,s.fill,e):Pq(s,e)}function Dn(t,e){const{width:r,alignment:s,miterLimit:n,cap:i,join:a,pixelLine:o,...l}=e,c=yr(t,l);return c?{width:r,alignment:s,miterLimit:n,cap:i,join:a,pixelLine:o,...c}:null}const Tq=new We,Ou=new ie,al=class jt extends Nt{constructor(){super(...arguments),this.uid=Se("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Yr,this._transform=new ie,this._fillStyle={...jt.defaultFillStyle},this._strokeStyle={...jt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Pt,this._boundsDirty=!0}clone(){const e=new jt;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=yr(e,jt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Dn(e,jt.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=yr(e,jt.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=yr(e,jt.defaultStrokeStyle),this}texture(e,r,s,n,i,a){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:n||0,dw:i||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?Le.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Yr,this}fill(e,r){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(e!=null&&(r!==void 0&&typeof e=="number"&&(_e(Ge,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=yr(e,jt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(We.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?r=s.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=Dn(e,jt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(s);else{r.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,r,s,n,i,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,s,n,i,a),this}arcTo(e,r,s,n,i){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,a.a*s+a.c*n+a.tx,a.b*s+a.d*n+a.ty,i),this}arcToSvg(e,r,s,n,i,a,o){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,s,n,i,l.a*a+l.c*o+l.tx,l.b*a+l.d*o+l.ty),this}bezierCurveTo(e,r,s,n,i,a,o){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*s+l.c*n+l.tx,l.b*s+l.d*n+l.ty,l.a*i+l.c*a+l.tx,l.b*i+l.d*a+l.ty,o),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,s,n){return this._tick++,this._activePath.ellipse(e,r,s,n,this._transform.clone()),this}circle(e,r,s){return this._tick++,this._activePath.circle(e,r,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*r+s.tx,s.b*e+s.d*r+s.ty),this}moveTo(e,r){this._tick++;const s=this._transform,n=this._activePath.instructions,i=s.a*e+s.c*r+s.tx,a=s.b*e+s.d*r+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=a,this):(this._activePath.moveTo(i,a),this)}quadraticCurveTo(e,r,s,n,i){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,a.a*s+a.c*n+a.tx,a.b*s+a.d*n+a.ty,i),this}rect(e,r,s,n){return this._tick++,this._activePath.rect(e,r,s,n,this._transform.clone()),this}roundRect(e,r,s,n,i){return this._tick++,this._activePath.roundRect(e,r,s,n,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,s,n,i=0,a){return this._tick++,this._activePath.regularPoly(e,r,s,n,i,a),this}roundPoly(e,r,s,n,i,a){return this._tick++,this._activePath.roundPoly(e,r,s,n,i,a),this}roundShape(e,r,s,n){return this._tick++,this._activePath.roundShape(e,r,s,n),this}filletRect(e,r,s,n,i){return this._tick++,this._activePath.filletRect(e,r,s,n,i),this}chamferRect(e,r,s,n,i,a){return this._tick++,this._activePath.chamferRect(e,r,s,n,i,a),this}star(e,r,s,n,i=0,a=0){return this._tick++,this._activePath.star(e,r,s,n,i,a,this._transform.clone()),this}svg(e){return this._tick++,_q(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,s,n,i,a){return e instanceof ie?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,s,n,i,a),this)}transform(e,r,s,n,i,a){return e instanceof ie?(this._transform.append(e),this):(Ou.set(e,r,s,n,i,a),this._transform.append(Ou),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r],n=s.action;if(n==="fill"){const i=s.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=s.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=s.data,a=i.style.alignment,o=i.style.width*(1-a),l=i.path.bounds;e.addFrame(l.minX-o,l.minY-o,l.maxX+o,l.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let s=!1;for(let n=0;n<r.length;n++){const i=r[n],a=i.data,o=a.path;if(!i.action||!o)continue;const l=a.style,c=o.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const A=c[u].transform,f=A?A.applyInverse(e,Tq):e;if(i.action==="fill")s=h.contains(f.x,f.y);else{const g=l;s=h.strokeContains(f.x,f.y,g.width,g.alignment)}const p=a.hole;if(p){const g=p.shapePath?.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(f.x,f.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};al.defaultFillStyle={color:16777215,alpha:1,texture:ne.WHITE,matrix:null,fill:null,textureSpace:"local"};al.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:ne.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let mr=al;const Lu=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Eq(t){const e=[];let r=0;for(let s=0;s<Lu.length;s++){const n=`_${Lu[s]}`;e[r++]=t[n]}return r=uA(t._fill,e,r),r=Iq(t._stroke,e,r),r=Rq(t.dropShadow,e,r),e.join("-")}function uA(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function Iq(t,e,r){return t&&(r=uA(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function Rq(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=Le.shared.setValue(t.color).toNumber()),r}const ol=class zr extends Nt{constructor(e={}){super(),Bq(e);const r={...zr.defaultTextStyle,...e};for(const s in r){const n=s;this[n]=r[s]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...zr.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...zr.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...mr.defaultFillStyle,...e},()=>{this._fill=yr({...this._originalFill},mr.defaultFillStyle)})),this._fill=yr(e===0?"black":e,mr.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...mr.defaultStrokeStyle,...e},()=>{this._stroke=Dn({...this._originalStroke},mr.defaultStrokeStyle)})),this._stroke=Dn(e,mr.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Eq(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=zr.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new zr({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(s,n,i)=>(s[n]=i,r?.(n,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(Le.isColorLike(e)||e instanceof or||e instanceof ri)}};ol.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};ol.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ts=ol;function Bq(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=Ts.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){_e(Ge,"strokeThickness is now a part of stroke");const r=e.stroke;let s={};if(Le.isColorLike(r))s.color=r;else if(r instanceof or||r instanceof ri)s.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))s=r;else throw new Error("Invalid stroke value.");t.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){_e(Ge,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=Ts.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const s=new or({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),n=e.fillGradientStops.map(i=>Le.shared.setValue(i).toNumber());n.forEach((i,a)=>{const o=a/(n.length-1);s.addColorStop(o,i)}),t.fill={fill:s}}}class zq{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const s=Ee.get().createCanvas();s.width=e,s.height=r;const n=s.getContext("2d");return{canvas:s,context:n}}getOptimalCanvasAndContext(e,r,s=1){e=Math.ceil(e*s-1e-6),r=Math.ceil(r*s-1e-6),e=Nn(e),r=Nn(r);const n=(e<<17)+(r<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:s,height:n}=r,i=(s<<17)+(n<<1);e.context.clearRect(0,0,s,n),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const Du=new zq,jq=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function mo(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let s=r.length-1;s>=0;s--){let n=r[s].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!jq.includes(n)&&(n=`"${n}"`),r[s]=n}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const ma={willReadFrequently:!0},Tt=class G{static get experimentalLetterSpacingSupported(){let e=G._experimentalLetterSpacingSupported;if(e!==void 0){const r=Ee.get().getCanvasRenderingContext2D().prototype;e=G._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,s,n,i,a,o,l,c){this.text=e,this.style=r,this.width=s,this.height=n,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,s=G._canvas,n=r.wordWrap){const i=`${e}:${r.styleKey}`;if(G._measurementCache[i])return G._measurementCache[i];const a=mo(r),o=G.measureFont(a);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const l=G.__context;l.font=a;const u=(n?G._wordWrap(e,r,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let A=0;for(let y=0;y<u.length;y++){const q=G._measureText(u[y],r.letterSpacing,l);h[y]=q,A=Math.max(A,q)}const f=r._stroke?.width||0;let p=A+f;r.dropShadow&&(p+=r.dropShadow.distance);const g=r.lineHeight||o.fontSize;let m=Math.max(g,o.fontSize+f)+(u.length-1)*(g+r.leading);return r.dropShadow&&(m+=r.dropShadow.distance),new G(e,r,p,m,u,h,g+r.leading,A,o)}static _measureText(e,r,s){let n=!1;G.experimentalLetterSpacingSupported&&(G.experimentalLetterSpacing?(s.letterSpacing=`${r}px`,s.textLetterSpacing=`${r}px`,n=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const i=s.measureText(e);let a=i.width;const o=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-o;if(a>0)if(n)a-=r,c-=r;else{const u=(G.graphemeSegmenter(e).length-1)*r;a+=u,c+=u}return Math.max(a,c)}static _wordWrap(e,r,s=G._canvas){const n=s.getContext("2d",ma);let i=0,a="",o="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=G._collapseSpaces(u),A=G._collapseNewlines(u);let f=!h;const p=r.wordWrapWidth+c,g=G._tokenize(e);for(let m=0;m<g.length;m++){let V=g[m];if(G._isNewline(V)){if(!A){o+=G._addLine(a),f=!h,a="",i=0;continue}V=" "}if(h){const q=G.isBreakingSpace(V),S=G.isBreakingSpace(a[a.length-1]);if(q&&S)continue}const y=G._getFromCache(V,c,l,n);if(y>p)if(a!==""&&(o+=G._addLine(a),a="",i=0),G.canBreakWords(V,r.breakWords)){const q=G.wordWrapSplit(V);for(let S=0;S<q.length;S++){let P=q[S],C=P,T=1;for(;q[S+T];){const B=q[S+T];if(!G.canBreakChars(C,B,V,S,r.breakWords))P+=B;else break;C=B,T++}S+=T-1;const j=G._getFromCache(P,c,l,n);j+i>p&&(o+=G._addLine(a),f=!1,a="",i=0),a+=P,i+=j}}else{a.length>0&&(o+=G._addLine(a),a="",i=0);const q=m===g.length-1;o+=G._addLine(V,!q),f=!1,a="",i=0}else y+i>p&&(f=!1,o+=G._addLine(a),a="",i=0),(a.length>0||!G.isBreakingSpace(V)||f)&&(a+=V,i+=y)}return o+=G._addLine(a,!1),o}static _addLine(e,r=!0){return e=G._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,s,n){let i=s[e];return typeof i!="number"&&(i=G._measureText(e,r,n)+r,s[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const s=e[r];if(!G.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:G._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:G._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let s="";if(typeof e!="string")return r;for(let n=0;n<e.length;n++){const i=e[n],a=e[n+1];if(G.isBreakingSpace(i,a)||G._isNewline(i)){s!==""&&(r.push(s),s=""),r.push(i);continue}s+=i}return s!==""&&r.push(s),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,s,n,i){return!0}static wordWrapSplit(e){return G.graphemeSegmenter(e)}static measureFont(e){if(G._fonts[e])return G._fonts[e];const r=G._context;r.font=e;const s=r.measureText(G.METRICS_STRING+G.BASELINE_SYMBOL),n={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return G._fonts[e]=n,n}static clearMetrics(e=""){e?delete G._fonts[e]:G._fonts={}}static get _canvas(){if(!G.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",ma)?.measureText)return G.__canvas=r,r;e=Ee.get().createCanvas()}catch{e=Ee.get().createCanvas()}e.width=e.height=10,G.__canvas=e}return G.__canvas}static get _context(){return G.__context||(G.__context=G._canvas.getContext("2d",ma)),G.__context}};Tt.METRICS_STRING="|Ã‰qÃ…";Tt.BASELINE_SYMBOL="M";Tt.BASELINE_MULTIPLIER=1.4;Tt.HEIGHT_MULTIPLIER=2;Tt.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();Tt.experimentalLetterSpacing=!1;Tt._fonts={};Tt._newlines=[10,13];Tt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Tt._measurementCache={};let Hu=Tt;const Gu=1e5;function Wu(t,e,r,s=0){if(t.texture===ne.WHITE&&!t.fill)return Le.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof ri){const n=t.fill,i=e.createPattern(n.texture.source.resource,"repeat"),a=n.transform.copyTo(ie.shared);return a.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(a),i}else if(t.fill instanceof or){const n=t.fill,i=n.type==="linear",a=n.textureSpace==="local";let o=1,l=1;a&&r&&(o=r.width+s,l=r.height+s);let c,u=!1;if(i){const{start:h,end:A}=n;c=e.createLinearGradient(h.x*o,h.y*l,A.x*o,A.y*l),u=Math.abs(A.x-h.x)<Math.abs((A.y-h.y)*.1)}else{const{center:h,innerRadius:A,outerCenter:f,outerRadius:p}=n;c=e.createRadialGradient(h.x*o,h.y*l,A*o,f.x*o,f.y*l,p*o)}if(u&&a&&r){const h=r.lineHeight/l;for(let A=0;A<r.lines.length;A++){const f=(A*r.lineHeight+s/2)/l;n.colorStops.forEach(p=>{const g=f+p.offset*h;c.addColorStop(Math.floor(g*Gu)/Gu,Le.shared.setValue(p.color).toHex())})}}else n.colorStops.forEach(h=>{c.addColorStop(h.offset,Le.shared.setValue(h.color).toHex())});return c}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(ie.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}return Ve("FillStyle not recognised",t),"red"}function hA(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,s=t.length;r<s;r++){const n=t[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<i)throw new Error("[BitmapFont]: Invalid character range.");for(let o=i,l=a;o<=l;o++)e.push(String.fromCharCode(o))}else e.push(...Array.from(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const dA=class fA extends Wf{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...fA.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const s=r.style.clone();r.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=ne.WHITE,s._fill.fill=null),this.applyFillAsTint=r.overrideFill;const n=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const i=mo(s);r.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/n):s.fontSize=this.baseRenderedFontSize=n,this._style=s,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=Hu.measureFont(i),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){const r=hA(e).filter(m=>!this._currentChars.includes(m)).filter((m,V,y)=>y.indexOf(m)===V);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:n,context:i}=s.canvasAndContext,a=s.texture.source;const o=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let A=0,f=!1;const p=n.width/this.resolution,g=n.height/this.resolution;for(let m=0;m<r.length;m++){const V=r[m],y=Hu.measureText(V,o,n,!1);y.lineHeight=y.height;const q=y.width*u,S=Math.ceil((o.fontStyle==="italic"?2:1)*q),P=y.height*u,C=S+h*2,T=P+h*2;if(f=!1,V!==`
`&&V!=="\r"&&V!=="	"&&V!==" "&&(f=!0,A=Math.ceil(Math.max(T,A))),l+C>p&&(c+=A,A=T,l=0,c+A>g)){a.update();const B=this._nextPage();n=B.canvasAndContext.canvas,i=B.canvasAndContext.context,a=B.texture.source,c=0}const j=q/u-(o.dropShadow?.distance??0)-(o._stroke?.width??0);if(this.chars[V]={id:V.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:j,kerning:{}},f){this._drawGlyph(i,y,l+h,c+h,u,o);const B=a.width*u,R=a.height*u,D=new ke(l/B*a.width,c/R*a.height,C/B*a.width,T/R*a.height);this.chars[V].texture=new ne({source:a,frame:D}),l+=Math.ceil(C)}}a.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return _e(Ge,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const s=this._measureCache;for(let n=0;n<e.length;n++){const i=e[n];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let l=s[i];l||(l=s[i]=r.measureText(i).width);let c=s[o];c||(c=s[o]=r.measureText(o).width);let u=r.measureText(i+o).width,h=u-(l+c);h&&(this.chars[i].kerning[o]=h),u=r.measureText(i+o).width,h=u-(l+c),h&&(this.chars[o].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=Du.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new ne({source:new wr({resource:r.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,s){r.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=mo(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const n=r._stroke,i=n?.width??0;if(n&&(e.lineWidth=i,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=Wu(n,e)),r._fill&&(e.fillStyle=Wu(r._fill,e)),r.dropShadow){const a=r.dropShadow,o=Le.shared.setValue(a.color).toArray(),l=a.blur*s,c=a.distance*s;e.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(a.angle)*c,e.shadowOffsetY=Math.sin(a.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,s,n,i,a){const o=r.text,l=r.fontProperties,u=(a._stroke?.width??0)*i,h=s+u/2,A=n-u/2,f=l.descent*i,p=r.lineHeight*i;a.stroke&&u&&e.strokeText(o,h,A+p-f),a._fill&&e.fillText(o,h,A+p-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:s}=this.pages[e];Du.returnCanvasAndContext(r),s.destroy(!0)}this.pages=null}};dA.defaultOptions={textureSize:512,style:new Ts,mipmap:!0};let Uu=dA;function Fq(t,e,r,s){const n={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=r.baseLineOffset;let i=n.lines[0],a=null,o=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=p=>{const g=i.width;for(let m=0;m<l.index;m++){const V=p.positions[m];i.chars.push(p.chars[m]),i.charPositions.push(V+g)}i.width+=p.width,o=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let p=i.chars.length-1;if(s){let g=i.chars[p];for(;g===" ";)i.width-=r.chars[g].xAdvance,g=i.chars[--p]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(i),n.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,A=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let p=0;p<t.length+1;p++){let g;const m=p===t.length;m||(g=t[p]);const V=r.chars[g]||r.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!o&&e.wordWrap&&i.width+l.width-A>f?(u(),c(l),m||i.charPositions.push(0)):(l.start=i.width,c(l),m||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&u();else if(!m){const P=V.xAdvance+(V.kerning[a]||0)+A;i.width+=P,i.spaceWidth=P,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const S=V.kerning[a]||0,P=V.xAdvance+S+A;l.positions[l.index++]=l.width+S,l.chars.push(g),l.width+=P}a=g}return u(),e.align==="center"?Nq(n):e.align==="right"?Oq(n):e.align==="justify"&&Lq(n),n}function Nq(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width/2-r.width/2;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function Oq(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width-r.width;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function Lq(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const s=t.lines[r];let n=0,i=s.spacesIndex[n++],a=0;const o=s.spacesIndex.length,c=(e-s.width)/o;for(let u=0;u<s.charPositions.length;u++)u===i&&(i=s.spacesIndex[n++],a+=c),s.charPositions[u]+=a}}let hn=0;class Dq{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let s=`${r.fontFamily}-bitmap`,n=!0;if(r._fill.fill&&!r._stroke)s+=r._fill.fill.styleKey,n=!1;else if(r._stroke||r.dropShadow){let a=r.styleKey;a=a.substring(0,a.lastIndexOf("-")),s=`${a}-bitmap`,n=!1}if(!we.has(s)){const a=new Uu({style:r,overrideFill:n,overrideSize:!0,...this.defaultOptions});hn++,hn>50&&Ve("BitmapText",`You have dynamically created ${hn} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{hn--,we.remove(s)}),we.set(s,a)}const i=we.get(s);return i.ensureCharacters?.(e),i}getLayout(e,r,s=!0){const n=this.getFont(e,r);return Fq([...e],r,n,s)}measureText(e,r,s=!0){return this.getLayout(e,r,s)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},_e(Ge,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=r?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const n=r.style,i=n instanceof Ts?n:new Ts(n),a=i._fill.fill!==null&&i._fill.fill!==void 0,o=new Uu({style:i,overrideFill:a,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=hA(r.chars);return o.ensureCharacters(l.join("")),we.set(`${s}-bitmap`,o),o.once("destroy",()=>we.remove(`${s}-bitmap`)),o}uninstall(e){const r=`${e}-bitmap`,s=we.get(r);s&&s.destroy()}}const Yu=new Dq;class AA extends Wf{constructor(e,r){super();const{textures:s,data:n}=e;Object.keys(n.pages).forEach(i=>{const a=n.pages[parseInt(i,10)],o=s[a.id];this.pages.push({texture:o})}),Object.keys(n.chars).forEach(i=>{const a=n.chars[i],{frame:o,source:l}=s[a.page],c=new ke(a.x+o.x,a.y+o.y,a.width,a.height),u=new ne({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:u}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){Yu.install(e)}static uninstall(e){Yu.uninstall(e)}}const ga={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const A=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in f){const m=f[g].split("="),V=m[0],y=m[1].replace(/"/gm,""),q=parseFloat(y),S=isNaN(q)?y:q;p[V]=S}r[A].push(p)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=r.info,[i]=r.common,[a]=r.distanceField??[];a&&(s.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),s.fontSize=parseInt(n.size,10),s.fontFamily=n.face,s.lineHeight=parseInt(i.lineHeight,10);const o=r.page;for(let h=0;h<o.length;h++)s.pages.push({id:parseInt(o[h].id,10)||0,file:o[h].file});const l={};s.baseLineOffset=s.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const A=c[h],f=parseInt(A.id,10);let p=A.letter??A.char??String.fromCharCode(f);p==="space"&&(p=" "),l[f]=p,s.chars[p]={id:f,page:parseInt(A.page,10)||0,x:parseInt(A.x,10),y:parseInt(A.y,10),width:parseInt(A.width,10),height:parseInt(A.height,10),xOffset:parseInt(A.xoffset,10),yOffset:parseInt(A.yoffset,10),xAdvance:parseInt(A.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const A=parseInt(u[h].first,10),f=parseInt(u[h].second,10),p=parseInt(u[h].amount,10);s.chars[l[f]].kerning[l[A]]=p}return s}},Xu={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(s.getAttribute("base"),10);for(let c=0;c<a.length;c++){const u=a[c],h=parseInt(u.getAttribute("id"),10);let A=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);A==="space"&&(A=" "),l[h]=A,e.chars[A]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<o.length;c++){const u=parseInt(o[c].getAttribute("first"),10),h=parseInt(o[c].getAttribute("second"),10),A=parseInt(o[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=A}return e}},$u={test(t){return typeof t=="string"&&t.includes("<font>")?Xu.test(Ee.get().parseXML(t)):!1},parse(t){return Xu.parse(Ee.get().parseXML(t))}},Hq=[".xml",".fnt"],Gq={extension:{type:U.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof AA,getCacheableAssets(t,e){const r={};return t.forEach(s=>{r[s]=e,r[`${s}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},Wq={extension:{type:U.LoadParser,priority:lr.Normal},name:"loadBitmapFont",test(t){return Hq.includes(At.extname(t).toLowerCase())},async testParse(t){return ga.test(t)||$u.test(t)},async parse(t,e,r){const s=ga.test(t)?ga.parse(t):$u.parse(t),{src:n}=e,{pages:i}=s,a=[],o=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const A=i[h].file;let f=At.join(At.dirname(n),A);f=ao(f,n),a.push({src:f,data:o})}const l=await r.load(a),c=a.map(h=>l[h.src]);return new AA({data:s,textures:c},n)},async load(t,e){return await(await Ee.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(s=>r.unload(s.texture.source._sourceOrigin))),t.destroy()}};class Uq{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<r;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const Yq={extension:{type:U.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof ne),getCacheableAssets:(t,e)=>{const r={};return t.forEach(s=>{e.forEach((n,i)=>{r[s+(i===0?"":i+1)]=n})}),r}};async function pA(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const Xq={extension:{type:U.DetectionParser,priority:1},test:async()=>pA("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},Ku=["png","jpg","jpeg"],$q={extension:{type:U.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Ku],remove:async t=>t.filter(e=>!Ku.includes(e))},Kq="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ll(t){return Kq?!1:document.createElement("video").canPlayType(t)!==""}const Qq={extension:{type:U.DetectionParser,priority:0},test:async()=>ll("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},Zq={extension:{type:U.DetectionParser,priority:0},test:async()=>ll("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},Jq={extension:{type:U.DetectionParser,priority:0},test:async()=>ll("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},ew={extension:{type:U.DetectionParser,priority:0},test:async()=>pA("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class tw{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,s)=>(this._parsersValidated=!1,e[r]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const s={promise:null,parser:null};return s.promise=(async()=>{let n=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||Ve(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];if(o.load&&o.test?.(e,r,this)){i=o;break}}if(!i)return Ve(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,r,this),s.parser=i;for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];o.parse&&o.parse&&await o.testParse?.(n,r,this)&&(n=await o.parse(n,r,this)||n,s.parser=o)}return n})(),s}async load(e,r){this._parsersValidated||this._validateParsers();let s=0;const n={},i=Ln(e),a=Mt(e,c=>({alias:[c],src:c,data:{}})),o=a.length,l=a.map(async c=>{const u=At.toAbsolute(c.src);if(!n[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),n[c.src]=await this.promiseCache[u].promise,r&&r(++s/o)}catch(h){throw delete this.promiseCache[u],delete n[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?n[a[0].src]:n}async unload(e){const s=Mt(e,n=>({alias:[n],src:n})).map(async n=>{const i=At.toAbsolute(n.src),a=this.promiseCache[i];if(a){const o=await a.promise;delete this.promiseCache[i],await a.parser?.unload?.(o,n,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&Ve(`[Assets] loadParser name conflict "${r.name}"`):Ve("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function ts(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function rs(t,e){const r=t.split("?")[0],s=At.extname(r).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const rw=".json",sw="application/json",nw={extension:{type:U.LoadParser,priority:lr.Low},name:"loadJson",test(t){return ts(t,sw)||rs(t,rw)},async load(t){return await(await Ee.get().fetch(t)).json()}},iw=".txt",aw="text/plain",ow={name:"loadTxt",extension:{type:U.LoadParser,priority:lr.Low,name:"loadTxt"},test(t){return ts(t,aw)||rs(t,iw)},async load(t){return await(await Ee.get().fetch(t)).text()}},lw=["normal","bold","100","200","300","400","500","600","700","800","900"],cw=[".ttf",".otf",".woff",".woff2"],uw=["font/ttf","font/otf","font/woff","font/woff2"],hw=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function dw(t){const e=At.extname(t),n=At.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let i=n.length>0;for(const o of n)if(!o.match(hw)){i=!1;break}let a=n.join(" ");return i||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const fw=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Aw(t){return fw.test(t)?t:encodeURI(t)}const pw={extension:{type:U.LoadParser,priority:lr.Low},name:"loadWebFont",test(t){return ts(t,uw)||rs(t,cw)},async load(t,e){const r=Ee.get().getFontFaceSet();if(r){const s=[],n=e.data?.family??dw(t),i=e.data?.weights?.filter(o=>lw.includes(o))??["normal"],a=e.data??{};for(let o=0;o<i.length;o++){const l=i[o],c=new FontFace(n,`url(${Aw(t)})`,{...a,weight:l});await c.load(),r.add(c),s.push(c)}return we.set(`${n}-and-url`,{url:t,fontFaces:s}),s.length===1?s[0]:s}return Ve("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{we.remove(`${e.family}-and-url`),Ee.get().getFontFaceSet().delete(e)})}};function cl(t,e=1){const r=es.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function ul(t,e,r){t.label=r,t._sourceOrigin=r;const s=new ne({source:t,label:r}),n=()=>{delete e.promiseCache[r],we.has(r)&&we.remove(r)};return s.source.once("destroy",()=>{e.promiseCache[r]&&(Ve("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),s.once("destroy",()=>{t.destroyed||(Ve("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),s}const mw=".svg",gw="image/svg+xml",xw={extension:{type:U.LoadParser,priority:lr.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return ts(t,gw)||rs(t,mw)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?Vw(t):yw(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function yw(t,e,r,s){const i=await(await Ee.get().fetch(t)).blob(),a=URL.createObjectURL(i),o=new Image;o.src=a,o.crossOrigin=s,await o.decode(),URL.revokeObjectURL(a);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||cl(t),h=e.data?.width??o.width,A=e.data?.height??o.height;l.width=h*u,l.height=A*u,c.drawImage(o,0,0,h*u,A*u);const{parseAsGraphicsContext:f,...p}=e.data??{},g=new wr({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...p});return ul(g,r,t)}async function Vw(t){const r=await(await Ee.get().fetch(t)).text(),s=new mr;return s.svg(r),s}const bw=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Lr=null,go=class{constructor(){Lr||(Lr=URL.createObjectURL(new Blob([bw],{type:"application/javascript"}))),this.worker=new Worker(Lr)}};go.revokeObjectURL=function(){Lr&&(URL.revokeObjectURL(Lr),Lr=null)};const qw=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Dr=null;class mA{constructor(){Dr||(Dr=URL.createObjectURL(new Blob([qw],{type:"application/javascript"}))),this.worker=new Worker(Dr)}}mA.revokeObjectURL=function(){Dr&&(URL.revokeObjectURL(Dr),Dr=null)};let Qu=0,xa;class ww{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new go;r.addEventListener("message",s=>{r.terminate(),go.revokeObjectURL(),e(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){xa===void 0&&(xa=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<xa&&(this._createdWorkers++,e=new mA().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const s=new Promise((n,i)=>{this._queue.push({id:e,arguments:r,resolve:n,reject:i})});return this._next(),s}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),s=r.id;this._resolveHash[Qu]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Qu++,id:s})}}const Zu=new ww,vw=[".jpeg",".jpg",".png",".webp",".avif"],_w=["image/jpeg","image/png","image/webp","image/avif"];async function kw(t,e){const r=await Ee.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const s=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const gA={name:"loadTextures",extension:{type:U.LoadParser,priority:lr.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return ts(t,_w)||rs(t,vw)},async load(t,e,r){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Zu.isImageBitmapSupported()?s=await Zu.loadImageBitmap(t,e):s=await kw(t,e):s=await new Promise((i,a)=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?i(s):(s.onload=()=>{i(s)},s.onerror=a)});const n=new wr({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||cl(t),...e.data});return ul(n,r,t)},unload(t){t.destroy(!0)}},xA=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Sw=xA.map(t=>`video/${t.substring(1)}`);function Cw(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=Pw(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function Mw(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",s),t.addEventListener("error",n),t.load();function s(){i(),e()}function n(a){i(),r(a)}function i(){t.removeEventListener("canplaythrough",s),t.removeEventListener("error",n)}})}function Pw(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const Tw={name:"loadVideo",extension:{type:U.LoadParser,name:"loadVideo"},test(t){const e=ts(t,Sw),r=rs(t,xA);return e||r},async load(t,e,r){const s={...vn.defaultOptions,resolution:e.data?.resolution||cl(t),alphaMode:e.data?.alphaMode||await Ef(),...e.data},n=document.createElement("video"),i={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&n.setAttribute(l,c)}),s.muted===!0&&(n.muted=!0),Cw(n,t,s.crossorigin);const a=document.createElement("source");let o;if(t.startsWith("data:"))o=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();o=vn.MIME_TYPES[l]||`video/${l}`}return a.src=t,o&&(a.type=o),new Promise(l=>{const c=async()=>{const u=new vn({...s,resource:n});n.removeEventListener("canplay",c),e.data.preload&&await Mw(n),l(ul(u,r,t))};n.addEventListener("canplay",c),n.appendChild(a)})},unload(t){t.destroy(!0)}},yA={extension:{type:U.ResolveParser,name:"resolveTexture"},test:gA.test,parse:t=>({resolution:parseFloat(es.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},Ew={extension:{type:U.ResolveParser,priority:-2,name:"resolveJson"},test:t=>es.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:yA.parse};class Iw{constructor(){this._detections=[],this._initialized=!1,this.resolver=new es,this.loader=new tw,this.cache=we,this._backgroundLoader=new Uq(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){Ve("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,s=typeof r=="number"?[r]:r,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:s}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const s=Ln(e),n=Mt(e).map(o=>{if(typeof o!="string"){const l=this.resolver.getAlias(o);return l.some(c=>!this.resolver.hasKey(c))&&this.add(o),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),i=this.resolver.resolve(n),a=await this._mapLoadToResolve(i,r);return s?a[n[0]]:a}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},a=Object.keys(n);let o=0,l=0;const c=()=>{r?.(++o/l)},u=a.map(h=>{const A=n[h];return l+=Object.keys(A).length,this._mapLoadToResolve(A,c).then(f=>{i[h]=f})});return await Promise.all(u),s?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return we.get(e);const r={};for(let s=0;s<e.length;s++)r[s]=we.get(e[s]);return r}async _mapLoadToResolve(e,r){const s=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(s,r);this._backgroundLoader.active=!0;const i={};return s.forEach(a=>{const o=n[a.src],l=[a.src];a.alias&&l.push(...a.alias),l.forEach(c=>{i[c]=o}),we.set(l,o)}),i}async unload(e){this._initialized||await this.init();const r=Mt(e).map(n=>typeof n!="string"?n.src:n),s=this.resolver.resolve(r);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=Mt(e);const r=this.resolver.resolveBundle(e),s=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(s)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(s=>{we.remove(s.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const s of e.detections)e.skipDetections||await s.test()?r=await s.add(r):e.skipDetections||(r=await s.remove(r));return r=r.filter((s,n)=>r.indexOf(s)===n),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(s=>s in e).forEach(s=>{r.config[s]=e[s]})})}}const xs=new Iw;it.handleByList(U.LoadParser,xs.loader.parsers).handleByList(U.ResolveParser,xs.resolver.parsers).handleByList(U.CacheParser,xs.cache.parsers).handleByList(U.DetectionParser,xs.detections);it.add(Yq,$q,Xq,ew,Qq,Zq,Jq,nw,ow,pw,xw,gA,Tw,Wq,Gq,yA,Ew);const Ju={loader:U.LoadParser,resolver:U.ResolveParser,cache:U.CacheParser,detection:U.DetectionParser};it.handle(U.Asset,t=>{const e=t.ref;Object.entries(Ju).filter(([r])=>!!e[r]).forEach(([r,s])=>it.add(Object.assign(e[r],{extension:e[r].extension??s})))},t=>{const e=t.ref;Object.keys(Ju).filter(r=>!!e[r]).forEach(r=>it.remove(e[r]))});it.add(Ay,py);const ya={x:1,y:0,z:0},Va={x:-1,y:0,z:0},ba={x:0,y:-1,z:0},qa={x:0,y:1,z:0},me={away:qa,left:ya,right:Va,towards:ba,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:Or(Ae(qa,Va)),towardsRight:Or(Ae(ba,Va)),towardsLeft:Or(Ae(ba,ya)),awayLeft:Or(Ae(qa,ya))},Rw=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),Bw=Math.cos(13*(Math.PI/180)),eh=-Math.PI/4,zw=t=>{const e=Math.cos(eh),r=Math.sin(eh);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};Or({x:1,y:2,z:0});Or({x:-1,y:2,z:0});const jw=t=>{const e=Ip(t);return e===void 0?ge:me[e]},Fw=t=>{const e=Vn(t);return e===void 0?ge:me[e]},Nw=(t,e=Bw)=>{const{x:r,y:s}=t,n=Math.sqrt(r*r+s*s);if(n===0)return ge;const i=r/n,a=s/n,o=Math.abs(i),l=Math.abs(a);if(o>l){if(o>=e)return{x:Math.sign(r)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(s)*n,z:0};return t},Ow={"4-way":jw,"8-way":Fw,analogue:Nw},Lw=.2,Dw=45,Hw=(t,e)=>!!t.keyboardState.has(e),VA=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},xo=.5,bA=(t,e,r)=>{for(const s of t.gamepads)if(!(s===null||s.axes.length<=e)){if(r===void 0){if(Math.abs(s.axes[e])>xo)return!0}else if(s.axes[e]*r>xo)return!0}return!1},dn=(t,e,r=!0)=>{const s=Pn(be.getState()),n=s.presses[e];if(t.hudInputState[e])return!0;for(const i of n.keys)if(Hw(t,i))return!0;for(const i of n.gamepadButtons)if(VA(t,i))return!0;if(r){const i=af(e);if(i!==void 0){const a=s.axes[i.axis];for(const o of a)if(bA(t,o,i.direction))return!0}}return!1};class Gw{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=ge;actionsHandled=new Set;#s=()=>{let e,r,s,n;switch("tap"){case(e=this.currentActionPress("left")):return me.left;case(r=this.currentActionPress("right")):return me.right;case(s=this.currentActionPress("away")):return me.away;case(n=this.currentActionPress("towards")):return me.towards}const i=(e!=="released"?1:0)+(r!=="released"?1:0)+(s!=="released"?1:0)+(n!=="released"?1:0);if(i>1)return this.#t;if(i===1)switch("hold"){case e:return me.left;case r:return me.right;case s:return me.away;case n:return me.towards}return ge};#n(){const e=this.#e.at(0);if(e===void 0)return ge;function*r(a){for(const o of zs)dn(a,o,!1)&&(yield me[o])}function*s(a){const{axes:{x:o,y:l}}=Pn(be.getState());for(const c of a.gamepads){if(c===null)continue;let u=0,h=0;for(const f of o)c.axes.length<=f||(u-=c.axes[f]);for(const f of l)c.axes.length<=f||(h-=c.axes[f]);const A={x:u,y:h,z:0};od(A)>Lw&&(yield A)}}let n=[...r(e)],i;if(n.length===1){const[a]=n,o=[...Ue(this.#e).drop(1).map(l=>[...r(l)])];e:for(const l of o){if(l.length>2)break e;if(l.length===2&&l.some(c=>Pp(c,a))){const c=l.find(u=>Ep(u,a)<.001);if(c!==void 0){i=c;break e}}}if(!i)for(const l of o)l.length===0&&(n=Fn)}return Ae(i??ge,...n,...s(e))}#r=({lastTime:e})=>{const r=zo(be.getState()),i=Cg(be.getState())&&r?zw:h=>h,a=Ow[r](Ae(i(r==="4-way"?this.#s():this.#n()),this.hudInputState.directionVector)),o=ld(a);this.#t={...o>1?id(a,1/o):a,z:0};const l={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:Rw(navigator.getGamepads()),atTime:e};this.#e.unshift(l);const c=e-Dw,u=this.#e.findIndex(h=>h.atTime<c);u!==-1&&this.#e.splice(u+1);for(const h of this.actionsHandled)dn(l,h)||this.actionsHandled.delete(h)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const s=dn(r,e);if(this.actionsHandled.has(e))return"released";if(s){const n=this.#e.at(1);return(n===void 0?!1:dn(n,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const s of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(s))return{type:"key",input:s};for(const s of e.gamepads)if(s!==null){for(const[n,i]of s.buttons.entries())if(i.pressed&&(r===void 0||!VA(r,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of s.axes.entries())if(Math.abs(i)>xo&&(r===void 0||!bA(r,n)))return{type:"gamepadAxes",input:n}}}}get directionVector(){return this.#t}startTicking(){nt.shared.add(this.#r,void 0,On.INTERACTION)}stopTicking(){nt.shared.remove(this.#r)}}const Ww=()=>({directionVector:ge,...Fs(Sd.map(t=>[t,!1]))}),qA=I.createContext(null),Uw=({children:t})=>{const[e]=I.useState(dy),[r]=I.useState(()=>new Gw(e,Ww()));return I.useEffect(()=>{const s=fy(e);return r.startTicking(),()=>{s(),r.stopTicking()}},[r,e]),d.jsx(qA,{value:r,children:t})},hl=()=>{const t=I.useContext(qA);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},$e=({handler:t,action:e,disabled:r=!1})=>{const s=I.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=hl();I.useEffect(()=>{if(r)return;const i=()=>{for(const a of s)if(n.currentActionPress(a)==="tap"){if(!t(a))for(const c of s)n.actionsHandled.add(c);break}};return nt.shared.add(i),()=>{nt.shared.remove(i)}},[s,r,n,t])},Yw=({handler:t,disabled:e=!1})=>{const r=hl();I.useEffect(()=>{if(e)return;const s=()=>{const n=r.inputTap();n!==void 0&&t(n,r)};return nt.shared.add(s),()=>{nt.shared.remove(s)}},[e,t,r])};function H(t,e){const r=Ro();return I.useCallback(()=>{r(t(e))},[t,r,e])}const Xw=()=>{const t=ae(r=>r.gameMenus.assigningInput!==void 0),e=ae(r=>r.gameMenus.openMenus.length>0);$e({action:"menu_openOrExit",handler:H(Fc),disabled:t}),$e({action:"menu_exit",handler:H(Fc),disabled:!e}),$e({action:"toggleShowFps",handler:H(Ut,"userSettings.showFps"),disabled:e}),$e({action:"hold",handler:H(rf,"toggle"),disabled:t}),$e({action:"map",handler:H(Xx),disabled:t}),I.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),$e({action:"toggleColourisation",handler:H(Ut,"userSettings.displaySettings.uncolourised"),disabled:t}),$e({action:"cycleResolution",handler:H(nf,void 0),disabled:t})},wa=()=>{be.dispatch(Qx(Xd($n(be.getState()))))},$w=()=>{const t=Ro();I.useLayoutEffect(()=>{wa()},[]),I.useLayoutEffect(()=>(window.addEventListener("resize",wa),()=>window.removeEventListener("resize",wa)),[t])},Kw=()=>($w(),Xw(),ay(),null),Qw=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bagâ€™s icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring.compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,Zw=`## BLACKTOOTH

![](texture-blacktooth.wall.armour.left?bg-pureBlack)![](texture-blacktooth.wall.shield.away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,Jw=`## BOOK WORLD

![](texture-bookworld.wall.cowboy.left?bg-pureBlack)![](texture-book.x?float-right&clear-right)![](texture-book.y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,ev=`## CONVEYOR BELTS

![](texture-animated-heels.walking.right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor.x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,tv=`## CREDITS

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
Â©1987 Ocean Software Limited.
`,rv=`## CROWNS

![](texture-crown.blacktooth)![](texture-crown.bookworld?float-right)![](texture-crown.egyptus?clear-left)![](texture-crown.penitentiary?float-right&clear-right)![](texture-crown.safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,sv=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## ![](texture-hud.char.2?sprite-tinted&text-metallicBlue&sprites-normal-height) Two extra lives
if you pick them up while head and heels are joined, they get two each

## ![](texture-hud.shield?sprite-tinted&text-metallicBlue&sprites-normal-height) Iron pills

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud.bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height)Jump higher bunny

![](texture-heels.walking.right.2?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud.fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height)Go faster bunny
![](texture-head.walking.right.2?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,nv=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so donâ€™t waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,iv=`## EGYPTUS

![](texture-egyptus.wall.sarcophagus.left)![](texture-egyptus.wall.sarcophagus.away?float-right)![](texture-egyptus.wall.hieroglyphics.left?clear-left)![](texture-egyptus.wall.hieroglyphics.away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,av=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head.walking.towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head.falling.right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,ov=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels.walking.towards?float-right)During Heelsâ€™s evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,lv=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head.idle.towards?float-right&relative&z-topSprite)![](texture-heels.walking.towards.2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelsâ€™s bag and Headâ€™s hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the otherâ€™s back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Headâ€™s jumps and Heelsâ€™s jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring.released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you canâ€™t understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,cv=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown.blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head.walking.right.2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels.walking.right.2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,uv=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,hv=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head.walking.right.2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles.white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Headâ€™s race, they disappear and wonâ€™t return until they are sure the coast is
clear.

> Head Over Heels Manual
`,dv=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary.wall.skeleton.left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,fv=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish.1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,Av=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youâ€™re not there already
* To the right of the address bar, click the **install icon: î©¸**
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youâ€™re not there already
* Tap the **share button ï”Ž**
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen ï‘—**
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youâ€™re not there already
* Click the **share button ï”Ž** to the right of the address bar
* Choose **Add to Dock ó±‚©**
* **Head over heels** is now installed on your mac
* If you donâ€™t want to keep the game in the Dock, right-click the doc icon and uncheck **Options âž¡ keep in doc**. It is still available in Applications

`,pv=`## Supported platforms

Almost anything with an up-to-date browser can play

Hereâ€™s some Iâ€™ve tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,mv=`## SAFARI

![](texture-monkey.right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant.towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,gv=`## SPRINGS

![](texture-spring.compressed)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,xv=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!  
**WARNING**: Switching a deadly monster off will stop him moving but he will
still be **deadly** to touch.

> Head Over Heels Manual
`,yv=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,Vv=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman.towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minionâ€™s back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyâ€™ll never get this far!

*> Your humble minion*
`,bv=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,qv=`## THE EMPERORâ€™S GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles.cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,wv=`## THE GAME

![](texture-heels.walking.right.2)![](texture-animated-head.idle.towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain â€˜keep fitâ€™ equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market.wall.fruits.left?bg-pureBlack)![](texture-moonbase.wall.window2.away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown.bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman.towards?float-right&relative&z-topSprite)![](texture-animated-bubbles.cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle.right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,fe=Object.assign({"./bag.md":Qw,"./blacktooth.md":Zw,"./bookWorld.md":Jw,"./conveyorBelts.md":ev,"./credits.md":tv,"./crowns.md":rv,"./cuddlyStuffedWhiteRabbits.md":sv,"./doughnuts.md":nv,"./egyptus.md":iv,"./head.md":av,"./heels.md":ov,"./hintsAndTips.md":lv,"./historyOfTheBlacktoothEmpire.md":cv,"./hooter.md":uv,"./hushPuppies.md":hv,"./penitentiary.md":dv,"./reincarnationFish.md":fv,"./remake/installGuide.md":Av,"./remake/supportedPlatforms.md":pv,"./safari.md":mv,"./springs.md":gv,"./switches.md":xv,"./swopKey.md":yv,"./teleportBack.md":Vv,"./teleports.md":bv,"./theEmperorsGuardian.md":qv,"./theGame.md":wv}),dl={historyOfTheBlacktoothEmpire:fe["./historyOfTheBlacktoothEmpire.md"],theGame:fe["./theGame.md"],egyptus:fe["./egyptus.md"],penitentiary:fe["./penitentiary.md"],safari:fe["./safari.md"],bookWorld:fe["./bookWorld.md"],blacktooth:fe["./blacktooth.md"],head:fe["./head.md"],heels:fe["./heels.md"],reincarnationFish:fe["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:fe["./cuddlyStuffedWhiteRabbits.md"],hooter:fe["./hooter.md"],doughnuts:fe["./doughnuts.md"],bag:fe["./bag.md"],crowns:fe["./crowns.md"],teleports:fe["./teleports.md"],springs:fe["./springs.md"],switches:fe["./switches.md"],conveyorBelts:fe["./conveyorBelts.md"],hushPuppies:fe["./hushPuppies.md"],theEmperorsGuardian:fe["./theEmperorsGuardian.md"],swopKey:fe["./swopKey.md"],hintsAndTips:fe["./hintsAndTips.md"],credits:fe["./credits.md"],installGuide:fe["./remake/installGuide.md"]},vv={...dl,teleportBack:fe["./teleportBack.md"]},_v=/^##\s+(.*)$/m,kv=t=>{const e=t.match(_v);if(e===null)return"no title found";const[,r]=e;return r};function Jk(t){if(!yo(t))throw new Error(`Invalid textureId: "${t}"`)}function yo(t){return Gt.frames[t]!==void 0}function eS(t){return Gt.animations[t]!==void 0}const Sv="/assets/sprites-wUnPyw7O.png";let vs;const Cv=async()=>{if(vs!==void 0)return vs;let t;try{t=await xs.load(Sv)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=ne.EMPTY}const e=new oo(t,Gt);return await e.parse(),e.textureSource.scaleMode="nearest",vs=e,e},Mv=()=>{if(vs===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return vs},Pv=({className:t,children:e})=>t?d.jsx("div",{className:`contents ${t}`,children:e}):e,O=({children:t,className:e,noSlitWords:r,classnameCycle:s,onClick:n,TagName:i="span"})=>{const a=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(a.length===0)return null;const o=r?[a.toUpperCase()]:a.toUpperCase().split(/\s+/);return d.jsxs(i,{className:e,onClick:n,children:[d.jsx("span",{className:"sr-only",children:a}),o.map((l,c)=>d.jsx("span",{className:Oe("text-nowrap inline-block",c===o.length-1?"":"me-1"),children:Array.from(l).map((u,h)=>{const A=`hud.char.${bd(u)}`;return yo(A)||console.error("no texture for char",u,u.charCodeAt(0),A,"we have:",Object.keys(Mv().textures)),d.jsx("span",{className:`sprite ${yo(A)?`texture-${A}`:"texture-hud.char.?"}
                  sprite-tinted
                  ${s===void 0?"":s[h%s.length]}`},h)})},c))]})},Tv=t=>t.props.children!==void 0,rt=({children:t,className:e})=>d.jsx(Pv,{className:e,children:Array.isArray(t)?t.map((r,s)=>d.jsx(rt,{children:r},s)):typeof t=="number"?d.jsx(O,{children:String(t)}):typeof t=="string"?d.jsx(O,{children:t}):I.isValidElement(t)?t.type===O||t.type===rt?t:Tv(t)?I.cloneElement(t,void 0,typeof t.props.children=="string"?d.jsx(O,{children:`${t.props.children}`}):d.jsx(rt,{children:t.props.children})):t:t}),Ev=({flip:t=!1,focussed:e=!1})=>d.jsx(O,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":""),children:e?"â©â©":"âŒâ"});var bt={},Er={},Ir={},th;function ni(){if(th)return Ir;th=1;var t=Ir&&Ir.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ir,"__esModule",{value:!0});const r=t($r()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return Ir.default=r,Ir}var rh;function Iv(){if(rh)return Er;rh=1;var t=Er&&Er.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Er,"__esModule",{value:!0});const e=t($r()),r=t($h()),s=t(ni()),n=({id:i,children:a})=>{const{refs:o,renderItems:l}=e.default.useContext(s.default),c=o[i],u=l[i];return c?u?r.default.createPortal(u(a),c,i):r.default.createPortal(a,c,i):null};return Er.default=n,Er}var Rr={},sh;function Rv(){if(sh)return Rr;sh=1;var t=Rr&&Rr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Rr,"__esModule",{value:!0});const e=t($r()),r=t(ni()),s=({id:n,renderItem:i=o=>o,className:a})=>{const{register:o,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&o(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,a].filter(u=>!!u).join(" "),ref:c})};return Rr.default=s,Rr}var rr={},nh;function Bv(){if(nh)return rr;nh=1;var t=rr&&rr.__rest||function(i,a){var o={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.indexOf(l)<0&&(o[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)a.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(o[l[c]]=i[l[c]]);return o},e=rr&&rr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(rr,"__esModule",{value:!0});const r=e($r()),s=e(ni()),n=({children:i})=>{const[a,o]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((f,p,g)=>{o(m=>Object.assign(Object.assign({},m),{[f]:p})),c(m=>Object.assign(Object.assign({},m),{[f]:g}))},[]),h=r.default.useCallback(f=>{o(p=>{const g=p,m=f;return g[m],t(g,[typeof m=="symbol"?m:m+""])}),c(p=>{const g=p,m=f;return g[m],t(g,[typeof m=="symbol"?m:m+""])})},[]),A=r.default.useMemo(()=>({refs:a,renderItems:l,register:u,unregister:h}),[a,l,u,h]);return r.default.createElement(s.default.Provider,{value:A},i)};return rr.default=n,rr}var ih;function zv(){if(ih)return bt;ih=1;var t=bt&&bt.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.Context=bt.Placeholder=bt.Provider=void 0;const e=t(Iv()),r=t(Rv()),s=t(Bv()),n=t(ni());bt.Provider=s.default,bt.Placeholder=r.default,bt.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=r.default,i.Provider=s.default,bt.default=i,bt}var jv=zv();const ss=Ze(jv),ve="leading-none [&_[class*='texture-hud.char']]:mb-oneScaledPix",Fv=["menu_select","swop","jump"],Es="data-menuitem_id",wA="data-menuitem_hidden",vA="data-menuitem_disabled",Nv=()=>{},Q=({id:t,label:e,valueElement:r,flipLeader:s=!1,doubleHeightWhenFocussed:n,onSelect:i=Nv,hidden:a=!1,disabled:o=!1,hintInline:l=!1,className:c,hint:u,leader:h})=>{const A=I.useRef(!0),f=ae(m=>m.gameMenus.openMenus[0].scrollableSelection),p=ae(m=>m.gameMenus.openMenus[0].focussedItemId===t);$e({action:Fv,handler:i,disabled:!p||a||o});const g=d.jsxs("li",{[Es]:t,[wA]:a,[vA]:o,tabIndex:0,className:Oe("contents",a?"hidden":"",n&&p?"sprites-double-height":"",p?"selectedMenuItem":"",c),onMouseMove:H($o,{focussedItemId:t,scrollableSelection:!1}),onClick:o?void 0:i,children:[h||d.jsx(Ev,{flip:s,focussed:p}),d.jsx("div",{ref:m=>{p&&f&&m?.scrollIntoView({behavior:A.current?"instant":"smooth",block:"center"}),A.current=!1},className:Oe(r===void 0?"col-span-2":""),children:typeof e=="string"?d.jsx(d.Fragment,{children:d.jsx(O,{children:e})}):e}),r!==void 0&&r,!p||u===void 0||l?null:d.jsx(ss,{children:typeof u=="string"?d.jsx(O,{className:ve,children:u}):u})]});return l&&u&&p?d.jsxs(d.Fragment,{children:[g,d.jsx("div",{className:"col-span-2 col-start-2",children:u})]}):g},tr=()=>d.jsx(Q,{id:"back",label:"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:H(Ye)}),ii=t=>d.jsx("div",{className:`col-span-3 h-1 ${t}`}),_A=()=>{const t=document.body.querySelectorAll(`[${Es}]`);return Array.from(t)},ah=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=be.getState();if(e===void 0)return!0;const r=_A();if(r.length<=1)return!0;const s=r.findIndex(i=>i.getAttribute(Es)===e);if(s===-1)return!0;let n=s;do n=(n+t+r.length)%r.length;while(r[n].getAttribute(wA)==="true"||r[n].getAttribute(vA)==="true");return be.dispatch($o({focussedItemId:r[n].getAttribute(Es),scrollableSelection:!0})),!1},Ov=t=>{const e=Ed();$e({action:"away",handler:I.useCallback(()=>{if(t.current!==null)return ah(-1)},[t]),disabled:e}),$e({action:"towards",handler:I.useCallback(()=>{if(t.current!==null)return ah(1)},[t]),disabled:e})},Ne=({className:t="",children:e})=>{const r=I.useRef(null);return I.useEffect(()=>{if(r.current===null||be.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const s=_A();be.dispatch($o({focussedItemId:s[0].getAttribute(Es),scrollableSelection:!0}))},[]),Ov(r),d.jsx("menu",{ref:r,className:Oe("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})};var kA=$h();const tS=Ze(kA),Je=({children:t})=>kA.createPortal(d.jsx(zd,{children:t}),document.body),ai=({className:t})=>d.jsxs("div",{className:Oe("text-redShadow zx:text-zxMagenta sprites-double-height flex flex-row gap-1",t),children:[d.jsx(O,{className:"inline-block scale-[-1]",onClick:H(Ye),children:"â©â©"}),d.jsx(O,{className:"inline-block",onClick:H(Ye),children:"Back"})]}),Lv=({pageName:t})=>{const e=dl[t],r=kv(e),s=ft()==="desktop";return d.jsx(Q,{id:`markdown/${t}`,label:r,onSelect:H(Ct,`markdown/${t}`),doubleHeightWhenFocussed:s})},Dv=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxCyan",onClick:H(Ye)}),d.jsx(De,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:d.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${ve} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[Xt()&&d.jsx(ai,{className:"mb-1"}),d.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[d.jsx("span",{className:"sprite texture-book.x zx:sprite-revert-to-white sprites-normal-height"}),d.jsx(O,{className:"sprites-double-height mx-1",children:"Read the manual"}),d.jsx("span",{className:"sprite texture-book.y zx:sprite-revert-to-white sprites-normal-height"})]}),d.jsxs(Ne,{children:[[...Ue(Eo(dl)).map(t=>d.jsx(Lv,{pageName:t},t))],d.jsx(ii,{}),Xt()||d.jsx(tr,{})]})]})})]}),Hv={"":I.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},oh=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),Gv=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),va=t=>t.replace(/^\s+|\s+$/g," "),Ie=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),ys=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,s=0;const n=Ie("");let i,a;e?(i=Ie("p"),a=[n,i],n.c.push(i)):(i=n,a=[n]);let o;const l=(h,A=!0)=>(A&&a.push(h),i.c.push(h),A&&(i=h),h),c=h=>{const A=a.findIndex(f=>f.t===h);a=a.slice(0,A),i=a.at(-1)};for(;o=r.exec(t);){const h=t.substring(s,o.index);if(s=r.lastIndex,h!=="")if(i===n&&e){const A=Ie("p",va(h));n.c.push(A),a=[n,A],i=A}else i.c.push(va(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(o[3]||o[4]){const A=Ie("pre",o[4]?oh(o[4]):Ie("code",oh(o[3]),o[2]?{language:`language-${o[2].toLowerCase()}`}:{}));n.c.push(A),a=[n],i=n}else if(o[6]){const A=o[6],f=A!==">",p=!!A.match(/\./),g=f?p?"ol":"ul":"blockquote",m=o[5].split(`
`).map(y=>y.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(y=>y.trim()!==""),V=Ie(g,f?m.map(y=>Ie("li",ys(y).c)):ys(m.join(`
`)).c);n.c.push(V),a=[n,V],i=n}else if(o[8]){const A=Ie("img",[],{src:o[8],...o[7]?{alt:o[7]}:{}});if(e&&i===n){const f=Ie("p",A);n.c.push(f),i=f,a=[n,f]}else l(A,!1)}else if(o[10]){const A=a.find(f=>f.t==="a");A&&(A.p.href=o[11])}else if(o[9])l(Ie("a"));else if(o[14]){const A="h"+o[14].length;n.c.push(Ie(A,ys(o[15]).c)),a=[n],i=n}else if(o[13])n.c.push(Ie("h1",ys(o[12]).c)),a=[n],i=n;else if(o[16])l(Ie("code",o[16]),!1);else if(o[17]?.[0]===`
`||o[17]===`  
`){if(!(a[1]?.t==="p")){const p=n.c;let g;for(g=p.length-1;g>=0&&!Gv(p[g]);g--);if(g!==n.c.length-1){const m=n.c.splice(g+1);n.c.push(Ie("p",m))}}const f=Ie("p");n.c.push(f),a=[n,f],i=f}else if(o[1])n.c.push(Ie("hr")),a=[n],i=n;else if(o[17]){const A=o[17].length===2?"strong":"em";a.findIndex(p=>p.t===A)===-1?l(Ie(A)):c(A)}}}const u=va(t.substring(s));if(u.length){const h=n.c.at(-1);let A;h?.t==="p"?A=h:e?(A=Ie("p"),n.c.push(A)):A=n,A.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},Wv=(t,e={})=>{const r={...Hv,...e},s=(n,i=0)=>{const a=n.t===""?I.Fragment:r[n.t];return I.createElement(a,{...n.p,key:i},n.c.length===0?void 0:n.c.map((o,l)=>typeof o=="string"?o:s(o,l)))};return s(ys(t,!0))},Uv=({markdown:t,customComponents:e})=>Wv(t,e),Yv={h2:function({children:e}){return d.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${ve}`,children:d.jsx(rt,{children:e})})},h3:function({children:e}){return d.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:d.jsx(rt,{children:e})})},blockquote:function({children:e}){return d.jsx("blockquote",{className:"mt-1 mb-1 text-moss zx:text-zxBlue clear-both",children:d.jsxs(rt,{children:["> ",e]})})},p:function({children:e}){return d.jsx("div",{className:`mb-1 last:mb-0 ${ve}`,children:d.jsx(rt,{children:e})})},a:function({children:e,href:r}){return d.jsx("a",{className:"text-white zx:text-zxWhite bg-metallicBlue hover:bg-white hover:text-metallicBlue zx:bg-zxBlue inline-block pl-oneScaledPix pt-oneScaledPix",href:r,target:"_blank",rel:"noopener noreferrer",children:d.jsx(rt,{children:e})})},li:function({children:e}){return d.jsx("div",{className:`mb-1 clear-both ${ve}`,children:d.jsxs(rt,{children:[d.jsx(O,{className:"text-metallicBlue zx:text-zxYellow",children:"â€¢"}),e]})})},strong:function({children:e}){return d.jsx(rt,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return d.jsx(rt,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=Ns();if(e===void 0)throw new Error("image without src");const s=e.split(/\?|&/);return d.jsx("span",{style:{"--scale":r*2},children:d.jsx("span",{className:Oe("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",s.join(" "))})})},hr:function(){return d.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 mb-1 border-none"})}},ht=({markdown:t,className:e})=>d.jsx("div",{className:`contents ${e}`,children:d.jsx(Uv,{customComponents:Yv,markdown:t})}),lh=4,ch=kt.h,SA=()=>{const t=Ns(),e=I.useRef(null),r=I.useCallback(s=>{if(e.current===null)return;const{scrollTop:n,scrollLeft:i}=e.current,a=me[s],o=n+t*lh*-a.y*ch,l=i+t*lh*a.x*ch;e.current.scrollTo({left:l,top:o,behavior:"instant"})},[t]);return $e({handler:I.useCallback(()=>{r("towards")},[r]),action:"towards"}),$e({handler:I.useCallback(()=>{r("away")},[r]),action:"away"}),$e({handler:I.useCallback(()=>{r("left")},[r]),action:"left"}),$e({handler:I.useCallback(()=>{r("right")},[r]),action:"right"}),e},uh=({pageName:t})=>{const e=vv[t],r=SA();return d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Ye)}),d.jsxs(De,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:H(Ye),children:[d.jsxs("div",{className:Oe("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[Xt()&&d.jsx(ai,{className:"pb-1"}),d.jsx(ht,{markdown:e})]}),d.jsx(Ne,{className:"hidden",children:d.jsx(tr,{})})]})]})},hh={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},Xv={egyptus:"texture-crown.egyptus",blacktooth:"texture-crown.blacktooth",bookworld:"texture-crown.bookworld",penitentiary:"texture-crown.penitentiary",safari:"texture-crown.safari"},hs=({planet:t,className:e,label:r=t})=>{const s=ae(i=>i.gameMenus.planetsLiberated[t]),n=Bo();return d.jsxs("div",{className:`flex flex-col ${e}`,children:[d.jsx("span",{className:`sprite block ${Xv[t]} ${s?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),d.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${s?"":"colourised:brightness-halfBrite"} ${hh[t][0]}`}),d.jsx(O,{classnameCycle:n?hh[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${s?"":"colourised:brightness-halfBrite"}`,children:r})]})},$v=()=>d.jsxs(d.Fragment,{children:[d.jsx(O,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),d.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[d.jsx(hs,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(hs,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(hs,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(hs,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(hs,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),fl=I.createContext(null),Kv=({children:t})=>{const[e,r]=I.useState(0),s=I.useCallback(()=>r(i=>i+1),[]),n=I.useCallback(()=>r(i=>i-1),[]);return d.jsx(fl,{value:{count:e,loadingStarted:s,loadingFinished:n},children:t})},Qv=()=>{const t=I.useContext(fl);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t},Zv=()=>{const t=I.useContext(fl);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t.count>0},Jv="/assets/rock-C4e7VvX5.mp3",e0=({playMusic:t=!1})=>{const e=Zv(),r=H(Ye);return d.jsxs(Je,{children:[e?d.jsx(Kh,{}):d.jsx(gt,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsxs(De,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,children:[t&&d.jsx("audio",{src:Jv,autoPlay:!0,loop:!0}),d.jsx($v,{}),d.jsx(Ne,{className:"hidden",children:!e&&d.jsx(tr,{})})]})]})},Wt=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],t0=()=>d.jsx(d.Fragment,{children:d.jsxs("div",{className:"flex justify-center gap-2 resHandheld:gap-1 leading-none",children:[d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(O,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(O,{classnameCycle:Wt,children:"Jon"}),d.jsx(O,{classnameCycle:Wt,children:"Ritman"})]}),d.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(O,{classnameCycle:Wt,children:"Bernie"}),d.jsx(O,{classnameCycle:Wt,children:"Drummand"})]})]})]}),d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(O,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),d.jsx("address",{className:"flex",children:d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[d.jsx(O,{classnameCycle:Wt,children:"Jim"}),d.jsx(O,{classnameCycle:Wt,children:"Higson"})]})})]})]})}),Al=({noSubtitle:t,className:e})=>d.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[d.jsxs("h1",{className:"flex",children:[d.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[d.jsx(O,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),d.jsxs("div",{className:"mt-1 resHandheld:mt-0 relative",children:[d.jsx("span",{className:"sprite zx:sprite-revert-to-white texture-animated-head.idle.right hover:texture-animated-head.walking.right relative z-topSprite"}),d.jsx("span",{className:"sprite zx:hidden texture-shadow.smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})]}),d.jsx(O,{classnameCycle:Wt,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),d.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[d.jsx(O,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),d.jsxs("div",{className:"mt-1 resHandheld:mt-0 relative",children:[d.jsx("span",{className:"sprite zx:sprite-revert-to-white texture-heels.walking.towards.2 hover:texture-animated-heels.walking.towards relative z-topSprite"}),d.jsx("span",{className:"sprite zx:hidden texture-shadow.smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})]})]}),t||d.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[d.jsx(O,{className:"text-midRed zx:text-zxCyan",children:"block"}),d.jsx(O,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),d.jsx(O,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),d.jsx(O,{className:"text-moss zx:text-zxWhite",children:"ing"}),d.jsx(O,{classnameCycle:Wt,children:" remake"})]})]}),r0=()=>{const[t,e]=I.useReducer(r=>!r,!1);return d.jsxs("div",{onClick:e,className:"flex bg-metallicBlueHalfbrite text-metallicBlue justify-end absolute bottom-0 right-2 z-dialog",children:[!t&&d.jsx(O,{children:"*"}),t&&d.jsxs(O,{children:["cf8b03c","2025-04-11"]})]})},s0=()=>{const t=Gr();return d.jsx(O,{children:t?"Resume the game":"Play the game"})},n0=()=>d.jsx(Q,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:H(Ct,"installGuide")}),i0=()=>{const t=Gr();return d.jsx(Q,{id:"quitGame",label:"Quit",className:"text-midRed zx:text-zxYellow",onSelect:H(Ct,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},dh="https://discord.gg/Se5Jznc2jm",a0=t=>{const e=Gr(),r=H(Ct,"crowns"),s=H(Ct,"score"),n=I.useCallback(()=>{r(),s()},[r,s]);return d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),d.jsxs(De,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[d.jsx(Al,{noSubtitle:e,className:e?"resHandheld:hidden":""}),d.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[d.jsxs(Ne,{className:"w-max mx-auto",children:[d.jsx(Q,{id:"playGame",label:d.jsx(s0,{}),doubleHeightWhenFocussed:!0,onSelect:H(Wx)}),d.jsx(Q,{id:"map",label:"use the Map",onSelect:H(Ct,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),d.jsx(Q,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e}),d.jsx(i0,{})]}),d.jsxs("div",{className:"flex flex-row justify-center gap-2",children:[d.jsxs(Ne,{children:[d.jsx(Q,{id:"modernisationOptions",label:"Options",doubleHeightWhenFocussed:!0,onSelect:H(Ct,"modernisationOptions")}),d.jsx(Q,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:H(Ct,"readTheManual")})]}),d.jsxs(Ne,{children:[xg()||d.jsx(n0,{}),d.jsx(Q,{id:"discord",leader:d.jsx(O,{children:qd}),label:d.jsx("a",{href:dh,target:"_blank",children:d.jsx(O,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:I.useCallback(()=>{window.open(dh,"_blank")},[])})]})]}),d.jsx(Ne,{})]}),!e&&d.jsx(t0,{})]}),d.jsx(r0,{})]})},oi=({className:t})=>d.jsx("div",{className:Oe("contents",t),children:d.jsx(ss.Placeholder,{})}),o0=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midRed zx:bg-zxYellow"}),d.jsx(De,{className:"bg-white zx:bg-zxRed",children:d.jsxs(ss.Provider,{children:[d.jsx(Al,{noSubtitle:!0}),d.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center",children:[d.jsx(O,{className:"sprites-double-height mt-2 resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),d.jsxs(Ne,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"no",label:"No",onSelect:H(Ye),hint:"Go back to the game"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"yes",label:"Yes",onSelect:H(tf,{offerReincarnation:!1}),hint:d.jsx(ht,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"})})]}),d.jsx(oi,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})]})})]}),CA=Qr(()=>Kr(()=>import("./campaign-CtabydHx.js"),__vite__mapDeps([6,7,4,5]))),fh=(t,e)=>t*160+e*1e4,l0=()=>{const{campaign:t}=I.use(CA()),e=ae(kg),r=ae(({gameMenus:{roomsExplored:o}})=>Ga(Ue(Yn(o)))),s=fh(r,e),n=Ga(Ad(t.rooms)),i=fh(n,5),a=s<8e3?"dummy":s<2e4?"novice":s<3e4?"spy":s<55e3?"master-spy":s<84e3?"hero":s<i?"liberator":"completionist";return d.jsxs(d.Fragment,{children:[d.jsx(Al,{noSubtitle:!0,className:"resHandheld:hidden"}),d.jsx(O,{classnameCycle:Wt,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:a}),d.jsxs("div",{className:`contents ${ve}`,children:[d.jsxs(O,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",s.toLocaleString()]}),d.jsxs(O,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",n," rooms"," ",`(${(100*r/n).toFixed(1)}%)`]}),d.jsxs(O,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),d.jsx(Ne,{className:"hidden",children:d.jsx(tr,{})})]})]})},c0=()=>d.jsx(Je,{children:d.jsxs(I.Suspense,{fallback:d.jsxs(d.Fragment,{children:[d.jsx(Kh,{}),d.jsx(De,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[d.jsx(gt,{className:"bg-metallicBlue zx:bg-zxCyan"}),d.jsx(De,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:H(Ye),children:d.jsx(l0,{})})]})}),xr="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",u0=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:xr,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:xr,children:"Cursor"}),"â¬‡"]});case"ArrowUp":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:xr,children:"Cursor"}),"â¬†"]});case"ArrowLeft":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:xr,children:"Cursor"}),"â¬…"]});case"ArrowRight":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:xr,children:"Cursor"}),"âž¡"]});default:return t}},h0=t=>t===0?"â¬…âž¡":t===1?"â¬†â¬‡":`axis${t}`,d0=t=>{switch(yc[t]){case"dPadDown":return"d-Padâ¬‡";case"dPadUp":return"d-Padâ¬†";case"dPadLeft":return"d-Padâ¬…";case"dPadRight":return"d-Padâž¡";case"a":return d.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return d.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return d.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return d.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return yc[t]??t},pl=({action:t,keyClassName:e,className:r,flashingCursor:s=!1})=>{const n=ae(a=>a.gameMenus.assigningInput?.action===t?a.gameMenus.assigningInput?.presses:Pn(a).presses[t]),i=ae(a=>{const o=af(t);return o===void 0?Fn:a.gameMenus.assigningInput?.action===t?a.gameMenus.assigningInput.axes:Pn(a).axes[o.axis]});return d.jsxs("div",{className:r,children:[n.keys.map(a=>d.jsx("span",{className:Oe("text-nowrap",e),children:d.jsx(rt,{children:u0(a)})},`key:${a}`)),i.map(a=>d.jsx("span",{className:Oe("text-nowrap",e),children:d.jsxs(rt,{children:[d.jsx("span",{className:xr,children:"ðŸ•¹"}),h0(a)]})},`gamePadAxis:${a}`)),n.gamepadButtons.map(a=>d.jsx("span",{className:Oe("text-nowrap",e),children:d.jsxs(rt,{children:[d.jsx("span",{className:xr,children:"ðŸ•¹"}),d0(a)]})},`gamePadButton:${a}`)),s&&d.jsx("span",{className:"sprite texture-hud.char.space bg-[currentColor] animate-flash"})]})},f0=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>d.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:ft()==="desktop"?d.jsxs(d.Fragment,{children:[d.jsx(O,{className:"me-1",children:"Press"}),d.jsx(O,{className:Oe("me-1",r),children:t}),d.jsx(O,{children:"to continue"}),d.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[d.jsx(O,{children:"("}),d.jsx(pl,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),d.jsx(O,{children:")"})]})]}):d.jsxs(d.Fragment,{children:[d.jsx(O,{className:Oe("me-1",r),children:"Tap"}),d.jsx(O,{children:"to continue"})]})}),A0=()=>d.jsx(Je,{children:d.jsxs(De,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:H(Ye),children:[d.jsx(O,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),d.jsx("span",{className:"zx",children:d.jsx(f0,{className:`${ve} px-1`,action:"hold"})})]})});function MA(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=MA(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function p0(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=MA(t))&&(s&&(s+=" "),s+=e);return s}const jr=({className:t,value:e,onClick:r})=>d.jsx(O,{onClick:s=>r?.(s,!e),className:p0("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed",t),noSlitWords:!0,children:e?"  ON":"OFF "}),PA="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",TA="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",_a="[&_.em]:text-lightBeige zx:[&_.em]:text-zxCyan",m0=`![](texture-animated-head.walking.towards?float-right)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,g0=`pokes canâ€™t be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,x0="everything to *select the keys* and other input settings",y0=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:H(Ye)}),d.jsx(De,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:d.jsx(ss.Provider,{children:d.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+TA,children:[Xt()&&d.jsx(ai,{className:"text-highlightBeige"}),d.jsx(O,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),d.jsxs(Ne,{className:PA,children:[d.jsx(Q,{id:"controlOptions",label:"Control options",doubleHeightWhenFocussed:!0,onSelect:H(Ct,"controlOptions"),hint:d.jsx(ht,{className:_a,markdown:x0})}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:d.jsx(jr,{value:Bo()}),onSelect:H(Ut,"userSettings.displaySettings.uncolourised"),hint:d.jsx(ht,{className:_a,markdown:m0})}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"livesModel",label:"âˆž Lives poke",hint:d.jsx(ht,{className:_a,markdown:g0}),valueElement:d.jsx(jr,{value:ae(Id)}),onSelect:H(Ut,"userSettings.infiniteLivesPoke"),disabled:Gr()}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"infiniteDoughnutsPoke",label:"âˆž doughnuts poke",valueElement:d.jsx(jr,{value:ae(Rd)}),onSelect:H(Ut,"userSettings.infiniteDoughnutsPoke"),disabled:Gr()}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"showFps",label:"Show FPS",valueElement:d.jsx(jr,{value:ae(qg)}),onSelect:H(Ut,"userSettings.showFps"),hint:"show frame rate (frames per second) in the top-right corner"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"crtFilter",label:"CRT TV effect",valueElement:d.jsx(jr,{value:ae(_g)}),onSelect:H(Ut,"userSettings.displaySettings.crtFilter"),hint:"Subtle screen glow a bit like an old tv"}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:H(Ct,"emulatedResolution")}),d.jsx(ii,{}),Xt()||d.jsx(tr,{})]}),Xt()||d.jsx(oi,{className:"text-moss zx:text-zxGreen"})]})})})]}),Ah="text-pink zx:text-zxCyan",V0=()=>{const t=ae(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:d.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${ve} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[d.jsx(O,{children:"Press "}),d.jsx(pl,{className:`inline ${Ah}`,action:"menu_openOrExit",keyClassName:"me-1"}),d.jsx(O,{children:"when done selecting keys for "}),d.jsx(O,{className:Ah,children:t})]})},et="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow",b0="**world**: Control is relative to directions in the isometric world",q0=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but requires inputting diagonals a lot`,w0=({className:t})=>d.jsxs("span",{children:[d.jsx(O,{className:Oe("text-nowrap me-1","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:Tn()?"screen":"world"}),d.jsx(O,{className:Oe("text-nowrap","text-moss zx:text-zxBlue selectedMenuItem:text-mossHalfbrite zx:selectedMenuItem:text-zxBlue",t),children:Tn()?"â¬… âž¡ â¬† â¬‡":"â†– â†˜ â†— â†™"})]}),v0=()=>{const t=Tn();return d.jsx(Q,{id:"screenRelativeControl",label:"input axes",leader:d.jsx("span",{className:`${et} ${t?"texture-heels.walking.towardsRight.2 selectedMenuItem:texture-animated-heels.screenDirections":"texture-heels.walking.right.2 selectedMenuItem:texture-animated-heels.worldDirections"}`}),valueElement:d.jsx(w0,{}),onSelect:H(Ut,"userSettings.screenRelativeControl"),hintInline:!0,hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:t?q0:b0})})},EA="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",_0="**4-way**: true to the 1987 original - move in x directions only",k0="**8-way**: the original with *4-way* movement, plus *diagonals*",S0="**analogue**: move in *any* direction with analogue stick",C0=()=>{const t=Bd();return d.jsx(Q,{id:"analogueControl",label:"Directions",leader:d.jsx("span",{className:`${et} texture-joystick`}),valueElement:d.jsx(O,{className:EA,children:t}),onSelect:H($x),hintInline:!0,hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:t==="analogue"?S0:t==="8-way"?k0:_0})})},qt=({className:t,action:e})=>{const r=ae(s=>s.gameMenus.assigningInput?.action===e);return d.jsx(pl,{className:Oe("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:EA,flashingCursor:r})},M0=({className:t})=>{const e=ae(bg);return d.jsx(O,{className:Oe("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},P0=()=>{const t=Tn();return d.jsxs(d.Fragment,{children:[d.jsx(Q,{id:"preset",label:d.jsx(O,{className:`inline-block w-6 ${ve}`,children:"key/ button preset"}),valueElement:d.jsx(M0,{}),onSelect:H(Ct,"inputPreset")}),d.jsx(Q,{id:"left",label:`Left ${t?"â¬…":"â†–"}`,leader:d.jsx("span",{className:`${et} ${t?"texture-head.walking.towardsLeft.2 selectedMenuItem:texture-animated-head.walking.towardsLeft":"texture-head.walking.left.2 selectedMenuItem:texture-animated-head.walking.left"}`}),valueElement:d.jsx(qt,{action:"left"}),onSelect:H(yt,"left")}),d.jsx(Q,{id:"right",label:`Right ${t?"âž¡":"â†˜"}`,leader:d.jsx("span",{className:`${et} ${t?"texture-head.walking.awayRight.2 selectedMenuItem:texture-animated-head.walking.awayRight":"texture-head.walking.right.2 selectedMenuItem:texture-animated-head.walking.right"}`}),valueElement:d.jsx(qt,{action:"right"}),onSelect:H(yt,"right")}),d.jsx(Q,{id:"up",label:`Up ${t?"â¬†":"â†—"}`,leader:d.jsx("span",{className:`${et} ${t?"texture-head.walking.awayLeft.2 selectedMenuItem:texture-animated-head.walking.awayLeft":"texture-head.walking.away.2 selectedMenuItem:texture-animated-head.walking.away"}`}),valueElement:d.jsx(qt,{action:"away"}),onSelect:H(yt,"away")}),d.jsx(Q,{id:"down",label:`Down ${t?"â¬‡":"â†™"}`,leader:d.jsx("span",{className:`${et} ${t?"texture-head.walking.towardsRight.2 selectedMenuItem:texture-animated-head.walking.towardsRight":"texture-head.walking.towards.2 selectedMenuItem:texture-animated-head.walking.towards"}`}),valueElement:d.jsx(qt,{action:"towards"}),onSelect:H(yt,"towards")}),d.jsxs("div",{className:`${ve} col-span-3`,children:[d.jsx(O,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),d.jsx(O,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),d.jsx(Q,{id:"jump",label:"Jump",leader:d.jsx("span",{className:`${et} texture-spring.released selectedMenuItem:texture-spring.compressed`}),valueElement:d.jsx(qt,{action:"jump"}),onSelect:H(yt,"jump")}),d.jsx(Q,{id:"carry",label:"Carry",leader:d.jsx("span",{className:`${et} texture-bag`}),valueElement:d.jsx(qt,{action:"carry"}),onSelect:H(yt,"carry"),hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:"**heels only**. requires the bag"}),hintInline:!0}),d.jsx(Q,{id:"fire",label:d.jsx(O,{className:`inline-block w-6 ${ve}`,children:"fire dough- nuts"}),leader:d.jsx("span",{className:`${et} texture-doughnuts`}),hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:"**head only**. requires the hooter"}),hintInline:!0,valueElement:d.jsx(qt,{action:"fire"}),onSelect:H(yt,"fire")}),d.jsx(Q,{id:"swop",label:"Swop",valueElement:d.jsx(qt,{action:"swop"}),onSelect:H(yt,"swop"),hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:d.jsxs("span",{className:`${et} texture-blank relative overflow-hidden`,children:[d.jsx("span",{className:`${et} texture-head.walking.towardsRight.2 selectedMenuItem:texture-animated-head.walking.towardsRight absolute right-[50%]`}),d.jsx("span",{className:`${et} texture-heels.walking.towardsRight.2 selectedMenuItem:texture-animated-heels.walking.towardsRight absolute left-[50%]`})]})}),d.jsx(Q,{id:"swopHead",label:d.jsx(O,{className:`inline-block w-6 ${ve}`,children:"Swop to head"}),valueElement:d.jsx(qt,{action:"swop.head"}),onSelect:H(yt,"swop.head"),hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${et} texture-head.walking.towardsRight.2 selectedMenuItem:texture-animated-head.walking.towardsRight`})}),d.jsx(Q,{id:"swopHeels",label:d.jsxs("div",{className:`w-6 ${ve}`,children:[d.jsx(O,{className:"me-1",children:"Swop to"}),d.jsx(O,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:d.jsx(qt,{action:"swop.heels"}),onSelect:H(yt,"swop.heels"),hint:d.jsx(ht,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${et} texture-heels.walking.towardsRight.2 selectedMenuItem:texture-animated-heels.walking.towardsRight`})}),d.jsx(Q,{id:"hold",label:"Pause",valueElement:d.jsx(qt,{action:"hold"}),onSelect:H(yt,"hold")}),d.jsx(Q,{id:"toggleColourisation",label:d.jsx(O,{className:`inline-block w-6 ${ve}`,children:"toggle colour- isation"}),valueElement:d.jsx(qt,{action:"toggleColourisation"}),onSelect:H(yt,"toggleColourisation")})]})},T0=()=>d.jsx(Q,{id:"controlOptions",label:"on-screen controls",valueElement:d.jsx(jr,{value:Pg()}),onSelect:H(Ut,"userSettings.onScreenControls")}),E0=()=>{const t=!Ed();$e({action:"menu_openOrExit",handler:I.useCallback(()=>{be.dispatch(Gx())},[]),disabled:t}),Yw({handler:I.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&Td(be.getState())&&be.dispatch(Ux(e))},[]),disabled:t})},I0=({showAll:t})=>d.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[d.jsx(O,{className:`block mb-1 ${ve}`,children:"Detected that you are on a phone or tablet"}),d.jsx(O,{className:`block mb-1 ${ve}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),d.jsx(O,{className:`block mb-1 text-midRed zx:text-zxRed ${ve} mb-1`,onClick:t,children:"Tap here to show all settings"})]}),ph=PA+" !gap-y-1 !sprites-normal-height",R0=()=>{E0();const[t,e]=I.useState(!Xt()),r=Bd();return d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:H(Ye)}),d.jsxs(De,{tall:!0,wide:!0,className:"bg-white zx:bg-zxWhite pr-0 pl-1",children:[d.jsxs("div",{className:"flex flex-col gap-y-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+TA,children:[Xt()&&d.jsx(ai,{className:"mb-1"}),d.jsx(O,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block",children:"control options"}),d.jsxs(Ne,{className:ph,children:[d.jsx(C0,{}),d.jsx(T0,{}),r!=="4-way"&&t&&d.jsx(v0,{})]}),t?d.jsxs(d.Fragment,{children:[d.jsx(O,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),d.jsxs(Ne,{className:ph,children:[d.jsx(P0,{}),Xt()||d.jsx(tr,{})]})]}):d.jsx(d.Fragment,{children:d.jsx(I0,{showAll:()=>e(!0)})})]}),d.jsx(V0,{})]})]})},B0=({presetName:t})=>d.jsx(Q,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:Hr[t].description,onSelect:H(Yx,t)},t),z0=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Ye)}),d.jsx(De,{className:"bg-white pl-1",children:d.jsxs(ss.Provider,{children:[d.jsx(O,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),d.jsxs(Ne,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[yd(Hr).map(t=>d.jsx(B0,{presetName:t},t)),d.jsx(ii,{}),d.jsx(tr,{})]}),d.jsx(oi,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),j0=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsx(De,{className:"bg-pureBlack w-zx h-full block p-0",onClick:H(Ye),children:d.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[d.jsxs("div",{className:"flex gap-7",children:[d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[d.jsx("span",{className:"sprite texture-crown.blacktooth zx:sprite-revert-zxYellow"}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head.idle.right hover:texture-animated-head.walking.right relative z-topSprite"})]}),d.jsxs("div",{className:"flex flex-col items-center me-1",children:[d.jsx("span",{className:"sprite texture-crown.blacktooth zx:sprite-revert-zxYellow"}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels.walking.towards.2 hover:texture-animated-heels.walking.towards relative z-topSprite"})]})]}),d.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[d.jsx(O,{children:"The people salute your heroism"}),d.jsx(O,{children:"and proclaim you"})]}),d.jsx(O,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),d.jsx(Ne,{className:"hidden",children:d.jsx(tr,{})})]})})]}),F0=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),N0=({resolutionName:t})=>{const e=ae($n),r=Sr[t];return d.jsx(Q,{id:t,label:`${e===t?"* ":""}${F0(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:H(nf,t)},t)},O0=()=>d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Ye)}),d.jsx(De,{className:"bg-white pl-1",children:d.jsxs(ss.Provider,{children:[d.jsx(O,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),d.jsxs(Ne,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[yd(Sr).map(t=>d.jsx(N0,{resolutionName:t})),d.jsx(ii,{}),d.jsx(tr,{})]}),d.jsx(oi,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),L0=()=>{const t=Jr();return d.jsxs(Je,{children:[d.jsx(gt,{className:"bg-midRed zx:bg-zxYellow"}),d.jsxs(De,{className:"bg-white zx:bg-zxRed",children:[d.jsx(O,{className:"sprites-double-height mt-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),d.jsx("span",{className:"sprite texture-animated-fish float-left"}),d.jsx(O,{className:`resHandheld:mt-0 text-redShadow zx:text-zxWhite ${ve}`,children:"Ah, But you ate a Reincarnation Fish! Reincarnate?"}),d.jsxs(Ne,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{t.reincarnateFrom(be.getState().gameMenus.reincarnationPoint),be.dispatch(sf())}}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:H(tf,{offerReincarnation:!1})})]})]})]})},D0=`##The game crashed
Maybe:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord](https://discord.gg/XmV9QNWY)
* play [this](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,H0=({message:t})=>{const e=ae(s=>s.gameMenus.reincarnationPoint!==void 0),r=H(sf);return d.jsxs(Je,{children:[d.jsx(gt,{className:"loading-border"}),d.jsx(De,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",children:d.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[d.jsx(ht,{markdown:D0}),d.jsx(O,{className:`text-midRed ${ve}`,children:t}),d.jsxs(Ne,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${ve}`,children:[d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:H(jc,"ignore")}),e&&d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:r}),d.jsx(Q,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:H(jc,"clearAllData")})]})]})})]})},le={w:16,d:16,h:12},mh={x:16,y:16,z:12},rS=(t,e)=>{const r=Fr(t);return e.x=r.x,e.y=r.y,e},sS=({x:t=0,y:e=0})=>e-t,Fe=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),Te=({x:t=0,y:e=0,z:r=0})=>({x:t*le.w,y:e*le.d,z:r*le.h}),Fr=t=>Fe(Te(t)),Y=48,Yt=36,Is=.6,Sn=Y*((1-Is)/2),gh=Y-Sn,Zt=8,Xr=t=>Math.round(t*10)/10,Rt=t=>{const e=Fe(t);return`translate(${Xr(e.x)},${Xr(e.y)})`},J=t=>{const e=Fe(t);return _t(e)},_t=t=>`${Xr(t.x)},${Xr(t.y)}`,G0=()=>{const t=I.useRef(null);return I.useLayoutEffect(()=>{t.current?.scrollIntoView({behavior:"instant",block:"center"})}),d.jsx("div",{ref:t})},Vs=({className:t,scrollTo:e=!1})=>d.jsxs("foreignObject",{x:-50,y:-100,width:100,height:100,className:t,children:[d.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`}),e&&d.jsx(G0,{})]}),W0=({notableItem:t,className:e})=>{const r=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown.blacktooth":t.config.planet==="egyptus"?"texture-crown.egyptus":t.config.planet==="penitentiary"?"texture-crown.penitentiary":t.config.planet==="safari"?"texture-crown.safari":t.config.planet==="bookworld"?"texture-crown.bookworld":"texture-crown.dark":"texture-block.organic";return d.jsx(Vs,{className:`${e??""} ${r}`})},xh=Y/5,sr=Y/4,Bt={x:Y/2,y:Y/2},ka={1:[Rt(Bt)],2:[Rt(Xe(Bt,{x:-9.6,y:xh})),Rt(Xe(Bt,{x:xh,y:-9.6}))],3:[Rt(Xe(Bt,{x:sr,y:sr})),Rt(Xe(Bt,{x:-12,y:sr})),Rt(Xe(Bt,{x:sr,y:-12}))],4:[Rt(Xe(Bt,{x:-12,y:-12})),Rt(Xe(Bt,{x:-12,y:sr})),Rt(Xe(Bt,{x:sr,y:-12})),Rt(Xe(Bt,{x:sr,y:sr}))]},yh=({children:t,heightAdjust:e=0})=>{const r=t.filter(s=>s!==void 0&&s!==!1);if(r.length>ka.length)throw new Error(`too many items to fit on a square: ${r.length} (max is ${ka.length})`);return d.jsx("g",{transform:`translate(0, ${e})`,children:r.map((s,n)=>d.jsx("g",{transform:ka[r.length][n],children:s},n))})},IA=(t,e,r)=>{if(e==="*")return!0;const s=r.meta.subRooms[e];return t.x>=s.physicalPosition.from.x&&t.y>=s.physicalPosition.from.y&&t.x<=s.physicalPosition.to.x&&t.y<=s.physicalPosition.to.y},RA=({position:t},e,r)=>IA(t,e,r),U0=({state:{position:t}},e,r)=>{const s={x:t.x/le.w,y:t.y/le.d};return IA(s,e,r)},fn=(t,e)=>{const r=e.meta?.subRooms;if(r===void 0)return"*";const s=Ue(Eo(r)).find(n=>U0(t,n,e));if(s===void 0)throw new Error(`${t.id} not found in any subroom of ${e.id} ${JSON.stringify(t.state.position)} ${JSON.stringify(e.meta?.subRooms)}`);return s},Y0=(t,e,r)=>RA(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="pickup"&&t.config.gives!=="scroll"),nr={blacktooth:{bgClassName:"fill-moss zx:fill-zxGreenDimmed text-shadow zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-lightGrey zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-highlightBeige zx:fill-zxGreen text-white zx:text-zxBlack",containerClassName:"bg-highlightBeige zx:bg-zxGreen scrollbar-track-highlightBeige zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},An=t=>{switch(t.hue){case"cyan":return{floor:"fill-pastelBlue zx:fill-zxCyan",awayWall:"fill-pastelBlueHalfbrite zx:fill-zxCyanDimmed"};case"green":return{floor:"fill-moss zx:fill-zxGreen",awayWall:"fill-mossHalfbrite zx:fill-zxGreenDimmed"};case"magenta":return{floor:"fill-pink zx:fill-zxMagenta",awayWall:"fill-pinkHalfbrite zx:fill-zxMagentaDimmed"};case"white":return{floor:"fill-lightGrey zx:fill-zxWhiteDimmed",awayWall:"fill-lightGreyHalfbrite zx:fill-zxBlack"};case"yellow":return{floor:"fill-highlightBeige zx:fill-zxYellow",awayWall:"fill-highlightBeigeHalfbrite zx:fill-zxYellowDimmed"};default:throw t.hue,new Error("unknown hue")}},dt=t=>({x:t.x*Y,y:t.y*Y,z:t.z*Yt}),BA=.15,pn=Fe(dt({x:.5,y:.5,z:0})),Vh=Fe(dt({x:BA,y:0,z:0})),bh=Fe(dt({x:BA*1.66,y:0,z:0})),X0=({className:t})=>d.jsxs(d.Fragment,{children:[d.jsx("ellipse",{className:"fill-white",cx:pn.x,cy:pn.y,rx:Math.abs(bh.x),ry:Math.abs(bh.y)}),d.jsx("ellipse",{className:t,cx:pn.x,cy:pn.y,rx:Math.abs(Vh.x),ry:Math.abs(Vh.y)})]}),mn=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return"texture-animated-head.walking.away";case"towards":return"texture-animated-head.walking.towards";case"left":return"texture-animated-head.walking.left";case"right":return"texture-animated-head.walking.right";case"awayRight":return"texture-animated-head.walking.awayRight";case"towardsRight":return"texture-animated-head.walking.towardsRight";case"towardsLeft":return"texture-animated-head.walking.towardsLeft";case"awayLeft":return"texture-animated-head.walking.awayLeft";default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return"texture-animated-head.idle.towards";case"right":return"texture-animated-head.idle.right";case"awayRight":return"texture-animated-head.idle.awayRight";case"towardsRight":return"texture-animated-head.idle.towardsRight";case"towardsLeft":return"texture-animated-head.idle.towardsLeft";case"away":return"texture-head.walking.away.2";case"left":return"texture-head.walking.left.2";case"awayLeft":return"texture-head.walking.awayLeft.2";default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return"texture-animated-heels.walking.away";case"towards":return"texture-animated-heels.walking.towards";case"left":return"texture-animated-heels.walking.left";case"right":return"texture-animated-heels.walking.right";case"awayRight":return"texture-animated-heels.walking.awayRight";case"towardsRight":return"texture-animated-heels.walking.towardsRight";case"towardsLeft":return"texture-animated-heels.walking.towardsLeft";case"awayLeft":return"texture-animated-heels.walking.awayLeft";default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return"texture-heels.walking.towards.2";case"right":return"texture-heels.walking.right.2";case"awayRight":return"texture-heels.walking.awayRight.2";case"towardsRight":return"texture-heels.walking.towardsRight.2";case"towardsLeft":return"texture-heels.walking.towardsLeft.2";case"away":return"texture-heels.walking.away.2";case"left":return"texture-heels.walking.left.2";case"awayLeft":return"texture-heels.walking.awayLeft.2";default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},qh=ld(Fe({x:Y,y:0})),gn={wall:void 0,open:"0,999",doorway:`${Xr(qh*((1-Is)/2))}, ${Xr(qh*Is)}, 999`},$0=`
M ${J({x:0,y:0})}
L ${J({x:0,y:Y})}
L ${J({x:Y,y:Y})}
L ${J({x:Y,y:0})}
z`,wh=(t,e=Is)=>{const r=Y*((1-e)/2),s=Y-r,n=r,i=t.away!=="wall",a=t.towards!=="wall",o=t.left!=="wall",l=t.right!=="wall",c=i?Y:s,u=a?0:r,h=o?Y:s,A=l?0:r;let f=`
M ${J({})}
L ${J({y:Y})}
L ${J({x:Y,y:Y})}
L ${J({x:Y})}
M ${J({x:A,y:u})}
L ${J({x:A,y:c})}
L ${J({x:h,y:c})}
L ${J({x:h,y:u})}
L ${J({x:A,y:u})}
z`;const p=`
l ${J({x:n})}
l ${J({y:n})}
l ${J({x:-n})}
z`;return a&&l&&(f+=`
M 0, 0    
${p}`),l&&i&&(f+=`
M ${J({y:s})}
${p}`),i&&o&&(f+=`
M ${J({x:s,y:s})}    
${p}`),o&&a&&(f+=`
M ${J({x:s})}    
${p}`),f},vh=t=>{const e=`
M ${J({x:0,y:Y})}
L ${J({x:0,y:Y,z:Yt})}
L ${J({x:Y,y:Y,z:Yt})}
L ${J({x:Y,y:Y})}
z
`;return t?e+`
M ${J({x:Sn,y:Y})}
L ${J({x:Sn,y:Y,z:Yt})}
L ${J({x:gh,y:Y,z:Yt})}
L ${J({x:gh,y:Y})}
L ${J({x:Sn,y:Y})}
  `:e},K0=`            
M ${J({x:Y,y:Y,z:Yt})}            
L ${J({x:Y,y:Y})}            
M ${J({x:Y,y:0,z:Yt})}            
L ${J({x:Y,y:0})}            
M ${J({x:0,y:Y,z:Yt})}            
L ${J({x:0,y:Y})}            
M ${J({x:0,y:0,z:Yt})}            
L 0, 0            
`,Q0=(t,e,r)=>I.useMemo(()=>{let s=!1,n=!1,i=!1;return[...Ue(To(t.items)).filter(([o])=>!e[o]).map(([o,l])=>l).filter(o=>{if(o.type==="hushPuppy"){if(s)return!1;s=!0}if(o.type==="teleporter"){if(n)return!1;n=!0}if(o.type==="pickup"&&o.config.gives==="crown"){if(i)return!1;i=!0}return!0}).filter(o=>Y0(o,r,t))]},[t,e,r]),Z0=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:s,roomVisited:n,hasHead:i,hasHeels:a,hasHeadOverHeels:o})=>{const{id:l,roomAbove:c,roomBelow:u,color:h}=s,A=Q0(s,r,e);return d.jsxs("g",{"data-room-id":l,strokeWidth:3,className:"[--scale:2]",children:[u===void 0?d.jsx("path",{className:"fill-white",d:$0}):d.jsx("path",{className:"fill-white",fillRule:"evenodd",d:wh(t,Is*.7)}),d.jsx("path",{className:An(h).floor,fillRule:"evenodd",d:wh(t)}),c&&d.jsxs(d.Fragment,{children:[d.jsx("path",{className:An(h).awayWall,fillRule:"evenodd",d:vh(t.away==="doorway")}),d.jsx("path",{className:An(h).floor,fillRule:"evenodd",transform:"scale(-1, 1)",d:vh(t.left==="doorway")})]}),d.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[d.jsx("path",{d:`M ${J({x:0,y:Y})} L 0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:gn[t.right]}),d.jsx("path",{d:`M ${J({x:Y,y:0})} L ${J({x:Y,y:Y})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:gn[t.left]}),d.jsx("path",{d:`M ${J({x:Y,y:0})} L 0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:gn[t.towards]}),d.jsx("path",{d:`M ${J({x:0,y:Y})} L ${J({x:Y,y:Y})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:gn[t.away]})]}),n&&d.jsx(X0,{className:`${An(h).floor}`}),d.jsxs(yh,{heightAdjust:14,children:[i&&d.jsx(Vs,{className:`${a?"[--scale:1.5]":"[--scale:2.5]"}
              ${mn({character:"head",action:i.current?"walking":"idle",facingXy8:i.facingXy8})}`,scrollTo:i.current}),a&&d.jsx(Vs,{className:`${i?"[--scale:1.5]":"[--scale:2.5]"}
            ${mn({character:"heels",action:a.current?"walking":"idle",facingXy8:a.facingXy8})}`,scrollTo:a.current})]}),o&&d.jsxs("g",{transform:"translate(0,-16)",className:"[--scale:1.5]",children:[d.jsx(Vs,{className:mn({character:"heels",action:"walking",facingXy8:o.facingXy8})}),d.jsx("g",{transform:"translate(0, -20)",children:d.jsx(Vs,{className:mn({character:"head",action:"walking",facingXy8:o.facingXy8}),scrollTo:!0})})]}),!i&&!a&&!o&&d.jsx(yh,{heightAdjust:11,children:A.map((f,p)=>{const g=f.type==="hushPuppy"||f.type==="teleporter";return d.jsx(W0,{notableItem:f,className:g?"[--scale:1.25]":"[--scale:1.5]"},p)})}),c&&d.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:K0})]})},J0=t=>{const e=Fe(t);return`translate(${e.x}, ${e.y})`},e_=({campaign:t,pickupsCollected:e,gridPositions:r,currentCharacterName:s,playerLocations:n,background:i,mapBounds:a,containerWidth:o,roomsExplored:l})=>{const c=a.r-a.l+2*Zt,u=a.b-a.t+2*Zt,h=Object.values(r);return d.jsxs("svg",{className:"w-full",style:{minWidth:`${c}px`,height:`${u}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[i,d.jsx("g",{transform:`translate(${-a.l+Zt+(o-c)/2},${-a.t+8})`,children:h.map(A=>{const{roomId:f,subRoomId:p,gridPosition:g}=A,m=n.head&&f===n.head.roomId&&p===n.head.subRoomId?{current:s==="head",facingXy8:n.head.facingXy8}:void 0,V=n.heels&&f===n.heels.roomId&&p===n.heels.subRoomId?{current:s==="heels",facingXy8:n.heels.facingXy8}:void 0,y=n.headOverHeels&&f===n.headOverHeels.roomId&&p===n.headOverHeels.subRoomId?{facingXy8:n.headOverHeels.facingXy8}:void 0,q=`${f}/${p}`;return d.jsx("g",{"data-id":q,transform:J0(dt(g)),children:d.jsx(Z0,{roomGridPositionSpec:A,roomPickupsCollected:e[f]??pe,roomJson:t.rooms[f],hasHead:m,hasHeels:V,hasHeadOverHeels:y,roomVisited:l[f]??!1})},q)})})]})},t_=["head","heels"],r_=[...t_,"headOverHeels"],Vo=t=>t==="head"?"heels":"head",Ce=(...t)=>e=>t.includes(e.type),s_=Ce("bubbles","stopAutowalk","floorEdge","firedDoughnut"),n_=(t,e)=>s_(t)||l_(t)&&(e!==void 0&&jA(e)||t.config.direction.z!==0)||u_(t)&&t.config.type==="none",_h=(t,e)=>!n_(t,e),i_=t=>(t.type==="movingPlatform"||t.type==="pushableBlock")&&t.config.style==="stepStool",nS=(t,e,r=!1)=>FA(e)&&!(!r&&jA(e)&&e.state.autoWalk)&&!(c_(t)&&i_(e)),zA=["ball","slidingBlock","slidingDeadly"],iS=Ce(...zA),a_=["portableBlock","spring","sceneryPlayer"],aS=Ce(...a_),jA=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function FA(t){return NA.includes(t.type)}const NA=[...r_,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer"],o_=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],oS=t=>Ce(...o_)(t)||t.type==="floor"&&t.config.type==="deadly",lS=t=>t.config.times!==void 0,l_=Ce("portal"),cS=Ce("teleporter");Ce("heels");Ce("head");const uS=Ce("heels","headOverHeels"),hS=Ce("head","headOverHeels"),c_=Ce("lift"),dS=Ce("monster"),u_=Ce("floor"),fS=Ce("pickup"),AS=Ce("spring"),pS=Ce("joystick"),mS=Ce("monster","movingPlatform"),OA=Ce("head"),LA=Ce("heels"),Hn=Ce("headOverHeels"),er=(t,e)=>t.characterRooms[e]?.items[e],gS=t=>er(t,t.currentCharacterName),xS=t=>{if(OA(t))return t.state;if(Hn(t))return t.state.head},yS=t=>{if(LA(t))return t.state;if(Hn(t))return t.state.heels},h_=(t,e)=>{const r=er(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&OA(r)||e==="heels"&&LA(r))return r.state;if(e==="head"&&Hn(r))return r.state.head;if(e==="heels"&&Hn(r))return r.state.heels}},VS=h_,tt={x:12,y:12,z:le.h},d_={x:14,y:14,z:le.h},Br={x:16,y:16,z:le.h},Cn={...tt,z:le.h*2},DA=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:tt};case"slidingBlock":return t.config.style==="book"?{aabb:Br}:{aabb:tt};case"lift":return{aabb:{...tt,z:tt.z}};case"switch":return{aabb:{...tt,z:tt.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:tt};case"charles":return{aabb:Cn};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:Br};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:Br};case"tower":return{aabb:{x:11,y:11,z:le.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...tt,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:Cn};case"helicopterBug":case"dalek":return{aabb:tt};default:return{aabb:Br}}case"deadlyBlock":case"spikes":return{aabb:Br};case"bubbles":return{aabb:tt};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:Br};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:le.h}:{x:15,y:3,z:le.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:Cn}:{aabb:tt};default:return{aabb:d_}}},bo=(t,e)=>{const r={x:1,y:1,z:1,...e},s=Mn(mh,t);return Mn(Mp(r,mh),s)},je={renders:!0,aabb:tt},f_=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,Re=Xn/1e3,bS={head:15e-5,heels:15e-5},qS=1e3/110,wS=240,A_=2e-4,p_={head:le.h*2/1e3,others:le.h*6/1e3},vS=A_*.35,_S=p_.others*.5,kS=.8,SS=.001,CS={head:Re,heels:2*Re,charles:Re,dalek:Math.SQRT2*Re,bubbleRobot:(Math.SQRT2+1)/2*Re,cyberman:1*Re,skiHead:Re,helicopterBug:Re,homingBot:2*Re,monkey:Re,elephant:Re,elephantHead:0,emperor:Re,emperorsGuardian:Math.SQRT2*Re,computerBot:Re,turtle:Re,ball:2*Re,firedDoughnut:2*Re,movingPlatform:Re},m_=(t=1)=>t*Xn/1e3,MS=m_(),PS=2,kh=1.1,TS={head:le.h*2.6+kh,heels:le.h+kh},li=11,ES=6e4,IS=9999,g_=8,RS=750,BS=2500,zS=200,jS=8,HA=50,Sa=le.h*2,x_=4,xn=le.h*4;function*y_(t,e){const{config:{direction:r},position:s}=t,n=Co(r),i=Mo(n),a=f_(t),o={...ge,[i]:a?-.5:0},l=1,c={[i]:a?-1:0},u={[i]:l*le.w},h=9,A=8,f=8;yield{...t,...je,type:"doorFrame",id:`${e}/far`,config:{...t.config,inHiddenWall:a,part:"far"},state:{position:Te(Ae(s,{[n]:1.5},o,c)),expires:null,stoodOnBy:pe,disappear:null},aabb:Ae({[n]:A,[i]:f,z:xn},u)},yield{...t,...je,type:"doorFrame",id:`${e}/near`,config:{...t.config,inHiddenWall:a,part:"near"},state:{position:Te(Ae(s,o,c)),expires:null,stoodOnBy:pe,disappear:null},aabb:Ae({[n]:h,[i]:f,z:xn},u)},yield{...t,...je,type:"doorFrame",id:`${e}/top`,config:{...t.config,inHiddenWall:a,part:"top"},state:{position:Ae(Te(Ae(s,o,c)),{[n]:h,z:Sa}),expires:null,stoodOnBy:pe,disappear:null},aabb:Ae({[n]:2*le.w-h-A,[i]:f,z:xn-Sa},u)},yield{...t,...je,type:"wall",id:`${e}/wall`,config:{style:"none",direction:"away",tiles:[]},renders:!1,state:{position:Ae(Te(Ae(s,o)),{z:xn}),expires:null,stoodOnBy:pe,disappear:null},aabb:Te({[n]:2,[i]:.5,z:li-x_-s.z})},yield{...t,...je,type:"portal",id:`${e}/portal`,config:{...t.config,inHidden:a,relativePoint:Te({...ge,[i]:a?.25:-.25}),direction:me[r]},renders:!1,state:{position:Ae(Te(Ae(s,{[i]:a?-.5:.5})),{[n]:h}),expires:null,stoodOnBy:pe,disappear:null},aabb:{[n]:2*le.w-h-A,[i]:0,z:Sa}},s.z!==0&&(yield{...t,...je,type:"doorLegs",id:`${e}/legs`,config:{...t.config,inHiddenWall:a,style:"none",side:"away",height:s.z},renders:!0,shadowCastTexture:a?"shadow.door.floatingThreshold.double.y":void 0,shadowMask:{spriteOptions:{textureId:a?"shadowMask.door.floatingThreshold.double.y":"shadowMask.door.legs.threshold.double.y",flipX:n==="x"},relativeTo:"top"},state:{position:{...Te(Ae(s,o,c)),z:0},expires:null,stoodOnBy:{},disappear:null},aabb:Ae(Te({[n]:2,[i]:.5,z:s.z}),u)}),yield{type:"stopAutowalk",id:`${e}/stopAutowalk`,renders:!1,aabb:Te({[n]:2,[i]:0,z:2}),config:{},state:{position:Te(Mn(s,ad(me[r],.75))),expires:null,stoodOnBy:pe,disappear:null}}}const qo=t=>{const e=Te(t.position),{aabb:r}=DA(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:Ae(e,{x:le.w-r.x>>1,y:le.d-r.y>>1})},vr=()=>({expires:null,stoodOnBy:{},disappear:null}),Rs=()=>({standingOnItemId:null,vels:{gravity:ge,movingFloor:ge},latentMovement:[],actedOnAt:{roomTime:Ke,by:pe},collidedWith:{roomTime:Ke,by:pe}}),V_=t=>{const e=NA.includes(t.type);return{...vr(),position:qo(t),...e?{standingOnItemId:null,vels:{gravity:ge,movingFloor:ge,...zA.includes(t.type)?{sliding:ge}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:ge}:{}},latentMovement:[],actedOnAt:{roomTime:Ke,by:Fn},collidedWith:{roomTime:Ke,by:Fn}}:{},...t.type==="monster"?{activated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:me[t.config.startDirection]}:{facing:me.towards}}:{},...t.type==="pickup"?{collected:!1,disappear:"onTouchByPlayer"}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",facing:me[t.config.startDirection]}:{},...t.type==="switch"?{setting:"left",touchedOnProgression:-1}:{},...t.type==="block"?{disappear:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappear:t.config.disappearing??null}:{},...t.type==="barrier"?{disappear:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:ge}}:{},...t.type==="charles"?{facing:me.towards}:{}}},Gn={config:pe,shadowCastTexture:"shadow.smallRound",aabb:tt},Bs=()=>{const t=Id(be.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:me.towards,walkStartFacing:me.towards,walkDistance:0,vels:{walking:ge,gravity:ge,movingFloor:ge},switchedToAt:Ke,lastDiedAt:Ke,gameTime:0,jumpStartTime:Ke,lives:t?"infinite":g_,jumpStartZ:0}},b_=t=>{const e=Rd(be.getState());return t.config.which==="head"?{id:"head",type:"head",...je,...Gn,state:{...vr(),...Rs(),...Bs(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Ke,shieldCollectedAt:Ke,doughnuts:e?"infinite":0,doughnutLastFireTime:Ke,position:qo(t)}}:{id:"heels",type:"heels",...je,...Gn,state:{...vr(),...Rs(),...Bs(),carrying:null,hasBag:!1,bigJumps:0,shieldCollectedAt:Ke,position:qo(t)}}},GA=1,q_=(t=li)=>({x:le.w,y:le.d*GA,z:t*le.h}),w_={x:le.w,y:0,z:HA},v_=(t=li)=>({x:le.w*GA,y:le.d,z:t*le.h}),__={x:0,y:le.d,z:HA},k_=(t,e,r)=>{const{config:{direction:s,times:n},position:i}=e,{size:{z:a}}=r,o=Co(s),l=Mo(o),c=s==="towards"||s==="right",u={...ge,[l]:c?-1:0};return{type:"wall",id:t,config:e.config,aabb:bo(o==="y"?v_(a):q_(a),n),renders:!c,renderAabb:c?void 0:bo(o==="y"?__:w_,n),state:{position:Te(Ae(i,u)),stoodOnBy:pe,expires:null,disappear:null},shadowCastTexture:o==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0}}};function*WA(t,e,r,s,n={}){if(!s[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&n[e.config.page]))switch(e.type){case"door":return yield*y_(e,t);case"player":{yield b_(e);return}case"wall":{yield k_(t,e,r);return}default:{const i=DA(e),a=e.config.times!==void 0?{aabb:bo(i.aabb,e.config.times),renderAabb:void 0}:i;yield{...e,...je,...a,shadowMask:S_(e),shadowCastTexture:C_(e),id:t,config:e.config,state:V_(e)}}}}const S_=t=>{switch(t.type){case"lift":return{spriteOptions:"shadowMask.smallBlock",relativeTo:"origin"};case"conveyor":return{spriteOptions:{textureId:"shadowMask.conveyor",flipX:So(t.config.direction)==="x"},relativeTo:"origin"};case"barrier":return{spriteOptions:{textureId:"shadowMask.barrier.y",flipX:t.config.axis==="x"},relativeTo:"origin"};case"spring":return{spriteOptions:"shadowMask.smallRound",relativeTo:"origin"};case"block":return{spriteOptions:t.config.style==="tower"?"shadowMask.tower":"shadowMask.fullBlock",relativeTo:"origin"};case"pushableBlock":case"movingPlatform":return{spriteOptions:t.config.style==="stepStool"?"shadowMask.stepStool":"shadowMask.fullBlock",relativeTo:"origin"};case"teleporter":return{spriteOptions:"shadowMask.teleporter",relativeTo:"origin"};case"hushPuppy":return{spriteOptions:"shadowMask.hushPuppy",relativeTo:"origin"};case"portableBlock":return{spriteOptions:t.config.style==="drum"?"shadowMask.smallRound":"shadowMask.smallBlock",relativeTo:"origin"};case"slidingBlock":return{spriteOptions:t.config.style==="book"?"shadowMask.fullBlock":"shadowMask.smallRound",relativeTo:"origin"};case"deadlyBlock":switch(t.config.style){case"volcano":return{spriteOptions:"shadowMask.volcano",relativeTo:"origin"};case"toaster":return{spriteOptions:"shadowMask.fullBlock",relativeTo:"origin"};default:t.config.style}break;case"spikes":return{spriteOptions:"shadowMask.spikes",relativeTo:"origin"};case"switch":return{spriteOptions:"shadowMask.switch",relativeTo:"origin"};case"pickup":return t.config.gives==="scroll"?{spriteOptions:"shadowMask.scroll",relativeTo:"origin"}:void 0;case"slidingDeadly":return{spriteOptions:"shadowMask.smallRound",relativeTo:"origin"};case"monster":switch(t.config.which){case"dalek":return{spriteOptions:"shadowMask.dalek",relativeTo:"origin"};default:return}case"joystick":return{spriteOptions:"shadowMask.joystick",relativeTo:"origin"}}},C_=t=>{switch(t.type){case"lift":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:So(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"monster":return"shadow.smallRound"}};let M_=0;const FS=({gameState:t,room:e,itemType:r,config:s,position:n})=>{const i={type:r,config:s,position:ge},a=`${r}/${M_++}`,o=lm(WA(a,i,e.roomJson,t.pickupsCollected[e.id]??pe));if(o===void 0)throw console.error("failed to generate any items for json",a,i),new Error("failed to generate any items");return o.state.position=n,Wn({room:e,item:o}),o},Wn=({room:t,item:e})=>(t.items[e.id]=e,e),P_=(t,e)=>Ue(Eo(t)).map(r=>e.items[r]);function T_(t,e){return t===null?null:e.items[t]}const Sh=(t,e)=>{if(t.state.standingOnItemId!==null){const r=T_(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null}},E_=({above:t,below:e})=>{t.state.standingOnItemId=e.id,e.state.stoodOnBy[t.id]=!0},wo=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;FA(r)&&Sh(r,t);for(const s of P_(r.state.stoodOnBy,t))Sh(s,t);typeof e=="string"?delete t.items[e]:delete t.items[r.id]},I_=t=>{const e=er(t,"head"),r=er(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},R_=t=>{const e={id:"head",type:"head",...je,...Gn,state:{...vr(),...Rs(),...Bs(),...t.state.head,facing:t.state.facing,position:Ae(t.state.position,{z:le.h}),switchedToAt:Ke,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith}},r={id:"heels",type:"heels",...je,...Gn,state:{...vr(),...Rs(),...Bs(),...t.state.heels,facing:t.state.facing,position:Ae(t.state.position),switchedToAt:Ke,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith}};return{head:e,heels:r}},B_=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...je,shadowCastTexture:e.shadowCastTexture,config:pe,aabb:Cn,state:{...vr(),...Rs(),...Bs(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,head:{...En(t.state,"hasHooter","doughnuts","doughnutLastFireTime","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ke},heels:{...En(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ke}}}),z_=t=>{const e=t.characterRooms.head,r=er(t,"head"),s=er(t,"heels"),n=B_({head:r,heels:s});wo({room:e,item:"head"}),wo({room:e,item:"heels"}),Wn({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},j_=(t,e)=>{const r=t.characterRooms.headOverHeels,s=er(t,"headOverHeels"),n=e??Vo(t.previousPlayable),{head:i,heels:a}=R_(s);wo({room:r,item:"headOverHeels"}),Wn({room:r,item:i}),Wn({room:r,item:a}),E_({above:i,below:a}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},F_=t=>{const e=er(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},Ca=(t,e)=>{I_(t)&&(!e||e===t.currentCharacterName)?z_(t):t.currentCharacterName==="headOverHeels"?j_(t,e):(!e||e!==t.currentCharacterName)&&er(t,Vo(t.currentCharacterName))!==void 0&&(t.currentCharacterName=Vo(t.currentCharacterName)),F_(t)},N_=t=>{const{inputStateTracker:e}=t;e.currentActionPress("swop")==="tap"&&Ca(t),e.currentActionPress("swop.head")==="tap"&&Ca(t,"head"),e.currentActionPress("swop.heels")==="tap"&&Ca(t,"heels")},UA=()=>{const t=Jr(),[e,r]=I.useState(t.gameState.currentCharacterName);return I.useEffect(()=>{const s=()=>{r(t.gameState.currentCharacterName)};return nt.shared.add(s),()=>{nt.shared.remove(s)}},[t.gameState]),e},O_=()=>{const t=Jr();I.useEffect(()=>{const e=()=>{N_(t.gameState)};return nt.shared.add(e),()=>{nt.shared.remove(e)}},[t.gameState])},gr=({mapTitle:t,y:e=0,className:r,textOnly:s=!1})=>{const n=Ns();return d.jsxs("g",{className:r,children:[s||d.jsx("rect",{y:e,width:1e4,height:1e4}),d.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:Zt,y:e+Zt,children:d.jsx(O,{className:`left-2 relative sprites-double-height ${ve}`,children:t})})]})},L_=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const s=Ns(),n=e.r-e.l+2*Zt,i={x:-e.l+Zt+(r-n)/2,y:-e.t+Zt},a=(m,V=ge)=>Xe(i,Fe(dt(Ae(t[m].gridPosition,V)))),o=a("blacktooth44market/*",{x:1,z:1.5}),l=a("blacktooth44market/*",{x:1}),c=a("blacktooth45market/*"),u=a("blacktooth48market/*",{y:1}),h=a("blacktooth53market/*",{x:0,y:0,z:0}),A=a("blacktooth53market/*",{x:0,y:1,z:0}),f=a("blacktooth53market/*",{x:1,y:1,z:0}),p=a("blacktooth52market/*",{x:1,y:.5,z:0}),g=s*8*2;return d.jsxs(d.Fragment,{children:[d.jsx("path",{className:`${nr.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${_t({...o,x:g})}
L ${_t(o)}
L ${_t(l)}
L ${_t(c)}
L ${_t(u)}
L ${_t(h)}
L ${_t(A)}
L ${_t(f)}
L ${_t(p)}
L ${_t({...p,x:g})}
z`}),d.jsx(gr,{y:p.y,mapTitle:"Market",className:nr.market.bgClassName,textOnly:!0})]})},YA=()=>{const t=Jr(),e=UA(),r=t.gameState.characterRooms[e];return(r&&nr[r.roomJson.planet])??{bgClassName:"fill-shadow",containerClassName:""}},D_={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},H_=({campaign:t,curRoomId:e,gridPositions:r,mapBounds:s,containerWidth:n})=>{const i=t.name==="original"&&!["penitentiary","bookworld","egyptus","safari"].includes(t.rooms[e].planet),a=YA();if(i){const o=r,l=Fe(dt({x:1,y:1,z:0})).y,c=Fe(dt({x:1,y:1,z:1})).y,u=A=>Fe(dt(o[A].gridPosition)).y+c,h=(A,f)=>{if(o[A]===void 0)throw new Error(A);if(o[f]===void 0)throw new Error(f);const p=Fe(dt(o[A].gridPosition)).y,g=Fe(dt(o[f].gridPosition)).y+l+Zt;return(p+g)/2};return d.jsxs(d.Fragment,{children:[d.jsx(gr,{y:u("finalroom/*")-s.t,mapTitle:"Freedom",className:nr.freedom.bgClassName}),d.jsx(gr,{y:h("finalroom/*","blacktooth83tofreedom/*")-s.t,mapTitle:"Castle Blacktooth",className:nr.blacktooth.bgClassName}),d.jsx(gr,{y:h("blacktooth87crown/*","moonbase35/*")-s.t,mapTitle:"moonbase",className:nr.moonbase.bgClassName}),d.jsx(gr,{y:h("moonbase9/*","blacktooth62fish/right")-s.t,mapTitle:"Blacktooth escape",className:nr.blacktooth.bgClassName}),d.jsx(L_,{mapBounds:s,originalCampaignPositions:o,containerWidth:n}),d.jsx(gr,{y:h("blacktooth24/*","blacktooth1head/*")-s.t,mapTitle:"Jail",className:nr.jail.bgClassName})]})}return d.jsx(gr,{mapTitle:D_[t.rooms[e].planet],className:a.bgClassName})},_s=(t,e)=>e?.[t],XA=t=>Yn(t),G_=t=>Ue(XA(t)),NS=t=>Ue(To(t)),OS=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),W_=t=>t.characterRooms[t.currentCharacterName],U_=({aabb:t,state:{position:e}},{aabb:r,state:{position:s}})=>!(e.x+t.x<=s.x||e.x>=s.x+r.x)&&!(e.y+t.y<=s.y||e.y>=s.y+r.y)&&!(e.z+t.z<=s.z||e.z>=s.z+r.z),Y_=(t,e)=>[...Ue(e).filter(r=>t.id!==r.id&&U_(t,r))],X_=t=>{const e={},r=Object.values(t.items).filter(s=>s.type==="door");for(const{config:{direction:s},position:{x:n,y:i}}of r)Co(s)==="x"?i===0?e.towards=!0:i===t.size.y&&(e.away=!0):n===0?e.right=!0:n===t.size.x&&(e.left=!0);return e},$A=t=>{const e=X_(t),r=e.right?-.5:0,s=t.size.x+(e.left?.5:0),n=e.towards?-.5:0,i=t.size.y+(e.away?.5:0);return{blockXMin:r,blockXMax:s,blockYMin:n,blockYMax:i,sidesWithDoors:e}},LS=t=>{const{blockXMax:e,blockXMin:r,blockYMax:s,blockYMin:n,sidesWithDoors:i}=$A(t),a=Fr({x:t.size.x+(i.right?.5:0),y:-n}).x,o=Fr({x:-r,y:t.size.y+(i.towards?.5:0)}).x,l=Fr({x:t.size.x,y:t.size.y}).y,c=Fr({x:r,y:n}),u=Fr({x:e,y:s});return{blockXMin:r,blockXMax:e,blockYMin:n,blockYMax:s,edgeLeftX:a,edgeRightX:o,topEdgeY:l,frontSide:c,backSide:u,sidesWithDoors:i}};function*$_(t){const e=t.size.z??li,r=Te({...t.size,z:1}),{blockXMax:s,blockXMin:n,blockYMax:i,blockYMin:a}=$A(t),o=Te({x:s-n,y:i-a,z:1}),l=Te({...cd,z:-1}),c=Te({x:n,y:a,z:-1});if(yield{id:"floorEdge",...je,type:"floorEdge",state:{...vr(),position:{...c,z:0}},aabb:ge,config:{},fixedZIndex:9999},t.floor==="none"&&t.roomBelow!==void 0?(yield{...je,type:"floor",id:"floor",config:{type:"none"},aabb:r,shadowMask:void 0,state:{position:c,expires:null,stoodOnBy:{},disappear:null},renders:!0,fixedZIndex:-1},yield{...je,type:"portal",id:"floor/portal",config:{toRoom:t.roomBelow,relativePoint:{x:r.x/2,y:r.y/2,z:r.z},direction:me.down},aabb:r,state:{position:l,expires:null,stoodOnBy:{},disappear:null},renders:!1}):yield{...je,type:"floor",id:"floor",config:{type:t.floor==="deadly"?"deadly":"standable"},aabb:o,shadowMask:{relativeTo:"origin"},state:{position:c,expires:null,stoodOnBy:{},disappear:null},renders:!0,fixedZIndex:-1},t.roomAbove!==void 0){const u=Ae(l,{z:le.h*e});yield{...je,type:"portal",id:"ceiling",config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?Te(t.ceilingRelativePoint):{x:r.x/2,y:r.y/2},z:-12},direction:me.up},aabb:r,state:{position:u,expires:null,stoodOnBy:{},disappear:null},renders:!1}}}function*K_(t,e,r){const{gameMenus:{scrollsRead:s}}=be.getState(),n=gd(t.items);for(const[i,a]of n)a.type==="player"&&!r||(yield*WA(i,a,t,e,s))}const Ch=t=>Ue(t).reduce((e,r)=>({...e,[r.id]:r}),{}),Mh=({roomJson:t,roomPickupsCollected:e,isNewGame:r=!1})=>{const s={...Ch($_(t)),...Ch(K_(t,e,r))};for(const i of G_(s)){const o=Y_(i,XA(s)).find(l=>_h(i)&&_h(l)&&!(i.type==="wall"&&l.type==="wall"));o!==void 0&&console.error(`in room ${t.id} item ${i.id} @${JSON.stringify(i.state.position)} #${JSON.stringify(i.aabb)} is colliding with (solid item) ${o.id} @${JSON.stringify(o.state.position)} #${JSON.stringify(o.aabb)} on loading room ${t.id}`)}return{...t,roomJson:t,items:{...s},roomTime:0}};function Q_(t){return{all:t=t||new Map,on:function(e,r){var s=t.get(e);s?s.push(r):t.set(e,[r])},off:function(e,r){var s=t.get(e);s&&(r?s.splice(s.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var s=t.get(e);s&&s.slice().map(function(n){n(r)}),(s=t.get("*"))&&s.slice().map(function(n){n(e,r)})}}}const Ph=({state:{position:t,facing:e,autoWalk:r,action:s,vels:n}})=>({position:t,facing:e,autoWalk:r,action:s,vels:{...n}}),KA=(t,e)=>{if(e)return Vd(e.gameState.characterRooms,([s,n])=>[s,n.id]);const r={};for(const s of Object.values(t.rooms))for(const n of Object.values(s.items))if(n.type==="player"){const{which:i}=n.config;r[i]=s.id}if(r.head===void 0&&r.heels===void 0)throw new Error("couldn't find either head or heels in campaign");return r},DS=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:s={}})=>{const n=KA(t,r),i={},a=r?r.gameState.characterRooms.head&&fs(r.gameState.characterRooms.head):n.head&&Mh({roomJson:t.rooms[n.head],roomPickupsCollected:i[n.head]??pe,isNewGame:r===void 0}),o=n.heels===n.head?a:r?r.gameState.characterRooms.heels&&fs(r.gameState.characterRooms.heels):n.heels&&Mh({roomJson:t.rooms[n.heels],roomPickupsCollected:i[n.heels]??pe,isNewGame:r===void 0}),l=r?.gameState.characterRooms.headOverHeels&&fs(r.gameState.characterRooms.headOverHeels),c={head:a,heels:o,headOverHeels:l};return Object.assign(s,{events:Q_(),inputStateTracker:e,campaign:t,gameSpeed:1,...r?fs(r?.gameState):{currentCharacterName:n.head===void 0?"heels":"head",entryState:{head:a===void 0?void 0:Ph(_s("head",a?.items)),heels:o===void 0?void 0:Ph(_s("heels",o?.items))},pickupsCollected:i,gameTime:0,progression:0},characterRooms:c})},Z_=Fe(dt({x:1,y:1,z:1})).y,Th=Fe(dt({x:0,y:1,z:0})).x,J_=t=>t.reduce((e,{gridPosition:r})=>{const s=Fe(dt(r));return{t:Math.min(e.t,s.y+Z_),b:Math.max(e.b,s.y),l:Math.min(e.l,s.x-Th),r:Math.max(e.r,s.x+Th)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),yn=(t,e,r,s)=>e.some(n=>n.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:n})=>Tp(me[t],Cp(n,s)))?"open":"wall";function*Nr(t){try{yield*e1(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"} ---found--v 
 ${r.message}`,{cause:r})}}function*e1({roomId:t,subRoomId:e="*",campaign:r,visited:s={},vectorFromPrevious:n,previousRoomGridPosition:i=ge}){if(s[t]?.[e])return;s[t]===void 0&&(s[t]={}),s[t][e]=!0;const a=r.rooms[t];if(a===void 0)throw new Error(`no room in the campaign with id="${t}"`);const o=[...Ue(Yn(a.items)).filter(f=>f.type==="door").filter(f=>RA(f,e,a))],l=Ae(i,n===void 0?cd:n),c=a.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:yn("left",o,c,u),right:yn("right",o,c,u),away:yn("away",o,c,u),towards:yn("towards",o,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:p}]of Ue(gd(c)))f!==e&&(yield*Nr({roomId:t,subRoomId:f,campaign:r,visited:s,vectorFromPrevious:Mn({...p,z:0},u),previousRoomGridPosition:l}))}if(a.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:p}=a;yield*Nr({roomId:f,subRoomId:p,campaign:r,visited:s,vectorFromPrevious:me.up,previousRoomGridPosition:l})}if(a.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:p}=a;yield*Nr({roomId:f,subRoomId:p,campaign:r,visited:s,vectorFromPrevious:me.down,previousRoomGridPosition:l})}for(const f of o){const{toRoom:p}=f.config;yield*Nr({roomId:p,campaign:r,visited:s,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:me[f.config.direction],previousRoomGridPosition:l})}const A=a.meta?.nonContiguousRelationship;if(A!==void 0){const{with:{room:f},gridOffset:p}=A;yield*Nr({roomId:f,campaign:r,visited:s,subRoomId:"*",vectorFromPrevious:p,previousRoomGridPosition:l})}}const t1=t=>{const r=[...t].sort(({gridPosition:s},{gridPosition:n})=>s.z!==n.z?s.z-n.z:n.x+n.y-(s.x+s.y)).map(s=>[`${s.roomId}/${s.subRoomId}`,s]);return Fs(r)},r1=()=>{const t=UA(),{gameState:e}=Jr();return I.useMemo(()=>{const r=W_(e),s=r?.roomJson.id??KA(e.campaign).head;let n;if(!e)n="*";else if(!r?.roomJson.meta?.subRooms)n="*";else{const u=r?.items[t];u?n=fn(u,r.roomJson):n="*"}const{characterRooms:i}=e,a={head:i.head&&{roomId:i.head.roomJson.id,subRoomId:fn(i.head.items.head,i.head.roomJson),facingXy8:Vn(_s("head",i.head.items).state.facing)??"towards"},heels:i.heels&&{roomId:i.heels.roomJson.id,subRoomId:fn(i.heels.items.heels,i.heels.roomJson),facingXy8:Vn(_s("heels",i.heels.items).state.facing)??"towards"},headOverHeels:i.headOverHeels&&{roomId:i.headOverHeels.roomJson.id,subRoomId:fn(i.headOverHeels.items.headOverHeels,i.headOverHeels.roomJson),facingXy8:Vn(_s("headOverHeels",i.headOverHeels.items).state.facing)??"towards"}},o=[...Nr({campaign:e.campaign,roomId:s,subRoomId:n})],l=t1(o);return{mapBounds:J_(o),curRoomId:r?.roomJson.id,gridPositions:l,currentCharacterName:t,playerLocations:a}},[t,e])},s1=({containerWidth:t})=>{const e=Jr(),r=Tg(),{campaign:s}=e;O_();const{gridPositions:n,curRoomId:i,mapBounds:a,playerLocations:o,currentCharacterName:l}=r1(),{pickupsCollected:c}=e.gameState;return d.jsx(e_,{background:i===void 0?null:d.jsx(H_,{curRoomId:i,campaign:s,gridPositions:n,mapBounds:a,containerWidth:t}),campaign:s,mapBounds:a,pickupsCollected:c,gridPositions:n,currentCharacterName:l,curRoomId:i,playerLocations:o,containerWidth:t,roomsExplored:r})};var Ma,Eh;function ml(){if(Eh)return Ma;Eh=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Ma=t,Ma}var Pa,Ih;function n1(){if(Ih)return Pa;Ih=1;var t=typeof Ds=="object"&&Ds&&Ds.Object===Object&&Ds;return Pa=t,Pa}var Ta,Rh;function QA(){if(Rh)return Ta;Rh=1;var t=n1(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return Ta=r,Ta}var Ea,Bh;function i1(){if(Bh)return Ea;Bh=1;var t=QA(),e=function(){return t.Date.now()};return Ea=e,Ea}var Ia,zh;function a1(){if(zh)return Ia;zh=1;var t=/\s/;function e(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return Ia=e,Ia}var Ra,jh;function o1(){if(jh)return Ra;jh=1;var t=a1(),e=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(e,"")}return Ra=r,Ra}var Ba,Fh;function ZA(){if(Fh)return Ba;Fh=1;var t=QA(),e=t.Symbol;return Ba=e,Ba}var za,Nh;function l1(){if(Nh)return za;Nh=1;var t=ZA(),e=Object.prototype,r=e.hasOwnProperty,s=e.toString,n=t?t.toStringTag:void 0;function i(a){var o=r.call(a,n),l=a[n];try{a[n]=void 0;var c=!0}catch{}var u=s.call(a);return c&&(o?a[n]=l:delete a[n]),u}return za=i,za}var ja,Oh;function c1(){if(Oh)return ja;Oh=1;var t=Object.prototype,e=t.toString;function r(s){return e.call(s)}return ja=r,ja}var Fa,Lh;function u1(){if(Lh)return Fa;Lh=1;var t=ZA(),e=l1(),r=c1(),s="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function a(o){return o==null?o===void 0?n:s:i&&i in Object(o)?e(o):r(o)}return Fa=a,Fa}var Na,Dh;function h1(){if(Dh)return Na;Dh=1;function t(e){return e!=null&&typeof e=="object"}return Na=t,Na}var Oa,Hh;function d1(){if(Hh)return Oa;Hh=1;var t=u1(),e=h1(),r="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&t(n)==r}return Oa=s,Oa}var La,Gh;function f1(){if(Gh)return La;Gh=1;var t=o1(),e=ml(),r=d1(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return s;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||a.test(c)?o(c.slice(2),h?2:8):n.test(c)?s:+c}return La=l,La}var Da,Wh;function JA(){if(Wh)return Da;Wh=1;var t=ml(),e=i1(),r=f1(),s="Expected a function",n=Math.max,i=Math.min;function a(o,l,c){var u,h,A,f,p,g,m=0,V=!1,y=!1,q=!0;if(typeof o!="function")throw new TypeError(s);l=r(l)||0,t(c)&&(V=!!c.leading,y="maxWait"in c,A=y?n(r(c.maxWait)||0,l):A,q="trailing"in c?!!c.trailing:q);function S(W){var te=u,Me=h;return u=h=void 0,m=W,f=o.apply(Me,te),f}function P(W){return m=W,p=setTimeout(j,l),V?S(W):f}function C(W){var te=W-g,Me=W-m,x=l-te;return y?i(x,A-Me):x}function T(W){var te=W-g,Me=W-m;return g===void 0||te>=l||te<0||y&&Me>=A}function j(){var W=e();if(T(W))return B(W);p=setTimeout(j,C(W))}function B(W){return p=void 0,q&&u?S(W):(u=h=void 0,f)}function R(){p!==void 0&&clearTimeout(p),m=0,u=g=h=p=void 0}function D(){return p===void 0?f:B(e())}function K(){var W=e(),te=T(W);if(u=arguments,h=this,g=W,te){if(p===void 0)return P(g);if(y)return clearTimeout(p),p=setTimeout(j,l),S(g)}return p===void 0&&(p=setTimeout(j,l)),f}return K.cancel=R,K.flush=D,K}return Da=a,Da}var A1=JA();const p1=Ze(A1);var Ha,Uh;function m1(){if(Uh)return Ha;Uh=1;var t=JA(),e=ml(),r="Expected a function";function s(n,i,a){var o=!0,l=!0;if(typeof n!="function")throw new TypeError(r);return e(a)&&(o="leading"in a?!!a.leading:o,l="trailing"in a?!!a.trailing:l),t(n,i,{leading:o,maxWait:i,trailing:l})}return Ha=s,Ha}var g1=m1();const x1=Ze(g1),y1=(t,e,r,s)=>{switch(e){case"debounce":return p1(t,r,s);case"throttle":return x1(t,r,s);default:return t}},V1=t=>{const e=I.useRef(t);return I.useEffect(()=>{e.current=t}),I.useMemo(()=>(...r)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...r)},[])},b1=t=>{const[e,r]=I.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:I.useMemo(()=>new Proxy(n=>{n!==e&&r(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,a){return i==="current"?r(a):n[i]=a,!0}}),[e]),refElement:e,setRefElement:r}},q1=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function w1({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:s,handleWidth:n=!0,handleHeight:i=!0,targetRef:a,observerOptions:o,onResize:l}={}){const c=I.useRef(t),u=V1(l),[h,A]=I.useState({width:void 0,height:void 0}),{refProxy:f,refElement:p}=b1(a),{box:g}=o||{},m=I.useCallback(y=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const q=(S,P)=>n&&S.width!==P.width||i&&S.height!==P.height;y.forEach(S=>{const P=q1(S,g);A(C=>q(C,P)?(u?.({width:P.width,height:P.height,entry:S}),P):C)})},[n,i,c,g]),V=I.useCallback(y1(m,e,r,s),[m,e,r,s]);return I.useEffect(()=>{let y;return p?(y=new window.ResizeObserver(V),y.observe(p,o)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),A({width:void 0,height:void 0})),()=>{var q,S,P;(q=y?.disconnect)===null||q===void 0||q.call(y),(P=(S=V).cancel)===null||P===void 0||P.call(S)}},[V,p]),Object.assign({ref:f},h)}const v1=()=>{const{ref:t,width:e}=w1(),r=YA(),s=SA();return d.jsx(Je,{children:d.jsx(De,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${r.containerClassName}`,onClick:H(Ye),children:d.jsx("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 h-min",ref:s,children:e!==void 0&&d.jsx(s1,{containerWidth:e})})})})};class _1 extends I.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){be.dispatch(ef({message:e.message,stack:e.stack}))}render(){return this.props.children}}const k1=t=>e=>d.jsx(_1,{children:d.jsx(t,{...e})}),S1=t=>t.startsWith("markdown/"),C1=k1(t=>{const e=ae(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(S1(e.menuId))return d.jsx(uh,{pageName:e.menuId.slice(9)});switch(e.menuId){case"controlOptions":return d.jsx(R0,{});case"crowns":return d.jsx(e0,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return d.jsx(O0,{});case"errorCaught":return d.jsx(H0,{...e.menuParam});case"hold":return d.jsx(A0,{});case"inputPreset":return d.jsx(z0,{});case"installGuide":return d.jsx(uh,{pageName:"installGuide"});case"mainMenu":return d.jsx(a0,{});case"map":return d.jsx(v1,{});case"modernisationOptions":return d.jsx(y0,{});case"offerReincarnation":return d.jsx(L0,{});case"proclaimEmperor":return d.jsx(j0,{});case"quitGameConfirm":return d.jsx(o0,{});case"readTheManual":return d.jsx(Dv,{});case"score":return d.jsx(c0,{});default:return e.menuId,d.jsx(De,{children:d.jsx(O,{children:`unknown dialog ${e}`})})}}),M1=Qr(()=>Kr(()=>import("./Cheats--Y1ORWcN.js"),__vite__mapDeps([8,4,5,9]))),P1=Qr(()=>Kr(()=>import("./gameMain-B0mEwjD2.js").then(t=>t.g),__vite__mapDeps([10,9,2,4,5]))),T1=Qr(()=>Kr(()=>import("./testCampaign-D29I7Sb6.js"),__vite__mapDeps([11,4,5,7]))),E1="/assets/bonus-CvVo342Z.mp3",I1="/assets/bubblesLoop-B_LY362Z.mp3",R1="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",B1="/assets/conveyorStop-D5zeg8cv.mp3",z1="/assets/conveyorLoop-CF-OA6qJ.mp3",j1="/assets/conveyorStart-CcCK4MGd.mp3",F1="/assets/destroy-CZDN4Ktz.mp3",N1="/assets/detect-D_kRR5uD.mp3",O1="data:audio/mpeg;base64,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",L1="/assets/headFall-rxdxTCeK.mp3",D1="/assets/headJump-GCHlCfni.mp3",H1="/assets/headWalk-B5kQ4tvC.mp3",G1="/assets/heelsFall-IsGtipMw.mp3",W1="data:audio/mpeg;base64,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",U1="/assets/heelsWalk-Bmk6WOTI.mp3",Y1="/assets/helicopter-BYGzJTF2.mp3",X1="data:audio/mpeg;base64,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",$1="/assets/hushPuppyVanish-CZOUg83F.mp3",K1="/assets/jetpack-loop-1-XbLJ84YF.m4a",Q1="data:audio/mpeg;base64,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Jua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",Z1="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",J1="data:audio/mpeg;base64,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v//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",ek="/assets/mojo-D9S1pz9n.mp3",tk="data:audio/mp4;base64,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",rk="/assets/robotBeepingLoop-Cz0TGwJH.mp3",sk="data:audio/mpeg;base64,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",nk="/assets/rollingBallLoop-BUA084C_.mp3",ik="/assets/servosLoop-Bn-haKck.mp3",ak="/assets/servosStart-BgsySGJF.mp3",ok="/assets/servosStop-BR1i0gi5.mp3",lk="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",ck="/assets/spring-CP3uOhml.mp3",uk="/assets/metalicScraping-BqmM5ys4.mp3",hk="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",dk="/assets/teleportIn-DZAhHW9-.mp3",fk="/assets/teleportOut-Bra-ABlh.mp3",Ak="/assets/teleportWarningSiren-Boo1HoAB.mp3",pk=new window.AudioContext;let Un;const se=async t=>await pk.decodeAudioData(await(await fetch(t)).arrayBuffer()),mk=Qr(async()=>({bonus:await se(E1),bubbleRobotLoop:await se(I1),carry:await se(R1),conveyorEnd:await se(B1),conveyorLoop:await se(z1),conveyorStart:await se(j1),destroy:await se(F1),detect:await se(N1),drum:await se(O1),headFall:await se(L1),headJump:await se(D1),headWalk:await se(H1),heelsFall:await se(G1),heelsJump:await se(W1),heelsWalk:await se(U1),helicopter:await se(Y1),hooter:await se(X1),hushPuppyVanish:await se($1),jetpackLoop:await se(K1),jetpackTurnaround:await se(Q1),landing:await se(Z1),metalHit:await se(J1),mojoLoop:await se(ek),mojoTurn:await se(tk),robotBeepingLoop:await se(rk),robotWhirLoop:await se(sk),rollingBallLoop:await se(nk),servoLoop:await se(ik),servoStart:await se(ak),servoStop:await se(ok),softBump:await se(lk),springBoing:await se(ck),stepStoolScraping:await se(uk),switchClick:await se(hk),teleportIn:await se(dk),teleportOut:await se(fk),teleportWarningSiren:await se(Ak)})),gk=async()=>{Un===void 0&&(Un=await mk())},HS=()=>{if(Un===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Un},xk=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=ae(s=>s.gameMenus.upscale);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},yk=I.lazy(M1),Yh=Qr(t=>Promise.all([P1(),CA(),t?T1():void 0,Cv(),gk()])),Vk=()=>{const[t,e]=I.useState(),r=Gr(),s=hl(),n=Pd(),{loadingStarted:i,loadingFinished:a}=Qv();return I.useEffect(()=>{if(!r){e(void 0),Yh(n);return}let o=!1,l;return(async()=>{try{i();const[u,h,A]=await Yh(n);if(a(),!o){const f=n?{...h.campaign,rooms:{...h.campaign.rooms,...A?.testCampaign.rooms}}:h.campaign;l=await u.default(f,s),e(l)}}catch(u){const h=u;be.dispatch(ef({message:h.message,stack:h.stack}))}})(),()=>{l?.stop(),o=!0}},[n,r,s,i,a]),t},Xh=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,bk=()=>{const t=wg(),{rotate90:e}=ae(r=>r.gameMenus.upscale);I.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",ft())},[]),I.useEffect(()=>{document.body.classList.remove(...Object.keys(Sr).map(Xh)),document.body.classList.add(Xh(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},qk=()=>{const[t,e]=I.useState(null),r=Pd(),s=Vk(),n=ae(a=>a.gameMenus.upscale.canvasSize),i=xk();return bk(),I.useEffect(()=>{t===null||s===void 0||(s.renderIn(t),t.addEventListener("touchstart",a=>a.preventDefault(),{passive:!1}))},[s,t]),I.useEffect(()=>{s?.resizeTo(n)},[n,s]),d.jsxs(d.Fragment,{children:[d.jsx("div",{style:i,ref:e}),d.jsxs(Eg,{gameApi:s,children:[d.jsx(Kw,{}),d.jsx(C1,{}),s&&r&&d.jsx(I.Suspense,{fallback:null,children:d.jsx(yk,{})})]})]})},wk=()=>{const t=Bo();return I.useEffect(()=>{document.body.classList.toggle("zx",!t),document.body.classList.toggle("colourised",t)},[t]),d.jsxs(zd,{children:[d.jsx(_l,{path:"/",children:d.jsx(Uw,{children:d.jsx(Kv,{children:d.jsx(qk,{})})})}),d.jsx(_l,{path:"/sprites",children:d.jsx(Fm,{})})]})},vk=()=>d.jsx(tg,{store:be,children:d.jsx(wk,{})}),GS=Object.freeze(Object.defineProperty({__proto__:null,App:vk},Symbol.toStringTag,{value:"Module"}));export{it as $,iS as A,Vo as B,Mh as C,pe as D,yS as E,Te as F,mr as G,le as H,Ph as I,be as J,Xk as K,l_ as L,Gk as M,md as N,Mo as O,So as P,jk as Q,Ik as R,Rk as S,We as T,Ly as U,lV as V,U as W,nt as X,On as Y,Nt as Z,Ve as _,wo as a,er as a$,Ls as a0,QV as a1,gu as a2,Ee as a3,eb as a4,st as a5,Ms as a6,_n as a7,Jo as a8,Pf as a9,ta as aA,au as aB,oV as aC,Le as aD,Vf as aE,ab as aF,_b as aG,Sb as aH,Eb as aI,Rb as aJ,Bb as aK,kA as aL,Jr as aM,tS as aN,p0 as aO,ip as aP,zd as aQ,Ok as aR,Lk as aS,Ro as aT,jr as aU,Kk as aV,Qk as aW,W_ as aX,gS as aY,_s as aZ,z_ as a_,Ot as aa,Gf as ab,Du as ac,ie as ad,vb as ae,kb as af,Pb as ag,Ib as ah,Uf as ai,el as aj,ne as ak,co as al,Sy as am,ti as an,Of as ao,jb as ap,Kt as aq,gf as ar,Pt as as,nV as at,ru as au,Cs as av,MV as aw,Se as ax,ke as ay,nu as az,FS as b,qg as b$,js as b0,kr as b1,Jp as b2,ut as b3,Ts as b4,Hu as b5,zk as b6,ES as b7,Fn as b8,Mv as b9,ld as bA,Or as bB,Tp as bC,cd as bD,CS as bE,me as bF,zs as bG,Sp as bH,kp as bI,Ut as bJ,Hk as bK,AS as bL,cS as bM,fS as bN,A_ as bO,kh as bP,PS as bQ,TS as bR,SS as bS,kS as bT,bS as bU,zA as bV,aS as bW,t_ as bX,F as bY,VS as bZ,Ke as b_,Fr as ba,Bk as bb,Vg as bc,zw as bd,Nw as be,od as bf,Lw as bg,Vn as bh,xd as bi,Jk as bj,kt as bk,_p as bl,BS as bm,Wk as bn,Yk as bo,zg as bp,$k as bq,xS as br,Co as bs,jA as bt,oS as bu,OS as bv,Ek as bw,dS as bx,Nk as by,Cp as bz,ge as c,Nn as c$,p_ as c0,vS as c1,_S as c2,Ip as c3,Sk as c4,MS as c5,Wn as c6,je as c7,P_ as c8,uS as c9,pk as cA,HS as cB,Eo as cC,sS as cD,li as cE,Sg as cF,vg as cG,ft as cH,at as cI,ef as cJ,En as cK,Fk as cL,Dk as cM,zo as cN,qS as cO,wS as cP,DS as cQ,Uk as cR,ky as cS,Eq as cT,rA as cU,xu as cV,mu as cW,Yu as cX,Fq as cY,we as cZ,Cy as c_,hS as ca,c_ as cb,mS as cc,tf as cd,R_ as ce,B_ as cf,Mk as cg,Pk as ch,Ck as ci,Qd as cj,NS as ck,N_ as cl,Tk as cm,Fe as cn,IS as co,To as cp,lS as cq,Xe as cr,qm as cs,RS as ct,zS as cu,yo as cv,eS as cw,LS as cx,rS as cy,Ft as cz,_e as d,mo as d0,Wu as d1,iA as d2,GS as d3,Ae as e,ad as f,Mn as g,G_ as h,Ue as i,Ce as j,Ep as k,FA as l,Y_ as m,U_ as n,Yn as o,pS as p,_h as q,XA as r,Gt as s,nS as t,jS as u,Ge as v,T_ as w,Pp as x,Sh as y,E_ as z};
