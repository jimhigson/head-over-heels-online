const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-OTRMOWZd.js","assets/webworkerAll-BWeqVGSw.js","assets/Graphics-syCdv5_k.js","assets/colorToUniform-KTpA7KSL.js","assets/index-Bxq02GSZ.js","assets/index-DJxk3PUF.css","assets/campaign-su_oVbP3.js","assets/Cheats-CNyI4upJ.js","assets/pixiContainerToString-CG28Y_gJ.js","assets/gameMain-CLdbNYAj.js","assets/consolidateItems-vH0q63-c.js","assets/testCampaign-CUhr3zP2.js"])))=>i.map(i=>d[i]);
import{b as an,r as v,R as Bu,g as Qe,j as p,_ as er,t as Xe,d as ng,B as tt,D as Ee,L as ig,i as ln,c as Vi,a as Mq}from"./index-Bxq02GSZ.js";function Iq(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(o.push(r),a+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~s?s:~i?i:n.length)),a+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~s?"?":"")+"\\"+n.substring(i))):a+="/"+n;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var wa={exports:{}},va={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hd;function jq(){if(hd)return va;hd=1;var t=an();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,s=t.useState,n=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,d){var f=d(),A=s({inst:{value:f,getSnapshot:d}}),g=A[0].inst,m=A[1];return i(function(){g.value=f,g.getSnapshot=d,l(g)&&m({inst:g})},[h,f,d]),n(function(){return l(g)&&m({inst:g}),h(function(){l(g)&&m({inst:g})})},[h]),o(f),f}function l(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!r(h,f)}catch{return!0}}function c(h,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return va.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,va}var dd;function Bq(){return dd||(dd=1,wa.exports=jq()),wa.exports}var Oq=Bq();const Nq=Bu.useInsertionEffect,zq=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Fq=zq?v.useLayoutEffect:v.useEffect,Lq=Nq||Fq,og=t=>{const e=v.useRef([t,(...r)=>e[0](...r)]).current;return Lq(()=>{e[0]=t}),e[1]},Dq="popstate",Ou="pushState",Nu="replaceState",Uq="hashchange",fd=[Dq,Ou,Nu,Uq],Hq=t=>{for(const e of fd)addEventListener(e,t);return()=>{for(const e of fd)removeEventListener(e,t)}},ag=(t,e)=>Oq.useSyncExternalStore(Hq,t,e),$q=()=>location.search,Gq=({ssrSearch:t=""}={})=>ag($q,()=>t),pd=()=>location.pathname,Wq=({ssrPath:t}={})=>ag(pd,t?()=>t:pd),Yq=(t,{replace:e=!1,state:r=null}={})=>history[e?Nu:Ou](r,"",t),Kq=(t={})=>[Wq(t),Yq],Ad=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Ad]>"u"){for(const t of[Ou,Nu]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,Ad,{value:!0})}const Xq=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",lg=(t="")=>t==="/"?"":t,Qq=(t,e)=>t[0]==="~"?t.slice(1):lg(e)+t,Zq=(t="",e)=>Xq(md(lg(t)),md(e)),md=t=>{try{return decodeURI(t)}catch{return t}},cg={hook:Kq,searchHook:Gq,parser:Iq,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},ug=v.createContext(cg),Qo=()=>v.useContext(ug),hg={},dg=v.createContext(hg),Jq=()=>v.useContext(dg),zu=t=>{const[e,r]=t.hook(t);return[Zq(t.base,e),og((s,n)=>r(Qq(s,t.base),n))]},fg=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),o=n.exec(r)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,d)=>[h,l[d]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[a]:[]]:[!1,null]},ew=({children:t,...e})=>{const r=Qo(),s=e.hook?cg:r;let n=s;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=v.useRef({}),l=a.current,c=l;for(let u in s){const h=u==="base"?s[u]+(e[u]||""):e[u]||s[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,h!==s[u]&&(n=c)}return v.createElement(ug.Provider,{value:n,children:t})},gd=({children:t,component:e},r)=>e?v.createElement(e,{params:r}):typeof t=="function"?t(r):t,tw=t=>{let e=v.useRef(hg);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},_i=({path:t,nest:e,match:r,...s})=>{const n=Qo(),[i]=zu(n),[o,a,l]=r??fg(n.parser,t,i,e),c=tw({...Jq(),...a});if(!o)return null;const u=l?v.createElement(ew,{base:l},gd(s,c)):gd(s,c);return v.createElement(dg.Provider,{value:c,children:u})};v.forwardRef((t,e)=>{const r=Qo(),[s,n]=zu(r),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:d,...f}=t,A=og(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(a?.(m),m.defaultPrevented||(m.preventDefault(),n(o,t)))}),g=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return l&&v.isValidElement(c)?v.cloneElement(c,{onClick:A,href:g}):v.createElement("a",{...f,onClick:A,href:g,className:u?.call?u(s===o):u,children:c,ref:e})});const pg=t=>Array.isArray(t)?t.flatMap(e=>pg(e&&e.type===v.Fragment?e.props.children:e)):[t],rw=({children:t,location:e})=>{const r=Qo(),[s]=zu(r);for(const n of pg(t)){let i=0;if(v.isValidElement(n)&&(i=fg(r.parser,n.props.path,e||s,n.props.nest))[0])return v.cloneElement(n,{match:i})}return null},je=t=>t[Symbol.iterator](),Ln=1e-4,ls=(t,e)=>Math.abs(t-e)<Ln,aN=t=>t===0?Ln:Math.abs(t)<Ln?Ln*Math.sign(t):t,di=["away","towards","left","right"],sw=["awayRight","towardsRight","towardsLeft","awayLeft"],Ys=[...di,...sw],Ag=t=>t==="away"||t==="towards"?"y":"x",lN=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",mg=t=>Fu(Ag(t)),Fu=t=>t==="x"?"y":"x",Mr=(t,...e)=>e.reduce((r,s)=>({x:r.x+(s.x??0),y:r.y+(s.y??0)}),t),nw=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0)}),t),Lu=(t,e)=>({x:t.x*e,y:t.y*e}),fi=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),iw=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),Du=({x:t,y:e,z:r})=>Math.hypot(t,e,r),gg=({x:t,y:e})=>Math.hypot(t,e),cN=({x:t,y:e,z:r})=>t**2+e**2+r**2,Ls=t=>{const e=Du(t);if(e===0)throw new Error("unitVector called with zero length vector");return fi(t,1/e)},re=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n=0,y:i=0,z:o=0})=>({x:e+n,y:r+i,z:s+o}),pe),ow=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n,y:i,z:o})=>({x:e*n,y:r*i,z:s*o}),Zo),Vo=(t,...e)=>e.reduce((r,s)=>({x:r.x-(s.x??0),y:r.y-(s.y??0),z:r.z-(s.z??0)}),t),aw=({x:t,y:e,z:r},{x:s,y:n,z:i})=>t===s&&e===n&&r===i,lw=({x:t,y:e},{x:r,y:s})=>t===r&&e===s,uN=t=>{const{x:e}=t,r=Math.round(e),s=!Number.isInteger(e)&&ls(e,r),{y:n}=t,i=Math.round(n),o=!Number.isInteger(n)&&ls(n,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&ls(t.z,l);return s||o||c?{x:s?r:e,y:o?i:n,z:c?l:a}:t},hN=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),dN=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),cw=Object.freeze({x:0,y:0}),pe=Object.freeze({x:0,y:0,z:0}),Zo=Object.freeze({x:1,y:1,z:1}),fN=["x","y","z"],Rc=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,uw=({x:t,y:e})=>{if(!(ls(t,0)&&ls(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},hw=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],Uu=({x:t,y:e})=>{if(ls(t,0)&&ls(e,0))return;const r=Math.atan2(-e,-t),s=Math.round(8*r/(2*Math.PI))&7;return hw[s]},pN=({x:t,y:e},{x:r,y:s})=>Math.abs(r-t)**2+Math.abs(s-e)**2;var Va={exports:{}},_a={exports:{}},yd;function Lr(){return yd||(yd=1,function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(_a)),_a.exports}var xd;function dw(){return xd||(xd=1,function(t){var e=Lr().default;function r(){t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var s,n={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(S,V,T){S[V]=T.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function d(S,V,T){return Object.defineProperty(S,V,{value:T,enumerable:!0,configurable:!0,writable:!0}),S[V]}try{d({},"")}catch{d=function(T,R,I){return T[R]=I}}function f(S,V,T,R){var I=V&&V.prototype instanceof w?V:w,O=Object.create(I.prototype),D=new _(R||[]);return a(O,"_invoke",{value:F(S,T,D)}),O}function A(S,V,T){try{return{type:"normal",arg:S.call(V,T)}}catch(R){return{type:"throw",arg:R}}}n.wrap=f;var g="suspendedStart",m="suspendedYield",y="executing",x="completed",b={};function w(){}function P(){}function C(){}var E={};d(E,c,function(){return this});var B=Object.getPrototypeOf,j=B&&B(B(k([])));j&&j!==i&&o.call(j,c)&&(E=j);var M=C.prototype=w.prototype=Object.create(E);function z(S){["next","throw","return"].forEach(function(V){d(S,V,function(T){return this._invoke(V,T)})})}function G(S,V){function T(I,O,D,ee){var Z=A(S[I],S,O);if(Z.type!=="throw"){var te=Z.arg,ye=te.value;return ye&&e(ye)=="object"&&o.call(ye,"__await")?V.resolve(ye.__await).then(function(ne){T("next",ne,D,ee)},function(ne){T("throw",ne,D,ee)}):V.resolve(ye).then(function(ne){te.value=ne,D(te)},function(ne){return T("throw",ne,D,ee)})}ee(Z.arg)}var R;a(this,"_invoke",{value:function(O,D){function ee(){return new V(function(Z,te){T(O,D,Z,te)})}return R=R?R.then(ee,ee):ee()}})}function F(S,V,T){var R=g;return function(I,O){if(R===y)throw Error("Generator is already running");if(R===x){if(I==="throw")throw O;return{value:s,done:!0}}for(T.method=I,T.arg=O;;){var D=T.delegate;if(D){var ee=L(D,T);if(ee){if(ee===b)continue;return ee}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(R===g)throw R=x,T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);R=y;var Z=A(S,V,T);if(Z.type==="normal"){if(R=T.done?x:m,Z.arg===b)continue;return{value:Z.arg,done:T.done}}Z.type==="throw"&&(R=x,T.method="throw",T.arg=Z.arg)}}}function L(S,V){var T=V.method,R=S.iterator[T];if(R===s)return V.delegate=null,T==="throw"&&S.iterator.return&&(V.method="return",V.arg=s,L(S,V),V.method==="throw")||T!=="return"&&(V.method="throw",V.arg=new TypeError("The iterator does not provide a '"+T+"' method")),b;var I=A(R,S.iterator,V.arg);if(I.type==="throw")return V.method="throw",V.arg=I.arg,V.delegate=null,b;var O=I.arg;return O?O.done?(V[S.resultName]=O.value,V.next=S.nextLoc,V.method!=="return"&&(V.method="next",V.arg=s),V.delegate=null,b):O:(V.method="throw",V.arg=new TypeError("iterator result is not an object"),V.delegate=null,b)}function Q(S){var V={tryLoc:S[0]};1 in S&&(V.catchLoc=S[1]),2 in S&&(V.finallyLoc=S[2],V.afterLoc=S[3]),this.tryEntries.push(V)}function q(S){var V=S.completion||{};V.type="normal",delete V.arg,S.completion=V}function _(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(Q,this),this.reset(!0)}function k(S){if(S||S===""){var V=S[c];if(V)return V.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var T=-1,R=function I(){for(;++T<S.length;)if(o.call(S,T))return I.value=S[T],I.done=!1,I;return I.value=s,I.done=!0,I};return R.next=R}}throw new TypeError(e(S)+" is not iterable")}return P.prototype=C,a(M,"constructor",{value:C,configurable:!0}),a(C,"constructor",{value:P,configurable:!0}),P.displayName=d(C,h,"GeneratorFunction"),n.isGeneratorFunction=function(S){var V=typeof S=="function"&&S.constructor;return!!V&&(V===P||(V.displayName||V.name)==="GeneratorFunction")},n.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,C):(S.__proto__=C,d(S,h,"GeneratorFunction")),S.prototype=Object.create(M),S},n.awrap=function(S){return{__await:S}},z(G.prototype),d(G.prototype,u,function(){return this}),n.AsyncIterator=G,n.async=function(S,V,T,R,I){I===void 0&&(I=Promise);var O=new G(f(S,V,T,R),I);return n.isGeneratorFunction(V)?O:O.next().then(function(D){return D.done?D.value:O.next()})},z(M),d(M,h,"Generator"),d(M,c,function(){return this}),d(M,"toString",function(){return"[object Generator]"}),n.keys=function(S){var V=Object(S),T=[];for(var R in V)T.push(R);return T.reverse(),function I(){for(;T.length;){var O=T.pop();if(O in V)return I.value=O,I.done=!1,I}return I.done=!0,I}},n.values=k,_.prototype={constructor:_,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(q),!V)for(var T in this)T.charAt(0)==="t"&&o.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=s)},stop:function(){this.done=!0;var V=this.tryEntries[0].completion;if(V.type==="throw")throw V.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var T=this;function R(te,ye){return D.type="throw",D.arg=V,T.next=te,ye&&(T.method="next",T.arg=s),!!ye}for(var I=this.tryEntries.length-1;I>=0;--I){var O=this.tryEntries[I],D=O.completion;if(O.tryLoc==="root")return R("end");if(O.tryLoc<=this.prev){var ee=o.call(O,"catchLoc"),Z=o.call(O,"finallyLoc");if(ee&&Z){if(this.prev<O.catchLoc)return R(O.catchLoc,!0);if(this.prev<O.finallyLoc)return R(O.finallyLoc)}else if(ee){if(this.prev<O.catchLoc)return R(O.catchLoc,!0)}else{if(!Z)throw Error("try statement without catch or finally");if(this.prev<O.finallyLoc)return R(O.finallyLoc)}}}},abrupt:function(V,T){for(var R=this.tryEntries.length-1;R>=0;--R){var I=this.tryEntries[R];if(I.tryLoc<=this.prev&&o.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var O=I;break}}O&&(V==="break"||V==="continue")&&O.tryLoc<=T&&T<=O.finallyLoc&&(O=null);var D=O?O.completion:{};return D.type=V,D.arg=T,O?(this.method="next",this.next=O.finallyLoc,b):this.complete(D)},complete:function(V,T){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&T&&(this.next=T),b},finish:function(V){for(var T=this.tryEntries.length-1;T>=0;--T){var R=this.tryEntries[T];if(R.finallyLoc===V)return this.complete(R.completion,R.afterLoc),q(R),b}},catch:function(V){for(var T=this.tryEntries.length-1;T>=0;--T){var R=this.tryEntries[T];if(R.tryLoc===V){var I=R.completion;if(I.type==="throw"){var O=I.arg;q(R)}return O}}throw Error("illegal catch attempt")},delegateYield:function(V,T,R){return this.delegate={iterator:k(V),resultName:T,nextLoc:R},this.method==="next"&&(this.arg=s),b}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Va)),Va.exports}var ka,bd;function Dr(){if(bd)return ka;bd=1;var t=dw()();ka=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return ka}var vt={},Sa={exports:{}},Ca={exports:{}},Pa={exports:{}},qd;function fw(){return qd||(qd=1,function(t){var e=Lr().default;function r(s,n){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,n||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Pa)),Pa.exports}var wd;function yg(){return wd||(wd=1,function(t){var e=Lr().default,r=fw();function s(n){var i=r(n,"string");return e(i)=="symbol"?i:i+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(Ca)),Ca.exports}var vd;function pw(){return vd||(vd=1,function(t){var e=yg();function r(s,n,i){return(n=e(n))in s?Object.defineProperty(s,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[n]=i,s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Sa)),Sa.exports}var Ea={exports:{}},Ta={exports:{}},Ra={exports:{}},Vd;function xg(){return Vd||(Vd=1,function(t){function e(r,s){(s==null||s>r.length)&&(s=r.length);for(var n=0,i=Array(s);n<s;n++)i[n]=r[n];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ra)),Ra.exports}var _d;function Aw(){return _d||(_d=1,function(t){var e=xg();function r(s){if(Array.isArray(s))return e(s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ta)),Ta.exports}var Ma={exports:{}},kd;function mw(){return kd||(kd=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ma)),Ma.exports}var Ia={exports:{}},Sd;function bg(){return Sd||(Sd=1,function(t){var e=xg();function r(s,n){if(s){if(typeof s=="string")return e(s,n);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,n):void 0}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ia)),Ia.exports}var ja={exports:{}},Cd;function gw(){return Cd||(Cd=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ja)),ja.exports}var Pd;function Hu(){return Pd||(Pd=1,function(t){var e=Aw(),r=mw(),s=bg(),n=gw();function i(o){return e(o)||r(o)||s(o)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(Ea)),Ea.exports}var Ba={},Oa={},Ed;function Jo(){if(Ed)return Oa;Ed=1;function t(e){return typeof e<"u"}return Oa.notUndefined=t,Oa}var Td;function qg(){if(Td)return Ba;Td=1;var t=Jo(),e=t.notUndefined;function r(s){return s!=null&&e(s[Symbol.iterator])}return Ba.isIterable=r,Ba}var Na={},Rd;function yw(){return Rd||(Rd=1,Na.isLoopable=qg().isIterable),Na}var za={},Md;function xw(){if(Md)return za;Md=1;var t=Jo(),e=t.notUndefined;function r(s){return s==null||e(s[Symbol.iterator])}return za.isWrappable=r,za}var ki={},Id;function bw(){if(Id)return ki;Id=1;var t=Dr(),e=t.mark(s),r=t.mark(n);function s(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(i,"t0",1);case 1:case"end":return a.stop()}},e)}ki.wrap=s;function n(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i==null){a.next=2;break}return a.delegateYield(i,"t0",2);case 2:case"end":return a.stop()}},r)}return ki.nullableWrap=n,ki}var Si={},jd;function qw(){if(jd)return Si;jd=1;var t=Hu();function e(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.length,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return i<=l.length?n.apply(void 0,t(o).concat(l)):e(n,i-l.length,[].concat(t(o),l))}}Si.curry=e;function r(n,i){var o=n.fn,a=n.validateArgs,l=n.variadic,c=n.reduces,u=n.growRight,h=n.minArgs,d=n.maxArgs,f=n.isIterable,A=n.iterableType,g=n.applyOnIterableArgs,m=n.IterableClass;if(i.length>h){var y=!0,x=l?i.findIndex(function(j,M){return f(j)&&M>=h}):Math.min(d,i.length-1),b=l?i.length:x+1;if(l)for(var w=x;w<i.length;w++)y=y&&f(i[w]);else y=f(i[x]);if(i.length>d&&(x===-1||!y)){var P=l?"...".concat(A,"s"):A,C="".concat(o.name," takes up to ").concat(d," arguments, followed by ").concat(P,". ")+"You already passed ".concat(i.length," arguments");throw l?new Error("".concat(C," and the following arguments were not all ").concat(A,"s")):new Error("".concat(C," and the last argument was not ").concat(A))}if(x>=0&&y){for(var E=x;E<b;E++)i[E]=g(i[E]);var B=l?i.slice(x):i[x];return i.splice(x),u||i.reverse(),i.unshift(B),a(i),c?o.apply(void 0,t(i)):new m(o,i)}}return s(n,i)}function s(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];if(a.length===0)throw new Error("Cannot make a partial application with no arguments");return a.unshift.apply(a,t(i)),r(n,a)}}return Si.variadicCurryWithValidation=s,Si}var bn={},Bd;function ww(){if(Bd)return bn;Bd=1;var t=Symbol.for("_");bn._=t;var e=Symbol("__iterate");bn.__iterate=e;var r=Symbol("split");return bn.split=r,bn}var Od;function Ot(){if(Od)return vt;Od=1;var t=pw(),e=Hu(),r,s=qg(),n=s.isIterable,i=yw(),o=i.isLoopable,a=xw(),l=a.isWrappable,c=bw(),u=c.nullableWrap,h=qw(),d=h.variadicCurryWithValidation,f=ww(),A=f._,g=f.__iterate;vt.wrap=u,vt.isIterable=n,vt.isLoopable=o,vt.isWrappable=l;function m(B){if(l(B))return n(B)?B:u(B);throw typeof B.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}vt.ensureIterable=m;function y(B){"return"in B&&B.return()}vt.callReturn=y;function x(B,j){this[A]={fn:B,args:j,staticIterator:null}}vt.BaseIterableIterator=x,Object.assign(x.prototype,(r={constructor:x},t(r,g,function(){var B=this[A],j=B.fn,M=B.args;return j.apply(void 0,e(M))}),t(r,"next",function(){var j=this[A];return j.staticIterator=j.staticIterator||this[g](),j.staticIterator.next()}),t(r,"return",function(j){var M=this[A];return M.staticIterator=M.staticIterator||this[g](),M.staticIterator.return(j)}),t(r,"throw",function(j){var M=this[A];return M.staticIterator=M.staticIterator||this[g](),M.staticIterator.throw(j)}),r));function b(){for(var B=arguments.length,j=new Array(B),M=0;M<B;M++)j[M]=arguments[M];x.apply(this,j)}vt.IterableIterator=b,b.prototype=Object.assign(Object.create(x.prototype),t({constructor:b},Symbol.iterator,function(){return this[g]()}));function w(B){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=j.validateArgs,z=M===void 0?function(O){}:M,G=j.variadic,F=G===void 0?!1:G,L=j.reduces,Q=L===void 0?!1:L,q=j.growRight,_=q===void 0?!1:q,k=j.minArgs,S=k===void 0?B.length-1:k,V=j.maxArgs,T=V===void 0?B.length-1:V,R=j.applyOnIterableArgs,I=R===void 0?m:R;return{fn:B,validateArgs:z,variadic:F,reduces:Q,growRight:_,minArgs:S,maxArgs:T,isIterable:l,iterableType:"iterable",applyOnIterableArgs:I,IterableClass:b}}function P(B){return e(B)}vt.cache=P;function C(B){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=j.validateArgs,z=M===void 0?function(G){return G}:M;return function(){for(var G=arguments.length,F=new Array(G),L=0;L<G;L++)F[L]=arguments[L];return z(F),new b(B,F)}}vt.wrapWithIterableIterator=C;var E=function(j,M){return d(w(j,M))};return vt.iterableCurry=E,vt}var Fa={exports:{}},Nd;function $u(){return Nd||(Nd=1,function(t){function e(r,s){if(!(r instanceof s))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Fa)),Fa.exports}var La={exports:{}},zd;function Gu(){return zd||(zd=1,function(t){var e=yg();function r(n,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,e(a.key),a)}}function s(n,i,o){return i&&r(n.prototype,i),o&&r(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(La)),La.exports}var Da={exports:{}},Ua={exports:{}},Fd;function wg(){return Fd||(Fd=1,function(t){function e(r,s){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ua)),Ua.exports}var Ld;function vw(){return Ld||(Ld=1,function(t){var e=wg();function r(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(n&&n.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),n&&e(s,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Da)),Da.exports}var Ha={exports:{}},$a={exports:{}},Dd;function Vw(){return Dd||(Dd=1,function(t){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}($a)),$a.exports}var Ud;function _w(){return Ud||(Ud=1,function(t){var e=Lr().default,r=Vw();function s(n,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(n)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(Ha)),Ha.exports}var Ga={exports:{}},Hd;function vg(){return Hd||(Hd=1,function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ga)),Ga.exports}var Wa={exports:{}},Ya={exports:{}},$d;function kw(){return $d||($d=1,function(t){function e(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!r},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ya)),Ya.exports}var Gd;function Sw(){return Gd||(Gd=1,function(t){var e=kw(),r=wg();function s(n,i,o){if(e())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,i);var l=new(n.bind.apply(n,a));return o&&r(l,o.prototype),l}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(Wa)),Wa.exports}var Ka={},Wd;function Cw(){if(Wd)return Ka;Wd=1;var t=$u(),e=Gu(),r=function(){function s(){t(this,s)}return e(s,[{key:Symbol.iterator,value:function(){return this}}]),s}();return Ka.IterableIterator=r,Ka}var qn={},Yd;function Vg(){if(Yd)return qn;Yd=1;function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&isFinite(s)&&!(n&&s===0)}qn.isInteger=t;function e(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return t(s)&&(n?s>0:s>=0)}qn.isPositiveInteger=e;function r(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof s=="number"&&!isNaN(s)&&!(n&&s===0)}return qn.isIntegerOrInfinite=r,qn}var Xa={exports:{}},Qa={exports:{}},Kd;function Pw(){return Kd||(Kd=1,function(t){var e=vg();function r(s,n){for(;!{}.hasOwnProperty.call(s,n)&&(s=e(s))!==null;);return s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Qa)),Qa.exports}var Xd;function Ew(){return Xd||(Xd=1,function(t){var e=Pw();function r(){return t.exports=r=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(s,n,i){var o=e(s,n);if(o){var a=Object.getOwnPropertyDescriptor(o,n);return a.get?a.get.call(arguments.length<3?s:i):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(null,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Xa)),Xa.exports}var Za={exports:{}},Ja={exports:{}},Qd;function Tw(){return Qd||(Qd=1,function(t){function e(r){if(Array.isArray(r))return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Ja)),Ja.exports}var el={exports:{}},Zd;function Rw(){return Zd||(Zd=1,function(t){function e(r,s){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,a,l,c=[],u=!0,h=!1;try{if(a=(n=n.call(r)).next,s===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=a.call(n)).done)&&(c.push(i.value),c.length!==s);u=!0);}catch(d){h=!0,o=d}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(h)throw o}}return c}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(el)),el.exports}var tl={exports:{}},Jd;function Mw(){return Jd||(Jd=1,function(t){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(tl)),tl.exports}var ef;function Iw(){return ef||(ef=1,function(t){var e=Tw(),r=Rw(),s=bg(),n=Mw();function i(o,a){return e(o)||r(o,a)||s(o,a)||n()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(Za)),Za.exports}var Ci={},tf;function jw(){if(tf)return Ci;tf=1;var t=Dr(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=s(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(x){throw x},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A=!0,g=!1,m;return{s:function(){h=c[Symbol.iterator]()},n:function(){var x=h.next();return A=x.done,x},e:function(x){g=!0,m=x},f:function(){try{!A&&h.return!=null&&h.return()}finally{if(g)throw m}}}}function s(c,u){if(c){if(typeof c=="string")return n(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return n(c,u)}}function n(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=Ot(),o=i.iterableCurry;function a(c,u){var h,d,f,A;return t.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:h=0,d=r(c),m.prev=2,d.s();case 4:if((f=d.n()).done){m.next=10;break}return A=f.value,m.next=8,u(A,h++);case 8:m.next=4;break;case 10:m.next=15;break;case 12:m.prev=12,m.t0=m.catch(2),d.e(m.t0);case 15:return m.prev=15,d.f(),m.finish(15);case 18:case"end":return m.stop()}},e,null,[[2,12,15,18]])}Ci.__map=a;var l=o(a);return Ci.map=l,Ci}var Pi={},rf;function Bw(){if(rf)return Pi;rf=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(m){throw m},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,A;return{s:function(){c=a[Symbol.iterator]()},n:function(){var m=c.next();return d=m.done,m},e:function(m){f=!0,A=m},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw A}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var s=Ot(),n=s.ensureIterable;function i(a){var l=[],c=t(a),u;try{for(c.s();!(u=c.n()).done;){var h=u.value;l.push(h)}}catch(d){c.e(d)}finally{c.f()}return l}Pi.__toArray=i;function o(a){return i(n(a))}return Pi.toArray=o,Pi}var rl={},sf;function _g(){if(sf)return rl;sf=1;var t=Lr();function e(r){return t(r)==="object"&&r!==null}return rl.isObject=e,rl}var sl={},nf;function Ow(){if(nf)return sl;nf=1;function t(n,i){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=e(n))||i){o&&(n=o);var a=0,l=function(){};return{s:l,n:function(){return a>=n.length?{done:!0}:{done:!1,value:n[a++]}},e:function(f){throw f},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,u=!1,h;return{s:function(){o=n[Symbol.iterator]()},n:function(){var f=o.next();return c=f.done,f},e:function(f){u=!0,h=f},f:function(){try{!c&&o.return!=null&&o.return()}finally{if(u)throw h}}}}function e(n,i){if(n){if(typeof n=="string")return r(n,i);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return r(n,i)}}function r(n,i){(i==null||i>n.length)&&(i=n.length);for(var o=0,a=new Array(i);o<i;o++)a[o]=n[o];return a}function s(n,i){var o=t(n),a;try{for(o.s();!(a=o.n()).done;){var l=a.value;i(l)}}catch(c){o.e(c)}finally{o.f()}}return sl.parallelEach=s,sl}var nl={},of;function Nw(){if(of)return nl;of=1;var t=Sw(),e=$u(),r=Gu(),s=Ot(),n=s.ensureIterable,i=s.callReturn,o=Symbol.for("_"),a=function(){function c(u){e(this,c),this.peekr=u}return r(c,[{key:"next",value:function(){var h=this.peekr,d=h.current;return h.advance(),d}},{key:"return",value:function(){return this.peekr.return(),{value:void 0,done:!0}}},{key:Symbol.iterator,value:function(){return this}}]),c}(),l=function(){r(c,null,[{key:"from",value:function(h){for(var d=n(h)[Symbol.iterator](),f=d.next(),A=arguments.length,g=new Array(A>1?A-1:0),m=1;m<A;m++)g[m-1]=arguments[m];return t(this,[d,f].concat(g))}}]);function c(u,h){e(this,c),this[o]={iterator:u,current:h,index:0}}return r(c,[{key:"advance",value:function(){var h=this[o];return h.current.done||(h.index++,h.current=h.iterator.next()),this}},{key:"return",value:function(){var h=this[o];return this.done||i(h.iterator),h.current={value:void 0,done:!0},this}},{key:"asIterator",value:function(){return new a(this)}},{key:"current",get:function(){return this[o].current}},{key:"value",get:function(){return this[o].current.value}},{key:"done",get:function(){return this[o].current.done}},{key:"index",get:function(){return this[o].index}}]),c}();return nl.Peekerator=l,nl}var il={},af;function zw(){if(af)return il;af=1;var t=Vg(),e=t.isInteger,r=_g(),s=r.isObject,n=Jo(),i=n.notUndefined,o=function(l){return function(u){if(s(u[1])){var h=u[1],d=h.start,f=h.step;u[1]=d,u[2]=f}if(i(u[2])&&(u[2]=Number(u[2]),!e(u[2],!0)))throw new Error("step argument to ".concat(l," must be a non-zero integer"))}};return il.makeValidateArgs=o,il}var wn={},lf;function Fw(){if(lf)return wn;lf=1;var t=Hu(),e=$u(),r=Gu(),s=Ew(),n=vw(),i=_w(),o=vg();function a(L){var Q=l();return function(){var _=o(L),k;if(Q){var S=o(this).constructor;k=Reflect.construct(_,arguments,S)}else k=_.apply(this,arguments);return i(this,k)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var c=Ot(),u=c.iterableCurry,h=c.callReturn,d=Cw(),f=d.IterableIterator,A=Ow(),g=A.parallelEach,m=Nw(),y=m.Peekerator,x=jw(),b=x.__map,w=Bw(),P=w.__toArray,C=Symbol.for("_"),E=Symbol.for("__advance"),B=function(L){n(q,L);var Q=a(q);function q(_,k,S){var V;return e(this,q),V=Q.call(this,_,k),V[C].inputSummary=S,V}return r(q,[{key:"advance",value:function(){this[C].inputSummary.advanceBuffer(this)}},{key:E,value:function(){s(o(q.prototype),"advance",this).call(this)}}]),q}(y),j=function(){function L(){e(this,L),this.buffers=[],this.notDoneBuffer=null,this.index=0}return r(L,[{key:"init",value:function(q){this.buffers=q,this.updateNotDone()}},{key:"updateNotDone",value:function(){this.notDoneBuffer=this.buffers.find(function(q){return!q.done})}},{key:"advanceBuffer",value:function(q){var _=q.done;q[E](),this.index++,!_&&q.done&&this.updateNotDone()}}]),L}(),M=function(){function L(Q){e(this,L),this[C]=Q}return r(L,[{key:"advance",value:function(){throw new Error("advance() is not supported on an interleave summary")}},{key:"current",get:function(){return{value:this.value,done:this.done}}},{key:"value",get:function(){return this[C].notDoneBuffer}},{key:"done",get:function(){return this[C].notDoneBuffer===void 0}},{key:"index",get:function(){return this[C].index}}]),L}();wn.InputSummary=M;var z=function(L){n(q,L);var Q=a(q);function q(_,k,S){var V;return e(this,q),V=Q.call(this),V.sources=_,V.strategy=k,V.options=S,V.initialized=!1,V.inputSummary=new j(_),V}return r(q,[{key:"init",value:function(){this.initialized=!0;var k=this.strategy,S=this.options,V=this.inputSummary;this.buffers=P(b(this.sources,function(T){return B.from(T,V)})),this.iterator=k.apply(void 0,[S,new M(V)].concat(t(this.buffers))),V.init(this.buffers)}},{key:"returnBuffers",value:function(){g(this.buffers,function(k){return k.return()})}},{key:"next",value:function(){this.initialized||this.init();var k=this.iterator.next();return k.done&&this.returnBuffers(),k}},{key:"return",value:function(){return h(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}]),q}(f);function G(L,Q){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new z(L,Q,q)}wn.__interleave=G;var F=u(G,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return wn.interleave=F,wn}var Ei={},Ti={},cf;function Lw(){if(cf)return Ti;cf=1;var t=Ot(),e=t.iterableCurry,r=t.callReturn;function s(i,o){var a=i[Symbol.iterator](),l=a.next(),c=l.value,u=l.done;return u?o:(r(a),c)}Ti.__firstOr=s;var n=e(s,{reduces:!0});return Ti.firstOr=n,Ti}var uf;function Dw(){if(uf)return Ei;uf=1;var t=Ot(),e=t.iterableCurry,r=Lw(),s=r.__firstOr;function n(o){return s(o,void 0)}Ei.__first=n;var i=e(n,{reduces:!0});return Ei.first=i,Ei}var Ri={},hf;function Uw(){if(hf)return Ri;hf=1;var t=Lr(),e=Dr(),r=e.mark(o),s=Ot(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,[c,l[c]];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Ri.__objectEntries=o;var a=n(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return Ri.objectEntries=a,Ri}var Mi={},df;function Hw(){if(df)return Mi;df=1;var t=Lr(),e=Dr(),r=e.mark(o),s=Ot(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,c;case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Mi.__objectKeys=o;var a=n(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return Mi.objectKeys=a,Mi}var Ii={},ff;function $w(){if(ff)return Ii;ff=1;var t=Lr(),e=Dr(),r=e.mark(o),s=Ot(),n=s.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,l[c];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Ii.__objectValues=o;var a=n(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return Ii.objectValues=a,Ii}var ji={},pf;function Gw(){if(pf)return ji;pf=1;var t=Iw(),e=Dr(),r=e.mark(d),s=Ot(),n=s.wrapWithIterableIterator,i=Vg(),o=i.isInteger,a=i.isIntegerOrInfinite,l=_g(),c=l.isObject,u=Jo(),h=u.notUndefined;function d(){var A,g,m,y,x=arguments;return e.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:A=x.length>0&&x[0]!==void 0?x[0]:0,g=x.length>1&&x[1]!==void 0?x[1]:1/0,m=x.length>2&&x[2]!==void 0?x[2]:1,y=A;case 4:if(!(m>0?y<g:y>g)){w.next=10;break}return w.next=7,y;case 7:y+=m,w.next=4;break;case 10:case"end":return w.stop()}},r)}ji.__range=d;var f=n(d,{growRight:!0,validateArgs:function(g){var m=t(g,3),y=m[0],x=m[1],b=x===void 0?1/0:x,w=m[2],P;if(c(y)?(P=y.start,b=y.end,w=y.step):g.length>1?P=y:b=y,h(P)&&!o(P))throw new TypeError("The specified start was not an integer");if(h(b)&&!a(b))throw new TypeError("The specified end was not an integer or infinite");if(h(w)&&!o(w,!0))throw new TypeError("The specified step was not a non-zero integer");g[0]=P,g[1]=b,g[2]=w}});return ji.range=f,ji}var Bi={},Af;function Ww(){if(Af)return Bi;Af=1;var t=Dr(),e=t.mark(l),r=Ot(),s=r.iterableCurry,n=Fw(),i=n.__interleave,o=zw(),a=o.makeValidateArgs;function l(h,d){var f,A,g,m,y,x,b,w=arguments;return t.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:for(f=h.start,A=h.step,g=w.length,m=new Array(g>2?g-2:0),y=2;y<g;y++)m[y-2]=w[y];f=f%m.length,x=f;case 4:if(d.done){C.next=13;break}if(b=m[x],b.done){C.next=10;break}return C.next=9,b.value;case 9:b.advance();case 10:x=(x+A)%m.length,C.next=4;break;case 13:case"end":return C.stop()}},e)}function c(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i(h,l,{start:f,step:d})}Bi.__roundRobin=c;var u=s(c,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:a("roundRobin")});return Bi.roundRobin=u,Bi}var Oi={},mf;function Yw(){if(mf)return Oi;mf=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(m){throw m},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,A;return{s:function(){c=a[Symbol.iterator]()},n:function(){var m=c.next();return d=m.done,m},e:function(m){f=!0,A=m},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw A}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var s=Ot(),n=s.ensureIterable;function i(a){var l=n(a),c=0,u=t(l),h;try{for(u.s();!(h=u.n()).done;){var d=h.value;c++}}catch(f){u.e(f)}finally{u.f()}return c}Oi.__size=i;var o=i;return Oi.size=o,Oi}var Ni={},gf;function Kw(){if(gf)return Ni;gf=1;var t=Dr(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=s(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(x){throw x},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A=!0,g=!1,m;return{s:function(){h=c[Symbol.iterator]()},n:function(){var x=h.next();return A=x.done,x},e:function(x){g=!0,m=x},f:function(){try{!A&&h.return!=null&&h.return()}finally{if(g)throw m}}}}function s(c,u){if(c){if(typeof c=="string")return n(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return n(c,u)}}function n(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=Ot(),o=i.iterableCurry;function a(c,u){var h,d,f,A;return t.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(u!==0){m.next=2;break}return m.abrupt("return");case 2:h=0,d=r(c),m.prev=4,d.s();case 6:if((f=d.n()).done){m.next=14;break}return A=f.value,m.next=10,A;case 10:if(++h!==u){m.next=12;break}return m.abrupt("break",14);case 12:m.next=6;break;case 14:m.next=19;break;case 16:m.prev=16,m.t0=m.catch(4),d.e(m.t0);case 19:return m.prev=19,d.f(),m.finish(19);case 22:case"end":return m.stop()}},e,null,[[4,16,19,22]])}Ni.__take=a;var l=o(a);return Ni.take=l,Ni}var ol,yf;function Xw(){return yf||(yf=1,ol=Dw().first),ol}var Qw=Xw();const Zw=Qe(Qw);var al,xf;function Jw(){return xf||(xf=1,al=Uw().objectEntries),al}var ev=Jw();const Wu=Qe(ev);var ll,bf;function tv(){return bf||(bf=1,ll=Hw().objectKeys),ll}var rv=tv();const kg=Qe(rv);var cl,qf;function sv(){return qf||(qf=1,cl=$w().objectValues),cl}var nv=sv();const ms=Qe(nv);var ul,wf;function iv(){return wf||(wf=1,ul=Gw().range),ul}var ov=iv();const Sg=Qe(ov);var hl,vf;function av(){return vf||(vf=1,hl=Ww().roundRobin),hl}var lv=av();const cv=Qe(lv);var dl,Vf;function uv(){return Vf||(Vf=1,dl=Yw().size),dl}var hv=uv();const Mc=Qe(hv);var fl,_f;function dv(){return _f||(_f=1,fl=Kw().take),fl}var fv=dv();const pv=Qe(fv),Gr=(t,{x:e,y:r},s)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:r,...s}}],yield[`${t}.away`,{frame:{x:e+s.w+1,y:r,...s}}],yield[`${t}.towards`,{frame:{x:e,y:r+s.h+1,...s}}],yield[`${t}.right`,{frame:{x:e+s.w+1,y:r+s.h+1,...s}}]}return Object.fromEntries(n())},Ce=(t,e,{x:r,y:s},n,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a%i*(n.w+1),y:s+Math.floor(a/i)*(n.h+1),...n}}]}return Object.fromEntries(o())},Av=(t,e,r,s)=>({...Ce(`${t}.left`,e,r,s),...Ce(`${t}.away`,e,Mr(r,{x:(s.w+1)*e}),s),...Ce(`${t}.towards`,e,Mr(r,{y:s.h+1}),s),...Ce(`${t}.right`,e,Mr(r,{x:(s.w+1)*e,y:s.h+1}),s)}),Tn=(t,e)=>[...je(Sg(1,e+1)).map(r=>`${t}.${String(r)}`)],Ic={w:32,h:16},Pt={w:16,h:56},ae={w:32,h:28},H={w:24,h:24},fo={w:8,h:8},$=t=>({x:t.x*(H.w+1)+1,y:t.y*(H.h+1)+2}),he=t=>({x:t.x*(ae.w+1)+1,y:t.y*(ae.h+1)+396}),AN=["yellow","cyan","green","magenta","white"],mN=["basic","dimmed"],pi=25,gN=1e3/pi,cn={amigaHiResPal:{x:640,y:512},classicMac:{x:512,y:384},amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},mv=Object.keys(cn),yN={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},ge=(t,e)=>Object.assign([...t],{animationSpeed:e}),gv=.5,Cg=5e3,yv=Cg*2,vn=(t,e)=>{const r=Math.round(Cg/(pi*4)),s=`head.walking.${t}.${e}`,n=`head.blinking.${t}`,i=[...new Array(r-3).fill(s),n,s,n];return ge(i,.5)},pl=(t,e)=>{const r=Math.round(yv/(pi*4)),s=`heels.walking.${t}.${e}`,n=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(s),...new Array(Math.ceil(r*.2)).fill(n)];return ge(i,.5)},kf=(t,e,r)=>{const s=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*n(){for(let i=0;i<Ys.length;i++){const o=s[i];for(let a=0;a<=2;a++)yield[`${t}.walking.${o}.${a+1}`,{frame:{...$({x:e.x+a,y:e.y+i}),...H}}];yield[`${t}.falling.${o}`,{frame:{...$({x:e.x+3,y:e.y+i}),...H}}],r[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...$({x:e.x+4,y:e.y+i}),...H}}])}}return Object.fromEntries(n())};function Sf(t){function*e(r,s){yield`${r}.walking.${s}.1`,yield`${r}.walking.${s}.2`,yield`${r}.walking.${s}.3`,yield`${r}.walking.${s}.2`}return Ys.reduce((r,s)=>({...r,[`${t}.walking.${s}`]:ge([...e(t,s)],gv)}),{})}const xv={...Ce("bubbles.head",6,$({x:0,y:6}),H),...kf("head",{x:0,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},left:{noBlinking:!0}}),...Ce("bubbles.heels",6,$({x:6,y:6}),H),...kf("heels",{x:5,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},awayRight:{noBlinking:!0},towardsLeft:{noBlinking:!0},left:{noBlinking:!0}}),...Ce("shine",6,he({x:8,y:-2}),ae,3),blank:{frame:{...$({x:0,y:2}),...H}}},Pg={frames:xv,animations:{...Sf("head"),...Sf("heels"),"heels.screenDirections":ge(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":ge(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":vn("right",3),"head.idle.towards":vn("towards",3),"head.idle.towardsRight":vn("towardsRight",2),"head.idle.towardsLeft":vn("towardsLeft",2),"head.idle.awayRight":vn("awayRight",2),"heels.idle.right":pl("right",2),"heels.idle.towards":pl("towards",2),"heels.idle.towardsRight":pl("towardsRight",2),"head.fadeOut":ge(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":ge(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:ge(Tn("shine",6),.5),"shine.headInSymbio":ge(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":ge(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},Eg={jail:["bars"],blacktooth:["armour","shield","plain"],bookworld:["cowboy","book"],egyptus:["sarcophagus","hieroglyphics"],market:["passage","fruits","more-fruits"],moonbase:["window1","window2","window3","coil"],penitentiary:["loop","skeleton"],safari:["window","shield","wall"]},xN=Object.keys(Eg),bN=["blacktooth","penitentiary","bookworld","egyptus","safari"],rt=(t,e,r,s)=>{function*n(i,o,a){const l=Eg[i],{w:c,h:u}=Pt,h=c>>1,d=l.length;let f=0;for(;f<l.length;f++)yield[`${i}${s}.wall.${l[f]}.left`,{frame:{x:o+c*f,y:a-h*f,...Pt}}],yield[`${i}${s}.wall.${l[f]}.away`,{frame:{x:o+c*((d<<1)-f-1),y:a-h*f,...Pt}}];const A=f-1;yield[`${i}${s}.floor`,{frame:{x:o+A*c,y:a-A*h+u,...Ic}}]}return Object.fromEntries(n(t,e,r))},Cf={w:16,h:13},Pf={w:8,h:9},bv={...rt("blacktooth",542,104,".dark"),...rt("blacktooth",542,29,""),...rt("bookworld",408,29,".dark"),...rt("bookworld",408,29,""),...rt("egyptus",475,29,""),...rt("egyptus",475,104,".dark"),...rt("jail",440,104,".dark"),...rt("jail",440,104,""),...rt("market",443,357,".dark"),...rt("market",443,357,""),...rt("moonbase",453,276,".dark"),...rt("moonbase",453,204,""),...rt("penitentiary",376,357,".dark"),...rt("penitentiary",376,357,""),...rt("safari",542,357,".dark"),...rt("safari",542,357,""),"floorEdge.right":{frame:{x:418,y:466,...Cf,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...Cf,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...Pf,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...Pf,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Pt.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:407,y:143,...Ic}},"generic.dark.floor.deadly":{frame:{x:407,y:160,...Ic}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Pt.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Pt.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Pt.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Pt.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Pt.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Pt.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Pt.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...Ce("moonbase.wall.screen.window1.away",3,{x:566,y:196},{w:10,h:7}),...Ce("moonbase.wall.screen.window2.away",2,{x:550,y:188},{w:10,h:7}),...Ce("moonbase.wall.screen.window3.away",4,{x:534,y:180},{w:10,h:7})},Tg={frames:bv,animations:{"moonbase.wall.screen.window1.away":ge(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":ge(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":ge(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},Ai=Object.entries,Yu=Wu,Rg=Object.keys,Ku=kg,qv=Object.fromEntries,un=Object.fromEntries,Mg=(t,e)=>{const s=je(Yu(t)).map(e);return qv(s)},wv={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},Ig=t=>wv[t]??t,jg="",vv="",Vv="",_v="",kv="",Sv="",Cv=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","","","","",{char:"",double:!0},{char:jg,double:!0},{char:vv,double:!0}],Pv=[" ","?","!",".",",",";",":","/","\\","","","'","`","-","+","%","","","","","","","","","(",")","[","]","<",">","","","","EnterFullscreen","ExitFullscreen","Menu","*","@",Vv,_v,kv,Sv,"","","^","",""],Ef=(t,e)=>{function*r(){let{x:s}=e;for(let n=0;n<t.length;n++){const i=t[n],o=typeof i=="string"?i:i.char,l=(typeof i=="string"?!1:i.double)?fo.w*2:fo.w;yield[`hud.char.${Ig(o)}`,{frame:{x:s,y:e.y,...fo,w:l}}],s+=l+1}}return un(r())},Ev={frames:{...Ef(Cv,{x:151,y:2}),...Ef(Pv,{x:151,y:11})}},ws=(t,e,r)=>{const s=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...Mr(r,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...Mr(r,{x:i+2,y:o}),w:a,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.whole`,{frame:{...s({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...s({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...s({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...s({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return un(n())},Tv={frames:{...ws("generic","y",{x:580,y:415}),...ws("generic","x",{x:582,y:415}),...ws("moonbase","y",{x:451,y:204}),...ws("moonbase","x",{x:582,y:204}),...ws("moonbase.dark","y",{x:451,y:276}),...ws("moonbase.dark","x",{x:582,y:276})}},Rv={...Ce("dalek",2,$({x:0,y:0}),H),"shadowMask.dalek":{frame:{...$({x:2,y:0}),...H}},...Ce("bubbles.cold",2,$({x:3,y:0}),H),...Gr("cyberman",$({x:1,y:1}),H),...Gr("charles",$({x:3,y:1}),H),"shadowMask.charles.away":{frame:{...$({x:5,y:1}),...H}},"shadowMask.charles.right":{frame:{...$({x:5,y:2}),...H}},...Gr("elephant",$({x:6,y:1}),H),"crown.blacktooth":{frame:{...$({x:8,y:1}),...H}},"crown.safari":{frame:{...$({x:9,y:1}),...H}},"crown.egyptus":{frame:{...$({x:10,y:1}),...H}},"crown.penitentiary":{frame:{...$({x:11,y:1}),...H}},"crown.bookworld":{frame:{...$({x:12,y:1}),...H}},ball:{frame:{...$({x:13,y:1}),...H}},"shadowMask.ball":{frame:{...$({x:14,y:1}),...H}},sticks:{frame:{...$({x:8,y:2}),...H}},cube:{frame:{...$({x:9,y:2}),...H}},drum:{frame:{...$({x:10,y:2}),...H}},hooter:{frame:{...$({x:11,y:2}),...H}},bag:{frame:{...$({x:12,y:2}),...H}},joystick:{frame:{...$({x:13,y:2}),...H}},"shadowMask.joystick":{frame:{...$({x:14,y:2}),...H}},...Av("turtle",2,$({x:0,y:3}),H),"shadowMask.turtle.away":{frame:{...$({x:4,y:3}),...H}},"shadowMask.turtle.right":{frame:{...$({x:4,y:4}),...H}},...Gr("monkey",$({x:5,y:3}),H),...Gr("computerBot",$({x:7,y:3}),H),"spring.compressed":{frame:{...$({x:9,y:3}),...H}},"spring.released":{frame:{...$({x:10,y:3}),...H}},"switch.left":{frame:{...$({x:11,y:3}),...H}},"switch.right":{frame:{...$({x:12,y:3}),...H}},"shadowMask.switch":{frame:{...$({x:13,y:3}),...H}},tower:{frame:{...$({x:14,y:3}),...H}},"shadowMask.tower":{frame:{...$({x:15,y:3}),...H}},scroll:{frame:{...$({x:9,y:4}),...H,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...$({x:10,y:4}),...H,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...$({x:11,y:4}),...H,pivot:{x:17,y:24}}},"spikyBall.1":{frame:{...$({x:12,y:4}),...H}},"spikyBall.2":{frame:{...$({x:13,y:4}),...H}},puck:{frame:{...$({x:14,y:4}),...H}},"shadow.smallRound":{frame:{...$({x:15,y:4}),...H}},"shadowMask.smallRound":{frame:{...$({x:16,y:4}),...H}},...Ce("helicopterBug",4,$({x:0,y:5}),H),"barrier.x":{frame:{...$({x:4,y:5}),...H,pivot:{x:18,y:23}}},"barrier.y":{frame:{...$({x:5,y:5}),...H,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...$({x:6,y:5}),...H,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...$({x:7,y:5}),...H,pivot:{x:6,y:22}}},...Ce("bubbles.taupe",3,$({x:8,y:5}),H),whiteRabbit:{frame:{...$({x:11,y:5}),...H}},"shadowMask.whiteRabbit":{frame:{...$({x:12,y:5}),...H}},...Ce("bubbles.white",3,$({x:13,y:5}),H),...Ce("fish",2,$({x:12,y:6}),H),doughnuts:{frame:{...$({x:14,y:6}),...H}},"shadowMask.doughnuts":{frame:{...$({x:15,y:6}),...H}},"lift.static":{frame:{...$({x:10,y:7}),...H}},"shadow.smallBlock":{frame:{...$({x:11,y:7}),...H}},"shadowMask.smallBlock":{frame:{...$({x:12,y:7}),...H}},...Ce("lift",4,$({x:10,y:8}),H),headlessBase:{frame:{...$({x:14,y:8}),...H}},...Ce("headlessBase",4,$({x:10,y:9}),H),"headlessBase.all":{frame:{...$({x:14,y:9}),...H}},...Gr("skiHead.greenAndPink",{x:251,y:252},{w:24,h:32}),...Gr("skiHead.starsAndStripes",{x:301,y:252},{w:24,h:32}),"shadowMask.skiHead.away":{frame:{x:351,y:252,w:24,h:32}},"shadowMask.skiHead.right":{frame:{x:351,y:285,w:24,h:32}},"editor.cursor.xz":{frame:{...he({x:7,y:-2}),...ae}},"editor.cursor.floor":{frame:{...he({x:7,y:-1}),...ae}},"block.organic":{frame:{...he({x:0,y:0}),...ae}},"block.organic.disappearing":{frame:{...he({x:1,y:0}),...ae}},"block.organic.dark":{frame:{...he({x:2,y:0}),...ae}},"block.organic.dark.disappearing":{frame:{...he({x:3,y:0}),...ae}},"block.artificial":{frame:{...he({x:4,y:0}),...ae}},"block.artificial.disappearing":{frame:{...he({x:5,y:0}),...ae}},"book.x":{frame:{...he({x:6,y:0}),...ae}},"book.y":{frame:{...he({x:7,y:0}),...ae}},"shadow.fullBlock":{frame:{...he({x:8,y:0}),...ae}},"shadowMask.fullBlock":{frame:{...he({x:9,y:0}),...ae}},stepStool:{frame:{...he({x:0,y:1}),...ae}},"shadowMask.stepStool":{frame:{...he({x:1,y:1}),...ae}},"volcano.1":{frame:{...he({x:2,y:1}),...ae}},"volcano.2":{frame:{...he({x:3,y:1}),...ae}},"shadowMask.volcano":{frame:{...he({x:4,y:1}),...ae}},hushPuppy:{frame:{...he({x:5,y:1}),...ae}},"shadowMask.hushPuppy":{frame:{...he({x:6,y:1}),...ae}},"toaster.on":{frame:{...he({x:7,y:1}),...ae}},"toaster.off":{frame:{...he({x:8,y:1}),...ae}},"shadowMask.toaster":{frame:{...he({x:9,y:1}),...ae}},sandwich:{frame:{...he({x:10,y:1}),...ae}},spikes:{frame:{...he({x:11,y:1}),...ae}},"shadowMask.spikes":{frame:{...he({x:12,y:1}),...ae}},...Ce("conveyor.x",7,he({x:0,y:2}),ae),"shadowMask.conveyor":{frame:{...he({x:7,y:2}),...ae}},button:{frame:{...he({x:9,y:2}),...ae}},"button.pressed":{frame:{...he({x:10,y:2}),...ae}},"button.surfaceMask":{frame:{...he({x:11,y:2}),...ae}},...Ce("conveyor.y",7,he({x:0,y:3}),ae),teleporter:{frame:{...he({x:7,y:3}),...ae}},...Ce("teleporter.flashing",2,he({x:8,y:3}),ae),"shadowMask.teleporter":{frame:{...he({x:10,y:3}),...ae}},"shadowMask.teleporter.flashing":{frame:{...he({x:11,y:3}),...ae}},...Ce("particle",4,{x:331,y:396},{w:9,h:11})},Bg={frames:Rv,animations:{"teleporter.flashing":ge(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:ge(["fish.1","fish.2"],.25),lift:ge(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:ge(["dalek.1","dalek.2"],.5),"turtle.left":ge(["turtle.left.1","turtle.left.2"],.25),"turtle.away":ge(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":ge(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":ge(["turtle.right.1","turtle.right.2"],.25),helicopterBug:ge(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":ge(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":ge(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":ge(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":ge(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":ge(Tn("conveyor.x",7),.5),"conveyor.y":ge(Tn("conveyor.y",7),.5),volcano:ge(Tn("volcano",2),3/16),"spring.bounce":ge(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"headlessBase.scan":ge(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":ge(["headlessBase.all","headlessBase"],.5),switch:ge(["switch.left","switch.right"],.02),"particle.fade":ge(Tn("particle",4),.5)}},Mv={frames:{"editor.tool.save":{frame:{w:12,h:12,x:601,y:0}},"editor.tool.pointer":{frame:{w:12,h:12,x:614,y:0}},"editor.tool.eyedropper":{frame:{w:12,h:12,x:628,y:0}}}},Iv={...Bg.frames,...Pg.frames,...Tg.frames,...Ev.frames,...Tv.frames,...Mv.frames},or={frames:Iv,animations:{...Pg.animations,...Bg.animations,...Tg.animations},meta:{scale:1}},Og="/assets/sprites-DAyMTFMS.png";var Al,Tf;function jv(){if(Tf)return Al;Tf=1;function t(s){if(Array.isArray(s))return!0;var n=s.length;return typeof n=="number"&&n>-1?n?0 in s&&n-1 in s:!0:!1}function e(s){var n=typeof s;return n==="object"?s===null?"null":t(s)?"array":s.constructor===Object?"pure-object":"object":n}function r(s,n){if(s===n||s!==s&&n!==n)return!0;var i=e(s),o=e(n);if(i!==o)return!1;if(i==="pure-object"){if(s===n)return!0;var a=Object.keys(s),l=Object.keys(n).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!n.hasOwnProperty(a[c]))return!1;var d=s[h],f=n[h];if(d===s||f===n||d===n||f===s)return d===f;if(!r(d,f))return!1}return!0}else if(i==="array"){if(s.length===n.length)for(var A=0;A<s.length;A++){var g=s[A],m=n[A];if(g===s||m===n||g===n||m===s)return g===m;if(!r(g,m))return!1}else return!1;return!0}else if(i==="object"){if(s.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return s.valueOf()===n.valueOf();if(s.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return s.toString()===n.toString()}return!1}return Al=r,Al}var Bv=jv();const Ov=Qe(Bv);var ml={exports:{}},gl={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rf;function Nv(){if(Rf)return gl;Rf=1;var t=an();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return gl.useSyncExternalStoreWithSelector=function(l,c,u,h,d){var f=n(null);if(f.current===null){var A={hasValue:!1,value:null};f.current=A}else A=f.current;f=o(function(){function m(P){if(!y){if(y=!0,x=P,P=h(P),d!==void 0&&A.hasValue){var C=A.value;if(d(C,P))return b=C}return b=P}if(C=b,r(x,P))return C;var E=h(P);return d!==void 0&&d(C,E)?(x=P,C):(x=P,b=E)}var y=!1,x,b,w=u===void 0?null:u;return[function(){return m(c())},w===null?void 0:function(){return m(w())}]},[c,u,h,d]);var g=s(l,f[0],f[1]);return i(function(){A.hasValue=!0,A.value=g},[g]),a(g),g},gl}var Mf;function zv(){return Mf||(Mf=1,ml.exports=Nv()),ml.exports}var Fv=zv();function Lv(t){t()}function Dv(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Lv(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var If={notify(){},get:()=>[]};function Uv(t,e){let r,s=If,n=0,i=!1;function o(g){u();const m=s.subscribe(g);let y=!1;return()=>{y||(y=!0,m(),h())}}function a(){s.notify()}function l(){A.onStateChange&&A.onStateChange()}function c(){return i}function u(){n++,r||(r=t.subscribe(l),s=Dv())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=If)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const A={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>s};return A}var Hv=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$v=Hv(),Gv=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Wv=Gv(),Yv=()=>$v||Wv?v.useLayoutEffect:v.useEffect,Kv=Yv(),Xv=Symbol.for("react-redux-context"),Qv=typeof globalThis<"u"?globalThis:{};function Zv(){if(!v.createContext)return{};const t=Qv[Xv]??=new Map;let e=t.get(v.createContext);return e||(e=v.createContext(null),t.set(v.createContext,e)),e}var jr=Zv();function Jv(t){const{children:e,context:r,serverState:s,store:n}=t,i=v.useMemo(()=>{const l=Uv(n);return{store:n,subscription:l,getServerState:s?()=>s:void 0}},[n,s]),o=v.useMemo(()=>n.getState(),[n]);Kv(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=r||jr;return v.createElement(a.Provider,{value:i},e)}var eV=Jv;function Xu(t=jr){return function(){return v.useContext(t)}}var Ng=Xu();function zg(t=jr){const e=t===jr?Ng:Xu(t),r=()=>{const{store:s}=e();return s};return Object.assign(r,{withTypes:()=>r}),r}var Fg=zg();function tV(t=jr){const e=t===jr?Fg:zg(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var rV=tV(),sV=(t,e)=>t===e;function nV(t=jr){const e=t===jr?Ng:Xu(t),r=(s,n={})=>{const{equalityFn:i=sV}=typeof n=="function"?{equalityFn:n}:n,o=e(),{store:a,subscription:l,getServerState:c}=o;v.useRef(!0);const u=v.useCallback({[s.name](d){return s(d)}}[s.name],[s]),h=Fv.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return v.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var iV=nV();const Qu=rV.withTypes(),le=iV.withTypes();Fg.withTypes();const Ne={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},jf=Mg(Ne,([t,e])=>[e,t]),oV={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},aV={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},Nt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},Lg=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...di],Dg=[...Lg,...di],po={presses:un(Dg.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[]}},Bf=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function gs(...t){return{presses:t.reduce((e,r)=>{for(const s of Dg)e[s]={keys:Bf(e[s]?.keys,r?.presses?.[s]?.keys),gamepadButtons:Bf(e[s]?.gamepadButtons,r?.presses?.[s]?.gamepadButtons)};return e},structuredClone(po.presses)),axes:{x:Array.from(new Set([...po.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...po.axes.y,...t.map(e=>e.axes?.y??[]).flat()]))}}}const ys={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape",""]},menu_exit:{gamepadButtons:[Ne.b]},menu_select:{keys:["Enter"],gamepadButtons:[Ne.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},hn={inputAssignment:gs(ys,{presses:{right:{gamepadButtons:[Ne.dPadRight]},towards:{gamepadButtons:[Ne.dPadDown]},left:{gamepadButtons:[Ne.dPadLeft]},away:{gamepadButtons:[Ne.dPadUp]},jump:{gamepadButtons:[Ne.a,Ne.y]},carry:{gamepadButtons:[Ne.x,Ne.y]},fire:{gamepadButtons:[Ne.b]},swop:{gamepadButtons:[Ne.rb]},"swop.head":{gamepadButtons:[Ne.l3]},"swop.heels":{gamepadButtons:[Ne.r3]},hold:{gamepadButtons:[Ne.start]},menu_openOrExit:{gamepadButtons:[Ne.select]},map:{gamepadButtons:[Ne.lb]},toggleColourisation:{gamepadButtons:[Ne.lt]}},axes:{x:[0],y:[1]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},lV={inputAssignment:gs(ys,hn.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},cV={inputAssignment:gs(ys,hn.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},uV={inputAssignment:gs(ys,hn.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M","Tab"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},hV={inputAssignment:gs(ys,hn.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},dV={inputAssignment:gs(ys,hn.inputAssignment,{presses:{right:{keys:[Nt.dPadRight]},towards:{keys:[Nt.dPadDown]},left:{keys:[Nt.dPadLeft]},away:{keys:[Nt.dPadUp]},jump:{keys:[Nt.a,Nt.y]},carry:{keys:[Nt.b,Nt.y]},fire:{keys:[Nt.x]},swop:{keys:[Nt.rb]},hold:{keys:[Nt.start]},menu_openOrExit:{keys:[Nt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that dont support controllers"},Of=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]}}}),fV={inputAssignment:gs(po,ys,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},Of(oV),Of(aV)),description:"MAME key mappings. For arcade-style control panels"},Ks={default:uV,"zx spectrum":lV,amiga:cV,mame:fV,wasd:hV," 8bitdo keyboard mode":dV," joystick":hn},Dt=()=>bt()==="mobile"||bt()==="tablet",bt=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},pV=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Zu={inputAssignment:Ks.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:bt()==="mobile"?"handheld":"zxSpectrum"},showFps:!1,onScreenControls:bt()==="mobile"||bt()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1,soundSettings:{mute:!1,noFootsteps:!1}},_o=(t,e)=>e.split(".").reduce((r,s)=>r[s],t),AV=(t,e,r)=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){const o=s[i];n=n[o]}n[s[s.length-1]]=r};function Ze(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var mV=typeof Symbol=="function"&&Symbol.observable||"@@observable",Nf=mV,yl=()=>Math.random().toString(36).substring(7).split("").join("."),gV={INIT:`@@redux/INIT${yl()}`,REPLACE:`@@redux/REPLACE${yl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${yl()}`},ko=gV;function Ju(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function eh(t,e,r){if(typeof t!="function")throw new Error(Ze(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ze(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ze(1));return r(eh)(t,e)}let s=t,n=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((m,y)=>{o.set(y,m)}))}function u(){if(l)throw new Error(Ze(3));return n}function h(m){if(typeof m!="function")throw new Error(Ze(4));if(l)throw new Error(Ze(5));let y=!0;c();const x=a++;return o.set(x,m),function(){if(y){if(l)throw new Error(Ze(6));y=!1,c(),o.delete(x),i=null}}}function d(m){if(!Ju(m))throw new Error(Ze(7));if(typeof m.type>"u")throw new Error(Ze(8));if(typeof m.type!="string")throw new Error(Ze(17));if(l)throw new Error(Ze(9));try{l=!0,n=s(n,m)}finally{l=!1}return(i=o).forEach(x=>{x()}),m}function f(m){if(typeof m!="function")throw new Error(Ze(10));s=m,d({type:ko.REPLACE})}function A(){const m=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Ze(11));function x(){const w=y;w.next&&w.next(u())}return x(),{unsubscribe:m(x)}},[Nf](){return this}}}return d({type:ko.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[Nf]:A}}function yV(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:ko.INIT})>"u")throw new Error(Ze(12));if(typeof r(void 0,{type:ko.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ze(13))})}function Ug(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const s=Object.keys(r);let n;try{yV(r)}catch(i){n=i}return function(o={},a){if(n)throw n;let l=!1;const c={};for(let u=0;u<s.length;u++){const h=s[u],d=r[h],f=o[h],A=d(f,a);if(typeof A>"u")throw a&&a.type,new Error(Ze(14));c[h]=A,l=l||A!==f}return l=l||s.length!==Object.keys(o).length,l?c:o}}function So(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function xV(...t){return e=>(r,s)=>{const n=e(r,s);let i=()=>{throw new Error(Ze(15))};const o={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=So(...a)(n.dispatch),{...n,dispatch:i}}}function Hg(t){return Ju(t)&&"type"in t&&typeof t.type=="string"}var $g=Symbol.for("immer-nothing"),zf=Symbol.for("immer-draftable"),jt=Symbol.for("immer-state");function Yt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Xs=Object.getPrototypeOf;function ds(t){return!!t&&!!t[jt]}function qr(t){return t?Gg(t)||Array.isArray(t)||!!t[zf]||!!t.constructor?.[zf]||ta(t)||ra(t):!1}var bV=Object.prototype.constructor.toString();function Gg(t){if(!t||typeof t!="object")return!1;const e=Xs(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===bV}function Co(t,e){ea(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,s)=>e(s,r,t))}function ea(t){const e=t[jt];return e?e.type_:Array.isArray(t)?1:ta(t)?2:ra(t)?3:0}function jc(t,e){return ea(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Wg(t,e,r){const s=ea(t);s===2?t.set(e,r):s===3?t.add(r):t[e]=r}function qV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ta(t){return t instanceof Map}function ra(t){return t instanceof Set}function Xr(t){return t.copy_||t.base_}function Bc(t,e){if(ta(t))return new Map(t);if(ra(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Gg(t);if(e===!0||e==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[jt];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const o=n[i],a=s[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(s[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Xs(t),s)}else{const s=Xs(t);if(s!==null&&r)return{...t};const n=Object.create(s);return Object.assign(n,t)}}function th(t,e=!1){return sa(t)||ds(t)||!qr(t)||(ea(t)>1&&(t.set=t.add=t.clear=t.delete=wV),Object.freeze(t),e&&Object.entries(t).forEach(([r,s])=>th(s,!0))),t}function wV(){Yt(2)}function sa(t){return Object.isFrozen(t)}var vV={};function fs(t){const e=vV[t];return e||Yt(0,t),e}var Kn;function Yg(){return Kn}function VV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ff(t,e){e&&(fs("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Oc(t){Nc(t),t.drafts_.forEach(_V),t.drafts_=null}function Nc(t){t===Kn&&(Kn=t.parent_)}function Lf(t){return Kn=VV(Kn,t)}function _V(t){const e=t[jt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Df(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[jt].modified_&&(Oc(e),Yt(4)),qr(t)&&(t=Po(e,t),e.parent_||Eo(e,t)),e.patches_&&fs("Patches").generateReplacementPatches_(r[jt].base_,t,e.patches_,e.inversePatches_)):t=Po(e,r,[]),Oc(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==$g?t:void 0}function Po(t,e,r){if(sa(e))return e;const s=e[jt];if(!s)return Co(e,(n,i)=>Uf(t,s,e,n,i,r)),e;if(s.scope_!==t)return e;if(!s.modified_)return Eo(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,o=!1;s.type_===3&&(i=new Set(n),n.clear(),o=!0),Co(i,(a,l)=>Uf(t,s,n,a,l,r,o)),Eo(t,n,!1),r&&t.patches_&&fs("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function Uf(t,e,r,s,n,i,o){if(ds(n)){const a=i&&e&&e.type_!==3&&!jc(e.assigned_,s)?i.concat(s):void 0,l=Po(t,n,a);if(Wg(r,s,l),ds(l))t.canAutoFreeze_=!1;else return}else o&&r.add(n);if(qr(n)&&!sa(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Po(t,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,s)&&Eo(t,n)}}function Eo(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&th(e,r)}function kV(t,e){const r=Array.isArray(t),s={type_:r?1:0,scope_:e?e.scope_:Yg(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=rh;r&&(n=[s],i=Xn);const{revoke:o,proxy:a}=Proxy.revocable(n,i);return s.draft_=a,s.revoke_=o,a}var rh={get(t,e){if(e===jt)return t;const r=Xr(t);if(!jc(r,e))return SV(t,r,e);const s=r[e];return t.finalized_||!qr(s)?s:s===xl(t.base_,e)?(bl(t),t.copy_[e]=Fc(s,t)):s},has(t,e){return e in Xr(t)},ownKeys(t){return Reflect.ownKeys(Xr(t))},set(t,e,r){const s=Kg(Xr(t),e);if(s?.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const n=xl(Xr(t),e),i=n?.[jt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(qV(r,n)&&(r!==void 0||jc(t.base_,e)))return!0;bl(t),zc(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return xl(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bl(t),zc(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xr(t),s=Reflect.getOwnPropertyDescriptor(r,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:r[e]}},defineProperty(){Yt(11)},getPrototypeOf(t){return Xs(t.base_)},setPrototypeOf(){Yt(12)}},Xn={};Co(rh,(t,e)=>{Xn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Xn.deleteProperty=function(t,e){return Xn.set.call(this,t,e,void 0)};Xn.set=function(t,e,r){return rh.set.call(this,t[0],e,r,t[0])};function xl(t,e){const r=t[jt];return(r?Xr(r):t)[e]}function SV(t,e,r){const s=Kg(e,r);return s?"value"in s?s.value:s.get?.call(t.draft_):void 0}function Kg(t,e){if(!(e in t))return;let r=Xs(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,e);if(s)return s;r=Xs(r)}}function zc(t){t.modified_||(t.modified_=!0,t.parent_&&zc(t.parent_))}function bl(t){t.copy_||(t.copy_=Bc(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var CV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,s)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(l=i,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Yt(6),s!==void 0&&typeof s!="function"&&Yt(7);let n;if(qr(e)){const i=Lf(this),o=Fc(e,void 0);let a=!0;try{n=r(o),a=!1}finally{a?Oc(i):Nc(i)}return Ff(i,s),Df(n,i)}else if(!e||typeof e!="object"){if(n=r(e),n===void 0&&(n=e),n===$g&&(n=void 0),this.autoFreeze_&&th(n,!0),s){const i=[],o=[];fs("Patches").generateReplacementPatches_(e,n,i,o),s(i,o)}return n}else Yt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let s,n;return[this.produce(e,r,(o,a)=>{s=o,n=a}),s,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){qr(t)||Yt(8),ds(t)&&(t=PV(t));const e=Lf(this),r=Fc(t,void 0);return r[jt].isManual_=!0,Nc(e),r}finishDraft(t,e){const r=t&&t[jt];(!r||!r.isManual_)&&Yt(9);const{scope_:s}=r;return Ff(s,e),Df(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(e=e.slice(r+1));const s=fs("Patches").applyPatches_;return ds(t)?s(t,e):this.produce(t,n=>s(n,e))}};function Fc(t,e){const r=ta(t)?fs("MapSet").proxyMap_(t,e):ra(t)?fs("MapSet").proxySet_(t,e):kV(t,e);return(e?e.scope_:Yg()).drafts_.push(r),r}function PV(t){return ds(t)||Yt(10,t),Xg(t)}function Xg(t){if(!qr(t)||sa(t))return t;const e=t[jt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Bc(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Bc(t,!0);return Co(r,(s,n)=>{Wg(r,s,Xg(n))}),e&&(e.finalized_=!1),r}var Bt=new CV,sh=Bt.produce;Bt.produceWithPatches.bind(Bt);Bt.setAutoFreeze.bind(Bt);Bt.setUseStrictShallowCopy.bind(Bt);Bt.applyPatches.bind(Bt);Bt.createDraft.bind(Bt);Bt.finishDraft.bind(Bt);function Qg(t){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,t):n(i)}var EV=Qg(),TV=Qg,RV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?So:So.apply(null,arguments)};function Qs(t,e){function r(...s){if(e){let n=e(...s);if(!n)throw new Error(pt(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>Hg(s)&&s.type===t,r}var Zg=class Rn extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Rn.prototype)}static get[Symbol.species](){return Rn}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Rn(...e[0].concat(this)):new Rn(...e.concat(this))}};function Hf(t){return qr(t)?sh(t,()=>{}):t}function Lc(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function MV(t){return typeof t=="boolean"}var IV=()=>function(e){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let o=new Zg;return r&&(MV(r)?o.push(EV):o.push(TV(r.extraArgument))),o},jV="RTK_autoBatch",$f=t=>e=>{setTimeout(e,t)},BV=(t={type:"raf"})=>e=>(...r)=>{const s=e(...r);let n=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:$f(10):t.type==="callback"?t.queueNotification:$f(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const h=()=>n&&u(),d=s.subscribe(h);return a.add(u),()=>{d(),a.delete(u)}},dispatch(u){try{return n=!u?.meta?.[jV],i=!n,i&&(o||(o=!0,l(c))),s.dispatch(u)}finally{n=!0}}})},OV=t=>function(r){const{autoBatch:s=!0}=r??{};let n=new Zg(t);return s&&n.push(BV(typeof s=="object"?s:void 0)),n};function NV(t){const e=IV(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(Ju(r))a=Ug(r);else throw new Error(pt(1));let l;typeof s=="function"?l=s(e):l=e();let c=So;n&&(c=RV({trace:!1,...typeof n=="object"&&n}));const u=xV(...l),h=OV(u);let d=typeof o=="function"?o(h):h();const f=c(...d);return eh(a,i,f)}function Jg(t){const e={},r=[];let s;const n={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(pt(28));if(a in e)throw new Error(pt(29));return e[a]=o,n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return s=i,n}};return t(n),[e,r,s]}function zV(t){return typeof t=="function"}function FV(t,e){let[r,s,n]=Jg(e),i;if(zV(t))i=()=>Hf(t());else{const a=Hf(t);i=()=>a}function o(a=i(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(ds(u)){const f=h(u,l);return f===void 0?u:f}else{if(qr(u))return sh(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return d}}return u},a)}return o.getInitialState=i,o}var LV="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ey=(t=21)=>{let e="",r=t;for(;r--;)e+=LV[Math.random()*64|0];return e},DV=Symbol.for("rtk-slice-createasyncthunk");function UV(t,e){return`${t}/${e}`}function HV({creators:t}={}){const e=t?.asyncThunk?.[DV];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(pt(11));const o=(typeof s.reducers=="function"?s.reducers(GV()):s.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(x,b){const w=typeof x=="string"?x:x.type;if(!w)throw new Error(pt(12));if(w in l.sliceCaseReducersByType)throw new Error(pt(13));return l.sliceCaseReducersByType[w]=b,c},addMatcher(x,b){return l.sliceMatchers.push({matcher:x,reducer:b}),c},exposeAction(x,b){return l.actionCreators[x]=b,c},exposeCaseReducer(x,b){return l.sliceCaseReducersByName[x]=b,c}};a.forEach(x=>{const b=o[x],w={reducerName:x,type:UV(n,x),createNotation:typeof s.reducers=="function"};YV(b)?XV(w,b,c,e):WV(w,b,c)});function u(){const[x={},b=[],w=void 0]=typeof s.extraReducers=="function"?Jg(s.extraReducers):[s.extraReducers],P={...x,...l.sliceCaseReducersByType};return FV(s.initialState,C=>{for(let E in P)C.addCase(E,P[E]);for(let E of l.sliceMatchers)C.addMatcher(E.matcher,E.reducer);for(let E of b)C.addMatcher(E.matcher,E.reducer);w&&C.addDefaultCase(w)})}const h=x=>x,d=new Map;let f;function A(x,b){return f||(f=u()),f(x,b)}function g(){return f||(f=u()),f.getInitialState()}function m(x,b=!1){function w(C){let E=C[x];return typeof E>"u"&&b&&(E=g()),E}function P(C=h){const E=Lc(d,b,()=>new WeakMap);return Lc(E,C,()=>{const B={};for(const[j,M]of Object.entries(s.selectors??{}))B[j]=$V(M,C,g,b);return B})}return{reducerPath:x,getSelectors:P,get selectors(){return P(w)},selectSlice:w}}const y={name:n,reducer:A,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g,...m(i),injectInto(x,{reducerPath:b,...w}={}){const P=b??i;return x.inject({reducerPath:P,reducer:A},w),{...y,...m(P,!0)}}};return y}}function $V(t,e,r,s){function n(i,...o){let a=e(i);return typeof a>"u"&&s&&(a=r()),t(a,...o)}return n.unwrapped=t,n}var ty=HV();function GV(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function WV({type:t,reducerName:e,createNotation:r},s,n){let i,o;if("reducer"in s){if(r&&!KV(s))throw new Error(pt(17));i=s.reducer,o=s.prepare}else i=s;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?Qs(t,o):Qs(t))}function YV(t){return t._reducerDefinitionType==="asyncThunk"}function KV(t){return t._reducerDefinitionType==="reducerWithPrepare"}function XV({type:t,reducerName:e},r,s,n){if(!n)throw new Error(pt(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=n(t,i,u);s.exposeAction(e,h),o&&s.addCase(h.fulfilled,o),a&&s.addCase(h.pending,a),l&&s.addCase(h.rejected,l),c&&s.addMatcher(h.settled,c),s.exposeCaseReducer(e,{fulfilled:o||zi,pending:a||zi,rejected:l||zi,settled:c||zi})}function zi(){}var QV="task",ry="listener",sy="completed",nh="cancelled",ZV=`task-${nh}`,JV=`task-${sy}`,Dc=`${ry}-${nh}`,e0=`${ry}-${sy}`,na=class{constructor(t){this.code=t,this.message=`${QV} ${nh} (reason: ${t})`}name="TaskAbortError";message},ih=(t,e)=>{if(typeof t!="function")throw new TypeError(pt(32))},To=()=>{},ny=(t,e=To)=>(t.catch(e),t),iy=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),cs=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},us=t=>{if(t.aborted){const{reason:e}=t;throw new na(e)}};function oy(t,e){let r=To;return new Promise((s,n)=>{const i=()=>n(new na(t.reason));if(t.aborted){i();return}r=iy(t,i),e.finally(()=>r()).then(s,n)}).finally(()=>{r=To})}var t0=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof na?"cancelled":"rejected",error:r}}finally{e?.()}},Ro=t=>e=>ny(oy(t,e).then(r=>(us(t),r))),ay=t=>{const e=Ro(t);return r=>e(new Promise(s=>setTimeout(s,r)))},{assign:Us}=Object,Gf={},ia="listenerMiddleware",r0=(t,e)=>{const r=s=>iy(t,()=>cs(s,t.reason));return(s,n)=>{ih(s);const i=new AbortController;r(i);const o=t0(async()=>{us(t),us(i.signal);const a=await s({pause:Ro(i.signal),delay:ay(i.signal),signal:i.signal});return us(i.signal),a},()=>cs(i,JV));return n?.autoJoin&&e.push(o.catch(To)),{result:Ro(t)(o),cancel(){cs(i,ZV)}}}},s0=(t,e)=>{const r=async(s,n)=>{us(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:s,effect:(h,d)=>{d.unsubscribe(),l([h,d.getState(),d.getOriginalState()])}});i=()=>{u(),c()}})];n!=null&&a.push(new Promise(l=>setTimeout(l,n,null)));try{const l=await oy(e,Promise.race(a));return us(e),l}finally{i()}};return(s,n)=>ny(r(s,n))},ly=t=>{let{type:e,actionCreator:r,matcher:s,predicate:n,effect:i}=t;if(e)n=Qs(e).match;else if(r)e=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(pt(21));return ih(i),{predicate:n,type:e,effect:i}},cy=Us(t=>{const{type:e,predicate:r,effect:s}=ly(t);return{id:ey(),effect:s,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(pt(22))}}},{withTypes:()=>cy}),Wf=(t,e)=>{const{type:r,effect:s,predicate:n}=ly(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},Uc=t=>{t.pending.forEach(e=>{cs(e,Dc)})},n0=t=>()=>{t.forEach(Uc),t.clear()},Yf=(t,e,r)=>{try{t(e,r)}catch(s){setTimeout(()=>{throw s},0)}},uy=Us(Qs(`${ia}/add`),{withTypes:()=>uy}),i0=Qs(`${ia}/removeAll`),hy=Us(Qs(`${ia}/remove`),{withTypes:()=>hy}),o0=(...t)=>{console.error(`${ia}/error`,...t)},a0=(t={})=>{const e=new Map,{extra:r,onError:s=o0}=t;ih(s);const n=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Uc(u)}),i=u=>{const h=Wf(e,u)??cy(u);return n(h)};Us(i,{withTypes:()=>i});const o=u=>{const h=Wf(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Uc(h)),!!h};Us(o,{withTypes:()=>o});const a=async(u,h,d,f)=>{const A=new AbortController,g=s0(i,A.signal),m=[];try{u.pending.add(A),await Promise.resolve(u.effect(h,Us({},d,{getOriginalState:f,condition:(y,x)=>g(y,x).then(Boolean),take:g,delay:ay(A.signal),pause:Ro(A.signal),extra:r,signal:A.signal,fork:r0(A.signal,m),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,x,b)=>{y!==A&&(cs(y,Dc),b.delete(y))})},cancel:()=>{cs(A,Dc),u.pending.delete(A)},throwIfCancelled:()=>{us(A.signal)}})))}catch(y){y instanceof na||Yf(s,y,{raisedBy:"effect"})}finally{await Promise.all(m),cs(A,e0),u.pending.delete(A)}},l=n0(e);return{middleware:u=>h=>d=>{if(!Hg(d))return h(d);if(uy.match(d))return i(d.payload);if(i0.match(d)){l();return}if(hy.match(d))return o(d.payload);let f=u.getState();const A=()=>{if(f===Gf)throw new Error(pt(23));return f};let g;try{if(g=h(d),e.size>0){const m=u.getState(),y=Array.from(e.values());for(const x of y){let b=!1;try{b=x.predicate(d,m,f)}catch(w){b=!1,Yf(s,w,{raisedBy:"predicate"})}b&&a(x,d,u,A)}}}finally{f=Gf}return g},startListening:i,stopListening:o,clearListeners:l}},l0=t=>"reducerPath"in t&&typeof t.reducerPath=="string",c0=t=>t.flatMap(e=>l0(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),oh=Symbol.for("rtk-state-proxy-original"),u0=t=>!!t&&!!t[oh],h0=new WeakMap,d0=(t,e)=>Lc(h0,t,()=>new Proxy(t,{get:(r,s,n)=>{if(s===oh)return r;const i=Reflect.get(r,s,n);if(typeof i>"u"){const o=e[s.toString()];if(o){const a=o(void 0,{type:ey()});if(typeof a>"u")throw new Error(pt(24));return a}}return i}})),f0=t=>{if(!u0(t))throw new Error(pt(25));return t[oh]},p0=(t={})=>t;function A0(...t){const e=Object.fromEntries(c0(t)),r=()=>Object.keys(e).length?Ug(e):p0;let s=r();function n(a,l){return s(a,l)}n.withLazyLoadedSlices=()=>n;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,s=r()),n},o=Object.assign(function(l,c){return function(h,...d){return l(d0(c?c(h,...d):h,e),...d)}},{original:f0});return Object.assign(n,{inject:i,selector:o})}function pt(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const m0=t=>bt()==="server"?cn.zxSpectrum:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},ah=(t,e)=>{const r=bt();return{renderAreaSize:m0(e),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio}},g0=8,dy=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:s=bt()})=>{const n=cn[e],{renderAreaSize:i,rotate90:o}=s!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},a=Lu(i,r),l=Math.max(Math.floor(Math.min(a.x/n.x,a.y/n.y)),1),c=Math.min(g0,l),u=l/c/r,h={x:Math.floor(a.x/l),y:Math.floor(a.y/l)},d={x:Math.ceil(i.x/u),y:Math.ceil(i.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:h,canvasSize:d,rotate90:o}},y0={upscale:dy(ah(Zu.displaySettings.emulatedResolution))},Mo=ty({name:"upscale",initialState:y0,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=dy(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:fy}=Mo.actions,{selectCanvasSize:x0,selectRot90:b0,selectUpscale:q0,selectGameEngineUpscale:qN,selectTotalUpscale:w0,selectGameEngineScreenSize:wN}=Mo.selectors,wt=t=>e=>_o(e.gameMenus.userSettings,t)??_o(Zu,t),mi=()=>le(w0),Io=wt("inputAssignment"),vN=t=>t.gameMenus.openMenus.length>0,py=()=>le(t=>t.gameMenus.cheatsOn),Ay=t=>t.gameMenus.assigningInput!==void 0,my=()=>le(Ay),v0=t=>{for(const[e,r]of je(Yu(Ks)))if(Ov(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},Zs=()=>le(t=>t.gameMenus.gameRunning),V0=wt("showFps"),oa=wt("displaySettings.emulatedResolution"),_0=()=>le(oa),k0=wt("displaySettings.uncolourised"),lh=()=>le(k0),S0=wt("displaySettings.crtFilter"),gy=wt("infiniteLivesPoke"),yy=wt("infiniteDoughnutsPoke"),VN=t=>t.gameMenus.planetsLiberated.egyptus&&t.gameMenus.planetsLiberated.bookworld&&t.gameMenus.planetsLiberated.penitentiary&&t.gameMenus.planetsLiberated.safari,jo=()=>le(t=>t.gameMenus.userSettings.screenRelativeControl),ch=wt("inputDirectionMode"),xy=()=>le(ch),C0=t=>Mc(je(ms(t.gameMenus.planetsLiberated)).filter(Boolean)),P0=wt("displaySettings.showBoundingBoxes"),_N=()=>le(P0),E0=wt("displaySettings.showShadowMasks"),kN=()=>le(E0),T0=wt("screenRelativeControl"),R0=wt("onScreenControls"),M0=wt("soundSettings.mute"),I0=wt("soundSettings.noFootsteps"),SN=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??Zu.onScreenControls)&&e.upscale.rotate90===!1,j0=()=>le(R0),CN=(t,e)=>!!_o(t.gameMenus,e),B0=()=>le(t=>t.gameMenus.roomsExplored),Hs=({children:t,scaleFactor:e})=>{const r=mi();return p.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},Hc=4,Fi=20,O0=()=>{const t=Object.keys(or.frames).sort();return p.jsxs(p.Fragment,{children:[p.jsx("img",{src:Og,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),p.jsx("title",{children:"Sprites"}),p.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:t.map(e=>{const{frame:r}=or.frames[e],s=r;return p.jsxs("div",{className:"bg-shadow m-[8px] p-[16px] text-center flex flex-col",children:[p.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border-1 mb-1 box-content mx-auto w-min",style:{"--x":`${or.frames[e].frame.x}px`,"--y":`${or.frames[e].frame.y}px`,"--h":`${or.frames[e].frame.h}px`,"--w":`${or.frames[e].frame.w}px`},children:s.pivot?p.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${Fi}px`,height:`${Fi}px`,left:`${s.pivot.x*Hc-Fi/2}px`,top:`${s.pivot.y*Hc-Fi/2}px`}}):null}),p.jsx("div",{className:"flex-grow"}),p.jsx("div",{className:"text-moss",children:e}),p.jsxs("div",{className:"text-lightGrey",children:[r.w,"x",r.h]}),p.jsx("div",{className:"text-midRed",children:s.pivot?p.jsxs(p.Fragment,{children:["pivot: (",s.pivot.x,",",s.pivot.y,")"]}):"no pivot"}),p.jsxs("div",{className:"text-midGrey",children:["@(",r.x,",",r.y,")"]})]},e)})})]})},N0=()=>p.jsx(Hs,{scaleFactor:Hc,children:p.jsx(O0,{})}),uh=v.createContext(null),z0=({gameApi:t,children:e})=>p.jsx(uh,{value:t,children:e}),dn=()=>{const t=v.useContext(uh);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},F0=()=>{const t=v.useContext(uh);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},Qn=(t,...e)=>{const r={};for(const s of e)r[s]=t[s];return r},PN=(t,...e)=>{const r={...t};for(const s of e)delete r[s];return r},Mn=t=>JSON.parse(JSON.stringify(t)),L0=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],D0=["planetsLiberated","scrollsRead","roomsExplored","reincarnationPoint"],U0=(t,e)=>je(Ku(t)).map(r=>{const s=e.items[r];if(s===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return s});function H0(t,e){return t===null?null:e.items[t]}const de={w:16,d:16,h:12},Kf={x:16,y:16,z:12},$0=["head","heels"],G0=[...$0,"headOverHeels"],$c=t=>t==="head"?"heels":"head",Be=(...t)=>e=>t.includes(e.type),W0=Be("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),Y0=(t,e)=>W0(t)||t_(t)&&(e!==void 0&&qy(e)||t.config.direction.z!==0)||Wc(t)&&t.config.floorType==="none",Gc=(t,e)=>!Y0(t,e),K0=t=>t.type==="movingPlatform"||t.type==="pushableBlock",EN=(t,e,r=!1)=>hh(e)&&!(!r&&qy(e)&&e.state.autoWalk)&&!(r_(t)&&K0(e))&&!(dh(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),by=["ball","slidingBlock","slidingDeadly"],TN=Be(...by),X0=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],Q0=["dalek","turtle","elephantHead","homingBot","helicopterBug"],RN=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?Q0.includes(t.config.which):X0.includes(t.type),qy=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function hh(t){return wy.includes(t.type)}const wy=[...G0,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],Z0=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],J0=Be(...Z0),MN=t=>dh(t)&&!t.state.activated?!1:J0(t)||t.type==="floor"&&t.config.floorType==="deadly",e_=t=>t.config.times!==void 0,t_=Be("portal"),IN=Be("teleporter");Be("heels");Be("head");const jN=Be("heels","headOverHeels"),BN=Be("head","headOverHeels"),r_=Be("lift"),ON=Be("emitter"),dh=Be("monster"),Wc=Be("floor"),s_=Be("pickup"),NN=t=>s_(t)&&t.config.gives==="crown",zN=Be("spring"),FN=Be("joystick"),LN=Be("monster","movingPlatform"),DN=t=>dh(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,Xf=(t,e)=>{if(t.state.standingOnItemId!==null){const r=H0(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime}},Bo=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;hh(r)&&Xf(r,t);for(const s of U0(r.state.stoodOnBy,t))Xf(s,t);typeof e=="string"?delete t.items[e]:delete t.items[r.id]},n_=(t,e,r)=>{const s=Mn({saveTime:Date.now(),screenshotBase64:"IAMANIMAGE",campaignId:"original",gameState:Qn(t,...L0),store:{gameMenus:Qn(e.gameMenus,...D0)}});if(r!==void 0){const n=s.gameState,i=n.characterRooms[n.currentCharacterName];if(!i)throw new Error("how are we saving from a pickup if there is no current room?");Bo({room:i,item:i.items[r]})}return s},Qf=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]};var fh="persist:",ph="persist/FLUSH",gi="persist/REHYDRATE",Ah="persist/PAUSE",mh="persist/PERSIST",gh="persist/PURGE",yh="persist/REGISTER",vy=-1;function Ao(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ao=function(r){return typeof r}:Ao=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ao(t)}function Zf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function i_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zf(r,!0).forEach(function(s){o_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zf(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function o_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a_(t,e,r,s){s.debug;var n=i_({},r);return t&&Ao(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(n[i]=t[i])}),n}function l_(t){var e=t.blacklist||null,r=t.whitelist||null,s=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:fh).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(P){return P}:typeof t.serialize=="function"?a=t.serialize:a=c_;var l=t.writeFailHandler||null,c={},u={},h=[],d=null,f=null,A=function(P){Object.keys(P).forEach(function(C){y(C)&&c[C]!==P[C]&&h.indexOf(C)===-1&&h.push(C)}),Object.keys(c).forEach(function(C){P[C]===void 0&&y(C)&&h.indexOf(C)===-1&&c[C]!==void 0&&h.push(C)}),d===null&&(d=setInterval(g,n)),c=P};function g(){if(h.length===0){d&&clearInterval(d),d=null;return}var w=h.shift(),P=s.reduce(function(C,E){return E.in(C,w,c)},c[w]);if(P!==void 0)try{u[w]=a(P)}catch(C){console.error("redux-persist/createPersistoid: error serializing state",C)}else delete u[w];h.length===0&&m()}function m(){Object.keys(u).forEach(function(w){c[w]===void 0&&delete u[w]}),f=o.setItem(i,a(u)).catch(x)}function y(w){return!(r&&r.indexOf(w)===-1&&w!=="_persist"||e&&e.indexOf(w)!==-1)}function x(w){l&&l(w)}var b=function(){for(;h.length!==0;)g();return f||Promise.resolve()};return{update:A,flush:b}}function c_(t){return JSON.stringify(t)}function u_(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:fh).concat(t.key),s=t.storage;t.debug;var n;return t.deserialize===!1?n=function(o){return o}:typeof t.deserialize=="function"?n=t.deserialize:n=h_,s.getItem(r).then(function(i){if(i)try{var o={},a=n(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},n(a[l]))}),o}catch(l){throw l}else return})}function h_(t){return JSON.parse(t)}function d_(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:fh).concat(t.key);return e.removeItem(r,f_)}function f_(t){}function Jf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jf(r,!0).forEach(function(s){p_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jf(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function p_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A_(t,e){if(t==null)return{};var r=m_(t,e),s,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function m_(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}var g_=5e3;function y_(t,e){var r=t.version!==void 0?t.version:vy;t.debug;var s=t.stateReconciler===void 0?a_:t.stateReconciler,n=t.getStoredState||u_,i=t.timeout!==void 0?t.timeout:g_,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var d=u||{},f=d._persist,A=A_(d,["_persist"]),g=A;if(h.type===mh){var m=!1,y=function(B,j){m||(h.rehydrate(t.key,B,j),m=!0)};if(i&&setTimeout(function(){!m&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=l_(t)),f)return dr({},e(g,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(E){var B=t.migrate||function(j,M){return Promise.resolve(j)};B(E,r).then(function(j){y(j)},function(j){y(void 0,j)})},function(E){y(void 0,E)}),dr({},e(g,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===gh)return a=!0,h.result(d_(t)),dr({},e(g,h),{_persist:f});if(h.type===ph)return h.result(o&&o.flush()),dr({},e(g,h),{_persist:f});if(h.type===Ah)l=!0;else if(h.type===gi){if(a)return dr({},g,{_persist:dr({},f,{rehydrated:!0})});if(h.key===t.key){var x=e(g,h),b=h.payload,w=s!==!1&&b!==void 0?s(b,u,x,t):x,P=dr({},w,{_persist:dr({},f,{rehydrated:!0})});return c(P)}}}if(!f)return e(u,h);var C=e(g,h);return C===g?u:c(dr({},C,{_persist:f}))}}function ep(t){return q_(t)||b_(t)||x_()}function x_(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function b_(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function q_(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function tp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Yc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tp(r,!0).forEach(function(s){w_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tp(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function w_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Vy={registry:[],bootstrapped:!1},v_=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vy,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case yh:return Yc({},e,{registry:[].concat(ep(e.registry),[r.key])});case gi:var s=e.registry.indexOf(r.key),n=ep(e.registry);return n.splice(s,1),Yc({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function V_(t,e,r){var s=eh(v_,Vy,void 0),n=function(l){s.dispatch({type:yh,key:l})},i=function(l,c,u){var h={type:gi,payload:c,err:u,key:l};t.dispatch(h),s.dispatch(h)},o=Yc({},s,{purge:function(){var l=[];return t.dispatch({type:gh,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:ph,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:Ah})},persist:function(){t.dispatch({type:mh,register:n,rehydrate:i})}});return o.persist(),o}function __(t,e){return function(r,s){if(!r)return Promise.resolve(void 0);var n=r._persist&&r._persist.version!==void 0?r._persist.version:vy;if(n===s||n>s)return Promise.resolve(r);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return s>=a&&a>n}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},r);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const _y=[],ky=new Set,UN=new Map;ky.add=()=>{throw new Error("emptySet.add")};ky.clear=()=>{throw new Error("emptySet.clear")};const fe=Object.freeze({}),aa=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t),HN=["none","non-wall","all"],k_=["4-way","8-way","analogue"],S_=bt()!=="server",ql=S_?aa().has("cheats"):!1,Sy={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},Kc={userSettings:{displaySettings:{},soundSettings:{}},planetsLiberated:Sy,roomsExplored:{},scrollsRead:{},gameRunning:ql,openMenus:ql?[]:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:fe}],assigningInput:void 0,cheatsOn:ql,currentGame:void 0,reincarnationPoint:void 0},la=ty({name:"gameMenus",initialState:Kc,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=Qf(mv,oa({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},scrollRead(t,{payload:e}){e.source==="manual"?(t.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:fe}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=Qf(k_,ch({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(o,a)=>{o.includes(a)||o.push(a)},{presses:s,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":r(s.keys,e.input);break;case"gamepadButtons":r(s.gamepadButtons,e.input);break;case"gamepadAxes":{di.includes(i)&&r(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:s}=t.assigningInput,n=r.keys.length+r.gamepadButtons.length+s.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(Ks.default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=s),(e==="towards"||e==="away")&&(i.axes.y=s)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:fe}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},gameStarted(t){t.gameRunning?t.openMenus=[]:(t.openMenus=[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.planetsLiberated=Sy,t.roomsExplored={},t.scrollsRead={})},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=Ks[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[s]=t.openMenus;s.focussedItemId=e,s.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:fe}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:fe}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){AV(t,e,!_o(t,e))},crownCollected(t,{payload:e}){t.planetsLiberated[e]=!0;const r=Object.values(t.planetsLiberated).every(n=>n),s={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:fe},s]:t.openMenus=[s]},roomExplored(t,{payload:e}){t.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){e&&t.reincarnationPoint!==void 0?t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:fe},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:fe}]:(t.gameRunning=!1,delete t.reincarnationPoint,delete t.currentGame,t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:fe},{menuId:"mainMenu",scrollableSelection:!0,menuParam:fe}])},reincarnationFishEaten(t,{payload:e}){t.reincarnationPoint=e},reincarnationAccepted(t){delete t.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:fe}]},saveCurrentGame(t,{payload:e}){t.currentGame=e},gameRestoreFromSave(t,{payload:e}){Object.assign(t,e)},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,Kc),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){}},extraReducers(t){t.addCase(gi,(e,r)=>{r.payload?.currentGame&&(e.gameRunning=!0,e.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:fe}])})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")}}}),{assignInputStart:Vt,backToParentMenu:De,characterRoomChange:$N,crownCollected:GN,debugItemClicked:C_,doneAssigningInput:P_,errorCaught:Cy,errorDismissed:rp,gameOver:Py,gameRestoreFromSave:WN,gameStarted:E_,goToSubmenu:Rt,holdPressed:Ey,inputAddedDuringAssignment:T_,keyAssignmentPresetChosen:R_,mapPressed:M_,menuOpenOrExitPressed:sp,nextInputDirectionMode:I_,reincarnationAccepted:Ty,reincarnationFishEaten:YN,roomExplored:KN,saveCurrentGame:j_,scrollRead:XN,setEmulatedResolution:xh,setFocussedMenuItemId:bh,setShowBoundingBoxes:QN,setShowShadowMasks:ZN,toggleBoolean:Kt}=la.actions,{selectHasError:JN}=la.selectors;var Vn={},Li={},Di={},np;function B_(){if(np)return Di;np=1,Di.__esModule=!0,Di.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function s(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function n(i){var o="".concat(i,"Storage");return s(o)?self[o]:r}return Di}var ip;function O_(){if(ip)return Li;ip=1,Li.__esModule=!0,Li.default=r;var t=e(B_());function e(s){return s&&s.__esModule?s:{default:s}}function r(s){var n=(0,t.default)(s);return{getItem:function(o){return new Promise(function(a,l){a(n.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(n.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(n.removeItem(o))})}}}return Li}var op;function N_(){if(op)return Vn;op=1,Vn.__esModule=!0,Vn.default=void 0;var t=e(O_());function e(s){return s&&s.__esModule?s:{default:s}}var r=(0,t.default)("local");return Vn.default=r,Vn}var z_=N_();const F_=Qe(z_),Xc=(t,e)=>e?.[t],Ry=t=>ms(t),hs=t=>je(Ry(t)),ez=t=>je(Wu(t)),tz=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),L_=1e3,Ir=-2,_t=t=>{const e=Kc.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},D_=__({1:_t,2:_t,3:_t,4:_t,5:_t,6:_t,7:_t,8:_t,9:_t,10:_t,11:_t,12:_t,13(t){const e=t,r=structuredClone(t);return r.gameMenus.userSettings.soundSettings={},console.log("redux-persist migration: migrating state 12->13 by adding `{}` at `gameMenus.userSettings.soundSettings`",e,"->",r),r},14(t){console.group("redux-persist migration: migrating state 13->14 to add fixedZIndexes");const e=t,r=structuredClone(e),s=a=>{for(const l of hs(a.items))l.renders===!1?(console.log(l.id,"is a non-rendering item, giving fixedZIndex"),l.fixedZIndex=Ir):l.type==="floatingText"&&(console.log(l.id,"is getting .fixedZIndex = floatingTextFixedZIndex"),l.fixedZIndex=L_)},n=a=>{for(const[l,c]of Yu(a))console.group("fixing room for",l,c.roomJson.id),s(c),console.groupEnd()},{currentGame:i}=r;i!==void 0&&(console.group("found a currentGame - migrating..."),n(i.gameState.characterRooms),console.groupEnd());const o=a=>{const l=a?.store.gameMenus.reincarnationPoint;if(l===void 0)return;console.log("found a reincarnation point - migrating..."),n(l.gameState.characterRooms),console.log("...reincarnation point migrated");const c=l.store.gameMenus.reincarnationPoint;c!==void 0&&o(c)};return o(i),console.log("migration done"),console.groupEnd(),r},15:_t}),My=a0(),U_=My.startListening.withTypes(),H_=()=>{bt()!=="server"&&U_({actionCreator:xh,effect(t,{dispatch:e,getState:r}){const{emulatedResolution:s}=r().gameMenus.userSettings.displaySettings;s!==void 0&&e(fy(ah(s)))}})},$_=15,G_=["userSettings","currentGame"],W_={key:"hohol/gameMenus/userSettings",version:$_,migrate:D_,storage:F_,whitelist:G_},Y_=y_(W_,la.reducer),Qc=A0({[la.reducerPath]:Y_,[Mo.reducerPath]:Mo.reducer}).withLazyLoadedSlices();Qc.inject;const K_=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?Qc(void 0,e):Qc(t,e),ke=NV({reducer:K_,middleware:t=>t({serializableCheck:{ignoredActions:[ph,gi,Ah,mh,gh,yh,C_.type]}}).prepend(My.middleware)});H_();const X_=V_(ke),Q_=aa().get("noSaves"),Z_=()=>{const t=Qu(),e=F0();v.useEffect(()=>{if(e===void 0)return;const r=()=>{Q_||(console.log("saving current game"),t(j_(n_(e.gameState,ke.getState()))),X_.flush())},s=()=>{document.visibilityState==="hidden"&&(console.log("pausing due to visibilityState=hidden"),t(Ey("hold")),r())};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",r)}},[t,e])},J_=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape",""],ek=t=>J_.includes(t);let tk=1;const rk=()=>tk++,sk=3,ap=({key:t,location:e,repeat:r})=>{if(r)return;const s=t.length===1?t.toUpperCase():t,n=e===sk?`Numpad${s}`:s;if(ek(n))return n;console.warn("unrecognised key",t)},nk=()=>new Map,ik=t=>{const e=n=>{const i=ap(n);i!==void 0&&t.set(i,rk())},r=n=>{const i=ap(n);i!==void 0&&t.delete(i)},s=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",s,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",s,!1)}},Iy=t=>t==="left"?{axis:"x",direction:-1}:t==="right"?{axis:"x",direction:1}:t==="towards"?{axis:"y",direction:1}:t==="away"?{axis:"y",direction:-1}:void 0;var J=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(J||{});const Zc=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Ui=(t,e)=>Zc(t).priority??e,qt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Zc).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(Zc).forEach(e=>{e.type.forEach(r=>{const s=this._addHandlers,n=this._queue;s[r]?s[r]?.(e):(n[r]=n[r]||[],n[r]?.push(e))})}),this},handle(t,e,r){const s=this._addHandlers,n=this._removeHandlers;if(s[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,n[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,s=>{e.findIndex(i=>i.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((i,o)=>Ui(o.value,r)-Ui(i.value,r)))},s=>{const n=e.findIndex(i=>i.name===s.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,r=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((n,i)=>Ui(i,r)-Ui(n,r)))},s=>{const n=e.indexOf(s.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},ok={extension:{type:J.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await er(()=>import("./browserAll-OTRMOWZd.js"),__vite__mapDeps([0,1,2,3,4,5]))}},ak={extension:{type:J.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await er(()=>import("./webworkerAll-BWeqVGSw.js"),__vite__mapDeps([1,2,3,4,5]))}};class Et{constructor(e,r,s){this._x=r||0,this._y=s||0,this._observer=e}clone(e){return new Et(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var wl={exports:{}},lp;function lk(){return lp||(lp=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,h||l,d),A=r?r+c:c;return l._events[A]?l._events[A].fn?l._events[A]=[l._events[A],f]:l._events[A].push(f):(l._events[A]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,A=new Array(f);d<f;d++)A[d]=h[d].fn;return A},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,A){var g=r?r+c:c;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,x,b;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,h),!0;case 4:return m.fn.call(m.context,u,h,d),!0;case 5:return m.fn.call(m.context,u,h,d,f),!0;case 6:return m.fn.call(m.context,u,h,d,f,A),!0}for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];m.fn.apply(m.context,x)}else{var w=m.length,P;for(b=0;b<w;b++)switch(m[b].once&&this.removeListener(c,m[b].fn,void 0,!0),y){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,u);break;case 3:m[b].fn.call(m[b].context,u,h);break;case 4:m[b].fn.call(m[b].context,u,h,d);break;default:if(!x)for(P=1,x=new Array(y-1);P<y;P++)x[P-1]=arguments[P];m[b].fn.apply(m[b].context,x)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var A=this._events[f];if(A.fn)A.fn===u&&(!d||A.once)&&(!h||A.context===h)&&o(this,f);else{for(var g=0,m=[],y=A.length;g<y;g++)(A[g].fn!==u||d&&!A[g].once||h&&A[g].context!==h)&&m.push(A[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(wl)),wl.exports}var ck=lk();const cr=Qe(ck),uk=Math.PI*2,hk=180/Math.PI,dk=Math.PI/180;class at{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new at(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return vl.x=0,vl.y=0,vl}}const vl=new at;class me{constructor(e=1,r=0,s=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,s,n,i,o){return this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,r){r=r||new at;const s=e.x,n=e.y;return r.x=this.a*s+this.c*n+this.tx,r.y=this.b*s+this.d*n+this.ty,r}applyInverse(e,r){r=r||new at;const s=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(s*o+i*-n),u=e.x,h=e.y;return r.x=o*c*u+-i*c*h+(l*i-a*o)*c,r.y=s*c*h+-n*c*u+(-l*s+a*n)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*r-this.b*s,this.b=n*s+this.b*r,this.c=i*r-this.d*s,this.d=i*s+this.d*r,this.tx=o*r-this.ty*s,this.ty=o*s+this.ty*r,this}append(e){const r=this.a,s=this.b,n=this.c,i=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*s+e.b*i,this.c=e.c*r+e.d*n,this.d=e.c*s+e.d*i,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*i+this.ty,this}appendFrom(e,r){const s=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,d=r.d;return this.a=s*c+n*h,this.b=s*u+n*d,this.c=i*c+o*h,this.d=i*u+o*d,this.tx=a*c+l*h+r.tx,this.ty=a*u+l*d+r.ty,this}setTransform(e,r,s,n,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(s*this.a+n*this.c),this.ty=r-(s*this.b+n*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,s=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),l=Math.atan2(s,r),c=Math.abs(a+l);return c<1e-5||Math.abs(uk-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+s*s),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*r+o.y*n),e.position.y=this.ty+(o.x*s+o.y*i),e}invert(){const e=this.a,r=this.b,s=this.c,n=this.d,i=this.tx,o=e*n-r*s;return this.a=n/o,this.b=-r/o,this.c=-s/o,this.d=e/o,this.tx=(s*this.ty-n*i)/o,this.ty=-(e*this.ty-r*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new me;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return pk.identity()}static get shared(){return fk.identity()}}const fk=new me,pk=new me,Qr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Jr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],es=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Jc=[],jy=[],Hi=Math.sign;function Ak(){for(let t=0;t<16;t++){const e=[];Jc.push(e);for(let r=0;r<16;r++){const s=Hi(Qr[t]*Qr[r]+Jr[t]*Zr[r]),n=Hi(Zr[t]*Qr[r]+es[t]*Zr[r]),i=Hi(Qr[t]*Jr[r]+Jr[t]*es[r]),o=Hi(Zr[t]*Jr[r]+es[t]*es[r]);for(let a=0;a<16;a++)if(Qr[a]===s&&Zr[a]===n&&Jr[a]===i&&es[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new me;e.set(Qr[t],Zr[t],Jr[t],es[t],0,0),jy.push(e)}}Ak();const Ve={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>Qr[t],uY:t=>Zr[t],vX:t=>Jr[t],vY:t=>es[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Jc[t][e],sub:(t,e)=>Jc[t][Ve.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Ve.S:Ve.N:Math.abs(e)*2<=Math.abs(t)?t>0?Ve.E:Ve.W:e>0?t>0?Ve.SE:Ve.SW:t>0?Ve.NE:Ve.NW,matrixAppendRotationInv:(t,e,r=0,s=0)=>{const n=jy[Ve.inv(e)];n.tx=r,n.ty=s,t.append(n)}},$i=[new at,new at,new at,new at];class Re{constructor(e=0,r=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Re(0,0,0,0)}clone(){return new Re(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,s,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=s*(1-n),u=s-c,h=a-c,d=a+i+c,f=l-c,A=l+o+c,g=a+u,m=a+i-u,y=l+u,x=l+o-u;return e>=h&&e<=d&&r>=f&&r<=A&&!(e>g&&e<m&&r>y&&r<x)}intersects(e,r){if(!r){const B=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=B)return!1;const M=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>M}const s=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=s||o<=i)return!1;const a=$i[0].set(e.left,e.top),l=$i[1].set(e.left,e.bottom),c=$i[2].set(e.right,e.top),u=$i[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=s||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),A=d*s+f*i,g=d*n+f*i,m=d*s+f*o,y=d*n+f*o;if(Math.max(A,g,m,y)<=d*a.x+f*a.y||Math.min(A,g,m,y)>=d*u.x+f*u.y)return!1;const x=h*(a.y-c.y),b=h*(c.x-a.x),w=x*s+b*i,P=x*n+b*i,C=x*s+b*o,E=x*n+b*o;return!(Math.max(w,P,C,E)<=x*a.x+b*a.y||Math.min(w,P,C,E)>=x*u.x+b*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(s-r,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,r=.001){const s=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=s-this.x,this.height=n-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=s-r,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new Re),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,s=e.y,n=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Vl={default:-1};function Me(t="default"){return Vl[t]===void 0&&(Vl[t]=-1),++Vl[t]}const cp={},it="8.0.0",mk="8.3.4";function Te(t,e,r=3){if(cp[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(s=s.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(s))),cp[e]=!0}const By=()=>{};function Oo(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function up(t){return!(t&t-1)&&!!t}function Oy(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const hp=Object.create(null);function gk(t){const e=hp[t];return e===void 0&&(hp[t]=Me("resource")),e}const Ny=class zy extends cr{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...zy.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){Te(it,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=gk(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Ny.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let yk=Ny;const Fy=class Ly extends cr{constructor(e={}){super(),this.options=e,this.uid=Me("textureSource"),this._resourceType="textureSource",this._resourceId=Me("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...Ly.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new yk(Oy(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Me("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,s){s||(s=this._resolution),e||(e=this.width),r||(r=this.height);const n=Math.round(e*s),i=Math.round(r*s);return this.width=n/s,this.height=i/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=Me("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=up(this.pixelWidth)&&up(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};Fy.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let ur=Fy;class qh extends ur{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(r instanceof Float32Array?s="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?s="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?s="rgba16uint":(r instanceof Int8Array,s="bgra8unorm")),super({...e,resource:r,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}qh.extension=J.TextureSource;const dp=new me;class xk{constructor(e,r){this.mapCoord=new me,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];r[n]=i*s.a+o*s.c+s.tx,r[n+1]=i*s.b+o*s.d+s.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(dp.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(dp));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class Ae extends cr{constructor({source:e,label:r,frame:s,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=Me("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Re,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new ur,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new xk(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:s,height:n}=this._source,i=r.x/s,o=r.y/n,a=r.width/s,l=r.height/n;let c=this.rotate;if(c){const u=a/2,h=l/2,d=i+u,f=o+h;c=Ve.add(c,Ve.NW),e.x0=d+u*Ve.uX(c),e.y0=f+h*Ve.uY(c),c=Ve.add(c,2),e.x1=d+u*Ve.uX(c),e.y1=f+h*Ve.uY(c),c=Ve.add(c,2),e.x2=d+u*Ve.uX(c),e.y2=f+h*Ve.uY(c),c=Ve.add(c,2),e.x3=d+u*Ve.uX(c),e.y3=f+h*Ve.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Te(it,"Texture.baseTexture is now Texture.source"),this._source}}Ae.EMPTY=new Ae({label:"EMPTY",source:new ur({label:"EMPTY"})});Ae.EMPTY.destroy=By;Ae.WHITE=new Ae({source:new qh({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ae.WHITE.destroy=By;function bk(t,e,r){const{width:s,height:n}=r.orig,i=r.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*s,t.maxX=t.minX+o,t.minY=i.y-e._y*n,t.maxY=t.minY+a}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*n,t.maxY=t.minY+n}const fp=new me;class Qt{constructor(e=1/0,r=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=fp,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Re);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=fp,this}set(e,r,s,n){this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(e,r,s,n,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let d=this.minX,f=this.minY,A=this.maxX,g=this.maxY,m=o*e+l*r+u,y=a*e+c*r+h;m<d&&(d=m),y<f&&(f=y),m>A&&(A=m),y>g&&(g=y),m=o*s+l*r+u,y=a*s+c*r+h,m<d&&(d=m),y<f&&(f=y),m>A&&(A=m),y>g&&(g=y),m=o*e+l*n+u,y=a*e+c*n+h,m<d&&(d=m),y<f&&(f=y),m>A&&(A=m),y>g&&(g=y),m=o*s+l*n+u,y=a*s+c*n+h,m<d&&(d=m),y<f&&(f=y),m>A&&(A=m),y>g&&(g=y),this.minX=d,this.minY=f,this.maxX=A,this.maxY=g}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,s=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let d=o*r+l*s+u,f=a*r+c*s+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*n+l*s+u,f=a*n+c*s+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+l*i+u,f=a*r+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*n+l*i+u,f=a*n+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,s,n){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Qt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,s,n){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,d=n.d,f=n.tx,A=n.ty;for(let g=r;g<s;g+=2){const m=e[g],y=e[g+1],x=c*m+h*y+f,b=u*m+d*y+A;i=x<i?x:i,o=b<o?b:o,a=x>a?x:a,l=b>l?b:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var qk={grad:.9,turn:360,rad:360/(2*Math.PI)},fr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Ke=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Lt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},Dy=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},pp=function(t){return{r:Lt(t.r,0,255),g:Lt(t.g,0,255),b:Lt(t.b,0,255),a:Lt(t.a)}},_l=function(t){return{r:Ke(t.r),g:Ke(t.g),b:Ke(t.b),a:Ke(t.a,3)}},wk=/^#([0-9a-f]{3,8})$/i,Gi=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Uy=function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=Math.max(e,r,s),o=i-Math.min(e,r,s),a=o?i===e?(r-s)/o:i===r?2+(s-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},Hy=function(t){var e=t.h,r=t.s,s=t.v,n=t.a;e=e/360*6,r/=100,s/=100;var i=Math.floor(e),o=s*(1-r),a=s*(1-(e-i)*r),l=s*(1-(1-e+i)*r),c=i%6;return{r:255*[s,a,o,o,l,s][c],g:255*[l,s,s,a,o,o][c],b:255*[o,o,l,s,s,a][c],a:n}},Ap=function(t){return{h:Dy(t.h),s:Lt(t.s,0,100),l:Lt(t.l,0,100),a:Lt(t.a)}},mp=function(t){return{h:Ke(t.h),s:Ke(t.s),l:Ke(t.l),a:Ke(t.a,3)}},gp=function(t){return Hy((r=(e=t).s,{h:e.h,s:(r*=((s=e.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:e.a}));var e,r,s},Dn=function(t){return{h:(e=Uy(t)).h,s:(n=(200-(r=e.s))*(s=e.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,s,n},vk=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Vk=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_k=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,kk=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,eu={string:[[function(t){var e=wk.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Ke(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Ke(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=_k.exec(t)||kk.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:pp({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=vk.exec(t)||Vk.exec(t);if(!e)return null;var r,s,n=Ap({h:(r=e[1],s=e[2],s===void 0&&(s="deg"),Number(r)*(qk[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return gp(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=n===void 0?1:n;return fr(e)&&fr(r)&&fr(s)?pp({r:Number(e),g:Number(r),b:Number(s),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,s=t.l,n=t.a,i=n===void 0?1:n;if(!fr(e)||!fr(r)||!fr(s))return null;var o=Ap({h:Number(e),s:Number(r),l:Number(s),a:Number(i)});return gp(o)},"hsl"],[function(t){var e=t.h,r=t.s,s=t.v,n=t.a,i=n===void 0?1:n;if(!fr(e)||!fr(r)||!fr(s))return null;var o=function(a){return{h:Dy(a.h),s:Lt(a.s,0,100),v:Lt(a.v,0,100),a:Lt(a.a)}}({h:Number(e),s:Number(r),v:Number(s),a:Number(i)});return Hy(o)},"hsv"]]},yp=function(t,e){for(var r=0;r<e.length;r++){var s=e[r][0](t);if(s)return[s,e[r][1]]}return[null,void 0]},Sk=function(t){return typeof t=="string"?yp(t.trim(),eu.string):typeof t=="object"&&t!==null?yp(t,eu.object):[null,void 0]},kl=function(t,e){var r=Dn(t);return{h:r.h,s:Lt(r.s+100*e,0,100),l:r.l,a:r.a}},Sl=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},xp=function(t,e){var r=Dn(t);return{h:r.h,s:r.s,l:Lt(r.l+100*e,0,100),a:r.a}},tu=function(){function t(e){this.parsed=Sk(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Ke(Sl(this.rgba),2)},t.prototype.isDark=function(){return Sl(this.rgba)<.5},t.prototype.isLight=function(){return Sl(this.rgba)>=.5},t.prototype.toHex=function(){return e=_l(this.rgba),r=e.r,s=e.g,n=e.b,o=(i=e.a)<1?Gi(Ke(255*i)):"","#"+Gi(r)+Gi(s)+Gi(n)+o;var e,r,s,n,i,o},t.prototype.toRgb=function(){return _l(this.rgba)},t.prototype.toRgbString=function(){return e=_l(this.rgba),r=e.r,s=e.g,n=e.b,(i=e.a)<1?"rgba("+r+", "+s+", "+n+", "+i+")":"rgb("+r+", "+s+", "+n+")";var e,r,s,n,i},t.prototype.toHsl=function(){return mp(Dn(this.rgba))},t.prototype.toHslString=function(){return e=mp(Dn(this.rgba)),r=e.h,s=e.s,n=e.l,(i=e.a)<1?"hsla("+r+", "+s+"%, "+n+"%, "+i+")":"hsl("+r+", "+s+"%, "+n+"%)";var e,r,s,n,i},t.prototype.toHsv=function(){return e=Uy(this.rgba),{h:Ke(e.h),s:Ke(e.s),v:Ke(e.v),a:Ke(e.a,3)};var e},t.prototype.invert=function(){return nr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),nr(kl(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),nr(kl(this.rgba,-e))},t.prototype.grayscale=function(){return nr(kl(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),nr(xp(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),nr(xp(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?nr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Ke(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Dn(this.rgba);return typeof e=="number"?nr({h:e,s:r.s,l:r.l,a:r.a}):Ke(r.h)},t.prototype.isEqual=function(e){return this.toHex()===nr(e).toHex()},t}(),nr=function(t){return t instanceof tu?t:new tu(t)},bp=[],Ck=function(t){t.forEach(function(e){bp.indexOf(e)<0&&(e(tu,eu),bp.push(e))})};function Pk(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in r)s[r[n]]=n;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=s[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,d="black";if(!i.length)for(var f in r)i[f]=new t(r[f]).toRgb();for(var A in r){var g=(a=u,l=i[A],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<h&&(h=g,d=A)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}Ck([Pk]);const Js=class In{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof In)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const s=typeof e;if(s!==typeof r)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,o)=>i===r[o]);if(e!==null&&r!==null){const i=Object.keys(e),o=Object.keys(r);return i.length!==o.length?!1:i.every(a=>e[a]===r[a])}return e===r}toRgba(){const[e,r,s,n]=this._components;return{r:e,g:r,b:s,a:n}}toRgb(){const[e,r,s]=this._components;return{r:e,g:r,b:s}}toRgbaString(){const[e,r,s]=this.toUint8RgbArray();return`rgba(${e},${r},${s},${this.alpha})`}toUint8RgbArray(e){const[r,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(s*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,s,n,i]=this._components;return e[0]=r,e[1]=s,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,s,n]=this._components;return e[0]=r,e[1]=s,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,r,s]=this.toUint8RgbArray();return(s<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,s,n,i]=In._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=s,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return r&&(s=s*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,s,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,s=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,s,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,s,n,i=255]=e,r/=255,s/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=In.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=nr(e);o.isValid()&&({r,g:s,b:n,a:i}=o.rgba,r/=255,s/=255,n/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=s,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,s]=this._components;this._int=(e*255<<16)+(r*255<<8)+(s*255|0)}_clamp(e,r=0,s=1){return typeof e=="number"?Math.min(Math.max(e,r),s):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,r),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof In||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Js.shared=new Js;Js._temp=new Js;Js.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let et=Js;const Ek={cullArea:null,cullable:!1,cullableChildren:!0};class wh{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Tk{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new wh(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const s=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[s]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const xr=new Tk,Rk={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){Te("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function Mk(t,e,r){const s=t.length;let n;if(e>=s||r===0)return;r=e+r>s?s-e:r;const i=s-r;for(n=e;n<i;++n)t[n]=t[n+r];t.length=i}const Ik={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,s=r-t,n=[];if(s>0&&s<=r){for(let o=r-1;o>=t;o--){const a=this.children[o];a&&(n.push(a),a.parent=null)}Mk(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let o=0;o<n.length;++o)this.emit("childRemoved",n[o],this,o),n[o].emit("removed",this);return n.length>0&&this._didViewChangeTick++,n}else if(s===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||Te(it,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),r.prepend(s),t.setFromMatrix(r),t}},jk={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const s=this.children,n=s.length;for(let i=0;i<n;i++)s[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:s}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];s[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];s[i.pipe].pop(i,this,t)}}};class qp{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class Bk{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const s=this._tests[r];if(s.test(e))return xr.get(s.maskClass,e)}return e}returnMaskEffect(e){xr.return(e)}}const ru=new Bk;qt.handleByList(J.MaskEffect,ru._effectClasses);const Ok={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,s)=>r.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),ru.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=ru.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new qp);t=t;const r=t?.length>0,s=e.filters?.length>0,n=r!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new qp),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},Nk={label:null,get name(){return Te(it,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){Te(it,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let s=0;s<r.length;s++){const n=r[s];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let s=0;s<r.length;s++){const i=r[s].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const s=this.children;for(let n=0;n<s.length;n++){const i=s[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let n=0;n<s.length;n++)s[n].getChildrenByLabel(t,!0,r);return r}},ft=new wh(me),br=new wh(Qt),zk=new me,Fk={getFastGlobalBounds(t,e){e||(e=new Qt),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(s=br.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;s.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,s,r)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,s.applyMatrix(o.worldTransform)),this.effects[a].addBounds(s,!0));i&&(s.applyMatrix(o.worldTransform.copyTo(zk).invert()),e.addBounds(s,this.relativeGroupTransform)),e.addBounds(s),br.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),br.return(s))}};function $y(t,e,r){r.clear();let s,n;return t.parent?e?s=t.parent.worldTransform:(n=ft.get().identity(),s=vh(t,n)):s=me.IDENTITY,Gy(t,r,s,e),n&&ft.return(n),r.isValid||r.set(0,0,0,0),r}function Gy(t,e,r,s){if(!t.visible||!t.measurable)return;let n;s?n=t.worldTransform:(t.updateLocalTransform(),n=ft.get(),n.appendFrom(t.localTransform,r));const i=e,o=!!t.effects.length;if(o&&(e=br.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{t.bounds&&(e.matrix=n,e.addBounds(t.bounds));for(let a=0;a<t.children.length;a++)Gy(t.children[a],e,n,s)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,me.IDENTITY),br.return(e)}s||ft.return(n)}function vh(t,e){const r=t.parent;return r&&(vh(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function Wy(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,s=t>>8&255,n=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=r*i/255|0,c=s*o/255|0,u=n*a/255|0;return(l<<16)+(c<<8)+u}const wp=16777215;function vp(t,e){return t===wp?e:e===wp?t:Wy(t,e)}function mo(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const Lk={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=vh(this,ft.get().identity());return t.appendFrom(this.localTransform,r),ft.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?mo(this.renderGroup.worldColor):this.parentRenderGroup?mo(vp(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=vp(e,r.localColor),r=r.parent;return mo(e)}};let Cl=0;const Vp=500;function _e(...t){Cl!==Vp&&(Cl++,Cl===Vp?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function Yy(t,e,r){return e.clear(),r||(r=me.IDENTITY),Ky(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function Ky(t,e,r,s,n){let i;if(n)i=ft.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=ft.get(),i.appendFrom(l,r)}const o=e,a=!!t.effects.length;if(a&&(e=br.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)Ky(l[c],e,i,s,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);o.addBounds(e,me.IDENTITY),br.return(e)}ft.return(i)}function Xy(t,e){const r=t.children;for(let s=0;s<r.length;s++){const n=r[s],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,n.children.length&&Xy(n,e)}return e.didChange}const Dk=new me,Uk={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Qt});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),Xy(this,t),t.didChange&&Yy(this,t.localBounds,Dk),t.localBounds},getBounds(t,e){return $y(this,t,e||new Qt)}},Hk={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},$k={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Gk))}};function Gk(t,e){return t._zIndex-e._zIndex}const Wk={getGlobalPosition(t=new at,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const s=this.getGlobalTransform(ft.get(),r);return e=s.apply(t,e),ft.return(s),e},toLocal(t,e,r,s){e&&(t=e.toGlobal(t,r,s));const n=this.getGlobalTransform(ft.get(),s);return r=n.applyInverse(t,r),ft.return(n),r}};class Qy{constructor(){this.uid=Me("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Yk=0;class Kk{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,s){const n=new ur({...this.textureOptions,width:e,height:r,resolution:1,antialias:s,autoGarbageCollect:!1});return new Ae({source:n,label:`texturePool_${Yk++}`})}getOptimalTexture(e,r,s=1,n){let i=Math.ceil(e*s-1e-6),o=Math.ceil(r*s-1e-6);i=Oo(i),o=Oo(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,n)),l.source._resolution=s,l.source.width=i/s,l.source.height=o/s,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,r=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const s=this._texturePool[r];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const Xk=new Kk;class Qk{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new me,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Qy,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let s=0;s<r.length;s++){const n=r[s];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Xk.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let s=0;s<r.length;s++)this.addChild(r[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let s=0;s<r.length;s++)this.removeChild(r[s])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const s=e.children;for(let n=0;n<s.length;n++)this._getChildren(s[n],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new me),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new me),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new me),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Zk(t,e,r={}){for(const s in e)!r[s]&&e[s]!==void 0&&(t[s]=e[s])}const Pl=new Et(null),El=new Et(null),Tl=new Et(null,1,1),_p=1,Jk=2,Rl=4;class yi extends cr{constructor(e={}){super(),this.uid=Me("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new me,this.relativeGroupTransform=new me,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Et(this,0,0),this._scale=Tl,this._pivot=El,this._skew=Pl,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Zk(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){Te("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),qt.mixin(yi,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||Te(it,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const r=e[0],s=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),s&&(s.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,s&&s.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const r=e[0],s=this.children.indexOf(r);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,s),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=xr.get(Qk,this),this.groupTransform=me.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),xr.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new me),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*hk}set angle(e){this.rotation=e*dk}get pivot(){return this._pivot===El&&(this._pivot=new Et(this,0,0)),this._pivot}set pivot(e){this._pivot===El&&(this._pivot=new Et(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Pl&&(this._skew=new Et(this,0,0)),this._skew}set skew(e){this._skew===Pl&&(this._skew=new Et(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Tl&&(this._scale=new Et(this,1,1)),this._scale}set scale(e){this._scale===Tl&&(this._scale=new Et(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const s=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,s=this._scale,n=this._pivot,i=this._position,o=s._x,a=s._y,l=n._x,c=n._y;r.a=this._cx*o,r.b=this._sx*o,r.c=this._cy*a,r.d=this._sy*a,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=_p,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=et.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=_p,this._onUpdate())}get tint(){return mo(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Jk,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rl,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rl,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Rl,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let n=0;n<r.length;++n)r[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}qt.mixin(yi,Ik,Fk,Wk,Hk,Uk,Ok,Nk,$k,Ek,Rk,Lk,jk);class eS extends yi{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new Qt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:s,y:n}=e;return s>=r.minX&&s<=r.maxX&&n>=r.minY&&n<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,s){const{renderPipes:n,renderableGC:i}=r;n.blendMode.setBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const a=this.children,l=a.length;for(let c=0;c<l;c++)a[c].collectRenderables(e,r,s)}}class Zn extends eS{constructor(e=Ae.EMPTY){e instanceof Ae&&(e={texture:e});const{texture:r=Ae.EMPTY,anchor:s,roundPixels:n,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new Et({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,r=!1){return e instanceof Ae?new Zn(e):new Zn(Ae.from(e,r))}set texture(e){e||(e=Ae.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return bk(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Te("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,s=this._bounds,{width:n,height:i}=r.orig;s.minX=-e._x*n,s.maxX=s.minX+n,s.minY=-e._y*i,s.maxY=s.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const tS=new Qt;function Zy(t,e,r){const s=tS;t.measurable=!0,$y(t,r,s),e.addBoundsMask(s),t.measurable=!1}function Jy(t,e,r){const s=br.get();t.measurable=!0;const n=ft.get().identity(),i=ex(t,r,n);Yy(t,s,i),t.measurable=!1,e.addBoundsMask(s),ft.return(n),br.return(s)}function ex(t,e,r){return t?(t!==e&&(ex(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(_e("Mask bounds, renderable is not inside the root container"),r)}class tx{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Zn),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||Zy(this.mask,e,r)}addLocalBounds(e,r){Jy(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Zn}}tx.extension=J.MaskEffect;class rx{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}rx.extension=J.MaskEffect;class sx{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){Zy(this.mask,e,r)}addLocalBounds(e,r){Jy(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof yi}}sx.extension=J.MaskEffect;const rS={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let kp=rS;const Le={get(){return kp},set(t){kp=t}};class nx extends ur{constructor(e){e.resource||(e.resource=Le.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,s=this._resolution){const n=super.resize(e,r,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}nx.extension=J.TextureSource;class ps extends ur{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=Le.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,_e("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}ps.extension=J.TextureSource;var No=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(No||{});class Ml{constructor(e,r=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=s,this._once=n}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const ix=class St{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ml(null,null,1/0),this.deltaMS=1/St.targetFPMS,this.elapsedMS=1/St.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,s=No.NORMAL){return this._addListener(new Ml(e,r,s))}addOnce(e,r,s=No.NORMAL){return this._addListener(new Ml(e,r,s,!0))}_addListener(e){let r=this._head.next,s=this._head;if(!r)e.connect(s);else{for(;r;){if(e.priority>r.priority){e.connect(s);break}s=r,r=r.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,r){let s=this._head.next;for(;s;)s.match(e,r)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*St.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,r)/1e3,St.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!St._shared){const e=St._shared=new St;e.autoStart=!0,e._protected=!0}return St._shared}static get system(){if(!St._system){const e=St._system=new St;e.autoStart=!0,e._protected=!0}return St._system}};ix.targetFPMS=.06;let xt=ix,Il;async function ox(){return Il??(Il=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!r)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Il}const ca=class ax extends ur{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...ax.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=xt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await ox(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(xt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(xt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(xt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};ca.extension=J.TextureSource;ca.defaultOptions={...ur.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ca.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let go=ca;const Xt=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||r?e(s):s):t);class sS{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||_e(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const s=Xt(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(s,r);break}}const i=new Map(Object.entries(n||{}));n||s.forEach(l=>{i.set(l,r)});const o=[...i.keys()],a={cacheKeys:o,keys:s};s.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=n?n[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&_e("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){_e(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const Pe=new sS,su=[];qt.handleByList(J.TextureSource,su);function lx(t={}){const e=t&&t.resource,r=e?t.resource:t,s=e?t:{resource:t};for(let n=0;n<su.length;n++){const i=su[n];if(i.test(r))return new i(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function nS(t={},e=!1){const r=t&&t.resource,s=r?t.resource:t,n=r?t:{resource:t};if(!e&&Pe.has(s))return Pe.get(s);const i=new Ae({source:lx(n)});return i.on("destroy",()=>{Pe.has(s)&&Pe.remove(s)}),e||Pe.set(s,i),i}function iS(t,e=!1){return typeof t=="string"?Pe.get(t):t instanceof ur?new Ae({source:t}):nS(t,e)}Ae.from=iS;ur.from=lx;qt.add(tx,rx,sx,go,ps,nx,qh);var Ur=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(Ur||{});function $t(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function _n(t){return t.split("?")[0].split("#")[0]}function oS(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function aS(t,e,r){return t.replace(new RegExp(oS(e),"g"),r)}function lS(t,e){let r="",s=0,n=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",s=0):(r=r.slice(0,l),s=r.length-1-r.lastIndexOf("/")),n=a,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,n=a,i=0;continue}}}else r.length>0?r+=`/${t.slice(n+1,a)}`:r=t.slice(n+1,a),s=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}const Mt={toPosix(t){return aS(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){$t(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if($t(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=_n(this.toPosix(e??Le.get().getBaseUrl())),n=_n(this.toPosix(r??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?Mt.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if($t(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=lS(t),t.length>0&&s&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return $t(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const s=t[r];if($t(s),s.length>0)if(e===void 0)e=s;else{const n=t[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if($t(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let s=-1,n=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){s=a;break}}else n=!1;return s===-1?r?"/":this.isUrl(o)?i+t:i:r&&s===1?"//":i+t.slice(0,s)},rootname(t){$t(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){$t(t),e&&$t(e),t=_n(this.toPosix(t));let r=0,s=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){r=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(s=i):(o=-1,s=a))}return r===s?s=a:s===-1&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){r=i+1;break}}else s===-1&&(n=!1,s=i+1);return s===-1?"":t.slice(r,s)},extname(t){$t(t),t=_n(this.toPosix(t));let e=-1,r=0,s=-1,n=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!n){r=o+1;break}continue}s===-1&&(n=!1,s=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||s===-1||i===0||i===1&&e===s-1&&e===r+1?"":t.slice(e,s)},parse(t){$t(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=_n(this.toPosix(t));let r=t.charCodeAt(0);const s=this.isAbsolute(t);let n;e.root=this.rootname(t),s||this.hasProtocol(t)?n=1:n=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&s?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&s?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function cx(t,e,r,s,n){const i=e[r];for(let o=0;o<i.length;o++){const a=i[o];r<e.length-1?cx(t.replace(s[r],a),e,r+1,s,n):n.push(t.replace(s[r],a))}}function cS(t){const e=/\{(.*?)\}/g,r=t.match(e),s=[];if(r){const n=[];r.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),cx(t,n,0,r,s)}else s.push(t);return s}const zo=t=>!Array.isArray(t);class fn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}getAlias(e){const{alias:r,src:s}=e;return Xt(r||s,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&_e("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const s=[];let n=r;Array.isArray(r)||(n=Object.entries(r).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);s.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));s.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=s}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let s;s=i=>{this.hasKey(i)&&_e(`[Resolver] already has key: ${i} overwriting`)},Xt(r).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c}=i;const u=Xt(o).map(f=>typeof f=="string"?cS(f):Array.isArray(f)?f:[f]),h=this.getAlias(i);Array.isArray(h)?h.forEach(s):s(h);const d=[];u.forEach(f=>{f.forEach(A=>{let g={};if(typeof A!="object"){g.src=A;for(let m=0;m<this._parsers.length;m++){const y=this._parsers[m];if(y.test(A)){g=y.parse(A);break}}}else a=A.data??a,l=A.format??l,c=A.loadParser??c,g={...g,...A};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:h,data:a,format:l,loadParser:c}),d.push(g)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const r=zo(e);e=Xt(e);const s={};return e.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(n,l)]=c}s[n]=a}}),r?s[e[0]]:s}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const s={};for(const n in r)s[n]=r[n].src;return s}return r.src}resolve(e){const r=zo(e);e=Xt(e);const s={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),r?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const s=e[r],n=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:s,data:n,loadParser:i,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=Mt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.format=o??e.format??uS(e.src),e}}fn.RETINA_PREFIX=/@([0-9\.]+)x/;function uS(t){return t.split(".").pop().split("?").shift().split("#").shift()}const nu=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},ux=class jn{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof Ae?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const s=parseFloat(r.meta.scale);s?(this.resolution=s,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=jn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const s=jn.BATCH_SIZE;for(;r-e<s&&r<this._frameKeys.length;){const n=this._frameKeys[r],i=this._frames[n],o=i.frame;if(o){let a=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Re(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?a=new Re(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Re(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Re(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new Ae({source:this.textureSource,frame:a,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let s=0;s<e[r].length;s++){const n=e[r][s];this.animations[r].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*jn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*jn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};ux.BATCH_SIZE=1e3;let iu=ux;const hS=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function hx(t,e,r){const s={};if(t.forEach(n=>{s[n]=e}),Object.keys(e.textures).forEach(n=>{s[n]=e.textures[n]}),!r){const n=Mt.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=hx([`${n}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(s,a)})}return s}const dS={extension:J.Asset,cache:{test:t=>t instanceof iu,getCacheableAssets:(t,e)=>hx(t,e,!1)},resolver:{extension:{type:J.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),s=r.pop(),n=r.pop();return s==="json"&&hS.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(fn.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:J.LoadParser,priority:Ur.Normal,name:"spritesheetLoader"},async testParse(t,e){return Mt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:s,imageFilename:n,textureOptions:i}=e?.data??{};let o=Mt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(s instanceof Ae)a=s;else{const u=nu(o+(n??t.meta.image),e.src);a=(await r.load([{src:u,data:i}]))[u]}const l=new iu(a.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const d of c){if(typeof d!="string")continue;let f=o+d;e.data?.ignoreMultiPack||(f=nu(f,e.src),u.push(r.load({src:f,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(d=>{d.linkedSheets=[l].concat(l.linkedSheets.filter(f=>f!==d))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};qt.add(dS);const jl=Object.create(null),Sp=Object.create(null);function Vh(t,e){let r=Sp[t];return r===void 0&&(jl[e]===void 0&&(jl[e]=1),Sp[t]=r=jl[e]++),r}let Wi;function dx(){return(!Wi||Wi?.isContextLost())&&(Wi=Le.get().createCanvas().getContext("webgl",{})),Wi}let Yi;function fS(){if(!Yi){Yi="mediump";const t=dx();t&&t.getShaderPrecisionFormat&&(Yi=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return Yi}function pS(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function AS(t,e,r){const s=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&s!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function mS(t,e){return e?`#version 300 es
${t}`:t}const gS={},yS={};function xS(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const s=r?gS:yS;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function bS(t,e){return e?t.replace("#version 300 es",""):t}const Bl={stripVersion:bS,ensurePrecision:AS,addProgramDefines:pS,setProgramName:xS,insertVersion:mS},Ol=Object.create(null),fx=class ou{constructor(e){e={...ou.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:fS()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let n=e.fragment,i=e.vertex;Object.keys(Bl).forEach(o=>{const a=s[o];n=Bl[o](n,a,!0),i=Bl[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=Vh(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return Ol[r]||(Ol[r]=new ou(e)),Ol[r]}};fx.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let px=fx;const Cp={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function qS(t){return Cp[t]??Cp.float32}const wS={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function vS({source:t,entryPoint:e}){const r={},s=t.indexOf(`fn ${e}`);if(s!==-1){const n=t.indexOf("->",s);if(n!==-1){const i=t.substring(s,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=wS[a[3]]??"float32";r[a[2]]={location:parseInt(a[1],10),format:l,stride:qS(l).stride,offset:0,instance:!1,start:0}}}}return r}function Nl(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((A,g)=>{const[m,y]=g.split(":");return A[m.trim()]=y.trim(),A},{});return f?{name:d,members:f}:null}).filter(({name:h})=>c.some(d=>d.type===h))??[];return{groups:c,structs:u}}var Bn=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Bn||{});function VS({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:Bn.VERTEX|Bn.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:Bn.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:Bn.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function _S({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function kS(t,e){const r=new Set,s=new Set,n=[...t.structs,...e.structs].filter(o=>r.has(o.name)?!1:(r.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return s.has(a)?!1:(s.add(a),!0)});return{structs:n,groups:i}}const zl=Object.create(null);class ua{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:s,layout:n,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=r,this.vertex=s,r.source===s.source){const a=Nl(r.source);this.structsAndGroups=a}else{const a=Nl(s.source),l=Nl(r.source);this.structsAndGroups=kS(a,l)}this.layout=n??_S(this.structsAndGroups),this.gpuLayout=i??VS(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,s=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=Vh(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=vS(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return zl[r]||(zl[r]=new ua(e)),zl[r]}}const Ax=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],SS=Ax.reduce((t,e)=>(t[e]=!0,t),{});function CS(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const mx=class gx{constructor(e,r){this._touched=0,this.uid=Me("uniform"),this._resourceType="uniformGroup",this._resourceId=Me("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...gx.defaultOptions,...r},this.uniformStructures=e;const s={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!SS[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${Ax.join(", ")}`);i.value??(i.value=CS(i.type,i.size)),s[n]=i.value}this.uniforms=s,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=Vh(Object.keys(s).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};mx.defaultOptions={ubo:!1,isStatic:!1};let yx=mx;class yo{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const s in e){const n=e[s];this.setResource(n,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const s in this.resources)e[r++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,r){const s=this.resources[r];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const s in r)r[s]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const s in r)r[s]===e&&(r[s]=null)}else this._updateKey()}}var au=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(au||{});class _h extends cr{constructor(e){super(),this.uid=Me("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:s,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=r,this.glProgram=s,o===void 0&&(o=0,r&&(o|=au.WEBGPU),s&&(o|=au.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&n&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&n&&!a){const c=r.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},a={},r&&r.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new yo,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let d=i[u];!d.source&&!d._resourceType&&(d=new yx(d));const f=l[h];f&&(n[f.group]||(n[f.group]=new yo,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(d,f.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,l)}addResource(e,r,s){var n,i;(n=this._uniformBindMap)[r]||(n[r]={}),(i=this._uniformBindMap[r])[s]||(i[s]=e),this.groups[r]||(this.groups[r]=new yo,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const s={};for(const n in r){const i=r[n];Object.defineProperty(s,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return s}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:s,...n}=e;let i,o;return r&&(i=ua.from(r)),s&&(o=px.from(s)),new _h({gpuProgram:i,glProgram:o,...n})}}var Ki={exports:{}},Pp;function PS(){if(Pp)return Ki.exports;Pp=1,Ki.exports=t,Ki.exports.default=t;function t(q,_,k){k=k||2;var S=_&&_.length,V=S?_[0]*k:q.length,T=e(q,0,V,k,!0),R=[];if(!T||T.next===T.prev)return R;var I,O,D,ee,Z,te,ye;if(S&&(T=l(q,_,T,k)),q.length>80*k){I=D=q[0],O=ee=q[1];for(var ne=k;ne<V;ne+=k)Z=q[ne],te=q[ne+1],Z<I&&(I=Z),te<O&&(O=te),Z>D&&(D=Z),te>ee&&(ee=te);ye=Math.max(D-I,ee-O),ye=ye!==0?32767/ye:0}return s(T,R,k,I,O,ye,0),R}function e(q,_,k,S,V){var T,R;if(V===Q(q,_,k,S)>0)for(T=_;T<k;T+=S)R=G(T,q[T],q[T+1],R);else for(T=k-S;T>=_;T-=S)R=G(T,q[T],q[T+1],R);return R&&w(R,R.next)&&(F(R),R=R.next),R}function r(q,_){if(!q)return q;_||(_=q);var k=q,S;do if(S=!1,!k.steiner&&(w(k,k.next)||b(k.prev,k,k.next)===0)){if(F(k),k=_=k.prev,k===k.next)break;S=!0}else k=k.next;while(S||k!==_);return _}function s(q,_,k,S,V,T,R){if(q){!R&&T&&f(q,S,V,T);for(var I=q,O,D;q.prev!==q.next;){if(O=q.prev,D=q.next,T?i(q,S,V,T):n(q)){_.push(O.i/k|0),_.push(q.i/k|0),_.push(D.i/k|0),F(q),q=D.next,I=D.next;continue}if(q=D,q===I){R?R===1?(q=o(r(q),_,k),s(q,_,k,S,V,T,2)):R===2&&a(q,_,k,S,V,T):s(r(q),_,k,S,V,T,1);break}}}}function n(q){var _=q.prev,k=q,S=q.next;if(b(_,k,S)>=0)return!1;for(var V=_.x,T=k.x,R=S.x,I=_.y,O=k.y,D=S.y,ee=V<T?V<R?V:R:T<R?T:R,Z=I<O?I<D?I:D:O<D?O:D,te=V>T?V>R?V:R:T>R?T:R,ye=I>O?I>D?I:D:O>D?O:D,ne=S.next;ne!==_;){if(ne.x>=ee&&ne.x<=te&&ne.y>=Z&&ne.y<=ye&&y(V,I,T,O,R,D,ne.x,ne.y)&&b(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function i(q,_,k,S){var V=q.prev,T=q,R=q.next;if(b(V,T,R)>=0)return!1;for(var I=V.x,O=T.x,D=R.x,ee=V.y,Z=T.y,te=R.y,ye=I<O?I<D?I:D:O<D?O:D,ne=ee<Z?ee<te?ee:te:Z<te?Z:te,Ht=I>O?I>D?I:D:O>D?O:D,lt=ee>Z?ee>te?ee:te:Z>te?Z:te,ct=g(ye,ne,_,k,S),sr=g(Ht,lt,_,k,S),oe=q.prevZ,xe=q.nextZ;oe&&oe.z>=ct&&xe&&xe.z<=sr;){if(oe.x>=ye&&oe.x<=Ht&&oe.y>=ne&&oe.y<=lt&&oe!==V&&oe!==R&&y(I,ee,O,Z,D,te,oe.x,oe.y)&&b(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,xe.x>=ye&&xe.x<=Ht&&xe.y>=ne&&xe.y<=lt&&xe!==V&&xe!==R&&y(I,ee,O,Z,D,te,xe.x,xe.y)&&b(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;oe&&oe.z>=ct;){if(oe.x>=ye&&oe.x<=Ht&&oe.y>=ne&&oe.y<=lt&&oe!==V&&oe!==R&&y(I,ee,O,Z,D,te,oe.x,oe.y)&&b(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;xe&&xe.z<=sr;){if(xe.x>=ye&&xe.x<=Ht&&xe.y>=ne&&xe.y<=lt&&xe!==V&&xe!==R&&y(I,ee,O,Z,D,te,xe.x,xe.y)&&b(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function o(q,_,k){var S=q;do{var V=S.prev,T=S.next.next;!w(V,T)&&P(V,S,S.next,T)&&j(V,T)&&j(T,V)&&(_.push(V.i/k|0),_.push(S.i/k|0),_.push(T.i/k|0),F(S),F(S.next),S=q=T),S=S.next}while(S!==q);return r(S)}function a(q,_,k,S,V,T){var R=q;do{for(var I=R.next.next;I!==R.prev;){if(R.i!==I.i&&x(R,I)){var O=z(R,I);R=r(R,R.next),O=r(O,O.next),s(R,_,k,S,V,T,0),s(O,_,k,S,V,T,0);return}I=I.next}R=R.next}while(R!==q)}function l(q,_,k,S){var V=[],T,R,I,O,D;for(T=0,R=_.length;T<R;T++)I=_[T]*S,O=T<R-1?_[T+1]*S:q.length,D=e(q,I,O,S,!1),D===D.next&&(D.steiner=!0),V.push(m(D));for(V.sort(c),T=0;T<V.length;T++)k=u(V[T],k);return k}function c(q,_){return q.x-_.x}function u(q,_){var k=h(q,_);if(!k)return _;var S=z(k,q);return r(S,S.next),r(k,k.next)}function h(q,_){var k=_,S=q.x,V=q.y,T=-1/0,R;do{if(V<=k.y&&V>=k.next.y&&k.next.y!==k.y){var I=k.x+(V-k.y)*(k.next.x-k.x)/(k.next.y-k.y);if(I<=S&&I>T&&(T=I,R=k.x<k.next.x?k:k.next,I===S))return R}k=k.next}while(k!==_);if(!R)return null;var O=R,D=R.x,ee=R.y,Z=1/0,te;k=R;do S>=k.x&&k.x>=D&&S!==k.x&&y(V<ee?S:T,V,D,ee,V<ee?T:S,V,k.x,k.y)&&(te=Math.abs(V-k.y)/(S-k.x),j(k,q)&&(te<Z||te===Z&&(k.x>R.x||k.x===R.x&&d(R,k)))&&(R=k,Z=te)),k=k.next;while(k!==O);return R}function d(q,_){return b(q.prev,q,_.prev)<0&&b(_.next,q,q.next)<0}function f(q,_,k,S){var V=q;do V.z===0&&(V.z=g(V.x,V.y,_,k,S)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==q);V.prevZ.nextZ=null,V.prevZ=null,A(V)}function A(q){var _,k,S,V,T,R,I,O,D=1;do{for(k=q,q=null,T=null,R=0;k;){for(R++,S=k,I=0,_=0;_<D&&(I++,S=S.nextZ,!!S);_++);for(O=D;I>0||O>0&&S;)I!==0&&(O===0||!S||k.z<=S.z)?(V=k,k=k.nextZ,I--):(V=S,S=S.nextZ,O--),T?T.nextZ=V:q=V,V.prevZ=T,T=V;k=S}T.nextZ=null,D*=2}while(R>1);return q}function g(q,_,k,S,V){return q=(q-k)*V|0,_=(_-S)*V|0,q=(q|q<<8)&16711935,q=(q|q<<4)&252645135,q=(q|q<<2)&858993459,q=(q|q<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,q|_<<1}function m(q){var _=q,k=q;do(_.x<k.x||_.x===k.x&&_.y<k.y)&&(k=_),_=_.next;while(_!==q);return k}function y(q,_,k,S,V,T,R,I){return(V-R)*(_-I)>=(q-R)*(T-I)&&(q-R)*(S-I)>=(k-R)*(_-I)&&(k-R)*(T-I)>=(V-R)*(S-I)}function x(q,_){return q.next.i!==_.i&&q.prev.i!==_.i&&!B(q,_)&&(j(q,_)&&j(_,q)&&M(q,_)&&(b(q.prev,q,_.prev)||b(q,_.prev,_))||w(q,_)&&b(q.prev,q,q.next)>0&&b(_.prev,_,_.next)>0)}function b(q,_,k){return(_.y-q.y)*(k.x-_.x)-(_.x-q.x)*(k.y-_.y)}function w(q,_){return q.x===_.x&&q.y===_.y}function P(q,_,k,S){var V=E(b(q,_,k)),T=E(b(q,_,S)),R=E(b(k,S,q)),I=E(b(k,S,_));return!!(V!==T&&R!==I||V===0&&C(q,k,_)||T===0&&C(q,S,_)||R===0&&C(k,q,S)||I===0&&C(k,_,S))}function C(q,_,k){return _.x<=Math.max(q.x,k.x)&&_.x>=Math.min(q.x,k.x)&&_.y<=Math.max(q.y,k.y)&&_.y>=Math.min(q.y,k.y)}function E(q){return q>0?1:q<0?-1:0}function B(q,_){var k=q;do{if(k.i!==q.i&&k.next.i!==q.i&&k.i!==_.i&&k.next.i!==_.i&&P(k,k.next,q,_))return!0;k=k.next}while(k!==q);return!1}function j(q,_){return b(q.prev,q,q.next)<0?b(q,_,q.next)>=0&&b(q,q.prev,_)>=0:b(q,_,q.prev)<0||b(q,q.next,_)<0}function M(q,_){var k=q,S=!1,V=(q.x+_.x)/2,T=(q.y+_.y)/2;do k.y>T!=k.next.y>T&&k.next.y!==k.y&&V<(k.next.x-k.x)*(T-k.y)/(k.next.y-k.y)+k.x&&(S=!S),k=k.next;while(k!==q);return S}function z(q,_){var k=new L(q.i,q.x,q.y),S=new L(_.i,_.x,_.y),V=q.next,T=_.prev;return q.next=_,_.prev=q,k.next=V,V.prev=k,S.next=k,k.prev=S,T.next=S,S.prev=T,S}function G(q,_,k,S){var V=new L(q,_,k);return S?(V.next=S.next,V.prev=S,S.next.prev=V,S.next=V):(V.prev=V,V.next=V),V}function F(q){q.next.prev=q.prev,q.prev.next=q.next,q.prevZ&&(q.prevZ.nextZ=q.nextZ),q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function L(q,_,k){this.i=q,this.x=_,this.y=k,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(q,_,k,S){var V=_&&_.length,T=V?_[0]*k:q.length,R=Math.abs(Q(q,0,T,k));if(V)for(var I=0,O=_.length;I<O;I++){var D=_[I]*k,ee=I<O-1?_[I+1]*k:q.length;R-=Math.abs(Q(q,D,ee,k))}var Z=0;for(I=0;I<S.length;I+=3){var te=S[I]*k,ye=S[I+1]*k,ne=S[I+2]*k;Z+=Math.abs((q[te]-q[ne])*(q[ye+1]-q[te+1])-(q[te]-q[ye])*(q[ne+1]-q[te+1]))}return R===0&&Z===0?0:Math.abs((Z-R)/R)};function Q(q,_,k,S){for(var V=0,T=_,R=k-S;T<k;T+=S)V+=(q[R]-q[T])*(q[T+1]+q[R+1]),R=T;return V}return t.flatten=function(q){for(var _=q[0][0].length,k={vertices:[],holes:[],dimensions:_},S=0,V=0;V<q.length;V++){for(var T=0;T<q[V].length;T++)for(var R=0;R<_;R++)k.vertices.push(q[V][T][R]);V>0&&(S+=q[V-1].length,k.holes.push(S))}return k},Ki.exports}var ES=PS();const TS=Qe(ES);class xx extends cr{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Te(it,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Te(it,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Te(it,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Te(it,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Te(it,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Ep=[{offset:0,color:"white"},{offset:1,color:"black"}],kh=class lu{constructor(...e){this.uid=Me("fillGradient"),this.type="linear",this.colorStops=[];let r=RS(e);r={...r.type==="radial"?lu.defaultRadialOptions:lu.defaultLinearOptions,...Oy(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:et.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Ep,r=this._textureSize,{canvas:s,context:n}=Rp(r,1),i=n.createLinearGradient(0,0,this._textureSize,0);Tp(i,e),n.fillStyle=i,n.fillRect(0,0,r,1),this.texture=new Ae({source:new ps({resource:s})});const{x:o,y:a}=this.start,{x:l,y:c}=this.end,u=new me,h=l-o,d=c-a,f=Math.sqrt(h*h+d*d),A=Math.atan2(d,h);u.scale(f/r,1),u.rotate(A),u.translate(o,a),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Ep,r=this._textureSize,{canvas:s,context:n}=Rp(r,r),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,d=l-u,f=r/(u*2),A=(i-h)*f,g=(o-d)*f,m=n.createRadialGradient(A,g,c*f,(a-h)*f,(l-d)*f,u*f);Tp(m,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,r,r),n.fillStyle=m,n.translate(A,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-A,-g),n.fillRect(0,0,r,r),this.texture=new Ae({source:new ps({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const y=new me;y.scale(1/f,1/f),y.translate(h,d),this.textureSpace==="local"&&y.scale(r,r),this.transform=y}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};kh.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};kh.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let Br=kh;function Tp(t,e){for(let r=0;r<e.length;r++){const s=e[r];t.addColorStop(s.offset,s.color)}}function Rp(t,e){const r=Le.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}function RS(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(Te("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??Br.defaultLinearOptions.textureSize}),e}const Mp={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ha{constructor(e,r){this.uid=Me("fillPattern"),this.transform=new me,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=Mp[r].addressModeU,e.source.style.addressModeV=Mp[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Fl,Ip;function MS(){if(Ip)return Fl;Ip=1,Fl=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(s);return o?o.map(Number):[]}return Fl}var IS=MS();const jS=Qe(IS);function BS(t,e){const r=jS(t),s=[];let n=null,i=0,o=0;for(let a=0;a<r.length;a++){const l=r[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),s.length>0&&(n=s.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:_e(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:o},s.push(n))}return e}class Sh{constructor(e=0,r=0,s=0){this.type="circle",this.x=e,this.y=r,this.radius=s}clone(){return new Sh(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-e,i=this.y-r;return n*=n,i*=i,n+i<=s}strokeContains(e,r,s,n=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-r,a=this.radius,l=(1-n)*s,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(s-l)}getBounds(e){return e||(e=new Re),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ch{constructor(e=0,r=0,s=0,n=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=s,this.halfHeight=n}clone(){return new Ch(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,n=(r-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(e,r,s,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=s*(1-n),l=s-a,c=i-l,u=o-l,h=i+a,d=o+a,f=e-this.x,A=r-this.y,g=f*f/(c*c)+A*A/(u*u),m=f*f/(h*h)+A*A/(d*d);return g>1&&m<=1}getBounds(e){return e||(e=new Re),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function OS(t,e,r,s,n,i){const o=t-r,a=e-s,l=n-r,c=i-s,u=o*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,A;d<0?(f=r,A=s):d>1?(f=n,A=i):(f=r+d*l,A=s+d*c);const g=t-f,m=e-A;return g*g+m*m}let NS,zS;class Un{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const s=[];for(let n=0,i=r.length;n<i;n++)s.push(r[n].x,r[n].y);r=s}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,s=r.length;for(let n=0;n<s;n+=2){const i=r[n],o=r[n+1],a=r[(n+2)%s],l=r[(n+3)%s];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const r=this.getBounds(NS),s=e.getBounds(zS);if(!r.containsRect(s))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),r=new Un(e);return r.closePath=this.closePath,r}contains(e,r){let s=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(s=!s)}return s}strokeContains(e,r,s,n=.5){const i=s*s,o=i*(1-n),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],d=l[u+1],f=l[(u+2)%l.length],A=l[(u+3)%l.length],g=OS(e,r,h,d,f,A),m=Math.sign((f-h)*(r-d)-(A-d)*(e-h));if(g<=(m<0?a:o))return!0}return!1}getBounds(e){e||(e=new Re);const r=this.points;let s=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,l=r.length;a<l;a+=2){const c=r[a],u=r[a+1];s=c<s?c:s,n=c>n?c:n,i=u<i?u:i,o=u>o?u:o}return e.x=s,e.width=n-s,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Xi=(t,e,r,s,n,i,o)=>{const a=t-r,l=e-s,c=Math.sqrt(a*a+l*l);return c>=n-i&&c<=n+o};class Ph{constructor(e=0,r=0,s=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=s,this.height=n,this.radius=i}getBounds(e){return e||(e=new Re),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Ph(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let n=e-(this.x+s),i=r-(this.y+s);const o=s*s;if(n*n+i*i<=o||(n=e-(this.x+this.width-s),n*n+i*i<=o)||(i=r-(this.y+this.height-s),n*n+i*i<=o)||(n=e-(this.x+s),n*n+i*i<=o))return!0}return!1}strokeContains(e,r,s,n=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=s*(1-n),h=s-u,d=i+c,f=o+c,A=a-c*2,g=l-c*2,m=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=m-h&&e<=m+u)&&r>=f&&r<=f+g||(r>=o-u&&r<=o+h||r>=y-h&&r<=y+u)&&e>=d&&e<=d+A?!0:e<d&&r<f&&Xi(e,r,d,f,c,h,u)||e>m-c&&r<f&&Xi(e,r,m-c,f,c,h,u)||e>m-c&&r>y-c&&Xi(e,r,m-c,y-c,c,h,u)||e<d&&r>y-c&&Xi(e,r,d,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const FS=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function LS(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function DS(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=FS.replace(/%forloop%/gi,LS(t));if(e.shaderSource(r,s),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let vs=null;function bx(){if(vs)return vs;const t=dx();return vs=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),vs=DS(vs,t),t.getExtension("WEBGL_lose_context")?.loseContext(),vs}const qx={};function US(t,e){let r=2166136261;for(let s=0;s<e;s++)r^=t[s].uid,r=Math.imul(r,16777619),r>>>=0;return qx[r]||HS(t,e,r)}let Ll=0;function HS(t,e,r){const s={};let n=0;Ll||(Ll=bx());for(let o=0;o<Ll;o++){const a=o<e?t[o]:Ae.EMPTY.source;s[n++]=a.source,s[n++]=a.style}const i=new yo(s);return qx[r]=i,i}class jp{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Bp(t,e){const r=t.byteLength/8|0,s=new Float64Array(t,0,r);new Float64Array(e,0,r).set(s);const i=t.byteLength-r*8;if(i>0){const o=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(o)}}const $S={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var GS=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(GS||{});function Op(t,e){return e.alphaMode==="no-premultiply-alpha"&&$S[t]||t}class WS{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class YS{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new WS,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const wx=[];let cu=0;function Np(){return cu>0?wx[--cu]:new YS}function zp(t){wx[cu++]=t}let kn=0;const vx=class xo{constructor(e={}){this.uid=Me("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],xo.defaultOptions.maxTextures=xo.defaultOptions.maxTextures??bx(),e={...xo.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:s,indicesInitialSize:n}=e;this.attributeBuffer=new jp(s*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)zp(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const s=e._batch.textures.ids[r._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let s=Np(),n=s.textures;n.clear();const i=r[this.elementStart];let o=Op(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const A=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=r[g];r[g]=null;const x=m.texture._source,b=Op(m.blendMode,x),w=o!==b||a!==m.topology;if(x._batchTick===kn&&!w){m._textureId=x._textureBindLocation,h+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,c,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,c,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=s;continue}x._batchTick=kn,(n.count>=A||w)&&(this._finishBatch(s,d,h-d,n,o,a,e,f),f="renderBatch",d=h,o=b,a=m.topology,s=Np(),n=s.textures,n.clear(),++kn),m._textureId=x._textureBindLocation=n.count,n.ids[x.uid]=n.count,n.textures[n.count++]=x,m._batch=s,h+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,c,m._attributeStart,m._textureId),this.packQuadIndex(u,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,c,m._attributeStart,m._textureId),this.packIndex(m,u,m._indexStart,m._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(s,d,h-d,n,o,a,e,f),d=h,++kn),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=h}_finishBatch(e,r,s,n,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=o,e.start=r,e.size=s,++kn,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),s=new jp(r);Bp(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const r=this.indexBuffer;let s=Math.max(e,r.length*1.5);s+=s%2;const n=s>65535?new Uint32Array(s):new Uint16Array(s);if(n.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)n[i]=r[i];else Bp(r.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,r,s){e[r]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+3]=s+0,e[r+4]=s+2,e[r+5]=s+3}packIndex(e,r,s,n){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)r[s++]=n+i[c+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)zp(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};vx.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let KS=vx;var yt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(yt||{});let Jn=class extends cr{constructor(e){let{data:r,size:s}=e;const{usage:n,label:i,shrinkToFit:o}=e;super(),this.uid=Me("buffer"),this._resourceType="buffer",this._resourceId=Me("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,s??(s=r?.byteLength);const a=!!r;this.descriptor={size:s,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&yt.STATIC)}set static(e){e?this.descriptor.usage|=yt.STATIC:this.descriptor.usage&=~yt.STATIC}setDataWithSize(e,r,s){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Me("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Vx(t,e){if(!(t instanceof Jn)){let r=e?yt.INDEX:yt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=yt.INDEX|yt.COPY_DST):(t=new Float32Array(t),r=yt.VERTEX|yt.COPY_DST)),t=new Jn({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function XS(t,e,r){const s=t.getAttribute(e);if(!s)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const n=s.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(s.offset||0)/c,h=(s.stride||2*4)/c;for(let d=u;d<n.length;d+=h){const f=n[d],A=n[d+1];f>a&&(a=f),A>l&&(l=A),f<i&&(i=f),A<o&&(o=A)}return r.minX=i,r.minY=o,r.maxX=a,r.maxY=l,r}function QS(t){return(t instanceof Jn||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Vx(t.buffer,!1),t}class ZS extends cr{constructor(e={}){super(),this.uid=Me("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Qt,this._boundsDirty=!0;const{attributes:r,indexBuffer:s,topology:n}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const s=QS(r);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=Vx(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,XS(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const JS=new Float32Array(1),e1=new Uint32Array(1);class t1 extends ZS{constructor(){const r=new Jn({data:JS,label:"attribute-batch-buffer",usage:yt.VERTEX|yt.COPY_DST,shrinkToFit:!1}),s=new Jn({data:e1,label:"index-batch-buffer",usage:yt.INDEX|yt.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:n,offset:0},aUV:{buffer:r,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:r,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:s})}}function Fp(t,e,r){if(t)for(const s in t){const n=s.toLocaleLowerCase(),i=e[n];if(i){let o=t[s];s==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(o)}else _e(`${s} placement hook does not exist in shader`)}}const r1=/\{\{(.*?)\}\}/g;function Lp(t){const e={};return(t.match(r1)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function Dp(t,e){let r;const s=/@in\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function Up(t,e,r=!1){const s=[];Dp(e,s),t.forEach(a=>{a.header&&Dp(a.header,s)});const n=s;r&&n.sort();const i=n.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Hp(t,e){let r;const s=/@out\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function s1(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function n1(t){const e=/@.*?\s+/g;return t.replace(e,"")}function i1(t,e){const r=[];Hp(e,r),t.forEach(l=>{l.header&&Hp(l.header,r)});let s=0;const n=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${n1(l)};`).join(`
`),o=`return VSOutput(
            ${r.sort().map(l=>` ${s1(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function $p(t,e){let r=t;for(const s in e){const n=e[s];n.join(`
`).length?r=r.replace(`{{${s}}}`,`//-----${s} START-----//
${n.join(`
`)}
//----${s} FINISH----//`):r=r.replace(`{{${s}}}`,"")}return r}const Rr=Object.create(null),Dl=new Map;let o1=0;function a1({template:t,bits:e}){const r=_x(t,e);if(Rr[r])return Rr[r];const{vertex:s,fragment:n}=c1(t,e);return Rr[r]=kx(s,n,e),Rr[r]}function l1({template:t,bits:e}){const r=_x(t,e);return Rr[r]||(Rr[r]=kx(t.vertex,t.fragment,e)),Rr[r]}function c1(t,e){const r=e.map(o=>o.vertex).filter(o=>!!o),s=e.map(o=>o.fragment).filter(o=>!!o);let n=Up(r,t.vertex,!0);n=i1(r,n);const i=Up(s,t.fragment,!0);return{vertex:n,fragment:i}}function _x(t,e){return e.map(r=>(Dl.has(r)||Dl.set(r,o1++),Dl.get(r))).sort((r,s)=>r-s).join("-")+t.vertex+t.fragment}function kx(t,e,r){const s=Lp(t),n=Lp(e);return r.forEach(i=>{Fp(i.vertex,s,i.name),Fp(i.fragment,n,i.name)}),{vertex:$p(t,s),fragment:$p(e,n)}}const u1=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,h1=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,d1=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,f1=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,p1={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},A1={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function m1({bits:t,name:e}){const r=a1({template:{fragment:h1,vertex:u1},bits:[p1,...t]});return ua.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function g1({bits:t,name:e}){return new px({name:e,...l1({template:{vertex:d1,fragment:f1},bits:[A1,...t]})})}const y1={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},x1={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Ul={};function b1(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${r++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function q1(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function w1(t){return Ul[t]||(Ul[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${b1(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${q1(t)}
            `}}),Ul[t]}const Hl={};function v1(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function V1(t){return Hl[t]||(Hl[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${v1(t)}
            `}}),Hl[t]}const _1={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},k1={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Gp={};function S1(t){let e=Gp[t];if(e)return e;const r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=s;return e=Gp[t]=new yx({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class C1 extends _h{constructor(e){const r=g1({name:"batch",bits:[x1,V1(e),k1]}),s=m1({name:"batch",bits:[y1,w1(e),_1]});super({glProgram:r,gpuProgram:s,resources:{batchSamplers:S1(e)}})}}let Wp=null;const Sx=class Cx extends KS{constructor(){super(...arguments),this.geometry=new t1,this.shader=Wp||(Wp=new C1(this.maxTextures)),this.name=Cx.extension.name,this.vertexSize=6}packAttributes(e,r,s,n,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,{positions:A,uvs:g}=e,m=e.color,y=e.attributeOffset,x=y+e.attributeSize;for(let b=y;b<x;b++){const w=b*2,P=A[w],C=A[w+1];r[n++]=l*P+u*C+d,r[n++]=h*C+c*P+f,r[n++]=g[w],r[n++]=g[w+1],s[n++]=m,s[n++]=o}}packQuadAttributes(e,r,s,n,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,A=e.bounds,g=A.maxX,m=A.minX,y=A.maxY,x=A.minY,b=o.uvs,w=e.color,P=i<<16|e.roundPixels&65535;r[n+0]=l*m+u*x+d,r[n+1]=h*x+c*m+f,r[n+2]=b.x0,r[n+3]=b.y0,s[n+4]=w,s[n+5]=P,r[n+6]=l*g+u*x+d,r[n+7]=h*x+c*g+f,r[n+8]=b.x1,r[n+9]=b.y1,s[n+10]=w,s[n+11]=P,r[n+12]=l*g+u*y+d,r[n+13]=h*y+c*g+f,r[n+14]=b.x2,r[n+15]=b.y2,s[n+16]=w,s[n+17]=P,r[n+18]=l*m+u*y+d,r[n+19]=h*y+c*m+f,r[n+20]=b.x3,r[n+21]=b.y3,s[n+22]=w,s[n+23]=P}};Sx.extension={type:[J.Batcher],name:"default"};let P1=Sx;function E1(t,e,r,s,n,i,o,a=null){let l=0;r*=e,n*=i;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,A=a.ty;for(;l<o;){const g=t[r],m=t[r+1];s[n]=c*g+h*m+f,s[n+1]=u*g+d*m+A,n+=i,r+=e,l++}}function T1(t,e,r,s){let n=0;for(e*=r;n<s;)t[e]=0,t[e+1]=0,e+=r,n++}function Px(t,e,r,s,n){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),s||(s=2),n||(n=t.length/s-r);let h=r*s;for(let d=0;d<n;d++){const f=t[h],A=t[h+1];t[h]=i*f+a*A+c,t[h+1]=o*f+l*A+u,h+=s}}const R1=new me;class Ex{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?Wy(r,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||R1}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const ei={extension:{type:J.ShapeBuilder,name:"circle"},build(t,e){let r,s,n,i,o,a;if(t.type==="circle"){const w=t;r=w.x,s=w.y,o=a=w.radius,n=i=0}else if(t.type==="ellipse"){const w=t;r=w.x,s=w.y,o=w.halfWidth,a=w.halfHeight,n=i=0}else{const w=t,P=w.width/2,C=w.height/2;r=w.x+P,s=w.y+C,o=a=Math.max(0,Math.min(w.radius,Math.min(P,C))),n=P-o,i=C-a}if(!(o>=0&&a>=0&&n>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+n,e[1]=e[3]=s+i,e[2]=e[4]=r-n,e[5]=e[7]=s-i,e;let u=0,h=l*4+(n?2:0)+2,d=h,f=c,A=n+o,g=i,m=r+A,y=r-A,x=s+g;if(e[u++]=m,e[u++]=x,e[--h]=x,e[--h]=y,i){const w=s-g;e[d++]=y,e[d++]=w,e[--f]=w,e[--f]=m}for(let w=1;w<l;w++){const P=Math.PI/2*(w/l),C=n+Math.cos(P)*o,E=i+Math.sin(P)*a,B=r+C,j=r-C,M=s+E,z=s-E;e[u++]=B,e[u++]=M,e[--h]=M,e[--h]=j,e[d++]=j,e[d++]=z,e[--f]=z,e[--f]=B}A=n,g=i+a,m=r+A,y=r-A,x=s+g;const b=s-g;return e[u++]=m,e[u++]=x,e[--f]=b,e[--f]=m,n&&(e[u++]=y,e[u++]=x,e[--f]=b,e[--f]=y),e},triangulate(t,e,r,s,n,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=s;e[l*r]=o,e[l*r+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},M1={...ei,extension:{...ei.extension,name:"ellipse"}},I1={...ei,extension:{...ei.extension,name:"roundedRectangle"}},Tx=1e-4,Yp=1e-4;function j1(t){const e=t.length;if(e<6)return 1;let r=0;for(let s=0,n=t[e-2],i=t[e-1];s<e;s+=2){const o=t[s],a=t[s+1];r+=(o-n)*(a+i),n=o,i=a}return r<0?-1:1}function Kp(t,e,r,s,n,i,o,a){const l=t-r*n,c=e-s*n,u=t+r*i,h=e+s*i;let d,f;o?(d=s,f=-r):(d=-s,f=r);const A=l+d,g=c+f,m=u+d,y=h+f;return a.push(A,g),a.push(m,y),2}function Wr(t,e,r,s,n,i,o,a){const l=r-t,c=s-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,A=Math.abs(f),g=Math.sqrt(l*l+c*c),m=(15*A*Math.sqrt(g)/Math.PI>>0)+1,y=f/m;if(d+=y,a){o.push(t,e),o.push(r,s);for(let x=1,b=d;x<m;x++,b+=y)o.push(t,e),o.push(t+Math.sin(b)*g,e+Math.cos(b)*g);o.push(t,e),o.push(n,i)}else{o.push(r,s),o.push(t,e);for(let x=1,b=d;x<m;x++,b+=y)o.push(t+Math.sin(b)*g,e+Math.cos(b)*g),o.push(t,e);o.push(n,i),o.push(t,e)}return m*2}function B1(t,e,r,s,n,i){const o=Tx;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let S=j1(t);l=(l-.5)*S+.5}const c=new at(t[0],t[1]),u=new at(t[t.length-2],t[t.length-1]),h=s,d=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),d&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const S=(c.x+u.x)*.5,V=(u.y+c.y)*.5;t.unshift(S,V),t.push(S,V)}const f=n,A=t.length/2;let g=t.length;const m=f.length/2,y=a.width/2,x=y*y,b=a.miterLimit*a.miterLimit;let w=t[0],P=t[1],C=t[2],E=t[3],B=0,j=0,M=-(P-E),z=w-C,G=0,F=0,L=Math.sqrt(M*M+z*z);M/=L,z/=L,M*=y,z*=y;const Q=l,q=(1-Q)*2,_=Q*2;h||(a.cap==="round"?g+=Wr(w-M*(q-_)*.5,P-z*(q-_)*.5,w-M*q,P-z*q,w+M*_,P+z*_,f,!0)+2:a.cap==="square"&&(g+=Kp(w,P,M,z,q,_,!0,f))),f.push(w-M*q,P-z*q),f.push(w+M*_,P+z*_);for(let S=1;S<A-1;++S){w=t[(S-1)*2],P=t[(S-1)*2+1],C=t[S*2],E=t[S*2+1],B=t[(S+1)*2],j=t[(S+1)*2+1],M=-(P-E),z=w-C,L=Math.sqrt(M*M+z*z),M/=L,z/=L,M*=y,z*=y,G=-(E-j),F=C-B,L=Math.sqrt(G*G+F*F),G/=L,F/=L,G*=y,F*=y;const V=C-w,T=P-E,R=C-B,I=j-E,O=V*R+T*I,D=T*R-I*V,ee=D<0;if(Math.abs(D)<.001*Math.abs(O)){f.push(C-M*q,E-z*q),f.push(C+M*_,E+z*_),O>=0&&(a.join==="round"?g+=Wr(C,E,C-M*q,E-z*q,C-G*q,E-F*q,f,!1)+4:g+=2,f.push(C-G*_,E-F*_),f.push(C+G*q,E+F*q));continue}const Z=(-M+w)*(-z+E)-(-M+C)*(-z+P),te=(-G+B)*(-F+E)-(-G+C)*(-F+j),ye=(V*te-R*Z)/D,ne=(I*Z-T*te)/D,Ht=(ye-C)*(ye-C)+(ne-E)*(ne-E),lt=C+(ye-C)*q,ct=E+(ne-E)*q,sr=C-(ye-C)*_,oe=E-(ne-E)*_,xe=Math.min(V*V+T*T,R*R+I*I),ud=ee?q:_,Rq=xe+ud*ud*x;Ht<=Rq?a.join==="bevel"||Ht/x>b?(ee?(f.push(lt,ct),f.push(C+M*_,E+z*_),f.push(lt,ct),f.push(C+G*_,E+F*_)):(f.push(C-M*q,E-z*q),f.push(sr,oe),f.push(C-G*q,E-F*q),f.push(sr,oe)),g+=2):a.join==="round"?ee?(f.push(lt,ct),f.push(C+M*_,E+z*_),g+=Wr(C,E,C+M*_,E+z*_,C+G*_,E+F*_,f,!0)+4,f.push(lt,ct),f.push(C+G*_,E+F*_)):(f.push(C-M*q,E-z*q),f.push(sr,oe),g+=Wr(C,E,C-M*q,E-z*q,C-G*q,E-F*q,f,!1)+4,f.push(C-G*q,E-F*q),f.push(sr,oe)):(f.push(lt,ct),f.push(sr,oe)):(f.push(C-M*q,E-z*q),f.push(C+M*_,E+z*_),a.join==="round"?ee?g+=Wr(C,E,C+M*_,E+z*_,C+G*_,E+F*_,f,!0)+2:g+=Wr(C,E,C-M*q,E-z*q,C-G*q,E-F*q,f,!1)+2:a.join==="miter"&&Ht/x<=b&&(ee?(f.push(sr,oe),f.push(sr,oe)):(f.push(lt,ct),f.push(lt,ct)),g+=2),f.push(C-G*q,E-F*q),f.push(C+G*_,E+F*_),g+=2)}w=t[(A-2)*2],P=t[(A-2)*2+1],C=t[(A-1)*2],E=t[(A-1)*2+1],M=-(P-E),z=w-C,L=Math.sqrt(M*M+z*z),M/=L,z/=L,M*=y,z*=y,f.push(C-M*q,E-z*q),f.push(C+M*_,E+z*_),h||(a.cap==="round"?g+=Wr(C-M*(q-_)*.5,E-z*(q-_)*.5,C-M*q,E-z*q,C+M*_,E+z*_,f,!1)+2:a.cap==="square"&&(g+=Kp(C,E,M,z,q,_,!1,f)));const k=Yp*Yp;for(let S=m;S<g+m-2;++S)w=f[S*2],P=f[S*2+1],C=f[(S+1)*2],E=f[(S+1)*2+1],B=f[(S+2)*2],j=f[(S+2)*2+1],!(Math.abs(w*(E-j)+C*(j-P)+B*(P-E))<k)&&i.push(S,S+1,S+2)}function O1(t,e,r,s){const n=Tx;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<n&&Math.abs(o-l)<n,u=r,h=t.length/2,d=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)s.push(d+f,d+f+1);c&&s.push(d+h-1,d)}function Rx(t,e,r,s,n,i,o){const a=TS(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+n,i[o++]=a[c+1]+n,i[o++]=a[c+2]+n;let l=n*s;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=s}const N1=[],z1={extension:{type:J.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,s,n,i){Rx(t,N1,e,r,s,n,i)}},F1={extension:{type:J.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,s=r.x,n=r.y,i=r.width,o=r.height;return i>=0&&o>=0&&(e[0]=s,e[1]=n,e[2]=s+i,e[3]=n,e[4]=s+i,e[5]=n+o,e[6]=s,e[7]=n+o),e},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[6],e[s+o+1]=t[7],o+=r,e[s+o]=t[4],e[s+o+1]=t[5],o+=r;const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},L1={extension:{type:J.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[4],e[s+o+1]=t[5];const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},D1=new me,U1=new Re;function H1(t,e,r,s){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(U1);n.translate(-i.x,-i.y),n.scale(1/i.width,1/i.height)}else{n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return s&&n.append(D1.copyFrom(s).invert()),n}const da={};qt.handleByMap(J.ShapeBuilder,da);qt.add(F1,z1,L1,ei,M1,I1);const $1=new Re,G1=new me;function W1(t,e){const{geometryData:r,batches:s}=e;s.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")Y1(i.data,s,r);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&Xp(c.shapePath,l,!0,s,r),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Xp(a,l,o,s,r)}}}function Y1(t,e,r){const{vertices:s,uvs:n,indices:i}=r,o=i.length,a=s.length/2,l=[],c=da.rectangle,u=$1,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const d=t.transform;c.build(u,l),d&&Px(l,d),c.triangulate(l,s,2,a,i,o);const f=h.uvs;n.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const A=xr.get(Ex);A.indexOffset=o,A.indexSize=i.length-o,A.attributeOffset=a,A.attributeSize=s.length/2-a,A.baseColor=t.style,A.alpha=t.alpha,A.texture=h,A.geometryData=r,e.push(A)}function Xp(t,e,r,s,n){const{vertices:i,uvs:o,indices:a}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=a.length,d=i.length/2,f=[],A=da[l.type];let g="triangle-list";if(A.build(l,f),c&&Px(f,c),r){const b=l.closePath??!0,w=e;w.pixelLine?(O1(f,b,i,a),g="line-list"):B1(f,w,!1,b,i,a)}else if(u){const b=[],w=f.slice();K1(u).forEach(C=>{b.push(w.length/2),w.push(...C)}),Rx(w,b,i,2,d,a,h)}else A.triangulate(f,i,2,d,a,h);const m=o.length/2,y=e.texture;if(y!==Ae.WHITE){const b=H1(G1,e,l,c);E1(i,2,d,o,m,2,i.length/2-d,b)}else T1(o,m,2,i.length/2-d);const x=xr.get(Ex);x.indexOffset=h,x.indexSize=a.length-h,x.attributeOffset=d,x.attributeSize=i.length/2-d,x.baseColor=e.color,x.alpha=e.alpha,x.texture=y,x.geometryData=n,x.topology=g,s.push(x)})}function K1(t){const e=[];for(let r=0;r<t.length;r++){const s=t[r].shape,n=[];da[s.type].build(s,n),e.push(n)}return e}class X1{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Q1{constructor(){this.batcher=new P1,this.instructions=new Qy}init(){this.instructions.reset()}get geometry(){return Te(mk,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Eh=class uu{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){uu.defaultOptions.bezierSmoothness=e?.bezierSmoothness??uu.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),W1(e,r);const s=e.batchMode;e.customShader||s==="no-batch"?r.isBatchable=!1:s==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=xr.get(Q1),{batches:s,geometryData:n}=this._gpuContextHash[e.uid],i=n.vertices.length,o=n.indices.length;for(let u=0;u<s.length;u++)s[u].applyTransform=!1;const a=r.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let u=0;u<s.length;u++){const h=s[u];a.add(h)}a.finish(r.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=US(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new X1;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(xr.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(s=>{xr.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};Eh.extension={type:[J.WebGLSystem,J.WebGPUSystem,J.CanvasSystem],name:"graphicsContext"};Eh.defaultOptions={bezierSmoothness:.5};let Mx=Eh;const Z1=8,Qi=11920929e-14,J1=1;function Ix(t,e,r,s,n,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??Mx.defaultOptions.bezierSmoothness));let d=(J1-h)/1;return d*=d,eC(e,r,s,n,i,o,a,l,t,d),t}function eC(t,e,r,s,n,i,o,a,l,c){hu(t,e,r,s,n,i,o,a,l,c,0),l.push(o,a)}function hu(t,e,r,s,n,i,o,a,l,c,u){if(u>Z1)return;const h=(t+r)/2,d=(e+s)/2,f=(r+n)/2,A=(s+i)/2,g=(n+o)/2,m=(i+a)/2,y=(h+f)/2,x=(d+A)/2,b=(f+g)/2,w=(A+m)/2,P=(y+b)/2,C=(x+w)/2;if(u>0){let E=o-t,B=a-e;const j=Math.abs((r-o)*B-(s-a)*E),M=Math.abs((n-o)*B-(i-a)*E);if(j>Qi&&M>Qi){if((j+M)*(j+M)<=c*(E*E+B*B)){l.push(P,C);return}}else if(j>Qi){if(j*j<=c*(E*E+B*B)){l.push(P,C);return}}else if(M>Qi){if(M*M<=c*(E*E+B*B)){l.push(P,C);return}}else if(E=P-(t+o)/2,B=C-(e+a)/2,E*E+B*B<=c){l.push(P,C);return}}hu(t,e,h,d,y,x,P,C,l,c,u+1),hu(P,C,b,w,g,m,o,a,l,c,u+1)}const tC=8,rC=11920929e-14,sC=1;function nC(t,e,r,s,n,i,o,a){const c=Math.min(.99,Math.max(0,a??Mx.defaultOptions.bezierSmoothness));let u=(sC-c)/1;return u*=u,iC(e,r,s,n,i,o,t,u),t}function iC(t,e,r,s,n,i,o,a){du(o,t,e,r,s,n,i,a,0),o.push(n,i)}function du(t,e,r,s,n,i,o,a,l){if(l>tC)return;const c=(e+s)/2,u=(r+n)/2,h=(s+i)/2,d=(n+o)/2,f=(c+h)/2,A=(u+d)/2;let g=i-e,m=o-r;const y=Math.abs((s-i)*m-(n-o)*g);if(y>rC){if(y*y<=a*(g*g+m*m)){t.push(f,A);return}}else if(g=f-(e+i)/2,m=A-(r+o)/2,g*g+m*m<=a){t.push(f,A);return}du(t,e,r,c,u,f,A,a,l+1),du(t,f,A,h,d,i,o,a,l+1)}function jx(t,e,r,s,n,i,o,a){let l=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=n;c*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),A=e+d*s,g=r+f*s;t.push(A,g),u+=c}}function oC(t,e,r,s,n,i){const o=t[t.length-2],l=t[t.length-1]-r,c=o-e,u=n-r,h=s-e,d=Math.abs(l*h-c*u);if(d<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const f=l*l+c*c,A=u*u+h*h,g=l*u+c*h,m=i*Math.sqrt(f)/d,y=i*Math.sqrt(A)/d,x=m*g/f,b=y*g/A,w=m*h+y*c,P=m*u+y*l,C=c*(y+x),E=l*(y+x),B=h*(m+b),j=u*(m+b),M=Math.atan2(E-P,C-w),z=Math.atan2(j-P,B-w);jx(t,w+e,P+r,i,M,z,c*u>h*l)}const Hn=Math.PI*2,$l={centerX:0,centerY:0,ang1:0,ang2:0},Gl=({x:t,y:e},r,s,n,i,o,a,l)=>{t*=r,e*=s;const c=n*t-i*e,u=i*t+n*e;return l.x=c+o,l.y=u+a,l};function aC(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:r,n=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:n-i*s,y:i+n*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Qp=(t,e,r,s)=>{const n=t*s-e*r<0?-1:1;let i=t*r+e*s;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},lC=(t,e,r,s,n,i,o,a,l,c,u,h,d)=>{const f=Math.pow(n,2),A=Math.pow(i,2),g=Math.pow(u,2),m=Math.pow(h,2);let y=f*A-f*m-A*g;y<0&&(y=0),y/=f*m+A*g,y=Math.sqrt(y)*(o===a?-1:1);const x=y*n/i*h,b=y*-i/n*u,w=c*x-l*b+(t+r)/2,P=l*x+c*b+(e+s)/2,C=(u-x)/n,E=(h-b)/i,B=(-u-x)/n,j=(-h-b)/i,M=Qp(1,0,C,E);let z=Qp(C,E,B,j);a===0&&z>0&&(z-=Hn),a===1&&z<0&&(z+=Hn),d.centerX=w,d.centerY=P,d.ang1=M,d.ang2=z};function cC(t,e,r,s,n,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*Hn/360),h=Math.cos(a*Hn/360),d=h*(e-s)/2+u*(r-n)/2,f=-u*(e-s)/2+h*(r-n)/2;if(d===0&&f===0)return;i=Math.abs(i),o=Math.abs(o);const A=Math.pow(d,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(o,2);A>1&&(i*=Math.sqrt(A),o*=Math.sqrt(A)),lC(e,r,s,n,i,o,l,c,u,h,d,f,$l);let{ang1:g,ang2:m}=$l;const{centerX:y,centerY:x}=$l;let b=Math.abs(m)/(Hn/4);Math.abs(1-b)<1e-7&&(b=1);const w=Math.max(Math.ceil(b),1);m/=w;let P=t[t.length-2],C=t[t.length-1];const E={x:0,y:0};for(let B=0;B<w;B++){const j=aC(g,m),{x:M,y:z}=Gl(j[0],i,o,h,u,y,x,E),{x:G,y:F}=Gl(j[1],i,o,h,u,y,x,E),{x:L,y:Q}=Gl(j[2],i,o,h,u,y,x,E);Ix(t,P,C,M,z,G,F,L,Q),P=L,C=Q,g+=m}}function uC(t,e,r){const s=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},n=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??r;if(l<=0){n(o,a),i=a;continue}const c=e[(o+1)%e.length],u=s(a,i),h=s(a,c);if(u.len<1e-4||h.len<1e-4){n(o,a),i=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,A=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,A=!0):d>0&&(f=-1,A=!0);const g=d/2;let m,y=Math.abs(Math.cos(g)*l/Math.sin(g));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=l;const x=a.x+h.nx*y+-h.ny*m*f,b=a.y+h.ny*y+h.nx*m*f,w=Math.atan2(u.ny,u.nx)+Math.PI/2*f,P=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&t.moveTo(x+Math.cos(w)*m,b+Math.sin(w)*m),t.arc(x,b,m,w,P,A),i=a}}function hC(t,e,r,s){const n=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??r;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],d=n(u,l);let f;if(d<1e-4)f=l;else{const m=Math.min(d/2,c);f=i(l,u,m/d)}const A=n(h,l);let g;if(A<1e-4)g=l;else{const m=Math.min(A/2,c);g=i(l,h,m/A)}a===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,g.x,g.y,s)}}const dC=new Re;class fC{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Qt,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],i=s[s.length-1];return(n!==e||i!==r)&&s.push(e,r),this}arc(e,r,s,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return jx(a,e,r,s,n,i,o),this}arcTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly.points;return oC(o,e,r,s,n,i),this}arcToSvg(e,r,s,n,i,o,a){const l=this._currentPoly.points;return cC(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,r,s,n,i),this}bezierCurveTo(e,r,s,n,i,o,a){this._ensurePoly();const l=this._currentPoly;return Ix(this._currentPoly.points,l.lastX,l.lastY,e,r,s,n,i,o,a),this}quadraticCurveTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly;return nC(this._currentPoly.points,o.lastX,o.lastY,e,r,s,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const s=this.shapePrimitives,n=s.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&s.length-n>1){let i=null;for(let o=n;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,s,n,i){return this.drawShape(new Re(e,r,s,n),i),this}circle(e,r,s,n){return this.drawShape(new Sh(e,r,s),n),this}poly(e,r,s){const n=new Un(e);return n.closePath=r,this.drawShape(n,s),this}regularPoly(e,r,s,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=a-u*l;c.push(e+s*Math.cos(h),r+s*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,r,s,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,r,s,n,o);const l=s*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let d=0;d<n;d++){const f=d*u+c,A=e+s*Math.cos(f),g=r+s*Math.sin(f),m=f+Math.PI+h,y=f-Math.PI-h,x=A+i*Math.cos(m),b=g+i*Math.sin(m),w=A+i*Math.cos(y),P=g+i*Math.sin(y);d===0?this.moveTo(x,b):this.lineTo(x,b),this.quadraticCurveTo(A,g,w,P,a)}return this.closePath()}roundShape(e,r,s=!1,n){return e.length<3?this:(s?hC(this,e,r,n):uC(this,e,r),this.closePath())}filletRect(e,r,s,n,i){if(i===0)return this.rect(e,r,s,n);const o=Math.min(s,n)/2,a=Math.min(o,Math.max(-o,i)),l=e+s,c=r+n,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+s-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,s,n,i,o){if(i<=0)return this.rect(e,r,s,n);const a=Math.min(i,Math.min(s,n)/2),l=e+s,c=r+n,u=[e+a,r,l-a,r,l,r+a,l,c-a,l-a,c,e+a,c,e,c-a,e,r+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,r,s,n,i){return this.drawShape(new Ch(e,r,s,n),i),this}roundRect(e,r,s,n,i,o){return this.drawShape(new Ph(e,r,s,n,i),o),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let s=this._currentPoly;return s&&this.endPoly(),s=new Un,s.points.push(e,r),this._currentPoly=s,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Un,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let s=r.shape.x,n=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,o=s;s=i.a*s+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const s=e.instructions[r];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let s=0;s<r.length;s++){const n=r[s],i=n.shape.getBounds(dC);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class en{constructor(e,r=!1){this.instructions=[],this.uid=Me("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?BS(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new fC(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,s,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(at.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,s,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,s){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(at.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,r,s]}),this._dirty=!0,this}rect(e,r,s,n,i){return this.instructions.push({action:"rect",data:[e,r,s,n,i]}),this._dirty=!0,this}circle(e,r,s,n){return this.instructions.push({action:"circle",data:[e,r,s,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,s,n,i,o,a){i||(i=n/2);const l=-1*Math.PI/2+o,c=s*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?i:n,A=d*u+l;h.push(e+f*Math.cos(A),r+f*Math.sin(A))}return this.poly(h,!0,a),this}clone(e=!1){const r=new en;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];r.instructions.push({action:n.action,data:n.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,s=e.b,n=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,A=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],x=y.data;switch(y.action){case"moveTo":case"lineTo":l=x[0],c=x[1],x[0]=r*l+n*c+o,x[1]=s*l+i*c+a;break;case"bezierCurveTo":u=x[0],h=x[1],d=x[2],f=x[3],l=x[4],c=x[5],x[0]=r*u+n*h+o,x[1]=s*u+i*h+a,x[2]=r*d+n*f+o,x[3]=s*d+i*f+a,x[4]=r*l+n*c+o,x[5]=s*l+i*c+a;break;case"quadraticCurveTo":u=x[0],h=x[1],l=x[2],c=x[3],x[0]=r*u+n*h+o,x[1]=s*u+i*h+a,x[2]=r*l+n*c+o,x[3]=s*l+i*c+a;break;case"arcToSvg":l=x[5],c=x[6],A=x[0],g=x[1],x[0]=r*A+n*g,x[1]=s*A+i*g,x[5]=r*l+n*c+o,x[6]=s*l+i*c+a;break;case"circle":x[4]=Sn(x[3],e);break;case"rect":x[4]=Sn(x[4],e);break;case"ellipse":x[8]=Sn(x[8],e);break;case"roundRect":x[5]=Sn(x[5],e);break;case"addPath":x[0].transform(e);break;case"poly":x[2]=Sn(x[2],e);break;default:_e("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,s=this.instructions[r];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;s=this.instructions[r]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function Sn(t,e){return t?t.prepend(e):e.clone()}function Se(t,e,r){const s=t.getAttribute(e);return s?Number(s):r}function pC(t,e){const r=t.querySelectorAll("defs");for(let s=0;s<r.length;s++){const n=r[s];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=AC(o);break;case"radialgradient":e.defs[o.id]=mC();break}}}}function AC(t){const e=Se(t,"x1",0),r=Se(t,"y1",0),s=Se(t,"x2",1),n=Se(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new Br(e,r,s,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Se(l,"offset",0),u=et.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function mC(t){return _e("[SVG Parser] Radial gradients are not yet supported"),new Br(0,0,1,0)}function Zp(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Jp={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Bx(t,e){const r=t.getAttribute("style"),s={},n={},i={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const o in Jp){const a=t.getAttribute(o);a&&eA(e,i,o,a.trim())}if(r){const o=r.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");Jp[c]&&eA(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?s:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function eA(t,e,r,s){switch(r){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=Zp(s);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=et.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=Zp(s);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=et.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function gC(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const r={context:e,defs:{},path:new en};pC(t,r);const s=t.children,{fillStyle:n,strokeStyle:i}=Bx(t,r);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&Ox(a,r,n,i)}return e}function Ox(t,e,r,s){const n=t.children,{fillStyle:i,strokeStyle:o}=Bx(t,e);i&&r?r={...r,...i}:i&&(r=i),o&&s?s={...s,...o}:o&&(s=o);const a=!r&&!s;a&&(r={color:0});let l,c,u,h,d,f,A,g,m,y,x,b,w,P,C,E,B;switch(t.nodeName.toLowerCase()){case"path":P=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&_e("SVG Evenodd fill rule not supported, your svg may render incorrectly"),C=new en(P,!0),e.context.path(C),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"circle":A=Se(t,"cx",0),g=Se(t,"cy",0),m=Se(t,"r",0),e.context.ellipse(A,g,m,m),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"rect":l=Se(t,"x",0),c=Se(t,"y",0),E=Se(t,"width",0),B=Se(t,"height",0),y=Se(t,"rx",0),x=Se(t,"ry",0),y||x?e.context.roundRect(l,c,E,B,y||x):e.context.rect(l,c,E,B),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"ellipse":A=Se(t,"cx",0),g=Se(t,"cy",0),y=Se(t,"rx",0),x=Se(t,"ry",0),e.context.beginPath(),e.context.ellipse(A,g,y,x),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"line":u=Se(t,"x1",0),h=Se(t,"y1",0),d=Se(t,"x2",0),f=Se(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(d,f),s&&e.context.stroke(s);break;case"polygon":w=t.getAttribute("points"),b=w.match(/\d+/g).map(j=>parseInt(j,10)),e.context.poly(b,!0),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"polyline":w=t.getAttribute("points"),b=w.match(/\d+/g).map(j=>parseInt(j,10)),e.context.poly(b,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{_e(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(r=null);for(let j=0;j<n.length;j++)Ox(n[j],e,r,s)}function yC(t){return et.isColorLike(t)}function tA(t){return t instanceof ha}function rA(t){return t instanceof Br}function xC(t){return t instanceof Ae}function bC(t,e,r){const s=et.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?r.alpha:s.alpha,t.texture=Ae.WHITE,{...r,...t}}function qC(t,e,r){return t.texture=e,{...r,...t}}function sA(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function nA(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function wC(t,e){const r={...e,...t},s=et.shared.setValue(r.color);return r.alpha*=s.alpha,r.color=s.toNumber(),r}function as(t,e){if(t==null)return null;const r={},s=t;return yC(t)?bC(r,t,e):xC(t)?qC(r,t,e):tA(t)?sA(r,t,e):rA(t)?nA(r,t,e):s.fill&&tA(s.fill)?sA(s,s.fill,e):s.fill&&rA(s.fill)?nA(s,s.fill,e):wC(s,e)}function Fo(t,e){const{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...l}=e,c=as(t,l);return c?{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...c}:null}const vC=new at,iA=new me,Th=class ir extends cr{constructor(){super(...arguments),this.uid=Me("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new en,this._transform=new me,this._fillStyle={...ir.defaultFillStyle},this._strokeStyle={...ir.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Qt,this._boundsDirty=!0}clone(){const e=new ir;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=as(e,ir.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Fo(e,ir.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=as(e,ir.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=as(e,ir.defaultStrokeStyle),this}texture(e,r,s,n,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:n||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?et.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new en,this}fill(e,r){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(e!=null&&(r!==void 0&&typeof e=="number"&&(Te(it,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=as(e,ir.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(at.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?r=s.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=Fo(e,ir.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(s);else{r.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,r,s,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,s,n,i,o),this}arcTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}arcToSvg(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,s,n,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*s+l.c*n+l.tx,l.b*s+l.d*n+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,s,n){return this._tick++,this._activePath.ellipse(e,r,s,n,this._transform.clone()),this}circle(e,r,s){return this._tick++,this._activePath.circle(e,r,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*r+s.tx,s.b*e+s.d*r+s.ty),this}moveTo(e,r){this._tick++;const s=this._transform,n=this._activePath.instructions,i=s.a*e+s.c*r+s.tx,o=s.b*e+s.d*r+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}rect(e,r,s,n){return this._tick++,this._activePath.rect(e,r,s,n,this._transform.clone()),this}roundRect(e,r,s,n,i){return this._tick++,this._activePath.roundRect(e,r,s,n,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,s,n,i=0,o){return this._tick++,this._activePath.regularPoly(e,r,s,n,i,o),this}roundPoly(e,r,s,n,i,o){return this._tick++,this._activePath.roundPoly(e,r,s,n,i,o),this}roundShape(e,r,s,n){return this._tick++,this._activePath.roundShape(e,r,s,n),this}filletRect(e,r,s,n,i){return this._tick++,this._activePath.filletRect(e,r,s,n,i),this}chamferRect(e,r,s,n,i,o){return this._tick++,this._activePath.chamferRect(e,r,s,n,i,o),this}star(e,r,s,n,i=0,o=0){return this._tick++,this._activePath.star(e,r,s,n,i,o,this._transform.clone()),this}svg(e){return this._tick++,gC(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,s,n,i,o){return e instanceof me?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,s,n,i,o),this)}transform(e,r,s,n,i,o){return e instanceof me?(this._transform.append(e),this):(iA.set(e,r,s,n,i,o),this._transform.append(iA),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r],n=s.action;if(n==="fill"){const i=s.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=s.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=s.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let s=!1;for(let n=0;n<r.length;n++){const i=r[n],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const d=c[u].transform,f=d?d.applyInverse(e,vC):e;if(i.action==="fill")s=h.contains(f.x,f.y);else{const g=l;s=h.strokeContains(f.x,f.y,g.width,g.alignment)}const A=o.hole;if(A){const g=A.shapePath?.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(f.x,f.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Th.defaultFillStyle={color:16777215,alpha:1,texture:Ae.WHITE,matrix:null,fill:null,textureSpace:"local"};Th.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ae.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let ts=Th;const oA=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function VC(t){const e=[];let r=0;for(let s=0;s<oA.length;s++){const n=`_${oA[s]}`;e[r++]=t[n]}return r=Nx(t._fill,e,r),r=_C(t._stroke,e,r),r=kC(t.dropShadow,e,r),e.join("-")}function Nx(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function _C(t,e,r){return t&&(r=Nx(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function kC(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=et.shared.setValue(t.color).toNumber()),r}const Rh=class Os extends cr{constructor(e={}){super(),SC(e);const r={...Os.defaultTextStyle,...e};for(const s in r){const n=s;this[n]=r[s]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Os.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Os.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...ts.defaultFillStyle,...e},()=>{this._fill=as({...this._originalFill},ts.defaultFillStyle)})),this._fill=as(e===0?"black":e,ts.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...ts.defaultStrokeStyle,...e},()=>{this._stroke=Fo({...this._originalStroke},ts.defaultStrokeStyle)})),this._stroke=Fo(e,ts.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=VC(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=Os.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Os({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(s,n,i)=>(s[n]=i,r?.(n,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(et.isColorLike(e)||e instanceof Br||e instanceof ha)}};Rh.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Rh.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ti=Rh;function SC(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=ti.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){Te(it,"strokeThickness is now a part of stroke");const r=e.stroke;let s={};if(et.isColorLike(r))s.color=r;else if(r instanceof Br||r instanceof ha)s.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))s=r;else throw new Error("Invalid stroke value.");t.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){Te(it,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=ti.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const s=new Br({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),n=e.fillGradientStops.map(i=>et.shared.setValue(i).toNumber());n.forEach((i,o)=>{const a=o/(n.length-1);s.addColorStop(a,i)}),t.fill={fill:s}}}class CC{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const s=Le.get().createCanvas();s.width=e,s.height=r;const n=s.getContext("2d");return{canvas:s,context:n}}getOptimalCanvasAndContext(e,r,s=1){e=Math.ceil(e*s-1e-6),r=Math.ceil(r*s-1e-6),e=Oo(e),r=Oo(r);const n=(e<<17)+(r<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:s,height:n}=r,i=(s<<17)+(n<<1);e.context.clearRect(0,0,s,n),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const aA=new CC,PC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function fu(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let s=r.length-1;s>=0;s--){let n=r[s].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!PC.includes(n)&&(n=`"${n}"`),r[s]=n}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const Wl={willReadFrequently:!0},tr=class W{static get experimentalLetterSpacingSupported(){let e=W._experimentalLetterSpacingSupported;if(e!==void 0){const r=Le.get().getCanvasRenderingContext2D().prototype;e=W._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,s,n,i,o,a,l,c){this.text=e,this.style=r,this.width=s,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,s=W._canvas,n=r.wordWrap){const i=`${e}:${r.styleKey}`;if(W._measurementCache[i])return W._measurementCache[i];const o=fu(r),a=W.measureFont(o);a.fontSize===0&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const l=W.__context;l.font=o;const u=(n?W._wordWrap(e,r,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let x=0;x<u.length;x++){const b=W._measureText(u[x],r.letterSpacing,l);h[x]=b,d=Math.max(d,b)}const f=r._stroke?.width||0;let A=d+f;r.dropShadow&&(A+=r.dropShadow.distance);const g=r.lineHeight||a.fontSize;let m=Math.max(g,a.fontSize+f)+(u.length-1)*(g+r.leading);return r.dropShadow&&(m+=r.dropShadow.distance),new W(e,r,A,m,u,h,g+r.leading,d,a)}static _measureText(e,r,s){let n=!1;W.experimentalLetterSpacingSupported&&(W.experimentalLetterSpacing?(s.letterSpacing=`${r}px`,s.textLetterSpacing=`${r}px`,n=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const i=s.measureText(e);let o=i.width;const a=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-a;if(o>0)if(n)o-=r,c-=r;else{const u=(W.graphemeSegmenter(e).length-1)*r;o+=u,c+=u}return Math.max(o,c)}static _wordWrap(e,r,s=W._canvas){const n=s.getContext("2d",Wl);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=W._collapseSpaces(u),d=W._collapseNewlines(u);let f=!h;const A=r.wordWrapWidth+c,g=W._tokenize(e);for(let m=0;m<g.length;m++){let y=g[m];if(W._isNewline(y)){if(!d){a+=W._addLine(o),f=!h,o="",i=0;continue}y=" "}if(h){const b=W.isBreakingSpace(y),w=W.isBreakingSpace(o[o.length-1]);if(b&&w)continue}const x=W._getFromCache(y,c,l,n);if(x>A)if(o!==""&&(a+=W._addLine(o),o="",i=0),W.canBreakWords(y,r.breakWords)){const b=W.wordWrapSplit(y);for(let w=0;w<b.length;w++){let P=b[w],C=P,E=1;for(;b[w+E];){const j=b[w+E];if(!W.canBreakChars(C,j,y,w,r.breakWords))P+=j;else break;C=j,E++}w+=E-1;const B=W._getFromCache(P,c,l,n);B+i>A&&(a+=W._addLine(o),f=!1,o="",i=0),o+=P,i+=B}}else{o.length>0&&(a+=W._addLine(o),o="",i=0);const b=m===g.length-1;a+=W._addLine(y,!b),f=!1,o="",i=0}else x+i>A&&(f=!1,a+=W._addLine(o),o="",i=0),(o.length>0||!W.isBreakingSpace(y)||f)&&(o+=y,i+=x)}return a+=W._addLine(o,!1),a}static _addLine(e,r=!0){return e=W._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,s,n){let i=s[e];return typeof i!="number"&&(i=W._measureText(e,r,n)+r,s[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const s=e[r];if(!W.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:W._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:W._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let s="";if(typeof e!="string")return r;for(let n=0;n<e.length;n++){const i=e[n],o=e[n+1];if(W.isBreakingSpace(i,o)||W._isNewline(i)){s!==""&&(r.push(s),s=""),r.push(i);continue}s+=i}return s!==""&&r.push(s),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,s,n,i){return!0}static wordWrapSplit(e){return W.graphemeSegmenter(e)}static measureFont(e){if(W._fonts[e])return W._fonts[e];const r=W._context;r.font=e;const s=r.measureText(W.METRICS_STRING+W.BASELINE_SYMBOL),n={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return W._fonts[e]=n,n}static clearMetrics(e=""){e?delete W._fonts[e]:W._fonts={}}static get _canvas(){if(!W.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Wl)?.measureText)return W.__canvas=r,r;e=Le.get().createCanvas()}catch{e=Le.get().createCanvas()}e.width=e.height=10,W.__canvas=e}return W.__canvas}static get _context(){return W.__context||(W.__context=W._canvas.getContext("2d",Wl)),W.__context}};tr.METRICS_STRING="|q";tr.BASELINE_SYMBOL="M";tr.BASELINE_MULTIPLIER=1.4;tr.HEIGHT_MULTIPLIER=2;tr.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();tr.experimentalLetterSpacing=!1;tr._fonts={};tr._newlines=[10,13];tr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];tr._measurementCache={};let lA=tr;const cA=1e5;function uA(t,e,r,s=0){if(t.texture===Ae.WHITE&&!t.fill)return et.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof ha){const n=t.fill,i=e.createPattern(n.texture.source.resource,"repeat"),o=n.transform.copyTo(me.shared);return o.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(o),i}else if(t.fill instanceof Br){const n=t.fill,i=n.type==="linear",o=n.textureSpace==="local";let a=1,l=1;o&&r&&(a=r.width+s,l=r.height+s);let c,u=!1;if(i){const{start:h,end:d}=n;c=e.createLinearGradient(h.x*a,h.y*l,d.x*a,d.y*l),u=Math.abs(d.x-h.x)<Math.abs((d.y-h.y)*.1)}else{const{center:h,innerRadius:d,outerCenter:f,outerRadius:A}=n;c=e.createRadialGradient(h.x*a,h.y*l,d*a,f.x*a,f.y*l,A*a)}if(u&&o&&r){const h=r.lineHeight/l;for(let d=0;d<r.lines.length;d++){const f=(d*r.lineHeight+s/2)/l;n.colorStops.forEach(A=>{const g=f+A.offset*h;c.addColorStop(Math.floor(g*cA)/cA,et.shared.setValue(A.color).toHex())})}}else n.colorStops.forEach(h=>{c.addColorStop(h.offset,et.shared.setValue(h.color).toHex())});return c}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(me.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}return _e("FillStyle not recognised",t),"red"}function zx(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,s=t.length;r<s;r++){const n=t[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Fx=class Lx extends xx{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...Lx.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const s=r.style.clone();r.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=Ae.WHITE,s._fill.fill=null),this.applyFillAsTint=r.overrideFill;const n=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const i=fu(s);r.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/n):s.fontSize=this.baseRenderedFontSize=n,this._style=s,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=lA.measureFont(i),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){const r=zx(e).filter(m=>!this._currentChars.includes(m)).filter((m,y,x)=>x.indexOf(m)===y);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:n,context:i}=s.canvasAndContext,o=s.texture.source;const a=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let d=0,f=!1;const A=n.width/this.resolution,g=n.height/this.resolution;for(let m=0;m<r.length;m++){const y=r[m],x=lA.measureText(y,a,n,!1);x.lineHeight=x.height;const b=x.width*u,w=Math.ceil((a.fontStyle==="italic"?2:1)*b),P=x.height*u,C=w+h*2,E=P+h*2;if(f=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(f=!0,d=Math.ceil(Math.max(E,d))),l+C>A&&(c+=d,d=E,l=0,c+d>g)){o.update();const j=this._nextPage();n=j.canvasAndContext.canvas,i=j.canvasAndContext.context,o=j.texture.source,c=0}const B=b/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:B,kerning:{}},f){this._drawGlyph(i,x,l+h,c+h,u,a);const j=o.width*u,M=o.height*u,z=new Re(l/j*o.width,c/M*o.height,C/j*o.width,E/M*o.height);this.chars[y].texture=new Ae({source:o,frame:z}),l+=Math.ceil(C)}}o.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return Te(it,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const s=this._measureCache;for(let n=0;n<e.length;n++){const i=e[n];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=s[i];l||(l=s[i]=r.measureText(i).width);let c=s[a];c||(c=s[a]=r.measureText(a).width);let u=r.measureText(i+a).width,h=u-(l+c);h&&(this.chars[i].kerning[a]=h),u=r.measureText(i+a).width,h=u-(l+c),h&&(this.chars[a].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=aA.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new Ae({source:new ps({resource:r.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,s){r.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=fu(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const n=r._stroke,i=n?.width??0;if(n&&(e.lineWidth=i,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=uA(n,e)),r._fill&&(e.fillStyle=uA(r._fill,e)),r.dropShadow){const o=r.dropShadow,a=et.shared.setValue(o.color).toArray(),l=o.blur*s,c=o.distance*s;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*c,e.shadowOffsetY=Math.sin(o.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,s,n,i,o){const a=r.text,l=r.fontProperties,u=(o._stroke?.width??0)*i,h=s+u/2,d=n-u/2,f=l.descent*i,A=r.lineHeight*i;o.stroke&&u&&e.strokeText(a,h,d+A-f),o._fill&&e.fillText(a,h,d+A-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:s}=this.pages[e];aA.returnCanvasAndContext(r),s.destroy(!0)}this.pages=null}};Fx.defaultOptions={textureSize:512,style:new ti,mipmap:!0};let hA=Fx;function EC(t,e,r,s){const n={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=r.baseLineOffset;let i=n.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=A=>{const g=i.width;for(let m=0;m<l.index;m++){const y=A.positions[m];i.chars.push(A.chars[m]),i.charPositions.push(y+g)}i.width+=A.width,a=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let A=i.chars.length-1;if(s){let g=i.chars[A];for(;g===" ";)i.width-=r.chars[g].xAdvance,g=i.chars[--A]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,n.lines.push(i),n.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let A=0;A<t.length+1;A++){let g;const m=A===t.length;m||(g=t[A]);const y=r.chars[g]||r.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!a&&e.wordWrap&&i.width+l.width-d>f?(u(),c(l),m||i.charPositions.push(0)):(l.start=i.width,c(l),m||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&u();else if(!m){const P=y.xAdvance+(y.kerning[o]||0)+d;i.width+=P,i.spaceWidth=P,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const w=y.kerning[o]||0,P=y.xAdvance+w+d;l.positions[l.index++]=l.width+w,l.chars.push(g),l.width+=P}o=g}return u(),e.align==="center"?TC(n):e.align==="right"?RC(n):e.align==="justify"&&MC(n),n}function TC(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width/2-r.width/2;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function RC(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width-r.width;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function MC(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const s=t.lines[r];let n=0,i=s.spacesIndex[n++],o=0;const a=s.spacesIndex.length,c=(e-s.width)/a;for(let u=0;u<s.charPositions.length;u++)u===i&&(i=s.spacesIndex[n++],o+=c),s.charPositions[u]+=o}}let Zi=0;class IC{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let s=`${r.fontFamily}-bitmap`,n=!0;if(r._fill.fill&&!r._stroke)s+=r._fill.fill.styleKey,n=!1;else if(r._stroke||r.dropShadow){let o=r.styleKey;o=o.substring(0,o.lastIndexOf("-")),s=`${o}-bitmap`,n=!1}if(!Pe.has(s)){const o=new hA({style:r,overrideFill:n,overrideSize:!0,...this.defaultOptions});Zi++,Zi>50&&_e("BitmapText",`You have dynamically created ${Zi} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Zi--,Pe.remove(s)}),Pe.set(s,o)}const i=Pe.get(s);return i.ensureCharacters?.(e),i}getLayout(e,r,s=!0){const n=this.getFont(e,r);return EC([...e],r,n,s)}measureText(e,r,s=!0){return this.getLayout(e,r,s)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},Te(it,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=r?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const n=r.style,i=n instanceof ti?n:new ti(n),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new hA({style:i,overrideFill:o,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=zx(r.chars);return a.ensureCharacters(l.join("")),Pe.set(`${s}-bitmap`,a),a.once("destroy",()=>Pe.remove(`${s}-bitmap`)),a}uninstall(e){const r=`${e}-bitmap`,s=Pe.get(r);s&&s.destroy()}}const dA=new IC;class Dx extends xx{constructor(e,r){super();const{textures:s,data:n}=e;Object.keys(n.pages).forEach(i=>{const o=n.pages[parseInt(i,10)],a=s[o.id];this.pages.push({texture:a})}),Object.keys(n.chars).forEach(i=>{const o=n.chars[i],{frame:a,source:l}=s[o.page],c=new Re(o.x+a.x,o.y+a.y,o.width,o.height),u=new Ae({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:u}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){dA.install(e)}static uninstall(e){dA.uninstall(e)}}const Yl={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),A={};for(const g in f){const m=f[g].split("="),y=m[0],x=m[1].replace(/"/gm,""),b=parseFloat(x),w=isNaN(b)?x:b;A[y]=w}r[d].push(A)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=r.info,[i]=r.common,[o]=r.distanceField??[];o&&(s.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),s.fontSize=parseInt(n.size,10),s.fontFamily=n.face,s.lineHeight=parseInt(i.lineHeight,10);const a=r.page;for(let h=0;h<a.length;h++)s.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};s.baseLineOffset=s.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let A=d.letter??d.char??String.fromCharCode(f);A==="space"&&(A=" "),l[f]=A,s.chars[A]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),A=parseInt(u[h].amount,10);s.chars[l[f]].kerning[l[d]]=A}return s}},fA={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(s.getAttribute("base"),10);for(let c=0;c<o.length;c++){const u=o[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const u=parseInt(a[c].getAttribute("first"),10),h=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},pA={test(t){return typeof t=="string"&&t.includes("<font>")?fA.test(Le.get().parseXML(t)):!1},parse(t){return fA.parse(Le.get().parseXML(t))}},jC=[".xml",".fnt"],BC={extension:{type:J.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof Dx,getCacheableAssets(t,e){const r={};return t.forEach(s=>{r[s]=e,r[`${s}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},OC={extension:{type:J.LoadParser,priority:Ur.Normal},name:"loadBitmapFont",test(t){return jC.includes(Mt.extname(t).toLowerCase())},async testParse(t){return Yl.test(t)||pA.test(t)},async parse(t,e,r){const s=Yl.test(t)?Yl.parse(t):pA.parse(t),{src:n}=e,{pages:i}=s,o=[],a=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const d=i[h].file;let f=Mt.join(Mt.dirname(n),d);f=nu(f,n),o.push({src:f,data:a})}const l=await r.load(o),c=o.map(h=>l[h.src]);return new Dx({data:s,textures:c},n)},async load(t,e){return await(await Le.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(s=>r.unload(s.texture.source._sourceOrigin))),t.destroy()}};class NC{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<r;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const zC={extension:{type:J.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof Ae),getCacheableAssets:(t,e)=>{const r={};return t.forEach(s=>{e.forEach((n,i)=>{r[s+(i===0?"":i+1)]=n})}),r}};async function Ux(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const FC={extension:{type:J.DetectionParser,priority:1},test:async()=>Ux("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},AA=["png","jpg","jpeg"],LC={extension:{type:J.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...AA],remove:async t=>t.filter(e=>!AA.includes(e))},DC="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Mh(t){return DC?!1:document.createElement("video").canPlayType(t)!==""}const UC={extension:{type:J.DetectionParser,priority:0},test:async()=>Mh("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},HC={extension:{type:J.DetectionParser,priority:0},test:async()=>Mh("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},$C={extension:{type:J.DetectionParser,priority:0},test:async()=>Mh("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},GC={extension:{type:J.DetectionParser,priority:0},test:async()=>Ux("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class WC{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,s)=>(this._parsersValidated=!1,e[r]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const s={promise:null,parser:null};return s.promise=(async()=>{let n=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||_e(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,r,this)){i=a;break}}if(!i)return _e(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,r,this),s.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(n,r,this)&&(n=await a.parse(n,r,this)||n,s.parser=a)}return n})(),s}async load(e,r){this._parsersValidated||this._validateParsers();let s=0;const n={},i=zo(e),o=Xt(e,c=>({alias:[c],src:c,data:{}})),a=o.length,l=o.map(async c=>{const u=Mt.toAbsolute(c.src);if(!n[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),n[c.src]=await this.promiseCache[u].promise,r&&r(++s/a)}catch(h){throw delete this.promiseCache[u],delete n[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?n[o[0].src]:n}async unload(e){const s=Xt(e,n=>({alias:[n],src:n})).map(async n=>{const i=Mt.toAbsolute(n.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,n,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&_e(`[Assets] loadParser name conflict "${r.name}"`):_e("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function pn(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function An(t,e){const r=t.split("?")[0],s=Mt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const YC=".json",KC="application/json",XC={extension:{type:J.LoadParser,priority:Ur.Low},name:"loadJson",test(t){return pn(t,KC)||An(t,YC)},async load(t){return await(await Le.get().fetch(t)).json()}},QC=".txt",ZC="text/plain",JC={name:"loadTxt",extension:{type:J.LoadParser,priority:Ur.Low,name:"loadTxt"},test(t){return pn(t,ZC)||An(t,QC)},async load(t){return await(await Le.get().fetch(t)).text()}},eP=["normal","bold","100","200","300","400","500","600","700","800","900"],tP=[".ttf",".otf",".woff",".woff2"],rP=["font/ttf","font/otf","font/woff","font/woff2"],sP=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function nP(t){const e=Mt.extname(t),n=Mt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=n.length>0;for(const a of n)if(!a.match(sP)){i=!1;break}let o=n.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const iP=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function oP(t){return iP.test(t)?t:encodeURI(t)}const aP={extension:{type:J.LoadParser,priority:Ur.Low},name:"loadWebFont",test(t){return pn(t,rP)||An(t,tP)},async load(t,e){const r=Le.get().getFontFaceSet();if(r){const s=[],n=e.data?.family??nP(t),i=e.data?.weights?.filter(a=>eP.includes(a))??["normal"],o=e.data??{};for(let a=0;a<i.length;a++){const l=i[a],c=new FontFace(n,`url(${oP(t)})`,{...o,weight:l});await c.load(),r.add(c),s.push(c)}return Pe.set(`${n}-and-url`,{url:t,fontFaces:s}),s.length===1?s[0]:s}return _e("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{Pe.remove(`${e.family}-and-url`),Le.get().getFontFaceSet().delete(e)})}};function Ih(t,e=1){const r=fn.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function jh(t,e,r){t.label=r,t._sourceOrigin=r;const s=new Ae({source:t,label:r}),n=()=>{delete e.promiseCache[r],Pe.has(r)&&Pe.remove(r)};return s.source.once("destroy",()=>{e.promiseCache[r]&&(_e("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),s.once("destroy",()=>{t.destroyed||(_e("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),s}const lP=".svg",cP="image/svg+xml",uP={extension:{type:J.LoadParser,priority:Ur.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return pn(t,cP)||An(t,lP)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?dP(t):hP(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function hP(t,e,r,s){const i=await(await Le.get().fetch(t)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=s,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||Ih(t),h=e.data?.width??a.width,d=e.data?.height??a.height;l.width=h*u,l.height=d*u,c.drawImage(a,0,0,h*u,d*u);const{parseAsGraphicsContext:f,...A}=e.data??{},g=new ps({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...A});return jh(g,r,t)}async function dP(t){const r=await(await Le.get().fetch(t)).text(),s=new ts;return s.svg(r),s}const fP=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let $s=null,pu=class{constructor(){$s||($s=URL.createObjectURL(new Blob([fP],{type:"application/javascript"}))),this.worker=new Worker($s)}};pu.revokeObjectURL=function(){$s&&(URL.revokeObjectURL($s),$s=null)};const pP=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Gs=null;class Hx{constructor(){Gs||(Gs=URL.createObjectURL(new Blob([pP],{type:"application/javascript"}))),this.worker=new Worker(Gs)}}Hx.revokeObjectURL=function(){Gs&&(URL.revokeObjectURL(Gs),Gs=null)};let mA=0,Kl;class AP{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new pu;r.addEventListener("message",s=>{r.terminate(),pu.revokeObjectURL(),e(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Kl===void 0&&(Kl=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Kl&&(this._createdWorkers++,e=new Hx().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const s=new Promise((n,i)=>{this._queue.push({id:e,arguments:r,resolve:n,reject:i})});return this._next(),s}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),s=r.id;this._resolveHash[mA]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:mA++,id:s})}}const gA=new AP,mP=[".jpeg",".jpg",".png",".webp",".avif"],gP=["image/jpeg","image/png","image/webp","image/avif"];async function yP(t,e){const r=await Le.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const s=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const $x={name:"loadTextures",extension:{type:J.LoadParser,priority:Ur.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return pn(t,gP)||An(t,mP)},async load(t,e,r){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await gA.isImageBitmapSupported()?s=await gA.loadImageBitmap(t,e):s=await yP(t,e):s=await new Promise((i,o)=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?i(s):(s.onload=()=>{i(s)},s.onerror=o)});const n=new ps({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||Ih(t),...e.data});return jh(n,r,t)},unload(t){t.destroy(!0)}},Gx=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],xP=Gx.map(t=>`video/${t.substring(1)}`);function bP(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=wP(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function qP(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",s),t.addEventListener("error",n),t.load();function s(){i(),e()}function n(o){i(),r(o)}function i(){t.removeEventListener("canplaythrough",s),t.removeEventListener("error",n)}})}function wP(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const vP={name:"loadVideo",extension:{type:J.LoadParser,name:"loadVideo"},test(t){const e=pn(t,xP),r=An(t,Gx);return e||r},async load(t,e,r){const s={...go.defaultOptions,resolution:e.data?.resolution||Ih(t),alphaMode:e.data?.alphaMode||await ox(),...e.data},n=document.createElement("video"),i={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&n.setAttribute(l,c)}),s.muted===!0&&(n.muted=!0),bP(n,t,s.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=go.MIME_TYPES[l]||`video/${l}`}return o.src=t,a&&(o.type=a),new Promise(l=>{const c=async()=>{const u=new go({...s,resource:n});n.removeEventListener("canplay",c),e.data.preload&&await qP(n),l(jh(u,r,t))};n.addEventListener("canplay",c),n.appendChild(o)})},unload(t){t.destroy(!0)}},Wx={extension:{type:J.ResolveParser,name:"resolveTexture"},test:$x.test,parse:t=>({resolution:parseFloat(fn.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},VP={extension:{type:J.ResolveParser,priority:-2,name:"resolveJson"},test:t=>fn.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Wx.parse};class _P{constructor(){this._detections=[],this._initialized=!1,this.resolver=new fn,this.loader=new WC,this.cache=Pe,this._backgroundLoader=new NC(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){_e("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,s=typeof r=="number"?[r]:r,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:s}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const s=zo(e),n=Xt(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,r);return s?o[n[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);let a=0,l=0;const c=()=>{r?.(++a/l)},u=o.map(h=>{const d=n[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{i[h]=f})});return await Promise.all(u),s?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Pe.get(e);const r={};for(let s=0;s<e.length;s++)r[s]=Pe.get(e[s]);return r}async _mapLoadToResolve(e,r){const s=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(s,r);this._backgroundLoader.active=!0;const i={};return s.forEach(o=>{const a=n[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(c=>{i[c]=a}),Pe.set(l,a)}),i}async unload(e){this._initialized||await this.init();const r=Xt(e).map(n=>typeof n!="string"?n.src:n),s=this.resolver.resolve(r);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=Xt(e);const r=this.resolver.resolveBundle(e),s=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(s)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(s=>{Pe.remove(s.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const s of e.detections)e.skipDetections||await s.test()?r=await s.add(r):e.skipDetections||(r=await s.remove(r));return r=r.filter((s,n)=>r.indexOf(s)===n),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(s=>s in e).forEach(s=>{r.config[s]=e[s]})})}}const On=new _P;qt.handleByList(J.LoadParser,On.loader.parsers).handleByList(J.ResolveParser,On.resolver.parsers).handleByList(J.CacheParser,On.cache.parsers).handleByList(J.DetectionParser,On.detections);qt.add(zC,LC,FC,GC,UC,HC,$C,XC,JC,aP,uP,$x,vP,OC,BC,Wx,VP);const yA={loader:J.LoadParser,resolver:J.ResolveParser,cache:J.CacheParser,detection:J.DetectionParser};qt.handle(J.Asset,t=>{const e=t.ref;Object.entries(yA).filter(([r])=>!!e[r]).forEach(([r,s])=>qt.add(Object.assign(e[r],{extension:e[r].extension??s})))},t=>{const e=t.ref;Object.keys(yA).filter(r=>!!e[r]).forEach(r=>qt.remove(e[r]))});qt.add(ok,ak);const Xl={x:1,y:0,z:0},Ql={x:-1,y:0,z:0},Zl={x:0,y:-1,z:0},Jl={x:0,y:1,z:0},be={away:Jl,left:Xl,right:Ql,towards:Zl,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:Ls(re(Jl,Ql)),towardsRight:Ls(re(Zl,Ql)),towardsLeft:Ls(re(Zl,Xl)),awayLeft:Ls(re(Jl,Xl))},kP=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),SP=Math.cos(13*(Math.PI/180)),xA=-Math.PI/4,Yx=t=>{const e=Math.cos(xA),r=Math.sin(xA);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};Ls({x:1,y:2,z:0});Ls({x:-1,y:2,z:0});const CP=t=>{const e=uw(t);return e===void 0?pe:be[e]},PP=t=>{const e=Uu(t);return e===void 0?pe:be[e]},EP=(t,e=SP)=>{const{x:r,y:s}=t,n=Math.sqrt(r*r+s*s);if(n===0)return pe;const i=r/n,o=s/n,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(r)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(s)*n,z:0};return t},TP={"4-way":CP,"8-way":PP,analogue:EP},RP=.2,MP=45,IP=(t,e)=>!!t.keyboardState.has(e),Kx=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},Au=.5,Xx=(t,e,r)=>{for(const s of t.gamepads)if(!(s===null||s.axes.length<=e)){if(r===void 0){if(Math.abs(s.axes[e])>Au)return!0}else if(s.axes[e]*r>Au)return!0}return!1},Ji=(t,e,r=!0)=>{const s=Io(ke.getState()),n=s.presses[e];if(t.hudInputState[e])return!0;for(const i of n.keys)if(IP(t,i))return!0;for(const i of n.gamepadButtons)if(Kx(t,i))return!0;if(r){const i=Iy(e);if(i!==void 0){const o=s.axes[i.axis];for(const a of o)if(Xx(t,a,i.direction))return!0}}return!1};class jP{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=pe;actionsHandled=new Set;#s=()=>{let e,r,s,n;switch("tap"){case(e=this.currentActionPress("left")):return be.left;case(r=this.currentActionPress("right")):return be.right;case(s=this.currentActionPress("away")):return be.away;case(n=this.currentActionPress("towards")):return be.towards}const i=(e!=="released"?1:0)+(r!=="released"?1:0)+(s!=="released"?1:0)+(n!=="released"?1:0);if(i>1)return this.#t;if(i===1)switch("hold"){case e:return be.left;case r:return be.right;case s:return be.away;case n:return be.towards}return pe};#n(){const e=this.#e.at(0);if(e===void 0)return pe;function*r(o){for(const a of di)Ji(o,a,!1)&&(yield be[a])}function*s(o){const{axes:{x:a,y:l}}=Io(ke.getState());for(const c of o.gamepads){if(c===null)continue;let u=0,h=0;for(const f of a)c.axes.length<=f||(u-=c.axes[f]);for(const f of l)c.axes.length<=f||(h-=c.axes[f]);const d={x:u,y:h,z:0};Du(d)>RP&&(yield d)}}let n=[...r(e)],i;if(n.length===1){const[o]=n,a=[...je(this.#e).drop(1).map(l=>[...r(l)])];e:for(const l of a){if(l.length>2)break e;if(l.length===2&&l.some(c=>aw(c,o))){const c=l.find(u=>Rc(u,o)<.001);if(c!==void 0){i=c;break e}}}if(!i)for(const l of a)l.length===0&&(n=_y)}return re(i??pe,...n,...s(e))}#r=({lastTime:e})=>{const r=ch(ke.getState()),i=T0(ke.getState())&&r?Yx:h=>h,o=TP[r](re(i(r==="4-way"?this.#s():this.#n()),this.hudInputState.directionVector)),a=gg(o);this.#t={...a>1?Lu(o,1/a):o,z:0};const l={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:kP(navigator.getGamepads()),atTime:e};this.#e.unshift(l);const c=e-MP,u=this.#e.findIndex(h=>h.atTime<c);u!==-1&&this.#e.splice(u+1);for(const h of this.actionsHandled)Ji(l,h)||this.actionsHandled.delete(h)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const s=Ji(r,e);if(this.actionsHandled.has(e))return"released";if(s){const n=this.#e.at(1);return(n===void 0?!1:Ji(n,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const s of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(s))return{type:"key",input:s};for(const s of e.gamepads)if(s!==null){for(const[n,i]of s.buttons.entries())if(i.pressed&&(r===void 0||!Kx(r,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of s.axes.entries())if(Math.abs(i)>Au&&(r===void 0||!Xx(r,n)))return{type:"gamepadAxes",input:n}}}}get directionVector(){return this.#t}startTicking(){xt.shared.add(this.#r,void 0,No.INTERACTION)}stopTicking(){xt.shared.remove(this.#r)}}const BP=()=>({directionVector:pe,...un(Lg.map(t=>[t,!1]))}),Qx=v.createContext(null),OP=({children:t})=>{const[e]=v.useState(nk),[r]=v.useState(()=>new jP(e,BP()));return v.useEffect(()=>{const s=ik(e);return r.startTicking(),()=>{s(),r.stopTicking()}},[r,e]),p.jsx(Qx,{value:r,children:t})},Bh=()=>{const t=v.useContext(Qx);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},dt=({handler:t,action:e,disabled:r=!1})=>{const s=v.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=Bh();v.useEffect(()=>{if(r)return;const i=()=>{for(const o of s)if(n.currentActionPress(o)==="tap"){if(!t(o))for(const c of s)n.actionsHandled.add(c);break}};return xt.shared.add(i),()=>{xt.shared.remove(i)}},[s,r,n,t])},NP=({handler:t,disabled:e=!1})=>{const r=Bh();v.useEffect(()=>{if(e)return;const s=()=>{const n=r.inputTap();n!==void 0&&t(n,r)};return xt.shared.add(s),()=>{xt.shared.remove(s)}},[e,t,r])};function U(t,e){const r=Qu();return v.useCallback(()=>{r(t(e))},[t,r,e])}const zP=()=>{const t=le(r=>r.gameMenus.assigningInput!==void 0),e=le(r=>r.gameMenus.openMenus.length>0);dt({action:"menu_openOrExit",handler:U(sp),disabled:t}),dt({action:"menu_exit",handler:U(sp),disabled:!e}),dt({action:"toggleShowFps",handler:U(Kt,"userSettings.showFps"),disabled:e}),dt({action:"hold",handler:U(Ey,"toggle"),disabled:t}),dt({action:"map",handler:U(M_),disabled:t}),v.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),dt({action:"toggleColourisation",handler:U(Kt,"userSettings.displaySettings.uncolourised"),disabled:t}),dt({action:"cycleResolution",handler:U(xh,void 0),disabled:t})},bA=(t,e)=>{ke.dispatch(fy(ah(oa(ke.getState()),e)))},FP=(t,e)=>{const r=Qu();v.useLayoutEffect(()=>{bA()},[]),v.useLayoutEffect(()=>{const s=()=>bA(t,e);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[r,e,t])},LP=()=>(FP(),zP(),Z_(),null),DP=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bags icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,UP=`## BLACKTOOTH

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,HP=`## BOOK WORLD

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,$P=`## CONVEYOR BELTS

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,GP=`## CREDITS

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
1987 Ocean Software Limited.

### Remake

Remake by Jim Higson
Playtesting, ideas, map design, and general support by my brother, Tom Higson
Playtesting, moral support, and `,WP=`## CROWNS

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,YP=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
if you pick them up while head and heels are joined, they get *two each*

## Iron pills ![](texture-hud_shield?sprite-tinted&text-metallicBlue&sprites-normal-height)

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud_bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height) Jump higher bunny 

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud_fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height) Go faster bunny 
![](texture-animated-head_idle_right?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,KP=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so dont waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,XP=`## EGYPTUS

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,QP=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,ZP=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heelss evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,JP=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_walking_towards_2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelss bag and Heads hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the others back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Heads jumps and Heelss jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you cant understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,eE=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown_blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_walking_right_2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,tE=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,rE=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Heads race, they disappear and wont return until they are sure the coast is
clear.

> Head Over Heels Manual
`,sE=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,nE=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,iE=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* To the right of the address bar, click the **install icon: **
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock **
* **Head over heels** is now installed on your mac
* If you dont want to keep the game in the Dock, right-click the doc icon and uncheck **Options  keep in doc**. It is still available in Applications

`,oE=`## Supported platforms

Almost anything with an up-to-date browser can play

Heres some Ive tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,aE=`## SAFARI

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,lE=`## SPRINGS

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,cE=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Head Over Heels Manual, revised for remake
`,uE=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,hE=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minions back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyll never get this far!

*> Your humble minion*
`,dE=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,fE=`## THE EMPERORS GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,pE=`## THE GAME

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain keep fit equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,qe=Object.assign({"./bag.md":DP,"./blacktooth.md":UP,"./bookWorld.md":HP,"./conveyorBelts.md":$P,"./credits.md":GP,"./crowns.md":WP,"./cuddlyStuffedWhiteRabbits.md":YP,"./doughnuts.md":KP,"./egyptus.md":XP,"./head.md":QP,"./heels.md":ZP,"./hintsAndTips.md":JP,"./historyOfTheBlacktoothEmpire.md":eE,"./hooter.md":tE,"./hushPuppies.md":rE,"./penitentiary.md":sE,"./reincarnationFish.md":nE,"./remake/installGuide.md":iE,"./remake/supportedPlatforms.md":oE,"./safari.md":aE,"./springs.md":lE,"./switches.md":cE,"./swopKey.md":uE,"./teleportBack.md":hE,"./teleports.md":dE,"./theEmperorsGuardian.md":fE,"./theGame.md":pE}),Oh={historyOfTheBlacktoothEmpire:qe["./historyOfTheBlacktoothEmpire.md"],theGame:qe["./theGame.md"],egyptus:qe["./egyptus.md"],penitentiary:qe["./penitentiary.md"],safari:qe["./safari.md"],bookWorld:qe["./bookWorld.md"],blacktooth:qe["./blacktooth.md"],head:qe["./head.md"],heels:qe["./heels.md"],reincarnationFish:qe["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:qe["./cuddlyStuffedWhiteRabbits.md"],hooter:qe["./hooter.md"],doughnuts:qe["./doughnuts.md"],bag:qe["./bag.md"],crowns:qe["./crowns.md"],teleports:qe["./teleports.md"],springs:qe["./springs.md"],switches:qe["./switches.md"],conveyorBelts:qe["./conveyorBelts.md"],hushPuppies:qe["./hushPuppies.md"],theEmperorsGuardian:qe["./theEmperorsGuardian.md"],swopKey:qe["./swopKey.md"],hintsAndTips:qe["./hintsAndTips.md"],credits:qe["./credits.md"],installGuide:qe["./remake/installGuide.md"]},AE={...Oh,teleportBack:qe["./teleportBack.md"]},mE=/^##\s+(.*)$/m,gE=t=>{const e=t.match(mE);if(e===null)return"no title found";const[,r]=e;return r};function nz(t){if(!mu(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(or.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function mu(t){return or.frames[t]!==void 0}function iz(t){return or.animations[t]!==void 0}let $n;const yE=async()=>{if($n!==void 0)return $n;let t;try{t=await On.load(Og)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=Ae.EMPTY}const e=new iu(t,or);return await e.parse(),e.textureSource.scaleMode="nearest",$n=e,e},xE=()=>{if($n===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return $n},bE=({className:t,children:e})=>t?p.jsx("div",{className:`contents ${t}`,children:e}):e,qE=t=>t.replaceAll(/(?<!\.)\./g,"_"),N=({children:t,className:e,noSlitWords:r,classnameCycle:s,onClick:n,noTint:i=!1,TagName:o="span"})=>{const a=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(a.length===0)return null;const l=r?[a.toUpperCase()]:a.toUpperCase().split(/\s+/);return p.jsxs(o,{className:e,onClick:n,children:[p.jsx("span",{className:"sr-only",children:a}),l.map((c,u)=>p.jsx("span",{className:Xe("text-nowrap inline-block",u===l.length-1?"":"me-1"),children:Array.from(c).map((h,d)=>{const f=`hud.char.${Ig(h)}`;return mu(f)||console.error("no texture for char",h,h.charCodeAt(0),f,"we have:",Object.keys(xE().textures)),p.jsx("span",{className:`sprite ${mu(f)?`texture-${qE(f)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${s===void 0?"":s[d%s.length]}`},d)})},u))]})},wE=t=>t.props.children!==void 0,ht=({children:t,className:e})=>p.jsx(bE,{className:e,children:Array.isArray(t)?t.map((r,s)=>p.jsx(ht,{children:r},s)):typeof t=="number"?p.jsx(N,{children:String(t)}):typeof t=="string"?p.jsx(N,{children:t}):v.isValidElement(t)?t.type===N||t.type===ht?t:wE(t)?v.cloneElement(t,void 0,typeof t.props.children=="string"?p.jsx(N,{children:`${t.props.children}`}):p.jsx(ht,{children:t.props.children})):t:t}),vE=({flip:t=!1,focussed:e=!1})=>p.jsx(N,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":""),children:e?"":""});var zt={},Vs={},_s={},qA;function fa(){if(qA)return _s;qA=1;var t=_s&&_s.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(_s,"__esModule",{value:!0});const r=t(an()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return _s.default=r,_s}var wA;function VE(){if(wA)return Vs;wA=1;var t=Vs&&Vs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Vs,"__esModule",{value:!0});const e=t(an()),r=t(ng()),s=t(fa()),n=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(s.default),c=a[i],u=l[i];return c?u?r.default.createPortal(u(o),c,i):r.default.createPortal(o,c,i):null};return Vs.default=n,Vs}var ks={},vA;function _E(){if(vA)return ks;vA=1;var t=ks&&ks.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ks,"__esModule",{value:!0});const e=t(an()),r=t(fa()),s=({id:n,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,o].filter(u=>!!u).join(" "),ref:c})};return ks.default=s,ks}var _r={},VA;function kE(){if(VA)return _r;VA=1;var t=_r&&_r.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=_r&&_r.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(_r,"__esModule",{value:!0});const r=e(an()),s=e(fa()),n=({children:i})=>{const[o,a]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((f,A,g)=>{a(m=>Object.assign(Object.assign({},m),{[f]:A})),c(m=>Object.assign(Object.assign({},m),{[f]:g}))},[]),h=r.default.useCallback(f=>{a(A=>{const g=A,m=f;return g[m],t(g,[typeof m=="symbol"?m:m+""])}),c(A=>{const g=A,m=f;return g[m],t(g,[typeof m=="symbol"?m:m+""])})},[]),d=r.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return r.default.createElement(s.default.Provider,{value:d},i)};return _r.default=n,_r}var _A;function SE(){if(_A)return zt;_A=1;var t=zt&&zt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.Context=zt.Placeholder=zt.Provider=void 0;const e=t(VE()),r=t(_E()),s=t(kE()),n=t(fa());zt.Provider=s.default,zt.Placeholder=r.default,zt.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=r.default,i.Provider=s.default,zt.default=i,zt}var CE=SE();const xs=Qe(CE),ve="leading-none [&_[class*='texture-hud']]:mb-oneScaledPix",PE=["menu_select","swop","jump"],ri="data-menuitem_id",Zx="data-menuitem_hidden",Jx="data-menuitem_disabled",EE=()=>{},X=({id:t,label:e,valueElement:r,flipLeader:s=!1,doubleHeightWhenFocussed:n,onSelect:i=EE,hidden:o=!1,disabled:a=!1,hintInline:l=!1,className:c,hint:u,leader:h})=>{const d=v.useRef(!0),f=le(m=>m.gameMenus.openMenus.at(0)?.scrollableSelection??!1),A=le(m=>m.gameMenus.openMenus.at(0)?.focussedItemId===t);dt({action:PE,handler:i,disabled:!A||o||a});const g=p.jsxs("li",{[ri]:t,[Zx]:o,[Jx]:a,tabIndex:0,className:Xe("contents",o?"hidden":"",n&&A?"sprites-double-height":"",A?"selectedMenuItem":"",c),onMouseMove:U(bh,{focussedItemId:t,scrollableSelection:!1}),onClick:a?void 0:i,children:[h||p.jsx(vE,{flip:s,focussed:A}),p.jsx("div",{ref:m=>{A&&f&&m?.scrollIntoView({behavior:d.current?"instant":"smooth",block:"center"}),d.current=!1},className:Xe(r===void 0?"col-span-2":""),children:typeof e=="string"?p.jsx(p.Fragment,{children:p.jsx(N,{children:e})}):e}),r!==void 0&&r,!A||u===void 0||l?null:p.jsx(xs,{children:typeof u=="string"?p.jsx(N,{className:ve,children:u}):u})]});return l&&u?p.jsxs(p.Fragment,{children:[g,p.jsx("div",{className:"col-span-2 col-start-2 mb-2",children:u})]}):g},rr=()=>p.jsx(X,{id:"back",label:"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:U(De)}),xi=t=>p.jsx("div",{className:`col-span-3 h-1 ${t}`}),eb=()=>{const t=document.body.querySelectorAll(`[${ri}]`);return Array.from(t)},kA=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=ke.getState();if(e===void 0)return!0;const r=eb();if(r.length<=1)return!0;const s=r.findIndex(i=>i.getAttribute(ri)===e);if(s===-1)return!0;let n=s;do n=(n+t+r.length)%r.length;while(r[n].getAttribute(Zx)==="true"||r[n].getAttribute(Jx)==="true");return ke.dispatch(bh({focussedItemId:r[n].getAttribute(ri),scrollableSelection:!0})),!1},TE=t=>{const e=my();dt({action:"away",handler:v.useCallback(()=>{if(t.current!==null)return kA(-1)},[t]),disabled:e}),dt({action:"towards",handler:v.useCallback(()=>{if(t.current!==null)return kA(1)},[t]),disabled:e})},Ie=({className:t="",children:e})=>{const r=v.useRef(null);return v.useEffect(()=>{if(r.current===null||ke.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const s=eb();ke.dispatch(bh({focussedItemId:s[0].getAttribute(ri),scrollableSelection:!0}))},[]),TE(r),p.jsx("menu",{ref:r,className:Xe("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})};var pa=ng();const RE=Qe(pa),Ue=({children:t})=>pa.createPortal(p.jsx(Hs,{children:t}),document.body),bi=({className:t})=>p.jsxs("div",{className:Xe("text-redShadow zx:text-zxMagenta sprites-double-height flex flex-row gap-1",t),children:[p.jsx(N,{className:"inline-block scale-[-1]",onClick:U(De),children:""}),p.jsx(N,{className:"inline-block",onClick:U(De),children:"Back"})]}),ME=({pageName:t})=>{const e=Oh[t],r=gE(e),s=bt()==="desktop";return p.jsx(X,{id:`markdown/${t}`,label:r,onSelect:U(Rt,`markdown/${t}`),doubleHeightWhenFocussed:s})},IE=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midGrey zx:bg-zxCyan",onClick:U(De)}),p.jsx(Ee,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:p.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${ve} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[Dt()&&p.jsx(bi,{className:"mb-1"}),p.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[p.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),p.jsx(N,{className:"sprites-double-height mx-1",children:"Read the manual"}),p.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),p.jsxs(Ie,{children:[[...je(Ku(Oh)).map(t=>p.jsx(ME,{pageName:t},t))],p.jsx(xi,{}),Dt()||p.jsx(rr,{})]})]})})]}),jE={"":v.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},SA=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),BE=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),ec=t=>t.replace(/^\s+|\s+$/g," "),He=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),Nn=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,s=0;const n=He("");let i,o;e?(i=He("p"),o=[n,i],n.c.push(i)):(i=n,o=[n]);let a;const l=(h,d=!0)=>(d&&o.push(h),i.c.push(h),d&&(i=h),h),c=h=>{const d=o.findIndex(f=>f.t===h);o=o.slice(0,d),i=o.at(-1)};for(;a=r.exec(t);){const h=t.substring(s,a.index);if(s=r.lastIndex,h!=="")if(i===n&&e){const d=He("p",ec(h));n.c.push(d),o=[n,d],i=d}else i.c.push(ec(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const d=He("pre",a[4]?SA(a[4]):He("code",SA(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));n.c.push(d),o=[n],i=n}else if(a[6]){const d=a[6],f=d!==">",A=!!d.match(/\./),g=f?A?"ol":"ul":"blockquote",m=a[5].split(`
`).map(x=>x.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(x=>x.trim()!==""),y=He(g,f?m.map(x=>He("li",Nn(x).c)):Nn(m.join(`
`)).c);n.c.push(y),o=[n,y],i=n}else if(a[8]){const d=He("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===n){const f=He("p",d);n.c.push(f),i=f,o=[n,f]}else l(d,!1)}else if(a[10]){const d=o.find(f=>f.t==="a");d&&(d.p.href=a[11])}else if(a[9])l(He("a"));else if(a[14]){const d="h"+a[14].length;n.c.push(He(d,Nn(a[15]).c)),o=[n],i=n}else if(a[13])n.c.push(He("h1",Nn(a[12]).c)),o=[n],i=n;else if(a[16])l(He("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const A=n.c;let g;for(g=A.length-1;g>=0&&!BE(A[g]);g--);if(g!==n.c.length-1){const m=n.c.splice(g+1);n.c.push(He("p",m))}}const f=He("p");n.c.push(f),o=[n,f],i=f}else if(a[1])n.c.push(He("hr")),o=[n],i=n;else if(a[17]){const d=a[17].length===2?"strong":"em";o.findIndex(A=>A.t===d)===-1?l(He(d)):c(d)}}}const u=ec(t.substring(s));if(u.length){const h=n.c.at(-1);let d;h?.t==="p"?d=h:e?(d=He("p"),n.c.push(d)):d=n,d.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},OE=(t,e={})=>{const r={...jE,...e},s=(n,i=0)=>{const o=n.t===""?v.Fragment:r[n.t];return v.createElement(o,{...n.p,key:i},n.c.length===0?void 0:n.c.map((a,l)=>typeof a=="string"?a:s(a,l)))};return s(Nn(t,!0))},NE=({markdown:t,customComponents:e})=>OE(t,e),zE={h2:function({children:e}){return p.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${ve}`,children:p.jsx(ht,{children:e})})},h3:function({children:e}){return p.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:p.jsx(ht,{children:e})})},blockquote:function({children:e}){return p.jsx("blockquote",{className:`${ve} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:p.jsxs(ht,{children:["> ",e]})})},p:function({children:e}){return p.jsx("div",{className:`mb-1 last:mb-0 ${ve}`,children:p.jsx(ht,{children:e})})},a:function({children:e,href:r}){return p.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:p.jsx(ht,{children:e})})},li:function({children:e}){return p.jsx("div",{className:`mb-1 clear-both ${ve}`,children:p.jsxs(ht,{children:[p.jsx(N,{className:"text-metallicBlue zx:text-zxYellow",children:""}),e]})})},strong:function({children:e}){return p.jsx(ht,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return p.jsx(ht,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=mi();if(e===void 0)throw new Error("image without src");const s=e.split(/\?|&/);return p.jsx("span",{style:{"--scale":r*2},children:p.jsx("span",{className:Xe("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",s.join(" "))})})},hr:function(){return p.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},ot=({markdown:t,className:e})=>p.jsx("div",{className:`contents ${e}`,children:p.jsx(NE,{customComponents:zE,markdown:t})}),CA=4,PA=fo.h,tb=()=>{const t=mi(),e=v.useRef(null),r=v.useCallback(s=>{if(e.current===null)return;const{scrollTop:n,scrollLeft:i}=e.current,o=be[s],a=n+t*CA*-o.y*PA,l=i+t*CA*o.x*PA;e.current.scrollTo({left:l,top:a,behavior:"instant"})},[t]);return dt({handler:v.useCallback(()=>{r("towards")},[r]),action:"towards"}),dt({handler:v.useCallback(()=>{r("away")},[r]),action:"away"}),dt({handler:v.useCallback(()=>{r("left")},[r]),action:"left"}),dt({handler:v.useCallback(()=>{r("right")},[r]),action:"right"}),e},tc=t=>{const e=t.source==="manual"?AE[t.pageName]:t.markdown,r=tb();return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:U(De)}),p.jsxs(Ee,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:U(De),children:[p.jsxs("div",{className:Xe("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[Dt()&&p.jsx(bi,{className:"pb-1"}),p.jsx(ot,{markdown:e})]}),p.jsx(Ie,{className:"hidden",children:p.jsx(rr,{})})]})]})},ce=t=>t,EA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},FE={egyptus:ce("texture-crown_egyptus"),blacktooth:ce("texture-crown_blacktooth"),bookworld:ce("texture-crown_bookworld"),penitentiary:ce("texture-crown_penitentiary"),safari:ce("texture-crown_safari")},Cn=({planet:t,className:e,label:r=t})=>{const s=le(i=>i.gameMenus.planetsLiberated[t]),n=!lh();return p.jsxs("div",{className:`flex flex-col ${e}`,children:[p.jsx("span",{className:`sprite block ${FE[t]} ${s?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),p.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${s?"":"colourised:brightness-halfBrite"} ${EA[t][0]}`}),p.jsx(N,{classnameCycle:n?EA[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${s?"":"colourised:brightness-halfBrite"}`,children:r})]})},LE=()=>p.jsxs(p.Fragment,{children:[p.jsx(N,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),p.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[p.jsx(Cn,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(Cn,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(Cn,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(Cn,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(Cn,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),Nh=v.createContext(null),DE=({children:t})=>{const[e,r]=v.useState(0),s=v.useCallback(()=>r(i=>i+1),[]),n=v.useCallback(()=>r(i=>i-1),[]);return p.jsx(Nh,{value:{count:e,loadingStarted:s,loadingFinished:n},children:t})},UE=()=>{const t=v.useContext(Nh);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t},HE=()=>{const t=v.useContext(Nh);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t.count>0},$E="/assets/rock-C4e7VvX5.mp3",GE=({playMusic:t=!1})=>{const e=HE(),r=U(De);return p.jsxs(Ue,{children:[e?p.jsx(ig,{}):p.jsx(tt,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsxs(Ee,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,children:[t&&p.jsx("audio",{src:$E,autoPlay:!0,loop:!0}),p.jsx(LE,{}),p.jsx(Ie,{className:"hidden",children:!e&&p.jsx(rr,{})})]})]})},mr=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],WE=()=>p.jsx(p.Fragment,{children:p.jsxs("div",{className:"flex justify-center gap-2 resHandheld:gap-1 leading-none",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(N,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(N,{classnameCycle:mr,children:"Jon"}),p.jsx(N,{classnameCycle:mr,children:"Ritman"})]}),p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(N,{classnameCycle:mr,children:"Bernie"}),p.jsx(N,{classnameCycle:mr,children:"Drummand"})]})]})]}),p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(N,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),p.jsx("address",{className:"flex",children:p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(N,{classnameCycle:mr,children:"Jim"}),p.jsx(N,{classnameCycle:mr,children:"Higson"})]})})]})]})}),tn=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return ce("texture-animated-head_walking_away");case"towards":return ce("texture-animated-head_walking_towards");case"left":return ce("texture-animated-head_walking_left");case"right":return ce("texture-animated-head_walking_right");case"awayRight":return ce("texture-animated-head_walking_awayRight");case"towardsRight":return ce("texture-animated-head_walking_towardsRight");case"towardsLeft":return ce("texture-animated-head_walking_towardsLeft");case"awayLeft":return ce("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return ce("texture-animated-head_idle_towards");case"right":return ce("texture-animated-head_idle_right");case"awayRight":return ce("texture-animated-head_idle_awayRight");case"towardsRight":return ce("texture-animated-head_idle_towardsRight");case"towardsLeft":return ce("texture-animated-head_idle_towardsLeft");case"away":return ce("texture-head_walking_away_2");case"left":return ce("texture-head_walking_left_2");case"awayLeft":return ce("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return ce("texture-animated-heels_walking_away");case"towards":return ce("texture-animated-heels_walking_towards");case"left":return ce("texture-animated-heels_walking_left");case"right":return ce("texture-animated-heels_walking_right");case"awayRight":return ce("texture-animated-heels_walking_awayRight");case"towardsRight":return ce("texture-animated-heels_walking_towardsRight");case"towardsLeft":return ce("texture-animated-heels_walking_towardsLeft");case"awayLeft":return ce("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return ce("texture-heels_walking_towards_2");case"right":return ce("texture-heels_walking_right_2");case"awayRight":return ce("texture-heels_walking_awayRight_2");case"towardsRight":return ce("texture-heels_walking_towardsRight_2");case"towardsLeft":return ce("texture-heels_walking_towardsLeft_2");case"away":return ce("texture-heels_walking_away_2");case"left":return ce("texture-heels_walking_left_2");case"awayLeft":return ce("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},YE=(t,e,r)=>{const s=t.getBoundingClientRect(),n=s.left+s.width/2,i=s.top+s.height/2,o=n-e,a=i-r,c=Yx({x:o,y:a});return Uu(c)},TA=({character:t,defaultFacing:e,className:r=""})=>{const[s,n]=v.useState(e),[i,o]=v.useState(!1),a=v.useRef(null);v.useEffect(()=>{const d=A=>{a.current&&n(YE(a.current,A.clientX,A.clientY)||"right")},f=()=>{n(e),o(!1)};return window.addEventListener("mousemove",d),document.addEventListener("mouseleave",f),()=>{window.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",f)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=tn({character:t,facingXy8:s,action:i?"walking":"idle"});return p.jsxs("div",{ref:a,className:`relative ${r}`,onMouseEnter:l,onMouseLeave:c,children:[p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),p.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})},rb=({noSubtitle:t,className:e})=>p.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[p.jsxs("h1",{className:"flex",children:[p.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[p.jsx(N,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),p.jsx(TA,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),p.jsx(N,{classnameCycle:mr,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),p.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[p.jsx(N,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),p.jsx(TA,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||p.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[p.jsx(N,{className:"text-midRed zx:text-zxCyan",children:"block"}),p.jsx(N,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),p.jsx(N,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),p.jsx(N,{className:"text-moss zx:text-zxWhite",children:"ing"}),p.jsx(N,{classnameCycle:mr,children:" remake"})]})]}),KE=()=>{const[t,e]=v.useReducer(r=>!r,!1);return p.jsxs("div",{onClick:e,className:"flex bg-metallicBlueHalfbrite text-metallicBlue justify-end absolute bottom-0 right-2 z-dialog",children:[!t&&p.jsx(N,{children:"*"}),t&&p.jsxs(N,{children:["2814b6c","2025-08-13"]})]})},XE=()=>{const t=Zs();return p.jsx(N,{children:t?"Resume the game":"Play the game"})},QE=()=>p.jsx(X,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"installGuide")}),ZE=()=>p.jsx(X,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"sureWantEditor")}),JE=()=>{const t=Zs(),e=le(r=>r.gameMenus.reincarnationPoint!==void 0);return p.jsx(X,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:U(Rt,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},RA="https://discord.gg/Se5Jznc2jm",eT=t=>{const e=Zs(),r=U(Rt,"crowns"),s=U(Rt,"score"),n=v.useCallback(()=>{r(),s()},[r,s]);return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),p.jsxs(Ee,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[p.jsx(rb,{noSubtitle:e,className:e?"resHandheld:hidden":""}),p.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[p.jsxs(Ie,{className:"w-24 mx-auto",children:[p.jsx(X,{id:"playGame",label:p.jsx(XE,{}),doubleHeightWhenFocussed:!0,onSelect:U(E_)}),!e&&bt()==="desktop"&&p.jsx(ZE,{}),p.jsx(X,{id:"map",label:"use the Map",onSelect:U(Rt,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),p.jsx(X,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e})]}),p.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[p.jsxs(Ie,{children:[p.jsx(X,{id:"modernisationOptions",label:"Options",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"modernisationOptions")}),p.jsx(X,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"readTheManual")})]}),p.jsxs(Ie,{children:[pV()||p.jsx(QE,{}),p.jsx(X,{id:"discord",leader:p.jsx(N,{children:jg}),label:p.jsx("a",{href:RA,target:"_blank",children:p.jsx(N,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:v.useCallback(()=>{window.open(RA,"_blank")},[])})]})]}),p.jsx(Ie,{className:"w-24 mx-auto",children:p.jsx(JE,{})})]}),!e&&p.jsx(WE,{})]}),p.jsx(KE,{})]})},mn=({className:t})=>p.jsx("div",{className:Xe("contents",t),children:p.jsx(xs.Placeholder,{})}),sb=t=>{t.reincarnateFrom(ke.getState().gameMenus.reincarnationPoint),ke.dispatch(Ty())},tT="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",rT=()=>{const t=dn();return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midRed zx:bg-zxYellow"}),p.jsxs(Ee,{className:"bg-white zx:bg-zxRed px-1",children:[p.jsx(N,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),p.jsx(ot,{markdown:tT,className:"text-redShadow zx:text-zxWhite"}),p.jsxs(Ie,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(X,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{sb(t)}}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:U(Py,{offerReincarnation:!1})})]})]})]})},Ge="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow",sT=()=>{const t=le(r=>r.gameMenus.reincarnationPoint!==void 0),e=dn();return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midRed zx:bg-zxYellow"}),p.jsx(Ee,{className:"bg-white zx:bg-zxRed px-1",children:p.jsx(xs.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[p.jsx(N,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),p.jsxs(Ie,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(X,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:p.jsx("span",{className:`${Ge} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:U(De),hint:"Back to the game"}),t&&p.jsx(X,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:p.jsx("span",{className:`${Ge} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>sb(e),hint:"Go back and continue from the last reincarnation fish you ate"}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:U(Py,{offerReincarnation:!1}),leader:p.jsx("span",{className:`${Ge} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(ot,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"})})]}),p.jsx(mn,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},gu=ln(()=>er(()=>import("./campaign-su_oVbP3.js"),__vite__mapDeps([6,4,5]))),MA=(t,e)=>t*160+e*1e4,nT=()=>{const{campaign:t}=v.use(gu()),e=le(C0),r=le(({gameMenus:{roomsExplored:a}})=>Mc(je(ms(a)))),s=MA(r,e),n=Mc(kg(t.rooms)),i=MA(n,5),o=s<8e3?"beginner":s<2e4?"novice":s<3e4?"spy":s<55e3?"master-spy":s<84e3?"hero":s<i?"liberator":"completionist";return p.jsxs(p.Fragment,{children:[p.jsx(rb,{noSubtitle:!0,className:"resHandheld:hidden"}),p.jsx(N,{classnameCycle:mr,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:o}),p.jsxs("div",{className:`contents ${ve}`,children:[p.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",s.toLocaleString()]}),p.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",n," rooms"," ",`(${(100*r/n).toFixed(1)}%)`]}),p.jsxs(N,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),p.jsx(Ie,{className:"hidden",children:p.jsx(rr,{})})]})]})},iT=()=>p.jsx(Ue,{children:p.jsxs(v.Suspense,{fallback:p.jsxs(p.Fragment,{children:[p.jsx(ig,{}),p.jsx(Ee,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[p.jsx(tt,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Ee,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:U(De),children:p.jsx(nT,{})})]})}),ss="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",oT=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:ss,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:ss,children:"Cursor"}),""]});case"ArrowUp":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:ss,children:"Cursor"}),""]});case"ArrowLeft":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:ss,children:"Cursor"}),""]});case"ArrowRight":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:ss,children:"Cursor"}),""]});default:return t}},aT=t=>t===0?"":t===1?"":`axis${t}`,lT=t=>{switch(jf[t]){case"dPadDown":return"d-Pad";case"dPadUp":return"d-Pad";case"dPadLeft":return"d-Pad";case"dPadRight":return"d-Pad";case"a":return p.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return p.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return p.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return p.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return jf[t]??t},zh=({action:t,keyClassName:e,className:r,flashingCursor:s=!1})=>{const n=le(o=>o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput?.presses:Io(o).presses[t]),i=le(o=>{const a=Iy(t);return a===void 0?_y:o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput.axes:Io(o).axes[a.axis]});return p.jsxs("div",{className:r,children:[n.keys.map(o=>p.jsx("span",{className:Xe("text-nowrap",e),children:p.jsx(ht,{children:oT(o)})},`key:${o}`)),i.map(o=>p.jsx("span",{className:Xe("text-nowrap",e),children:p.jsxs(ht,{children:[p.jsx("span",{className:ss,children:""}),aT(o)]})},`gamePadAxis:${o}`)),n.gamepadButtons.map(o=>p.jsx("span",{className:Xe("text-nowrap",e),children:p.jsxs(ht,{children:[p.jsx("span",{className:ss,children:""}),lT(o)]})},`gamePadButton:${o}`)),s&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]})},cT=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>p.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:bt()==="desktop"?p.jsxs(p.Fragment,{children:[p.jsx(N,{className:"me-1",children:"Press"}),p.jsx(N,{className:Xe("me-1",r),children:t}),p.jsx(N,{children:"to continue"}),p.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[p.jsx(N,{children:"("}),p.jsx(zh,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),p.jsx(N,{children:")"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx(N,{className:Xe("me-1",r),children:"Tap"}),p.jsx(N,{children:"to continue"})]})}),uT=()=>p.jsx(Ue,{children:p.jsxs(Ee,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:U(De),children:[p.jsx(N,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),p.jsx("span",{className:"zx",children:p.jsx(cT,{className:`${ve} px-1`,action:"hold"})})]})});function nb(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=nb(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function ib(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=nb(t))&&(s&&(s+=" "),s+=e);return s}function hT(...t){return Xe(ib(t))}const dT=/^(?<modifiers>[^]*)(?<key>.+)$/,fT=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},pT=(t,e,r)=>{const s=t?.join(" ");v.useEffect(()=>{if(!t||t.length===0)return;const n=i=>{if(i.target.closest(".monaco-editor")===null)for(const l of t){const c=l.match(dT);if(!c||!c.groups)continue;const{modifiers:u,key:h}=c.groups;if(fT(u)){console.warn(`Invalid shortcut "${l}": duplicate modifiers`);continue}const d=u.includes("^"),f=u.includes(""),A=u.includes(""),g=u.includes(""),m=d||f||A||g,y=d===i.ctrlKey&&f===i.metaKey&&A===i.shiftKey&&g===i.altKey&&(m||!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey);if((g&&i.altKey?i.code.replace(/^Key/,"").toLowerCase():i.key.toLowerCase())===h.toLowerCase()&&y){e||r?.(),i.preventDefault();break}}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[e,r,s])};function gr(t,e,{checkForDefaultPrevented:r=!0}={}){return function(n){if(t?.(n),r===!1||!n.defaultPrevented)return e?.(n)}}function IA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ob(...t){return e=>{let r=!1;const s=t.map(n=>{const i=IA(n,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let n=0;n<s.length;n++){const i=s[n];typeof i=="function"?i():IA(t[n],null)}}}}function bs(...t){return v.useCallback(ob(...t),t)}function ab(t,e=[]){let r=[];function s(i,o){const a=v.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:d,children:f,...A}=h,g=d?.[t]?.[l]||a,m=v.useMemo(()=>A,Object.values(A));return p.jsx(g.Provider,{value:m,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,A=v.useContext(f);if(A)return A;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const n=()=>{const i=r.map(o=>v.createContext(o));return function(a){const l=a?.[t]||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return n.scopeName=t,[s,AT(n,...e)]}function AT(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function mT(t){const e=gT(t),r=v.forwardRef((s,n)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(xT);if(l){const c=l.props.children,u=a.map(h=>h===l?v.Children.count(c)>1?v.Children.only(null):v.isValidElement(c)?c.props.children:null:h);return p.jsx(e,{...o,ref:n,children:v.isValidElement(c)?v.cloneElement(c,void 0,u):null})}return p.jsx(e,{...o,ref:n,children:i})});return r.displayName=`${t}.Slot`,r}function gT(t){const e=v.forwardRef((r,s)=>{const{children:n,...i}=r;if(v.isValidElement(n)){const o=qT(n),a=bT(i,n.props);return n.type!==v.Fragment&&(a.ref=s?ob(s,o):o),v.cloneElement(n,a)}return v.Children.count(n)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var lb=Symbol("radix.slottable");function yT(t){const e=({children:r})=>p.jsx(p.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=lb,e}function xT(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===lb}function bT(t,e){const r={...e};for(const s in e){const n=t[s],i=e[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...a)=>{const l=i(...a);return n(...a),l}:n&&(r[s]=n):s==="style"?r[s]={...n,...i}:s==="className"&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...t,...r}}function qT(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var wT=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Hr=wT.reduce((t,e)=>{const r=mT(`Primitive.${e}`),s=v.forwardRef((n,i)=>{const{asChild:o,...a}=n,l=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function vT(t,e){t&&pa.flushSync(()=>t.dispatchEvent(e))}function Aa(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...r)=>e.current?.(...r),[])}function VT(t,e=globalThis?.document){const r=Aa(t);v.useEffect(()=>{const s=n=>{n.key==="Escape"&&r(n)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[r,e])}var _T="DismissableLayer",yu="dismissableLayer.update",kT="dismissableLayer.pointerDownOutside",ST="dismissableLayer.focusOutside",jA,cb=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ub=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=v.useContext(cb),[u,h]=v.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=v.useState({}),A=bs(e,E=>h(E)),g=Array.from(c.layers),[m]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(m),x=u?g.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,w=x>=y,P=ET(E=>{const B=E.target,j=[...c.branches].some(M=>M.contains(B));!w||j||(n?.(E),o?.(E),E.defaultPrevented||a?.())},d),C=TT(E=>{const B=E.target;[...c.branches].some(M=>M.contains(B))||(i?.(E),o?.(E),E.defaultPrevented||a?.())},d);return VT(E=>{x===c.layers.size-1&&(s?.(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},d),v.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(jA=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),BA(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=jA)}},[u,d,r,c]),v.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),BA())},[u,c]),v.useEffect(()=>{const E=()=>f({});return document.addEventListener(yu,E),()=>document.removeEventListener(yu,E)},[]),p.jsx(Hr.div,{...l,ref:A,style:{pointerEvents:b?w?"auto":"none":void 0,...t.style},onFocusCapture:gr(t.onFocusCapture,C.onFocusCapture),onBlurCapture:gr(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:gr(t.onPointerDownCapture,P.onPointerDownCapture)})});ub.displayName=_T;var CT="DismissableLayerBranch",PT=v.forwardRef((t,e)=>{const r=v.useContext(cb),s=v.useRef(null),n=bs(e,s);return v.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),p.jsx(Hr.div,{...t,ref:n})});PT.displayName=CT;function ET(t,e=globalThis?.document){const r=Aa(t),s=v.useRef(!1),n=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){hb(kT,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=l,e.addEventListener("click",n.current,{once:!0})):l()}else e.removeEventListener("click",n.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",n.current)}},[e,r]),{onPointerDownCapture:()=>s.current=!0}}function TT(t,e=globalThis?.document){const r=Aa(t),s=v.useRef(!1);return v.useEffect(()=>{const n=i=>{i.target&&!s.current&&hb(ST,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function BA(){const t=new CustomEvent(yu);document.dispatchEvent(t)}function hb(t,e,r,{discrete:s}){const n=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),s?vT(n,i):n.dispatchEvent(i)}var Or=globalThis?.document?v.useLayoutEffect:()=>{},RT=Bu[" useId ".trim().toString()]||(()=>{}),MT=0;function IT(t){const[e,r]=v.useState(RT());return Or(()=>{r(s=>s??String(MT++))},[t]),e?`radix-${e}`:""}const jT=["top","right","bottom","left"],Nr=Math.min,Tt=Math.max,Lo=Math.round,eo=Math.floor,ar=t=>({x:t,y:t}),BT={left:"right",right:"left",bottom:"top",top:"bottom"},OT={start:"end",end:"start"};function xu(t,e,r){return Tt(t,Nr(e,r))}function wr(t,e){return typeof t=="function"?t(e):t}function vr(t){return t.split("-")[0]}function gn(t){return t.split("-")[1]}function Fh(t){return t==="x"?"y":"x"}function Lh(t){return t==="y"?"height":"width"}function zr(t){return["top","bottom"].includes(vr(t))?"y":"x"}function Dh(t){return Fh(zr(t))}function NT(t,e,r){r===void 0&&(r=!1);const s=gn(t),n=Dh(t),i=Lh(n);let o=n==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Do(o)),[o,Do(o)]}function zT(t){const e=Do(t);return[bu(t),e,bu(e)]}function bu(t){return t.replace(/start|end/g,e=>OT[e])}function FT(t,e,r){const s=["left","right"],n=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?n:s:e?s:n;case"left":case"right":return e?i:o;default:return[]}}function LT(t,e,r,s){const n=gn(t);let i=FT(vr(t),r==="start",s);return n&&(i=i.map(o=>o+"-"+n),e&&(i=i.concat(i.map(bu)))),i}function Do(t){return t.replace(/left|right|bottom|top/g,e=>BT[e])}function DT(t){return{top:0,right:0,bottom:0,left:0,...t}}function db(t){return typeof t!="number"?DT(t):{top:t,right:t,bottom:t,left:t}}function Uo(t){const{x:e,y:r,width:s,height:n}=t;return{width:s,height:n,top:r,left:e,right:e+s,bottom:r+n,x:e,y:r}}function OA(t,e,r){let{reference:s,floating:n}=t;const i=zr(e),o=Dh(e),a=Lh(o),l=vr(e),c=i==="y",u=s.x+s.width/2-n.width/2,h=s.y+s.height/2-n.height/2,d=s[a]/2-n[a]/2;let f;switch(l){case"top":f={x:u,y:s.y-n.height};break;case"bottom":f={x:u,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:h};break;case"left":f={x:s.x-n.width,y:h};break;default:f={x:s.x,y:s.y}}switch(gn(e)){case"start":f[o]-=d*(r&&c?-1:1);break;case"end":f[o]+=d*(r&&c?-1:1);break}return f}const UT=async(t,e,r)=>{const{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:h}=OA(c,s,l),d=s,f={},A=0;for(let g=0;g<a.length;g++){const{name:m,fn:y}=a[g],{x,y:b,data:w,reset:P}=await y({x:u,y:h,initialPlacement:s,placement:d,strategy:n,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=x??u,h=b??h,f={...f,[m]:{...f[m],...w}},P&&A<=50&&(A++,typeof P=="object"&&(P.placement&&(d=P.placement),P.rects&&(c=P.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:n}):P.rects),{x:u,y:h}=OA(c,d,l)),g=-1)}return{x:u,y:h,placement:d,strategy:n,middlewareData:f}};async function si(t,e){var r;e===void 0&&(e={});const{x:s,y:n,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=wr(e,t),A=db(f),m=a[d?h==="floating"?"reference":"floating":h],y=Uo(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(m)))==null||r?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=h==="floating"?{x:s,y:n,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),w=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},P=Uo(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:b,strategy:l}):x);return{top:(y.top-P.top+A.top)/w.y,bottom:(P.bottom-y.bottom+A.bottom)/w.y,left:(y.left-P.left+A.left)/w.x,right:(P.right-y.right+A.right)/w.x}}const HT=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:s,placement:n,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=wr(t,e)||{};if(c==null)return{};const h=db(u),d={x:r,y:s},f=Dh(n),A=Lh(f),g=await o.getDimensions(c),m=f==="y",y=m?"top":"left",x=m?"bottom":"right",b=m?"clientHeight":"clientWidth",w=i.reference[A]+i.reference[f]-d[f]-i.floating[A],P=d[f]-i.reference[f],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let E=C?C[b]:0;(!E||!await(o.isElement==null?void 0:o.isElement(C)))&&(E=a.floating[b]||i.floating[A]);const B=w/2-P/2,j=E/2-g[A]/2-1,M=Nr(h[y],j),z=Nr(h[x],j),G=M,F=E-g[A]-z,L=E/2-g[A]/2+B,Q=xu(G,L,F),q=!l.arrow&&gn(n)!=null&&L!==Q&&i.reference[A]/2-(L<G?M:z)-g[A]/2<0,_=q?L<G?L-G:L-F:0;return{[f]:d[f]+_,data:{[f]:Q,centerOffset:L-Q-_,...q&&{alignmentOffset:_}},reset:q}}}),$T=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,s;const{placement:n,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:A="none",flipAlignment:g=!0,...m}=wr(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=vr(n),x=zr(a),b=vr(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),P=d||(b||!g?[Do(a)]:zT(a)),C=A!=="none";!d&&C&&P.push(...LT(a,g,A,w));const E=[a,...P],B=await si(e,m),j=[];let M=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&j.push(B[y]),h){const L=NT(n,o,w);j.push(B[L[0]],B[L[1]])}if(M=[...M,{placement:n,overflows:j}],!j.every(L=>L<=0)){var z,G;const L=(((z=i.flip)==null?void 0:z.index)||0)+1,Q=E[L];if(Q)return{data:{index:L,overflows:M},reset:{placement:Q}};let q=(G=M.filter(_=>_.overflows[0]<=0).sort((_,k)=>_.overflows[1]-k.overflows[1])[0])==null?void 0:G.placement;if(!q)switch(f){case"bestFit":{var F;const _=(F=M.filter(k=>{if(C){const S=zr(k.placement);return S===x||S==="y"}return!0}).map(k=>[k.placement,k.overflows.filter(S=>S>0).reduce((S,V)=>S+V,0)]).sort((k,S)=>k[1]-S[1])[0])==null?void 0:F[0];_&&(q=_);break}case"initialPlacement":q=a;break}if(n!==q)return{reset:{placement:q}}}return{}}}};function NA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function zA(t){return jT.some(e=>t[e]>=0)}const GT=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:s="referenceHidden",...n}=wr(t,e);switch(s){case"referenceHidden":{const i=await si(e,{...n,elementContext:"reference"}),o=NA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:zA(o)}}}case"escaped":{const i=await si(e,{...n,altBoundary:!0}),o=NA(i,r.floating);return{data:{escapedOffsets:o,escaped:zA(o)}}}default:return{}}}}};async function WT(t,e){const{placement:r,platform:s,elements:n}=t,i=await(s.isRTL==null?void 0:s.isRTL(n.floating)),o=vr(r),a=gn(r),l=zr(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=wr(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:A}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof A=="number"&&(f=a==="end"?A*-1:A),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const YT=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,s;const{x:n,y:i,placement:o,middlewareData:a}=e,l=await WT(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},KT=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:s,placement:n}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:m=>{let{x:y,y:x}=m;return{x:y,y:x}}},...l}=wr(t,e),c={x:r,y:s},u=await si(e,l),h=zr(vr(n)),d=Fh(h);let f=c[d],A=c[h];if(i){const m=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=f+u[m],b=f-u[y];f=xu(x,f,b)}if(o){const m=h==="y"?"top":"left",y=h==="y"?"bottom":"right",x=A+u[m],b=A-u[y];A=xu(x,A,b)}const g=a.fn({...e,[d]:f,[h]:A});return{...g,data:{x:g.x-r,y:g.y-s,enabled:{[d]:i,[h]:o}}}}}},XT=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:s,placement:n,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=wr(t,e),u={x:r,y:s},h=zr(n),d=Fh(h);let f=u[d],A=u[h];const g=wr(a,e),m=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const b=d==="y"?"height":"width",w=i.reference[d]-i.floating[b]+m.mainAxis,P=i.reference[d]+i.reference[b]-m.mainAxis;f<w?f=w:f>P&&(f=P)}if(c){var y,x;const b=d==="y"?"width":"height",w=["top","left"].includes(vr(n)),P=i.reference[h]-i.floating[b]+(w&&((y=o.offset)==null?void 0:y[h])||0)+(w?0:m.crossAxis),C=i.reference[h]+i.reference[b]+(w?0:((x=o.offset)==null?void 0:x[h])||0)-(w?m.crossAxis:0);A<P?A=P:A>C&&(A=C)}return{[d]:f,[h]:A}}}},QT=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,s;const{placement:n,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=wr(t,e),u=await si(e,c),h=vr(n),d=gn(n),f=zr(n)==="y",{width:A,height:g}=i.floating;let m,y;h==="top"||h==="bottom"?(m=h,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,m=d==="end"?"top":"bottom");const x=g-u.top-u.bottom,b=A-u.left-u.right,w=Nr(g-u[m],x),P=Nr(A-u[y],b),C=!e.middlewareData.shift;let E=w,B=P;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(B=b),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(E=x),C&&!d){const M=Tt(u.left,0),z=Tt(u.right,0),G=Tt(u.top,0),F=Tt(u.bottom,0);f?B=A-2*(M!==0||z!==0?M+z:Tt(u.left,u.right)):E=g-2*(G!==0||F!==0?G+F:Tt(u.top,u.bottom))}await l({...e,availableWidth:B,availableHeight:E});const j=await o.getDimensions(a.floating);return A!==j.width||g!==j.height?{reset:{rects:!0}}:{}}}};function ma(){return typeof window<"u"}function yn(t){return fb(t)?(t.nodeName||"").toLowerCase():"#document"}function It(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function hr(t){var e;return(e=(fb(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function fb(t){return ma()?t instanceof Node||t instanceof It(t).Node:!1}function Zt(t){return ma()?t instanceof Element||t instanceof It(t).Element:!1}function lr(t){return ma()?t instanceof HTMLElement||t instanceof It(t).HTMLElement:!1}function FA(t){return!ma()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof It(t).ShadowRoot}function qi(t){const{overflow:e,overflowX:r,overflowY:s,display:n}=Jt(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+r)&&!["inline","contents"].includes(n)}function ZT(t){return["table","td","th"].includes(yn(t))}function ga(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Uh(t){const e=Hh(),r=Zt(t)?Jt(t):t;return["transform","translate","scale","rotate","perspective"].some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(r.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(r.contain||"").includes(s))}function JT(t){let e=Fr(t);for(;lr(e)&&!rn(e);){if(Uh(e))return e;if(ga(e))return null;e=Fr(e)}return null}function Hh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function rn(t){return["html","body","#document"].includes(yn(t))}function Jt(t){return It(t).getComputedStyle(t)}function ya(t){return Zt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Fr(t){if(yn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||FA(t)&&t.host||hr(t);return FA(e)?e.host:e}function pb(t){const e=Fr(t);return rn(e)?t.ownerDocument?t.ownerDocument.body:t.body:lr(e)&&qi(e)?e:pb(e)}function ni(t,e,r){var s;e===void 0&&(e=[]),r===void 0&&(r=!0);const n=pb(t),i=n===((s=t.ownerDocument)==null?void 0:s.body),o=It(n);if(i){const a=qu(o);return e.concat(o,o.visualViewport||[],qi(n)?n:[],a&&r?ni(a):[])}return e.concat(n,ni(n,[],r))}function qu(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Ab(t){const e=Jt(t);let r=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const n=lr(t),i=n?t.offsetWidth:r,o=n?t.offsetHeight:s,a=Lo(r)!==i||Lo(s)!==o;return a&&(r=i,s=o),{width:r,height:s,$:a}}function $h(t){return Zt(t)?t:t.contextElement}function Ws(t){const e=$h(t);if(!lr(e))return ar(1);const r=e.getBoundingClientRect(),{width:s,height:n,$:i}=Ab(e);let o=(i?Lo(r.width):r.width)/s,a=(i?Lo(r.height):r.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const eR=ar(0);function mb(t){const e=It(t);return!Hh()||!e.visualViewport?eR:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function tR(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==It(t)?!1:e}function As(t,e,r,s){e===void 0&&(e=!1),r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=$h(t);let o=ar(1);e&&(s?Zt(s)&&(o=Ws(s)):o=Ws(t));const a=tR(i,r,s)?mb(i):ar(0);let l=(n.left+a.x)/o.x,c=(n.top+a.y)/o.y,u=n.width/o.x,h=n.height/o.y;if(i){const d=It(i),f=s&&Zt(s)?It(s):s;let A=d,g=qu(A);for(;g&&s&&f!==A;){const m=Ws(g),y=g.getBoundingClientRect(),x=Jt(g),b=y.left+(g.clientLeft+parseFloat(x.paddingLeft))*m.x,w=y.top+(g.clientTop+parseFloat(x.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,h*=m.y,l+=b,c+=w,A=It(g),g=qu(A)}}return Uo({width:u,height:h,x:l,y:c})}function Gh(t,e){const r=ya(t).scrollLeft;return e?e.left+r:As(hr(t)).left+r}function gb(t,e,r){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),n=s.left+e.scrollLeft-(r?0:Gh(t,s)),i=s.top+e.scrollTop;return{x:n,y:i}}function rR(t){let{elements:e,rect:r,offsetParent:s,strategy:n}=t;const i=n==="fixed",o=hr(s),a=e?ga(e.floating):!1;if(s===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=ar(1);const u=ar(0),h=lr(s);if((h||!h&&!i)&&((yn(s)!=="body"||qi(o))&&(l=ya(s)),lr(s))){const f=As(s);c=Ws(s),u.x=f.x+s.clientLeft,u.y=f.y+s.clientTop}const d=o&&!h&&!i?gb(o,l,!0):ar(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function sR(t){return Array.from(t.getClientRects())}function nR(t){const e=hr(t),r=ya(t),s=t.ownerDocument.body,n=Tt(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Tt(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+Gh(t);const a=-r.scrollTop;return Jt(s).direction==="rtl"&&(o+=Tt(e.clientWidth,s.clientWidth)-n),{width:n,height:i,x:o,y:a}}function iR(t,e){const r=It(t),s=hr(t),n=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(n){i=n.width,o=n.height;const c=Hh();(!c||c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:a,y:l}}function oR(t,e){const r=As(t,!0,e==="fixed"),s=r.top+t.clientTop,n=r.left+t.clientLeft,i=lr(t)?Ws(t):ar(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=n*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function LA(t,e,r){let s;if(e==="viewport")s=iR(t,r);else if(e==="document")s=nR(hr(t));else if(Zt(e))s=oR(e,r);else{const n=mb(t);s={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Uo(s)}function yb(t,e){const r=Fr(t);return r===e||!Zt(r)||rn(r)?!1:Jt(r).position==="fixed"||yb(r,e)}function aR(t,e){const r=e.get(t);if(r)return r;let s=ni(t,[],!1).filter(a=>Zt(a)&&yn(a)!=="body"),n=null;const i=Jt(t).position==="fixed";let o=i?Fr(t):t;for(;Zt(o)&&!rn(o);){const a=Jt(o),l=Uh(o);!l&&a.position==="fixed"&&(n=null),(i?!l&&!n:!l&&a.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||qi(o)&&!l&&yb(t,o))?s=s.filter(u=>u!==o):n=a,o=Fr(o)}return e.set(t,s),s}function lR(t){let{element:e,boundary:r,rootBoundary:s,strategy:n}=t;const o=[...r==="clippingAncestors"?ga(e)?[]:aR(e,this._c):[].concat(r),s],a=o[0],l=o.reduce((c,u)=>{const h=LA(e,u,n);return c.top=Tt(h.top,c.top),c.right=Nr(h.right,c.right),c.bottom=Nr(h.bottom,c.bottom),c.left=Tt(h.left,c.left),c},LA(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function cR(t){const{width:e,height:r}=Ab(t);return{width:e,height:r}}function uR(t,e,r){const s=lr(e),n=hr(e),i=r==="fixed",o=As(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ar(0);if(s||!s&&!i)if((yn(e)!=="body"||qi(n))&&(a=ya(e)),s){const d=As(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else n&&(l.x=Gh(n));const c=n&&!s&&!i?gb(n,a):ar(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function rc(t){return Jt(t).position==="static"}function DA(t,e){if(!lr(t)||Jt(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return hr(t)===r&&(r=r.ownerDocument.body),r}function xb(t,e){const r=It(t);if(ga(t))return r;if(!lr(t)){let n=Fr(t);for(;n&&!rn(n);){if(Zt(n)&&!rc(n))return n;n=Fr(n)}return r}let s=DA(t,e);for(;s&&ZT(s)&&rc(s);)s=DA(s,e);return s&&rn(s)&&rc(s)&&!Uh(s)?r:s||JT(t)||r}const hR=async function(t){const e=this.getOffsetParent||xb,r=this.getDimensions,s=await r(t.floating);return{reference:uR(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function dR(t){return Jt(t).direction==="rtl"}const fR={convertOffsetParentRelativeRectToViewportRelativeRect:rR,getDocumentElement:hr,getClippingRect:lR,getOffsetParent:xb,getElementRects:hR,getClientRects:sR,getDimensions:cR,getScale:Ws,isElement:Zt,isRTL:dR};function bb(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function pR(t,e){let r=null,s;const n=hr(t);function i(){var a;clearTimeout(s),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const A=eo(h),g=eo(n.clientWidth-(u+d)),m=eo(n.clientHeight-(h+f)),y=eo(u),b={rootMargin:-A+"px "+-g+"px "+-m+"px "+-y+"px",threshold:Tt(0,Nr(1,l))||1};let w=!0;function P(C){const E=C[0].intersectionRatio;if(E!==l){if(!w)return o();E?o(!1,E):s=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!bb(c,t.getBoundingClientRect())&&o(),w=!1}try{r=new IntersectionObserver(P,{...b,root:n.ownerDocument})}catch{r=new IntersectionObserver(P,b)}r.observe(t)}return o(!0),i}function AR(t,e,r,s){s===void 0&&(s={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=$h(t),u=n||i?[...c?ni(c):[],...ni(e)]:[];u.forEach(y=>{n&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const h=c&&a?pR(c,r):null;let d=-1,f=null;o&&(f=new ResizeObserver(y=>{let[x]=y;x&&x.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let A,g=l?As(t):null;l&&m();function m(){const y=As(t);g&&!bb(g,y)&&r(),g=y,A=requestAnimationFrame(m)}return r(),()=>{var y;u.forEach(x=>{n&&x.removeEventListener("scroll",r),i&&x.removeEventListener("resize",r)}),h?.(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(A)}}const mR=YT,gR=KT,yR=$T,xR=QT,bR=GT,UA=HT,qR=XT,wR=(t,e,r)=>{const s=new Map,n={platform:fR,...r},i={...n.platform,_c:s};return UT(t,e,{...n,platform:i})};var bo=typeof document<"u"?v.useLayoutEffect:v.useEffect;function Ho(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,s,n;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(s=r;s--!==0;)if(!Ho(t[s],e[s]))return!1;return!0}if(n=Object.keys(t),r=n.length,r!==Object.keys(e).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(e,n[s]))return!1;for(s=r;s--!==0;){const i=n[s];if(!(i==="_owner"&&t.$$typeof)&&!Ho(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function qb(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function HA(t,e){const r=qb(t);return Math.round(e*r)/r}function sc(t){const e=v.useRef(t);return bo(()=>{e.current=t}),e}function vR(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:s=[],platform:n,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=v.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=v.useState(s);Ho(d,s)||f(s);const[A,g]=v.useState(null),[m,y]=v.useState(null),x=v.useCallback(k=>{k!==C.current&&(C.current=k,g(k))},[]),b=v.useCallback(k=>{k!==E.current&&(E.current=k,y(k))},[]),w=i||A,P=o||m,C=v.useRef(null),E=v.useRef(null),B=v.useRef(u),j=l!=null,M=sc(l),z=sc(n),G=sc(c),F=v.useCallback(()=>{if(!C.current||!E.current)return;const k={placement:e,strategy:r,middleware:d};z.current&&(k.platform=z.current),wR(C.current,E.current,k).then(S=>{const V={...S,isPositioned:G.current!==!1};L.current&&!Ho(B.current,V)&&(B.current=V,pa.flushSync(()=>{h(V)}))})},[d,e,r,z,G]);bo(()=>{c===!1&&B.current.isPositioned&&(B.current.isPositioned=!1,h(k=>({...k,isPositioned:!1})))},[c]);const L=v.useRef(!1);bo(()=>(L.current=!0,()=>{L.current=!1}),[]),bo(()=>{if(w&&(C.current=w),P&&(E.current=P),w&&P){if(M.current)return M.current(w,P,F);F()}},[w,P,F,M,j]);const Q=v.useMemo(()=>({reference:C,floating:E,setReference:x,setFloating:b}),[x,b]),q=v.useMemo(()=>({reference:w,floating:P}),[w,P]),_=v.useMemo(()=>{const k={position:r,left:0,top:0};if(!q.floating)return k;const S=HA(q.floating,u.x),V=HA(q.floating,u.y);return a?{...k,transform:"translate("+S+"px, "+V+"px)",...qb(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:S,top:V}},[r,a,q.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:F,refs:Q,elements:q,floatingStyles:_}),[u,F,Q,q,_])}const VR=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:n}=typeof t=="function"?t(r):t;return s&&e(s)?s.current!=null?UA({element:s.current,padding:n}).fn(r):{}:s?UA({element:s,padding:n}).fn(r):{}}}},_R=(t,e)=>({...mR(t),options:[t,e]}),kR=(t,e)=>({...gR(t),options:[t,e]}),SR=(t,e)=>({...qR(t),options:[t,e]}),CR=(t,e)=>({...yR(t),options:[t,e]}),PR=(t,e)=>({...xR(t),options:[t,e]}),ER=(t,e)=>({...bR(t),options:[t,e]}),TR=(t,e)=>({...VR(t),options:[t,e]});var RR="Arrow",wb=v.forwardRef((t,e)=>{const{children:r,width:s=10,height:n=5,...i}=t;return p.jsx(Hr.svg,{...i,ref:e,width:s,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});wb.displayName=RR;var MR=wb;function IR(t){const[e,r]=v.useState(void 0);return Or(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const i=n[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),e}var Wh="Popper",[vb,Vb]=ab(Wh),[jR,_b]=vb(Wh),kb=t=>{const{__scopePopper:e,children:r}=t,[s,n]=v.useState(null);return p.jsx(jR,{scope:e,anchor:s,onAnchorChange:n,children:r})};kb.displayName=Wh;var Sb="PopperAnchor",Cb=v.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:s,...n}=t,i=_b(Sb,r),o=v.useRef(null),a=bs(e,o);return v.useEffect(()=>{i.onAnchorChange(s?.current||o.current)}),s?null:p.jsx(Hr.div,{...n,ref:a})});Cb.displayName=Sb;var Yh="PopperContent",[BR,OR]=vb(Yh),Pb=v.forwardRef((t,e)=>{const{__scopePopper:r,side:s="bottom",sideOffset:n=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:A,...g}=t,m=_b(Yh,r),[y,x]=v.useState(null),b=bs(e,Z=>x(Z)),[w,P]=v.useState(null),C=IR(w),E=C?.width??0,B=C?.height??0,j=s+(i!=="center"?"-"+i:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},z=Array.isArray(c)?c:[c],G=z.length>0,F={padding:M,boundary:z.filter(zR),altBoundary:G},{refs:L,floatingStyles:Q,placement:q,isPositioned:_,middlewareData:k}=vR({strategy:"fixed",placement:j,whileElementsMounted:(...Z)=>AR(...Z,{animationFrame:f==="always"}),elements:{reference:m.anchor},middleware:[_R({mainAxis:n+B,alignmentAxis:o}),l&&kR({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?SR():void 0,...F}),l&&CR({...F}),PR({...F,apply:({elements:Z,rects:te,availableWidth:ye,availableHeight:ne})=>{const{width:Ht,height:lt}=te.reference,ct=Z.floating.style;ct.setProperty("--radix-popper-available-width",`${ye}px`),ct.setProperty("--radix-popper-available-height",`${ne}px`),ct.setProperty("--radix-popper-anchor-width",`${Ht}px`),ct.setProperty("--radix-popper-anchor-height",`${lt}px`)}}),w&&TR({element:w,padding:a}),FR({arrowWidth:E,arrowHeight:B}),d&&ER({strategy:"referenceHidden",...F})]}),[S,V]=Rb(q),T=Aa(A);Or(()=>{_&&T?.()},[_,T]);const R=k.arrow?.x,I=k.arrow?.y,O=k.arrow?.centerOffset!==0,[D,ee]=v.useState();return Or(()=>{y&&ee(window.getComputedStyle(y).zIndex)},[y]),p.jsx("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...Q,transform:_?Q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:D,"--radix-popper-transform-origin":[k.transformOrigin?.x,k.transformOrigin?.y].join(" "),...k.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(BR,{scope:r,placedSide:S,onArrowChange:P,arrowX:R,arrowY:I,shouldHideArrow:O,children:p.jsx(Hr.div,{"data-side":S,"data-align":V,...g,ref:b,style:{...g.style,animation:_?void 0:"none"}})})})});Pb.displayName=Yh;var Eb="PopperArrow",NR={top:"bottom",right:"left",bottom:"top",left:"right"},Tb=v.forwardRef(function(e,r){const{__scopePopper:s,...n}=e,i=OR(Eb,s),o=NR[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(MR,{...n,ref:r,style:{...n.style,display:"block"}})})});Tb.displayName=Eb;function zR(t){return t!==null}var FR=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:s,middlewareData:n}=e,o=n.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Rb(r),h={start:"0%",center:"50%",end:"100%"}[u],d=(n.arrow?.x??0)+a/2,f=(n.arrow?.y??0)+l/2;let A="",g="";return c==="bottom"?(A=o?h:`${d}px`,g=`${-l}px`):c==="top"?(A=o?h:`${d}px`,g=`${s.floating.height+l}px`):c==="right"?(A=`${-l}px`,g=o?h:`${f}px`):c==="left"&&(A=`${s.floating.width+l}px`,g=o?h:`${f}px`),{data:{x:A,y:g}}}});function Rb(t){const[e,r="center"]=t.split("-");return[e,r]}var LR=kb,DR=Cb,UR=Pb,HR=Tb,$R="Portal",Mb=v.forwardRef((t,e)=>{const{container:r,...s}=t,[n,i]=v.useState(!1);Or(()=>i(!0),[]);const o=r||n&&globalThis?.document?.body;return o?RE.createPortal(p.jsx(Hr.div,{...s,ref:e}),o):null});Mb.displayName=$R;function GR(t,e){return v.useReducer((r,s)=>e[r][s]??r,t)}var Kh=t=>{const{present:e,children:r}=t,s=WR(e),n=typeof r=="function"?r({present:s.isPresent}):v.Children.only(r),i=bs(s.ref,YR(n));return typeof r=="function"||s.isPresent?v.cloneElement(n,{ref:i}):null};Kh.displayName="Presence";function WR(t){const[e,r]=v.useState(),s=v.useRef(null),n=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=GR(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const c=to(s.current);i.current=a==="mounted"?c:"none"},[a]),Or(()=>{const c=s.current,u=n.current;if(u!==t){const d=i.current,f=to(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,l]),Or(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const g=to(s.current).includes(f.animationName);if(f.target===e&&g&&(l("ANIMATION_END"),!n.current)){const m=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=m)})}},d=f=>{f.target===e&&(i.current=to(s.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(c=>{s.current=c?getComputedStyle(c):null,r(c)},[])}}function to(t){return t?.animationName||"none"}function YR(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var KR=Bu[" useInsertionEffect ".trim().toString()]||Or;function XR({prop:t,defaultProp:e,onChange:r=()=>{},caller:s}){const[n,i,o]=QR({defaultProp:e,onChange:r}),a=t!==void 0,l=a?t:n;{const u=v.useRef(t!==void 0);v.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,s])}const c=v.useCallback(u=>{if(a){const h=ZR(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function QR({defaultProp:t,onChange:e}){const[r,s]=v.useState(t),n=v.useRef(r),i=v.useRef(e);return KR(()=>{i.current=e},[e]),v.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}function ZR(t){return typeof t=="function"}var JR=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),eM="VisuallyHidden",Ib=v.forwardRef((t,e)=>p.jsx(Hr.span,{...t,ref:e,style:{...JR,...t.style}}));Ib.displayName=eM;var tM=Ib,[xa,oz]=ab("Tooltip",[Vb]),ba=Vb(),rM="TooltipProvider",wu="tooltip.open",[az,Xh]=xa(rM),ii="Tooltip",[sM,wi]=xa(ii),jb=t=>{const{__scopeTooltip:e,children:r,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=Xh(ii,t.__scopeTooltip),c=ba(e),[u,h]=v.useState(null),d=IT(),f=v.useRef(0),A=o??l.disableHoverableContent,g=a??l.delayDuration,m=v.useRef(!1),[y,x]=XR({prop:s,defaultProp:n??!1,onChange:E=>{E?(l.onOpen(),document.dispatchEvent(new CustomEvent(wu))):l.onClose(),i?.(E)},caller:ii}),b=v.useMemo(()=>y?m.current?"delayed-open":"instant-open":"closed",[y]),w=v.useCallback(()=>{window.clearTimeout(f.current),f.current=0,m.current=!1,x(!0)},[x]),P=v.useCallback(()=>{window.clearTimeout(f.current),f.current=0,x(!1)},[x]),C=v.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{m.current=!0,x(!0),f.current=0},g)},[g,x]);return v.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),p.jsx(LR,{...c,children:p.jsx(sM,{scope:e,contentId:d,open:y,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:v.useCallback(()=>{l.isOpenDelayedRef.current?C():w()},[l.isOpenDelayedRef,C,w]),onTriggerLeave:v.useCallback(()=>{A?P():(window.clearTimeout(f.current),f.current=0)},[P,A]),onOpen:w,onClose:P,disableHoverableContent:A,children:r})})};jb.displayName=ii;var vu="TooltipTrigger",Bb=v.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=wi(vu,r),i=Xh(vu,r),o=ba(r),a=v.useRef(null),l=bs(e,a,n.onTriggerChange),c=v.useRef(!1),u=v.useRef(!1),h=v.useCallback(()=>c.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),p.jsx(DR,{asChild:!0,...o,children:p.jsx(Hr.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:l,onPointerMove:gr(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:gr(t.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:gr(t.onPointerDown,()=>{n.open&&n.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:gr(t.onFocus,()=>{c.current||n.onOpen()}),onBlur:gr(t.onBlur,n.onClose),onClick:gr(t.onClick,n.onClose)})})});Bb.displayName=vu;var Qh="TooltipPortal",[nM,iM]=xa(Qh,{forceMount:void 0}),Ob=t=>{const{__scopeTooltip:e,forceMount:r,children:s,container:n}=t,i=wi(Qh,e);return p.jsx(nM,{scope:e,forceMount:r,children:p.jsx(Kh,{present:r||i.open,children:p.jsx(Mb,{asChild:!0,container:n,children:s})})})};Ob.displayName=Qh;var sn="TooltipContent",Nb=v.forwardRef((t,e)=>{const r=iM(sn,t.__scopeTooltip),{forceMount:s=r.forceMount,side:n="top",...i}=t,o=wi(sn,t.__scopeTooltip);return p.jsx(Kh,{present:s||o.open,children:o.disableHoverableContent?p.jsx(zb,{side:n,...i,ref:e}):p.jsx(oM,{side:n,...i,ref:e})})}),oM=v.forwardRef((t,e)=>{const r=wi(sn,t.__scopeTooltip),s=Xh(sn,t.__scopeTooltip),n=v.useRef(null),i=bs(e,n),[o,a]=v.useState(null),{trigger:l,onClose:c}=r,u=n.current,{onPointerInTransitChange:h}=s,d=v.useCallback(()=>{a(null),h(!1)},[h]),f=v.useCallback((A,g)=>{const m=A.currentTarget,y={x:A.clientX,y:A.clientY},x=hM(y,m.getBoundingClientRect()),b=dM(y,x),w=fM(g.getBoundingClientRect()),P=AM([...b,...w]);a(P),h(!0)},[h]);return v.useEffect(()=>()=>d(),[d]),v.useEffect(()=>{if(l&&u){const A=m=>f(m,u),g=m=>f(m,l);return l.addEventListener("pointerleave",A),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",A),u.removeEventListener("pointerleave",g)}}},[l,u,f,d]),v.useEffect(()=>{if(o){const A=g=>{const m=g.target,y={x:g.clientX,y:g.clientY},x=l?.contains(m)||u?.contains(m),b=!pM(y,o);x?d():b&&(d(),c())};return document.addEventListener("pointermove",A),()=>document.removeEventListener("pointermove",A)}},[l,u,o,c,d]),p.jsx(zb,{...t,ref:i})}),[aM,lM]=xa(ii,{isInside:!1}),cM=yT("TooltipContent"),zb=v.forwardRef((t,e)=>{const{__scopeTooltip:r,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=wi(sn,r),c=ba(r),{onClose:u}=l;return v.useEffect(()=>(document.addEventListener(wu,u),()=>document.removeEventListener(wu,u)),[u]),v.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),p.jsx(ub,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:p.jsxs(UR,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(cM,{children:s}),p.jsx(aM,{scope:r,isInside:!0,children:p.jsx(tM,{id:l.contentId,role:"tooltip",children:n||s})})]})})});Nb.displayName=sn;var Fb="TooltipArrow",uM=v.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=ba(r);return lM(Fb,r).isInside?null:p.jsx(HR,{...n,...s,ref:e})});uM.displayName=Fb;function hM(t,e){const r=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,s,n,i)){case i:return"left";case n:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function dM(t,e,r=5){const s=[];switch(e){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function fM(t){const{top:e,right:r,bottom:s,left:n}=t;return[{x:n,y:e},{x:r,y:e},{x:r,y:s},{x:n,y:s}]}function pM(t,e){const{x:r,y:s}=t;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>s!=d>s&&r<(h-c)*(s-u)/(d-u)+c&&(n=!n)}return n}function AM(t){const e=t.slice();return e.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),mM(e)}function mM(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const n=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const r=[];for(let s=t.length-1;s>=0;s--){const n=t[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var gM=jb;const yM=({triggerContent:t,tooltipContent:e})=>e?p.jsxs(gM,{children:[p.jsx(Bb,{asChild:!0,children:t}),p.jsx(Ob,{children:p.jsx(Hs,{scaleFactor:2,children:p.jsx(Nb,{side:"bottom",align:"end",className:"bg-highlightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?p.jsx("div",{className:"max-w-16",children:p.jsx(ot,{markdown:e})}):e})})})]}):t,Lb=t=>t.replace(/ArrowLeft/g,"").replace(/ArrowRight/g,"").replace(/ArrowUp/g,"").replace(/ArrowDown/g,""),xM=t=>{const e=t.map(Lb);return e.length===1?`

Hotkey: **${e[0]}**`:`

Hotkeys: ${e.map(r=>`**${r}**`).join(" or ")}`},bM=(t,e)=>{if(!e)return t;if(t)return`${t}${xM(e)}`;const r=e.map(Lb);return r.length===1?`Hotkey: **${r[0]}**`:`Hotkeys: ${r.map(s=>`**${s}**`).join(" or ")}`},Pr=({className:t,value:e,onChange:r,trueLabel:s="ON",falseLabel:n="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(s.length,n.length)+1,c=s.padStart(l," "),u=n.padEnd(l," ");pT(o,!1,()=>{r?.(!e,void 0)});const h=p.jsxs("span",{onClick:f=>r?.(!e,f),className:hT("inline-flex justify-between",t),children:[i&&p.jsx(N,{className:"inline-block mr-1 text-lightGrey",noSlitWords:!0,children:i}),p.jsx(N,{className:ib("inline-block w-min h-min",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),d=bM(typeof a=="string"?a:void 0,o)??a;return p.jsx(yM,{triggerContent:h,tooltipContent:d})},Zh="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",Jh="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",nc="[&_.em]:text-lightBeige zx:[&_.em]:text-zxCyan",qM=`![](texture-animated-head_walking_towards?float-right)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,wM=`pokes cant be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,vM="everything to *select the keys* and other input settings",VM=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:U(De)}),p.jsx(Ee,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsx(xs.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+Jh,children:[Dt()&&p.jsx(bi,{className:"text-highlightBeige"}),p.jsx(N,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),p.jsxs(Ie,{className:Zh,children:[p.jsx(X,{id:"controlOptions",label:"Control options",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"controlOptions"),hint:p.jsx(ot,{className:nc,markdown:vM})}),p.jsx(X,{id:"sound",label:"Sound options",doubleHeightWhenFocussed:!0,onSelect:U(Rt,"sound")}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:p.jsx(Pr,{value:!lh()}),onSelect:U(Kt,"userSettings.displaySettings.uncolourised"),hint:p.jsx(ot,{className:nc,markdown:qM})}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"livesModel",label:" Lives poke",hint:p.jsx(ot,{className:nc,markdown:wM}),valueElement:p.jsx(Pr,{value:le(gy)}),onSelect:U(Kt,"userSettings.infiniteLivesPoke"),disabled:Zs()}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"infiniteDoughnutsPoke",label:" doughnuts poke",valueElement:p.jsx(Pr,{value:le(yy)}),onSelect:U(Kt,"userSettings.infiniteDoughnutsPoke"),disabled:Zs()}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"showFps",label:"Show FPS",valueElement:p.jsx(Pr,{value:le(V0)}),onSelect:U(Kt,"userSettings.showFps"),hint:"show frame rate (frames per second) in the top-right corner"}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"crtFilter",label:"CRT TV effect",valueElement:p.jsx(Pr,{value:le(S0)}),onSelect:U(Kt,"userSettings.displaySettings.crtFilter"),hint:"Subtle screen glow a bit like an old tv"}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:U(Rt,"emulatedResolution")}),p.jsx(xi,{}),Dt()||p.jsx(rr,{})]}),Dt()||p.jsx(mn,{className:"text-moss zx:text-zxGreen"})]})})})]}),$A="text-pink zx:text-zxCyan",_M=()=>{const t=le(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:p.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${ve} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[p.jsx(N,{children:"Press "}),p.jsx(zh,{className:`inline ${$A}`,action:"menu_openOrExit",keyClassName:"me-1"}),p.jsx(N,{children:"when done selecting keys for "}),p.jsx(N,{className:$A,children:t})]})},kM="**world**: Control is relative to directions in the isometric world",SM=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but requires inputting diagonals a lot`,CM=({className:t})=>p.jsxs("span",{children:[p.jsx(N,{className:Xe("text-nowrap me-1","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:jo()?"screen":"world"}),p.jsx(N,{className:Xe("text-nowrap","text-moss zx:text-zxBlue selectedMenuItem:text-mossHalfbrite zx:selectedMenuItem:text-zxBlue",t),children:jo()?"   ":"   "})]}),PM=()=>{const t=jo();return p.jsx(X,{id:"screenRelativeControl",label:"input axes",leader:p.jsx("span",{className:`${Ge} ${t?"texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections":"texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_worldDirections"}`}),valueElement:p.jsx(CM,{}),onSelect:U(Kt,"userSettings.screenRelativeControl"),hintInline:!0,hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:t?SM:kM})})},Db="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",EM="**4-way**: true to the 1987 original - move in x directions only",TM="**8-way**: the original with *4-way* movement, plus *diagonals*",RM="**analogue**: move in *any* direction with analogue stick",MM=()=>{const t=xy();return p.jsx(X,{id:"analogueControl",label:"Directions",leader:p.jsx("span",{className:`${Ge} texture-joystick`}),valueElement:p.jsx(N,{className:Db,children:t}),onSelect:U(I_),hintInline:!0,hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:t==="analogue"?RM:t==="8-way"?TM:EM})})},kt=({className:t,action:e})=>{const r=le(s=>s.gameMenus.assigningInput?.action===e);return p.jsx(zh,{className:Xe("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:Db,flashingCursor:r})},IM=({className:t})=>{const e=le(v0);return p.jsx(N,{className:Xe("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},jM=()=>{const t=jo();return p.jsxs(p.Fragment,{children:[p.jsx(X,{id:"preset",label:p.jsx(N,{className:`inline-block w-6 ${ve}`,children:"key/ button preset"}),valueElement:p.jsx(IM,{}),onSelect:U(Rt,"inputPreset")}),p.jsx(X,{id:"left",label:`Left ${t?"":""}`,leader:p.jsx("span",{className:`${Ge} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:p.jsx(kt,{action:"left"}),onSelect:U(Vt,"left")}),p.jsx(X,{id:"right",label:`Right ${t?"":""}`,leader:p.jsx("span",{className:`${Ge} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:p.jsx(kt,{action:"right"}),onSelect:U(Vt,"right")}),p.jsx(X,{id:"up",label:`Up ${t?"":""}`,leader:p.jsx("span",{className:`${Ge} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:p.jsx(kt,{action:"away"}),onSelect:U(Vt,"away")}),p.jsx(X,{id:"down",label:`Down ${t?"":""}`,leader:p.jsx("span",{className:`${Ge} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:p.jsx(kt,{action:"towards"}),onSelect:U(Vt,"towards")}),p.jsxs("div",{className:`${ve} col-span-3`,children:[p.jsx(N,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),p.jsx(N,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),p.jsx(X,{id:"jump",label:"Jump",leader:p.jsx("span",{className:`${Ge} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:p.jsx(kt,{action:"jump"}),onSelect:U(Vt,"jump")}),p.jsx(X,{id:"carry",label:"Carry",leader:p.jsx("span",{className:`${Ge} texture-bag`}),valueElement:p.jsx(kt,{action:"carry"}),onSelect:U(Vt,"carry"),hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:"**carrying is heels only**. requires the bag"}),hintInline:!0}),p.jsx(X,{id:"fire",label:p.jsx(N,{className:`inline-block w-6 ${ve}`,children:"fire dough- nuts"}),leader:p.jsx("span",{className:`${Ge} texture-doughnuts`}),hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:"**firing doughnuts is head only**. requires the hooter"}),hintInline:!0,valueElement:p.jsx(kt,{action:"fire"}),onSelect:U(Vt,"fire")}),p.jsx(X,{id:"swop",label:"Swop",valueElement:p.jsx(kt,{action:"swop"}),onSelect:U(Vt,"swop"),hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:p.jsxs("span",{className:`${Ge} texture-blank relative overflow-hidden`,children:[p.jsx("span",{className:`${Ge} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),p.jsx("span",{className:`${Ge} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),p.jsx(X,{id:"swopHead",label:p.jsx(N,{className:`inline-block w-6 ${ve}`,children:"Swop to head"}),valueElement:p.jsx(kt,{action:"swop.head"}),onSelect:U(Vt,"swop.head"),hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Ge} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),p.jsx(X,{id:"swopHeels",label:p.jsxs("div",{className:`w-6 ${ve}`,children:[p.jsx(N,{className:"me-1",children:"Swop to"}),p.jsx(N,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:p.jsx(kt,{action:"swop.heels"}),onSelect:U(Vt,"swop.heels"),hint:p.jsx(ot,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Ge} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),p.jsx(X,{id:"map",label:"Map",valueElement:p.jsx(kt,{action:"map"}),onSelect:U(Vt,"map"),leader:p.jsx("span",{className:`${Ge} texture-scroll`})}),p.jsx(X,{id:"hold",label:"Pause",valueElement:p.jsx(kt,{action:"hold"}),onSelect:U(Vt,"hold")}),p.jsx(X,{id:"toggleColourisation",label:p.jsx(N,{className:`inline-block w-6 ${ve}`,children:"toggle colour- isation"}),valueElement:p.jsx(kt,{action:"toggleColourisation"}),onSelect:U(Vt,"toggleColourisation")})]})},BM=()=>p.jsx(X,{id:"controlOptions",label:"on-screen controls",valueElement:p.jsx(Pr,{value:j0()}),onSelect:U(Kt,"userSettings.onScreenControls")}),OM=()=>{const t=!my();dt({action:"menu_openOrExit",handler:v.useCallback(()=>{ke.dispatch(P_())},[]),disabled:t}),NP({handler:v.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&Ay(ke.getState())&&ke.dispatch(T_(e))},[]),disabled:t})},NM=({showAll:t})=>p.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[p.jsx(N,{className:`block mb-1 ${ve}`,children:"Detected that you are on a phone or tablet"}),p.jsx(N,{className:`block mb-1 ${ve}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),p.jsx(N,{className:`block mb-1 text-midRed zx:text-zxRed ${ve} mb-1`,onClick:t,children:"Tap here to show all settings"})]}),GA=Zh+" !gap-y-1 !sprites-normal-height",zM=()=>{OM();const[t,e]=v.useState(!Dt()),r=xy();return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:U(De)}),p.jsxs(Ee,{tall:!0,wide:!0,className:"bg-white zx:bg-zxWhite pr-0 pl-1",children:[p.jsxs("div",{className:"flex flex-col gap-y-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+Jh,children:[Dt()&&p.jsx(bi,{className:"mb-1"}),p.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block",children:"control options"}),p.jsxs(Ie,{className:GA,children:[p.jsx(MM,{}),p.jsx(BM,{}),r!=="4-way"&&t&&p.jsx(PM,{})]}),t?p.jsxs(p.Fragment,{children:[p.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),p.jsxs(Ie,{className:GA,children:[p.jsx(jM,{}),Dt()||p.jsx(rr,{})]})]}):p.jsx(p.Fragment,{children:p.jsx(NM,{showAll:()=>e(!0)})})]}),p.jsx(_M,{})]})]})},FM=({presetName:t})=>p.jsx(X,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:Ks[t].description,onSelect:U(R_,t)},t),LM=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:U(De)}),p.jsx(Ee,{className:"bg-white pl-1",children:p.jsxs(xs.Provider,{children:[p.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),p.jsxs(Ie,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[Rg(Ks).map(t=>p.jsx(FM,{presetName:t},t)),p.jsx(xi,{}),p.jsx(rr,{})]}),p.jsx(mn,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),DM=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsx(Ee,{className:"bg-pureBlack w-zx h-full block p-0",onClick:U(De),children:p.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[p.jsxs("div",{className:"flex gap-7",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),p.jsxs("div",{className:"flex flex-col items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_walking_towards_2 hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),p.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[p.jsx(N,{children:"The people salute your heroism"}),p.jsx(N,{children:"and proclaim you"})]}),p.jsx(N,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),p.jsx(Ie,{className:"hidden",children:p.jsx(rr,{})})]})})]}),UM=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),HM=({resolutionName:t})=>{const e=le(oa),r=cn[t];return p.jsx(X,{id:t,label:`${e===t?"* ":""}${UM(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:U(xh,t)},t)},$M=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:U(De)}),p.jsx(Ee,{className:"bg-white pl-1",children:p.jsxs(xs.Provider,{children:[p.jsx(N,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),p.jsxs(Ie,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[Rg(cn).map(t=>p.jsx(HM,{resolutionName:t})),p.jsx(xi,{}),p.jsx(rr,{})]}),p.jsx(mn,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),GM="/Users/jim/dev/hohjs",WM=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),s=[...t.matchAll(e)],n=[];return r.forEach((i,o)=>{n.push(i);const a=s[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){n.push(l);return}const u=`${GM}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),d=h?`:${h[1]}:${h[2]}`:"",f=`vscode://file${u}${d}`;n.push(p.jsx("a",{href:f,target:"_blank",children:c.pathname},o))}catch{n.push(a[0])}}),p.jsx(v.Fragment,{children:n})},YM=t=>{const{message:e,stack:r}=t;if(!r)return{message:e,sanitizedStack:""};const s=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,n=s.test(r);let i=r;n&&(i=i.replace(s,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},KM=`##The game crashed!
You could:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord server](https://discord.gg/XmV9QNWY)
* play [the msx remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,XM=({errors:t})=>{const e=le(o=>o.gameMenus.reincarnationPoint!==void 0),[r,s]=v.useState(!1),n=U(Ty),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=YM(o);return`
${a}

${l}
  `}).join(`
    

 ERROR        CAUGHT, WRAPPED, & RETHROWN 


`);return p.jsxs(Ue,{children:[p.jsx(tt,{className:"loading-border"}),p.jsx(Ee,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,children:p.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[p.jsx(ot,{markdown:KM}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsxs(Ie,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${ve}`,children:[p.jsx(X,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:U(rp,"ignore")}),e&&p.jsx(X,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:n}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:U(rp,"clearAllData")}),r?p.jsx(N,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):p.jsx(X,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>s(!0))})]}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsx(N,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),p.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max",children:p.jsx(WM,{children:i})})]})})]})};var ic,WA;function ed(){if(WA)return ic;WA=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return ic=t,ic}var oc,YA;function QM(){if(YA)return oc;YA=1;var t=typeof Vi=="object"&&Vi&&Vi.Object===Object&&Vi;return oc=t,oc}var ac,KA;function Ub(){if(KA)return ac;KA=1;var t=QM(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return ac=r,ac}var lc,XA;function ZM(){if(XA)return lc;XA=1;var t=Ub(),e=function(){return t.Date.now()};return lc=e,lc}var cc,QA;function JM(){if(QA)return cc;QA=1;var t=/\s/;function e(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return cc=e,cc}var uc,ZA;function eI(){if(ZA)return uc;ZA=1;var t=JM(),e=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(e,"")}return uc=r,uc}var hc,JA;function Hb(){if(JA)return hc;JA=1;var t=Ub(),e=t.Symbol;return hc=e,hc}var dc,em;function tI(){if(em)return dc;em=1;var t=Hb(),e=Object.prototype,r=e.hasOwnProperty,s=e.toString,n=t?t.toStringTag:void 0;function i(o){var a=r.call(o,n),l=o[n];try{o[n]=void 0;var c=!0}catch{}var u=s.call(o);return c&&(a?o[n]=l:delete o[n]),u}return dc=i,dc}var fc,tm;function rI(){if(tm)return fc;tm=1;var t=Object.prototype,e=t.toString;function r(s){return e.call(s)}return fc=r,fc}var pc,rm;function sI(){if(rm)return pc;rm=1;var t=Hb(),e=tI(),r=rI(),s="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?n:s:i&&i in Object(a)?e(a):r(a)}return pc=o,pc}var Ac,sm;function nI(){if(sm)return Ac;sm=1;function t(e){return e!=null&&typeof e=="object"}return Ac=t,Ac}var mc,nm;function iI(){if(nm)return mc;nm=1;var t=sI(),e=nI(),r="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&t(n)==r}return mc=s,mc}var gc,im;function oI(){if(im)return gc;im=1;var t=eI(),e=ed(),r=iI(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return s;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):n.test(c)?s:+c}return gc=l,gc}var yc,om;function $b(){if(om)return yc;om=1;var t=ed(),e=ZM(),r=oI(),s="Expected a function",n=Math.max,i=Math.min;function o(a,l,c){var u,h,d,f,A,g,m=0,y=!1,x=!1,b=!0;if(typeof a!="function")throw new TypeError(s);l=r(l)||0,t(c)&&(y=!!c.leading,x="maxWait"in c,d=x?n(r(c.maxWait)||0,l):d,b="trailing"in c?!!c.trailing:b);function w(F){var L=u,Q=h;return u=h=void 0,m=F,f=a.apply(Q,L),f}function P(F){return m=F,A=setTimeout(B,l),y?w(F):f}function C(F){var L=F-g,Q=F-m,q=l-L;return x?i(q,d-Q):q}function E(F){var L=F-g,Q=F-m;return g===void 0||L>=l||L<0||x&&Q>=d}function B(){var F=e();if(E(F))return j(F);A=setTimeout(B,C(F))}function j(F){return A=void 0,b&&u?w(F):(u=h=void 0,f)}function M(){A!==void 0&&clearTimeout(A),m=0,u=g=h=A=void 0}function z(){return A===void 0?f:j(e())}function G(){var F=e(),L=E(F);if(u=arguments,h=this,g=F,L){if(A===void 0)return P(g);if(x)return clearTimeout(A),A=setTimeout(B,l),w(g)}return A===void 0&&(A=setTimeout(B,l)),f}return G.cancel=M,G.flush=z,G}return yc=o,yc}var aI=$b();const lI=Qe(aI);var xc,am;function cI(){if(am)return xc;am=1;var t=$b(),e=ed(),r="Expected a function";function s(n,i,o){var a=!0,l=!0;if(typeof n!="function")throw new TypeError(r);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(n,i,{leading:a,maxWait:i,trailing:l})}return xc=s,xc}var uI=cI();const hI=Qe(uI),dI=(t,e,r,s)=>{switch(e){case"debounce":return lI(t,r,s);case"throttle":return hI(t,r,s);default:return t}},fI=t=>{const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...r)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...r)},[])},pI=t=>{const[e,r]=v.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:v.useMemo(()=>new Proxy(n=>{n!==e&&r(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,o){return i==="current"?r(o):n[i]=o,!0}}),[e]),refElement:e,setRefElement:r}},AI=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function mI({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:s,handleWidth:n=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=v.useRef(t),u=fI(l),[h,d]=v.useState({width:void 0,height:void 0}),{refProxy:f,refElement:A}=pI(o),{box:g}=a||{},m=v.useCallback(x=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const b=(w,P)=>n&&w.width!==P.width||i&&w.height!==P.height;x.forEach(w=>{const P=AI(w,g);d(C=>b(C,P)?(u?.({width:P.width,height:P.height,entry:w}),P):C)})},[n,i,c,g]),y=v.useCallback(dI(m,e,r,s),[m,e,r,s]);return v.useEffect(()=>{let x;return A?(x=new window.ResizeObserver(y),x.observe(A,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),d({width:void 0,height:void 0})),()=>{var b,w,P;(b=x?.disconnect)===null||b===void 0||b.call(x),(P=(w=y).cancel)===null||P===void 0||P.call(w)}},[y,A]),Object.assign({ref:f},h)}const Gb=Be("head"),Wb=Be("heels"),$o=Be("headOverHeels"),Vr=(t,e)=>t.characterRooms[e]?.items[e],lz=t=>Vr(t,t.currentCharacterName),cz=t=>{if(Gb(t))return t.state;if($o(t))return t.state.head},uz=t=>{if(Wb(t))return t.state;if($o(t))return t.state.heels},gI=(t,e)=>{const r=Vr(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&Gb(r)||e==="heels"&&Wb(r))return r.state;if(e==="head"&&$o(r))return r.state.head;if(e==="heels"&&$o(r))return r.state.heels}},hz=gI,ut={x:12,y:12,z:de.h},yI={x:14,y:14,z:de.h},ns={x:16,y:16,z:de.h},qo={...ut,z:de.h*2},Yb=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:ut};case"slidingBlock":return t.config.style==="book"?{aabb:ns}:{aabb:ut};case"lift":return{aabb:{...ut,z:ut.z}};case"switch":return{aabb:{...ut,z:ut.z}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:ut};case"charles":return{aabb:qo};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:ns};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:ns};case"tower":return{aabb:{x:11,y:11,z:de.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...ut,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:qo};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:ut};case"turtle":return{aabb:ut};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:ns};case"bubbles":return{aabb:ut};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:ns};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:de.h}:{x:15,y:3,z:de.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:qo}:{aabb:ut};case"emitter":return{aabb:pe};default:return{aabb:yI}}},nt={aabb:ut,castsShadowWhileStoodOn:!1},xI=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,dz=({x:t=0,y:e=0})=>e-t,ze=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),We=({x:t=0,y:e=0,z:r=0})=>({x:t*de.w,y:e*de.d,z:r*de.h}),fz=t=>ze(We(t)),Vu=t=>{const e=We(t.position),{aabb:r}=Yb(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:re(e,{x:de.w-r.x>>1,y:de.d-r.y>>1})},Fe=Number.MIN_SAFE_INTEGER,Oe=pi/1e3,pz={head:15e-5,heels:15e-5},Az=1e3/110,mz=240,bI=2e-4,qI={head:de.h*2/1e3,others:de.h*6/1e3},gz=bI*.35,yz=qI.others*.5,xz=.8,bz=.001,wI={head:Oe,heels:2*Oe,charles:Oe,dalek:Math.SQRT2*Oe,bubbleRobot:(Math.SQRT2+1)/2*Oe,cyberman:1*Oe,skiHead:Oe,helicopterBug:Oe,homingBot:2*Oe,monkey:Oe,elephant:Oe,elephantHead:0,emperor:Oe,emperorsGuardian:Math.SQRT2*Oe,computerBot:Oe,turtle:Oe,ball:2*Oe,firedDoughnut:2*Oe,movingPlatform:Oe,floatingText:Oe},vI=(t=1)=>t*pi/1e3,qz=vI(),wz=2,lm=1.1,vz={head:de.h*2.6+lm,heels:de.h+lm},VI=10,Vz=6e4,_I=8,_z=750,kz=2500,Sz=200,Cz=.15,Pz=8,kI=Pt.h-Pt.w/2,Kb=kI+2,td=9999,Je=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Fe,stoodOnUntilRoomTime:Fe}),oi=()=>({standingOnItemId:null,vels:{gravity:pe,movingFloor:pe},latentMovement:[],actedOnAt:{roomTime:Fe,by:fe},collidedWith:{roomTime:Fe,by:fe}}),SI=t=>{const e=wy.includes(t.type);return{...Je(),position:Vu(t),...e?{standingOnItemId:null,vels:{gravity:pe,movingFloor:pe,...by.includes(t.type)?{sliding:pe}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:pe}:{}},latentMovement:[],actedOnAt:{roomTime:Fe,by:fe},collidedWith:{roomTime:Fe,by:fe}}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:be[t.config.startDirection]}:{facing:be.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:be[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:pe}}:{},...t.type==="charles"?{facing:be.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Fe,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?fi(be[t.config.direction],wI.firedDoughnut):pe}}:{}}},bc=de.h*2,CI=4,ro=de.h*CI,PI=2,EI=.5,cm=2;function*TI(t,e){const{config:{direction:r},position:s}=t,n=mg(r),i=Fu(n),o=xI(t),a={...pe,[i]:o?-.5:0},l=1,c={[i]:o?-1:0},u=l*de.w,h={...pe,[i]:u},d=9,f=8,A=8;{const g={[n]:f,[i]:A,z:ro};yield{...t,...nt,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...Je(),position:We(re(s,{[n]:1.5},a,c)),stoodOnBy:fe},aabb:re(g,h),renderAabb:g,renderAabbOffset:o?h:void 0}}{const g={[n]:d,[i]:A,z:ro};yield{...t,...nt,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...Je(),position:We(re(s,a,c)),stoodOnBy:fe},aabb:re(g,h),renderAabb:g,renderAabbOffset:o?h:void 0}}{const g={[n]:2*de.w-d-f,[i]:A,z:ro-bc};yield{...t,...nt,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...Je(),position:re(We(re(s,a,c)),{[n]:d,z:bc}),stoodOnBy:fe},aabb:re(g,h),renderAabb:g,renderAabbOffset:o?h:void 0}}yield{...t,...nt,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...Je(),position:re(We(re(s,a,c)),{z:ro}),stoodOnBy:fe},aabb:re(We({[n]:2,[i]:l,z:td}),{[i]:A}),renderAabb:pe,fixedZIndex:Ir},yield{...t,...nt,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Qn(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:We({...pe,[i]:o?l+.25:-.25}),direction:be[r]},fixedZIndex:Ir,state:{...Je(),position:re(We(re(s,{[i]:o?-.5-l:.5})),{[n]:d}),stoodOnBy:fe},aabb:{[n]:PI*de.w-d-f,[i]:u,z:bc}},s.z!==0&&(yield{...t,...nt,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:s.z},renders:!0,shadowCastTexture:o?{textureId:"shadow.door.floatingThreshold.double.y",flipX:n==="x"}:void 0,castsShadowWhileStoodOn:o,state:{...Je(),position:{...We(re(s,a,c)),z:0}},aabb:re(We({[n]:2,[i]:.5,z:s.z}),h),renderAabb:o?re(We({[n]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?re({[n]:0,[i]:0,z:(s.z-.5)*de.h},{[i]:h[i]}):void 0,shadowOffset:{z:s.z*de.h,[i]:o?h[i]:void 0}}),yield{...nt,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:We({[n]:2,[i]:cm,z:2}),config:{},fixedZIndex:Ir,state:{...Je(),position:We(Vo(s,fi(be[r],EI),o?pe:{[i]:cm})),stoodOnBy:fe}}}const Go={config:fe,shadowCastTexture:"shadow.smallRound",castsShadowWhileStoodOn:!0,aabb:ut},ai=()=>{const t=gy(ke.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:be.towards,walkStartFacing:be.towards,walkDistance:0,vels:{walking:pe,gravity:pe,movingFloor:pe},switchedToAt:Fe,lastDiedAt:Fe,gameTime:0,jumpStartTime:Fe,lives:t?"infinite":_I,jumpStartZ:0}},RI=(t,e)=>{const r=yy(ke.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...nt,...Go,state:{...Je(),...oi(),...ai(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Fe,shieldCollectedAt:Fe,doughnuts:r?"infinite":0,position:Vu(t),stoodOnUntilRoomTime:Fe}}:{id:e,jsonItemId:e,type:"heels",...nt,...Go,state:{...Je(),...oi(),...ai(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Fe,position:Vu(t),stoodOnUntilRoomTime:Fe}}},MI=t=>t==="towards"||t==="right",rd=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),Ez=t=>t.type==="wall"?rd(t.config):e_(t)?t.config.times:void 0,_u=(t=Zo)=>({x:t.x??1,y:t.y??1,z:t.z??1}),Tz=t=>({x:t.x??1,y:t.y??1}),um=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?_u(rd(t.config)):e(t)?_u(t.config.times):Zo},Rz=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},li=(t,e={})=>{const r=_u(e),s=Vo(Kf,t);return Vo(iw(r,Kf),s)},Xb=1,II={x:de.w,y:de.d*Xb,z:td},jI={x:de.w,y:0,z:Kb},BI={x:de.w*Xb,y:de.d,z:td},OI={x:0,y:de.d,z:Kb},NI=(t,e)=>{const{config:{direction:r},position:s}=e,n=rd(e.config),i=mg(r),o=Fu(i),a=MI(r),l={...pe,[o]:a?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:li(i==="y"?BI:II,n),renderAabb:a?pe:li(i==="y"?OI:jI,n),fixedZIndex:a?Ir:void 0,state:{...Je(),position:We(re(s,l)),stoodOnBy:fe},shadowCastTexture:i==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0},castsShadowWhileStoodOn:a}},zI=3,hm=10,dm=.52,fm=.5,FI=(t,e,r)=>{const{config:{times:s},position:n}=e,i=re(n,{z:-3}),o={...s,z:zI};let a=i,l=o;const c=je(ms(r.items)).filter(d=>d.type==="door");if(n.z===0){const d={};for(const f of c){const{position:A,config:{direction:g}}=f;switch(g){case"towards":!d.towards&&A.y===i.y&&A.x>=i.x&&A.x<=i.x+s.x-2&&(l=re(l,{y:fm}),a=re(a,{y:-.5}),d.towards=!0);break;case"away":!d.away&&A.y===i.y+s.y&&A.x>=i.x&&A.x<=i.x+s.x-2&&(l=re(l,{y:dm}),d.away=!0);break;case"right":!d.right&&A.x===i.x&&A.y>=i.y&&A.y<=i.y+s.y-2&&(l=re(l,{x:fm}),a=re(a,{x:-.5}),d.right=!0);break;case"left":!d.left&&A.x===i.x+s.x&&A.y>=i.y&&A.y<=i.y+s.y-2&&(l=re(l,{x:dm}),d.left=!0);break}}}const u=We(a),h=li(ns,l);return{...nt,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:li(ns,o),position:We(i)}},aabb:h,renderAabb:{...h,z:hm},renderAabbOffset:{...pe,z:h.z-hm},shadowCastTexture:"shadow.fullBlock",state:{...Je(),position:u}}};function*sd(t,e,r,s=fe,n={},i=""){if(!s[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&n[e.config.page]))switch(!0){case e.type==="door":return yield*TI(e,t);case e.type==="player":{yield RI(e,t);return}case e.type==="wall":{yield NI(t,e);return}case e.type==="floor":{yield FI(t,e,r);return}case(e.type==="block"&&e.config.disappearing!==void 0&&Du(um(e))>=2):{const o=um(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=sh(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=Zo});yield*sd(t,u,r,s,n,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!ke.getState().gameMenus.planetsLiberated[e.config.planet]):return;default:{const o=Yb(e),a=e.config.times!==void 0?{aabb:li(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=SI(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...nt,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Ir:void 0,shadowCastTexture:LI(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const LI=t=>{switch(t.type){case"lift":case"switch":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Ag(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};let DI=0;const Mz=({gameState:t,room:e,itemType:r,config:s,position:n})=>{const i={type:r,config:s,position:pe},o=`${r}/${DI++}`,a=Zw(sd(o,i,e.roomJson,t.pickupsCollected[e.id]??fe));if(a===void 0)throw console.error("failed to generate any items for json",o,i),new Error("failed to generate any items");return a.state.position=n,Wo({room:e,item:a}),a},Wo=({room:t,item:e})=>(t.items[e.id]=e,e),Qb=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0},UI=t=>{const e=Vr(t,"head"),r=Vr(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},HI=t=>{const e={id:"head",type:"head",...nt,...Go,state:{...Je(),...oi(),...ai(),...t.state.head,facing:t.state.facing,position:re(t.state.position,{z:de.h}),switchedToAt:Fe,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...nt,...Go,state:{...Je(),...oi(),...ai(),...t.state.heels,facing:t.state.facing,position:re(t.state.position),switchedToAt:Fe,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},$I=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...nt,shadowCastTexture:e.shadowCastTexture,config:fe,aabb:qo,state:{...Je(),...oi(),...ai(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...Qn(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Fe},heels:{...Qn(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Fe}}}),GI=t=>{const e=t.characterRooms.head,r=Vr(t,"head"),s=Vr(t,"heels"),n=$I({head:r,heels:s});Bo({room:e,item:"head"}),Bo({room:e,item:"heels"}),Wo({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},WI=(t,e)=>{const r=t.characterRooms.headOverHeels,s=Vr(t,"headOverHeels"),n=e??$c(t.previousPlayable),{head:i,heels:o}=HI(s);Bo({room:r,item:"headOverHeels"}),Wo({room:r,item:i}),Wo({room:r,item:o}),Qb({above:i,below:o}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},YI=t=>{const e=Vr(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},wo=(t,e)=>{UI(t)&&(!e||e===t.currentCharacterName)?GI(t):t.currentCharacterName==="headOverHeels"?WI(t,e):(!e||e!==t.currentCharacterName)&&Vr(t,$c(t.currentCharacterName))!==void 0&&(t.currentCharacterName=$c(t.currentCharacterName)),YI(t)},KI=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(wo(t),!0):e.currentActionPress("swop.head")==="tap"?(wo(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(wo(t,"heels"),!0):!1},XI=()=>{const t=dn(),[e,r]=v.useState(t.gameState.currentCharacterName);return v.useEffect(()=>{const s=()=>{r(t.gameState.currentCharacterName)};return xt.shared.add(s),()=>{xt.shared.remove(s)}},[t.gameState]),e},QI=()=>{const t=dn();v.useEffect(()=>{const e=()=>{KI(t.gameState)};return xt.shared.add(e),()=>{xt.shared.remove(e)}},[t.gameState])},K=48,yr=36,ci=.55,gt=K*((1-ci)/2),mt=K-gt,ui=8,Ds=128,nn=t=>Math.round(t*10)/10,nd=t=>{const e=ze(t);return`translate(${nn(e.x)},${nn(e.y)})`},Y=t=>{const e=ze(t);return Ct(e)},Ct=t=>`${nn(t.x)},${nn(t.y)}`,ZI=()=>{const t=v.useRef(null);return v.useLayoutEffect(()=>{t.current?.scrollIntoView({behavior:"instant",block:"center"})}),p.jsx("div",{ref:t})},vo=({className:t,scrollTo:e=!1,onClick:r,yAdjust:s=0})=>p.jsxs("foreignObject",{x:-50,y:-100+s,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[p.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r,style:r?{pointerEvents:"all"}:{}}),e&&p.jsx(ZI,{})]}),zn=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:s=!1,yAdjust:n=0,onClick:i})=>p.jsx(vo,{className:`${s?"[--scale:2.5]":"[--scale:1.5]"}
                ${tn({character:t,action:r?"walking":"idle",facingXy8:Uu(e)??"towards"})}`,scrollTo:r,yAdjust:n,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),JI=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return p.jsxs(p.Fragment,{children:[p.jsx(vo,{className:`${r} texture-lift_static`}),p.jsx(vo,{className:`${r} texture-lift_2`})]});const s=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return p.jsx(vo,{className:`${r} ${s}`})},ej=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],tj=({x:t,y:e},{x:r,y:s})=>(t-r)**2+(e-s)**2,rj=(t,e)=>{const r=t%3,s=Math.floor(t/3),n=e%3,i=Math.floor(e/3);return Math.abs(r-n)<=1&&Math.abs(s-i)<=1&&t!==e},pm=t=>t.some((e,r)=>t.slice(r+1).some(s=>rj(e,s))),Gn=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...s]=t;return[...Gn(s,e),...Gn(s,e-1).map(n=>[r,...n])]},Zb=t=>t.length<=1?[t]:t.flatMap((e,r)=>Zb([...t.slice(0,r),...t.slice(r+1)]).map(s=>[e,...s])),Am={1:Gn([...Array(9).keys()],1),2:Gn([...Array(9).keys()],2).filter(t=>!pm(t)),3:Gn([...Array(9).keys()],3).filter(t=>!pm(t))},ku=3,Jb=({items:t,itemNormalisedPosition:e})=>{const r=Ai(t),s=r.length;if(s===0)return fe;if(s>ku)throw new Error(`roomItemPositions supports up to ${ku} items, but got ${s}: ${Object.keys(t).join(", ")}`);const n=r.map(([a,l])=>({id:a,pos:e(l)}));let i=fe,o=1/0;if(Am[s]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${s}`);for(const a of Am[s]){const l=a.map(c=>ej[c]);for(const c of Zb(l)){const u={};let h=0;for(let d=0;d<s;d++){const{id:f,pos:A}=n[d],g=c[d];u[f]=g,h+=tj(A,g)}h<o&&(o=h,i=u)}}return i},sj={x:1,y:1,z:1},mm=t=>re(t.state.position,fi(t.aabb,.5)),Iz=t=>t,nj=t=>ms(t.items),ij=t=>Wu(t),oj=t=>je(nj(t)),jz=(t,...e)=>{const r=je(ij(t));return e.length===0?r:r.filter(([,s])=>e.includes(s.type))},aj={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},Bz=t=>hs(t.items).reduce((e,r)=>{if(r.type==="floor"){const{config:{naturalFootprint:s},state:{position:n},renderAabb:i,renderAabbOffset:o,aabb:a}=r,l=ze(re(s.position,{x:s.aabb.x,z:s.aabb.z})).x,c=ze(re(s.position,{y:s.aabb.y,z:s.aabb.z})).x,u=ze(re(s.position,s.aabb)).y,h=ze(re(n,o??pe,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const s=ze(re(r.state.position,r.renderAabb??r.aabb??pe,r.renderAabbOffset??pe)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,s)},floors:e.floors}}},aj),lj={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},eq=t=>{const e=oj(t).filter(r=>r.type==="floor").reduce((r,s)=>{const{position:n,config:{times:i}}=s;return{from:{x:Math.min(r.from.x,n.x),y:Math.min(r.from.y,n.y),z:Math.min(r.from.z,n.z)},to:{x:Math.max(r.to.x,n.x+i.x),y:Math.max(r.to.y,n.y+i.y),z:Math.max(r.to.z,n.z)}}},lj);if(isFinite(e.from.x))return e},gm=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),tq=({items:t,positions:e,ItemComponent:r})=>p.jsx("g",{"data-class":"items",children:Ai(e).sort(([s,n],[i,o])=>o.y-n.y+(o.x-n.x)).map(([s,n])=>p.jsx("g",{"data-position":JSON.stringify(n),transform:`${nd(Lu(n,K*.5))} translate(0,-3)`,children:p.jsx(r,{item:t[s]})},s))}),cj=(t,e)=>{if(t==="*"){const r=eq(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},uj=({items:t,roomJson:e,subRoomId:r})=>{const s=v.useMemo(()=>Jb({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??fe,...sj},a=Mr(i.position,fi(o,.5)),l=cj(r,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return p.jsx(tq,{ItemComponent:JI,items:t,positions:s})},hj=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:s,onClick:n})=>{const i=v.useMemo(()=>({item:{type:l,state:{facing:c}}})=>p.jsx(zn,{characterName:l,facing:c,isCurrent:s===l,onlyPlayableInRoom:!1,onClick:n}),[s,n]),o=v.useMemo(()=>({head:t,heels:e}),[t,e]),a=v.useMemo(()=>Jb({items:o,itemNormalisedPosition:c=>{const u=mm(c),h=ow(mm(c),{x:1/de.w,y:1/de.d,z:1}),d=eq(r);if(d===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:gm(h.x,d.from.x,d.to.x),y:gm(u.y,d.from.y,d.to.y)}}}),[o,r]);return p.jsx(tq,{ItemComponent:i,items:o,positions:a})},Er={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},dj=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.lightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},rq=t=>(t&&Er[t])??{bgClassName:"fill-shadow",containerClassName:""},Ut=t=>({x:(t.x??0)*K,y:(t.y??0)*K,z:(t.z??0)*yr}),sq=.15,so=ze(Ut({x:.5,y:.5,z:0})),ym=ze(Ut({x:sq,y:0,z:0})),xm=ze(Ut({x:sq*1.66,y:0,z:0})),fj=({className:t})=>p.jsxs(p.Fragment,{children:[p.jsx("ellipse",{className:"fill-white",cx:so.x,cy:so.y,rx:Math.abs(xm.x),ry:Math.abs(xm.y)}),p.jsx("ellipse",{className:t,cx:so.x,cy:so.y,rx:Math.abs(ym.x),ry:Math.abs(ym.y)})]}),pj=(t,e,r)=>{if(e==="*")return!0;const s=r.meta.subRooms[e];return t.x>=s.physicalPosition.from.x&&t.y>=s.physicalPosition.from.y&&t.x<=s.physicalPosition.to.x&&t.y<=s.physicalPosition.to.y},nq=({position:t},e,r)=>pj(t,e,r),Aj=(t,e,r)=>{if(e==="*")return 0;const s=r.meta.subRooms[e],{from:n,to:i}=s.physicalPosition;if(t.x>=n.x&&t.y>=n.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<n.x?o=n.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<n.y?a=n.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},iq=(t,e,r)=>{const s=r.meta?.subRooms;if(s===void 0)return"*";let n,i=1/0;const o=e==="fine"?{x:t.x/de.w,y:t.y/de.d}:t;for(const a of Ku(s)){const l=Aj(o,a,r);if(l===0)return a;l<i&&(i=l,n=a)}if(n===void 0)throw new Error(`item not found in any subroom of ${r.id}
      item at  ${JSON.stringify(o)}
      subrooms ${JSON.stringify(r.meta?.subRooms,null,2)}`);return n},mj=(t,e,r)=>nq(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),gj=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const s=Object.groupBy(r,i=>i[1].type),n=pv(e,cv(...ms(s)));return Object.fromEntries(n)},yj=(t,e,r)=>v.useMemo(()=>{let s=!1,n=!1;const i=je(Ai(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(s)return!1;s=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(n)return!1;n=!0}return!0}).filter(o=>mj(o[1],r,t));return gj(un(i),ku)},[t,e,r]),Ft=3,bm=gg(ze({x:K,y:0})),no={wall:void 0,open:"0,999",doorway:`${nn(bm*((1-ci)/2)-Ft/2)}, ${nn(bm*ci+Ft)}, 999`},qc=`
M ${Y({})}
L ${Y({y:K})}
L ${Y({x:K,y:K})}
L ${Y({x:K})}
z`,io=(t,e=ci)=>{const r=K*((1-e)/2),s=K-r,n=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${Y({x:r,y:r})}`;return a&&(l+=`L${Y({x:0,y:r})} L${Y({x:0,y:s})}`),l+=`L${Y({x:r,y:s})}`,n&&(l+=`L${Y({x:r,y:K})} L${Y({x:s,y:K})}`),l+=`L${Y({x:s,y:s})}`,o&&(l+=`L${Y({x:K,y:s})} L${Y({x:K,y:r})}`),l+=`L${Y({x:s,y:r})}`,i&&(l+=`L${Y({x:s,y:0})} L${Y({x:r,y:0})}`),l+="z",l},wc=4,xj=je(Sg(wc)).map(t=>`
M${Y({x:K*((t+.5)/wc),y:0})}
L${Y({x:K*((t+.5)/wc),y:K})}`).toArray().join(""),qm=t=>{const e=`
M${Y({x:0,y:K})}
L${Y({x:0,y:K,z:yr})}
L${Y({x:K,y:K,z:yr})}
L${Y({x:K,y:K})}
z
`;return t?e+`
M${Y({x:gt,y:K})}
L${Y({x:gt,y:K,z:yr})}
L${Y({x:mt,y:K,z:yr})}
L${Y({x:mt,y:K})}
L${Y({x:gt,y:K})}`:e},bj=`            
M${Y({x:K,y:K,z:yr})}            
L${Y({x:K,y:K})}            
M${Y({x:K,y:0,z:yr})}            
L${Y({x:K,y:0})}            
M${Y({x:0,y:K,z:yr})}            
L${Y({x:0,y:K})}            
`,qj=`            
M${Y({x:0,y:0,z:yr})}            
L0, 0            
`,wj=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:s,roomVisited:n,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:d,color:f,items:A}=s,g=s.meta?.label,m=yj(s,r,e),y=Object.values(A).filter(w=>w.type==="floor"),x=y.length===0,b=y.some(w=>w.config.floorType==="deadly");return p.jsxs("g",{"data-room-id":h,strokeWidth:Ft,className:dj(f),children:[x?p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${qc} ${io(t)}`}),p.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${io(t)} ${io(t,ci*.7)}`})]}):p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:qc}),p.jsx("path",{className:"fill-white",d:io(t)}),b&&p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:xj})]}),s.id==="blacktooth11"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${Y({x:gt,y:gt})}
L${Y({x:mt,y:gt})}
L${Y({x:mt,y:gt-Ft*2})}
L${Y({x:gt,y:gt-Ft*2})}
z
M${Y({x:gt,y:mt})}
L${Y({x:mt,y:mt})}
L${Y({x:mt,y:mt+Ft*2})}
L${Y({x:gt,y:mt+Ft*2})}
z
`}):s.id==="moonbase20"||s.id==="moonbase23"?p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Ft*2,d:`
M${Y({x:gt,y:K/2})}
L${Y({x:mt,y:K/2})}

M${Y({x:K/2,y:gt})}
L${Y({x:mt,y:K/2})}

M${Y({x:K/2,y:mt})}
L${Y({x:mt,y:K/2})}
`}):s.id==="blacktooth77"||s.id==="safari26"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${Y({x:K/2-Ft,y:0})}
L${Y({x:K/2+Ft,y:0})}
L${Y({x:K/2+Ft,y:K})}
L${Y({x:K/2-Ft,y:K})}
z
`}):null,d&&p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:qm(t.away==="doorway")}),p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:qm(t.left==="doorway")})]}),p.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[p.jsx("path",{d:`M${Y({x:0,y:K})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:no[t.right]}),p.jsx("path",{d:`M${Y({x:K,y:0})} L${Y({x:K,y:K})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:no[t.left]}),p.jsx("path",{d:`M${Y({x:K,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:no[t.towards]}),p.jsx("path",{d:`M${Y({x:0,y:K})} L${Y({x:K,y:K})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:no[t.away]})]}),n&&p.jsx(fj,{className:"fill-[var(--roomHintColor)]"}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:bj}),i&&o?p.jsx(hj,{roomJson:s,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?p.jsx(zn,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?p.jsx(zn,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?p.jsxs(p.Fragment,{children:[p.jsx(zn,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),p.jsx(zn,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):p.jsx(uj,{roomJson:s,subRoomId:e,items:m}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:qj}),g&&p.jsx("g",{transform:nd(Ut(Mr(g.gridOffset,{x:.5,y:.5}))),children:p.jsx("foreignObject",{width:g.text.length*16,height:16,y:-8,x:g.align==="left"?0:g.text.length*-16,children:p.jsx(N,{noTint:!0,className:"[--scale:2] [--block:16px]",children:g.text})})}),u?p.jsx("path",{className:"fill-transparent cursor-pointer",d:qc,onClick:()=>{u(h)}}):null]})},is=({mapTitle:t,y:e=0,className:r,textOnly:s=!1})=>{const n=mi();return p.jsxs("g",{className:r,children:[s||p.jsx("rect",{y:e,width:1e4,height:1e4}),p.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:ui,y:e+16,children:p.jsx(N,{className:`left-2 relative sprites-double-height ${ve}`,children:t})})]})},vj=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const s=mi(),n=e.r-e.l+2*ui,i={x:-e.l+ui+(r-n)/2,y:-e.t+Ds},o=(b,w=pe)=>Mr(i,ze(Ut(re(t[b].gridPosition,w)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),d=o("blacktooth53market/*",{x:0,y:1,z:0}),f=o("blacktooth53market/*",{x:1,y:1,z:0}),A=o("blacktooth52market/*",{x:1,y:.5,z:0}),g=s*8*2,m="Market",y=(m.length+3)*s*8,x=s*8*2+32;return p.jsxs(p.Fragment,{children:[p.jsx("path",{className:`${Er.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Ct({x:g,y:A.y+x})}
L ${Ct({x:y,y:A.y+x})}
L ${Ct({x:y,y:a.y})}
L ${Ct(a)}
L ${Ct(l)}
L ${Ct(c)}
L ${Ct(u)}
L ${Ct(h)}
L ${Ct(d)}
L ${Ct(f)}
L ${Ct(A)}
L ${Ct({...A,x:g})}
z`}),p.jsx(is,{y:A.y,mapTitle:m,className:Er.market.bgClassName,textOnly:!0})]})},Vj=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const s=t,n=ze(Ut({x:1,y:1,z:0})).y,i=(o,a)=>{if(s[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(s[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=ze(Ut(s[o].gridPosition)).y,c=ze(Ut(s[a].gridPosition)).y+n;return(l+c)/2};return p.jsxs(p.Fragment,{children:[p.jsx(is,{y:0,mapTitle:"Freedom",className:Er.freedom.bgClassName}),p.jsx(is,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+Ds,mapTitle:"Castle Blacktooth",className:Er.blacktooth.bgClassName}),p.jsx(is,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+Ds,mapTitle:"moonbase",className:Er.moonbase.bgClassName}),p.jsx(is,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+Ds,mapTitle:"Blacktooth escape",className:Er.blacktooth.bgClassName}),p.jsx(vj,{mapBounds:e,originalCampaignPositions:s,containerWidth:r}),p.jsx(is,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+Ds,mapTitle:"Jail",className:Er.jail.bgClassName})]})},_j={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},kj=t=>{const{campaign:e,curRoomId:r}=t,s=e.name==="original"&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),n=rq(t.curRoomScenery);return s?p.jsx(Vj,{...t}):p.jsx(is,{mapTitle:_j[e.rooms[r].planet],className:n.bgClassName})},vc=(t,e,r,s)=>{const n=Xc(e,t[e]?.items);return n&&r===t[e].roomJson.id&&s===iq(n.state.position,"fine",t[e].roomJson)?n:void 0},Sj=t=>{const{campaign:e,pickupsCollected:r,gridPositions:s,currentCharacterName:n,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const d=o.r-o.l+2*ui,f=o.b-o.t+2*Ds,A=Object.values(s);return p.jsxs("svg",{className:"w-full",style:{minWidth:`${d}px`,height:`${f}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:p.jsx(kj,{...t,curRoomId:u,containerWidth:a}),p.jsx("g",{transform:`translate(${-o.l+ui+(a-d)/2},${-o.t+128})`,children:A.map(g=>{const{roomId:m,subRoomId:y,gridPosition:x}=g,b=`${m}/${y}`;return p.jsx("g",{"data-id":b,transform:nd(Ut(x)),children:p.jsx(wj,{roomGridPositionSpec:g,roomPickupsCollected:r[m]??fe,roomJson:e.rooms[m],headItemInRoom:vc(i,"head",m,y),heelsItemInRoom:vc(i,"heels",m,y),headOverHeelsItemInRoom:vc(i,"headOverHeels",m,y),currentCharacterName:n,roomVisited:l[m]??!1,onPlayableClick:c,onRoomClick:h})},b)})})]})},Cj=t=>t.characterRooms[t.currentCharacterName],oq=({aabb:t,state:{position:e}},{aabb:r,state:{position:s}})=>!(e.x+t.x<=s.x||e.x>=s.x+r.x)&&!(e.y+t.y<=s.y||e.y>=s.y+r.y)&&!(e.z+t.z<=s.z||e.z>=s.z+r.z),Pj=(t,e)=>[...je(e).filter(r=>t.id!==r.id&&oq(t,r))];function*Ej(t,e){if(t.roomBelow!==void 0)for(const r of hs(e).filter(Wc)){const{config:{naturalFootprint:s}}=r;yield{...nt,type:"portal",id:"floor/portal",fixedZIndex:Ir,config:{toRoom:t.roomBelow,relativePoint:{x:s.aabb.x/2,y:s.aabb.y/2,z:s.aabb.z},direction:be.down},aabb:s.aabb,state:{...Je(),position:s.position},renders:!1}}if(t.roomAbove!==void 0)for(const r of hs(e).filter(Wc)){const{config:{naturalFootprint:s}}=r;yield{...nt,type:"portal",id:"ceilingPortal",fixedZIndex:Ir,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?We(t.ceilingRelativePoint):{x:s.aabb.x/2,y:s.aabb.y/2},z:-12},direction:be.up},aabb:{...s.aabb,z:de.h},state:{...Je(),position:re(s.position,{z:s.aabb.z},{z:de.h*(t.height??VI)})}}}}const Tj=(t,e,r,s)=>{const n=Math.max(0,Math.min(t.x+e.x,r.x+s.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+s.y)-Math.max(t.y,r.y));return n*i},wm=({state:{position:t},aabb:e},{state:{position:r},aabb:s})=>Tj(t,e,r,s),vm=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),Vm={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},aq=(t,e)=>Vm[t.type]-Vm[e.type],Oz=(t,e)=>e.toSorted((r,s)=>{const n=aq(r,s);if(n!==0)return n;const i=Rc(t,vm(t,r)),o=Rc(t,vm(t,s));return Math.abs(i-o)<1e-4?r.id<s.id?-1:1:i-o}),Rj=(t,e,r=.001)=>{if(!Gc(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:s}}}}=t;return s>0?!1:oq({state:{position:re(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+Ln},id:t.id},{state:{position:re(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},Mj=(t,e)=>{const s=[...je(e).filter(i=>Rj(t,i))];return s.length===0?void 0:s.reduce((i,o)=>{const a=aq(o,i);return a<0||a===0&&wm(t,o)>wm(t,i)?o:i})};function*Ij(t,e,r,s){const n=Ai(t.items);for(const[i,o]of n)o.type==="player"&&!s||(yield*sd(i,o,t,e,r))}const _m=t=>je(t).reduce((e,r)=>({...e,[r.id]:r}),{}),km=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:s=!1})=>{const n=_m(Ij(t,e,r,s)),i={..._m(Ej(t,n)),...n};for(const a of hs(i)){const c=Pj(a,Ry(i)).find(u=>Gc(a)&&Gc(u)&&!(a.type==="wall"&&u.type==="wall"));c!==void 0&&console.error(`in room ${t.id} item ${a.id} @${JSON.stringify(a.state.position)} #${JSON.stringify(a.aabb)} is colliding with (solid item) ${c.id} @${JSON.stringify(c.state.position)} #${JSON.stringify(c.aabb)} on loading room ${t.id}`)}for(const a of hs(i).filter(hh)){const l=Mj(a,hs(i).filter(c=>c.id!==a.id));l!==void 0&&Qb({above:a,below:l})}return{...t,roomJson:t,items:i,roomTime:0}},Sm=({state:{position:t,facing:e,autoWalk:r,action:s,vels:n}})=>({position:t,facing:e,autoWalk:r,action:s,vels:{...n}}),lq=(t,e)=>{if(e)return Mg(e.gameState.characterRooms,([s,n])=>[s,n.id]);const r={};for(const s of Object.values(t.rooms))for(const n of Object.values(s.items))if(n.type==="player"){const{which:i}=n.config;r[i]=s.id}if(r.head===void 0&&r.heels===void 0)throw new Error("couldn't find either head or heels in campaign");return r},Nz=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:s={}})=>{const n=lq(t,r),i={},o=r?r.gameState.characterRooms.head&&Mn(r.gameState.characterRooms.head):n.head&&km({roomJson:t.rooms[n.head],roomPickupsCollected:fe,scrollsRead:fe,isNewGame:!0}),a=n.heels===n.head?o:r?r.gameState.characterRooms.heels&&Mn(r.gameState.characterRooms.heels):n.heels&&km({roomJson:t.rooms[n.heels],roomPickupsCollected:fe,scrollsRead:fe,isNewGame:!0}),l=r?.gameState.characterRooms.headOverHeels&&Mn(r.gameState.characterRooms.headOverHeels),c={head:o,heels:a,headOverHeels:l};return Object.assign(s,{inputStateTracker:e,campaign:t,gameSpeed:1,...r?Mn(r?.gameState):{currentCharacterName:n.head===void 0||aa().get("playAsHeels")==="1"?"heels":"head",entryState:{head:o===void 0?void 0:Sm(Xc("head",o?.items)),heels:a===void 0?void 0:Sm(Xc("heels",a?.items))},pickupsCollected:i,gameTime:0,progression:0},characterRooms:c})},jj=ze(Ut({x:1,y:1,z:1})).y,Cm=ze(Ut({x:0,y:1,z:0})).x,Bj=t=>t.reduce((e,{gridPosition:r})=>{const s=ze(Ut(r));return{t:Math.min(e.t,s.y+jj),b:Math.max(e.b,s.y),l:Math.min(e.l,s.x-Cm),r:Math.max(e.r,s.x+Cm)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),oo=(t,e,r,s)=>e.some(n=>n.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:n})=>lw(be[t],nw(n,s)))?"open":"wall";function*Ns(t){try{yield*Oj(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*Oj({roomId:t,subRoomId:e="*",campaign:r,visited:s={},vectorFromPrevious:n,previousRoomGridPosition:i=pe}){if(t==="nowhere"||s[t]?.[e])return;s[t]===void 0&&(s[t]={}),s[t][e]=!0;const o=r.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...je(ms(o.items)).filter(f=>f.type==="door").filter(f=>nq(f,e,o))],l=re(i,n===void 0?cw:n),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:oo("left",a,c,u),right:oo("right",a,c,u),away:oo("away",a,c,u),towards:oo("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:A}]of je(Ai(c)))f!==e&&(yield*Ns({roomId:t,subRoomId:f,campaign:r,visited:s,vectorFromPrevious:Vo({...A,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:A}=o;yield*Ns({roomId:f,subRoomId:A,campaign:r,visited:s,vectorFromPrevious:be.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:A}=o;yield*Ns({roomId:f,subRoomId:A,campaign:r,visited:s,vectorFromPrevious:be.down,previousRoomGridPosition:l})}for(const f of a){const{toRoom:A}=f.config;try{yield*Ns({roomId:A,campaign:r,visited:s,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:be[f.config.direction],previousRoomGridPosition:l})}catch(g){throw new Error(`error while traversing door ${JSON.stringify(f,null,2)} in room ${t} to room ${A}`,{cause:g})}}const d=o.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:f},gridOffset:A}=d;yield*Ns({roomId:f,campaign:r,visited:s,subRoomId:"*",vectorFromPrevious:A,previousRoomGridPosition:l})}}const Nj=t=>{const r=[...t].sort(({gridPosition:s},{gridPosition:n})=>s.z!==n.z?s.z-n.z:n.x+n.y-(s.x+s.y)).map(s=>[`${s.roomId}/${s.subRoomId}`,s]);return un(r)},zj=()=>{const t=XI(),e=B0(),{gameState:r}=dn();return v.useMemo(()=>{try{const{campaign:s}=r,n=Cj(r),i=n?.roomJson.id??lq(s).head;let o;if(!r)o="*";else if(!n?.roomJson.meta?.subRooms)o="*";else{const u=n?.items[t];u?o=iq(u.state.position,"fine",n.roomJson):o="*"}const a=[...Ns({campaign:s,roomId:i,subRoomId:o})],l=Nj(a);return{mapBounds:Bj(a),curRoomId:n?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:r.pickupsCollected,characterRooms:r.characterRooms,campaign:s,roomsExplored:e,curRoomScenery:n?.planet}}catch(s){throw new Error("error getting map data",{cause:s})}},[t,r,e])},Fj=()=>{const{ref:t,width:e}=mI(),r=tb(),s=dn();QI();const n=zj(),i=rq(n.curRoomScenery);return p.jsx(Ue,{children:p.jsx(Ee,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:U(De),children:p.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:r,children:p.jsx(Sj,{onPlayableClick:o=>wo(s.gameState,o),containerWidth:e,...n})})})})},Lj=()=>{const t=le(M0),e=le(I0);return p.jsxs(p.Fragment,{children:[p.jsx(tt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:U(De)}),p.jsx(Ee,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+Jh,children:[Dt()&&p.jsx(bi,{className:"text-highlightBeige"}),p.jsx(N,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Sound Options"}),p.jsxs(Ie,{className:Zh,children:[p.jsx(X,{doubleHeightWhenFocussed:!0,id:"mute",label:"Mute",valueElement:p.jsx(Pr,{value:t}),onSelect:U(Kt,"userSettings.soundSettings.mute")}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"footsteps",label:"Footstep sounds",valueElement:p.jsx(Pr,{value:!t&&!e}),onSelect:U(Kt,"userSettings.soundSettings.noFootsteps"),disabled:t}),p.jsx(xi,{}),Dt()||p.jsx(rr,{})]}),Dt()||p.jsx(mn,{className:"text-moss zx:text-zxGreen"})]})})]})},Dj=()=>p.jsx(Ue,{children:p.jsxs(Ee,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:U(De),children:[p.jsx(N,{className:`${ve} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You dont go towards the light"}),p.jsx(N,{className:`${ve} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),p.jsx(N,{className:`${ve} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),p.jsx(N,{className:`${ve} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),p.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),p.jsx(Ie,{className:"hidden",children:p.jsx(rr,{})})]})}),Uj=`##Level editor
This remake comes with an editor for the community to get creative.

*beta*. Expect to deal with
occasional, even frequent, crashes.`,Hj=()=>{const t=v.useCallback(()=>{window.location.href="/editor/"},[]);return p.jsxs(Ue,{children:[p.jsx(tt,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Ee,{className:"bg-white zx:bg-zxBlack px-1",children:p.jsx(xs.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[p.jsx("div",{children:p.jsx(ot,{className:"text-midGrey zx:text-zxWhite",markdown:Uj})}),p.jsxs(Ie,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[p.jsx(X,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),p.jsx(X,{doubleHeightWhenFocussed:!0,id:"no",label:"Im scared, go back",onSelect:U(De)})]}),p.jsx(mn,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},$j=t=>t.startsWith("markdown/"),Gj=t=>{const e=le(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if($j(e.menuId))return e.menuId==="markdown/inline"?p.jsx(tc,{source:"inline",markdown:e.menuParam.markdown}):p.jsx(tc,{source:"manual",pageName:e.menuId.slice(9)});switch(e.menuId){case"controlOptions":return p.jsx(zM,{});case"crowns":return p.jsx(GE,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return p.jsx($M,{});case"errorCaught":return p.jsx(XM,{errors:e.menuParam});case"hold":return p.jsx(uT,{});case"inputPreset":return p.jsx(LM,{});case"installGuide":return p.jsx(tc,{source:"manual",pageName:"installGuide"});case"mainMenu":return p.jsx(eT,{});case"map":return p.jsx(Fj,{});case"modernisationOptions":return p.jsx(VM,{});case"offerReincarnation":return p.jsx(rT,{});case"proclaimEmperor":return p.jsx(DM,{});case"quitGameConfirm":return p.jsx(sT,{});case"readTheManual":return p.jsx(IE,{});case"reincarnatedRestart":return p.jsx(Dj,{});case"score":return p.jsx(iT,{});case"sound":return p.jsx(Lj,{});case"sureWantEditor":return p.jsx(Hj,{});default:return e.menuId,p.jsx(Ee,{children:p.jsx(N,{children:`unknown dialog ${e}`})})}},Wj=ln(()=>er(()=>import("./Cheats-CNyI4upJ.js"),__vite__mapDeps([7,4,5,8]))),Yj=ln(()=>er(()=>import("./gameMain-CLdbNYAj.js").then(t=>t.g),__vite__mapDeps([9,8,2,4,5,10]))),Kj="/assets/bonus-CvVo342Z.mp3",Xj="/assets/bubblesLoop-B_LY362Z.mp3",Qj="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",Zj="/assets/conveyorStop-D5zeg8cv.mp3",Jj="/assets/conveyorLoop-CF-OA6qJ.mp3",eB="/assets/conveyorStart-CcCK4MGd.mp3",tB="/assets/destroy-CZDN4Ktz.mp3",rB="/assets/detect-D_kRR5uD.mp3",sB="data:audio/mpeg;base64,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",nB="data:audio/mpeg;base64,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",iB="/assets/headFall-rxdxTCeK.mp3",oB="/assets/headJump-GCHlCfni.mp3",aB="/assets/headWalk-B5kQ4tvC.mp3",lB="/assets/heelsFall-IsGtipMw.mp3",cB="data:audio/mpeg;base64,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",uB="/assets/heelsWalk-Bmk6WOTI.mp3",hB="/assets/helicopter-BYGzJTF2.mp3",dB="data:audio/mpeg;base64,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",fB="/assets/hushPuppyVanish-CZOUg83F.mp3",pB="/assets/jetpack-loop-1-XbLJ84YF.m4a",AB="data:audio/mpeg;base64,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Jua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",mB="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",gB="data:audio/mpeg;base64,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v//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",yB="/assets/mojo-D9S1pz9n.mp3",xB="data:audio/mp4;base64,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",bB="/assets/robotBeepingLoop-Cz0TGwJH.mp3",qB="data:audio/mpeg;base64,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",wB="/assets/rollingBallLoop-BUA084C_.mp3",vB="/assets/servosLoop-Bn-haKck.mp3",VB="/assets/servosStart-BgsySGJF.mp3",_B="/assets/servosStop-BR1i0gi5.mp3",kB="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",SB="/assets/spring-CP3uOhml.mp3",CB="/assets/metalicScraping-BqmM5ys4.mp3",PB="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",EB="/assets/toasterPopUp-CNfTxQPs.mp3",TB="/assets/teleportIn-DZAhHW9-.mp3",RB="/assets/teleportOut-Bra-ABlh.mp3",MB="/assets/teleportWarningSiren-Boo1HoAB.mp3",IB=new window.AudioContext;let Yo;const ie=async t=>await IB.decodeAudioData(await(await fetch(t)).arrayBuffer()),jB=ln(async()=>({bonus:await ie(Kj),bubbleRobotLoop:await ie(Xj),carry:await ie(Qj),conveyorEnd:await ie(Zj),conveyorLoop:await ie(Jj),conveyorStart:await ie(eB),destroy:await ie(tB),detect:await ie(rB),drum:await ie(sB),glassClink:await ie(nB),headFall:await ie(iB),headJump:await ie(oB),headWalk:await ie(aB),heelsFall:await ie(lB),heelsJump:await ie(cB),heelsWalk:await ie(uB),helicopter:await ie(hB),hooter:await ie(dB),hushPuppyVanish:await ie(fB),jetpackLoop:await ie(pB),jetpackTurnaround:await ie(AB),landing:await ie(mB),metalHit:await ie(gB),mojoLoop:await ie(yB),mojoTurn:await ie(xB),robotBeepingLoop:await ie(bB),robotWhirLoop:await ie(qB),rollingBallLoop:await ie(wB),servoLoop:await ie(vB),servoStart:await ie(VB),servoStop:await ie(_B),softBump:await ie(kB),springBoing:await ie(SB),stepStoolScraping:await ie(CB),switchClick:await ie(PB),toasterPopUpSoundUrl:await ie(EB),teleportIn:await ie(TB),teleportOut:await ie(RB),teleportWarningSiren:await ie(MB)})),BB=async()=>{Yo===void 0&&(Yo=await jB())},zz=()=>{if(Yo===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Yo},OB=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=le(q0);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},cq=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},Pm=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,NB=()=>{const t=_0(),e=le(b0);v.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",bt())},[]),v.useEffect(()=>{document.body.classList.remove(...Object.keys(cn).map(Pm)),document.body.classList.add(Pm(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])};class zB extends v.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){ke.dispatch(Cy(cq(e)))}render(){return this.props.children}}const uq=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const FB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",LB=Array.prototype.slice.call(FB),ao=(t=>{let e={};return t.forEach((r,s)=>e[r]=s),e})(LB),DB=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Vc=String.fromCharCode.bind(String),Em=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),hq=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),UB=t=>{if(t=t.replace(/\s+/g,""),!DB.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",s,n;for(let i=0;i<t.length;)e=ao[t.charAt(i++)]<<18|ao[t.charAt(i++)]<<12|(s=ao[t.charAt(i++)])<<6|(n=ao[t.charAt(i++)]),r+=s===64?Vc(e>>16&255):n===64?Vc(e>>16&255,e>>8&255):Vc(e>>16&255,e>>8&255,e&255);return r},HB=typeof atob=="function"?t=>atob(hq(t)):uq?t=>Buffer.from(t,"base64").toString("binary"):UB,$B=uq?t=>Em(Buffer.from(t,"base64")):t=>Em(HB(t).split("").map(e=>e.charCodeAt(0))),GB=t=>$B(WB(t)),WB=t=>hq(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),YB="gzip",dq=async t=>{try{const e=GB(t),r=new Blob([e]),s=new DecompressionStream(YB),n=r.stream().pipeThrough(s),i=await new Response(n).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},KB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>er(async()=>{const{default:s}=await Promise.resolve().then(()=>xn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class id extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class XB extends id{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Tm extends id{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rm extends id{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Su;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Su||(Su={}));var QB=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class ZB{constructor(e,{headers:r={},customFetch:s,region:n=Su.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=KB(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return QB(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:u}).catch(g=>{throw new XB(g)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Tm(h);if(!h.ok)throw new Rm(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),A;return f==="application/json"?A=yield h.json():f==="application/octet-stream"?A=yield h.blob():f==="text/event-stream"?A=h:f==="multipart/form-data"?A=yield h.formData():A=yield h.text(),{data:A,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof Rm||n instanceof Tm?n.context:void 0}}})}}var $e={},Ss={},Cs={},Ps={},Es={},Ts={},JB=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},on=JB();const eO=on.fetch,fq=on.fetch.bind(on),pq=on.Headers,tO=on.Request,rO=on.Response,xn=Object.freeze(Object.defineProperty({__proto__:null,Headers:pq,Request:tO,Response:rO,default:fq,fetch:eO},Symbol.toStringTag,{value:"Module"})),sO=Mq(xn);var lo={},Mm;function Aq(){if(Mm)return lo;Mm=1,Object.defineProperty(lo,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return lo.default=t,lo}var Im;function mq(){if(Im)return Ts;Im=1;var t=Ts&&Ts.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ts,"__esModule",{value:!0});const e=t(sO),r=t(Aq());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,A=null,g=null,m=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const P=await c.text();P===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?A=P:A=JSON.parse(P))}const b=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");b&&w&&w.length>1&&(g=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(A)&&(A.length>1?(f={code:"PGRST116",details:`Results contain ${A.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},A=null,g=null,m=406,y="Not Acceptable"):A.length===1?A=A[0]:A=null)}else{const b=await c.text();try{f=JSON.parse(b),Array.isArray(f)&&c.status===404&&(A=[],f=null,m=200,y="OK")}catch{c.status===404&&b===""?(m=204,y="No Content"):f={message:b}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,m=200,y="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:A,count:g,status:m,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Ts.default=s,Ts}var jm;function gq(){if(jm)return Es;jm=1;var t=Es&&Es.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Es,"__esModule",{value:!0});const e=t(mq());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Es.default=r,Es}var Bm;function od(){if(Bm)return Ps;Bm=1;var t=Ps&&Ps.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ps,"__esModule",{value:!0});const e=t(gq());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return Ps.default=r,Ps}var Om;function yq(){if(Om)return Cs;Om=1;var t=Cs&&Cs.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Cs,"__esModule",{value:!0});const e=t(od());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Cs.default=r,Cs}var Pn={},En={},Nm;function nO(){return Nm||(Nm=1,Object.defineProperty(En,"__esModule",{value:!0}),En.version=void 0,En.version="0.0.0-automated"),En}var zm;function iO(){if(zm)return Pn;zm=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.DEFAULT_HEADERS=void 0;const t=nO();return Pn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Pn}var Fm;function oO(){if(Fm)return Ss;Fm=1;var t=Ss&&Ss.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ss,"__esModule",{value:!0});const e=t(yq()),r=t(od()),s=iO();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([g,m])=>m!==void 0).map(([g,m])=>[g,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([g,m])=>{d.searchParams.append(g,m)})):(h="POST",f=a);const A=Object.assign({},this.headers);return u&&(A.Prefer=`count=${u}`),new r.default({method:h,url:d,headers:A,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Ss.default=n,Ss}var Lm;function aO(){if(Lm)return $e;Lm=1;var t=$e&&$e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty($e,"__esModule",{value:!0}),$e.PostgrestError=$e.PostgrestBuilder=$e.PostgrestTransformBuilder=$e.PostgrestFilterBuilder=$e.PostgrestQueryBuilder=$e.PostgrestClient=void 0;const e=t(oO());$e.PostgrestClient=e.default;const r=t(yq());$e.PostgrestQueryBuilder=r.default;const s=t(od());$e.PostgrestFilterBuilder=s.default;const n=t(gq());$e.PostgrestTransformBuilder=n.default;const i=t(mq());$e.PostgrestBuilder=i.default;const o=t(Aq());return $e.PostgrestError=o.default,$e.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},$e}var lO=aO();const cO=Qe(lO),{PostgrestClient:uO,PostgrestQueryBuilder:Fz,PostgrestFilterBuilder:Lz,PostgrestTransformBuilder:Dz,PostgrestBuilder:Uz,PostgrestError:Hz}=cO;function hO(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const dO=hO(),fO="2.11.15",pO=`realtime-js/${fO}`,AO="1.0.0",xq=1e4,mO=1e3;var Wn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Wn||(Wn={}));var st;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(st||(st={}));var Wt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Wt||(Wt={}));var Cu;(function(t){t.websocket="websocket"})(Cu||(Cu={}));var os;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(os||(os={}));class gO{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const l=s.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class bq{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var we;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(we||(we={}));const Dm=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=yO(o,t,e,n),i),{})},yO=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?qq(i,o):Pu(o)},qq=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return wO(e,r)}switch(t){case we.bool:return xO(e);case we.float4:case we.float8:case we.int2:case we.int4:case we.int8:case we.numeric:case we.oid:return bO(e);case we.json:case we.jsonb:return qO(e);case we.timestamp:return vO(e);case we.abstime:case we.date:case we.daterange:case we.int4range:case we.int8range:case we.money:case we.reltime:case we.text:case we.time:case we.timestamptz:case we.timetz:case we.tsrange:case we.tstzrange:return Pu(e);default:return Pu(e)}},Pu=t=>t,xO=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},bO=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},qO=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},wO=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>qq(e,a))}return t},vO=t=>typeof t=="string"?t.replace(" ","T"):t,wq=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class _c{constructor(e,r,s={},n=xq){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Um;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Um||(Um={}));class Yn{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Yn.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Yn.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Yn.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(m=>m.presence_ref),f=h.map(m=>m.presence_ref),A=u.filter(m=>f.indexOf(m.presence_ref)<0),g=h.filter(m=>d.indexOf(m.presence_ref)<0);A.length>0&&(a[c]=A),g.length>0&&(l[c]=g)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hm;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Hm||(Hm={}));var $m;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})($m||($m={}));var Ar;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ar||(Ar={}));class ad{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new _c(this,Wt.join,this.params,this.timeout),this.rejoinTimer=new bq(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Wt.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Yn(this),this.broadcastEndpointURL=wq(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(Ar.CHANNEL_ERROR,u)),this._onClose(()=>e?.(Ar.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(Ar.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,A=[];for(let g=0;g<f;g++){const m=d[g],{filter:{event:y,schema:x,table:b,filter:w}}=m,P=u&&u[g];if(P&&P.event===y&&P.schema===x&&P.table===b&&P.filter===w)A.push(Object.assign(Object.assign({},m),{id:P.id}));else{this.unsubscribe(),this.state=st.errored,e?.(Ar.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(Ar.SUBSCRIBED);return}}).receive("error",u=>{this.state=st.errored,e?.(Ar.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(Ar.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Wt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new _c(this,Wt.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new _c(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Wt;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var A,g,m;return((A=f.filter)===null||A===void 0?void 0:A.event)==="*"||((m=(g=f.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var A,g,m,y,x,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,P=(A=f.filter)===null||A===void 0?void 0:A.event;return w&&((g=r.ids)===null||g===void 0?void 0:g.includes(w))&&(P==="*"||P?.toLocaleLowerCase()===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const w=(x=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return w==="*"||w===((b=r?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const A=d.data,{schema:g,table:m,commit_timestamp:y,type:x,errors:b}=A;d=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:y,eventType:x,new:{},old:{},errors:b}),this._getPayloadRecords(A))}f.callback(d,s)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ad.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Wt.close,{},e)}_onError(e){this._on(Wt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Dm(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Dm(e.columns,e.old_record)),r}}const Gm=()=>{},VO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _O{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xq,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gm,this.ref=0,this.logger=Gm,this.conn=null,this.sendBuffer=[],this.serializer=new gO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>er(async()=>{const{default:l}=await Promise.resolve().then(()=>xn);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Cu.websocket}`,this.httpEndpoint=wq(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new bq(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=dO),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:AO}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Wn.connecting:return os.Connecting;case Wn.open:return os.Open;case Wn.closing:return os.Closing;default:return os.Closed}}isConnected(){return this.connectionState()===os.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new ad(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:pO};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Wt.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(mO,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Wt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([VO],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class ld extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ye(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class kO extends ld{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Eu extends ld{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var SO=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const vq=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>er(async()=>{const{default:s}=await Promise.resolve().then(()=>xn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},CO=()=>SO(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield er(()=>Promise.resolve().then(()=>xn),void 0)).Response:Response}),Tu=t=>{if(Array.isArray(t))return t.map(r=>Tu(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Tu(s)}),e};var qs=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const kc=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),PO=(t,e,r)=>qs(void 0,void 0,void 0,function*(){const s=yield CO();t instanceof s&&!r?.noResolveJson?t.json().then(n=>{e(new kO(kc(n),t.status||500))}).catch(n=>{e(new Eu(kc(n),n))}):e(new Eu(kc(t),t))}),EO=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),r))};function vi(t,e,r,s,n,i){return qs(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,EO(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>PO(l,a,s))})})}function Ko(t,e,r,s){return qs(this,void 0,void 0,function*(){return vi(t,"GET",e,r,s)})}function Cr(t,e,r,s,n){return qs(this,void 0,void 0,function*(){return vi(t,"POST",e,s,n,r)})}function TO(t,e,r,s,n){return qs(this,void 0,void 0,function*(){return vi(t,"PUT",e,s,n,r)})}function RO(t,e,r,s){return qs(this,void 0,void 0,function*(){return vi(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Vq(t,e,r,s,n){return qs(this,void 0,void 0,function*(){return vi(t,"DELETE",e,s,n,r)})}var At=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const MO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IO{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=vq(n)}uploadOrUpdate(e,r,s,n){return At(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Wm),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Ye(i))return{data:null,error:i};throw i}})}upload(e,r,s){return At(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return At(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Wm.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(Ye(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return At(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield Cr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new ld("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(Ye(s))return{data:null,error:s};throw s}})}update(e,r,s){return At(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return At(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}})}copy(e,r,s){return At(this,void 0,void 0,function*(){try{return{data:{path:(yield Cr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return At(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Cr(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return At(this,void 0,void 0,function*(){try{const n=yield Cr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}})}download(e,r){return At(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ko(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Ye(a))return{data:null,error:a};throw a}})}info(e){return At(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield Ko(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Tu(s),error:null}}catch(s){if(Ye(s))return{data:null,error:s};throw s}})}exists(e){return At(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield RO(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Ye(s)&&s instanceof Eu){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return At(this,void 0,void 0,function*(){try{return{data:yield Vq(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}})}list(e,r,s){return At(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},MO),r),{prefix:e||""});return{data:yield Cr(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const jO="2.7.1",BO={"X-Client-Info":`storage-js/${jO}`};var Rs=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class OO{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},BO),r),this.fetch=vq(s)}listBuckets(){return Rs(this,void 0,void 0,function*(){try{return{data:yield Ko(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ye(e))return{data:null,error:e};throw e}})}getBucket(e){return Rs(this,void 0,void 0,function*(){try{return{data:yield Ko(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Rs(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ye(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Rs(this,void 0,void 0,function*(){try{return{data:yield TO(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ye(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Rs(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Rs(this,void 0,void 0,function*(){try{return{data:yield Vq(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}})}}class NO extends OO{constructor(e,r={},s){super(e,r,s)}from(e){return new IO(this.url,this.headers,e,this.fetch)}}const zO="2.51.0";let Fn="";typeof Deno<"u"?Fn="deno":typeof document<"u"?Fn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fn="react-native":Fn="node";const FO={"X-Client-Info":`supabase-js-${Fn}/${zO}`},LO={headers:FO},DO={schema:"public"},UO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HO={};var $O=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const GO=t=>{let e;return t?e=t:typeof fetch>"u"?e=fq:e=fetch,(...r)=>e(...r)},WO=()=>typeof Headers>"u"?pq:Headers,YO=(t,e,r)=>{const s=GO(r),n=WO();return(i,o)=>$O(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new n(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},o),{headers:c}))})};var KO=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function XO(t){return t.endsWith("/")?t:t+"/"}function QO(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(s=a?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>KO(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const _q="2.71.0",zs=30*1e3,Ru=3,Sc=Ru*zs,ZO="http://localhost:9999",JO="supabase.auth.token",e2={"X-Client-Info":`gotrue-js/${_q}`},Mu="X-Supabase-Api-Version",kq={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},t2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,r2=10*60*1e3;class cd extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function se(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class s2 extends cd{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function n2(t){return se(t)&&t.name==="AuthApiError"}class Sq extends cd{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class $r extends cd{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Sr extends $r{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function i2(t){return se(t)&&t.name==="AuthSessionMissingError"}class co extends $r{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class uo extends $r{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ho extends $r{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function o2(t){return se(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ym extends $r{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Iu extends $r{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Cc(t){return se(t)&&t.name==="AuthRetryableFetchError"}class Km extends $r{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class ju extends $r{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xm=` 	
\r=`.split(""),a2=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Xm.length;e+=1)t[Xm[e].charCodeAt(0)]=-2;for(let e=0;e<Xo.length;e+=1)t[Xo[e].charCodeAt(0)]=e;return t})();function Qm(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Xo[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Xo[s]),e.queuedBits-=6}}function Cq(t,e,r){const s=a2[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Zm(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{u2(o,s,r)};for(let o=0;o<t.length;o+=1)Cq(t.charCodeAt(o),n,i);return e.join("")}function l2(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function c2(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}l2(s,e)}}function u2(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function h2(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Cq(t.charCodeAt(n),r,s);return new Uint8Array(e)}function d2(t){const e=[];return c2(t,r=>e.push(r)),new Uint8Array(e)}function f2(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>Qm(n,r,s)),Qm(null,r,s),e.join("")}function p2(t){return Math.round(Date.now()/1e3)+t}function A2(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Gt=()=>typeof window<"u"&&typeof document<"u",Yr={tested:!1,writable:!1},Pq=()=>{if(!Gt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Yr.tested)return Yr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Yr.tested=!0,Yr.writable=!0}catch{Yr.tested=!0,Yr.writable=!1}return Yr.writable};function m2(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Eq=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>er(async()=>{const{default:s}=await Promise.resolve().then(()=>xn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},g2=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Fs=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Kr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},kr=async(t,e)=>{await t.removeItem(e)};class qa{constructor(){this.promise=new qa.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}qa.promiseConstructor=Promise;function Pc(t){const e=t.split(".");if(e.length!==3)throw new ju("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!t2.test(e[s]))throw new ju("JWT not in base64url format");return{header:JSON.parse(Zm(e[0])),payload:JSON.parse(Zm(e[1])),signature:h2(e[2]),raw:{header:e[0],payload:e[1]}}}async function y2(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function x2(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function b2(t){return("0"+t.toString(16)).substr(-2)}function q2(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,b2).join("")}async function w2(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function v2(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await w2(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ms(t,e,r=!1){const s=q2();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Fs(t,`${e}-code-verifier`,n);const i=await v2(s);return[i,s===i?"plain":"s256"]}const V2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _2(t){const e=t.headers.get(Mu);if(!e||!e.match(V2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function k2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function S2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const C2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Is(t){if(!C2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ec(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var P2=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const rs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),E2=[502,503,504];async function Jm(t){var e;if(!g2(t))throw new Iu(rs(t),0);if(E2.includes(t.status))throw new Iu(rs(t),t.status);let r;try{r=await t.json()}catch(i){throw new Sq(rs(i),i)}let s;const n=_2(t);if(n&&n.getTime()>=kq["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Km(rs(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Sr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Km(rs(r),t.status,r.weak_password.reasons);throw new s2(rs(r),t.status||500,s)}const T2=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function ue(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[Mu]||(i[Mu]=kq["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await R2(t,e,r+a,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function R2(t,e,r,s,n,i){const o=T2(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new Iu(rs(l),0)}if(a.ok||await Jm(a),s?.noResolveJson)return a;try{return await a.json()}catch(l){await Jm(l)}}function pr(t){var e;let r=null;B2(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=p2(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function eg(t){const e=pr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Tr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function M2(t){return{data:t,error:null}}function I2(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=P2(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function j2(t){return t}function B2(t){return t.access_token&&t.refresh_token&&t.expires_in}const Tc=["global","local","others"];var O2=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class N2{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Eq(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Tc[0]){if(Tc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Tc.join(", ")}`);try{return await ue(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Tr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=O2(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:I2,redirectTo:r?.redirectTo})}catch(r){if(se(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ue(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Tr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:j2});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(A=>{const g=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(A.split(";")[1].split("=")[1]);c[`${m}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(se(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Is(e);try{return await ue(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Tr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Is(e);try{return await ue(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Tr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Is(e);try{return await ue(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Tr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Is(e.userId);try{const{data:r,error:s}=await ue(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(se(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Is(e.userId),Is(e.id);try{return{data:await ue(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}}function tg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function z2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const js={debug:!!(globalThis&&Pq()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Tq extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class F2 extends Tq{}async function L2(t,e,r){js.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),js.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){js.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{js.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw js.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new F2(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(js.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}z2();const D2={url:ZO,storageKey:JO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:e2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rg(t,e,r){return await r()}const Bs={};class hi{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hi.nextInstanceID,hi.nextInstanceID+=1,this.instanceID>0&&Gt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},D2),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new N2({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Eq(n.fetch),this.lock=n.lock||rg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Gt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=L2:this.lock=rg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Pq()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tg(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=tg(this.memoryStorage)),Gt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Bs[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Bs[this.storageKey]=Object.assign(Object.assign({},Bs[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Bs[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Bs[this.storageKey]=Object.assign(Object.assign({},Bs[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_q}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=m2(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),Gt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),o2(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return se(r)?{error:r}:{error:new Sq("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:pr}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,A=null;this.flowType==="pkce"&&([f,A]=await Ms(this.storage,this.storageKey)),i=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:A},xform:pr})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:pr})}else throw new uo("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:eg})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:eg})}else throw new uo("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new co}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,l,c,u,h,d,f;let A,g;if("message"in e)A=e.message,g=e.signature;else{const{chain:m,wallet:y,statement:x,options:b}=e;let w;if(Gt())if(typeof y=="object")w=y;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))w=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const P=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const C=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),x?{statement:x}:null));let E;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")E=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)E=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)A=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${P.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(n=(s=b?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=b?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((c=b?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(u=b?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const C=await w.signMessage(new TextEncoder().encode(A),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:m,error:y}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:f2(g)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:pr});if(y)throw y;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new co}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:y})}catch(m){if(se(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const r=await Kr(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:pr});if(await kr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new co}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(se(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:pr}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new co}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ms(this.storage,this.storageKey));const{error:h}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new uo("You must provide either an email or phone number.")}catch(a){if(se(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:pr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(se(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ms(this.storage,this.storageKey)),await ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:M2})}catch(i){if(se(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Sr;const{error:n}=await ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(se(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new uo("You must provide either an email or phone number and a type")}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Kr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Sc:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Kr(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Ec()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Tr}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Sr}:await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Tr})})}catch(r){if(se(r))return i2(r)&&(await this._removeSession(),await kr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Sr;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ms(this.storage,this.storageKey));const{data:c,error:u}=await ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Tr});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Sr;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=Pc(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(se(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Sr;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Gt())throw new ho("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ho(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ym("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ho("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ym("No code detected.");const{data:x,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new ho("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=zs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const A=d-h;u-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,d,u):u-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,d,u);const{data:g,error:m}=await this._getUser(i);if(m)throw m;const y={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(se(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Kr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(n2(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await kr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=A2(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ms(this.storage,this.storageKey,!0));try{return await ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(se(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ue(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Gt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(se(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await ue(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await x2(async n=>(n>0&&await y2(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pr})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Cc(i)&&Date.now()+o-s<zs})}catch(s){if(this._debug(r,"error",s),se(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Gt()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Kr(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Kr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await Fs(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:Ec()}else if(n&&!n.user&&!n.user){const o=await Kr(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await kr(this.storage,this.storageKey+"-user"),await Fs(this.storage,this.storageKey,n)):n.user=Ec()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Sc;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Sc}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Cc(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Sr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new qa;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Sr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),se(i)){const o={session:null,error:i};return Cc(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Fs(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=structuredClone(n);await Fs(this.storage,this.storageKey,i)}else{const n=structuredClone(r);await Fs(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await kr(this.storage,this.storageKey),await kr(this.storage,this.storageKey+"-code-verifier"),await kr(this.storage,this.storageKey+"-user"),this.userStorage&&await kr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Gt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),zs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/zs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${zs}ms, refresh threshold is ${Ru} ticks`),n<=Ru&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Tq)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Gt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ms(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await ue(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await ue(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=e?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Pc(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+r2>n)return s;const{data:i,error:o}=await ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:A}=await this.getSession();if(A||!f.session)return{data:null,error:A};s=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=Pc(s);r?.allowExpired||k2(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const u=S2(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,d2(`${a}.${l}`)))throw new ju("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}}hi.nextInstanceID=0;const U2=hi;class H2 extends U2{constructor(e){super(e)}}var $2=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class G2{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=XO(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:DO,realtime:HO,auth:Object.assign(Object.assign({},UO),{storageKey:c}),global:LO},h=QO(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=YO(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new uO(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new ZB(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new NO(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return $2(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new H2({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new _O(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const W2=(t,e,r)=>new G2(t,e,r),Y2=W2("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),K2=async t=>{const e=await Y2.rpc("get_latest_campaign",{p_name:t.name,p_created_by:t.createdBy,p_version:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const r=await dq(e.data.data);return Object.values(r.rooms).forEach(s=>{delete s.size}),r},X2=ln(()=>er(()=>import("./testCampaign-CUhr3zP2.js"),__vite__mapDeps([11,10,4,5]))),Q2=v.lazy(Wj),Z2=async t=>{const e=aa(),r=e.get("campaignData"),s=e.get("campaignAuthor"),n=e.get("campaignName"),i=s&&n;if(r)return dq(r);if(i)return K2({name:n,createdBy:s});if(t){const[{campaign:o},{testCampaign:a}]=await Promise.all([gu(),X2()]);return{...o,rooms:{...o.rooms,...a.rooms}}}else return(await gu()).campaign},sg=ln(t=>Promise.all([Yj(),Z2(t),yE(),BB()])),J2=()=>{const[t,e]=v.useState(),r=Zs(),s=Bh(),n=py(),{loadingStarted:i,loadingFinished:o}=UE();return v.useEffect(()=>{if(!r){e(void 0),sg(n);return}let a=!1,l;return(async()=>{try{i();const[{default:u},h]=await sg(n);o(),a||(l=await u(h,s),e(l))}catch(u){ke.dispatch(Cy(cq(u)))}})(),()=>{l?.stop(),a=!0}},[n,r,s,i,o]),t},eN=()=>{const[t,e]=v.useState(null),r=py(),s=J2(),n=le(x0),i=OB();return NB(),v.useEffect(()=>{t===null||s===void 0||(s.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[s,t]),v.useEffect(()=>{s?.resizeTo(n)},[n,s]),p.jsxs(p.Fragment,{children:[p.jsx("div",{style:i,ref:e}),p.jsxs(z0,{gameApi:s,children:[p.jsxs(zB,{children:[p.jsx(LP,{}),p.jsx(Gj,{})]}),s&&r&&p.jsx(v.Suspense,{fallback:null,children:p.jsx(Q2,{})})]})]})},tN=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"loading-border"}),p.jsxs(Ee,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:Ys.map(t=>p.jsx("span",{className:`sprite ${tn({action:"idle",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(N,{className:"sprites-double-height mb-1",children:"This is not the editor"}),p.jsxs(ht,{className:`${ve} p-1 pt-2 text-metallicBlue`,children:[p.jsx("p",{children:"If youre seeing this, youre trying to access the level editor, but the web manifest is getting in the way and redirected you to the games client-side routing."}),p.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",p.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),p.jsx("div",{className:"flex flex-col",children:Ys.toReversed().map(t=>p.jsx("span",{className:`sprite ${tn({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),rN=()=>p.jsxs(Ue,{children:[p.jsx(tt,{className:"loading-border"}),p.jsxs(Ee,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:Ys.map(t=>p.jsx("span",{className:`sprite ${tn({action:"walking",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(N,{className:"sprites-double-height",children:"404 Not found"}),p.jsx(N,{className:`${ve} p-1 pt-2 text-metallicBlue`,children:"whatever youre looking for, it aint here"})]}),p.jsx("div",{className:"flex flex-col",children:Ys.toReversed().map(t=>p.jsx("span",{className:`sprite ${tn({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),sN=()=>{const t=lh();return v.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),p.jsxs(rw,{children:[p.jsx(_i,{path:"/",children:p.jsx(Hs,{children:p.jsx(OP,{children:p.jsx(DE,{children:p.jsx(eN,{})})})})}),p.jsx(_i,{path:"/sprites",children:p.jsx(N0,{})}),p.jsx(_i,{path:"/editor",children:p.jsx(Hs,{children:p.jsx(tN,{})})}),p.jsx(_i,{children:p.jsx(Hs,{children:p.jsx(rN,{})})})]})},nN=()=>p.jsx(eV,{store:ke,children:p.jsx(sN,{})}),$z=Object.freeze(Object.defineProperty({__proto__:null,App:nN},Symbol.toStringTag,{value:"Module"}));export{je as $,aw as A,re as B,hh as C,Oz as D,Pj as E,Ry as F,ts as G,oq as H,FN as I,Gc as J,EN as K,ls as L,Pz as M,H0 as N,Xf as O,Qb as P,cN as Q,Rc as R,TN as S,$c as T,km as U,eS as V,ke as W,fe as X,uz as Y,We as Z,de as _,mN as a,bM as a$,Sm as a0,KN as a1,$N as a2,t_ as a3,Zn as a4,at as a5,Mk as a6,J as a7,xt as a8,No as a9,ua as aA,px as aB,P1 as aC,xr as aD,$y as aE,Qt as aF,Xk as aG,qp as aH,qS as aI,Me as aJ,Re as aK,vp as aL,Rl as aM,_p as aN,Jk as aO,et as aP,Yy as aQ,ZS as aR,g1 as aS,x1 as aT,V1 as aU,k1 as aV,S1 as aW,pa as aX,U_ as aY,pT as aZ,hT as a_,cr as aa,_e as ab,qt as ac,yi as ad,US as ae,Bp as af,Le as ag,GS as ah,yt as ai,Jn as aj,yo as ak,Vh as al,nx as am,ur as an,yx as ao,aA as ap,me as aq,m1 as ar,y1 as as,w1 as at,_1 as au,bx as av,_h as aw,Ae as ax,au as ay,xk as az,Kf as b,gv as b$,yM as b0,dn as b1,C_ as b2,vR as b3,_R as b4,kR as b5,CR as b6,PR as b7,TR as b8,ER as b9,yN as bA,Vz as bB,Yu as bC,_y as bD,_u as bE,fz as bF,xE as bG,gN as bH,Mg as bI,qN as bJ,ms as bK,w0 as bL,Yx as bM,EP as bN,RP as bO,Uu as bP,Mc as bQ,nz as bR,Ig as bS,fo as bT,e_ as bU,Ez as bV,ze as bW,cw as bX,mg as bY,Mr as bZ,kz as b_,SR as ba,AR as bb,RE as bc,Oq as bd,N as be,Hs as bf,Qu as bg,_N as bh,HN as bi,QN as bj,kN as bk,Pr as bl,ZN as bm,Cj as bn,lz as bo,Xc as bp,GI as bq,Vr as br,Dr as bs,Ot as bt,Bw as bu,Lw as bv,Et as bw,Pe as bx,ti as by,lA as bz,PN as c,Zw as c$,_z as c0,Sz as c1,Cz as c2,mu as c3,iz as c4,rd as c5,nw as c6,lw as c7,uw as c8,wI as c9,be as cA,di as cB,Ys as cC,sw as cD,Kt as cE,zN as cF,IN as cG,s_ as cH,bI as cI,lm as cJ,wz as cK,vz as cL,bz as cM,xz as cN,pz as cO,Rj as cP,by as cQ,Mj as cR,RN as cS,$0 as cT,hz as cU,V0 as cV,qI as cW,gz as cX,yz as cY,lN as cZ,qz as c_,Fe as ca,CN as cb,U0 as cc,qy as cd,Ku as ce,gg as cf,Pt as cg,DN as ch,H as ci,ky as cj,UN as ck,GN as cl,n_ as cm,YN as cn,XN as co,cz as cp,Wo as cq,Je as cr,L_ as cs,nt as ct,MN as cu,tz as cv,pN as cw,dh as cx,VN as cy,aN as cz,Te as d,Oo as d$,sd as d0,Ln as d1,NN as d2,jN as d3,BN as d4,r_ as d5,LN as d6,ON as d7,Py as d8,HI as d9,kg as dA,ty as dB,iV as dC,P0 as dD,k0 as dE,KI as dF,bt as dG,Cy as dH,cq as dI,JN as dJ,vN as dK,SN as dL,ch as dM,Az as dN,mz as dO,aa as dP,Nz as dQ,WN as dR,yk as dS,Iz as dT,VC as dU,Ex as dV,Op as dW,jp as dX,dA as dY,EC as dZ,bk as d_,$I as da,hN as db,dN as dc,uN as dd,ez as de,td as df,Wu as dg,IB as dh,zz as di,Zu as dj,Bz as dk,dz as dl,VI as dm,sh as dn,PV as dp,pv as dq,bN as dr,Sg as ds,Ai as dt,Tz as du,iq as dv,jz as dw,Ns as dx,MI as dy,ow as dz,Rz as e,fu as e0,uA as e1,Mx as e2,$z as e3,or as f,um as g,Bo as h,oj as i,Mz as j,mm as k,Du as l,Vo as m,fi as n,pe as o,Fu as p,hs as q,Be as r,xN as s,Ag as t,Zo as u,it as v,Eg as w,Ls as x,fN as y,AN as z};
