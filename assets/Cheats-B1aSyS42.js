import{r as d,j as e}from"./index-BndJllJT.js";import{u as V,c as K,a as X,P as k,b as Q,d as W,e as Y,f as Z,g as A,h as ee,B as i,i as te,C as se,j as ae,k as oe,l as re,m as ne,n as le,S as ce}from"./ShowBoundingBoxSelect-BkZn_3fG.js";import{j as R,k as y,l as $,C as D,n as ie,q as de,r as me,t as ue,w as he,B as F,S as pe,x as xe,y as C,A as M,E as ge,F as z,H as fe,I as je,J as we,K as be}from"./App-B7olYmBA.js";import{c as w}from"./changeCharacterRoom-D7p7stiV.js";var S="Collapsible",[ve,Be]=K(S),[Ne,I]=ve(S),J=d.forwardRef((a,s)=>{const{__scopeCollapsible:c,open:r,defaultOpen:o,disabled:t,onOpenChange:n,...m}=a,[u=!1,x]=V({prop:r,defaultProp:o,onChange:n});return e.jsx(Ne,{scope:c,disabled:t,contentId:X(),open:u,onOpenToggle:d.useCallback(()=>x(b=>!b),[x]),children:e.jsx(k.div,{"data-state":P(u),"data-disabled":t?"":void 0,...m,ref:s})})});J.displayName=S;var G="CollapsibleTrigger",U=d.forwardRef((a,s)=>{const{__scopeCollapsible:c,...r}=a,o=I(G,c);return e.jsx(k.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":P(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...r,ref:s,onClick:Q(a.onClick,o.onOpenToggle)})});U.displayName=G;var T="CollapsibleContent",q=d.forwardRef((a,s)=>{const{forceMount:c,...r}=a,o=I(T,a.__scopeCollapsible);return e.jsx(W,{present:c||o.open,children:({present:t})=>e.jsx(Ce,{...r,ref:s,present:t})})});q.displayName=T;var Ce=d.forwardRef((a,s)=>{const{__scopeCollapsible:c,present:r,children:o,...t}=a,n=I(T,c),[m,u]=d.useState(r),x=d.useRef(null),b=Y(s,x),O=d.useRef(0),B=O.current,E=d.useRef(0),H=E.current,v=n.open||m,_=d.useRef(v),j=d.useRef(void 0);return d.useEffect(()=>{const h=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(h)},[]),Z(()=>{const h=x.current;if(h){j.current=j.current||{transitionDuration:h.style.transitionDuration,animationName:h.style.animationName},h.style.transitionDuration="0s",h.style.animationName="none";const L=h.getBoundingClientRect();O.current=L.height,E.current=L.width,_.current||(h.style.transitionDuration=j.current.transitionDuration,h.style.animationName=j.current.animationName),u(r)}},[n.open,r]),e.jsx(k.div,{"data-state":P(n.open),"data-disabled":n.disabled?"":void 0,id:n.contentId,hidden:!v,...t,ref:b,style:{"--radix-collapsible-content-height":B?`${B}px`:void 0,"--radix-collapsible-content-width":H?`${H}px`:void 0,...a.style},children:v&&o})});function P(a){return a?"open":"closed"}const ke=()=>{const a=R(),[s,c]=d.useState(a?.currentRoom?.id);return d.useEffect(()=>(c(a.currentRoom?.id),y({actionCreator:$,effect(o){c(o.payload.roomId)}})),[a]),s};function Re({gameApi:a,className:s}){const[c,r]=d.useState(!1),o=ke();if(a===void 0)return null;const t=Object.keys(a.campaign.rooms);return e.jsxs(A,{open:c,onOpenChange:r,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(i,{role:"combobox","aria-expanded":c,className:`justify-between ${s}`,children:[o||"Select a room",e.jsx("span",{className:`sprite ml-2 h-4 w-4 shrink-0 ${c?"texture-hud.char.X":"texture-hud.char.â¬‡"}`})]})}),e.jsx(te,{className:"p-0 z-cheats",children:e.jsx(D,{scaleFactor:1,children:e.jsxs(se,{className:"w-[--radix-popper-anchor-width]",children:[e.jsx(ae,{placeholder:"Room id"}),e.jsxs(oe,{children:[e.jsx(re,{children:"No room found"}),e.jsx(ne,{children:t.map(n=>e.jsxs(le,{value:n,className:o===n?"bg-moss":"",onSelect:m=>{a.changeRoom(m),r(!1)},children:[a.gameState.characterRooms.head?.id===n&&e.jsx("span",{className:"sprite m-1 texture-head.walking.towards.2"}),a.gameState.characterRooms.heels?.id===n&&e.jsx("span",{className:"sprite m-1 texture-heels.walking.towards.2"}),n]},n))})]})]})})})]})}const ye=a=>{d.useEffect(()=>{if(a===void 0)return;const s=t=>{const n=t.hash.substring(1);if(n!==""&&a.campaign.rooms[n]!==void 0)return t.hash.substring(1)};if(window.location.hash){const t=s(window.location);t!==void 0&&a.currentRoom?.id!==t&&a.changeRoom(t)}const c=t=>{const n=s(new URL(t.newURL));n!==void 0&&n!==a.currentRoom?.id&&a.changeRoom(n)},r=t=>{window.location.hash=t};window.addEventListener("hashchange",c);const o=y({actionCreator:$,effect(t){r(t.payload.roomId)}});return()=>{window.removeEventListener("hashchange",c),o()}},[a])},Se=()=>{const a=R();d.useEffect(()=>y({actionCreator:ie,effect(c){const r=c.payload.item;if(de("teleporter","doorFrame")(r)){const{toRoom:o}=r.config;a.changeRoom(o)}if(r.type==="lift"){const o=a.currentRoom?.roomAbove;o&&a.changeRoom(o)}if(r.type==="floorEdge"){const o=a.currentRoom?.roomBelow;o&&a.changeRoom(o)}console.log(r.id,"item (live):",r,`
state (shallow copy):`,{...r.state},`
position`,`(${r.state.position.x}, ${r.state.position.y}, ${r.state.position.z})`,`
stoodOnBy:`,Object.keys(r.state.stoodOnBy),`
standingOn:`,me(r)?r.state.standingOnItemId:"n/a (not free to move)"),window.item=r}}))},p=({gameApi:a,speed:s,className:c})=>e.jsx(i,{className:c,onClick:r=>{a.gameState.gameSpeed=s,r.currentTarget.blur()},children:s.toString().replace(/^0\./,".")}),l="flex-1 h-3",N=({gameApi:a,playableName:s})=>e.jsx(i,{className:l,onClick:c=>{if(a.gameState.currentCharacterName===s)return;const r=C(a.gameState)?.id;if(r===void 0)return;if(a.gameState.currentCharacterName=s,s==="headOverHeels"){const t=z("head",a.gameState.characterRooms.head?.items),n=z("heels",a.gameState.characterRooms.heels?.items);if(!t||!n)console.log("cant summon headOverHeels - one of the individuals is not in the game to combine");else{w({playableItem:t,gameState:a.gameState,changeType:"level-select",toRoomId:"finalroom"}),w({playableItem:n,gameState:a.gameState,changeType:"level-select",toRoomId:"finalroom"}),fe(a.gameState);const m=a.gameState.characterRooms.headOverHeels.items.headOverHeels;w({playableItem:m,gameState:a.gameState,changeType:"level-select",toRoomId:r})}}const o=je(a.gameState,s);if(o===void 0){console.error(`can't summon ${s} who is not in the game`);return}w({playableItem:o,gameState:a.gameState,changeType:"level-select",toRoomId:r}),c.currentTarget.blur()},children:s==="headOverHeels"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sprite texture-head.walking.right.2 [button:hover_&]:texture-animated-head.walking.towards"}),"over",e.jsx("span",{className:"sprite texture-heels.walking.right.2 [button:hover_&]:texture-animated-heels.walking.towards"})]}):e.jsx("span",{className:`sprite texture-${s}.walking.right.2 [button:hover_&]:texture-animated-${s}.walking.towards`})}),g=({gameApi:a,roomId:s,children:c})=>e.jsx(i,{className:l,onClick:r=>{a.changeRoom(s),r.currentTarget.blur()},children:c||s}),f=({children:a})=>e.jsx("h4",{className:"bg-redShadow zx:bg-zxMagenta pl-1",children:a}),Ee=a=>{const s=R();Se();const c=ue(),r=he();ye(s);const o=(t,n)=>{const{gameState:m}=s,u=M(m);if(u===void 0)return;const x=C(m);x!==void 0&&we({gameState:m,room:x,itemType:t,config:n,position:{...u.state.position,z:u.state.position.z+be.h*2}})};return e.jsxs(J,{children:[e.jsx(U,{className:"absolute bottom-0 right-1 flex flex-col z-cheats text-midRed hover:text-metallicBlue ",onClick:t=>t.currentTarget.blur(),children:e.jsx("span",{className:"sprite texture-helicopterBug.1 hover:texture-animated-helicopterBug zx:sprite-revert-to-two-tone"})}),e.jsx(q,{children:e.jsx(D,{scaleFactor:2,children:e.jsxs("div",{className:"absolute bottom-[48px] max-h-[calc(100vh-48px)] right-1 flex flex-col w-[500px] zx:[&_.sprite]:sprite-revert-to-white overflow-y-scroll z-cheats text-white",children:[e.jsx(f,{children:"room select:"}),e.jsx(Re,{gameApi:s,className:"w-full"}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(g,{gameApi:s,roomId:"blacktooth1head",children:"Starting room"}),e.jsx(g,{gameApi:s,roomId:"laboratory",children:"To the lab!"})]}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(g,{gameApi:s,roomId:"blacktooth45market",children:"Market"}),e.jsx(g,{gameApi:s,roomId:"moonbase1",children:"Moonbase"}),e.jsx(g,{gameApi:s,roomId:"egyptus1",children:"Egyptus"}),e.jsx(g,{gameApi:s,roomId:"safari1",children:"Safari"}),e.jsx(g,{gameApi:s,roomId:"bookworld1",children:"Bookworld"}),e.jsx(g,{gameApi:s,roomId:"penitentiary1",children:"Penitentiary"})]}),e.jsx(f,{children:"debug rendering:"}),e.jsxs("div",{className:"flex flex-row items-center gap-x-1 justify-center pb-1 pt-1 bg-shadow text-white",children:[e.jsx(F,{children:"BBs:"}),e.jsx(ce,{}),e.jsx(F,{children:"shadow:"}),e.jsx(pe,{value:c,onClick:(t,n)=>{r(xe(n)),t.currentTarget.blur()}})]}),e.jsx(f,{children:"summon character:"}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(N,{gameApi:s,playableName:"head"}),e.jsx(N,{gameApi:s,playableName:"heels"}),e.jsx(N,{gameApi:s,playableName:"headOverHeels"})]}),e.jsx(f,{children:"summon item:"}),e.jsxs("div",{className:"flex flex-row items-center flex-wrap",children:[e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"bag"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-bag"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"hooter"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-hooter"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"doughnuts"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-doughnuts"})}),e.jsx(i,{className:l,onClick:t=>{o("portableBlock",{style:"cube"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-cube"})}),e.jsx(i,{className:l,onClick:t=>{o("spring",{}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-spring.released"})}),e.jsx(i,{className:l,onClick:t=>{o("monster",{which:"dalek",activated:"on",movement:"patrol-randomly-diagonal"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-dalek.1 hover:texture-animated-dalek"})}),e.jsx(i,{className:l,onClick:t=>{o("monster",{which:"turtle",activated:"on",movement:"clockwise",startDirection:"towards"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-turtle.towards.1 hover:texture-animated-turtle.towards"})}),e.jsx(i,{className:l,onClick:t=>{o("monster",{which:"skiHead",activated:"on",movement:"clockwise",startDirection:"towards",style:Math.random()>.5?"greenAndPink":"starsAndStripes"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-skiHead.greenAndPink.towards"})})]}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"crown",planet:"bookworld"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-crown.bookworld"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"crown",planet:"egyptus"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-crown.egyptus"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"crown",planet:"safari"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-crown.safari"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"crown",planet:"penitentiary"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-crown.penitentiary"})}),e.jsx(i,{className:l,onClick:t=>{o("pickup",{gives:"crown",planet:"blacktooth"}),t.currentTarget.blur()},children:e.jsx("span",{className:"sprite texture-crown.blacktooth"})})]}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsxs(i,{className:l,onClick:t=>{o("pickup",{gives:"extra-life"}),t.currentTarget.blur()},children:[e.jsx("span",{className:"sprite texture-whiteRabbit"}),e.jsx("span",{className:"sprite texture-hud.char.2 left-m2 relative"})]}),e.jsxs(i,{className:l,onClick:t=>{o("pickup",{gives:"shield"}),t.currentTarget.blur()},children:[e.jsx("span",{className:"sprite texture-whiteRabbit"}),e.jsx("span",{className:"sprite texture-hud.char.ðŸ›¡ left-m2 relative"})]}),e.jsxs(i,{className:l,onClick:t=>{o("pickup",{gives:"fast"}),t.currentTarget.blur()},children:[e.jsx("span",{className:"sprite texture-whiteRabbit"}),e.jsx("span",{className:"sprite texture-hud.char.âš¡ left-m2 relative"})]}),e.jsxs(i,{className:l,onClick:t=>{o("pickup",{gives:"jumps"}),t.currentTarget.blur()},children:[e.jsx("span",{className:"sprite texture-whiteRabbit"}),e.jsx("span",{className:"sprite texture-hud.char.â™¨ left-m2 relative"})]})]}),e.jsx(f,{children:"game speed x:"}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(p,{className:l,speed:.05,gameApi:s}),e.jsx(p,{className:l,speed:.2,gameApi:s}),e.jsx(p,{className:l,speed:.5,gameApi:s}),e.jsx(p,{className:l,speed:1,gameApi:s}),e.jsx(p,{className:l,speed:2,gameApi:s}),e.jsx(p,{className:l,speed:5,gameApi:s}),e.jsx(p,{className:l,speed:10,gameApi:s}),e.jsx(p,{className:l,speed:25,gameApi:s}),e.jsx(p,{className:l,speed:100,gameApi:s})]}),e.jsx(f,{children:"write to console:"}),e.jsxs("div",{className:"flex flex-row items-center flex-wrap",children:[e.jsx(i,{className:"flex-grow h-3",onClick:t=>{s&&(console.log(s.gameState),window.gs=s.gameState,console.log("gameState on window.gs")),t.currentTarget.blur()},children:"gameState"}),e.jsx(i,{className:"flex-grow h-3",onClick:t=>{if(s){const n=C(s.gameState)?.roomJson;window.roomJson=n,console.log("roomJson:",n),console.log("roomJson on window.roomJson")}t.currentTarget.blur()},children:"Room JSON"}),e.jsx(i,{className:"flex-grow h-3",onClick:t=>{s&&(window.room=s.currentRoom,console.log(s.currentRoom),console.log("currentRoom on window.room")),t.currentTarget.blur()},children:"Room state"}),e.jsxs(i,{className:"flex-grow",onClick:t=>{if(s){const n=M(s.gameState);if(n===void 0){console.log("no playable item");return}if(window.playable=n,console.log("currentCharacterName:",n),console.log("playable on window.playable"),n.id!=="headOverHeels"){const m=ge(n.id),u=s.gameState.characterRooms[m];console.log(m,"in room",u?.id,u?.items[m])}}t.currentTarget.blur()},children:[e.jsx("span",{className:"sprite texture-head.walking.right.2"}),e.jsx("span",{className:"sprite texture-heels.walking.right.2"})]})]})]})})})]})};export{Ee as Cheats,g as GoToRoomButton,Ee as default};
