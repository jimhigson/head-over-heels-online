const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WebGPURenderer-DwWfsku6.js","assets/index-DUlczrPk.js","assets/index-DLF7xdJ5.css","assets/colorToUniform-JePGKAsh.js","assets/SharedSystems-BrdWbLbY.js","assets/Graphics-BQ6AQWyT.js","assets/WebGLRenderer-BMk7Dc4p.js"])))=>i.map(i=>d[i]);
import{u as Pn,y as $n,z as Ot,e as At,E as Oe,c as En,C as S,d as We,v as Ue,Y as F,D as gt,a4 as Gt,K as zt,a as _e,b as Ee,U as Sn,V as Fn,a5 as Rn,a6 as Mn,a7 as In,a8 as He,a9 as hr,aa as fr,ab as se,ac as pr,ad as we,ae as re,af as yr,ag as Ln,ah as Dn,ai as Nn,aj as Bn,ak as gr,al as Z,am as Wn,an as Un,ao as ae}from"./index-DUlczrPk.js";import{S as Hn,G as Ve}from"./Graphics-BQ6AQWyT.js";const mr=class mt extends Pn{constructor(t){t={...mt.defaultOptions,...t},super(t),this.enabled=!0,this._state=Hn.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.addResource("uTexture",0,1)}apply(t,r,n,o){t.applyFilter(this,r,n,o)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:r,gl:n,...o}=t;let i,s;return r&&(i=$n.from(r)),n&&(s=Ot.from(n)),new mt({gpuProgram:i,glProgram:s,...o})}};mr.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1};let xr=mr;const xt=[];At.handleByNamedList(Oe.Environment,xt);async function Vn(e){if(!e)for(let t=0;t<xt.length;t++){const r=xt[t];if(r.value.test()){await r.value.load();return}}}let be;function Gn(){if(typeof be=="boolean")return be;try{be=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{be=!1}return be}var wr=(e=>(e[e.NONE=0]="NONE",e[e.COLOR=16384]="COLOR",e[e.STENCIL=1024]="STENCIL",e[e.DEPTH=256]="DEPTH",e[e.COLOR_DEPTH=16640]="COLOR_DEPTH",e[e.COLOR_STENCIL=17408]="COLOR_STENCIL",e[e.DEPTH_STENCIL=1280]="DEPTH_STENCIL",e[e.ALL=17664]="ALL",e))(wr||{});class Xn{constructor(t){this.items=[],this._name=t}emit(t,r,n,o,i,s,a,c){const{name:f,items:d}=this;for(let b=0,m=d.length;b<m;b++)d[b][f](t,r,n,o,i,s,a,c);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const r=this.items.indexOf(t);return r!==-1&&this.items.splice(r,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const jn=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],br=class vr extends En{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const r=[...jn,...this.config.runners??[]];this._addRunners(...r),this._unsafeEvalCheck()}async init(t={}){const r=t.skipExtensionImports===!0?!0:t.manageImports===!1;await Vn(r),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)t={...this._systemsHash[n].constructor.defaultOptions,...t};t={...vr.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(t);this._initOptions=t}render(t,r){let n=t;if(n instanceof S&&(n={container:n},r&&(We(Ue,"passing a second argument is deprecated, please use render options instead"),n.target=r.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor=this.background.colorRgba),n.clearColor){const o=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=o?n.clearColor:F.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(t,r,n){const o=this.view.resolution;this.view.resize(t,r,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==o&&this.runners.resolutionChange.emit(n)}clear(t={}){const r=this;t.target||(t.target=r.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=wr.ALL);const{clear:n,clearColor:o,target:i}=t;F.shared.setValue(o??this.background.colorRgba),r.renderTarget.clear(i,n,F.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(r=>{this.runners[r]=new Xn(r)})}_addSystems(t){let r;for(r in t){const n=t[r];this._addSystem(n.value,n.name)}}_addSystem(t,r){const n=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const o in this.runners)this.runners[o].add(n);return this}_addPipes(t,r){const n=r.reduce((o,i)=>(o[i.name]=i.value,o),{});t.forEach(o=>{const i=o.value,s=o.name,a=n[s];this.renderPipes[s]=new i(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(r=>{r.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Gn())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};br.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let _r=br,Se;function qn(e){return Se!==void 0||(Se=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:e??_r.defaultOptions.failIfMajorPerformanceCaveat};try{if(!gt.get().getWebGLRenderingContext())return!1;let n=gt.get().createCanvas().getContext("webgl",t);const o=!!n?.getContextAttributes()?.stencil;if(n){const i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}return n=null,o}catch{return!1}})()),Se}let Fe;async function Yn(e={}){return Fe!==void 0||(Fe=await(async()=>{const t=gt.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(e)).requestDevice(),!0}catch{return!1}})()),Fe}const Xt=["webgl","webgpu","canvas"];async function Kn(e){let t=[];e.preference?(t.push(e.preference),Xt.forEach(i=>{i!==e.preference&&t.push(i)})):t=Xt.slice();let r,n={};for(let i=0;i<t.length;i++){const s=t[i];if(s==="webgpu"&&await Yn()){const{WebGPURenderer:a}=await Gt(async()=>{const{WebGPURenderer:c}=await import("./WebGPURenderer-DwWfsku6.js");return{WebGPURenderer:c}},__vite__mapDeps([0,1,2,3,4,5]));r=a,n={...e,...e.webgpu};break}else if(s==="webgl"&&qn(e.failIfMajorPerformanceCaveat??_r.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Gt(async()=>{const{WebGLRenderer:c}=await import("./WebGLRenderer-BMk7Dc4p.js");return{WebGLRenderer:c}},__vite__mapDeps([6,1,2,3,4,5]));r=a,n={...e,...e.webgl};break}else if(s==="canvas")throw n={...e},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!r)throw new Error("No available renderer for the current environment");const o=new r;return await o.init(n),o}const Cr="8.4.1";class kr{static init(){globalThis.__PIXI_APP_INIT__?.(this,Cr)}static destroy(){}}kr.extension=Oe.Application;class Zn{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Cr)}destroy(){this._renderer=null}}Zn.extension={type:[Oe.WebGLSystem,Oe.WebGPUSystem],name:"initHook",priority:-10};const Tr=class wt{constructor(...t){this.stage=new S,t[0]!==void 0&&We(Ue,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Kn(t),wt._plugins.forEach(r=>{r.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return We(Ue,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,r=!1){const n=wt._plugins.slice(0);n.reverse(),n.forEach(o=>{o.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Tr._plugins=[];let Or=Tr;At.handleByList(Oe.Application,Or._plugins);At.add(kr);class Ge extends zt{constructor(...t){let r=t[0];Array.isArray(t[0])&&(r={textures:t[0],autoUpdate:t[1]});const{textures:n,autoUpdate:o,...i}=r,[s]=n;super({...i,texture:s instanceof _e?s:s.texture}),this._textures=null,this._durations=null,this._autoUpdate=o??!0,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=n}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ee.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ee.shared.add(this.update,this,Sn.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const r=t.deltaTime,n=this.animationSpeed*r,o=this.currentFrame;if(this._durations!==null){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=n/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const s=Math.sign(this.animationSpeed*r);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):o!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<o||this.animationSpeed<0&&this.currentFrame>o)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const r=[];for(let n=0;n<t.length;++n)r.push(_e.from(t[n]));return new Ge(r)}static fromImages(t){const r=[];for(let n=0;n<t.length;++n)r.push(_e.from(t[n]));return new Ge(r)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof _e)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let r=0;r<t.length;r++)this._textures.push(t[r].texture),this._durations.push(t[r].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const r=this.currentFrame;this._currentTime=t,r!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ee.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ee.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class Jn extends Fn{constructor(t,r){const{text:n,resolution:o,style:i,anchor:s,width:a,height:c,roundPixels:f,...d}=t;super({...d}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=r,this.text=n??"",this.style=i,this.resolution=o??null,this.allowChildren=!1,this._anchor=new Rn({_onUpdate:()=>{this.onViewUpdate()}}),s&&(this.anchor=s),this.roundPixels=f??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){t=t||{},this._style?.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,r){typeof t=="object"?(r=t.height??t.width,t=t.width):r??(r=t),t!==void 0&&this._setWidth(t,this.bounds.width),r!==void 0&&this._setHeight(r,this.bounds.height)}addBounds(t){const r=this.bounds;t.addFrame(r.minX,r.minY,r.maxX,r.maxY)}containsPoint(t){const r=this.bounds.width,n=this.bounds.height,o=-r*this.anchor.x;let i=0;return t.x>=o&&t.x<=o+r&&(i=-n*this.anchor.y,t.y>=i&&t.y<=i+n)}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0,this._didTextUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t?.style)&&this._style.destroy(t),this._style=null,this._text=null}}function Qn(e,t){let r=e[0]??{};return(typeof r=="string"||e[1])&&(We(Ue,`use new ${t}({ text: "hi!", style }) instead`),r={text:r,style:e[1]}),r}class eo extends Jn{constructor(...t){const r=Qn(t,"Text");super(r,Mn),this.renderPipeId="text"}_updateBounds(){const t=this._bounds,r=this._anchor,n=In.measureText(this._text,this._style),{width:o,height:i}=n;t.minX=-r._x*o,t.maxX=t.minX+o,t.minY=-r._y*i,t.maxY=t.minY+i}}const W=e=>e.characterRooms[e.currentCharacterName].room,to=e=>e.characterRooms[e.currentCharacterName].room.items[e.currentCharacterName],ro=(e,t)=>e.characterRooms[t]?.room.items[t],D={renders:!0,falls:!1},tt=["away","towards","left","right"],no=e=>e==="away"||e==="towards"?"y":"x",oo=e=>e==="away"?"towards":e==="towards"?"away":e==="left"?"right":"left",le=e=>Pt(no(e)),me={away:{x:0,y:1,z:0},left:{x:1,y:0,z:0},right:{x:-1,y:0,z:0},towards:{x:0,y:-1,z:0},down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1}},Pt=e=>e==="x"?"y":"x",De=(e,...t)=>t.reduce((r,n)=>({x:r.x+(n.x??0),y:r.y+(n.y??0)}),e),xe=(e,t)=>({x:e.x*t,y:e.y*t,z:e.z*t}),A=(e,...t)=>t.reduce((r,n)=>({x:r.x+(n.x??0),y:r.y+(n.y??0),z:r.z+(n.z??0)}),e),Ar=(e,...t)=>t.reduce((r,n)=>({x:r.x-(n.x??0),y:r.y-(n.y??0),z:r.z-(n.z??0)}),e),rt=({x:e,y:t,z:r},{x:n,y:o,z:i})=>e===n&&t===o&&r===i,ht=e=>Math.abs(e-Math.round(e))<.001,io=({x:e=0,y:t=0,z:r=0})=>ht(e)&&ht(t)&&ht(r),so=({x:e=0,y:t=0,z:r=0})=>Number.isInteger(e)&&Number.isInteger(t)&&Number.isInteger(r),ao=({x:e,y:t,z:r})=>({x:Math.round(e),y:Math.round(t),z:Math.round(r)}),jt=Object.freeze({x:0,y:0}),ce=Object.freeze({x:0,y:0,z:0}),zr=["x","y","z"],bt=(e,t)=>e.x*t.x+e.y*t.y+e.z*t.z,v={w:16,d:16,h:12},lo={near:{x:{x:16,y:56},y:{x:8,y:56}},far:{x:{x:8,y:52},y:{x:16,y:52}}},co={x:{x:8,y:24},y:{x:6,y:22}},ft=(e,t)=>{const r=K(e);return t.x=r.x,t.y=r.y,t},T=e=>{const t=io(e),{x:r=0,y:n=0,z:o=0}=e;return{x:n-r,y:t?-(r+n>>1)-o:-(r+n)/2-o}},L=({x:e=0,y:t=0,z:r=0})=>({x:e*v.w,y:t*v.d,z:r*v.h}),K=e=>T(L(e)),Pr={head:He/1e3,heels:2*He/1e3},$r=(e=1)=>e*He/1e3,uo=$r(),ho=2,Re={head:v.h*2.5,heels:v.h},Er=2e-4,fo={head:-(v.h*2)/1e3,others:-(v.h*6)/1e3},po=$r(2),nt=9,Sr=2,pe={x:12,y:12,z:v.h},qt={x:14,y:14,z:v.h},Me={x:16,y:16,z:v.h},Yt={...pe,z:v.h*2},Fr=50,Xe={x:v.w,y:0,z:nt*v.h},Rr={...Xe,z:Fr},je={x:0,y:v.d,z:nt*v.h},Mr={...je,z:Fr},qe=e=>{switch(e.type){case"spring":case"portable-block":case"pickup":case"player":return{aabb:pe};case"lift":return{aabb:{...pe,z:pe.z-Sr}};case"charles":return{aabb:Yt};case"ball":case"switch":case"fish":return{aabb:qt};case"block":switch(e.config.style){case"artificial":case"organic":return{aabb:Me};case"tower":return{aabb:{x:11,y:11,z:v.h}};default:throw new Error("unknown block style")}case"baddie":switch(e.config.which){case"american-football-head":case"bubble-robot":case"cyberman":case"elephant":case"flying-ball":case"computer-bot":return{aabb:Yt};case"helicopter-bug":case"dalek":return{aabb:pe};default:return{aabb:Me}}case"deadly-block":switch(e.config.style){case"puck":return{aabb:pe};default:return{aabb:Me}}case"book":case"conveyor":case"hush-puppy":case"teleporter":return{aabb:Me};case"barrier":return{aabb:e.config.axis==="y"?{x:3,y:15,z:v.h}:{x:15,y:3,z:v.h}};case"wall":return e.config.side==="left"||e.config.side==="right"?{aabb:je,renderAabb:Mr}:{aabb:Xe,renderAabb:Rr};default:return console.warn("giving default aabb for item",e),{aabb:qt}}};function*yo(e){for(let t=e.size.y-1;t>=0;t--){const r=e.walls.left[t];r!=="none"&&(yield{...D,type:"wall",id:`wall-left-${t}`,config:{side:"left",style:r},state:{position:L({x:e.size.x,y:t,z:0}),expires:null},aabb:je,renderAabb:Mr}),Object.values(e.items).find(o=>o.type==="door"&&le(o.config.direction)==="y"&&o.position.x===0&&(o.position.y===t||o.position.y+1===t))!==void 0||(yield{...D,type:"wall",id:`wall-right-${t}`,config:{side:"left",style:"none"},state:{position:L({x:0,y:t,z:0}),expires:null},aabb:je,renders:!1})}for(let t=e.size.x-1;t>=0;t--){const r=e.walls.away[t];r!=="none"&&(yield{...D,type:"wall",id:`wall-away-${t}`,config:{side:"away",style:r},state:{position:L({x:t,y:e.size.y,z:0}),expires:null},aabb:Xe,renderAabb:Rr}),Object.values(e.items).find(o=>o.type==="door"&&le(o.config.direction)==="x"&&(o.position.x===t||o.position.x+1===t)&&o.position.y===0)!==void 0||(yield{...D,type:"wall",id:`wall-towards-${t}`,config:{side:"towards",style:"none"},state:{position:L({x:t,y:0,z:0}),expires:null},aabb:Xe,renders:!1})}}const go=({config:{direction:e},position:t})=>e==="right"&&t.x===0||e==="towards"&&t.y===0,Ie=v.h*2,Kt=v.h*4;function*mo(e,t){const{config:{direction:r},position:n}=e,o=le(r),i=Pt(o),s=go(e),a={...ce,[i]:s?-.5:0};yield{...e,...D,type:"doorFrame",id:`${t}/far`,config:{...e.config,inHiddenWall:s,nearness:"far"},state:{position:L(A(n,{[o]:1.5},a)),expires:null},aabb:{x:8,y:8,z:Ie},renderAabb:{x:8,y:8,z:Kt}};const c=L(A(n,a));yield{...e,...D,type:"doorFrame",id:`${t}/near`,config:{...e.config,inHiddenWall:s,nearness:"near"},state:{position:c,expires:null},aabb:{x:8,y:8,z:Ie},renderAabb:{x:8,y:8,z:Kt}},yield{...e,...D,type:"portal",id:`${t}/portal`,config:{...e.config,inHiddenWall:s,relativePoint:c,direction:r},renders:!1,state:{position:L(A(n,{[o]:.5},{[i]:s?-.5:.5})),expires:null},aabb:{[o]:v.w,[i]:0,z:Ie}},yield{...e,...D,id:`${t}/wall`,config:{style:"none",side:"away"},renders:!1,type:"wall",state:{position:A(L(A(n,a)),{z:Ie}),expires:null},aabb:L({[o]:2,[i]:.5,z:nt-n.z-2})},n.z>0&&(yield{...e,...D,id:`${t}/legs`,config:{...e.config,inHiddenWall:s,style:"none",side:"away",height:n.z},renders:!0,type:"doorLegs",state:{position:A({...L(A(n,a)),z:0}),expires:null},aabb:{...L({[o]:2,[i]:.5,z:n.z})}})}const vt=e=>{const t=L(e.position),{aabb:r}=qe(e);if(r===void 0)throw new Error(`item type= ${e.type} config=${JSON.stringify(e.config)} has no bounding box`);return e.type==="wall"?t:A(t,{x:v.w-r.x>>1,y:v.d-r.y>>1})},xo=e=>e.config.which==="head"?{type:"head",config:{},...D,...qe(e),id:"head",state:{facing:"towards",action:"idle",jumpEndTime:-1,hasHooter:!1,fast:0,shield:0,standingOn:null,velZ:0,lives:8,donuts:0,autoWalkDistance:0,teleporting:null,position:vt(e),expires:null},falls:!0}:{type:"heels",config:{},...D,...qe(e),id:"heels",state:{facing:"towards",action:"idle",carrying:null,hasBag:!1,jumps:0,shield:0,standingOn:null,velZ:0,lives:8,autoWalkDistance:0,jumpEndTime:-1,teleporting:null,position:vt(e),expires:null},falls:!0};function*wo(e,t,{id:r},n){if(!(t.type==="pickup"&&n[r][e]))switch(t.type){case"door":return yield*mo(t,e);case"player":{yield xo(t);return}default:{const o=hr.includes(t.type);yield{...t,...D,...qe(t),id:e,config:t.config,state:bo(t),falls:o}}}}const bo=e=>{const t=hr.includes(e.type);return{position:vt(e),...t?{standingOn:null,velZ:0}:{},...e.type==="teleporter"?{flashing:!1}:{},...e.type==="pickup"?{collected:!1}:{},...e.type==="lift"?{direction:"up"}:{}}},ue=e=>e[Symbol.iterator](),Ir=({aabb:e,state:{position:t}},{aabb:r,state:{position:n}})=>{for(const o of zr)if(t[o]+e[o]<=n[o]||t[o]>=n[o]+r[o])return!1;return!0},$t=(e,t)=>[...ue(t).filter(r=>e.id!==r.id&&Ir(e,r))];var Lr={exports:{}},Dr={exports:{}};(function(e){function t(r){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Dr);var ot=Dr.exports;(function(e){var t=ot.default;function r(){e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var n,o={},i=Object.prototype,s=i.hasOwnProperty,a=Object.defineProperty||function(h,l,u){h[l]=u.value},c=typeof Symbol=="function"?Symbol:{},f=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",b=c.toStringTag||"@@toStringTag";function m(h,l,u){return Object.defineProperty(h,l,{value:u,enumerable:!0,configurable:!0,writable:!0}),h[l]}try{m({},"")}catch{m=function(u,y,w){return u[y]=w}}function _(h,l,u,y){var w=l&&l.prototype instanceof V?l:V,x=Object.create(w.prototype),O=new ut(y||[]);return a(x,"_invoke",{value:An(h,u,O)}),x}function C(h,l,u){try{return{type:"normal",arg:h.call(l,u)}}catch(y){return{type:"throw",arg:y}}}o.wrap=_;var E="suspendedStart",H="suspendedYield",R="executing",N="completed",$={};function V(){}function G(){}function j(){}var at={};m(at,f,function(){return this});var lt=Object.getPrototypeOf,Pe=lt&&lt(lt(dt([])));Pe&&Pe!==i&&s.call(Pe,f)&&(at=Pe);var de=j.prototype=V.prototype=Object.create(at);function Ht(h){["next","throw","return"].forEach(function(l){m(h,l,function(u){return this._invoke(l,u)})})}function $e(h,l){function u(w,x,O,M){var B=C(h[w],h,x);if(B.type!=="throw"){var ne=B.arg,J=ne.value;return J&&t(J)=="object"&&s.call(J,"__await")?l.resolve(J.__await).then(function(oe){u("next",oe,O,M)},function(oe){u("throw",oe,O,M)}):l.resolve(J).then(function(oe){ne.value=oe,O(ne)},function(oe){return u("throw",oe,O,M)})}M(B.arg)}var y;a(this,"_invoke",{value:function(x,O){function M(){return new l(function(B,ne){u(x,O,B,ne)})}return y=y?y.then(M,M):M()}})}function An(h,l,u){var y=E;return function(w,x){if(y===R)throw Error("Generator is already running");if(y===N){if(w==="throw")throw x;return{value:n,done:!0}}for(u.method=w,u.arg=x;;){var O=u.delegate;if(O){var M=Vt(O,u);if(M){if(M===$)continue;return M}}if(u.method==="next")u.sent=u._sent=u.arg;else if(u.method==="throw"){if(y===E)throw y=N,u.arg;u.dispatchException(u.arg)}else u.method==="return"&&u.abrupt("return",u.arg);y=R;var B=C(h,l,u);if(B.type==="normal"){if(y=u.done?N:H,B.arg===$)continue;return{value:B.arg,done:u.done}}B.type==="throw"&&(y=N,u.method="throw",u.arg=B.arg)}}}function Vt(h,l){var u=l.method,y=h.iterator[u];if(y===n)return l.delegate=null,u==="throw"&&h.iterator.return&&(l.method="return",l.arg=n,Vt(h,l),l.method==="throw")||u!=="return"&&(l.method="throw",l.arg=new TypeError("The iterator does not provide a '"+u+"' method")),$;var w=C(y,h.iterator,l.arg);if(w.type==="throw")return l.method="throw",l.arg=w.arg,l.delegate=null,$;var x=w.arg;return x?x.done?(l[h.resultName]=x.value,l.next=h.nextLoc,l.method!=="return"&&(l.method="next",l.arg=n),l.delegate=null,$):x:(l.method="throw",l.arg=new TypeError("iterator result is not an object"),l.delegate=null,$)}function zn(h){var l={tryLoc:h[0]};1 in h&&(l.catchLoc=h[1]),2 in h&&(l.finallyLoc=h[2],l.afterLoc=h[3]),this.tryEntries.push(l)}function ct(h){var l=h.completion||{};l.type="normal",delete l.arg,h.completion=l}function ut(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(zn,this),this.reset(!0)}function dt(h){if(h||h===""){var l=h[f];if(l)return l.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var u=-1,y=function w(){for(;++u<h.length;)if(s.call(h,u))return w.value=h[u],w.done=!1,w;return w.value=n,w.done=!0,w};return y.next=y}}throw new TypeError(t(h)+" is not iterable")}return G.prototype=j,a(de,"constructor",{value:j,configurable:!0}),a(j,"constructor",{value:G,configurable:!0}),G.displayName=m(j,b,"GeneratorFunction"),o.isGeneratorFunction=function(h){var l=typeof h=="function"&&h.constructor;return!!l&&(l===G||(l.displayName||l.name)==="GeneratorFunction")},o.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,j):(h.__proto__=j,m(h,b,"GeneratorFunction")),h.prototype=Object.create(de),h},o.awrap=function(h){return{__await:h}},Ht($e.prototype),m($e.prototype,d,function(){return this}),o.AsyncIterator=$e,o.async=function(h,l,u,y,w){w===void 0&&(w=Promise);var x=new $e(_(h,l,u,y),w);return o.isGeneratorFunction(l)?x:x.next().then(function(O){return O.done?O.value:x.next()})},Ht(de),m(de,b,"Generator"),m(de,f,function(){return this}),m(de,"toString",function(){return"[object Generator]"}),o.keys=function(h){var l=Object(h),u=[];for(var y in l)u.push(y);return u.reverse(),function w(){for(;u.length;){var x=u.pop();if(x in l)return w.value=x,w.done=!1,w}return w.done=!0,w}},o.values=dt,ut.prototype={constructor:ut,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(ct),!l)for(var u in this)u.charAt(0)==="t"&&s.call(this,u)&&!isNaN(+u.slice(1))&&(this[u]=n)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var u=this;function y(ne,J){return O.type="throw",O.arg=l,u.next=ne,J&&(u.method="next",u.arg=n),!!J}for(var w=this.tryEntries.length-1;w>=0;--w){var x=this.tryEntries[w],O=x.completion;if(x.tryLoc==="root")return y("end");if(x.tryLoc<=this.prev){var M=s.call(x,"catchLoc"),B=s.call(x,"finallyLoc");if(M&&B){if(this.prev<x.catchLoc)return y(x.catchLoc,!0);if(this.prev<x.finallyLoc)return y(x.finallyLoc)}else if(M){if(this.prev<x.catchLoc)return y(x.catchLoc,!0)}else{if(!B)throw Error("try statement without catch or finally");if(this.prev<x.finallyLoc)return y(x.finallyLoc)}}}},abrupt:function(l,u){for(var y=this.tryEntries.length-1;y>=0;--y){var w=this.tryEntries[y];if(w.tryLoc<=this.prev&&s.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var x=w;break}}x&&(l==="break"||l==="continue")&&x.tryLoc<=u&&u<=x.finallyLoc&&(x=null);var O=x?x.completion:{};return O.type=l,O.arg=u,x?(this.method="next",this.next=x.finallyLoc,$):this.complete(O)},complete:function(l,u){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&u&&(this.next=u),$},finish:function(l){for(var u=this.tryEntries.length-1;u>=0;--u){var y=this.tryEntries[u];if(y.finallyLoc===l)return this.complete(y.completion,y.afterLoc),ct(y),$}},catch:function(l){for(var u=this.tryEntries.length-1;u>=0;--u){var y=this.tryEntries[u];if(y.tryLoc===l){var w=y.completion;if(w.type==="throw"){var x=w.arg;ct(y)}return x}}throw Error("illegal catch attempt")},delegateYield:function(l,u,y){return this.delegate={iterator:dt(l),resultName:u,nextLoc:y},this.method==="next"&&(this.arg=n),$}},o}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Lr);var vo=Lr.exports,Ne=vo(),Nr=Ne;try{regeneratorRuntime=Ne}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Ne:Function("r","regeneratorRuntime = r")(Ne)}var U={},Br={exports:{}},Wr={exports:{}},Ur={exports:{}};(function(e){var t=ot.default;function r(n,o){if(t(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var s=i.call(n,o||"default");if(t(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Ur);var _o=Ur.exports;(function(e){var t=ot.default,r=_o;function n(o){var i=r(o,"string");return t(i)=="symbol"?i:i+""}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Wr);var Co=Wr.exports;(function(e){var t=Co;function r(n,o,i){return(o=t(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Br);var ko=Br.exports,Hr={exports:{}},Vr={exports:{}},Gr={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var o=0,i=Array(n);o<n;o++)i[o]=r[o];return i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Gr);var Xr=Gr.exports;(function(e){var t=Xr;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Vr);var To=Vr.exports,jr={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(jr);var Oo=jr.exports,qr={exports:{}};(function(e){var t=Xr;function r(n,o){if(n){if(typeof n=="string")return t(n,o);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(n,o):void 0}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(qr);var Ao=qr.exports,Yr={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Yr);var zo=Yr.exports;(function(e){var t=To,r=Oo,n=Ao,o=zo;function i(s){return t(s)||r(s)||n(s)||o()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(Hr);var Kr=Hr.exports,Et={},St={};function Po(e){return typeof e<"u"}St.notUndefined=Po;var $o=St,Eo=$o.notUndefined;function So(e){return e!=null&&Eo(e[Symbol.iterator])}Et.isIterable=So;var Zr={};Zr.isLoopable=Et.isIterable;var Jr={},Fo=St,Ro=Fo.notUndefined;function Mo(e){return e==null||Ro(e[Symbol.iterator])}Jr.isWrappable=Mo;var Ft={},it=Nr,Io=it.mark(Qr),Lo=it.mark(en);function Qr(e){return it.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(e,"t0",1);case 1:case"end":return r.stop()}},Io)}Ft.wrap=Qr;function en(e){return it.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e==null){r.next=2;break}return r.delegateYield(e,"t0",2);case 2:case"end":return r.stop()}},Lo)}Ft.nullableWrap=en;var Rt={},Ye=Kr;function tn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.length,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return t<=o.length?e.apply(void 0,Ye(r).concat(o)):tn(e,t-o.length,[].concat(Ye(r),o))}}Rt.curry=tn;function Do(e,t){var r=e.fn,n=e.validateArgs,o=e.variadic,i=e.reduces,s=e.growRight,a=e.minArgs,c=e.maxArgs,f=e.isIterable,d=e.iterableType,b=e.applyOnIterableArgs,m=e.IterableClass;if(t.length>a){var _=!0,C=o?t.findIndex(function(G,j){return f(G)&&j>=a}):Math.min(c,t.length-1),E=o?t.length:C+1;if(o)for(var H=C;H<t.length;H++)_=_&&f(t[H]);else _=f(t[C]);if(t.length>c&&(C===-1||!_)){var R=o?"...".concat(d,"s"):d,N="".concat(r.name," takes up to ").concat(c," arguments, followed by ").concat(R,". ")+"You already passed ".concat(t.length," arguments");throw o?new Error("".concat(N," and the following arguments were not all ").concat(d,"s")):new Error("".concat(N," and the last argument was not ").concat(d))}if(C>=0&&_){for(var $=C;$<E;$++)t[$]=b(t[$]);var V=o?t.slice(C):t[C];return t.splice(C),s||t.reverse(),t.unshift(V),n(t),i?r.apply(void 0,Ye(t)):new m(r,t)}}return rn(e,t)}function rn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(n.length===0)throw new Error("Cannot make a partial application with no arguments");return n.unshift.apply(n,Ye(t)),Do(e,n)}}Rt.variadicCurryWithValidation=rn;var st={},No=Symbol.for("_");st._=No;var Bo=Symbol("__iterate");st.__iterate=Bo;var Wo=Symbol("split");st.split=Wo;var Ce=ko,nn=Kr,he,Uo=Et,on=Uo.isIterable,Ho=Zr,Vo=Ho.isLoopable,Go=Jr,Mt=Go.isWrappable,Xo=Ft,sn=Xo.nullableWrap,jo=Rt,qo=jo.variadicCurryWithValidation,an=st,ke=an._,Te=an.__iterate;U.wrap=sn;U.isIterable=on;U.isLoopable=Vo;U.isWrappable=Mt;function ln(e){if(Mt(e))return on(e)?e:sn(e);throw typeof e.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}U.ensureIterable=ln;function Yo(e){"return"in e&&e.return()}U.callReturn=Yo;function Ae(e,t){this[ke]={fn:e,args:t,staticIterator:null}}U.BaseIterableIterator=Ae;Object.assign(Ae.prototype,(he={constructor:Ae},Ce(he,Te,function(){var e=this[ke],t=e.fn,r=e.args;return t.apply(void 0,nn(r))}),Ce(he,"next",function(){var t=this[ke];return t.staticIterator=t.staticIterator||this[Te](),t.staticIterator.next()}),Ce(he,"return",function(t){var r=this[ke];return r.staticIterator=r.staticIterator||this[Te](),r.staticIterator.return(t)}),Ce(he,"throw",function(t){var r=this[ke];return r.staticIterator=r.staticIterator||this[Te](),r.staticIterator.throw(t)}),he));function ze(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ae.apply(this,t)}U.IterableIterator=ze;ze.prototype=Object.assign(Object.create(Ae.prototype),Ce({constructor:ze},Symbol.iterator,function(){return this[Te]()}));function Ko(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.validateArgs,n=r===void 0?function(H){}:r,o=t.variadic,i=o===void 0?!1:o,s=t.reduces,a=s===void 0?!1:s,c=t.growRight,f=c===void 0?!1:c,d=t.minArgs,b=d===void 0?e.length-1:d,m=t.maxArgs,_=m===void 0?e.length-1:m,C=t.applyOnIterableArgs,E=C===void 0?ln:C;return{fn:e,validateArgs:n,variadic:i,reduces:a,growRight:f,minArgs:b,maxArgs:_,isIterable:Mt,iterableType:"iterable",applyOnIterableArgs:E,IterableClass:ze}}function Zo(e){return nn(e)}U.cache=Zo;function Jo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.validateArgs,n=r===void 0?function(o){return o}:r;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return n(i),new ze(e,i)}}U.wrapWithIterableIterator=Jo;var Qo=function(t,r){return qo(Ko(t,r))};U.iterableCurry=Qo;var It={},ei=ot,_t=Nr,ti=_t.mark(Lt),ri=U,ni=ri.wrapWithIterableIterator,oi=Object.prototype.hasOwnProperty;function Lt(e){var t;return _t.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!=null){n.next=2;break}return n.abrupt("return");case 2:n.t0=_t.keys(e);case 3:if((n.t1=n.t0()).done){n.next=10;break}if(t=n.t1.value,!oi.call(e,t)){n.next=8;break}return n.next=8,e[t];case 8:n.next=3;break;case 10:case"end":return n.stop()}},ti)}It.__objectValues=Lt;var ii=ni(Lt,{validateArgs:function(t){if(!(t[0]==null||ei(t[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});It.objectValues=ii;var si=It.objectValues;const P=fr(si);function*ai(e){const t={...L(De(e.size,{x:2,y:2})),z:0},r=L({x:-1,y:-1,z:0});if(e.floor==="none"&&e.roomBelow!==void 0?yield{...D,type:"portal",id:"floor",config:{toRoom:e.roomBelow,relativePoint:r,direction:"down"},aabb:t,state:{position:r,expires:null},renders:!1}:yield{...D,type:"floor",id:"floor",config:{deadly:e.floor==="deadly"},aabb:t,state:{position:r,expires:null},renders:!1},e.roomAbove!==void 0){const n=A(r,{z:v.h*nt});yield{...D,type:"portal",id:"ceiling",config:{toRoom:e.roomAbove,relativePoint:Ar(n,{z:v.h}),direction:"up"},aabb:t,state:{position:n,expires:null},renders:!1}}}const cn=(e,t,r)=>t.type!=="portal"&&!(t.type==="pickup"&&r[t.id]===!0)&&!(t.type==="pickup"&&se(e))&&!(e.type==="pickup"&&se(t)),Zt=.001,Ke=(e,t,r)=>{const{state:{position:n,standingOn:o},aabb:i,id:s}=e,a=A(n,{z:-Zt}),f=$t({state:{position:a},aabb:i,id:s},ue(t).filter(d=>cn(e,d,r))).filter(d=>d.state.position.z+d.aabb.z-n.z<Zt*2);return o!==null&&f.find(d=>d===o)||f.at(0)||null};function*li(e,t){const r=pr(e.items);for(const[n,o]of r)yield*wo(n,o,e,t)}const un=(e,t)=>{e.state.standingOn=Ke(e,P(t),{})},ci=e=>{for(const t of P(e))we(t)&&un(t,e)},pt=e=>ue(e).reduce((t,r)=>({...t,[r.id]:r}),{}),Ze=(e,t)=>{const r={...pt(ai(e)),...pt(yo(e)),...pt(li(e,t))};for(const n of P(r)){const o=$t(n,P(r));if(o.length>0)throw new Error(`item ${n.id} is colliding with ${o.map(i=>i.id)}`)}return ci(r),{...e,items:r}},Ct=({state:{position:e,facing:t,autoWalkDistance:r,action:n}})=>({position:e,facing:t,autoWalkDistance:r,action:n}),ui=["head","heels"],Dt=e=>e==="head"?"heels":"head",Nt=({gameState:e,toRoom:t,portalRelative:r=ce})=>{const{currentCharacterName:n}=e,o=e.characterRooms[n].room;if(t===o.id)throw new Error(`Can't move to the same room "${t}" from "${o.id}"`);const i=Dt(n),s=e.characterRooms[i]?.room,a=s?.id===t?s:Ze(e.campaign.rooms[t],e.pickupsCollected),c=o.items[n];if(c===void 0)throw new Error(`Couldn't find character ${n} in room ${o.id} - can't move them to new room ${t}`);delete o.items[n];const f=ue(P(a.items)).find(d=>re("portal")(d)&&d.config.toRoom===o.id);if(f!==void 0){c.state.position=A(f.config.relativePoint,r);const{config:{direction:d}}=f;tt.includes(d)&&(c.state.autoWalkDistance=v.w*.75)}delete a.items[n],a.items[n]=c,c.state.standingOn=Ke(c,P(a.items),e.pickupsCollected[t]),console.log("destinationRoom",a.id),e.characterRooms[n]={room:a,entryState:Ct(c)},e.events.emit("roomChange",t)},di=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Å","Ä","Ö","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","`","~","Tab","Backspace","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadAdd","NumpadSubtract","NumpadMultiply","NumpadDivide","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],Jt=e=>di.includes(e),q={right:["P"],towards:["A"],left:["O"],away:["Q"],jump:[" ","M"],carry:["C","M"],fire:["N"],swop:["Enter","S"],pause:["H"]},hi={right:["ArrowRight",...q.right],towards:["ArrowDown",...q.towards],left:["ArrowLeft",...q.left],away:["ArrowUp",...q.away],jump:q.jump,carry:["Shift",...q.carry],fire:["Control",...q.fire],swop:q.swop,pause:["F8",...q.pause]};function*Qt(e,t){for(const[r,n]of pr(e))n.includes(t)&&(yield r)}const er=e=>e.length===1?e.toUpperCase():e,fi=({keyAssignment:e,inputState:t})=>{const r=({key:s})=>{const a=er(s);if(!Jt(a)){console.log("do not recognise key: ",a);return}for(const c of Qt(e,a))t[c]=!0},n=({key:s})=>{const a=er(s);if(Jt(a))for(const c of Qt(e,a))t[c]=!1},o=()=>{t.windowFocus=!0},i=()=>{t.windowFocus=!1};return window.addEventListener("keydown",r,!1),window.addEventListener("keyup",n,!1),window.addEventListener("focus",o,!1),window.addEventListener("blur",i,!1),()=>{window.removeEventListener("keydown",r,!1),window.removeEventListener("keyup",n,!1),window.removeEventListener("focus",o,!1),window.removeEventListener("blur",i,!1)}};function pi(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(o){o(r)}),(n=e.get("*"))&&n.slice().map(function(o){o(t,r)})}}}const yi=[...tt,"jump","fire","carry","swop","pause"],gi=()=>({...yr(yi.map(e=>[e,!1])),windowFocus:!0}),mi=e=>{const t={};for(const r of Object.values(e.rooms))for(const n of Object.values(r.items))if(n.type==="player"){const{which:o}=n.config;t[o]=r.id}if(t.head===void 0&&t.heels===void 0)throw new Error("couldn't find either head or heels in campaign");return t},xi=(e,t)=>{const r=mi(e),n=yr(Object.keys(e.rooms).map(s=>[s,{}])),o=r.head&&Ze(e.rooms[r.head],n),i=r.heels&&Ze(e.rooms[r.heels],n);return{keyAssignment:hi,currentCharacterName:r.head===void 0?"heels":"head",characterRooms:{head:o===void 0?void 0:{room:o,entryState:Ct(o.items.head)},heels:i===void 0?void 0:{room:i,entryState:Ct(i.items.heels)}},inputState:gi(),renderOptions:t,campaign:e,events:pi(),pickupsCollected:n,gameTime:0}},fe=(e,{x:t,y:r},n)=>{function*o(){yield[`${e}.left`,{frame:{x:t,y:r,...n}}],yield[`${e}.away`,{frame:{x:t+n.w+2,y:r,...n}}],yield[`${e}.towards`,{frame:{x:t,y:r+n.h+2,...n}}],yield[`${e}.right`,{frame:{x:t+n.w+2,y:r+n.h+2,...n}}]}return Object.fromEntries(o())},k=(e,t,{x:r,y:n},o)=>{function*i(){for(let s=0;s<t;s++)yield[`${e}.${s+1}`,{frame:{x:r+s*(o.w+1),y:n,...o}}]}return Object.fromEntries(i())},Be={w:32,h:16},X={w:16,h:55},Q={w:24,h:56},I={w:32,h:28},p={w:24,h:24};function tr(e){function*t(r,n){yield`${r}.walking.${n}.1`,yield`${r}.walking.${n}.2`,yield`${r}.walking.${n}.3`,yield`${r}.walking.${n}.2`}return tt.reduce((r,n)=>({...r,[`${e}.walking.${n}`]:[...t(e,n)]}),{})}const wi={...k("head.walking.towards",3,{x:4,y:266},p),...k("head.walking.right",3,{x:80,y:266},p),...k("head.walking.left",3,{x:4,y:240},p),...k("head.walking.away",3,{x:80,y:240},p),"head.blinking.towards":{frame:{x:54,y:291,...p}},"head.blinking.right":{frame:{x:130,y:291,...p}},...k("head.idle.right",2,{x:4,y:329},p),"head.falling.towards":{frame:{x:29,y:291,...p}},"head.falling.right":{frame:{x:105,y:291,...p}},...k("bubbles.head",6,{x:4,y:215},p),...k("heels.walking.towards",3,{x:159,y:266},p),...k("heels.walking.right",3,{x:235,y:266},p),...k("heels.walking.left",3,{x:159,y:240},p),...k("heels.walking.away",3,{x:235,y:240},p),...k("bubbles.heels",6,{x:159,y:215},p)},bi=5e3,rr=Math.round(bi/(He*4))-3,dn={frames:wi,animations:{...tr("head"),...tr("heels"),"head.idle.right":[...new Array(rr).fill("head.walking.right.3"),"head.blinking.right","head.walking.right.3","head.blinking.right"],"head.idle.towards":[...new Array(rr).fill("head.walking.towards.3"),"head.blinking.towards","head.walking.towards.3","head.blinking.towards"],"head.fadeOut":["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],"heels.fadeOut":["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"]}},ee=(e,t,r)=>{function*n(o,i,s){const{walls:a}=Ln[o],{w:c,h:f}=X,d=c>>1,b=a.length;let m=0;for(;m<a.length;m++)yield[`${o}.wall.${a[m]}.left`,{frame:{x:i+c*m,y:s-d*m,...X}}],yield[`${o}.wall.${a[m]}.away`,{frame:{x:i+c*((b<<1)-m-1),y:s-d*m,...X}}];const _=m-1;yield[`${o}.floor`,{frame:{x:i+_*c,y:s-_*d+f+1,...Be}}]}return Object.fromEntries(n(e,t,r))},vi={...ee("blacktooth",487,335),...ee("bookworld",356,23),...ee("egyptus",435,23),...ee("jail",455,351),...ee("market",378,244),...ee("moonbase",384,141),...ee("penitentiary",513,23),...ee("safari",482,244)},_i={frames:vi,animations:{}};let kt;try{kt=await Dn.load(Nn)}catch{kt=_e.EMPTY}const Ci={"generic.edge.right":{frame:{x:536,y:392,w:8,h:9}},"generic.edge.towards":{frame:{x:527,y:392,w:8,h:9}},"generic.wall.overdraw":{frame:{x:210,y:37,w:X.w,h:Be.h*2}},"generic.wall.overdraw.debug":{frame:{x:210,y:4,w:X.w,h:Be.h*2}},"generic.floor.deadly":{frame:{x:422,y:407,...Be}},"generic.door.legs.base":{frame:{x:314,y:60,w:X.w,h:9}},"generic.door.legs.pillar":{frame:{x:314,y:48,w:X.w,h:12}},"generic.door.front.y":{frame:{x:227,y:13,...Q}},"generic.door.back.y":{frame:{x:243,y:5,...Q}},"generic.door.legs.threshold.y":{frame:{x:331,y:30,w:X.w,h:18}},"generic.door.threshold.x":{frame:{x:270,y:70,w:26,h:19}},"generic.door.threshold.y":{frame:{x:241,y:70,w:26,h:19}},"generic.door.platform.towards":{frame:{x:270,y:144,w:32,h:32}},"generic.door.front.x":{frame:{x:286,y:13,...Q}},"generic.door.back.x":{frame:{x:270,y:5,...Q}},"generic.door.legs.threshold.x":{frame:{x:314,y:30,w:X.w,h:18}},"generic.door.platform.left":{frame:{x:235,y:114,w:32,h:28}},"moonbase.door.front.y":{frame:{x:344,y:161,...Q}},"moonbase.door.back.y":{frame:{x:360,y:153,...Q}},"moonbase.door.front.x":{frame:{x:528,y:161,...Q}},"moonbase.door.back.x":{frame:{x:512,y:153,...Q}},teleporter:{frame:{x:2,y:478,...I}},...k("teleporter.flashing",2,{x:35,y:478},I),"barrier.x":{frame:{x:27,y:349,w:24,h:24}},"barrier.y":{frame:{x:2,y:349,w:24,h:24}},"block.organic":{frame:{x:160,y:449,...I}},"block.organic.weak":{frame:{x:160,y:420,...I}},"block.artificial":{frame:{x:127,y:449,...I}},"block.tower":{frame:{x:27,y:374,...p}},volcano:{frame:{x:193,y:420,...I}},toaster:{frame:{x:101,y:478,...I}},spikes:{frame:{x:422,y:378,...I}},"conveyor.x":{frame:{x:35,y:399,...I}},"conveyor.y":{frame:{x:68,y:399,...I}},bunny:{frame:{x:263,y:333,...p}},donuts:{frame:{x:263,y:308,...p}},crown:{frame:{x:367,y:358,...p}},hooter:{frame:{x:263,y:408,...p}},bag:{frame:{x:263,y:358,...p}},...k("fish",2,{x:238,y:383},p),"spring.compressed":{frame:{x:2,y:453,...p}},"spring.released":{frame:{x:27,y:453,...p}},...k("lift",4,{x:259,y:474},p),"lift.static":{frame:{x:359,y:474,...p}},...k("dalek",2,{x:4,y:4},p),"headless-base":{frame:{x:93,y:102,...p}},joystick:{frame:{x:2,y:374,...p}},anvil:{frame:{x:134,y:478,...I}},"book.x":{frame:{x:167,y:478,...I}},"book.y":{frame:{x:200,y:478,...I}},sandwich:{frame:{x:4,y:356,...I}},sticks:{frame:{x:4,y:391,...p}},cube:{frame:{x:27,y:428,...p}},drum:{frame:{x:52,y:428,...p}},"switch.off":{frame:{x:52,y:453,...p}},"switch.on":{frame:{x:77,y:453,...p}},...fe("american-football-head",{x:4,y:34},{w:24,h:32}),...fe("charles",{x:118,y:34},p),...fe("cyberman",{x:61,y:34},p),...fe("monkey",{x:118,y:90},p),...fe("elephant",{x:118,y:146},p),...fe("computer-bot",{x:173,y:146},p),...k("bubbles",3,{x:4,y:107},p),...k("bubbles.cold",2,{x:109,y:4},p),...k("bubbles.pickup",3,{x:288,y:333},p),...k("turtle.left",2,{x:4,y:137},p),...k("turtle.away",2,{x:55,y:137},p),...k("turtle.towards",2,{x:4,y:163},p),...k("turtle.right",2,{x:55,y:163},p),...k("helicopter-bug",4,{x:4,y:188},p),"hush-puppy":{frame:{x:193,y:449,...I}},ball:{frame:{x:84,y:4,...p}},puck:{frame:{x:102,y:428,...p}},"puck.deadly":{frame:{x:102,y:453,...p}},...dn.frames,..._i.frames},ki={frames:Ci,animations:{"teleporter.flashing":["teleporter.flashing.1","teleporter.flashing.2"],fish:["fish.1","fish.2"],lift:["lift.1","lift.2","lift.3","lift.4"],dalek:["dalek.1","dalek.2"],"turtle.left":["turtle.left.1","turtle.left.2"],"turtle.away":["turtle.away.1","turtle.away.2"],"turtle.towards":["turtle.towards.1","turtle.towards.2"],"turtle.right":["turtle.right.1","turtle.right.2"],"helicopter-bug":["helicopter-bug.1","helicopter-bug.2","helicopter-bug.3","helicopter-bug.4"],bubbles:["bubbles.1","bubbles.2"],"bubbles.cold":["bubbles.cold.1","bubbles.cold.2"],"bubbles.pickup":["bubbles.pickup.1","bubbles.pickup.2","bubbles.pickup.3"],"spring.bounce":["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],...dn.animations},meta:{scale:1}},z=new Bn(kt,ki);await z.parse();z.textureSource.scaleMode="nearest";const hn=.5,Ti=1e3/25,fn=(e,t=hn)=>e*Ti/t;fn(z.animations["bubbles.pickup"].length);const Je=fn(z.animations["head.fadeOut"].length),Oi={x:.5,y:1},Ai=e=>typeof e!="string"&&Object.hasOwn(e,"frames"),g=e=>{if(typeof e=="string")return g({texture:e});{const{anchor:t,flipX:r,pivot:n,x:o,y:i}=e;let s;return Ai(e)?s=zi(e):s=new zt(z.textures[e.texture]),t===void 0&&n===void 0?s.anchor=Oi:(t!==void 0&&(s.anchor=t),n!==void 0&&(s.pivot=n)),o!==void 0&&(s.x=o),i!==void 0&&(s.y=i),s.eventMode="static",r===!0&&(s.scale.x=-1),s}};function zi(e){const t=new Ge(e.frames.map(r=>({texture:r,time:gr})));return t.animationSpeed=e.animationSpeed||hn,t.play(),e.playOnce!==void 0&&(t.loop=!1,t.onComplete=()=>{t.stop(),e.playOnce==="and-destroy"&&t.destroy()}),t}const Pi=(e,t,r)=>`${e}.wall.${t}.${r}`,$i=(e,t,r)=>{const n=z.textures[`${e.planet}.door.front.${t}`]!==void 0;return r=="near"?n?`${e.planet}.door.front.${t}`:`generic.door.front.${t}`:n?`${e.planet}.door.back.${t}`:`generic.door.back.${t}`},pn=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Ei=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uOriginalColor;
uniform vec3 uTargetColor;
uniform float uTolerance;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    vec3 colorDiff = uOriginalColor - (c.rgb / max(c.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, uTolerance);
    finalColor = vec4(mix(c.rgb, uTargetColor * c.a, doReplace), c.a);
}
`;class Qe extends xr{static DEFAULT_OPTIONS={originalColor:16711680,targetColor:0,tolerance:.4};uniforms;_originalColor;_targetColor;constructor(t){t={...Qe.DEFAULT_OPTIONS,...t};const r=Ot.from({vertex:pn,fragment:Ei,name:"palette-swap-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uOriginalColor:{value:new Float32Array(3),type:"vec3<f32>"},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"},uTolerance:{value:t.tolerance,type:"f32"}}}}),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this._originalColor=new F,this._targetColor=new F,this.originalColor=t.originalColor??16711680,this.targetColor=t.targetColor??0,Object.assign(this,t)}get originalColor(){return this._originalColor.value}set originalColor(t){this._originalColor.setValue(t);const[r,n,o]=this._originalColor.toArray();this.uniforms.uOriginalColor[0]=r,this.uniforms.uOriginalColor[1]=n,this.uniforms.uOriginalColor[2]=o}get targetColor(){return this._targetColor.value}set targetColor(t){this._targetColor.setValue(t);const[r,n,o]=this._targetColor.toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}get tolerance(){return this.uniforms.uTolerance}set tolerance(t){this.uniforms.uTolerance=t}}const ie={original:new F("rgb(255, 255, 255)"),basic:new F("rgb(210, 210, 210)"),dimmed:new F("rgb(120, 120, 120)")},te={original:new F("rgb(255, 255, 0)"),basic:new F("hsl(50,58%,70%)"),dimmed:Z().redShadow},ye={original:new F("rgb(255, 0, 255)"),basic:Z().pink,dimmed:new F("hsl(290,25%,40%)")},Y={original:new F("rgb(0, 255, 255)"),basic:new F("hsl(183, 28%, 50%)"),dimmed:Z().shadow},ge={original:new F("rgb(0, 255, 0)"),basic:Z().moss,dimmed:new F("hsl(73,35%,30%)")},Si={white:ie,yellow:te,magenta:ye,cyan:Y,green:ge},Bt={white:{main:ie,edges:{towards:Y,right:te},hud:{lives:te,dimmed:ye,icons:Y}},yellow:{main:te,edges:{towards:ge,right:ie},hud:{lives:Y,dimmed:ye,icons:ge}},magenta:{main:ye,edges:{towards:ge,right:Y},hud:{lives:ie,dimmed:Y,icons:te}},cyan:{main:Y,edges:{towards:ye,right:ie},hud:{lives:ie,dimmed:ge,icons:te}},green:{main:ge,edges:{towards:Y,right:te},hud:{lives:ie,dimmed:ye,icons:Y}}},yn=e=>[new Qe({originalColor:Z().replaceLight,targetColor:e.basic,tolerance:.1}),new Qe({originalColor:Z().replaceDark,targetColor:e.dimmed,tolerance:.1})],Tt=(e,t)=>yn(Bt[e.color].edges[t]),Fi=e=>yn(Bt[e.color].main),Ri=[];function gn(e,t){const r=t||new S;for(const n of e)r.addChild(n);return r}function*Mi({config:{direction:e,inHiddenWall:t,height:r}},n){const o=le(e),i=o==="y"?0:16;function*s(a){if(t){if(r!==0){const f=g({pivot:{x:o==="x"?18:8,y:12},texture:`generic.door.threshold.${o}`,...De(a,{y:-v.h*r})});f.filters=Tt(n,o==="x"?"towards":"right"),yield f}}else{yield g({pivot:{x:i,y:12},texture:"generic.door.legs.base",...De(a,{y:r})});for(let c=1;c<r;c++)yield g({pivot:{x:i,y:9},texture:"generic.door.legs.pillar",...De(a,{y:-c*v.h})});yield g({pivot:{x:i,y:v.h*r+15},texture:`generic.door.legs.threshold.${o}`,...a})}}yield*s(K({...jt,[o]:1})),yield*s(jt)}const Ii=(e,t)=>gn(Mi(e,W(t)));function*Li({config:{direction:e,inHiddenWall:t,nearness:r},state:{position:n}},o){const i=le(e),{z:s}=n;if(!t&&s===0){const a=K({[Pt(i)]:.5});r==="far"&&(yield g({anchor:{x:0,y:1},flipX:i==="x",texture:"generic.wall.overdraw",...a}))}yield g({texture:$i(o,i,r),pivot:lo[r][i]})}const Di=(e,t)=>gn(Li(e,W(t))),nr=({type:e,state:{action:t,facing:r,teleporting:n}})=>{if(t==="death")return g({frames:z.animations[`${e}.fadeOut`]});if(n!==null){if(n.phase==="out")return g({frames:z.animations[`${e}.fadeOut`]});if(n.phase==="in")return g({frames:z.animations[`${e}.fadeOut`].toReversed()})}return g(t==="moving"?{frames:z.animations[`${e}.walking.${r}`]}:t==="falling"&&e==="head"&&(r==="towards"||r==="right")?`head.falling.${r}`:e==="head"&&(r==="towards"||r==="right")?{frames:z.animations[`head.idle.${r}`]}:`${e}.walking.${r}.2`)},yt={frames:z.animations["bubbles.cold"],animationSpeed:.25},ve=(e,t="headless-base")=>{const r=new S;r.addChild(g(t));const n=g(e);return n.y=-12,r.addChild(n),r},Ni={head:nr,heels:nr,doorFrame:Di,doorLegs:Ii,portal(){throw new Error("these should always be non-rendering")},wall({config:{side:e,style:t}},r){return e==="right"||e==="towards"?new S:g({texture:Pi(W(r).planet,t,e),anchor:e==="away"?{x:1,y:1}:{x:0,y:1}})},barrier:({config:{axis:e}})=>g({texture:`barrier.${e}`,pivot:co[e]}),"deadly-block":({config:{style:e}})=>g(e==="puck"?"puck.deadly":e),block:({config:{style:e}})=>g(`block.${e}`),conveyor:({config:{direction:e}})=>g(e==="left"||e==="right"?"conveyor.x":"conveyor.y"),fish:({config:{alive:e}})=>g(e?{frames:z.animations.fish,animationSpeed:.25}:{texture:"fish.1"}),lift(){const e=new S,t={x:p.w/2,y:p.h-Sr};return e.addChild(g({frames:z.animations.lift,pivot:t})),e.addChild(g({texture:"lift.static",pivot:t})),e},spring:(e,t)=>!e.state.stoodOn&&e.lastRenderedState?.stoodOn?g({frames:z.animations["spring.bounce"],playOnce:"and-stop"}):e.state.stoodOn?g("spring.compressed"):g("spring.released"),teleporter:e=>e.state.stoodOn?g({frames:z.animations["teleporter.flashing"]}):g("teleporter"),pickup({id:e,config:{gives:t}},r){const n=W(r).id;return r.pickupsCollected[n][e]===!0?g({frames:z.animations["bubbles.pickup"],playOnce:"and-destroy"}):g({shield:"bunny",jumps:"bunny",fast:"bunny","extra-life":"bunny",bag:"bag",donuts:"donuts",hooter:"hooter",crown:"crown"}[t])},sceneryPlayer:({config:{which:e}})=>g(`${e}.walking.towards.2`),baddie({config:e}){switch(e.which){case"helicopter-bug":case"dalek":return g({frames:z.animations[e.which],animationSpeed:.5});case"headless-base":return g({texture:"headless-base"});case"american-football-head":return g({texture:`american-football-head.${e.startDirection}`});case"turtle":return g({frames:z.animations[`turtle.${e.startDirection}`],animationSpeed:.25});case"cyberman":return e.charging?g(`cyberman.${e.startDirection}`):ve("cyberman.towards",yt);case"bubble-robot":return ve(yt);case"flying-ball":return ve("ball",yt);case"computer-bot":case"elephant":case"monkey":return ve(`${e.which}.towards`);case"elephant-head":return g("elephant.right");default:throw new Error(`unexpected baddie ${e}`)}},joystick:()=>g("joystick"),"movable-block":({config:{style:e}})=>g(e),book:({config:{slider:e}})=>g(`book.${e?"y":"x"}`),"portable-block":({config:{style:e}})=>g(e),charles:()=>ve("charles.towards"),switch:()=>g("switch.off"),"hush-puppy":()=>g("hush-puppy"),ball:()=>g("ball"),floor(){throw new Error("floor should not be rendered as an item")}},mn=(e,t)=>{Wn(e);const r=Ni[e.type];if(r===void 0)throw new Error(`item type "${e.type}" has no appearance - if it doesn't render, give it the .renders = false`);e.renderContainer.children.forEach(o=>o.destroy({children:!0,context:!0})),e.renderContainer.removeChildren();const n=r(e,t);e.renderContainer.addChild(n)},xn=e=>{Un(e);const{state:{position:t},positionContainer:r}=e,n=T(t);r.x=n.x,r.y=n.y},Bi=(e,t)=>{if(e.renders===!1||t.renders===!1)return 0;const r=e.renderAabb||e.aabb,n=t.renderAabb||t.aabb,o=T(e.state.position),i=o.x-r.x,s=o.x+r.y,a=T(t.state.position),c=a.x-n.x,f=a.x+n.y;if(i>=f||c>=s)return 0;const d=T(A(e.state.position,r)).y,b=T(A(t.state.position,n)).y;if(o.y<=b||a.y<=d)return 0;for(const m of zr){const _=e.state.position[m],C=_+r[m],E=t.state.position[m],H=E+n[m];if(C<=E)return 1*(m==="z"?-1:1);if(_>=H)return-1*(m==="z"?-1:1)}return or(t)-or(e)},or=e=>e.state.position.x+e.state.position.y-e.state.position.z;var Wt={exports:{}};Wt.exports=function(e){return wn(Wi(e),e)};Wt.exports.array=wn;function wn(e,t){var r=e.length,n=new Array(r),o={},i=r,s=Ui(t),a=Hi(e);for(t.forEach(function(f){if(!a.has(f[0])||!a.has(f[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});i--;)o[i]||c(e[i],i,new Set);return n;function c(f,d,b){if(b.has(f)){var m;try{m=", node was:"+JSON.stringify(f)}catch{m=""}throw new Error("Cyclic dependency"+m)}if(!a.has(f))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(f));if(!o[d]){o[d]=!0;var _=s.get(f)||new Set;if(_=Array.from(_),d=_.length){b.add(f);do{var C=_[--d];c(C,a.get(C),b)}while(d);b.delete(f)}n[--r]=f}}}function Wi(e){for(var t=new Set,r=0,n=e.length;r<n;r++){var o=e[r];t.add(o[0]),t.add(o[1])}return Array.from(t)}function Ui(e){for(var t=new Map,r=0,n=e.length;r<n;r++){var o=e[r];t.has(o[0])||t.set(o[0],new Set),t.has(o[1])||t.set(o[1],new Set),t.get(o[0]).add(o[1])}return t}function Hi(e){for(var t=new Map,r=0,n=e.length;r<n;r++)t.set(e[r],r);return t}var Vi=Wt.exports;const Gi=fr(Vi),bn=e=>{const t=[];for(const n of e)if(n.renders)for(const o of e){if(n===o)break;if(!o.renders)continue;const i=Bi(n,o);i!==0&&(i>0?t.push([o,n]):t.push([n,o]))}let r;try{r=Gi(t)}catch(n){throw new Error(`found a cyclic dependency in the draw order pairs are:
	${t.map(([o,i])=>`${o.id} is behind ${i.id}`).join(`
	`)}`,n)}for(let n=0;n<r.length;n++)r[n].positionContainer.zIndex=n},vn=e=>{const t={},r=Object.values(e.items).filter(re("doorFrame"));for(const{config:{direction:n},state:{position:{x:o,y:i}}}of r)le(n)==="x"?i<0?t.towards=!0:i===e.size.y*v.d&&(t.away=!0):o<0?t.right=!0:o===e.size.x*v.w&&(t.left=!0);return t},_n=e=>{const t=vn(e),r=t.right?-.5:0,n=e.size.x+(t.left?.5:0),o=t.towards?-.5:0,i=e.size.y+(t.away?.5:0),s=K({x:r,y:i}),a=K({x:n,y:o}),c=K({x:r,y:o}),f=K({x:n,y:i}),d=f.y+X.h;return{blockXMin:r,blockXMax:n,blockYMin:o,blockYMax:i,rightSide:s,leftSide:a,frontSide:c,backSide:f,top:d}},Xi=e=>{const{towards:t,right:r}=vn(e),{blockXMin:n,blockYMin:o,rightSide:i,leftSide:s,frontSide:a,backSide:c}=_n(e),{floor:f}=e,d=new S,b=Object.fromEntries(e.floorSkip.map(({x:R,y:N})=>[`${R},${N}`,!0]));if(f!=="none"){const R=f==="deadly"?"generic.floor.deadly":`${f}.floor`,N=new S;for(let V=-1;V<=e.size.x;V++)for(let G=V%2-1;G<=e.size.y;G+=2)b[`${V},${G}`]||N.addChild(ft({x:V,y:G},g({anchor:{x:.5,y:1},texture:R})));const $=new Ve().poly([a,i,c,s],!0).fill(16711680).stroke({width:8});N.addChild($),N.mask=$,d.addChild(N)}const m=new S;for(let R=n;R<=e.size.x;R+=.5)m.addChild(ft({x:R,y:t?-.5:0},g({pivot:{x:7,y:1},texture:"generic.edge.towards"})));m.filters=Tt(e,"towards");const _=new S;for(let R=o;R<=e.size.y;R+=.5)_.addChild(ft({x:r?-.5:0,y:R},g({pivot:{x:0,y:1},texture:"generic.edge.right"})));_.filters=Tt(e,"right");const C=K({x:0,y:e.size.y}),E=K({x:e.size.x,y:0}),H=new Ve().poly([{x:a.x,y:a.y+16},{x:C.x,y:C.y+16},{x:C.x,y:-999},{x:E.x,y:-999},{x:E.x,y:E.y+16}],!0).fill(16776960);return d.addChild(H),d.addChild(m),d.addChild(_),d.mask=H,d},ir=(e,t)=>new Ve().poly([T({}),T({x:e.x}),T({x:e.x,y:e.y}),T({y:e.y})]).poly([T({}),T({z:e.z}),T({y:e.y,z:e.z}),T({y:e.y})]).poly([T({x:e.x}),T({x:e.x,z:e.z}),T(e),T({x:e.x,y:e.y})]).poly([T({z:e.z}),T({x:e.x,z:e.z}),T({x:e.x,y:e.y,z:e.z}),T({y:e.y,z:e.z})]).stroke({width:.5,color:t}),ji={head:"rgba(255,184,0)",wall:"rgba(128,200,0)",portal:"rgba(255,0,255)"},qi=e=>{const t=ji[e.type]??"rgba(255,255,255)",r=new S;return r.addChild(new Ve().circle(0,0,2).fill(t)),r.addChild(ir(e.aabb,t)),e.renderAabb&&r.addChild(ir(e.renderAabb,"rgba(184, 184, 255)")),r},Yi=e=>{const t=new S;return e.renderContainer!==void 0&&t.addChild(e.renderContainer),t.addChild(qi(e)),t},Ki=`precision mediump float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uSourceBlacks[2];
uniform vec3 uTargetColor;

// colours are floats so check if they're very close rather than exactly equal:
bool colorsEffectivelyEqual(vec3 color1, vec3 color2) {    
    
    return distance(color1, color2) < 0.05;
}

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);

    if( c.a == 0.0 ) {
        finalColor = c;
        return;
    }

    if ( colorsEffectivelyEqual(c.rgb, uSourceBlacks[0]) || colorsEffectivelyEqual(c.rgb, uSourceBlacks[1])) {
        finalColor = vec4(0,0,0, 1.0);
    } else {
        finalColor = vec4(uTargetColor, 1);    
    }
}
`,sr=[Z().pureBlack,Z().lightBlack];class Ut extends xr{uniforms;constructor(t=te.basic){const r=Ot.from({vertex:pn,fragment:Ki,name:"revert-colourise-filter"});super({glProgram:r,resources:{colorReplaceUniforms:{uSourceBlacks:{value:new Float32Array(6),type:"vec3<f32>",size:6},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"}}}}),this.uniforms=this.resources.colorReplaceUniforms.uniforms;const[n,o,i]=sr[0].toArray();this.uniforms.uSourceBlacks[0]=n,this.uniforms.uSourceBlacks[1]=o,this.uniforms.uSourceBlacks[2]=i;const[s,a,c]=sr[1].toArray();this.uniforms.uSourceBlacks[3]=s,this.uniforms.uSourceBlacks[4]=a,this.uniforms.uSourceBlacks[5]=c,this.targetColor=t}set targetColor(t){const[r,n,o]=new F(t).toArray();this.uniforms.uTargetColor[0]=r,this.uniforms.uTargetColor[1]=n,this.uniforms.uTargetColor[2]=o}}const Zi=(e,t)=>{const{leftSide:r,rightSide:n,frontSide:o,top:i}=_n(e),s=(n.x+r.x)/2,a=(i+o.y)/2;t.x=-s,t.y=-a},Ji=(e,t,r)=>{e.renderContainer!==void 0&&(t.onItemClick&&e.renderContainer!==void 0&&(e.renderContainer.eventMode="static",e.renderContainer.on("pointertap",()=>{t.onItemClick(e)})),e.renderContainer.on("pointerenter",()=>{e.renderContainer.filters=new Ut(Si[r.color].original)}),e.renderContainer.on("pointerleave",()=>{e.renderContainer.filters=[]}))},Qi=(e,t)=>{const r=W(e),n=new S;n.addChild(Xi(r));const o=new S;for(const i of P(r.items)){const{renders:s}=i;if(s){const c=new S;i.renderContainer=c,mn(i,e)}const a=t.showBoundingBoxes==="all"||t.showBoundingBoxes==="non-wall"&&i.type!=="wall";i.positionContainer=a?Yi(i):i.renderContainer,t.showBoundingBoxes!=="none"&&i.renderContainer!==void 0&&(i.renderContainer.alpha=.8),Ji(i,t,r),i.positionContainer!==void 0&&(xn(i),o.addChild(i.positionContainer))}return bn(P(r.items)),n.addChild(o),n.filters=Fi(r),Zi(r,n),n},es=e=>{let t=1;return{get curUpscale(){return t},rescale(){if(e.renderer.width===0||e.renderer.height===0)return;const r=Math.floor(Math.min(e.renderer.width/ae.width,e.renderer.height/ae.height));t!==r&&(t=r,console.log("scale factor changed to:",r),e.stage.scale=r)}}},ar=8,Cn=e=>e==="heels"?1:-1,lr=(e,t)=>{const n=new eo({style:{fill:"white",fontFamily:"Head over Heels",fontSize:ar},resolution:8,x:(ae.width>>1)+Cn(e)*24,y:ae.height-ar*2});return n.scale={x:1,y:2},n},cr=e=>{const t=new zt(z.textures[`${e}.walking.${e==="head"?"right":"towards"}.2`]);return t.x=(ae.width>>1)+Cn(e)*64+(e==="heels"?-p.w:0),t.y=ae.height-p.h,t},ts=e=>{const t={head:{sprite:cr("head"),livesText:lr("head")},heels:{sprite:cr("heels"),livesText:lr("heels")}};e.addChild(t.head.livesText),e.addChild(t.head.sprite),e.addChild(t.heels.livesText),e.addChild(t.heels.sprite);const r=new Ut;return n=>{const o=W(n),{hud:{dimmed:i,lives:s}}=Bt[o.color];for(const a of ui){const c=n.currentCharacterName===a,f=ro(n,a);r.targetColor=i.dimmed,t[a].livesText.style.fill=s.basic,t[a].livesText.text=`${f?.state.lives??0}`,t[a].sprite.filters=c?Ri:r}}},rs=(e,t,r)=>{const{state:{velZ:n}}=e,o=fo[e.type==="head"?"head":"others"],i=Math.max(n-Er*r,o);return{positionDelta:{x:0,y:0,z:i*r},stateDelta:{velZ:i}}},Le=e=>{const r=e/ho*gr;return{velZ:(e+.5*Er*r**2)/r,tApex:r}},ns={head:Le(Re.head),headOnSpring:Le(Re.head+v.h),heels:Le(Re.heels),heelsOnSpring:Le(Re.heels+v.h)},os=(e,t)=>ns[`${e}${t?"OnSpring":""}`],is=(e,{inputState:{jump:t}},r)=>{const{type:n}=e;if(!t||e.state.standingOn===null||e.state.standingOn?.type==="teleporter")return{};const{velZ:o}=os(n,e.state.standingOn?.type==="spring");return{stateDelta:{action:"moving",velZ:o}}};function ss(e,t,r){return{stateDelta:{stoodOn:r.items.head?.state.standingOn===e||r.items.heels?.state.standingOn===e}}}function as(e,t,r){return{stateDelta:{stoodOn:ue(P(r.items)).find(n=>we(n)&&n.state.standingOn===e)!==void 0}}}function ls(e,t,r){const{state:{teleporting:n}}=e,{inputState:{jump:o}}=t;if(n===null)return o&&e.state.standingOn?.type==="teleporter"?{stateDelta:{teleporting:{phase:"out",toRoom:e.state.standingOn.config.toRoom,timeRemaining:Je}}}:{};const i=Math.max(n.timeRemaining-r,0);switch(n.phase){case"out":if(i===0)return Nt({gameState:t,toRoom:n.toRoom}),{stateDelta:{teleporting:{phase:"in",timeRemaining:Je}}};break;case"in":if(i===0)return{stateDelta:{teleporting:null}};break}return{stateDelta:{teleporting:{...n,timeRemaining:i}}}}const kn={},cs=(e,{inputState:t},r)=>{const{type:n,state:{autoWalkDistance:o,standingOn:i,facing:s,teleporting:a}}=e,c=tt.find(d=>t[d]===!0),f=Pr[n]*r;if(o>0)return{positionDelta:xe(me[s],f),stateDelta:{autoWalkDistance:Math.max(o-f,0)}};if(a!==null)return{};if(i===null)switch(n){case"head":{const b=e.state.velZ>0?"moving":"falling";return c===void 0?{stateDelta:{action:b}}:{positionDelta:xe(me[c],f),stateDelta:{facing:c,action:b}}}case"heels":return c===s?{positionDelta:xe(me[s],f*.6)}:kn}return c!==void 0?{positionDelta:xe(me[c],f),stateDelta:{facing:c,action:"moving"}}:{stateDelta:{action:"idle"}}},Tn=(e,t,r)=>{const n=W(e).id;if(e.pickupsCollected[n][r.id]===!0)return;const o=e.pickupsCollected[n];switch(o[r.id]=!0,r.state.expires=e.gameTime+Je,r.config.gives){case"extra-life":t.state.lives+=2}},us=.5,ur=(e,t,r,n)=>{const o=r.x+n.x-e.x,i=r.y+n.y-e.y,s=r.z+n.z-e.z,a=e.x+t.x-r.x,c=e.y+t.y-r.y,f=e.z+t.z-r.z,d=Math.abs(o)<Math.abs(a)?o:-a,b=Math.abs(i)<Math.abs(c)?i:-c,m=Math.abs(s)<Math.abs(f)?s:-f,_=Math.abs(d),C=Math.abs(b),E=Math.abs(m)*us;return _<C&&_<E?{x:d,y:0,z:0}:C<E?{x:0,y:b,z:0}:{x:0,y:0,z:m}},dr=(e,t)=>({x:e.x>0?t.state.position.x:t.state.position.x+t.aabb.x,y:e.y>0?t.state.position.y:t.state.position.y+t.aabb.y,z:e.z>0?t.state.position.z:t.state.position.z+t.aabb.z}),ds=(e,t)=>[...t].sort((r,n)=>{const o=bt(e,dr(e,r)),i=bt(e,dr(e,n));return o-i});function hs(e,t){return t.state.action="death",t.state.expires=e.gameTime+Je,!0}const fs=(e,t,{config:{relativePoint:r,toRoom:n,direction:o}},i)=>{const s=me[o];return bt(s,i)<=0?!1:(Nt({gameState:e,toRoom:n,portalRelative:Ar(t.state.position,r)}),!0)},ps=(e,t,r,n)=>{const{portal:o=[],deadly:i=[],pickup:s=[]}=Object.groupBy(t,c=>{switch(c.type){case"baddie":case"deadly-block":return"deadly";case"floor":return c.config.deadly?"deadly":"other";case"portal":return"portal";case"pickup":return"pickup"}return"other"}),a=o.at(0);if(a!==void 0&&fs(n,e,a,r)||i?.length>0&&hs(n,e))return!0;for(const c of s)Tn(n,e,c);return!1},ys=(e,t)=>{const r=ue(t).find(re("doorFrame"));if(r===void 0)return ce;const{config:{direction:n,nearness:o}}=r,i=le(n);return o==="far"?{x:i==="x"?-Math.abs(e.y):0,y:i==="y"?-Math.abs(e.x):0,z:0}:{x:i==="x"?Math.abs(e.y):0,y:i==="y"?Math.abs(e.x):0,z:0}},On=(e,t,r,n)=>{const o=A(ce,t);if(rt(o,ce))return;const i=W(r),{state:{position:s}}=e;e.state.position=A(s,o);const a=$t(e,P(i.items));if(se(e)&&ps(e,a,o,r))return;if(re("pickup")(e)){const d=a.find(se);d!==void 0&&Tn(r,d,e)}const c=a.filter(d=>cn(e,d,r.pickupsCollected[i.id])),f=ds(o,c);for(const d of f){if(!Ir(e,d))continue;const b=ur(e.state.position,e.aabb,d.state.position,d.aabb);if(we(d)&&d!==n){const m=e.type==="lift"?-1:-.5,_=xe(b,m);e.state.position=A(e.state.position,b,_),On(d,_,r,e),e.state.position=A(e.state.position,ur(e.state.position,e.aabb,d.state.position,d.aabb)),d.state.standingOn=Ke(d,P(i.items),r.pickupsCollected[i.id])}else e.state.position=A(e.state.position,b)}we(e)&&n===void 0&&(e.state.standingOn=Ke(e,P(i.items),r.pickupsCollected[i.id])),e.state.position=se(e)?A(e.state.position,ys(o,c)):e.state.position},gs=(e,t,r)=>{if(e.state.standingOn===null||e.state.standingOn.type!=="conveyor")return kn;const{config:{direction:n}}=e.state.standingOn,s=(re("heels")(e)&&e.state.action==="moving"&&e.state.facing===oo(n)?Pr.heels:uo)*r;return{positionDelta:xe(me[n],s)}},et=v.h,ms=.01;function xs(e,t,r=0,n=1){const o=(t==="up"?n-e:e-r)/et,i=(t==="up"?e-r:n-e)/et,s=o<1?o:1,a=i<1?i:1;return Math.max(po*s*a,ms)*(t==="up"?1:-1)}function ws({config:{bottom:e,top:t},state:{direction:r,position:{z:n}}},o,i){const s=e*et,a=t*et,c=xs(n,r,s,a),f=n<=s?"up":n>=a?"down":r;return{positionDelta:{z:c*i},stateDelta:{direction:f}}}const bs=(e,t,r)=>{const n=W(t);let o=ce;const i=we(e),s=({positionDelta:a,stateDelta:c})=>{a!==void 0&&(o=A(o,a)),c!==void 0&&(e.state={...e.state,...c})};se(e)&&e.type===t.currentCharacterName&&(s(ls(e,t,r)),s(cs(e,t,r)),s(is(e,t))),i&&(s(rs(e,t,r)),s(gs(e,t,r))),re("teleporter")(e)&&s(ss(e,t,n)),re("spring")(e)&&s(as(e,t,n)),re("lift")(e)&&s(ws(e,t,r)),rt(o,ce)||On(e,o,t)},vs=e=>{e.currentCharacterName=Dt(e.currentCharacterName)},_s=e=>{const{currentCharacterName:t}=e,{room:r,entryState:n}=e.characterRooms[t],o=r.items[t],i=Dt(t),s=o.state,a=o.state.lives-1;if(a===0){o.state.lives=a,e.characterRooms[t]=void 0,e.currentCharacterName=i;return}const c=Ze(e.campaign.rooms[r.id],e.pickupsCollected);e.characterRooms[t].room=c,o.state={...s,...n,expires:null,lives:a},un(o,c.items),c.items[t]=o},Cs=20,ks=(e,t)=>e.state.expires!==null&&e.state.expires<t.gameTime,Ts=(e,t)=>{t.positionContainer!==void 0&&t.positionContainer.destroy(),delete e.items[t.id];for(const r of ue(P(e.items)))we(r)&&r.state.standingOn===t&&(r.state.standingOn=null)},Os=e=>{for(const t of P(e.items)){const r=t.lastRenderedState.position;rt(r,t.state.position)&&!so(t.state.position)&&(console.log(`snapping item ${t.id} to pixel grid`),t.state.position=ao(t.state.position))}},As=(e,t)=>{const r=Math.ceil(t/Cs),n=t/r,{inputState:o}=e;if(o.swop){vs(e),o.swop=!1;return}const i=W(e);for(const s of P(i.items))s.lastRenderedState={...s.state};for(let s=0;s<r;s++){e.gameTime+=n;for(const a of P(i.items))if(ks(a,e))if(se(a)){_s(e);return}else Ts(i,a);for(const a of P(i.items)){if(to(e).state.action==="death")break;bs(a,e,n)}}Os(i)},zs=e=>{if(e.lastRenderedState===void 0)return!0;switch(e.type){case"head":case"heels":return e.state.facing!==e.lastRenderedState.facing||e.state.action!==e.lastRenderedState.action||e.state.teleporting?.phase!==e.lastRenderedState.teleporting?.phase;case"teleporter":case"spring":return e.state.stoodOn!==e.lastRenderedState.stoodOn;case"pickup":return e.state.expires!==e.lastRenderedState.expires;default:return!1}},Ps=(e,t,r,n)=>{const o=W(e);if(o!==t){console.log("will render from scratch",o.id,"since we currently have",t?.id),r.removeChildren(),r.label="world";const i=Qi(e,n);r.addChild(i)}else{let i=!1;for(const s of P(o.items))s.renders&&(zs(s)&&mn(s,e),(s.lastRenderedState===void 0||!rt(s.lastRenderedState.position,s.state.position))&&(xn(s),i=!0));i&&bn(P(o.items))}},$s=(e,t)=>{let r,n;const o=new S;o.label="world",o.y=ae.height*.7,e.stage.addChild(o);const i=new S;e.stage.addChild(i);const s=[new Ut(Z().shadow)],a=ts(i),c=es(e),f=({deltaMS:d})=>{c.rescale(),o.x=e.renderer.width/c.curUpscale/2;const{renderOptions:b}=t;n!==b&&(console.log(`render options changed!          
          renderOptions: ${n} -> ${b}`),r=void 0,n=b),e.stage.filters=t.inputState.windowFocus?[]:s,As(t,d),Ps(t,r,o,b),a(t),r=W(t)};return{start(){return e.ticker.add(f),this},stop(){e.stage.removeChild(o),e.ticker.remove(f)}}},Es=async e=>{const t={showBoundingBoxes:"none"},r=new Or;await r.init({background:"#000000",resizeTo:window});const n=xi(e,t),o=fi(n),i=$s(r,n).start();return{campaign:e,events:n.events,renderIn(s){s.appendChild(r.canvas)},changeRoom(s){Nt({gameState:n,toRoom:s})},get currentRoom(){return W(n)},get gameState(){return n},set renderOptions(s){n.renderOptions=s},stop(){console.log("tearing down game"),r.canvas.parentNode?.removeChild(r.canvas),i.stop(),o(),r.destroy()}}},Rs=Object.freeze(Object.defineProperty({__proto__:null,gameMain:Es},Symbol.toStringTag,{value:"Module"}));export{_r as A,wr as C,xr as F,Zn as R,Xn as S,Cr as V,Rs as g,Gn as u};
