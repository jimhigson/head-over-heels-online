const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/campaign-BXiPcX1f.js","assets/index-D-wA4cZA.js","assets/index-Af4gg--y.css","assets/Cheats-DlUTrLYo.js","assets/pixiContainerToString-By_XJWu3.js","assets/browserAll-DmP_fadV.js","assets/webworkerAll-CUxOO5W4.js","assets/Graphics-CTFCAVAS.js","assets/colorToUniform-KTpA7KSL.js","assets/gameMain-yJlnr7HI.js"])))=>i.map(i=>d[i]);
import{b as Ps,r as C,R as Uh,j as p,g as st,i as Xi,_ as gr,a as Iv,t as rt,L as jv,d as Hy,D as Se,c as fo}from"./index-D-wA4cZA.js";var Al={exports:{}},yl={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rf;function Ov(){if(Rf)return yl;Rf=1;var t=Ps();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,s=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return yl.useSyncExternalStoreWithSelector=function(l,c,u,h,d){var f=s(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=o(function(){function g(V){if(!y){if(y=!0,b=V,V=h(V),d!==void 0&&m.hasValue){var _=m.value;if(d(_,V))return x=_}return x=V}if(_=x,r(b,V))return _;var v=h(V);return d!==void 0&&d(_,v)?(b=V,_):(b=V,x=v)}var y=!1,b,x,w=u===void 0?null:u;return[function(){return g(c())},w===null?void 0:function(){return g(w())}]},[c,u,h,d]);var A=n(l,f[0],f[1]);return i(function(){m.hasValue=!0,m.value=A},[A]),a(A),A},yl}var Mf;function Bv(){return Mf||(Mf=1,Al.exports=Ov()),Al.exports}var Nv=Bv();function $y(t){t()}function zv(){let t=null,e=null;return{clear(){t=null,e=null},notify(){$y(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=e={callback:r,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!n||t===null||(n=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var If={notify(){},get:()=>[]};function Lv(t,e){let r,n=If,s=0,i=!1;function o(A){u();const g=n.subscribe(A);let y=!1;return()=>{y||(y=!0,g(),h())}}function a(){n.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){s++,r||(r=t.subscribe(l),n=zv())}function h(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=If)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>n};return m}var Dv=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Fv=Dv(),Uv=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Hv=Uv(),$v=()=>Fv||Hv?C.useLayoutEffect:C.useEffect,Gv=$v();function jf(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function gi(t,e){if(jf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(e,r[s])||!jf(t[r[s]],e[r[s]]))return!1;return!0}var Wv=Symbol.for("react-redux-context"),Yv=typeof globalThis<"u"?globalThis:{};function Qv(){if(!C.createContext)return{};const t=Yv[Wv]??=new Map;let e=t.get(C.createContext);return e||(e=C.createContext(null),t.set(C.createContext,e)),e}var Gr=Qv();function Kv(t){const{children:e,context:r,serverState:n,store:s}=t,i=C.useMemo(()=>{const l=Lv(s);return{store:s,subscription:l,getServerState:n?()=>n:void 0}},[s,n]),o=C.useMemo(()=>s.getState(),[s]);Gv(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=r||Gr;return C.createElement(a.Provider,{value:i},e)}var Xv=Kv;function Hh(t=Gr){return function(){return C.useContext(t)}}var Gy=Hh();function Wy(t=Gr){const e=t===Gr?Gy:Hh(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var $h=Wy();function Jv(t=Gr){const e=t===Gr?$h:Wy(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var Yy=Jv(),Zv=(t,e)=>t===e;function eV(t=Gr){const e=t===Gr?Gy:Hh(t),r=(n,s={})=>{const{equalityFn:i=Zv}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:a,subscription:l,getServerState:c}=o;C.useRef(!0);const u=C.useCallback({[n.name](d){return n(d)}}[n.name],[n]),h=Nv.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return C.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var Qy=eV(),tV=$y;function rV(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,n,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)r=s[0],r==="*"?(o.push(r),a+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~n?n:~i?i:s.length)),a+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~n?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var xl={exports:{}},bl={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Of;function nV(){if(Of)return bl;Of=1;var t=Ps();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,d){var f=d(),m=n({inst:{value:f,getSnapshot:d}}),A=m[0].inst,g=m[1];return i(function(){A.value=f,A.getSnapshot=d,l(A)&&g({inst:A})},[h,f,d]),s(function(){return l(A)&&g({inst:A}),h(function(){l(A)&&g({inst:A})})},[h]),o(f),f}function l(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!r(h,f)}catch{return!0}}function c(h,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return bl.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,bl}var Bf;function sV(){return Bf||(Bf=1,xl.exports=nV()),xl.exports}var iV=sV();const oV=Uh.useInsertionEffect,aV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lV=aV?C.useLayoutEffect:C.useEffect,cV=oV||lV,Ky=t=>{const e=C.useRef([t,(...r)=>e[0](...r)]).current;return cV(()=>{e[0]=t}),e[1]},uV="popstate",Gh="pushState",Wh="replaceState",hV="hashchange",Nf=[uV,Gh,Wh,hV],dV=t=>{for(const e of Nf)addEventListener(e,t);return()=>{for(const e of Nf)removeEventListener(e,t)}},Xy=(t,e)=>iV.useSyncExternalStore(dV,t,e),fV=()=>location.search,pV=({ssrSearch:t=""}={})=>Xy(fV,()=>t),zf=()=>location.pathname,mV=({ssrPath:t}={})=>Xy(zf,t?()=>t:zf),gV=(t,{replace:e=!1,state:r=null}={})=>history[e?Wh:Gh](r,"",t),AV=(t={})=>[mV(t),gV],Lf=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Lf]>"u"){for(const t of[Gh,Wh]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),n=new Event(t);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Lf,{value:!0})}const yV=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Jy=(t="")=>t==="/"?"":t,xV=(t,e)=>t[0]==="~"?t.slice(1):Jy(e)+t,bV=(t="",e)=>yV(Df(Jy(t)),Df(e)),Df=t=>{try{return decodeURI(t)}catch{return t}},Zy={hook:AV,searchHook:pV,parser:rV,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},ex=C.createContext(Zy),Ga=()=>C.useContext(ex),tx={},rx=C.createContext(tx),wV=()=>C.useContext(rx),Yh=t=>{const[e,r]=t.hook(t);return[bV(t.base,e),Ky((n,s)=>r(xV(n,t.base),s))]},nx=(t,e,r,n)=>{const{pattern:s,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",n),o=s.exec(r)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,d)=>[h,l[d]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...n?[a]:[]]:[!1,null]},qV=({children:t,...e})=>{const r=Ga(),n=e.hook?Zy:r;let s=n;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=C.useRef({}),l=a.current,c=l;for(let u in n){const h=u==="base"?n[u]+(e[u]||""):e[u]||n[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,h!==n[u]&&(s=c)}return C.createElement(ex.Provider,{value:s,children:t})},Ff=({children:t,component:e},r)=>e?C.createElement(e,{params:r}):typeof t=="function"?t(r):t,vV=t=>{let e=C.useRef(tx);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([n,s])=>s!==r[n])?t:r},po=({path:t,nest:e,match:r,...n})=>{const s=Ga(),[i]=Yh(s),[o,a,l]=r??nx(s.parser,t,i,e),c=vV({...wV(),...a});if(!o)return null;const u=l?C.createElement(qV,{base:l},Ff(n,c)):Ff(n,c);return C.createElement(rx.Provider,{value:c,children:u})};C.forwardRef((t,e)=>{const r=Ga(),[n,s]=Yh(r),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:d,...f}=t,m=Ky(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a?.(g),g.defaultPrevented||(g.preventDefault(),s(o,t)))}),A=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return l&&C.isValidElement(c)?C.cloneElement(c,{onClick:m,href:A}):C.createElement("a",{...f,onClick:m,href:A,className:u?.call?u(n===o):u,children:c,ref:e})});const sx=t=>Array.isArray(t)?t.flatMap(e=>sx(e&&e.type===C.Fragment?e.props.children:e)):[t],VV=({children:t,location:e})=>{const r=Ga(),[n]=Yh(r);for(const s of sx(t)){let i=0;if(C.isValidElement(s)&&(i=nx(r.parser,s.props.path,e||n,s.props.nest))[0])return C.cloneElement(s,{match:i})}return null},Ur=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t);function at(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var _V=typeof Symbol=="function"&&Symbol.observable||"@@observable",Uf=_V,wl=()=>Math.random().toString(36).substring(7).split("").join("."),SV={INIT:`@@redux/INIT${wl()}`,REPLACE:`@@redux/REPLACE${wl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${wl()}`},ya=SV;function gs(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Qh(t,e,r){if(typeof t!="function")throw new Error(at(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(at(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(at(1));return r(Qh)(t,e)}let n=t,s=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(l)throw new Error(at(3));return s}function h(g){if(typeof g!="function")throw new Error(at(4));if(l)throw new Error(at(5));let y=!0;c();const b=a++;return o.set(b,g),function(){if(y){if(l)throw new Error(at(6));y=!1,c(),o.delete(b),i=null}}}function d(g){if(!gs(g))throw new Error(at(7));if(typeof g.type>"u")throw new Error(at(8));if(typeof g.type!="string")throw new Error(at(17));if(l)throw new Error(at(9));try{l=!0,s=n(s,g)}finally{l=!1}return(i=o).forEach(b=>{b()}),g}function f(g){if(typeof g!="function")throw new Error(at(10));n=g,d({type:ya.REPLACE})}function m(){const g=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(at(11));function b(){const w=y;w.next&&w.next(u())}return b(),{unsubscribe:g(b)}},[Uf](){return this}}}return d({type:ya.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[Uf]:m}}function kV(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:ya.INIT})>"u")throw new Error(at(12));if(typeof r(void 0,{type:ya.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(at(13))})}function Kh(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let s;try{kV(r)}catch(i){s=i}return function(o={},a){if(s)throw s;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],d=r[h],f=o[h],m=d(f,a);if(typeof m>"u")throw a&&a.type,new Error(at(14));c[h]=m,l=l||m!==f}return l=l||n.length!==Object.keys(o).length,l?c:o}}function xa(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function CV(...t){return e=>(r,n)=>{const s=e(r,n);let i=()=>{throw new Error(at(15))};const o={getState:s.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=xa(...a)(s.dispatch),{...s,dispatch:i}}}function Xh(t){return gs(t)&&"type"in t&&typeof t.type=="string"}var Jh=Symbol.for("immer-nothing"),Ai=Symbol.for("immer-draftable"),Tt=Symbol.for("immer-state");function ct(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var kn=Object.getPrototypeOf;function fr(t){return!!t&&!!t[Tt]}function nr(t){return t?ix(t)||Array.isArray(t)||!!t[Ai]||!!t.constructor?.[Ai]||Ji(t)||Zi(t):!1}var PV=Object.prototype.constructor.toString();function ix(t){if(!t||typeof t!="object")return!1;const e=kn(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===PV}function EV(t){return fr(t)||ct(15,t),t[Tt].base_}function ki(t,e){Cn(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function Cn(t){const e=t[Tt];return e?e.type_:Array.isArray(t)?1:Ji(t)?2:Zi(t)?3:0}function Ci(t,e){return Cn(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function ql(t,e){return Cn(t)===2?t.get(e):t[e]}function ox(t,e,r){const n=Cn(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function TV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Ji(t){return t instanceof Map}function Zi(t){return t instanceof Set}function un(t){return t.copy_||t.base_}function Eu(t,e){if(Ji(t))return new Map(t);if(Zi(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=ix(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Tt];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const o=s[i],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(kn(t),n)}else{const n=kn(t);if(n!==null&&r)return{...t};const s=Object.create(n);return Object.assign(s,t)}}function Zh(t,e=!1){return Wa(t)||fr(t)||!nr(t)||(Cn(t)>1&&(t.set=t.add=t.clear=t.delete=RV),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Zh(n,!0))),t}function RV(){ct(2)}function Wa(t){return Object.isFrozen(t)}var Tu={};function Pn(t){const e=Tu[t];return e||ct(0,t),e}function MV(t,e){Tu[t]||(Tu[t]=e)}var Pi;function ax(){return Pi}function IV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Hf(t,e){e&&(Pn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Ru(t){Mu(t),t.drafts_.forEach(jV),t.drafts_=null}function Mu(t){t===Pi&&(Pi=t.parent_)}function $f(t){return Pi=IV(Pi,t)}function jV(t){const e=t[Tt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Gf(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Tt].modified_&&(Ru(e),ct(4)),nr(t)&&(t=ba(e,t),e.parent_||wa(e,t)),e.patches_&&Pn("Patches").generateReplacementPatches_(r[Tt].base_,t,e.patches_,e.inversePatches_)):t=ba(e,r,[]),Ru(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Jh?t:void 0}function ba(t,e,r){if(Wa(e))return e;const n=e[Tt];if(!n)return ki(e,(s,i)=>Wf(t,n,e,s,i,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return wa(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,o=!1;n.type_===3&&(i=new Set(s),s.clear(),o=!0),ki(i,(a,l)=>Wf(t,n,s,a,l,r,o)),wa(t,s,!1),r&&t.patches_&&Pn("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Wf(t,e,r,n,s,i,o){if(fr(s)){const a=i&&e&&e.type_!==3&&!Ci(e.assigned_,n)?i.concat(n):void 0,l=ba(t,s,a);if(ox(r,n,l),fr(l))t.canAutoFreeze_=!1;else return}else o&&r.add(s);if(nr(s)&&!Wa(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ba(t,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&wa(t,s)}}function wa(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Zh(e,r)}function OV(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:ax(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=ed;r&&(s=[n],i=Ei);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return n.draft_=a,n.revoke_=o,a}var ed={get(t,e){if(e===Tt)return t;const r=un(t);if(!Ci(r,e))return BV(t,r,e);const n=r[e];return t.finalized_||!nr(n)?n:n===vl(t.base_,e)?(Vl(t),t.copy_[e]=ju(n,t)):n},has(t,e){return e in un(t)},ownKeys(t){return Reflect.ownKeys(un(t))},set(t,e,r){const n=lx(un(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const s=vl(un(t),e),i=s?.[Tt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(TV(r,s)&&(r!==void 0||Ci(t.base_,e)))return!0;Vl(t),Iu(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vl(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Vl(t),Iu(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=un(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){ct(11)},getPrototypeOf(t){return kn(t.base_)},setPrototypeOf(){ct(12)}},Ei={};ki(ed,(t,e)=>{Ei[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ei.deleteProperty=function(t,e){return Ei.set.call(this,t,e,void 0)};Ei.set=function(t,e,r){return ed.set.call(this,t[0],e,r,t[0])};function vl(t,e){const r=t[Tt];return(r?un(r):t)[e]}function BV(t,e,r){const n=lx(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function lx(t,e){if(!(e in t))return;let r=kn(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=kn(r)}}function Iu(t){t.modified_||(t.modified_=!0,t.parent_&&Iu(t.parent_))}function Vl(t){t.copy_||(t.copy_=Eu(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var NV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(l=i,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&ct(6),n!==void 0&&typeof n!="function"&&ct(7);let s;if(nr(e)){const i=$f(this),o=ju(e,void 0);let a=!0;try{s=r(o),a=!1}finally{a?Ru(i):Mu(i)}return Hf(i,n),Gf(s,i)}else if(!e||typeof e!="object"){if(s=r(e),s===void 0&&(s=e),s===Jh&&(s=void 0),this.autoFreeze_&&Zh(s,!0),n){const i=[],o=[];Pn("Patches").generateReplacementPatches_(e,s,i,o),n(i,o)}return s}else ct(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let n,s;return[this.produce(e,r,(o,a)=>{n=o,s=a}),n,s]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){nr(t)||ct(8),fr(t)&&(t=Ou(t));const e=$f(this),r=ju(t,void 0);return r[Tt].isManual_=!0,Mu(e),r}finishDraft(t,e){const r=t&&t[Tt];(!r||!r.isManual_)&&ct(9);const{scope_:n}=r;return Hf(n,e),Gf(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const s=e[r];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}r>-1&&(e=e.slice(r+1));const n=Pn("Patches").applyPatches_;return fr(t)?n(t,e):this.produce(t,s=>n(s,e))}};function ju(t,e){const r=Ji(t)?Pn("MapSet").proxyMap_(t,e):Zi(t)?Pn("MapSet").proxySet_(t,e):OV(t,e);return(e?e.scope_:ax()).drafts_.push(r),r}function Ou(t){return fr(t)||ct(10,t),cx(t)}function cx(t){if(!nr(t)||Wa(t))return t;const e=t[Tt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Eu(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Eu(t,!0);return ki(r,(n,s)=>{ox(r,n,cx(s))}),e&&(e.finalized_=!1),r}function zV(){const e="replace",r="add",n="remove";function s(d,f,m,A){switch(d.type_){case 0:case 2:return o(d,f,m,A);case 1:return i(d,f,m,A);case 3:return a(d,f,m,A)}}function i(d,f,m,A){let{base_:g,assigned_:y}=d,b=d.copy_;b.length<g.length&&([g,b]=[b,g],[m,A]=[A,m]);for(let x=0;x<g.length;x++)if(y[x]&&b[x]!==g[x]){const w=f.concat([x]);m.push({op:e,path:w,value:h(b[x])}),A.push({op:e,path:w,value:h(g[x])})}for(let x=g.length;x<b.length;x++){const w=f.concat([x]);m.push({op:r,path:w,value:h(b[x])})}for(let x=b.length-1;g.length<=x;--x){const w=f.concat([x]);A.push({op:n,path:w})}}function o(d,f,m,A){const{base_:g,copy_:y}=d;ki(d.assigned_,(b,x)=>{const w=ql(g,b),V=ql(y,b),_=x?Ci(g,b)?e:r:n;if(w===V&&_===e)return;const v=f.concat(b);m.push(_===n?{op:_,path:v}:{op:_,path:v,value:V}),A.push(_===r?{op:n,path:v}:_===n?{op:r,path:v,value:h(w)}:{op:e,path:v,value:h(w)})})}function a(d,f,m,A){let{base_:g,copy_:y}=d,b=0;g.forEach(x=>{if(!y.has(x)){const w=f.concat([b]);m.push({op:n,path:w,value:x}),A.unshift({op:r,path:w,value:x})}b++}),b=0,y.forEach(x=>{if(!g.has(x)){const w=f.concat([b]);m.push({op:r,path:w,value:x}),A.unshift({op:n,path:w,value:x})}b++})}function l(d,f,m,A){m.push({op:e,path:[],value:f===Jh?void 0:f}),A.push({op:e,path:[],value:d})}function c(d,f){return f.forEach(m=>{const{path:A,op:g}=m;let y=d;for(let V=0;V<A.length-1;V++){const _=Cn(y);let v=A[V];typeof v!="string"&&typeof v!="number"&&(v=""+v),(_===0||_===1)&&(v==="__proto__"||v==="constructor")&&ct(19),typeof y=="function"&&v==="prototype"&&ct(19),y=ql(y,v),typeof y!="object"&&ct(18,A.join("/"))}const b=Cn(y),x=u(m.value),w=A[A.length-1];switch(g){case e:switch(b){case 2:return y.set(w,x);case 3:ct(16);default:return y[w]=x}case r:switch(b){case 1:return w==="-"?y.push(x):y.splice(w,0,x);case 2:return y.set(w,x);case 3:return y.add(x);default:return y[w]=x}case n:switch(b){case 1:return y.splice(w,1);case 2:return y.delete(w);case 3:return y.delete(m.value);default:return delete y[w]}default:ct(17,g)}}),d}function u(d){if(!nr(d))return d;if(Array.isArray(d))return d.map(u);if(Ji(d))return new Map(Array.from(d.entries()).map(([m,A])=>[m,u(A)]));if(Zi(d))return new Set(Array.from(d).map(u));const f=Object.create(kn(d));for(const m in d)f[m]=u(d[m]);return Ci(d,Ai)&&(f[Ai]=d[Ai]),f}function h(d){return fr(d)?u(d):d}MV("Patches",{applyPatches_:c,generatePatches_:s,generateReplacementPatches_:l})}var Ht=new NV,Es=Ht.produce,ux=Ht.produceWithPatches.bind(Ht);Ht.setAutoFreeze.bind(Ht);Ht.setUseStrictShallowCopy.bind(Ht);var Yf=Ht.applyPatches.bind(Ht);Ht.createDraft.bind(Ht);Ht.finishDraft.bind(Ht);function LV(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function DV(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function FV(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var Qf=t=>Array.isArray(t)?t:[t];function UV(t){const e=Array.isArray(t[0])?t[0]:t;return FV(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function HV(t,e){const r=[],{length:n}=t;for(let s=0;s<n;s++)r.push(t[s].apply(null,e));return r}var $V=class{constructor(t){this.value=t}deref(){return this.value}},GV=typeof WeakRef<"u"?WeakRef:$V,WV=0,Kf=1;function mo(){return{s:WV,v:void 0,o:null,p:null}}function qa(t,e={}){let r=mo();const{resultEqualityCheck:n}=e;let s,i=0;function o(){let a=r;const{length:l}=arguments;for(let h=0,d=l;h<d;h++){const f=arguments[h];if(typeof f=="function"||typeof f=="object"&&f!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const A=m.get(f);A===void 0?(a=mo(),m.set(f,a)):a=A}else{let m=a.p;m===null&&(a.p=m=new Map);const A=m.get(f);A===void 0?(a=mo(),m.set(f,a)):a=A}}const c=a;let u;if(a.s===Kf)u=a.v;else if(u=t.apply(null,arguments),i++,n){const h=s?.deref?.()??s;h!=null&&n(h,u)&&(u=h,i!==0&&i--),s=typeof u=="object"&&u!==null||typeof u=="function"?new GV(u):u}return c.s=Kf,c.v=u,u}return o.clearCache=()=>{r=mo(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function YV(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...s)=>{let i=0,o=0,a,l={},c=s.pop();typeof c=="object"&&(l=c,c=s.pop()),LV(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=qa,argsMemoizeOptions:m=[]}=u,A=Qf(d),g=Qf(m),y=UV(s),b=h(function(){return i++,c.apply(null,arguments)},...A),x=f(function(){o++;const V=HV(y,arguments);return a=b.apply(null,V),a},...g);return Object.assign(x,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:f})};return Object.assign(n,{withTypes:()=>n}),n}var td=YV(qa),QV=Object.assign((t,e=td)=>{DV(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(i=>t[i]);return e(n,(...i)=>i.reduce((o,a,l)=>(o[r[l]]=a,o),{}))},{withTypes:()=>QV});function hx(t){return({dispatch:r,getState:n})=>s=>i=>typeof i=="function"?i(r,n,t):s(i)}var KV=hx(),XV=hx,JV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?xa:xa.apply(null,arguments)},ZV=t=>t&&typeof t.match=="function";function vt(t,e){function r(...n){if(e){let s=e(...n);if(!s)throw new Error(nt(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Xh(n)&&n.type===t,r}var dx=class oi extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,oi.prototype)}static get[Symbol.species](){return oi}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new oi(...e[0].concat(this)):new oi(...e.concat(this))}};function Xf(t){return nr(t)?Es(t,()=>{}):t}function Bu(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function e0(t){return typeof t=="boolean"}var t0=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new dx;return r&&(e0(r)?o.push(KV):o.push(XV(r.extraArgument))),o},Ya="RTK_autoBatch",Us=()=>t=>({payload:t,meta:{[Ya]:!0}}),Jf=t=>e=>{setTimeout(e,t)},r0=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let s=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Jf(10):t.type==="callback"?t.queueNotification:Jf(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>s&&u(),d=n.subscribe(h);return a.add(u),()=>{d(),a.delete(u)}},dispatch(u){try{return s=!u?.meta?.[Ya],i=!s,i&&(o||(o=!0,l(c))),n.dispatch(u)}finally{s=!0}}})},n0=t=>function(r){const{autoBatch:n=!0}=r??{};let s=new dx(t);return n&&s.push(r0(typeof n=="object"?n:void 0)),s};function s0(t){const e=t0(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(gs(r))a=Kh(r);else throw new Error(nt(1));let l;typeof n=="function"?l=n(e):l=e();let c=xa;s&&(c=JV({trace:!1,...typeof s=="object"&&s}));const u=CV(...l),h=n0(u);let d=typeof o=="function"?o(h):h();const f=c(...d);return Qh(a,i,f)}function fx(t){const e={},r=[];let n;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(nt(28));if(a in e)throw new Error(nt(29));return e[a]=o,s},addMatcher(i,o){return r.push({matcher:i,reducer:o}),s},addDefaultCase(i){return n=i,s}};return t(s),[e,r,n]}function i0(t){return typeof t=="function"}function o0(t,e){let[r,n,s]=fx(e),i;if(i0(t))i=()=>Xf(t());else{const a=Xf(t);i=()=>a}function o(a=i(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[s]),c.reduce((u,h)=>{if(h)if(fr(u)){const f=h(u,l);return f===void 0?u:f}else{if(nr(u))return Es(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return d}}return u},a)}return o.getInitialState=i,o}var px=(t,e)=>ZV(t)?t.match(e):t(e);function pr(...t){return e=>t.some(r=>px(r,e))}function yi(...t){return e=>t.every(r=>px(r,e))}function Qa(t,e){if(!t||!t.meta)return!1;const r=typeof t.meta.requestId=="string",n=e.indexOf(t.meta.requestStatus)>-1;return r&&n}function eo(t){return typeof t[0]=="function"&&"pending"in t[0]&&"fulfilled"in t[0]&&"rejected"in t[0]}function rd(...t){return t.length===0?e=>Qa(e,["pending"]):eo(t)?pr(...t.map(e=>e.pending)):rd()(t[0])}function As(...t){return t.length===0?e=>Qa(e,["rejected"]):eo(t)?pr(...t.map(e=>e.rejected)):As()(t[0])}function Ka(...t){const e=r=>r&&r.meta&&r.meta.rejectedWithValue;return t.length===0?yi(As(...t),e):eo(t)?yi(As(...t),e):Ka()(t[0])}function Wr(...t){return t.length===0?e=>Qa(e,["fulfilled"]):eo(t)?pr(...t.map(e=>e.fulfilled)):Wr()(t[0])}function Nu(...t){return t.length===0?e=>Qa(e,["pending","fulfilled","rejected"]):eo(t)?pr(...t.flatMap(e=>[e.pending,e.rejected,e.fulfilled])):Nu()(t[0])}var a0="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",to=(t=21)=>{let e="",r=t;for(;r--;)e+=a0[Math.random()*64|0];return e},l0=["name","message","stack","code"],_l=class{constructor(t,e){this.payload=t,this.meta=e}_type},Zf=class{constructor(t,e){this.payload=t,this.meta=e}_type},c0=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of l0)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},ep="External signal was aborted",tp=(()=>{function t(e,r,n){const s=vt(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=vt(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=vt(e+"/rejected",(l,c,u,h,d)=>({payload:h,error:(n&&n.serializeError||c0)(l||"Rejected"),meta:{...d||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,d)=>{const f=n?.idGenerator?n.idGenerator(l):to(),m=new AbortController;let A,g;function y(x){g=x,m.abort()}c&&(c.aborted?y(ep):c.addEventListener("abort",()=>y(ep),{once:!0}));const b=async function(){let x;try{let V=n?.condition?.(l,{getState:h,extra:d});if(h0(V)&&(V=await V),V===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const _=new Promise((v,S)=>{A=()=>{S({name:"AbortError",message:g||"Aborted"})},m.signal.addEventListener("abort",A)});u(i(f,l,n?.getPendingMeta?.({requestId:f,arg:l},{getState:h,extra:d}))),x=await Promise.race([_,Promise.resolve(r(l,{dispatch:u,getState:h,extra:d,requestId:f,signal:m.signal,abort:y,rejectWithValue:(v,S)=>new _l(v,S),fulfillWithValue:(v,S)=>new Zf(v,S)})).then(v=>{if(v instanceof _l)throw v;return v instanceof Zf?s(v.payload,f,l,v.meta):s(v,f,l)})])}catch(V){x=V instanceof _l?o(null,f,l,V.payload,V.meta):o(V,f,l)}finally{A&&m.signal.removeEventListener("abort",A)}return n&&!n.dispatchConditionRejection&&o.match(x)&&x.meta.condition||u(x),x}();return Object.assign(b,{abort:y,requestId:f,arg:l,unwrap(){return b.then(u0)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:s,settled:pr(o,s),typePrefix:e})}return t.withTypes=()=>t,t})();function u0(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function h0(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var d0=Symbol.for("rtk-slice-createasyncthunk");function f0(t,e){return`${t}/${e}`}function p0({creators:t}={}){const e=t?.asyncThunk?.[d0];return function(n){const{name:s,reducerPath:i=s}=n;if(!s)throw new Error(nt(11));const o=(typeof n.reducers=="function"?n.reducers(g0()):n.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(b,x){const w=typeof b=="string"?b:b.type;if(!w)throw new Error(nt(12));if(w in l.sliceCaseReducersByType)throw new Error(nt(13));return l.sliceCaseReducersByType[w]=x,c},addMatcher(b,x){return l.sliceMatchers.push({matcher:b,reducer:x}),c},exposeAction(b,x){return l.actionCreators[b]=x,c},exposeCaseReducer(b,x){return l.sliceCaseReducersByName[b]=x,c}};a.forEach(b=>{const x=o[b],w={reducerName:b,type:f0(s,b),createNotation:typeof n.reducers=="function"};y0(x)?b0(w,x,c,e):A0(w,x,c)});function u(){const[b={},x=[],w=void 0]=typeof n.extraReducers=="function"?fx(n.extraReducers):[n.extraReducers],V={...b,...l.sliceCaseReducersByType};return o0(n.initialState,_=>{for(let v in V)_.addCase(v,V[v]);for(let v of l.sliceMatchers)_.addMatcher(v.matcher,v.reducer);for(let v of x)_.addMatcher(v.matcher,v.reducer);w&&_.addDefaultCase(w)})}const h=b=>b,d=new Map;let f;function m(b,x){return f||(f=u()),f(b,x)}function A(){return f||(f=u()),f.getInitialState()}function g(b,x=!1){function w(_){let v=_[b];return typeof v>"u"&&x&&(v=A()),v}function V(_=h){const v=Bu(d,x,()=>new WeakMap);return Bu(v,_,()=>{const S={};for(const[E,R]of Object.entries(n.selectors??{}))S[E]=m0(R,_,A,x);return S})}return{reducerPath:b,getSelectors:V,get selectors(){return V(w)},selectSlice:w}}const y={name:s,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:A,...g(i),injectInto(b,{reducerPath:x,...w}={}){const V=x??i;return b.inject({reducerPath:V,reducer:m},w),{...y,...g(V,!0)}}};return y}}function m0(t,e,r,n){function s(i,...o){let a=e(i);return typeof a>"u"&&n&&(a=r()),t(a,...o)}return s.unwrapped=t,s}var _r=p0();function g0(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function A0({type:t,reducerName:e,createNotation:r},n,s){let i,o;if("reducer"in n){if(r&&!x0(n))throw new Error(nt(17));i=n.reducer,o=n.prepare}else i=n;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?vt(t,o):vt(t))}function y0(t){return t._reducerDefinitionType==="asyncThunk"}function x0(t){return t._reducerDefinitionType==="reducerWithPrepare"}function b0({type:t,reducerName:e},r,n,s){if(!s)throw new Error(nt(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=s(t,i,u);n.exposeAction(e,h),o&&n.addCase(h.fulfilled,o),a&&n.addCase(h.pending,a),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(e,{fulfilled:o||go,pending:a||go,rejected:l||go,settled:c||go})}function go(){}var w0="task",mx="listener",gx="completed",nd="cancelled",q0=`task-${nd}`,v0=`task-${gx}`,zu=`${mx}-${nd}`,V0=`${mx}-${gx}`,Xa=class{constructor(t){this.code=t,this.message=`${w0} ${nd} (reason: ${t})`}name="TaskAbortError";message},sd=(t,e)=>{if(typeof t!="function")throw new TypeError(nt(32))},va=()=>{},Ax=(t,e=va)=>(t.catch(e),t),yx=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Vn=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},_n=t=>{if(t.aborted){const{reason:e}=t;throw new Xa(e)}};function xx(t,e){let r=va;return new Promise((n,s)=>{const i=()=>s(new Xa(t.reason));if(t.aborted){i();return}r=yx(t,i),e.finally(()=>r()).then(n,s)}).finally(()=>{r=va})}var _0=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Xa?"cancelled":"rejected",error:r}}finally{e?.()}},Va=t=>e=>Ax(xx(t,e).then(r=>(_n(t),r))),bx=t=>{const e=Va(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:ls}=Object,rp={},Ja="listenerMiddleware",S0=(t,e)=>{const r=n=>yx(t,()=>Vn(n,t.reason));return(n,s)=>{sd(n);const i=new AbortController;r(i);const o=_0(async()=>{_n(t),_n(i.signal);const a=await n({pause:Va(i.signal),delay:bx(i.signal),signal:i.signal});return _n(i.signal),a},()=>Vn(i,v0));return s?.autoJoin&&e.push(o.catch(va)),{result:Va(t)(o),cancel(){Vn(i,q0)}}}},k0=(t,e)=>{const r=async(n,s)=>{_n(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:n,effect:(h,d)=>{d.unsubscribe(),l([h,d.getState(),d.getOriginalState()])}});i=()=>{u(),c()}})];s!=null&&a.push(new Promise(l=>setTimeout(l,s,null)));try{const l=await xx(e,Promise.race(a));return _n(e),l}finally{i()}};return(n,s)=>Ax(r(n,s))},wx=t=>{let{type:e,actionCreator:r,matcher:n,predicate:s,effect:i}=t;if(e)s=vt(e).match;else if(r)e=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(nt(21));return sd(i),{predicate:s,type:e,effect:i}},qx=ls(t=>{const{type:e,predicate:r,effect:n}=wx(t);return{id:to(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(nt(22))}}},{withTypes:()=>qx}),np=(t,e)=>{const{type:r,effect:n,predicate:s}=wx(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===s)&&i.effect===n)},Lu=t=>{t.pending.forEach(e=>{Vn(e,zu)})},C0=t=>()=>{t.forEach(Lu),t.clear()},sp=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},vx=ls(vt(`${Ja}/add`),{withTypes:()=>vx}),P0=vt(`${Ja}/removeAll`),Vx=ls(vt(`${Ja}/remove`),{withTypes:()=>Vx}),E0=(...t)=>{console.error(`${Ja}/error`,...t)},T0=(t={})=>{const e=new Map,{extra:r,onError:n=E0}=t;sd(n);const s=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Lu(u)}),i=u=>{const h=np(e,u)??qx(u);return s(h)};ls(i,{withTypes:()=>i});const o=u=>{const h=np(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Lu(h)),!!h};ls(o,{withTypes:()=>o});const a=async(u,h,d,f)=>{const m=new AbortController,A=k0(i,m.signal),g=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,ls({},d,{getOriginalState:f,condition:(y,b)=>A(y,b).then(Boolean),take:A,delay:bx(m.signal),pause:Va(m.signal),extra:r,signal:m.signal,fork:S0(m.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,b,x)=>{y!==m&&(Vn(y,zu),x.delete(y))})},cancel:()=>{Vn(m,zu),u.pending.delete(m)},throwIfCancelled:()=>{_n(m.signal)}})))}catch(y){y instanceof Xa||sp(n,y,{raisedBy:"effect"})}finally{await Promise.all(g),Vn(m,V0),u.pending.delete(m)}},l=C0(e);return{middleware:u=>h=>d=>{if(!Xh(d))return h(d);if(vx.match(d))return i(d.payload);if(P0.match(d)){l();return}if(Vx.match(d))return o(d.payload);let f=u.getState();const m=()=>{if(f===rp)throw new Error(nt(23));return f};let A;try{if(A=h(d),e.size>0){const g=u.getState(),y=Array.from(e.values());for(const b of y){let x=!1;try{x=b.predicate(d,g,f)}catch(w){x=!1,sp(n,w,{raisedBy:"predicate"})}x&&a(b,d,u,m)}}}finally{f=rp}return A},startListening:i,stopListening:o,clearListeners:l}},R0=t=>"reducerPath"in t&&typeof t.reducerPath=="string",M0=t=>t.flatMap(e=>R0(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),id=Symbol.for("rtk-state-proxy-original"),I0=t=>!!t&&!!t[id],j0=new WeakMap,O0=(t,e)=>Bu(j0,t,()=>new Proxy(t,{get:(r,n,s)=>{if(n===id)return r;const i=Reflect.get(r,n,s);if(typeof i>"u"){const o=e[n.toString()];if(o){const a=o(void 0,{type:to()});if(typeof a>"u")throw new Error(nt(24));return a}}return i}})),B0=t=>{if(!I0(t))throw new Error(nt(25));return t[id]},N0=(t={})=>t;function z0(...t){const e=Object.fromEntries(M0(t)),r=()=>Object.keys(e).length?Kh(e):N0;let n=r();function s(a,l){return n(a,l)}s.withLazyLoadedSlices=()=>s;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,n=r()),s},o=Object.assign(function(l,c){return function(h,...d){return l(O0(c?c(h,...d):h,e),...d)}},{original:B0});return Object.assign(s,{inject:i,selector:o})}function nt(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const od=C.createContext(null),L0=({gameApi:t,children:e})=>p.jsx(od,{value:t,children:e}),Ts=()=>{const t=C.useContext(od);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},_x=()=>{const t=C.useContext(od);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},Sx=T0(),kx=Sx.startListening.withTypes();function D0(t){var e="";return r(t),e;function r(s){if(s===null||typeof s!="object"||s.toJSON!=null)e+=JSON.stringify(s);else if(Array.isArray(s)){e+="[";var i=!1;s.forEach(function(a){i&&(e+=","),i=!0,a===void 0&&(a=null),r(a)}),e+="]"}else{e+="{";var o=Object.keys(s).filter(function(a){return s[a]!==void 0}).sort();o.forEach(function(a,l){return n(s,a,l)}),e+="}"}}function n(s,i,o){o>0&&(e+=","),e+=JSON.stringify(i),e+=":",r(s[i])}}var ad="persist:",ld="persist/FLUSH",ro="persist/REHYDRATE",cd="persist/PAUSE",ud="persist/PERSIST",hd="persist/PURGE",dd="persist/REGISTER",Cx=-1;function aa(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?aa=function(r){return typeof r}:aa=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},aa(t)}function ip(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function F0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ip(r,!0).forEach(function(n){U0(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ip(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H0(t,e,r,n){n.debug;var s=F0({},r);return t&&aa(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(s[i]=t[i])}),s}function $0(t){var e=t.blacklist||null,r=t.whitelist||null,n=t.transforms||[],s=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:ad).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(V){return V}:typeof t.serialize=="function"?a=t.serialize:a=G0;var l=t.writeFailHandler||null,c={},u={},h=[],d=null,f=null,m=function(V){Object.keys(V).forEach(function(_){y(_)&&c[_]!==V[_]&&h.indexOf(_)===-1&&h.push(_)}),Object.keys(c).forEach(function(_){V[_]===void 0&&y(_)&&h.indexOf(_)===-1&&c[_]!==void 0&&h.push(_)}),d===null&&(d=setInterval(A,s)),c=V};function A(){if(h.length===0){d&&clearInterval(d),d=null;return}var w=h.shift(),V=n.reduce(function(_,v){return v.in(_,w,c)},c[w]);if(V!==void 0)try{u[w]=a(V)}catch(_){console.error("redux-persist/createPersistoid: error serializing state",_)}else delete u[w];h.length===0&&g()}function g(){Object.keys(u).forEach(function(w){c[w]===void 0&&delete u[w]}),f=o.setItem(i,a(u)).catch(b)}function y(w){return!(r&&r.indexOf(w)===-1&&w!=="_persist"||e&&e.indexOf(w)!==-1)}function b(w){l&&l(w)}var x=function(){for(;h.length!==0;)A();return f||Promise.resolve()};return{update:m,flush:x}}function G0(t){return JSON.stringify(t)}function W0(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:ad).concat(t.key),n=t.storage;t.debug;var s;return t.deserialize===!1?s=function(o){return o}:typeof t.deserialize=="function"?s=t.deserialize:s=Y0,n.getItem(r).then(function(i){if(i)try{var o={},a=s(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},s(a[l]))}),o}catch(l){throw l}else return})}function Y0(t){return JSON.parse(t)}function Q0(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:ad).concat(t.key);return e.removeItem(r,K0)}function K0(t){}function op(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function br(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?op(r,!0).forEach(function(n){X0(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):op(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function X0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J0(t,e){if(t==null)return{};var r=Z0(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Z0(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}var e_=5e3;function t_(t,e){var r=t.version!==void 0?t.version:Cx;t.debug;var n=t.stateReconciler===void 0?H0:t.stateReconciler,s=t.getStoredState||W0,i=t.timeout!==void 0?t.timeout:e_,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var d=u||{},f=d._persist,m=J0(d,["_persist"]),A=m;if(h.type===ud){var g=!1,y=function(S,E){g||(h.rehydrate(t.key,S,E),g=!0)};if(i&&setTimeout(function(){!g&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=$0(t)),f)return br({},e(A,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),s(t).then(function(v){var S=t.migrate||function(E,R){return Promise.resolve(E)};S(v,r).then(function(E){y(E)},function(E){y(void 0,E)})},function(v){y(void 0,v)}),br({},e(A,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===hd)return a=!0,h.result(Q0(t)),br({},e(A,h),{_persist:f});if(h.type===ld)return h.result(o&&o.flush()),br({},e(A,h),{_persist:f});if(h.type===cd)l=!0;else if(h.type===ro){if(a)return br({},A,{_persist:br({},f,{rehydrated:!0})});if(h.key===t.key){var b=e(A,h),x=h.payload,w=n!==!1&&x!==void 0?n(x,u,b,t):b,V=br({},w,{_persist:br({},f,{rehydrated:!0})});return c(V)}}}if(!f)return e(u,h);var _=e(A,h);return _===A?u:c(br({},_,{_persist:f}))}}function ap(t){return s_(t)||n_(t)||r_()}function r_(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n_(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function s_(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function lp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Du(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lp(r,!0).forEach(function(n){i_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lp(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function i_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Px={registry:[],bootstrapped:!1},o_=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Px,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case dd:return Du({},e,{registry:[].concat(ap(e.registry),[r.key])});case ro:var n=e.registry.indexOf(r.key),s=ap(e.registry);return s.splice(n,1),Du({},e,{registry:s,bootstrapped:s.length===0});default:return e}};function a_(t,e,r){var n=Qh(o_,Px,void 0),s=function(l){n.dispatch({type:dd,key:l})},i=function(l,c,u){var h={type:ro,payload:c,err:u,key:l};t.dispatch(h),n.dispatch(h)},o=Du({},n,{purge:function(){var l=[];return t.dispatch({type:hd,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:ld,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:cd})},persist:function(){t.dispatch({type:ud,register:s,rehydrate:i})}});return o.persist(),o}function l_(t,e){return function(r,n){if(!r)return Promise.resolve(void 0);var s=r._persist&&r._persist.version!==void 0?r._persist.version:Cx;if(s===n||s>n)return Promise.resolve(r);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return n>=a&&a>s}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},r);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const cs=1e-4,Hr=(t,e)=>Math.abs(t-e)<cs,dF=t=>t===0?cs:Math.abs(t)<cs?cs*Math.sign(t):t,Ti=["away","towards","left","right"],c_=["awayRight","towardsRight","towardsLeft","awayLeft"],ys=[...Ti,...c_],Ex=t=>t==="away"||t==="towards"?"y":"x",fF=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",Tx=t=>fd(Ex(t)),fd=t=>t==="x"?"y":"x",$r=(t,...e)=>e.reduce((r,n)=>({x:r.x+(n.x??0),y:r.y+(n.y??0)}),t),u_=(t,...e)=>e.reduce((r,n)=>({x:r.x-(n.x??0),y:r.y-(n.y??0)}),t),Rx=(t,e)=>({x:t.x*e,y:t.y*e}),Rt=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),h_=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),no=({x:t,y:e,z:r})=>Math.hypot(t,e,r),Mx=({x:t,y:e})=>Math.hypot(t,e),d_=({x:t,y:e,z:r})=>t**2+e**2+r**2,pF=({x:t,y:e})=>t**2+e**2,wn=t=>{const e=no(t);if(e===0)throw new Error("unitVector called with zero length vector");return Rt(t,1/e)},ee=(...t)=>t.reduce(({x:e,y:r,z:n},{x:s=0,y:i=0,z:o=0})=>({x:e+s,y:r+i,z:n+o}),ae),f_=(...t)=>t.reduce(({x:e,y:r,z:n},{x:s,y:i,z:o})=>({x:e*s,y:r*i,z:n*o}),Za),Rr=(t,...e)=>e.reduce((r,n)=>({x:r.x-(n.x??0),y:r.y-(n.y??0),z:r.z-(n.z??0)}),t),pd=({x:t,y:e,z:r},{x:n,y:s,z:i})=>t===n&&e===s&&r===i,p_=({x:t,y:e},{x:r,y:n})=>t===r&&e===n,mF=t=>{const{x:e}=t,r=Math.round(e),n=!Number.isInteger(e)&&Hr(e,r),{y:s}=t,i=Math.round(s),o=!Number.isInteger(s)&&Hr(s,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&Hr(t.z,l);return n||o||c?{x:n?r:e,y:o?i:s,z:c?l:a}:t},gF=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),AF=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),m_=Object.freeze({x:0,y:0}),ae=Object.freeze({x:0,y:0,z:0}),Za=Object.freeze({x:1,y:1,z:1}),g_=["x","y","z"],_a=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,A_=({x:t,y:e})=>{if(!(Hr(t,0)&&Hr(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},y_=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],md=({x:t,y:e})=>{if(Hr(t,0)&&Hr(e,0))return;const r=Math.atan2(-e,-t),n=Math.round(8*r/(2*Math.PI))&7;return y_[n]},yF=({x:t,y:e},{x:r,y:n})=>Math.abs(r-t)**2+Math.abs(n-e)**2,xF=(t,e)=>{const r=t.x*e.x+t.y*e.y+t.z*e.z;if(r<=0)return!1;const n=t.x*t.x+t.y*t.y+t.z*t.z,s=e.x*e.x+e.y*e.y+e.z*e.z;return Math.abs(r*r-n*s)<cs},Ix=["lookUp","lookDown","lookLeft","lookRight"],jx=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...Ti,...Ix],Ox=[...jx];var Sl={exports:{}},kl={exports:{}},cp;function Zr(){return cp||(cp=1,function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(kl)),kl.exports}var up;function x_(){return up||(up=1,function(t){var e=Zr().default;function r(){t.exports=r=function(){return s},t.exports.__esModule=!0,t.exports.default=t.exports;var n,s={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(M,T,j){M[T]=j.value},l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function d(M,T,j){return Object.defineProperty(M,T,{value:j,enumerable:!0,configurable:!0,writable:!0}),M[T]}try{d({},"")}catch{d=function(j,O,N){return j[O]=N}}function f(M,T,j,O){var N=T&&T.prototype instanceof w?T:w,D=Object.create(N.prototype),F=new k(O||[]);return a(D,"_invoke",{value:z(M,j,F)}),D}function m(M,T,j){try{return{type:"normal",arg:M.call(T,j)}}catch(O){return{type:"throw",arg:O}}}s.wrap=f;var A="suspendedStart",g="suspendedYield",y="executing",b="completed",x={};function w(){}function V(){}function _(){}var v={};d(v,c,function(){return this});var S=Object.getPrototypeOf,E=S&&S(S(P([])));E&&E!==i&&o.call(E,c)&&(v=E);var R=_.prototype=w.prototype=Object.create(v);function I(M){["next","throw","return"].forEach(function(T){d(M,T,function(j){return this._invoke(T,j)})})}function B(M,T){function j(N,D,F,G){var Q=m(M[N],M,D);if(Q.type!=="throw"){var re=Q.arg,ie=re.value;return ie&&e(ie)=="object"&&o.call(ie,"__await")?T.resolve(ie.__await).then(function(ne){j("next",ne,F,G)},function(ne){j("throw",ne,F,G)}):T.resolve(ie).then(function(ne){re.value=ne,F(re)},function(ne){return j("throw",ne,F,G)})}G(Q.arg)}var O;a(this,"_invoke",{value:function(D,F){function G(){return new T(function(Q,re){j(D,F,Q,re)})}return O=O?O.then(G,G):G()}})}function z(M,T,j){var O=A;return function(N,D){if(O===y)throw Error("Generator is already running");if(O===b){if(N==="throw")throw D;return{value:n,done:!0}}for(j.method=N,j.arg=D;;){var F=j.delegate;if(F){var G=L(F,j);if(G){if(G===x)continue;return G}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(O===A)throw O=b,j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);O=y;var Q=m(M,T,j);if(Q.type==="normal"){if(O=j.done?b:g,Q.arg===x)continue;return{value:Q.arg,done:j.done}}Q.type==="throw"&&(O=b,j.method="throw",j.arg=Q.arg)}}}function L(M,T){var j=T.method,O=M.iterator[j];if(O===n)return T.delegate=null,j==="throw"&&M.iterator.return&&(T.method="return",T.arg=n,L(M,T),T.method==="throw")||j!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+j+"' method")),x;var N=m(O,M.iterator,T.arg);if(N.type==="throw")return T.method="throw",T.arg=N.arg,T.delegate=null,x;var D=N.arg;return D?D.done?(T[M.resultName]=D.value,T.next=M.nextLoc,T.method!=="return"&&(T.method="next",T.arg=n),T.delegate=null,x):D:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,x)}function U(M){var T={tryLoc:M[0]};1 in M&&(T.catchLoc=M[1]),2 in M&&(T.finallyLoc=M[2],T.afterLoc=M[3]),this.tryEntries.push(T)}function q(M){var T=M.completion||{};T.type="normal",delete T.arg,M.completion=T}function k(M){this.tryEntries=[{tryLoc:"root"}],M.forEach(U,this),this.reset(!0)}function P(M){if(M||M===""){var T=M[c];if(T)return T.call(M);if(typeof M.next=="function")return M;if(!isNaN(M.length)){var j=-1,O=function N(){for(;++j<M.length;)if(o.call(M,j))return N.value=M[j],N.done=!1,N;return N.value=n,N.done=!0,N};return O.next=O}}throw new TypeError(e(M)+" is not iterable")}return V.prototype=_,a(R,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:V,configurable:!0}),V.displayName=d(_,h,"GeneratorFunction"),s.isGeneratorFunction=function(M){var T=typeof M=="function"&&M.constructor;return!!T&&(T===V||(T.displayName||T.name)==="GeneratorFunction")},s.mark=function(M){return Object.setPrototypeOf?Object.setPrototypeOf(M,_):(M.__proto__=_,d(M,h,"GeneratorFunction")),M.prototype=Object.create(R),M},s.awrap=function(M){return{__await:M}},I(B.prototype),d(B.prototype,u,function(){return this}),s.AsyncIterator=B,s.async=function(M,T,j,O,N){N===void 0&&(N=Promise);var D=new B(f(M,T,j,O),N);return s.isGeneratorFunction(T)?D:D.next().then(function(F){return F.done?F.value:D.next()})},I(R),d(R,h,"Generator"),d(R,c,function(){return this}),d(R,"toString",function(){return"[object Generator]"}),s.keys=function(M){var T=Object(M),j=[];for(var O in T)j.push(O);return j.reverse(),function N(){for(;j.length;){var D=j.pop();if(D in T)return N.value=D,N.done=!1,N}return N.done=!0,N}},s.values=P,k.prototype={constructor:k,reset:function(T){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(q),!T)for(var j in this)j.charAt(0)==="t"&&o.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=n)},stop:function(){this.done=!0;var T=this.tryEntries[0].completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(T){if(this.done)throw T;var j=this;function O(re,ie){return F.type="throw",F.arg=T,j.next=re,ie&&(j.method="next",j.arg=n),!!ie}for(var N=this.tryEntries.length-1;N>=0;--N){var D=this.tryEntries[N],F=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var G=o.call(D,"catchLoc"),Q=o.call(D,"finallyLoc");if(G&&Q){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(G){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!Q)throw Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(T,j){for(var O=this.tryEntries.length-1;O>=0;--O){var N=this.tryEntries[O];if(N.tryLoc<=this.prev&&o.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var D=N;break}}D&&(T==="break"||T==="continue")&&D.tryLoc<=j&&j<=D.finallyLoc&&(D=null);var F=D?D.completion:{};return F.type=T,F.arg=j,D?(this.method="next",this.next=D.finallyLoc,x):this.complete(F)},complete:function(T,j){if(T.type==="throw")throw T.arg;return T.type==="break"||T.type==="continue"?this.next=T.arg:T.type==="return"?(this.rval=this.arg=T.arg,this.method="return",this.next="end"):T.type==="normal"&&j&&(this.next=j),x},finish:function(T){for(var j=this.tryEntries.length-1;j>=0;--j){var O=this.tryEntries[j];if(O.finallyLoc===T)return this.complete(O.completion,O.afterLoc),q(O),x}},catch:function(T){for(var j=this.tryEntries.length-1;j>=0;--j){var O=this.tryEntries[j];if(O.tryLoc===T){var N=O.completion;if(N.type==="throw"){var D=N.arg;q(O)}return D}}throw Error("illegal catch attempt")},delegateYield:function(T,j,O){return this.delegate={iterator:P(T),resultName:j,nextLoc:O},this.method==="next"&&(this.arg=n),x}},s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Sl)),Sl.exports}var Cl,hp;function en(){if(hp)return Cl;hp=1;var t=x_()();Cl=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return Cl}var jt={},Pl={exports:{}},El={exports:{}},Tl={exports:{}},dp;function b_(){return dp||(dp=1,function(t){var e=Zr().default;function r(n,s){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,s||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Tl)),Tl.exports}var fp;function Bx(){return fp||(fp=1,function(t){var e=Zr().default,r=b_();function n(s){var i=r(s,"string");return e(i)=="symbol"?i:i+""}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(El)),El.exports}var pp;function w_(){return pp||(pp=1,function(t){var e=Bx();function r(n,s,i){return(s=e(s))in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Pl)),Pl.exports}var Rl={exports:{}},Ml={exports:{}},Il={exports:{}},mp;function Nx(){return mp||(mp=1,function(t){function e(r,n){(n==null||n>r.length)&&(n=r.length);for(var s=0,i=Array(n);s<n;s++)i[s]=r[s];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Il)),Il.exports}var gp;function q_(){return gp||(gp=1,function(t){var e=Nx();function r(n){if(Array.isArray(n))return e(n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ml)),Ml.exports}var jl={exports:{}},Ap;function v_(){return Ap||(Ap=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(jl)),jl.exports}var Ol={exports:{}},yp;function zx(){return yp||(yp=1,function(t){var e=Nx();function r(n,s){if(n){if(typeof n=="string")return e(n,s);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,s):void 0}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Ol)),Ol.exports}var Bl={exports:{}},xp;function V_(){return xp||(xp=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Bl)),Bl.exports}var bp;function gd(){return bp||(bp=1,function(t){var e=q_(),r=v_(),n=zx(),s=V_();function i(o){return e(o)||r(o)||n(o)||s()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(Rl)),Rl.exports}var Nl={},zl={},wp;function el(){if(wp)return zl;wp=1;function t(e){return typeof e<"u"}return zl.notUndefined=t,zl}var qp;function Lx(){if(qp)return Nl;qp=1;var t=el(),e=t.notUndefined;function r(n){return n!=null&&e(n[Symbol.iterator])}return Nl.isIterable=r,Nl}var Ll={},vp;function __(){return vp||(vp=1,Ll.isLoopable=Lx().isIterable),Ll}var Dl={},Vp;function S_(){if(Vp)return Dl;Vp=1;var t=el(),e=t.notUndefined;function r(n){return n==null||e(n[Symbol.iterator])}return Dl.isWrappable=r,Dl}var Ao={},_p;function k_(){if(_p)return Ao;_p=1;var t=en(),e=t.mark(n),r=t.mark(s);function n(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(i,"t0",1);case 1:case"end":return a.stop()}},e)}Ao.wrap=n;function s(i){return t.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i==null){a.next=2;break}return a.delegateYield(i,"t0",2);case 2:case"end":return a.stop()}},r)}return Ao.nullableWrap=s,Ao}var yo={},Sp;function C_(){if(Sp)return yo;Sp=1;var t=gd();function e(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s.length,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return i<=l.length?s.apply(void 0,t(o).concat(l)):e(s,i-l.length,[].concat(t(o),l))}}yo.curry=e;function r(s,i){var o=s.fn,a=s.validateArgs,l=s.variadic,c=s.reduces,u=s.growRight,h=s.minArgs,d=s.maxArgs,f=s.isIterable,m=s.iterableType,A=s.applyOnIterableArgs,g=s.IterableClass;if(i.length>h){var y=!0,b=l?i.findIndex(function(E,R){return f(E)&&R>=h}):Math.min(d,i.length-1),x=l?i.length:b+1;if(l)for(var w=b;w<i.length;w++)y=y&&f(i[w]);else y=f(i[b]);if(i.length>d&&(b===-1||!y)){var V=l?"...".concat(m,"s"):m,_="".concat(o.name," takes up to ").concat(d," arguments, followed by ").concat(V,". ")+"You already passed ".concat(i.length," arguments");throw l?new Error("".concat(_," and the following arguments were not all ").concat(m,"s")):new Error("".concat(_," and the last argument was not ").concat(m))}if(b>=0&&y){for(var v=b;v<x;v++)i[v]=A(i[v]);var S=l?i.slice(b):i[b];return i.splice(b),u||i.reverse(),i.unshift(S),a(i),c?o.apply(void 0,t(i)):new g(o,i)}}return n(s,i)}function n(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];if(a.length===0)throw new Error("Cannot make a partial application with no arguments");return a.unshift.apply(a,t(i)),r(s,a)}}return yo.variadicCurryWithValidation=n,yo}var Hs={},kp;function P_(){if(kp)return Hs;kp=1;var t=Symbol.for("_");Hs._=t;var e=Symbol("__iterate");Hs.__iterate=e;var r=Symbol("split");return Hs.split=r,Hs}var Cp;function $t(){if(Cp)return jt;Cp=1;var t=w_(),e=gd(),r,n=Lx(),s=n.isIterable,i=__(),o=i.isLoopable,a=S_(),l=a.isWrappable,c=k_(),u=c.nullableWrap,h=C_(),d=h.variadicCurryWithValidation,f=P_(),m=f._,A=f.__iterate;jt.wrap=u,jt.isIterable=s,jt.isLoopable=o,jt.isWrappable=l;function g(S){if(l(S))return s(S)?S:u(S);throw typeof S.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}jt.ensureIterable=g;function y(S){"return"in S&&S.return()}jt.callReturn=y;function b(S,E){this[m]={fn:S,args:E,staticIterator:null}}jt.BaseIterableIterator=b,Object.assign(b.prototype,(r={constructor:b},t(r,A,function(){var S=this[m],E=S.fn,R=S.args;return E.apply(void 0,e(R))}),t(r,"next",function(){var E=this[m];return E.staticIterator=E.staticIterator||this[A](),E.staticIterator.next()}),t(r,"return",function(E){var R=this[m];return R.staticIterator=R.staticIterator||this[A](),R.staticIterator.return(E)}),t(r,"throw",function(E){var R=this[m];return R.staticIterator=R.staticIterator||this[A](),R.staticIterator.throw(E)}),r));function x(){for(var S=arguments.length,E=new Array(S),R=0;R<S;R++)E[R]=arguments[R];b.apply(this,E)}jt.IterableIterator=x,x.prototype=Object.assign(Object.create(b.prototype),t({constructor:x},Symbol.iterator,function(){return this[A]()}));function w(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=E.validateArgs,I=R===void 0?function(D){}:R,B=E.variadic,z=B===void 0?!1:B,L=E.reduces,U=L===void 0?!1:L,q=E.growRight,k=q===void 0?!1:q,P=E.minArgs,M=P===void 0?S.length-1:P,T=E.maxArgs,j=T===void 0?S.length-1:T,O=E.applyOnIterableArgs,N=O===void 0?g:O;return{fn:S,validateArgs:I,variadic:z,reduces:U,growRight:k,minArgs:M,maxArgs:j,isIterable:l,iterableType:"iterable",applyOnIterableArgs:N,IterableClass:x}}function V(S){return e(S)}jt.cache=V;function _(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=E.validateArgs,I=R===void 0?function(B){return B}:R;return function(){for(var B=arguments.length,z=new Array(B),L=0;L<B;L++)z[L]=arguments[L];return I(z),new x(S,z)}}jt.wrapWithIterableIterator=_;var v=function(E,R){return d(w(E,R))};return jt.iterableCurry=v,jt}var Fl={exports:{}},Pp;function Ad(){return Pp||(Pp=1,function(t){function e(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Fl)),Fl.exports}var Ul={exports:{}},Ep;function yd(){return Ep||(Ep=1,function(t){var e=Bx();function r(s,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,e(a.key),a)}}function n(s,i,o){return i&&r(s.prototype,i),o&&r(s,o),Object.defineProperty(s,"prototype",{writable:!1}),s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Ul)),Ul.exports}var Hl={exports:{}},$l={exports:{}},Tp;function Dx(){return Tp||(Tp=1,function(t){function e(r,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}($l)),$l.exports}var Rp;function E_(){return Rp||(Rp=1,function(t){var e=Dx();function r(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&e(n,s)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Hl)),Hl.exports}var Gl={exports:{}},Wl={exports:{}},Mp;function T_(){return Mp||(Mp=1,function(t){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Wl)),Wl.exports}var Ip;function R_(){return Ip||(Ip=1,function(t){var e=Zr().default,r=T_();function n(s,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Gl)),Gl.exports}var Yl={exports:{}},jp;function Fx(){return jp||(jp=1,function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Yl)),Yl.exports}var Ql={exports:{}},Kl={exports:{}},Op;function M_(){return Op||(Op=1,function(t){function e(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!r},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Kl)),Kl.exports}var Bp;function I_(){return Bp||(Bp=1,function(t){var e=M_(),r=Dx();function n(s,i,o){if(e())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,i);var l=new(s.bind.apply(s,a));return o&&r(l,o.prototype),l}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Ql)),Ql.exports}var Xl={},Np;function j_(){if(Np)return Xl;Np=1;var t=Ad(),e=yd(),r=function(){function n(){t(this,n)}return e(n,[{key:Symbol.iterator,value:function(){return this}}]),n}();return Xl.IterableIterator=r,Xl}var $s={},zp;function Ux(){if(zp)return $s;zp=1;function t(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof n=="number"&&!isNaN(n)&&isFinite(n)&&!(s&&n===0)}$s.isInteger=t;function e(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return t(n)&&(s?n>0:n>=0)}$s.isPositiveInteger=e;function r(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return typeof n=="number"&&!isNaN(n)&&!(s&&n===0)}return $s.isIntegerOrInfinite=r,$s}var Jl={exports:{}},Zl={exports:{}},Lp;function O_(){return Lp||(Lp=1,function(t){var e=Fx();function r(n,s){for(;!{}.hasOwnProperty.call(n,s)&&(n=e(n))!==null;);return n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Zl)),Zl.exports}var Dp;function B_(){return Dp||(Dp=1,function(t){var e=O_();function r(){return t.exports=r=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,s,i){var o=e(n,s);if(o){var a=Object.getOwnPropertyDescriptor(o,s);return a.get?a.get.call(arguments.length<3?n:i):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(null,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Jl)),Jl.exports}var ec={exports:{}},tc={exports:{}},Fp;function N_(){return Fp||(Fp=1,function(t){function e(r){if(Array.isArray(r))return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(tc)),tc.exports}var rc={exports:{}},Up;function z_(){return Up||(Up=1,function(t){function e(r,n){var s=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s!=null){var i,o,a,l,c=[],u=!0,h=!1;try{if(a=(s=s.call(r)).next,n===0){if(Object(s)!==s)return;u=!1}else for(;!(u=(i=a.call(s)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(d){h=!0,o=d}finally{try{if(!u&&s.return!=null&&(l=s.return(),Object(l)!==l))return}finally{if(h)throw o}}return c}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(rc)),rc.exports}var nc={exports:{}},Hp;function L_(){return Hp||(Hp=1,function(t){function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(nc)),nc.exports}var $p;function D_(){return $p||($p=1,function(t){var e=N_(),r=z_(),n=zx(),s=L_();function i(o,a){return e(o)||r(o,a)||n(o,a)||s()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(ec)),ec.exports}var xo={},Gp;function F_(){if(Gp)return xo;Gp=1;var t=en(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=n(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(b){throw b},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,A=!1,g;return{s:function(){h=c[Symbol.iterator]()},n:function(){var b=h.next();return m=b.done,b},e:function(b){A=!0,g=b},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(A)throw g}}}}function n(c,u){if(c){if(typeof c=="string")return s(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(c,u)}}function s(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=$t(),o=i.iterableCurry;function a(c,u){var h,d,f,m;return t.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:h=0,d=r(c),g.prev=2,d.s();case 4:if((f=d.n()).done){g.next=10;break}return m=f.value,g.next=8,u(m,h++);case 8:g.next=4;break;case 10:g.next=15;break;case 12:g.prev=12,g.t0=g.catch(2),d.e(g.t0);case 15:return g.prev=15,d.f(),g.finish(15);case 18:case"end":return g.stop()}},e,null,[[2,12,15,18]])}xo.__map=a;var l=o(a);return xo.map=l,xo}var bo={},Wp;function U_(){if(Wp)return bo;Wp=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(g){throw g},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,m;return{s:function(){c=a[Symbol.iterator]()},n:function(){var g=c.next();return d=g.done,g},e:function(g){f=!0,m=g},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw m}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=$t(),s=n.ensureIterable;function i(a){var l=[],c=t(a),u;try{for(c.s();!(u=c.n()).done;){var h=u.value;l.push(h)}}catch(d){c.e(d)}finally{c.f()}return l}bo.__toArray=i;function o(a){return i(s(a))}return bo.toArray=o,bo}var sc={},Yp;function Hx(){if(Yp)return sc;Yp=1;var t=Zr();function e(r){return t(r)==="object"&&r!==null}return sc.isObject=e,sc}var ic={},Qp;function H_(){if(Qp)return ic;Qp=1;function t(s,i){var o;if(typeof Symbol>"u"||s[Symbol.iterator]==null){if(Array.isArray(s)||(o=e(s))||i){o&&(s=o);var a=0,l=function(){};return{s:l,n:function(){return a>=s.length?{done:!0}:{done:!1,value:s[a++]}},e:function(f){throw f},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,u=!1,h;return{s:function(){o=s[Symbol.iterator]()},n:function(){var f=o.next();return c=f.done,f},e:function(f){u=!0,h=f},f:function(){try{!c&&o.return!=null&&o.return()}finally{if(u)throw h}}}}function e(s,i){if(s){if(typeof s=="string")return r(s,i);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return r(s,i)}}function r(s,i){(i==null||i>s.length)&&(i=s.length);for(var o=0,a=new Array(i);o<i;o++)a[o]=s[o];return a}function n(s,i){var o=t(s),a;try{for(o.s();!(a=o.n()).done;){var l=a.value;i(l)}}catch(c){o.e(c)}finally{o.f()}}return ic.parallelEach=n,ic}var oc={},Kp;function $_(){if(Kp)return oc;Kp=1;var t=I_(),e=Ad(),r=yd(),n=$t(),s=n.ensureIterable,i=n.callReturn,o=Symbol.for("_"),a=function(){function c(u){e(this,c),this.peekr=u}return r(c,[{key:"next",value:function(){var h=this.peekr,d=h.current;return h.advance(),d}},{key:"return",value:function(){return this.peekr.return(),{value:void 0,done:!0}}},{key:Symbol.iterator,value:function(){return this}}]),c}(),l=function(){r(c,null,[{key:"from",value:function(h){for(var d=s(h)[Symbol.iterator](),f=d.next(),m=arguments.length,A=new Array(m>1?m-1:0),g=1;g<m;g++)A[g-1]=arguments[g];return t(this,[d,f].concat(A))}}]);function c(u,h){e(this,c),this[o]={iterator:u,current:h,index:0}}return r(c,[{key:"advance",value:function(){var h=this[o];return h.current.done||(h.index++,h.current=h.iterator.next()),this}},{key:"return",value:function(){var h=this[o];return this.done||i(h.iterator),h.current={value:void 0,done:!0},this}},{key:"asIterator",value:function(){return new a(this)}},{key:"current",get:function(){return this[o].current}},{key:"value",get:function(){return this[o].current.value}},{key:"done",get:function(){return this[o].current.done}},{key:"index",get:function(){return this[o].index}}]),c}();return oc.Peekerator=l,oc}var ac={},Xp;function G_(){if(Xp)return ac;Xp=1;var t=Ux(),e=t.isInteger,r=Hx(),n=r.isObject,s=el(),i=s.notUndefined,o=function(l){return function(u){if(n(u[1])){var h=u[1],d=h.start,f=h.step;u[1]=d,u[2]=f}if(i(u[2])&&(u[2]=Number(u[2]),!e(u[2],!0)))throw new Error("step argument to ".concat(l," must be a non-zero integer"))}};return ac.makeValidateArgs=o,ac}var Gs={},Jp;function W_(){if(Jp)return Gs;Jp=1;var t=gd(),e=Ad(),r=yd(),n=B_(),s=E_(),i=R_(),o=Fx();function a(L){var U=l();return function(){var k=o(L),P;if(U){var M=o(this).constructor;P=Reflect.construct(k,arguments,M)}else P=k.apply(this,arguments);return i(this,P)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var c=$t(),u=c.iterableCurry,h=c.callReturn,d=j_(),f=d.IterableIterator,m=H_(),A=m.parallelEach,g=$_(),y=g.Peekerator,b=F_(),x=b.__map,w=U_(),V=w.__toArray,_=Symbol.for("_"),v=Symbol.for("__advance"),S=function(L){s(q,L);var U=a(q);function q(k,P,M){var T;return e(this,q),T=U.call(this,k,P),T[_].inputSummary=M,T}return r(q,[{key:"advance",value:function(){this[_].inputSummary.advanceBuffer(this)}},{key:v,value:function(){n(o(q.prototype),"advance",this).call(this)}}]),q}(y),E=function(){function L(){e(this,L),this.buffers=[],this.notDoneBuffer=null,this.index=0}return r(L,[{key:"init",value:function(q){this.buffers=q,this.updateNotDone()}},{key:"updateNotDone",value:function(){this.notDoneBuffer=this.buffers.find(function(q){return!q.done})}},{key:"advanceBuffer",value:function(q){var k=q.done;q[v](),this.index++,!k&&q.done&&this.updateNotDone()}}]),L}(),R=function(){function L(U){e(this,L),this[_]=U}return r(L,[{key:"advance",value:function(){throw new Error("advance() is not supported on an interleave summary")}},{key:"current",get:function(){return{value:this.value,done:this.done}}},{key:"value",get:function(){return this[_].notDoneBuffer}},{key:"done",get:function(){return this[_].notDoneBuffer===void 0}},{key:"index",get:function(){return this[_].index}}]),L}();Gs.InputSummary=R;var I=function(L){s(q,L);var U=a(q);function q(k,P,M){var T;return e(this,q),T=U.call(this),T.sources=k,T.strategy=P,T.options=M,T.initialized=!1,T.inputSummary=new E(k),T}return r(q,[{key:"init",value:function(){this.initialized=!0;var P=this.strategy,M=this.options,T=this.inputSummary;this.buffers=V(x(this.sources,function(j){return S.from(j,T)})),this.iterator=P.apply(void 0,[M,new R(T)].concat(t(this.buffers))),T.init(this.buffers)}},{key:"returnBuffers",value:function(){A(this.buffers,function(P){return P.return()})}},{key:"next",value:function(){this.initialized||this.init();var P=this.iterator.next();return P.done&&this.returnBuffers(),P}},{key:"return",value:function(){return h(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}]),q}(f);function B(L,U){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new I(L,U,q)}Gs.__interleave=B;var z=u(B,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return Gs.interleave=z,Gs}var wo={},qo={},Zp;function Y_(){if(Zp)return qo;Zp=1;var t=$t(),e=t.iterableCurry,r=t.callReturn;function n(i,o){var a=i[Symbol.iterator](),l=a.next(),c=l.value,u=l.done;return u?o:(r(a),c)}qo.__firstOr=n;var s=e(n,{reduces:!0});return qo.firstOr=s,qo}var em;function Q_(){if(em)return wo;em=1;var t=$t(),e=t.iterableCurry,r=Y_(),n=r.__firstOr;function s(o){return n(o,void 0)}wo.__first=s;var i=e(s,{reduces:!0});return wo.first=i,wo}var vo={},tm;function K_(){if(tm)return vo;tm=1;var t=Zr(),e=en(),r=e.mark(o),n=$t(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,[c,l[c]];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}vo.__objectEntries=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return vo.objectEntries=a,vo}var Vo={},rm;function X_(){if(rm)return Vo;rm=1;var t=Zr(),e=en(),r=e.mark(o),n=$t(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,c;case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}Vo.__objectKeys=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return Vo.objectKeys=a,Vo}var _o={},nm;function J_(){if(nm)return _o;nm=1;var t=Zr(),e=en(),r=e.mark(o),n=$t(),s=n.wrapWithIterableIterator,i=Object.prototype.hasOwnProperty;function o(l){var c;return e.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l!=null){h.next=2;break}return h.abrupt("return");case 2:h.t0=e.keys(l);case 3:if((h.t1=h.t0()).done){h.next=10;break}if(c=h.t1.value,!i.call(l,c)){h.next=8;break}return h.next=8,l[c];case 8:h.next=3;break;case 10:case"end":return h.stop()}},r)}_o.__objectValues=o;var a=s(o,{validateArgs:function(c){if(!(c[0]==null||t(c[0])==="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return _o.objectValues=a,_o}var So={},sm;function Z_(){if(sm)return So;sm=1;var t=D_(),e=en(),r=e.mark(d),n=$t(),s=n.wrapWithIterableIterator,i=Ux(),o=i.isInteger,a=i.isIntegerOrInfinite,l=Hx(),c=l.isObject,u=el(),h=u.notUndefined;function d(){var m,A,g,y,b=arguments;return e.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:m=b.length>0&&b[0]!==void 0?b[0]:0,A=b.length>1&&b[1]!==void 0?b[1]:1/0,g=b.length>2&&b[2]!==void 0?b[2]:1,y=m;case 4:if(!(g>0?y<A:y>A)){w.next=10;break}return w.next=7,y;case 7:y+=g,w.next=4;break;case 10:case"end":return w.stop()}},r)}So.__range=d;var f=s(d,{growRight:!0,validateArgs:function(A){var g=t(A,3),y=g[0],b=g[1],x=b===void 0?1/0:b,w=g[2],V;if(c(y)?(V=y.start,x=y.end,w=y.step):A.length>1?V=y:x=y,h(V)&&!o(V))throw new TypeError("The specified start was not an integer");if(h(x)&&!a(x))throw new TypeError("The specified end was not an integer or infinite");if(h(w)&&!o(w,!0))throw new TypeError("The specified step was not a non-zero integer");A[0]=V,A[1]=x,A[2]=w}});return So.range=f,So}var ko={},im;function eS(){if(im)return ko;im=1;var t=en(),e=t.mark(l),r=$t(),n=r.iterableCurry,s=W_(),i=s.__interleave,o=G_(),a=o.makeValidateArgs;function l(h,d){var f,m,A,g,y,b,x,w=arguments;return t.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:for(f=h.start,m=h.step,A=w.length,g=new Array(A>2?A-2:0),y=2;y<A;y++)g[y-2]=w[y];f=f%g.length,b=f;case 4:if(d.done){_.next=13;break}if(x=g[b],x.done){_.next=10;break}return _.next=9,x.value;case 9:x.advance();case 10:b=(b+m)%g.length,_.next=4;break;case 13:case"end":return _.stop()}},e)}function c(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i(h,l,{start:f,step:d})}ko.__roundRobin=c;var u=n(c,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:a("roundRobin")});return ko.roundRobin=u,ko}var Co={},om;function tS(){if(om)return Co;om=1;function t(a,l){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=e(a))||l){c&&(a=c);var u=0,h=function(){};return{s:h,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(g){throw g},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,f=!1,m;return{s:function(){c=a[Symbol.iterator]()},n:function(){var g=c.next();return d=g.done,g},e:function(g){f=!0,m=g},f:function(){try{!d&&c.return!=null&&c.return()}finally{if(f)throw m}}}}function e(a,l){if(a){if(typeof a=="string")return r(a,l);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,l)}}function r(a,l){(l==null||l>a.length)&&(l=a.length);for(var c=0,u=new Array(l);c<l;c++)u[c]=a[c];return u}var n=$t(),s=n.ensureIterable;function i(a){var l=s(a),c=0,u=t(l),h;try{for(u.s();!(h=u.n()).done;){var d=h.value;c++}}catch(f){u.e(f)}finally{u.f()}return c}Co.__size=i;var o=i;return Co.size=o,Co}var Po={},am;function rS(){if(am)return Po;am=1;var t=en(),e=t.mark(a);function r(c,u){var h;if(typeof Symbol>"u"||c[Symbol.iterator]==null){if(Array.isArray(c)||(h=n(c))||u){h&&(c=h);var d=0,f=function(){};return{s:f,n:function(){return d>=c.length?{done:!0}:{done:!1,value:c[d++]}},e:function(b){throw b},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,A=!1,g;return{s:function(){h=c[Symbol.iterator]()},n:function(){var b=h.next();return m=b.done,b},e:function(b){A=!0,g=b},f:function(){try{!m&&h.return!=null&&h.return()}finally{if(A)throw g}}}}function n(c,u){if(c){if(typeof c=="string")return s(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(c,u)}}function s(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}var i=$t(),o=i.iterableCurry;function a(c,u){var h,d,f,m;return t.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u!==0){g.next=2;break}return g.abrupt("return");case 2:h=0,d=r(c),g.prev=4,d.s();case 6:if((f=d.n()).done){g.next=14;break}return m=f.value,g.next=10,m;case 10:if(++h!==u){g.next=12;break}return g.abrupt("break",14);case 12:g.next=6;break;case 14:g.next=19;break;case 16:g.prev=16,g.t0=g.catch(4),d.e(g.t0);case 19:return g.prev=19,d.f(),g.finish(19);case 22:case"end":return g.stop()}},e,null,[[4,16,19,22]])}Po.__take=a;var l=o(a);return Po.take=l,Po}var lc,lm;function nS(){return lm||(lm=1,lc=Q_().first),lc}var sS=nS();const iS=st(sS);var cc,cm;function oS(){return cm||(cm=1,cc=K_().objectEntries),cc}var aS=oS();const xd=st(aS);var uc,um;function lS(){return um||(um=1,uc=X_().objectKeys),uc}var cS=lS();const $x=st(cS);var hc,hm;function uS(){return hm||(hm=1,hc=J_().objectValues),hc}var hS=uS();const In=st(hS);var dc,dm;function dS(){return dm||(dm=1,dc=Z_().range),dc}var fS=dS();const Gx=st(fS);var fc,fm;function pS(){return fm||(fm=1,fc=eS().roundRobin),fc}var mS=pS();const gS=st(mS);var pc,pm;function AS(){return pm||(pm=1,pc=tS().size),pc}var yS=AS();const Fu=st(yS);var mc,mm;function xS(){return mm||(mm=1,mc=rS().take),mc}var bS=xS();const wS=st(bS),Oe=t=>t[Symbol.iterator](),so=Object.entries,Wx=xd,Yx=Object.keys,bd=$x,qS=Object.fromEntries,Rs=Object.fromEntries,vS=(t,e)=>{const n=Oe(Wx(t)).map(e);return qS(n)},ts={presses:Rs(Ox.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[],xLook:[],yLook:[]}},gm=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function jn(...t){return{presses:t.reduce((e,r)=>{for(const n of Ox)e[n]={keys:gm(e[n]?.keys,r?.presses?.[n]?.keys),gamepadButtons:gm(e[n]?.gamepadButtons,r?.presses?.[n]?.gamepadButtons)};return e},structuredClone(ts.presses)),axes:{x:Array.from(new Set([...ts.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...ts.axes.y,...t.map(e=>e.axes?.y??[]).flat()])),xLook:Array.from(new Set([...ts.axes.xLook,...t.map(e=>e.axes?.xLook??[]).flat()])),yLook:Array.from(new Set([...ts.axes.yLook,...t.map(e=>e.axes?.yLook??[]).flat()]))}}}const $e={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},Am=vS($e,([t,e])=>[e,t]),VS={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},_S={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},Wt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},On={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape","§"]},menu_exit:{gamepadButtons:[$e.b]},menu_select:{keys:["Enter"],gamepadButtons:[$e.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},Ms={inputAssignment:jn(On,{presses:{right:{gamepadButtons:[$e.dPadRight]},towards:{gamepadButtons:[$e.dPadDown]},left:{gamepadButtons:[$e.dPadLeft]},away:{gamepadButtons:[$e.dPadUp]},jump:{gamepadButtons:[$e.a,$e.y]},carry:{gamepadButtons:[$e.x,$e.y]},fire:{gamepadButtons:[$e.b]},swop:{gamepadButtons:[$e.rb]},"swop.head":{gamepadButtons:[$e.l3]},"swop.heels":{gamepadButtons:[$e.r3]},hold:{gamepadButtons:[$e.start]},menu_openOrExit:{gamepadButtons:[$e.select]},map:{gamepadButtons:[$e.lb]},toggleColourisation:{gamepadButtons:[$e.lt]}},axes:{x:[0],y:[1],xLook:[2],yLook:[3]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},SS={inputAssignment:jn(On,Ms.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},kS={inputAssignment:jn(On,Ms.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},CS={inputAssignment:jn(On,Ms.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M","Tab"]},lookUp:{keys:["I"]},lookDown:{keys:["K"]},lookLeft:{keys:["J"]},lookRight:{keys:["L"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},PS={inputAssignment:jn(On,Ms.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},ES={inputAssignment:jn(On,Ms.inputAssignment,{presses:{right:{keys:[Wt.dPadRight]},towards:{keys:[Wt.dPadDown]},left:{keys:[Wt.dPadLeft]},away:{keys:[Wt.dPadUp]},jump:{keys:[Wt.a,Wt.y]},carry:{keys:[Wt.b,Wt.y]},fire:{keys:[Wt.x]},swop:{keys:[Wt.rb]},hold:{keys:[Wt.start]},menu_openOrExit:{keys:[Wt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that don’t support controllers"},ym=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]}}}),TS={inputAssignment:jn(ts,On,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},ym(VS),ym(_S)),description:"MAME key mappings. For arcade-style control panels"},xs={default:CS,"zx spectrum":SS,amiga:kS,mame:TS,wasd:PS,"🕹 8bitdo keyboard mode":ES,"🕹 joystick":Ms},wd=()=>Ur().get("campaignName")?.startsWith("data:"),bF=["yellow","cyan","green","magenta","white"],io=25,wF=1e3/io,Is={amigaHiResPal:{x:640,y:512},classicMac:{x:512,y:384},amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},RS=Object.keys(Is),qF={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},Ye=()=>Pt()==="mobile"||Pt()==="tablet",Pt=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},MS=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Qx=[],Kx=new Set,vF=new Map;Kx.add=()=>{throw new Error("emptySet.add")};Kx.clear=()=>{throw new Error("emptySet.clear")};const ye=Object.freeze({}),Sa=(t,e)=>e.split(".").reduce((r,n)=>r[n],t),IS=(t,e,r)=>{const n=e.split(".");let s=t;for(let i=0;i<n.length-1;i++){const o=n[i];s=s[o]}s[n[n.length-1]]=r},xm=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]},Ri=(t,...e)=>{const r={};for(const n of e)r[n]=t[n];return r},VF=(t,...e)=>{const r={...t};for(const n of e)delete r[n];return r};var gc,bm;function jS(){if(bm)return gc;bm=1;function t(n){if(Array.isArray(n))return!0;var s=n.length;return typeof s=="number"&&s>-1?s?0 in n&&s-1 in n:!0:!1}function e(n){var s=typeof n;return s==="object"?n===null?"null":t(n)?"array":n.constructor===Object?"pure-object":"object":s}function r(n,s){if(n===s||n!==n&&s!==s)return!0;var i=e(n),o=e(s);if(i!==o)return!1;if(i==="pure-object"){if(n===s)return!0;var a=Object.keys(n),l=Object.keys(s).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!s.hasOwnProperty(a[c]))return!1;var d=n[h],f=s[h];if(d===n||f===s||d===s||f===n)return d===f;if(!r(d,f))return!1}return!0}else if(i==="array"){if(n.length===s.length)for(var m=0;m<n.length;m++){var A=n[m],g=s[m];if(A===n||g===s||A===s||g===n)return A===g;if(!r(A,g))return!1}else return!1;return!0}else if(i==="object"){if(n.valueOf!==Object.prototype.valueOf()&&s.valueOf!==Object.prototype.valueOf())return n.valueOf()===s.valueOf();if(n.toString!==Object.prototype.toString()&&s.toString!==Object.prototype.toString())return n.toString()===s.toString()}return!1}return gc=r,gc}var OS=jS();const BS=st(OS),qd=Yy.withTypes(),ue=Qy.withTypes();$h.withTypes();const Xx=t=>()=>ue(t),vd={inputAssignment:xs.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:Pt()==="mobile"?"handheld":"zxSpectrum"},showFps:!1,onScreenControls:Pt()==="mobile"||Pt()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1,soundSettings:{mute:!1,noFootsteps:!1}};var Jx=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(Jx||{});function wm(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var qm=gs;function Zx(t,e){if(t===e||!(qm(t)&&qm(e)||Array.isArray(t)&&Array.isArray(e)))return e;const r=Object.keys(e),n=Object.keys(t);let s=r.length===n.length;const i=Array.isArray(e)?[]:{};for(const o of r)i[o]=Zx(t[o],e[o]),s&&(s=t[o]===i[o]);return s?t:i}function us(t){let e=0;for(const r in t)e++;return e}var vm=t=>[].concat(...t);function NS(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function ka(t){return t!=null}function zS(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}function LS(t,e,r){return t.has(e)?t.get(e):t.set(e,r).get(e)}var Vm=class{constructor(t,e=void 0){this.value=t,this.meta=e}},Vd=vt("__rtkq/focused"),eb=vt("__rtkq/unfocused"),_d=vt("__rtkq/online"),tb=vt("__rtkq/offline");function Sd(t){return t.type==="query"}function DS(t){return t.type==="mutation"}function kd(t){return t.type==="infinitequery"}function Cd(t,e,r,n,s,i){return FS(t)?t(e,r,n,s).filter(ka).map(Uu).map(i):Array.isArray(t)?t.map(Uu).map(i):[]}function FS(t){return typeof t=="function"}function Uu(t){return typeof t=="string"?{type:t}:t}function US(t,e){return t.catch(e)}var Mi=Symbol("forceQueryFn"),Hu=t=>typeof t[Mi]=="function";function HS({serializeQueryArgs:t,queryThunk:e,infiniteQueryThunk:r,mutationThunk:n,api:s,context:i}){const o=new Map,a=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:u}=s.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:y,buildInitiateMutation:b,getRunningQueryThunk:h,getRunningMutationThunk:d,getRunningQueriesThunk:f,getRunningMutationsThunk:m};function h(x,w){return V=>{const _=i.endpointDefinitions[x],v=t({queryArgs:w,endpointDefinition:_,endpointName:x});return o.get(V)?.[v]}}function d(x,w){return V=>a.get(V)?.[w]}function f(){return x=>Object.values(o.get(x)||{}).filter(ka)}function m(){return x=>Object.values(a.get(x)||{}).filter(ka)}function A(x,w){const V=(_,{subscribe:v=!0,forceRefetch:S,subscriptionOptions:E,[Mi]:R,...I}={})=>(B,z)=>{const L=t({queryArgs:_,endpointDefinition:w,endpointName:x});let U;const q={...I,type:"query",subscribe:v,forceRefetch:S,subscriptionOptions:E,endpointName:x,originalArgs:_,queryCacheKey:L,[Mi]:R};if(Sd(w))U=e(q);else{const{direction:G,initialPageParam:Q}=I;U=r({...q,direction:G,initialPageParam:Q})}const k=s.endpoints[x].select(_),P=B(U),M=k(z()),{requestId:T,abort:j}=P,O=M.requestId!==T,N=o.get(B)?.[L],D=()=>k(z()),F=Object.assign(R?P.then(D):O&&!N?Promise.resolve(M):Promise.all([N,P]).then(D),{arg:_,requestId:T,subscriptionOptions:E,queryCacheKey:L,abort:j,async unwrap(){const G=await F;if(G.isError)throw G.error;return G.data},refetch:()=>B(V(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){v&&B(l({queryCacheKey:L,requestId:T}))},updateSubscriptionOptions(G){F.subscriptionOptions=G,B(u({endpointName:x,requestId:T,queryCacheKey:L,options:G}))}});if(!N&&!O&&!R){const G=LS(o,B,{});G[L]=F,F.then(()=>{delete G[L],us(G)||o.delete(B)})}return F};return V}function g(x,w){return A(x,w)}function y(x,w){return A(x,w)}function b(x){return(w,{track:V=!0,fixedCacheKey:_}={})=>(v,S)=>{const E=n({type:"mutation",endpointName:x,originalArgs:w,track:V,fixedCacheKey:_}),R=v(E),{requestId:I,abort:B,unwrap:z}=R,L=US(R.unwrap().then(P=>({data:P})),P=>({error:P})),U=()=>{v(c({requestId:I,fixedCacheKey:_}))},q=Object.assign(L,{arg:R.arg,requestId:I,abort:B,unwrap:z,reset:U}),k=a.get(v)||{};return a.set(v,k),k[I]=q,q.then(()=>{delete k[I],us(k)||a.delete(v)}),_&&(k[_]=q,q.then(()=>{k[_]===q&&(delete k[_],us(k)||a.delete(v))})),q}}}function $S(t){return t}var Eo=(t={})=>({...t,[Ya]:!0});function GS({reducerPath:t,baseQuery:e,context:{endpointDefinitions:r},serializeQueryArgs:n,api:s,assertTagType:i,selectors:o}){const a=(S,E,R,I)=>(B,z)=>{const L=r[S],U=n({queryArgs:E,endpointDefinition:L,endpointName:S});if(B(s.internalActions.queryResultPatched({queryCacheKey:U,patches:R})),!I)return;const q=s.endpoints[S].select(E)(z()),k=Cd(L.providesTags,q.data,void 0,E,{},i);B(s.internalActions.updateProvidedBy({queryCacheKey:U,providedTags:k}))};function l(S,E,R=0){const I=[E,...S];return R&&I.length>R?I.slice(0,-1):I}function c(S,E,R=0){const I=[...S,E];return R&&I.length>R?I.slice(1):I}const u=(S,E,R,I=!0)=>(B,z)=>{const U=s.endpoints[S].select(E)(z()),q={patches:[],inversePatches:[],undo:()=>B(s.util.patchQueryData(S,E,q.inversePatches,I))};if(U.status==="uninitialized")return q;let k;if("data"in U)if(nr(U.data)){const[P,M,T]=ux(U.data,R);q.patches.push(...M),q.inversePatches.push(...T),k=P}else k=R(U.data),q.patches.push({op:"replace",path:[],value:k}),q.inversePatches.push({op:"replace",path:[],value:U.data});return q.patches.length===0||B(s.util.patchQueryData(S,E,q.patches,I)),q},h=(S,E,R)=>I=>I(s.endpoints[S].initiate(E,{subscribe:!1,forceRefetch:!0,[Mi]:()=>({data:R})})),d=(S,E)=>S.query&&S[E]?S[E]:$S,f=async(S,{signal:E,abort:R,rejectWithValue:I,fulfillWithValue:B,dispatch:z,getState:L,extra:U})=>{const q=r[S.endpointName];try{let k=d(q,"transformResponse");const P={signal:E,abort:R,dispatch:z,getState:L,extra:U,endpoint:S.endpointName,type:S.type,forced:S.type==="query"?m(S,L()):void 0,queryCacheKey:S.type==="query"?S.queryCacheKey:void 0},M=S.type==="query"?S[Mi]:void 0;let T;const j=async(N,D,F,G)=>{if(D==null&&N.pages.length)return Promise.resolve({data:N});const Q={queryArg:S.originalArgs,pageParam:D},re=await O(Q),ie=G?l:c;return{data:{pages:ie(N.pages,re.data,F),pageParams:ie(N.pageParams,D,F)}}};async function O(N){let D;const{extraOptions:F}=q;if(M?D=M():q.query?D=await e(q.query(N),P,F):D=await q.queryFn(N,P,F,Q=>e(Q,P,F)),typeof process<"u",D.error)throw new Vm(D.error,D.meta);const G=await k(D.data,D.meta,N);return{...D,data:G}}if(S.type==="query"&&"infiniteQueryOptions"in q){const{infiniteQueryOptions:N}=q,{maxPages:D=1/0}=N;let F;const G={pages:[],pageParams:[]},Q=o.selectQueryEntry(L(),S.queryCacheKey)?.data,ie=m(S,L())&&!S.direction||!Q?G:Q;if("direction"in S&&S.direction&&ie.pages.length){const ne=S.direction==="backward",Ue=(ne?rb:$u)(N,ie);F=await j(ie,Ue,D,ne)}else{const{initialPageParam:ne=N.initialPageParam}=S,At=Q?.pageParams??[],Ue=At[0]??ne,it=At.length;F=await j(ie,Ue,D),M&&(F={data:F.data.pages[0]});for(let It=1;It<it;It++){const oe=$u(N,F.data);F=await j(F.data,oe,D)}}T=F}else T=await O(S.originalArgs);return B(T.data,Eo({fulfilledTimeStamp:Date.now(),baseQueryMeta:T.meta}))}catch(k){let P=k;if(P instanceof Vm){let M=d(q,"transformErrorResponse");try{return I(await M(P.value,P.meta,S.originalArgs),Eo({baseQueryMeta:P.meta}))}catch(T){P=T}}throw console.error(P),P}};function m(S,E){const R=o.selectQueryEntry(E,S.queryCacheKey),I=o.selectConfig(E).refetchOnMountOrArgChange,B=R?.fulfilledTimeStamp,z=S.forceRefetch??(S.subscribe&&I);return z?z===!0||(Number(new Date)-Number(B))/1e3>=z:!1}const A=()=>tp(`${t}/executeQuery`,f,{getPendingMeta({arg:E}){const R=r[E.endpointName];return Eo({startedTimeStamp:Date.now(),...kd(R)?{direction:E.direction}:{}})},condition(E,{getState:R}){const I=R(),B=o.selectQueryEntry(I,E.queryCacheKey),z=B?.fulfilledTimeStamp,L=E.originalArgs,U=B?.originalArgs,q=r[E.endpointName],k=E.direction;return Hu(E)?!0:B?.status==="pending"?!1:m(E,I)||Sd(q)&&q?.forceRefetch?.({currentArg:L,previousArg:U,endpointState:B,state:I})?!0:!(z&&!k)},dispatchConditionRejection:!0}),g=A(),y=A(),b=tp(`${t}/executeMutation`,f,{getPendingMeta(){return Eo({startedTimeStamp:Date.now()})}}),x=S=>"force"in S,w=S=>"ifOlderThan"in S,V=(S,E,R)=>(I,B)=>{const z=x(R)&&R.force,L=w(R)&&R.ifOlderThan,U=(k=!0)=>{const P={forceRefetch:k,isPrefetch:!0};return s.endpoints[S].initiate(E,P)},q=s.endpoints[S].select(E)(B());if(z)I(U());else if(L){const k=q?.fulfilledTimeStamp;if(!k){I(U());return}(Number(new Date)-Number(new Date(k)))/1e3>=L&&I(U())}else I(U(!1))};function _(S){return E=>E?.meta?.arg?.endpointName===S}function v(S,E){return{matchPending:yi(rd(S),_(E)),matchFulfilled:yi(Wr(S),_(E)),matchRejected:yi(As(S),_(E))}}return{queryThunk:g,mutationThunk:b,infiniteQueryThunk:y,prefetch:V,updateQueryData:u,upsertQueryData:h,patchQueryData:a,buildMatchThunkActions:v}}function $u(t,{pages:e,pageParams:r}){const n=e.length-1;return t.getNextPageParam(e[n],e,r[n],r)}function rb(t,{pages:e,pageParams:r}){return t.getPreviousPageParam?.(e[0],e,r[0],r)}function nb(t,e,r,n){return Cd(r[t.meta.arg.endpointName][e],Wr(t)?t.payload:void 0,Ka(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,n)}function To(t,e,r){const n=t[e];n&&r(n)}function Ii(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function _m(t,e,r){const n=t[Ii(e)];n&&r(n)}var Ws={};function WS({reducerPath:t,queryThunk:e,mutationThunk:r,serializeQueryArgs:n,context:{endpointDefinitions:s,apiUid:i,extractRehydrationInfo:o,hasRehydrationInfo:a},assertTagType:l,config:c}){const u=vt(`${t}/resetApiState`);function h(v,S,E,R){v[S.queryCacheKey]??={status:"uninitialized",endpointName:S.endpointName},To(v,S.queryCacheKey,I=>{I.status="pending",I.requestId=E&&I.requestId?I.requestId:R.requestId,S.originalArgs!==void 0&&(I.originalArgs=S.originalArgs),I.startedTimeStamp=R.startedTimeStamp;const B=s[R.arg.endpointName];kd(B)&&"direction"in S&&(I.direction=S.direction)})}function d(v,S,E,R){To(v,S.arg.queryCacheKey,I=>{if(I.requestId!==S.requestId&&!R)return;const{merge:B}=s[S.arg.endpointName];if(I.status="fulfilled",B)if(I.data!==void 0){const{fulfilledTimeStamp:z,arg:L,baseQueryMeta:U,requestId:q}=S;let k=Es(I.data,P=>B(P,E,{arg:L.originalArgs,baseQueryMeta:U,fulfilledTimeStamp:z,requestId:q}));I.data=k}else I.data=E;else I.data=s[S.arg.endpointName].structuralSharing??!0?Zx(fr(I.data)?EV(I.data):I.data,E):E;delete I.error,I.fulfilledTimeStamp=S.fulfilledTimeStamp})}const f=_r({name:`${t}/queries`,initialState:Ws,reducers:{removeQueryResult:{reducer(v,{payload:{queryCacheKey:S}}){delete v[S]},prepare:Us()},cacheEntriesUpserted:{reducer(v,S){for(const E of S.payload){const{queryDescription:R,value:I}=E;h(v,R,!0,{arg:R,requestId:S.meta.requestId,startedTimeStamp:S.meta.timestamp}),d(v,{arg:R,requestId:S.meta.requestId,fulfilledTimeStamp:S.meta.timestamp,baseQueryMeta:{}},I,!0)}},prepare:v=>({payload:v.map(R=>{const{endpointName:I,arg:B,value:z}=R,L=s[I];return{queryDescription:{type:"query",endpointName:I,originalArgs:R.arg,queryCacheKey:n({queryArgs:B,endpointDefinition:L,endpointName:I})},value:z}}),meta:{[Ya]:!0,requestId:to(),timestamp:Date.now()}})},queryResultPatched:{reducer(v,{payload:{queryCacheKey:S,patches:E}}){To(v,S,R=>{R.data=Yf(R.data,E.concat())})},prepare:Us()}},extraReducers(v){v.addCase(e.pending,(S,{meta:E,meta:{arg:R}})=>{const I=Hu(R);h(S,R,I,E)}).addCase(e.fulfilled,(S,{meta:E,payload:R})=>{const I=Hu(E.arg);d(S,E,R,I)}).addCase(e.rejected,(S,{meta:{condition:E,arg:R,requestId:I},error:B,payload:z})=>{To(S,R.queryCacheKey,L=>{if(!E){if(L.requestId!==I)return;L.status="rejected",L.error=z??B}})}).addMatcher(a,(S,E)=>{const{queries:R}=o(E);for(const[I,B]of Object.entries(R))(B?.status==="fulfilled"||B?.status==="rejected")&&(S[I]=B)})}}),m=_r({name:`${t}/mutations`,initialState:Ws,reducers:{removeMutationResult:{reducer(v,{payload:S}){const E=Ii(S);E in v&&delete v[E]},prepare:Us()}},extraReducers(v){v.addCase(r.pending,(S,{meta:E,meta:{requestId:R,arg:I,startedTimeStamp:B}})=>{I.track&&(S[Ii(E)]={requestId:R,status:"pending",endpointName:I.endpointName,startedTimeStamp:B})}).addCase(r.fulfilled,(S,{payload:E,meta:R})=>{R.arg.track&&_m(S,R,I=>{I.requestId===R.requestId&&(I.status="fulfilled",I.data=E,I.fulfilledTimeStamp=R.fulfilledTimeStamp)})}).addCase(r.rejected,(S,{payload:E,error:R,meta:I})=>{I.arg.track&&_m(S,I,B=>{B.requestId===I.requestId&&(B.status="rejected",B.error=E??R)})}).addMatcher(a,(S,E)=>{const{mutations:R}=o(E);for(const[I,B]of Object.entries(R))(B?.status==="fulfilled"||B?.status==="rejected")&&I!==B?.requestId&&(S[I]=B)})}}),A=_r({name:`${t}/invalidation`,initialState:Ws,reducers:{updateProvidedBy:{reducer(v,S){const{queryCacheKey:E,providedTags:R}=S.payload;for(const I of Object.values(v))for(const B of Object.values(I)){const z=B.indexOf(E);z!==-1&&B.splice(z,1)}for(const{type:I,id:B}of R){const z=(v[I]??={})[B||"__internal_without_id"]??=[];z.includes(E)||z.push(E)}},prepare:Us()}},extraReducers(v){v.addCase(f.actions.removeQueryResult,(S,{payload:{queryCacheKey:E}})=>{for(const R of Object.values(S))for(const I of Object.values(R)){const B=I.indexOf(E);B!==-1&&I.splice(B,1)}}).addMatcher(a,(S,E)=>{const{provided:R}=o(E);for(const[I,B]of Object.entries(R))for(const[z,L]of Object.entries(B)){const U=(S[I]??={})[z||"__internal_without_id"]??=[];for(const q of L)U.includes(q)||U.push(q)}}).addMatcher(pr(Wr(e),Ka(e)),(S,E)=>{g(S,E)}).addMatcher(f.actions.cacheEntriesUpserted.match,(S,E)=>{for(const{queryDescription:R,value:I}of E.payload)g(S,{type:"UNKNOWN",payload:I,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:R}})})}});function g(v,S){const E=nb(S,"providesTags",s,l),{queryCacheKey:R}=S.meta.arg;A.caseReducers.updateProvidedBy(v,A.actions.updateProvidedBy({queryCacheKey:R,providedTags:E}))}const y=_r({name:`${t}/subscriptions`,initialState:Ws,reducers:{updateSubscriptionOptions(v,S){},unsubscribeQueryResult(v,S){},internal_getRTKQSubscriptions(){}}}),b=_r({name:`${t}/internalSubscriptions`,initialState:Ws,reducers:{subscriptionsUpdated:{reducer(v,S){return Yf(v,S.payload)},prepare:Us()}}}),x=_r({name:`${t}/config`,initialState:{online:zS(),focused:NS(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(v,{payload:S}){v.middlewareRegistered=v.middlewareRegistered==="conflict"||i!==S?"conflict":!0}},extraReducers:v=>{v.addCase(_d,S=>{S.online=!0}).addCase(tb,S=>{S.online=!1}).addCase(Vd,S=>{S.focused=!0}).addCase(eb,S=>{S.focused=!1}).addMatcher(a,S=>({...S}))}}),w=Kh({queries:f.reducer,mutations:m.reducer,provided:A.reducer,subscriptions:b.reducer,config:x.reducer}),V=(v,S)=>w(u.match(S)?void 0:v,S),_={...x.actions,...f.actions,...y.actions,...b.actions,...m.actions,...A.actions,resetApiState:u};return{reducer:V,actions:_}}var Sr=Symbol.for("RTKQ/skipToken"),sb={status:"uninitialized"},Sm=Es(sb,()=>{}),km=Es(sb,()=>{});function YS({serializeQueryArgs:t,reducerPath:e,createSelector:r}){const n=x=>Sm,s=x=>km;return{buildQuerySelector:d,buildInfiniteQuerySelector:f,buildMutationSelector:m,selectInvalidatedBy:A,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function i(x){return{...x,...wm(x.status)}}function o(x){return x[e]}function a(x){return o(x)?.queries}function l(x,w){return a(x)?.[w]}function c(x){return o(x)?.mutations}function u(x){return o(x)?.config}function h(x,w,V){return _=>{if(_===Sr)return r(n,V);const v=t({queryArgs:_,endpointDefinition:w,endpointName:x});return r(E=>l(E,v)??Sm,V)}}function d(x,w){return h(x,w,i)}function f(x,w){const{infiniteQueryOptions:V}=w;function _(v){const S={...v,...wm(v.status)},{isLoading:E,isError:R,direction:I}=S,B=I==="forward",z=I==="backward";return{...S,hasNextPage:y(V,S.data),hasPreviousPage:b(V,S.data),isFetchingNextPage:E&&B,isFetchingPreviousPage:E&&z,isFetchNextPageError:R&&B,isFetchPreviousPageError:R&&z}}return h(x,w,_)}function m(){return x=>{let w;return typeof x=="object"?w=Ii(x)??Sr:w=x,r(w===Sr?s:v=>o(v)?.mutations?.[w]??km,i)}}function A(x,w){const V=x[e],_=new Set;for(const v of w.filter(ka).map(Uu)){const S=V.provided[v.type];if(!S)continue;let E=(v.id!==void 0?S[v.id]:vm(Object.values(S)))??[];for(const R of E)_.add(R)}return vm(Array.from(_.values()).map(v=>{const S=V.queries[v];return S?[{queryCacheKey:v,endpointName:S.endpointName,originalArgs:S.originalArgs}]:[]}))}function g(x,w){return Object.values(a(x)).filter(V=>V?.endpointName===w&&V.status!=="uninitialized").map(V=>V.originalArgs)}function y(x,w){return w?$u(x,w)!=null:!1}function b(x,w){return!w||!x.getPreviousPageParam?!1:rb(x,w)!=null}}var Cm=WeakMap?new WeakMap:void 0,Gu=({endpointName:t,queryArgs:e})=>{let r="";const n=Cm?.get(e);if(typeof n=="string")r=n;else{const s=JSON.stringify(e,(i,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=gs(o)?Object.keys(o).sort().reduce((a,l)=>(a[l]=o[l],a),{}):o,o));gs(e)&&Cm?.set(e,s),r=s}return`${t}(${r})`};function ib(...t){return function(r){const n=qa(c=>r.extractRehydrationInfo?.(c,{reducerPath:r.reducerPath??"api"})),s={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:n,serializeQueryArgs(c){let u=Gu;if("serializeQueryArgs"in c.endpointDefinition){const h=c.endpointDefinition.serializeQueryArgs;u=d=>{const f=h(d);return typeof f=="string"?f:Gu({...d,queryArgs:f})}}else r.serializeQueryArgs&&(u=r.serializeQueryArgs);return u(c)},tagTypes:[...r.tagTypes||[]]},i={endpointDefinitions:{},batch(c){c()},apiUid:to(),extractRehydrationInfo:n,hasRehydrationInfo:qa(c=>n(c)!=null)},o={injectEndpoints:l,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const h of c)s.tagTypes.includes(h)||s.tagTypes.push(h);if(u)for(const[h,d]of Object.entries(u))typeof d=="function"?d(i.endpointDefinitions[h]):Object.assign(i.endpointDefinitions[h]||{},d);return o}},a=t.map(c=>c.init(o,s,i));function l(c){const u=c.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"}),infiniteQuery:h=>({...h,type:"infinitequery"})});for(const[h,d]of Object.entries(u)){if(c.overrideExisting!==!0&&h in i.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(nt(39));continue}i.endpointDefinitions[h]=d;for(const f of a)f.injectEndpoint(h,d)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function QS(){return function(){throw new Error(nt(33))}}function wr(t,...e){return Object.assign(t,...e)}var KS=({api:t,queryThunk:e,internalState:r})=>{const n=`${t.reducerPath}/subscriptions`;let s=null,i=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=t.internalActions,l=(f,m)=>{if(o.match(m)){const{queryCacheKey:g,requestId:y,options:b}=m.payload;return f?.[g]?.[y]&&(f[g][y]=b),!0}if(a.match(m)){const{queryCacheKey:g,requestId:y}=m.payload;return f[g]&&delete f[g][y],!0}if(t.internalActions.removeQueryResult.match(m))return delete f[m.payload.queryCacheKey],!0;if(e.pending.match(m)){const{meta:{arg:g,requestId:y}}=m,b=f[g.queryCacheKey]??={};return b[`${y}_running`]={},g.subscribe&&(b[y]=g.subscriptionOptions??b[y]??{}),!0}let A=!1;if(e.fulfilled.match(m)||e.rejected.match(m)){const g=f[m.meta.arg.queryCacheKey]||{},y=`${m.meta.requestId}_running`;A||=!!g[y],delete g[y]}if(e.rejected.match(m)){const{meta:{condition:g,arg:y,requestId:b}}=m;if(g&&y.subscribe){const x=f[y.queryCacheKey]??={};x[b]=y.subscriptionOptions??x[b]??{},A=!0}}return A},c=()=>r.currentSubscriptions,d={getSubscriptions:c,getSubscriptionCount:f=>{const A=c()[f]??{};return us(A)},isRequestSubscribed:(f,m)=>!!c()?.[f]?.[m]};return(f,m)=>{if(s||(s=JSON.parse(JSON.stringify(r.currentSubscriptions))),t.util.resetApiState.match(f))return s=r.currentSubscriptions={},i=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(f))return[!1,d];const A=l(r.currentSubscriptions,f);let g=!0;if(A){i||(i=setTimeout(()=>{const x=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,w]=ux(s,()=>x);m.next(t.internalActions.subscriptionsUpdated(w)),s=x,i=null},500));const y=typeof f.type=="string"&&!!f.type.startsWith(n),b=e.rejected.match(f)&&f.meta.condition&&!!f.meta.arg.subscribe;g=!y&&!b}return[g,!1]}};function XS(t){for(const e in t)return!1;return!0}var JS=2147483647/1e3-1,ZS=({reducerPath:t,api:e,queryThunk:r,context:n,internalState:s,selectors:{selectQueryEntry:i,selectConfig:o}})=>{const{removeQueryResult:a,unsubscribeQueryResult:l,cacheEntriesUpserted:c}=e.internalActions,u=pr(l.match,r.fulfilled,r.rejected,c.match);function h(g){const y=s.currentSubscriptions[g];return!!y&&!XS(y)}const d={},f=(g,y,b)=>{const x=y.getState(),w=o(x);if(u(g)){let V;if(c.match(g))V=g.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=l.match(g)?g.payload:g.meta.arg;V=[_]}m(V,y,w)}if(e.util.resetApiState.match(g))for(const[V,_]of Object.entries(d))_&&clearTimeout(_),delete d[V];if(n.hasRehydrationInfo(g)){const{queries:V}=n.extractRehydrationInfo(g);m(Object.keys(V),y,w)}};function m(g,y,b){const x=y.getState();for(const w of g){const V=i(x,w);A(w,V?.endpointName,y,b)}}function A(g,y,b,x){const V=n.endpointDefinitions[y]?.keepUnusedDataFor??x.keepUnusedDataFor;if(V===1/0)return;const _=Math.max(0,Math.min(V,JS));if(!h(g)){const v=d[g];v&&clearTimeout(v),d[g]=setTimeout(()=>{h(g)||b.dispatch(a({queryCacheKey:g})),delete d[g]},_*1e3)}}return f},Pm=new Error("Promise never resolved before cacheEntryRemoved."),ek=({api:t,reducerPath:e,context:r,queryThunk:n,mutationThunk:s,internalState:i,selectors:{selectQueryEntry:o,selectApiState:a}})=>{const l=Nu(n),c=Nu(s),u=Wr(n,s),h={};function d(y,b,x){const w=h[y];w?.valueResolved&&(w.valueResolved({data:b,meta:x}),delete w.valueResolved)}function f(y){const b=h[y];b&&(delete h[y],b.cacheEntryRemoved())}const m=(y,b,x)=>{const w=A(y);function V(_,v,S,E){const R=o(x,v),I=o(b.getState(),v);!R&&I&&g(_,E,v,b,S)}if(n.pending.match(y))V(y.meta.arg.endpointName,w,y.meta.requestId,y.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(y))for(const{queryDescription:_,value:v}of y.payload){const{endpointName:S,originalArgs:E,queryCacheKey:R}=_;V(S,R,y.meta.requestId,E),d(R,v,{})}else if(s.pending.match(y))b.getState()[e].mutations[w]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,w,b,y.meta.requestId);else if(u(y))d(w,y.payload,y.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(y)||t.internalActions.removeMutationResult.match(y))f(w);else if(t.util.resetApiState.match(y))for(const _ of Object.keys(h))f(_)};function A(y){return l(y)?y.meta.arg.queryCacheKey:c(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:t.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:t.internalActions.removeMutationResult.match(y)?Ii(y.payload):""}function g(y,b,x,w,V){const _=r.endpointDefinitions[y],v=_?.onCacheEntryAdded;if(!v)return;const S={},E=new Promise(U=>{S.cacheEntryRemoved=U}),R=Promise.race([new Promise(U=>{S.valueResolved=U}),E.then(()=>{throw Pm})]);R.catch(()=>{}),h[x]=S;const I=t.endpoints[y].select(_.type==="query"?b:x),B=w.dispatch((U,q,k)=>k),z={...w,getCacheEntry:()=>I(w.getState()),requestId:V,extra:B,updateCachedData:_.type==="query"?U=>w.dispatch(t.util.updateQueryData(y,b,U)):void 0,cacheDataLoaded:R,cacheEntryRemoved:E},L=v(b,z);Promise.resolve(L).catch(U=>{if(U!==Pm)throw U})}return m},tk=({api:t,context:{apiUid:e},reducerPath:r})=>(n,s)=>{t.util.resetApiState.match(n)&&s.dispatch(t.internalActions.middlewareRegistered(e))},rk=({reducerPath:t,context:e,context:{endpointDefinitions:r},mutationThunk:n,queryThunk:s,api:i,assertTagType:o,refetchQuery:a,internalState:l})=>{const{removeQueryResult:c}=i.internalActions,u=pr(Wr(n),Ka(n)),h=pr(Wr(n,s),As(n,s));let d=[];const f=(g,y)=>{u(g)?A(nb(g,"invalidatesTags",r,o),y):h(g)?A([],y):i.util.invalidateTags.match(g)&&A(Cd(g.payload,void 0,void 0,void 0,void 0,o),y)};function m(g){const{queries:y,mutations:b}=g;for(const x of[y,b])for(const w in x)if(x[w]?.status==="pending")return!0;return!1}function A(g,y){const b=y.getState(),x=b[t];if(d.push(...g),x.config.invalidationBehavior==="delayed"&&m(x))return;const w=d;if(d=[],w.length===0)return;const V=i.util.selectInvalidatedBy(b,w);e.batch(()=>{const _=Array.from(V.values());for(const{queryCacheKey:v}of _){const S=x.queries[v],E=l.currentSubscriptions[v]??{};S&&(us(E)===0?y.dispatch(c({queryCacheKey:v})):S.status!=="uninitialized"&&y.dispatch(a(S)))}})}return f},nk=({reducerPath:t,queryThunk:e,api:r,refetchQuery:n,internalState:s})=>{const i={},o=(d,f)=>{(r.internalActions.updateSubscriptionOptions.match(d)||r.internalActions.unsubscribeQueryResult.match(d))&&l(d.payload,f),(e.pending.match(d)||e.rejected.match(d)&&d.meta.condition)&&l(d.meta.arg,f),(e.fulfilled.match(d)||e.rejected.match(d)&&!d.meta.condition)&&a(d.meta.arg,f),r.util.resetApiState.match(d)&&u()};function a({queryCacheKey:d},f){const m=f.getState()[t],A=m.queries[d],g=s.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y,skipPollingIfUnfocused:b}=h(g);if(!Number.isFinite(y))return;const x=i[d];x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);const w=Date.now()+y;i[d]={nextPollTimestamp:w,pollingInterval:y,timeout:setTimeout(()=>{(m.config.focused||!b)&&f.dispatch(n(A)),a({queryCacheKey:d},f)},y)}}function l({queryCacheKey:d},f){const A=f.getState()[t].queries[d],g=s.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y}=h(g);if(!Number.isFinite(y)){c(d);return}const b=i[d],x=Date.now()+y;(!b||x<b.nextPollTimestamp)&&a({queryCacheKey:d},f)}function c(d){const f=i[d];f?.timeout&&clearTimeout(f.timeout),delete i[d]}function u(){for(const d of Object.keys(i))c(d)}function h(d={}){let f=!1,m=Number.POSITIVE_INFINITY;for(let A in d)d[A].pollingInterval&&(m=Math.min(d[A].pollingInterval,m),f=d[A].skipPollingIfUnfocused||f);return{lowestPollingInterval:m,skipPollingIfUnfocused:f}}return o},sk=({api:t,context:e,queryThunk:r,mutationThunk:n})=>{const s=rd(r,n),i=As(r,n),o=Wr(r,n),a={};return(c,u)=>{if(s(c)){const{requestId:h,arg:{endpointName:d,originalArgs:f}}=c.meta,m=e.endpointDefinitions[d],A=m?.onQueryStarted;if(A){const g={},y=new Promise((V,_)=>{g.resolve=V,g.reject=_});y.catch(()=>{}),a[h]=g;const b=t.endpoints[d].select(m.type==="query"?f:h),x=u.dispatch((V,_,v)=>v),w={...u,getCacheEntry:()=>b(u.getState()),requestId:h,extra:x,updateCachedData:m.type==="query"?V=>u.dispatch(t.util.updateQueryData(d,f,V)):void 0,queryFulfilled:y};A(f,w)}}else if(o(c)){const{requestId:h,baseQueryMeta:d}=c.meta;a[h]?.resolve({data:c.payload,meta:d}),delete a[h]}else if(i(c)){const{requestId:h,rejectedWithValue:d,baseQueryMeta:f}=c.meta;a[h]?.reject({error:c.payload??c.error,isUnhandledError:!d,meta:f}),delete a[h]}}},ik=({reducerPath:t,context:e,api:r,refetchQuery:n,internalState:s})=>{const{removeQueryResult:i}=r.internalActions,o=(l,c)=>{Vd.match(l)&&a(c,"refetchOnFocus"),_d.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){const u=l.getState()[t],h=u.queries,d=s.currentSubscriptions;e.batch(()=>{for(const f of Object.keys(d)){const m=h[f],A=d[f];if(!A||!m)continue;(Object.values(A).some(y=>y[c]===!0)||Object.values(A).every(y=>y[c]===void 0)&&u.config[c])&&(us(A)===0?l.dispatch(i({queryCacheKey:f})):m.status!=="uninitialized"&&l.dispatch(n(m)))}})}return o};function ok(t){const{reducerPath:e,queryThunk:r,api:n,context:s}=t,{apiUid:i}=s,o={invalidateTags:vt(`${e}/invalidateTags`)},a=h=>h.type.startsWith(`${e}/`),l=[tk,ZS,rk,nk,ek,sk];return{middleware:h=>{let d=!1;const m={...t,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},A=l.map(b=>b(m)),g=KS(m),y=ik(m);return b=>x=>{if(!Xh(x))return b(x);d||(d=!0,h.dispatch(n.internalActions.middlewareRegistered(i)));const w={...h,next:b},V=h.getState(),[_,v]=g(x,w,V);let S;if(_?S=b(x):S=v,h.getState()[e]&&(y(x,w,V),a(x)||s.hasRehydrationInfo(x)))for(const E of A)E(x,w,V);return S}},actions:o};function u(h){return t.api.endpoints[h.endpointName].initiate(h.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Em=Symbol(),ob=({createSelector:t=td}={})=>({name:Em,init(e,{baseQuery:r,tagTypes:n,reducerPath:s,serializeQueryArgs:i,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u},h){zV();const d=O=>O;Object.assign(e,{reducerPath:s,endpoints:{},internalActions:{onOnline:_d,onOffline:tb,onFocus:Vd,onFocusLost:eb},util:{}});const f=YS({serializeQueryArgs:i,reducerPath:s,createSelector:t}),{selectInvalidatedBy:m,selectCachedArgsForQuery:A,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:b}=f;wr(e.util,{selectInvalidatedBy:m,selectCachedArgsForQuery:A});const{queryThunk:x,infiniteQueryThunk:w,mutationThunk:V,patchQueryData:_,updateQueryData:v,upsertQueryData:S,prefetch:E,buildMatchThunkActions:R}=GS({baseQuery:r,reducerPath:s,context:h,api:e,serializeQueryArgs:i,assertTagType:d,selectors:f}),{reducer:I,actions:B}=WS({context:h,queryThunk:x,mutationThunk:V,serializeQueryArgs:i,reducerPath:s,assertTagType:d,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:s,invalidationBehavior:u}});wr(e.util,{patchQueryData:_,updateQueryData:v,upsertQueryData:S,prefetch:E,resetApiState:B.resetApiState,upsertQueryEntries:B.cacheEntriesUpserted}),wr(e.internalActions,B);const{middleware:z,actions:L}=ok({reducerPath:s,context:h,queryThunk:x,mutationThunk:V,infiniteQueryThunk:w,api:e,assertTagType:d,selectors:f});wr(e.util,L),wr(e,{reducer:I,middleware:z});const{buildInitiateQuery:U,buildInitiateInfiniteQuery:q,buildInitiateMutation:k,getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueriesThunk:T,getRunningQueryThunk:j}=HS({queryThunk:x,mutationThunk:V,infiniteQueryThunk:w,api:e,serializeQueryArgs:i,context:h});return wr(e.util,{getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueryThunk:j,getRunningQueriesThunk:T}),{name:Em,injectEndpoint(O,N){const D=e,F=D.endpoints[O]??={};Sd(N)&&wr(F,{name:O,select:g(O,N),initiate:U(O,N)},R(x,O)),DS(N)&&wr(F,{name:O,select:b(),initiate:k(O)},R(V,O)),kd(N)&&wr(F,{name:O,select:y(O,N),initiate:q(O,N)},R(x,O))}}}});ob();function Ro(t){return t.replace(t[0],t[0].toUpperCase())}function ak(t){return t.type==="query"}function lk(t){return t.type==="mutation"}function ab(t){return t.type==="infinitequery"}function Ys(t,...e){return Object.assign(t,...e)}var Ac=Symbol();function Tm(t,e,r,n){const s=C.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?e({queryArgs:t,endpointDefinition:r,endpointName:n}):t}),[t,e,r,n]),i=C.useRef(s);return C.useEffect(()=>{i.current.serialized!==s.serialized&&(i.current=s)},[s]),i.current.serialized===s.serialized?i.current.queryArgs:t}function Mo(t){const e=C.useRef(t);return C.useEffect(()=>{gi(e.current,t)||(e.current=t)},[t]),gi(e.current,t)?e.current:t}var ck=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uk=ck(),hk=()=>typeof navigator<"u"&&navigator.product==="ReactNative",dk=hk(),fk=()=>uk||dk?C.useLayoutEffect:C.useEffect,pk=fk(),Rm=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:Jx.pending}:t;function yc(t,...e){const r={};return e.forEach(n=>{r[n]=t[n]}),r}var xc=["data","status","isLoading","isSuccess","isError","error"];function mk({api:t,moduleOptions:{batch:e,hooks:{useDispatch:r,useSelector:n,useStore:s},unstable__sideEffectsInRender:i,createSelector:o},serializeQueryArgs:a,context:l}){const c=i?w=>w():C.useEffect;return{buildQueryHooks:y,buildInfiniteQueryHooks:b,buildMutationHook:x,usePrefetch:d};function u(w,V,_){if(V?.endpointName&&w.isUninitialized){const{endpointName:B}=V,z=l.endpointDefinitions[B];_!==Sr&&a({queryArgs:V.originalArgs,endpointDefinition:z,endpointName:B})===a({queryArgs:_,endpointDefinition:z,endpointName:B})&&(V=void 0)}let v=w.isSuccess?w.data:V?.data;v===void 0&&(v=w.data);const S=v!==void 0,E=w.isLoading,R=(!V||V.isLoading||V.isUninitialized)&&!S&&E,I=w.isSuccess||S&&(E&&!V?.isError||w.isUninitialized);return{...w,data:v,currentData:w.data,isFetching:E,isLoading:R,isSuccess:I}}function h(w,V,_){if(V?.endpointName&&w.isUninitialized){const{endpointName:B}=V,z=l.endpointDefinitions[B];a({queryArgs:V.originalArgs,endpointDefinition:z,endpointName:B})===a({queryArgs:_,endpointDefinition:z,endpointName:B})&&(V=void 0)}let v=w.isSuccess?w.data:V?.data;v===void 0&&(v=w.data);const S=v!==void 0,E=w.isLoading,R=(!V||V.isLoading||V.isUninitialized)&&!S&&E,I=w.isSuccess||E&&S;return{...w,data:v,currentData:w.data,isFetching:E,isLoading:R,isSuccess:I}}function d(w,V){const _=r(),v=Mo(V);return C.useCallback((S,E)=>_(t.util.prefetch(w,S,{...v,...E})),[w,_,v])}function f(w,V,{refetchOnReconnect:_,refetchOnFocus:v,refetchOnMountOrArgChange:S,skip:E=!1,pollingInterval:R=0,skipPollingIfUnfocused:I=!1,...B}={}){const{initiate:z}=t.endpoints[w],L=r(),U=C.useRef(void 0);if(!U.current){const G=L(t.internalActions.internal_getRTKQSubscriptions());U.current=G}const q=Tm(E?Sr:V,Gu,l.endpointDefinitions[w],w),k=Mo({refetchOnReconnect:_,refetchOnFocus:v,pollingInterval:R,skipPollingIfUnfocused:I}),P=C.useRef(!1),M=B.initialPageParam,T=Mo(M),j=C.useRef(void 0);let{queryCacheKey:O,requestId:N}=j.current||{},D=!1;O&&N&&(D=U.current.isRequestSubscribed(O,N));const F=!D&&P.current;return c(()=>{P.current=D}),c(()=>{F&&(j.current=void 0)},[F]),c(()=>{const G=j.current;if(q===Sr){G?.unsubscribe(),j.current=void 0;return}const Q=j.current?.subscriptionOptions;if(!G||G.arg!==q){G?.unsubscribe();const re=L(z(q,{subscriptionOptions:k,forceRefetch:S,...ab(l.endpointDefinitions[w])?{initialPageParam:T}:{}}));j.current=re}else k!==Q&&G.updateSubscriptionOptions(k)},[L,z,S,q,k,F,T,w]),[j,L,z,k]}function m(w,V){return(v,{skip:S=!1,selectFromResult:E}={})=>{const{select:R}=t.endpoints[w],I=Tm(S?Sr:v,a,l.endpointDefinitions[w],w),B=C.useRef(void 0),z=C.useMemo(()=>o([R(I),(P,M)=>M,P=>I],V,{memoizeOptions:{resultEqualityCheck:gi}}),[R,I]),L=C.useMemo(()=>E?o([z],E,{devModeChecks:{identityFunctionCheck:"never"}}):z,[z,E]),U=n(P=>L(P,B.current),gi),q=s(),k=z(q.getState(),B.current);return pk(()=>{B.current=k},[k]),U}}function A(w){C.useEffect(()=>()=>{w.current?.unsubscribe?.(),w.current=void 0},[w])}function g(w){if(!w.current)throw new Error(nt(38));return w.current.refetch()}function y(w){const V=(S,E={})=>{const[R]=f(w,S,E);return A(R),C.useMemo(()=>({refetch:()=>g(R)}),[R])},_=({refetchOnReconnect:S,refetchOnFocus:E,pollingInterval:R=0,skipPollingIfUnfocused:I=!1}={})=>{const{initiate:B}=t.endpoints[w],z=r(),[L,U]=C.useState(Ac),q=C.useRef(void 0),k=Mo({refetchOnReconnect:S,refetchOnFocus:E,pollingInterval:R,skipPollingIfUnfocused:I});c(()=>{const j=q.current?.subscriptionOptions;k!==j&&q.current?.updateSubscriptionOptions(k)},[k]);const P=C.useRef(k);c(()=>{P.current=k},[k]);const M=C.useCallback(function(j,O=!1){let N;return e(()=>{q.current?.unsubscribe(),q.current=N=z(B(j,{subscriptionOptions:P.current,forceRefetch:!O})),U(j)}),N},[z,B]),T=C.useCallback(()=>{q.current?.queryCacheKey&&z(t.internalActions.removeQueryResult({queryCacheKey:q.current?.queryCacheKey}))},[z]);return C.useEffect(()=>()=>{q?.current?.unsubscribe()},[]),C.useEffect(()=>{L!==Ac&&!q.current&&M(L,!0)},[L,M]),C.useMemo(()=>[M,L,{reset:T}],[M,L,T])},v=m(w,u);return{useQueryState:v,useQuerySubscription:V,useLazyQuerySubscription:_,useLazyQuery(S){const[E,R,{reset:I}]=_(S),B=v(R,{...S,skip:R===Ac}),z=C.useMemo(()=>({lastArg:R}),[R]);return C.useMemo(()=>[E,{...B,reset:I},z],[E,B,I,z])},useQuery(S,E){const R=V(S,E),I=v(S,{selectFromResult:S===Sr||E?.skip?void 0:Rm,...E}),B=yc(I,...xc);return C.useDebugValue(B),C.useMemo(()=>({...I,...R}),[I,R])}}}function b(w){const V=(v,S={})=>{const[E,R,I,B]=f(w,v,S),z=C.useRef(B);c(()=>{z.current=B},[B]);const L=C.useCallback(function(U,q){let k;return e(()=>{E.current?.unsubscribe(),E.current=k=R(I(U,{subscriptionOptions:z.current,direction:q}))}),k},[E,R,I]);return A(E),C.useMemo(()=>({trigger:L,refetch:()=>g(E),fetchNextPage:()=>L(v,"forward"),fetchPreviousPage:()=>L(v,"backward")}),[E,L,v])},_=m(w,h);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:V,useInfiniteQuery(v,S){const{refetch:E,fetchNextPage:R,fetchPreviousPage:I}=V(v,S),B=_(v,{selectFromResult:v===Sr||S?.skip?void 0:Rm,...S}),z=yc(B,...xc,"hasNextPage","hasPreviousPage");return C.useDebugValue(z),C.useMemo(()=>({...B,fetchNextPage:R,fetchPreviousPage:I,refetch:E}),[B,R,I,E])}}}function x(w){return({selectFromResult:V,fixedCacheKey:_}={})=>{const{select:v,initiate:S}=t.endpoints[w],E=r(),[R,I]=C.useState();C.useEffect(()=>()=>{R?.arg.fixedCacheKey||R?.reset()},[R]);const B=C.useCallback(function(j){const O=E(S(j,{fixedCacheKey:_}));return I(O),O},[E,S,_]),{requestId:z}=R||{},L=C.useMemo(()=>v({fixedCacheKey:_,requestId:R?.requestId}),[_,R,v]),U=C.useMemo(()=>V?o([L],V):L,[V,L]),q=n(U,gi),k=_==null?R?.arg.originalArgs:void 0,P=C.useCallback(()=>{e(()=>{R&&I(void 0),_&&E(t.internalActions.removeMutationResult({requestId:z,fixedCacheKey:_}))})},[E,_,R,z]),M=yc(q,...xc,"endpointName");C.useDebugValue(M);const T=C.useMemo(()=>({...q,originalArgs:k,reset:P}),[q,k,P]);return C.useMemo(()=>[B,T],[B,T])}}}var gk=Symbol(),Ak=({batch:t=tV,hooks:e={useDispatch:Yy,useSelector:Qy,useStore:$h},createSelector:r=td,unstable__sideEffectsInRender:n=!1,...s}={})=>({name:gk,init(i,{serializeQueryArgs:o},a){const l=i,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:h,usePrefetch:d}=mk({api:i,moduleOptions:{batch:t,hooks:e,unstable__sideEffectsInRender:n,createSelector:r},serializeQueryArgs:o,context:a});return Ys(l,{usePrefetch:d}),Ys(a,{batch:t}),{injectEndpoint(f,m){if(ak(m)){const{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:b,useQuerySubscription:x}=c(f);Ys(l.endpoints[f],{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:b,useQuerySubscription:x}),i[`use${Ro(f)}Query`]=A,i[`useLazy${Ro(f)}Query`]=g}if(lk(m)){const A=h(f);Ys(l.endpoints[f],{useMutation:A}),i[`use${Ro(f)}Mutation`]=A}else if(ab(m)){const{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}=u(f);Ys(l.endpoints[f],{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}),i[`use${Ro(f)}InfiniteQuery`]=A}}}}}),yk=ib(ob(),Ak());const xk=Xi(()=>gr(()=>import("./campaign-BXiPcX1f.js"),__vite__mapDeps([0,1,2]))),tl=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const bk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ai=Array.prototype.slice.call(bk),Io=(t=>{let e={};return t.forEach((r,n)=>e[r]=n),e})(ai),wk=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,la=String.fromCharCode.bind(String),Mm=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),qk=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),lb=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),vk=t=>{let e,r,n,s,i="";const o=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|s,i+=ai[e>>18&63]+ai[e>>12&63]+ai[e>>6&63]+ai[e&63]}return o?i.slice(0,o-3)+"===".substring(o):i},Vk=typeof btoa=="function"?t=>btoa(t):tl?t=>Buffer.from(t,"binary").toString("base64"):vk,Im=tl?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let n=0,s=t.length;n<s;n+=4096)r.push(la.apply(null,t.subarray(n,n+4096)));return Vk(r.join(""))},_k=(t,e=!1)=>e?qk(Im(t)):Im(t),Sk=t=>{if(t=t.replace(/\s+/g,""),!wk.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",n,s;for(let i=0;i<t.length;)e=Io[t.charAt(i++)]<<18|Io[t.charAt(i++)]<<12|(n=Io[t.charAt(i++)])<<6|(s=Io[t.charAt(i++)]),r+=n===64?la(e>>16&255):s===64?la(e>>16&255,e>>8&255):la(e>>16&255,e>>8&255,e&255);return r},kk=typeof atob=="function"?t=>atob(lb(t)):tl?t=>Buffer.from(t,"base64").toString("binary"):Sk,Ck=tl?t=>Mm(Buffer.from(t,"base64")):t=>Mm(kk(t).split("").map(e=>e.charCodeAt(0))),Pk=t=>Ck(Ek(t)),Ek=t=>lb(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Tk=!0,cb="gzip",Rk=async t=>{const e=JSON.stringify(t),n=new TextEncoder().encode(e),s=new Blob([n]),i=new CompressionStream(cb),o=s.stream().pipeThrough(i),a=await new Response(o).arrayBuffer(),l=new Uint8Array(a);return _k(l,Tk)},ub=async t=>{try{const e=Pk(t),r=new Blob([e]),n=new DecompressionStream(cb),s=r.stream().pipeThrough(n),i=await new Response(s).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},Mk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Pd extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Ik extends Pd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class jm extends Pd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Om extends Pd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Wu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Wu||(Wu={}));var jk=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class Ok{constructor(e,{headers:r={},customFetch:n,region:s=Wu.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=Mk(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return jk(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u}).catch(A=>{throw new Ik(A)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new jm(h);if(!h.ok)throw new Om(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield h.json():f==="application/octet-stream"?m=yield h.blob():f==="text/event-stream"?m=h:f==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof Om||s instanceof jm?s.context:void 0}}})}}var Ke={},Ln={},Dn={},Fn={},Un={},Hn={},Bk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},bs=Bk();const Nk=bs.fetch,hb=bs.fetch.bind(bs),db=bs.Headers,zk=bs.Request,Lk=bs.Response,js=Object.freeze(Object.defineProperty({__proto__:null,Headers:db,Request:zk,Response:Lk,default:hb,fetch:Nk},Symbol.toStringTag,{value:"Module"})),Dk=Iv(js);var jo={},Bm;function fb(){if(Bm)return jo;Bm=1,Object.defineProperty(jo,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return jo.default=t,jo}var Nm;function pb(){if(Nm)return Hn;Nm=1;var t=Hn&&Hn.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Hn,"__esModule",{value:!0});const e=t(Dk),r=t(fb());class n{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,m=null,A=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const V=await c.text();V===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=V:m=JSON.parse(V))}const x=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&w&&w.length>1&&(A=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,A=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await c.text();try{f=JSON.parse(x),Array.isArray(f)&&c.status===404&&(m=[],f=null,g=200,y="OK")}catch{c.status===404&&x===""?(g=204,y="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,y="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:m,count:A,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Hn.default=n,Hn}var zm;function mb(){if(zm)return Un;zm=1;var t=Un&&Un.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Un,"__esModule",{value:!0});const e=t(pb());class r extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Un.default=r,Un}var Lm;function Ed(){if(Lm)return Fn;Lm=1;var t=Fn&&Fn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Fn,"__esModule",{value:!0});const e=t(mb());class r extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return Fn.default=r,Fn}var Dm;function gb(){if(Dm)return Dn;Dm=1;var t=Dn&&Dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Dn,"__esModule",{value:!0});const e=t(Ed());class r{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=i,this.schema=o,this.fetch=a}select(s,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const c=s.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(s)){const h=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Dn.default=r,Dn}var Qs={},Ks={},Fm;function Fk(){return Fm||(Fm=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.version=void 0,Ks.version="0.0.0-automated"),Ks}var Um;function Uk(){if(Um)return Qs;Um=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.DEFAULT_HEADERS=void 0;const t=Fk();return Qs.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Qs}var Hm;function Hk(){if(Hm)return Ln;Hm=1;var t=Ln&&Ln.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ln,"__esModule",{value:!0});const e=t(gb()),r=t(Ed()),n=Uk();class s{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([A,g])=>g!==void 0).map(([A,g])=>[A,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([A,g])=>{d.searchParams.append(A,g)})):(h="POST",f=a);const m=Object.assign({},this.headers);return u&&(m.Prefer=`count=${u}`),new r.default({method:h,url:d,headers:m,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Ln.default=s,Ln}var $m;function $k(){if($m)return Ke;$m=1;var t=Ke&&Ke.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.PostgrestError=Ke.PostgrestBuilder=Ke.PostgrestTransformBuilder=Ke.PostgrestFilterBuilder=Ke.PostgrestQueryBuilder=Ke.PostgrestClient=void 0;const e=t(Hk());Ke.PostgrestClient=e.default;const r=t(gb());Ke.PostgrestQueryBuilder=r.default;const n=t(Ed());Ke.PostgrestFilterBuilder=n.default;const s=t(mb());Ke.PostgrestTransformBuilder=s.default;const i=t(pb());Ke.PostgrestBuilder=i.default;const o=t(fb());return Ke.PostgrestError=o.default,Ke.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},Ke}var Gk=$k();const Wk=st(Gk),{PostgrestClient:Yk,PostgrestQueryBuilder:_F,PostgrestFilterBuilder:SF,PostgrestTransformBuilder:kF,PostgrestBuilder:CF,PostgrestError:PF}=Wk;function Qk(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Kk=Qk(),Xk="2.11.15",Jk=`realtime-js/${Xk}`,Zk="1.0.0",Ab=1e4,e1=1e3;var xi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(xi||(xi={}));var ft;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ft||(ft={}));var er;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(er||(er={}));var Yu;(function(t){t.websocket="websocket"})(Yu||(Yu={}));var An;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(An||(An={}));class t1{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class yb{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ve;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ve||(Ve={}));const Gm=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=r1(o,t,e,s),i),{})},r1=(t,e,r,n)=>{const s=e.find(a=>a.name===t),i=s?.type,o=r[t];return i&&!n.includes(i)?xb(i,o):Qu(o)},xb=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return o1(e,r)}switch(t){case Ve.bool:return n1(e);case Ve.float4:case Ve.float8:case Ve.int2:case Ve.int4:case Ve.int8:case Ve.numeric:case Ve.oid:return s1(e);case Ve.json:case Ve.jsonb:return i1(e);case Ve.timestamp:return a1(e);case Ve.abstime:case Ve.date:case Ve.daterange:case Ve.int4range:case Ve.int8range:case Ve.money:case Ve.reltime:case Ve.text:case Ve.time:case Ve.timestamptz:case Ve.timetz:case Ve.tsrange:case Ve.tstzrange:return Qu(e);default:return Qu(e)}},Qu=t=>t,n1=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},s1=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},i1=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},o1=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>xb(e,a))}return t},a1=t=>typeof t=="string"?t.replace(" ","T"):t,bb=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class bc{constructor(e,r,n={},s=Ab){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wm;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Wm||(Wm={}));class bi{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bi.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=bi.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=bi.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),A=h.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),A.length>0&&(l[c]=A)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}n(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ym;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ym||(Ym={}));var Qm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Qm||(Qm={}));var Vr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Vr||(Vr={}));class Td{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new bc(this,er.join,this.params,this.timeout),this.rejoinTimer=new yb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ft.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(er.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new bi(this),this.broadcastEndpointURL=bb(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ft.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(Vr.CHANNEL_ERROR,u)),this._onClose(()=>e?.(Vr.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(Vr.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,m=[];for(let A=0;A<f;A++){const g=d[A],{filter:{event:y,schema:b,table:x,filter:w}}=g,V=u&&u[A];if(V&&V.event===y&&V.schema===b&&V.table===x&&V.filter===w)m.push(Object.assign(Object.assign({},g),{id:V.id}));else{this.unsubscribe(),this.state=ft.errored,e?.(Vr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Vr.SUBSCRIBED);return}}).receive("error",u=>{this.state=ft.errored,e?.(Vr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(Vr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ft.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(er.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new bc(this,er.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new bc(this,e,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=er;if(n&&[a,l,c,u].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var m,A,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(A=f.filter)===null||A===void 0?void 0:A.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,n)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var m,A,g,y,b,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,V=(m=f.filter)===null||m===void 0?void 0:m.event;return w&&((A=r.ids)===null||A===void 0?void 0:A.includes(w))&&(V==="*"||V?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const w=(b=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return w==="*"||w===((x=r?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:A,table:g,commit_timestamp:y,type:b,errors:x}=m;d=Object.assign(Object.assign({},{schema:A,table:g,commit_timestamp:y,eventType:b,new:{},old:{},errors:x}),this._getPayloadRecords(m))}f.callback(d,n)})}_isClosed(){return this.state===ft.closed}_isJoined(){return this.state===ft.joined}_isJoining(){return this.state===ft.joining}_isLeaving(){return this.state===ft.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Td.isEqual(s.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(er.close,{},e)}_onError(e){this._on(er.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ft.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Gm(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Gm(e.columns,e.old_record)),r}}const Km=()=>{},l1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class c1{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ab,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Km,this.ref=0,this.logger=Km,this.conn=null,this.sendBuffer=[],this.serializer=new t1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>gr(async()=>{const{default:l}=await Promise.resolve().then(()=>js);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Yu.websocket}`,this.httpEndpoint=bb(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r?.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new yb(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Kk),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Zk}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xi.connecting:return An.Connecting;case xi.open:return An.Open;case xi.closing:return An.Closing;default:return An.Closed}}isConnected(){return this.connectionState()===An.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Td(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Jk};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(er.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(e1,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:s,payload:i,ref:o}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(er.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([l1],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Rd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function et(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class u1 extends Rd{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ku extends Rd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var h1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const wb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},d1=()=>h1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gr(()=>Promise.resolve().then(()=>js),void 0)).Response:Response}),Xu=t=>{if(Array.isArray(t))return t.map(r=>Xu(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Xu(n)}),e};var Bn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const wc=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),f1=(t,e,r)=>Bn(void 0,void 0,void 0,function*(){const n=yield d1();t instanceof n&&!r?.noResolveJson?t.json().then(s=>{e(new u1(wc(s),t.status||500))}).catch(s=>{e(new Ku(wc(s),s))}):e(new Ku(wc(t),t))}),p1=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function oo(t,e,r,n,s,i){return Bn(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,p1(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>f1(l,a,n))})})}function Ca(t,e,r,n){return Bn(this,void 0,void 0,function*(){return oo(t,"GET",e,r,n)})}function zr(t,e,r,n,s){return Bn(this,void 0,void 0,function*(){return oo(t,"POST",e,n,s,r)})}function m1(t,e,r,n,s){return Bn(this,void 0,void 0,function*(){return oo(t,"PUT",e,n,s,r)})}function g1(t,e,r,n){return Bn(this,void 0,void 0,function*(){return oo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function qb(t,e,r,n,s){return Bn(this,void 0,void 0,function*(){return oo(t,"DELETE",e,n,s,r)})}var Vt=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const A1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class y1{constructor(e,r={},n,s){this.url=e,this.headers=r,this.bucketId=n,this.fetch=wb(s)}uploadOrUpdate(e,r,n,s){return Vt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Xm),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(et(i))return{data:null,error:i};throw i}})}upload(e,r,n){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return Vt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Xm.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(et(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Vt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const i=yield zr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Rd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}})}update(e,r,n){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Vt(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(et(s))return{data:null,error:s};throw s}})}copy(e,r,n){return Vt(this,void 0,void 0,function*(){try{return{data:{path:(yield zr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(et(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return Vt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield zr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(et(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return Vt(this,void 0,void 0,function*(){try{const s=yield zr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(et(s))return{data:null,error:s};throw s}})}download(e,r){return Vt(this,void 0,void 0,function*(){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ca(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(et(a))return{data:null,error:a};throw a}})}info(e){return Vt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Ca(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Xu(n),error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}})}exists(e){return Vt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield g1(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(et(n)&&n instanceof Ku){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield qb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}})}list(e,r,n){return Vt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},A1),r),{prefix:e||""});return{data:yield zr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(et(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const x1="2.7.1",b1={"X-Client-Info":`storage-js/${x1}`};var $n=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class w1{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},b1),r),this.fetch=wb(n)}listBuckets(){return $n(this,void 0,void 0,function*(){try{return{data:yield Ca(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}getBucket(e){return $n(this,void 0,void 0,function*(){try{return{data:yield Ca(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return $n(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return $n(this,void 0,void 0,function*(){try{return{data:yield m1(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}})}emptyBucket(e){return $n(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}})}deleteBucket(e){return $n(this,void 0,void 0,function*(){try{return{data:yield qb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}})}}class q1 extends w1{constructor(e,r={},n){super(e,r,n)}from(e){return new y1(this.url,this.headers,e,this.fetch)}}const v1="2.51.0";let li="";typeof Deno<"u"?li="deno":typeof document<"u"?li="web":typeof navigator<"u"&&navigator.product==="ReactNative"?li="react-native":li="node";const V1={"X-Client-Info":`supabase-js-${li}/${v1}`},_1={headers:V1},S1={schema:"public"},k1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},C1={};var P1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};const E1=t=>{let e;return t?e=t:typeof fetch>"u"?e=hb:e=fetch,(...r)=>e(...r)},T1=()=>typeof Headers>"u"?db:Headers,R1=(t,e,r)=>{const n=E1(r),s=T1();return(i,o)=>P1(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new s(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:c}))})};var M1=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};function I1(t){return t.endsWith("/")?t:t+"/"}function j1(t,e){var r,n;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=a?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>M1(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const vb="2.71.0",rs=30*1e3,Ju=3,qc=Ju*rs,O1="http://localhost:9999",B1="supabase.auth.token",N1={"X-Client-Info":`gotrue-js/${vb}`},Zu="X-Supabase-Api-Version",Vb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},z1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,L1=10*60*1e3;class Md extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function se(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class D1 extends Md{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function F1(t){return se(t)&&t.name==="AuthApiError"}class _b extends Md{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class tn extends Md{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Nr extends tn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function U1(t){return se(t)&&t.name==="AuthSessionMissingError"}class Oo extends tn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bo extends tn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class No extends tn{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function H1(t){return se(t)&&t.name==="AuthImplicitGrantRedirectError"}class Jm extends tn{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eh extends tn{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function vc(t){return se(t)&&t.name==="AuthRetryableFetchError"}class Zm extends tn{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class th extends tn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eg=` 	
\r=`.split(""),$1=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<eg.length;e+=1)t[eg[e].charCodeAt(0)]=-2;for(let e=0;e<Pa.length;e+=1)t[Pa[e].charCodeAt(0)]=e;return t})();function tg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Pa[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Pa[n]),e.queuedBits-=6}}function Sb(t,e,r){const n=$1[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function rg(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Y1(o,n,r)};for(let o=0;o<t.length;o+=1)Sb(t.charCodeAt(o),s,i);return e.join("")}function G1(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function W1(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}G1(n,e)}}function Y1(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Q1(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)Sb(t.charCodeAt(s),r,n);return new Uint8Array(e)}function K1(t){const e=[];return W1(t,r=>e.push(r)),new Uint8Array(e)}function X1(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>tg(s,r,n)),tg(null,r,n),e.join("")}function J1(t){return Math.round(Date.now()/1e3)+t}function Z1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Zt=()=>typeof window<"u"&&typeof document<"u",on={tested:!1,writable:!1},kb=()=>{if(!Zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(on.tested)return on.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),on.tested=!0,on.writable=!0}catch{on.tested=!0,on.writable=!1}return on.writable};function eC(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const Cb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},tC=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ns=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},an=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Or=async(t,e)=>{await t.removeItem(e)};class rl{constructor(){this.promise=new rl.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}rl.promiseConstructor=Promise;function Vc(t){const e=t.split(".");if(e.length!==3)throw new th("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!z1.test(e[n]))throw new th("JWT not in base64url format");return{header:JSON.parse(rg(e[0])),payload:JSON.parse(rg(e[1])),signature:Q1(e[2]),raw:{header:e[0],payload:e[1]}}}async function rC(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function nC(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function sC(t){return("0"+t.toString(16)).substr(-2)}function iC(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,sC).join("")}async function oC(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function aC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await oC(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gn(t,e,r=!1){const n=iC();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await ns(t,`${e}-code-verifier`,s);const i=await aC(n);return[i,n===i?"plain":"s256"]}const lC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function cC(t){const e=t.headers.get(Zu);if(!e||!e.match(lC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function uC(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function hC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const dC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wn(t){if(!dC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _c(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var fC=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const hn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),pC=[502,503,504];async function ng(t){var e;if(!tC(t))throw new eh(hn(t),0);if(pC.includes(t.status))throw new eh(hn(t),t.status);let r;try{r=await t.json()}catch(i){throw new _b(hn(i),i)}let n;const s=cC(t);if(s&&s.getTime()>=Vb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Zm(hn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Nr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Zm(hn(r),t.status,r.weak_password.reasons);throw new D1(hn(r),t.status||500,n)}const mC=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function fe(t,e,r,n){var s;const i=Object.assign({},n?.headers);i[Zu]||(i[Zu]=Vb["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await gC(t,e,r+a,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function gC(t,e,r,n,s,i){const o=mC(e,n,s,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new eh(hn(l),0)}if(a.ok||await ng(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await ng(l)}}function vr(t){var e;let r=null;bC(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=J1(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function sg(t){const e=vr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Lr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function AC(t){return{data:t,error:null}}function yC(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,o=fC(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function xC(t){return t}function bC(t){return t.access_token&&t.refresh_token&&t.expires_in}const Sc=["global","local","others"];var wC=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class qC{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Cb(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Sc[0]){if(Sc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Sc.join(", ")}`);try{return await fe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Lr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=wC(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:yC,redirectTo:r?.redirectTo})}catch(r){if(se(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await fe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Lr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:xC});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const A=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=A}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(se(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Wn(e);try{return await fe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Lr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Wn(e);try{return await fe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Lr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Wn(e);try{return await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Lr})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Wn(e.userId);try{const{data:r,error:n}=await fe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(se(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Wn(e.userId),Wn(e.id);try{return{data:await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}}function ig(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function vC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Yn={debug:!!(globalThis&&kb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Pb extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class VC extends Pb{}async function _C(t,e,r){Yn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Yn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Yn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{Yn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Yn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new VC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Yn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}vC();const SC={url:O1,storageKey:B1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:N1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function og(t,e,r){return await r()}const Qn={};class ji{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ji.nextInstanceID,ji.nextInstanceID+=1,this.instanceID>0&&Zt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},SC),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new qC({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Cb(s.fetch),this.lock=s.lock||og,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Zt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=_C:this.lock=og,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:kb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ig(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ig(this.memoryStorage)),Zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Qn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Qn[this.storageKey]=Object.assign(Object.assign({},Qn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Qn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qn[this.storageKey]=Object.assign(Object.assign({},Qn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${vb}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=eC(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Zt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),H1(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return se(r)?{error:r}:{error:new _b("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:vr}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Gn(this.storage,this.storageKey)),i=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},xform:vr})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d?.data)!==null&&n!==void 0?n:{},channel:(s=d?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:vr})}else throw new Bo("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:sg})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:sg})}else throw new Bo("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Oo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,i,o,a,l,c,u,h,d,f;let m,A;if("message"in e)m=e.message,A=e.signature;else{const{chain:g,wallet:y,statement:b,options:x}=e;let w;if(Zt())if(typeof y=="object")w=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const V=new URL((r=x?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),b?{statement:b}:null));let v;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")v=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)v=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in v&&"signature"in v&&(typeof v.signedMessage=="string"||v.signedMessage instanceof Uint8Array)&&v.signature instanceof Uint8Array)m=typeof v.signedMessage=="string"?v.signedMessage:new TextDecoder().decode(v.signedMessage),A=v.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${V.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(s=(n=x?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(v=>`- ${v}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=_}}try{const{data:g,error:y}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:X1(A)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:vr});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Oo}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(se(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await an(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:vr});if(await Or(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Oo}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(se(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=e,a=await fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:vr}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Oo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Gn(this.storage,this.storageKey));const{error:h}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Bo("You must provide either an email or phone number.")}catch(a){if(se(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:vr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(se(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Gn(this.storage,this.storageKey)),await fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:AC})}catch(i){if(se(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Nr;const{error:s}=await fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(se(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await fe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await fe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new Bo("You must provide either an email or phone number and a type")}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await an(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<qc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await an(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=_c()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Lr}):await this._useSession(async r=>{var n,s,i;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nr}:await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Lr})})}catch(r){if(se(r))return U1(r)&&(await this._removeSession(),await Or(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Nr;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Gn(this.storage,this.storageKey));const{data:c,error:u}=await fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Lr});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(se(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nr;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=Vc(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(se(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Nr;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Zt())throw new No("No browser detected.");if(e.error||e.error_description||e.error_code)throw new No(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Jm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new No("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Jm("No code detected.");const{data:b,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new No("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=rs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:A,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(n){if(se(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await an(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(F1(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Or(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Z1(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Gn(this.storage,this.storageKey,!0));try{return await fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(se(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await fe(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Zt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(se(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await fe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await nC(async s=>(s>0&&await rC(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:vr})),(s,i)=>{const o=200*Math.pow(2,s);return i&&vc(i)&&Date.now()+o-n<rs})}catch(n){if(this._debug(r,"error",n),se(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Zt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await an(this.storage,this.storageKey);if(s&&this.userStorage){let o=await an(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await ns(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:_c()}else if(s&&!s.user&&!s.user){const o=await an(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await Or(this.storage,this.storageKey+"-user"),await ns(this.storage,this.storageKey,s)):s.user=_c()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<qc;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${qc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),vc(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rl;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),se(i)){const o={session:null,error:i};return vc(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ns(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=structuredClone(s);await ns(this.storage,this.storageKey,i)}else{const s=structuredClone(r);await ns(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Or(this.storage,this.storageKey),await Or(this.storage,this.storageKey+"-code-verifier"),await Or(this.storage,this.storageKey+"-user"),this.userStorage&&await Or(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Zt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/rs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${rs}ms, refresh threshold is ${Ju} ticks`),s<=Ju&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Pb)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await Gn(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await fe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await fe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l?.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Vc(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+L1>s)return n;const{data:i,error:o}=await fe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:f,error:m}=await this.getSession();if(m||!f.session)return{data:null,error:m};n=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Vc(n);r?.allowExpired||uC(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=hC(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,K1(`${a}.${l}`)))throw new th("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}}}ji.nextInstanceID=0;const kC=ji;class CC extends kC{constructor(e){super(e)}}var PC=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})};class EC{constructor(e,r,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=I1(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:S1,realtime:C1,auth:Object.assign(Object.assign({},k1),{storageKey:c}),global:_1},h=j1(n??{},u);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=R1(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Yk(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new Ok(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new q1(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return PC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new CC({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new c1(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const TC=(t,e,r)=>new EC(t,e,r),Id=TC("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),RC=async t=>{if(t.locator.campaignName===void 0)throw new Error("can not save a campaign without a name");const e=await Id.rpc("save_campaign_version",{p_name:t.locator.campaignName,p_data:await Rk(t),p_published:t.meta?.published??!1});if(e.error)throw new Error(`error saving to db ${e.error.message} ${e.error.details}`,{cause:e.error});return e.data},MC=async t=>{const e=await Id.rpc("get_latest_campaign",{p_campaign_name:t.campaignName,p_user_id:t.userId,p_version:t.version===-1?void 0:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const r=await ub(e.data.data);return Object.values(r.rooms).forEach(n=>{delete n.size}),r.locator===void 0&&(r.locator={userId:t.userId||"upgraded, unknown",campaignName:t.campaignName,version:e.data.version}),delete r.name,r},IC=async({publishedOnly:t})=>{const e=await Id.rpc("get_all_users_latest_campaigns",{p_published_only:t});if(e.error)throw new Error("could not get user campaigns",{cause:e.error});return e.data},wi=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},En=yk({reducerPath:"campaignsApi",baseQuery:QS(),endpoints:t=>({getCampaign:t.query({async queryFn(e){try{return e.userId==="@@original"&&e.campaignName==="original"?{data:(await xk()).campaign}:e.campaignName.startsWith("data:")?{data:await ub(e.campaignName.substring(5))}:{data:await MC(e)}}catch(r){return{error:wi(new Error(`getCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}}),getAllUsersLatestCampaigns:t.query({async queryFn({publishedOnly:e}){try{return{data:await IC({publishedOnly:e})}}catch(r){return{error:wi(new Error(`getAllUsersLatestCampaigns queryFn() failed: ${r}`))}}}}),saveCampaign:t.mutation({async queryFn(e){try{return{data:await RC(e)}}catch(r){return{error:wi(new Error(`saveCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}})})}),{useGetAllUsersLatestCampaignsQuery:jC}=En,OC=En.endpoints.getCampaign.select,BC=(t,e)=>OC(e)(t).data,NC=8,Eb=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:n=Pt()})=>{const s=Is[e],{renderAreaSize:i,rotate90:o}=n!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},a=Rx(i,r),l=Math.max(Math.floor(Math.min(a.x/s.x,a.y/s.y)),1),c=Math.min(NC,l),u=l/c/r,h={x:Math.floor(a.x/l),y:Math.floor(a.y/l)},d={x:Math.ceil(i.x/u),y:Math.ceil(i.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:h,canvasSize:d,rotate90:o}},zC=t=>Pt()==="server"?Is.zxSpectrum:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},jd=(t,e)=>{const r=Pt();return{renderAreaSize:zC(e),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio}},LC={upscale:Eb(jd(vd.displaySettings.emulatedResolution))},Ea=_r({name:"upscale",initialState:LC,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=Eb(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:Tb}=Ea.actions,{selectCanvasSize:DC,selectRot90:FC,selectUpscale:UC,selectGameEngineUpscale:EF,selectTotalUpscale:HC,selectGameEngineScreenSize:TF}=Ea.selectors,Gt=t=>e=>Sa(e.gameMenus.userSettings,t)??Sa(vd,t),ao=()=>ue(HC),Ta=Gt("inputAssignment"),RF=t=>t.gameMenus.openMenus.length>0,$C=()=>ue(t=>t.gameMenus.cheatsOn),Rb=t=>t.gameMenus.assigningInput!==void 0,Mb=()=>ue(Rb),GC=t=>{for(const[e,r]of Oe(Wx(xs)))if(BS(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},ws=()=>ue(t=>t.gameMenus.gameRunning),WC=Gt("showFps"),nl=Gt("displaySettings.emulatedResolution"),YC=()=>ue(nl),QC=Gt("displaySettings.uncolourised"),Od=()=>ue(QC),Ib=Gt("infiniteLivesPoke"),jb=Gt("infiniteDoughnutsPoke"),MF=t=>t.gameMenus.gameInPlay.planetsLiberated.egyptus&&t.gameMenus.gameInPlay.planetsLiberated.bookworld&&t.gameMenus.gameInPlay.planetsLiberated.penitentiary&&t.gameMenus.gameInPlay.planetsLiberated.safari,Ra=()=>ue(t=>t.gameMenus.userSettings.screenRelativeControl),Bd=Gt("inputDirectionMode"),Ob=()=>ue(Bd),KC=t=>Fu(Oe(In(t.gameMenus.gameInPlay.planetsLiberated)).filter(Boolean)),XC=Gt("displaySettings.showBoundingBoxes"),IF=()=>ue(XC),JC=Gt("displaySettings.showShadowMasks"),jF=()=>ue(JC),ZC=Gt("screenRelativeControl"),eP=Gt("onScreenControls"),tP=Gt("soundSettings.mute"),rP=Gt("soundSettings.noFootsteps"),OF=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??vd.onScreenControls)&&e.upscale.rotate90===!1,nP=()=>ue(eP),BF=(t,e)=>!!Sa(t.gameMenus,e),sP=()=>ue(t=>t.gameMenus.gameInPlay.roomsExplored),Bb=t=>{const e=iP(t);if(!e)throw new Error(`No current campaign. Campaign locator is:
${JSON.stringify(t.gameMenus.gameInPlay.campaignLocator,null,2)}`);return e},Nb=Xx(Bb),iP=t=>{const e=t.gameMenus.gameInPlay.campaignLocator;return e===void 0?void 0:BC(t,e)},NF=["none","non-wall","all"],Xs=t=>D0(Ri(t,"userId","campaignName")),oP=["4-way","8-way","analogue"],aP=Pt()!=="server",lP=aP?Ur().has("cheats"):!1,cP={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},rh={planetsLiberated:cP,roomsExplored:{},scrollsRead:{},reincarnationPoint:void 0},nh={userSettings:{displaySettings:{},soundSettings:{}},gameRunning:!1,gameInPlay:rh,openMenus:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ye}],assigningInput:void 0,cheatsOn:lP,savedGames:{saves:{}}},lo=_r({name:"gameMenus",initialState:nh,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=xm(RS,nl({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},scrollRead(t,{payload:e}){e.source==="manual"?(t.gameInPlay.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:ye}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=xm(oP,Bd({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(o,a)=>{o.includes(a)||o.push(a)},{presses:n,axes:s,action:i}=t.assigningInput;switch(e.type){case"key":r(n.keys,e.input);break;case"gamepadButtons":r(n.gamepadButtons,e.input);break;case"gamepadAxes":{Ti.includes(i)&&r(s,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:n}=t.assigningInput,s=r.keys.length+r.gamepadButtons.length+n.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(xs.default.inputAssignment):t.userSettings.inputAssignment;s>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=n),(e==="towards"||e==="away")&&(i.axes.y=n)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:ye}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},closeAllMenus(t){t.openMenus=[]},gameStarted(t,{payload:{campaignLocator:e,noShowCrowns:r}}){if(t.gameRunning)throw new Error("game is already running");t.openMenus=r?[]:[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.gameInPlay={...rh,campaignLocator:e}},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=xs[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[n]=t.openMenus;n.focussedItemId=e,n.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:ye}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:ye}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){IS(t,e,!Sa(t,e))},crownCollected(t,{payload:e}){t.gameInPlay.planetsLiberated[e]=!0;const r=Object.values(t.gameInPlay.planetsLiberated).every(s=>s),n={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:ye},n]:t.openMenus=[n]},roomExplored(t,{payload:e}){t.gameInPlay.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){if(e&&t.gameInPlay.reincarnationPoint!==void 0)t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ye},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:ye}];else{t.gameRunning=!1,delete t.gameInPlay.reincarnationPoint;const r=t.gameInPlay.campaignLocator,n=r&&Xs(r);console.log(Ou(t.savedGames)),n&&(delete t.savedGames.saves[n],delete t.savedGames.lastSavedCampaignLocator),console.log(Ou(t.savedGames)),t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:ye},{menuId:"mainMenu",scrollableSelection:!0,menuParam:ye}]}},reincarnationFishEaten(t,{payload:e}){t.gameInPlay.reincarnationPoint=e},reincarnationAccepted(t){delete t.gameInPlay.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:ye}]},saveGame(t,{payload:e}){const r=t.gameInPlay.campaignLocator;if(r===void 0)throw new Error("trying to save a game, but seems like there's no campaign to save against");if(wd())throw new Error("shouldn't be saving in playtest mode");t.savedGames.saves[Xs(r)]=e,t.savedGames.lastSavedCampaignLocator=r},gameRestoreFromSave(t,{payload:e}){t.gameInPlay=e},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,nh),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){},lostLife(t,e){}},extraReducers(t){t.addCase(ro,(e,r)=>{if(Ur().get("campaignName")?.startsWith("data:"))return;const n=[{menuId:"hold",scrollableSelection:!1,menuParam:ye}],s={userId:Ur().get("campaignAuthorUserId")??void 0,campaignName:Ur().get("campaignName")??void 0},i=r.payload?.savedGames;if((c=>c.userId!==void 0&&c.campaignName!==void 0)(s)){e.gameRunning=!0;const c=i?.saves[Xs(s)];if(c){e.gameRunning=!0,e.gameInPlay=c.store.gameMenus.gameInPlay,e.openMenus=n;return}else{e.gameRunning=!0,e.gameInPlay={...rh,campaignLocator:s},e.openMenus=n;return}}const a=i?.lastSavedCampaignLocator,l=a&&i.saves[Xs(a)];l&&(e.gameRunning=!0,e.gameInPlay=l.store.gameMenus.gameInPlay,e.openMenus=n)})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")},selectSaveForCampaign(t,e){return t.savedGames.saves[Xs(e)]}}}),{assignInputStart:Xe,backToParentMenu:Be,characterRoomChange:uP,closeAllMenus:hP,crownCollected:dP,debugItemClicked:fP,doneAssigningInput:pP,errorCaught:Nd,errorDismissed:ag,gameOver:zd,gameRestoreFromSave:zF,gameStarted:Oi,goToSubmenu:wt,holdPressed:zb,inputAddedDuringAssignment:mP,keyAssignmentPresetChosen:gP,lostLife:AP,mapPressed:yP,menuOpenOrExitPressed:lg,nextInputDirectionMode:xP,reincarnationAccepted:Ld,reincarnationFishEaten:LF,roomExplored:bP,saveGame:wP,scrollRead:DF,setEmulatedResolution:Dd,setFocussedMenuItemId:Fd,setShowBoundingBoxes:FF,setShowShadowMasks:UF,toggleBoolean:hr}=lo.actions,{selectHasError:HF}=lo.selectors,$F=lo.selectors.selectSaveForCampaign,qP=t=>e=>(t(e),null),vP=pr(zd,Ld,AP,Nd,Oi,dP),VP=()=>{const t=_x();C.useEffect(()=>kx({matcher:vP,effect(r,{getState:n}){const s=t?.gameState,[,i]=r.type.split("/"),o=n(),a=s?Math.round(s.gameTime/1e3):void 0,l=r.payload===void 0?{}:r.type==="gameMenus/crownCollected"?{crownForPlanet:r.payload}:r.type==="gameMenus/gameStarted"?void 0:r.type==="gameMenus/lostLife"?{position:r.payload.characterLosingLifeItem.state.position}:r.payload,c={gameTimeSeconds:a,...o.gameMenus.gameInPlay,cheatsOn:o.gameMenus.cheatsOn,...l,currentCharacter:s?.currentCharacterName,inRoom:s?.characterRooms[s.currentCharacterName]};window.umami?(console.debug("🍜 umami event:",i,c),window.umami.track(i,c)):console.debug("🍜 no umami for event:",i,c)}}),[t])},_P=qP(VP),SP=Xi(()=>gr(()=>import("./Cheats-DlUTrLYo.js"),__vite__mapDeps([3,1,2,4]))),Kn=(t,e,r)=>{const n=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...$r(r,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...$r(r,{x:i+2,y:o}),w:a,h:l,pivot:c};function*s(){yield[`door.frame.${t}.${e}.whole`,{frame:{...n({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...n({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...n({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...n({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return Rs(s())},kP={frames:{...Kn("generic","y",{x:580,y:415}),...Kn("generic","x",{x:582,y:415}),...Kn("moonbase","y",{x:752,y:232}),...Kn("moonbase","x",{x:915,y:232}),...Kn("moonbase.dark","y",{x:752,y:306}),...Kn("moonbase.dark","x",{x:915,y:306})}},CP={frames:{"editor.tool.share":{frame:{w:12,h:12,x:588,y:0}},"editor.tool.save":{frame:{w:12,h:12,x:601,y:0}},"editor.tool.pointer":{frame:{w:12,h:12,x:614,y:0}},"editor.tool.eyedropper":{frame:{w:12,h:12,x:628,y:0}}}},PP={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},Lb=t=>PP[t]??t,sh={w:32,h:16},Nt={w:16,h:56},he={w:32,h:28},W={w:24,h:24},ca={w:8,h:8},Y=t=>({x:t.x*(W.w+1)+1,y:t.y*(W.h+1)+2}),pe=t=>({x:t.x*(he.w+1)+1,y:t.y*(he.h+1)+396}),Db="",Fb="",EP="",TP="",RP="󱂩",MP="",IP=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","⚡","🛡","♨","🕹",{char:"∞",double:!0},{char:Db,double:!0},{char:Fb,double:!0}],jP=[" ","?","!",".",",",";",":","/","\\","‘","’","'","`","-","+","%","⬅","➡","⬆","⬇","↖","↘","↗","↙","(",")","[","]","<",">","⏩","⁌","⁍","EnterFullscreen","ExitFullscreen","Menu","*","@","©",EP,TP,RP,MP,"•","⇧","^","⌥","⌘","★"],cg=(t,e)=>{function*r(){let{x:n}=e;for(let s=0;s<t.length;s++){const i=t[s],o=typeof i=="string"?i:i.char,l=(typeof i=="string"?!1:i.double)?ca.w*2:ca.w;yield[`hud.char.${Lb(o)}`,{frame:{x:n,y:e.y,...ca,w:l}}],n+=l+1}}return Rs(r())},OP={frames:{...cg(IP,{x:126,y:1}),...cg(jP,{x:126,y:10})}},ln=(t,{x:e,y:r},n)=>{function*s(){yield[`${t}.left`,{frame:{x:e,y:r,...n}}],yield[`${t}.away`,{frame:{x:e+n.w+1,y:r,...n}}],yield[`${t}.towards`,{frame:{x:e,y:r+n.h+1,...n}}],yield[`${t}.right`,{frame:{x:e+n.w+1,y:r+n.h+1,...n}}]}return Object.fromEntries(s())},Re=(t,e,{x:r,y:n},s,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a%i*(s.w+1),y:n+Math.floor(a/i)*(s.h+1),...s}}]}return Object.fromEntries(o())},BP=(t,e,r,n)=>({...Re(`${t}.left`,e,r,n),...Re(`${t}.away`,e,$r(r,{x:(n.w+1)*e}),n),...Re(`${t}.towards`,e,$r(r,{y:n.h+1}),n),...Re(`${t}.right`,e,$r(r,{x:(n.w+1)*e,y:n.h+1}),n)}),ci=(t,e)=>[...Oe(Gx(1,e+1)).map(r=>`${t}.${String(r)}`)],Ae=(t,e)=>Object.assign([...t],{animationSpeed:e}),NP={...Re("dalek",2,Y({x:0,y:0}),W),"shadowMask.dalek":{frame:{...Y({x:2,y:0}),...W}},...Re("bubbles.cold",2,Y({x:3,y:0}),W),...ln("cyberman",Y({x:1,y:1}),W),...ln("charles",Y({x:3,y:1}),W),"shadowMask.charles.away":{frame:{...Y({x:5,y:1}),...W}},"shadowMask.charles.right":{frame:{...Y({x:5,y:2}),...W}},...ln("elephant",Y({x:6,y:1}),W),"crown.blacktooth":{frame:{...Y({x:8,y:1}),...W}},"crown.safari":{frame:{...Y({x:9,y:1}),...W}},"crown.egyptus":{frame:{...Y({x:10,y:1}),...W}},"crown.penitentiary":{frame:{...Y({x:11,y:1}),...W}},"crown.bookworld":{frame:{...Y({x:12,y:1}),...W}},ball:{frame:{...Y({x:13,y:1}),...W}},"shadowMask.ball":{frame:{...Y({x:14,y:1}),...W}},sticks:{frame:{...Y({x:8,y:2}),...W}},cube:{frame:{...Y({x:9,y:2}),...W}},drum:{frame:{...Y({x:10,y:2}),...W}},hooter:{frame:{...Y({x:11,y:2}),...W}},bag:{frame:{...Y({x:12,y:2}),...W}},joystick:{frame:{...Y({x:13,y:2}),...W}},"shadowMask.joystick":{frame:{...Y({x:14,y:2}),...W}},...BP("turtle",2,Y({x:0,y:3}),W),"shadowMask.turtle.away":{frame:{...Y({x:4,y:3}),...W}},"shadowMask.turtle.right":{frame:{...Y({x:4,y:4}),...W}},...ln("monkey",Y({x:5,y:3}),W),...ln("computerBot",Y({x:7,y:3}),W),"spring.compressed":{frame:{...Y({x:9,y:3}),...W}},"spring.released":{frame:{...Y({x:10,y:3}),...W}},"switch.left":{frame:{...Y({x:11,y:3}),...W}},"switch.right":{frame:{...Y({x:12,y:3}),...W}},"shadowMask.switch":{frame:{...Y({x:13,y:3}),...W}},tower:{frame:{...Y({x:14,y:3}),...W}},"shadowMask.tower":{frame:{...Y({x:15,y:3}),...W}},scroll:{frame:{...Y({x:9,y:4}),...W,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...Y({x:10,y:4}),...W,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...Y({x:11,y:4}),...W,pivot:{x:17,y:24}}},"spikyBall.1":{frame:{...Y({x:12,y:4}),...W}},"spikyBall.2":{frame:{...Y({x:13,y:4}),...W}},puck:{frame:{...Y({x:14,y:4}),...W}},"shadow.smallRound":{frame:{...Y({x:15,y:4}),...W}},"shadowMask.smallRound":{frame:{...Y({x:16,y:4}),...W}},...Re("helicopterBug",4,Y({x:0,y:5}),W),"barrier.x":{frame:{...Y({x:4,y:5}),...W,pivot:{x:18,y:23}}},"barrier.y":{frame:{...Y({x:5,y:5}),...W,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...Y({x:6,y:5}),...W,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...Y({x:7,y:5}),...W,pivot:{x:6,y:22}}},...Re("bubbles.taupe",3,Y({x:8,y:5}),W),whiteRabbit:{frame:{...Y({x:11,y:5}),...W}},"shadowMask.whiteRabbit":{frame:{...Y({x:12,y:5}),...W}},...Re("bubbles.white",3,Y({x:13,y:5}),W),...Re("fish",2,Y({x:12,y:6}),W),doughnuts:{frame:{...Y({x:14,y:6}),...W}},"shadowMask.doughnuts":{frame:{...Y({x:15,y:6}),...W}},"lift.static":{frame:{...Y({x:10,y:7}),...W}},"shadow.smallBlock":{frame:{...Y({x:11,y:7}),...W}},"shadowMask.smallBlock":{frame:{...Y({x:12,y:7}),...W}},buttonInGame:{frame:{...Y({x:13,y:7}),...W}},"buttonInGame.pressed":{frame:{...Y({x:14,y:7}),...W}},"shadowMask.buttonInGame":{frame:{...Y({x:15,y:7}),...W}},...Re("lift",4,Y({x:10,y:8}),W),headlessBase:{frame:{...Y({x:14,y:8}),...W}},...Re("headlessBase",4,Y({x:10,y:9}),W),"headlessBase.all":{frame:{...Y({x:14,y:9}),...W}},...ln("skiHead.greenAndPink",{x:251,y:252},{w:24,h:32}),...ln("skiHead.starsAndStripes",{x:301,y:252},{w:24,h:32}),"shadowMask.skiHead.away":{frame:{x:351,y:252,w:24,h:32}},"shadowMask.skiHead.right":{frame:{x:351,y:285,w:24,h:32}},"editor.cursor.xz":{frame:{...pe({x:7,y:-2}),...he}},"editor.cursor.floor":{frame:{...pe({x:7,y:-1}),...he}},"block.organic":{frame:{...pe({x:0,y:0}),...he}},"block.organic.disappearing":{frame:{...pe({x:1,y:0}),...he}},"block.organic.dark":{frame:{...pe({x:2,y:0}),...he}},"block.organic.dark.disappearing":{frame:{...pe({x:3,y:0}),...he}},"block.artificial":{frame:{...pe({x:4,y:0}),...he}},"block.artificial.disappearing":{frame:{...pe({x:5,y:0}),...he}},"book.x":{frame:{...pe({x:6,y:0}),...he}},"book.y":{frame:{...pe({x:7,y:0}),...he}},"shadow.fullBlock":{frame:{...pe({x:8,y:0}),...he}},"shadowMask.fullBlock":{frame:{...pe({x:9,y:0}),...he}},stepStool:{frame:{...pe({x:0,y:1}),...he}},"shadowMask.stepStool":{frame:{...pe({x:1,y:1}),...he}},"volcano.1":{frame:{...pe({x:2,y:1}),...he}},"volcano.2":{frame:{...pe({x:3,y:1}),...he}},"shadowMask.volcano":{frame:{...pe({x:4,y:1}),...he}},hushPuppy:{frame:{...pe({x:5,y:1}),...he}},"shadowMask.hushPuppy":{frame:{...pe({x:6,y:1}),...he}},"toaster.on":{frame:{...pe({x:7,y:1}),...he}},"toaster.off":{frame:{...pe({x:8,y:1}),...he}},"shadowMask.toaster":{frame:{...pe({x:9,y:1}),...he}},sandwich:{frame:{...pe({x:10,y:1}),...he}},spikes:{frame:{...pe({x:11,y:1}),...he}},"shadowMask.spikes":{frame:{...pe({x:12,y:1}),...he}},...Re("conveyor.x",7,pe({x:0,y:2}),he),"shadowMask.conveyor":{frame:{...pe({x:7,y:2}),...he}},button:{frame:{...pe({x:9,y:2}),...he}},"button.pressed":{frame:{...pe({x:10,y:2}),...he}},"button.surfaceMask":{frame:{...pe({x:11,y:2}),...he}},...Re("conveyor.y",7,pe({x:0,y:3}),he),teleporter:{frame:{...pe({x:7,y:3}),...he}},...Re("teleporter.flashing",2,pe({x:8,y:3}),he),"shadowMask.teleporter":{frame:{...pe({x:10,y:3}),...he}},"shadowMask.teleporter.flashing":{frame:{...pe({x:11,y:3}),...he}},...Re("particle",4,{x:331,y:396},{w:9,h:11})},Ub={frames:NP,animations:{"teleporter.flashing":Ae(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:Ae(["fish.1","fish.2"],.25),lift:Ae(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:Ae(["dalek.1","dalek.2"],.5),"turtle.left":Ae(["turtle.left.1","turtle.left.2"],.25),"turtle.away":Ae(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":Ae(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":Ae(["turtle.right.1","turtle.right.2"],.25),helicopterBug:Ae(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":Ae(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":Ae(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":Ae(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":Ae(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":Ae(ci("conveyor.x",7),.5),"conveyor.y":Ae(ci("conveyor.y",7),.5),volcano:Ae(ci("volcano",2),3/16),"spring.bounce":Ae(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"headlessBase.scan":Ae(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":Ae(["headlessBase.all","headlessBase"],.5),switch:Ae(["switch.left","switch.right"],.02),"particle.fade":Ae(ci("particle",4),.5)}},zP=.5,Hb=5e3,LP=Hb*2,Js=(t,e)=>{const r=Math.round(Hb/(io*4)),n=`head.walking.${t}.${e}`,s=`head.blinking.${t}`,i=[...new Array(r-3).fill(n),s,n,s];return Ae(i,.5)},kc=(t,e)=>{const r=Math.round(LP/(io*4)),n=`heels.walking.${t}.${e}`,s=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(n),...new Array(Math.ceil(r*.2)).fill(s)];return Ae(i,.5)},ug=(t,e,r)=>{const n=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*s(){for(let i=0;i<ys.length;i++){const o=n[i];for(let a=0;a<=2;a++)yield[`${t}.walking.${o}.${a+1}`,{frame:{...Y({x:e.x+a,y:e.y+i}),...W}}];yield[`${t}.falling.${o}`,{frame:{...Y({x:e.x+3,y:e.y+i}),...W}}],r[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...Y({x:e.x+4,y:e.y+i}),...W}}])}}return Object.fromEntries(s())};function hg(t){function*e(r,n){yield`${r}.walking.${n}.1`,yield`${r}.walking.${n}.2`,yield`${r}.walking.${n}.3`,yield`${r}.walking.${n}.2`}return ys.reduce((r,n)=>({...r,[`${t}.walking.${n}`]:Ae([...e(t,n)],zP)}),{})}const DP={...Re("bubbles.head",6,Y({x:0,y:6}),W),...ug("head",{x:0,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},left:{noBlinking:!0}}),...Re("bubbles.heels",6,Y({x:6,y:6}),W),...ug("heels",{x:5,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},awayRight:{noBlinking:!0},towardsLeft:{noBlinking:!0},left:{noBlinking:!0}}),...Re("shine",6,pe({x:8,y:-2}),he,3),blank:{frame:{...Y({x:0,y:2}),...W}}},$b={frames:DP,animations:{...hg("head"),...hg("heels"),"heels.screenDirections":Ae(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":Ae(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":Js("right",3),"head.idle.towards":Js("towards",3),"head.idle.towardsRight":Js("towardsRight",2),"head.idle.towardsLeft":Js("towardsLeft",2),"head.idle.awayRight":Js("awayRight",2),"heels.idle.right":kc("right",2),"heels.idle.towards":kc("towards",2),"heels.idle.towardsRight":kc("towardsRight",2),"head.fadeOut":Ae(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":Ae(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:Ae(ci("shine",6),.5),"shine.headInSymbio":Ae(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":Ae(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},FP={jail:["bars"],blacktooth:["plain","shield","armour"],bookworld:["book","cowboy"],egyptus:["hieroglyphics","sarcophagus"],market:["more-fruits","fruits","passage"],moonbase:["coil","window3","window2","window1","window-clear"],penitentiary:["skeleton","loop"],safari:["wall","shield","window"]},GF=["blacktooth","penitentiary","bookworld","egyptus","safari"],ht=(t,e,r,n)=>{function*s(i,o,a){const l=FP[i],{w:c,h:u}=Nt,h=c>>1;for(let d=0;d<l.length;d++)yield[`${i}${n}.wall.${l[d]}.left`,{frame:{x:o-c*(d+1),y:a+h*d,...Nt}}],yield[`${i}${n}.wall.${l[d]}.away`,{frame:{x:o+c*d,y:a+h*d,...Nt}}];yield[`${i}${n}.floor`,{frame:{x:o-c,y:a+u,...sh}}]}return Object.fromEntries(s(t,e,r))},dg={w:16,h:13},fg={w:8,h:9},lr=74;let dt=53;const UP={...ht("egyptus",834,dt,""),...ht("egyptus",834,dt+=lr,".dark"),...ht("moonbase",834,dt+=lr,""),...ht("moonbase",834,dt+=lr,".dark"),...ht("bookworld",834,dt+=lr,""),...ht("bookworld",834,dt,".dark"),...ht("jail",834,dt+=lr,""),...ht("jail",834,dt,".dark"),...ht("blacktooth",834,dt+=lr,""),...ht("blacktooth",834,dt+=lr,".dark"),...ht("penitentiary",834,dt+=lr,""),...ht("penitentiary",834,dt,".dark"),...ht("market",834,dt+=lr,""),...ht("market",834,dt,".dark"),...ht("safari",834,dt+=lr,""),...ht("safari",834,dt,".dark"),"floorEdge.right":{frame:{x:418,y:466,...dg,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...dg,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...fg,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...fg,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Nt.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:786,y:462,...sh}},"generic.dark.floor.deadly":{frame:{x:786,y:479,...sh}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Nt.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Nt.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Nt.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Nt.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Nt.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Nt.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Nt.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...Re("moonbase.wall.screen.window1.away",3,{x:883,y:217},{w:10,h:7}),...Re("moonbase.wall.screen.window2.away",2,{x:867,y:209},{w:10,h:7}),...Re("moonbase.wall.screen.window3.away",4,{x:851,y:201},{w:10,h:7})},Gb={frames:UP,animations:{"moonbase.wall.screen.window1.away":Ae(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":Ae(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":Ae(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},HP={...Ub.frames,...$b.frames,...Gb.frames,...OP.frames,...kP.frames,...CP.frames},Lt={frames:HP,animations:{...$b.animations,...Ub.animations,...Gb.animations},meta:{scale:1}};function WF(t){if(!ih(t))throw new Error(`Invalid textureId: "${t}"; textureId ∋ {${Object.keys(Lt.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function ih(t){return Lt.frames[t]!==void 0}function YF(t){return Lt.animations[t]!==void 0}var te=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(te||{});const oh=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},zo=(t,e)=>oh(t).priority??e,Et={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(oh).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(oh).forEach(e=>{e.type.forEach(r=>{const n=this._addHandlers,s=this._queue;n[r]?n[r]?.(e):(s[r]=s[r]||[],s[r]?.push(e))})}),this},handle(t,e,r){const n=this._addHandlers,s=this._removeHandlers;if(n[t]||s[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,s[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,n=>{e.findIndex(i=>i.name===n.name)>=0||(e.push({name:n.name,value:n.ref}),e.sort((i,o)=>zo(o.value,r)-zo(i.value,r)))},n=>{const s=e.findIndex(i=>i.name===n.name);s!==-1&&e.splice(s,1)})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((s,i)=>zo(i,r)-zo(s,r)))},n=>{const s=e.indexOf(n.ref);s!==-1&&e.splice(s,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},$P={extension:{type:te.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await gr(()=>import("./browserAll-DmP_fadV.js"),__vite__mapDeps([5,6,7,8,1,2]))}},GP={extension:{type:te.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await gr(()=>import("./webworkerAll-CUxOO5W4.js"),__vite__mapDeps([6,7,8,1,2]))}};class zt{constructor(e,r,n){this._x=r||0,this._y=n||0,this._observer=e}clone(e){return new zt(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Cc={exports:{}},pg;function WP(){return pg||(pg=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,h||l,d),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,m=new Array(f);d<f;d++)m[d]=h[d].fn;return m},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,m){var A=r?r+c:c;if(!this._events[A])return!1;var g=this._events[A],y=arguments.length,b,x;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,d),!0;case 5:return g.fn.call(g.context,u,h,d,f),!0;case 6:return g.fn.call(g.context,u,h,d,f,m),!0}for(x=1,b=new Array(y-1);x<y;x++)b[x-1]=arguments[x];g.fn.apply(g.context,b)}else{var w=g.length,V;for(x=0;x<w;x++)switch(g[x].once&&this.removeListener(c,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,u);break;case 3:g[x].fn.call(g[x].context,u,h);break;case 4:g[x].fn.call(g[x].context,u,h,d);break;default:if(!b)for(V=1,b=new Array(y-1);V<y;V++)b[V-1]=arguments[V];g[x].fn.apply(g[x].context,b)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var A=0,g=[],y=m.length;A<y;A++)(m[A].fn!==u||d&&!m[A].once||h&&m[A].context!==h)&&g.push(m[A]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(Cc)),Cc.exports}var YP=WP();const Ar=st(YP),QP=Math.PI*2,KP=180/Math.PI,XP=Math.PI/180;class gt{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new gt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Pc.x=0,Pc.y=0,Pc}}const Pc=new gt;class ge{constructor(e=1,r=0,n=0,s=1,i=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=s,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,s,i,o){return this.a=e,this.b=r,this.c=n,this.d=s,this.tx=i,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new gt;const n=e.x,s=e.y;return r.x=this.a*n+this.c*s+this.tx,r.y=this.b*n+this.d*s+this.ty,r}applyInverse(e,r){r=r||new gt;const n=this.a,s=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(n*o+i*-s),u=e.x,h=e.y;return r.x=o*c*u+-i*c*h+(l*i-a*o)*c,r.y=n*c*h+-s*c*u+(-l*n+a*s)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),s=this.a,i=this.c,o=this.tx;return this.a=s*r-this.b*n,this.b=s*n+this.b*r,this.c=i*r-this.d*n,this.d=i*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,s=this.c,i=this.d;return this.a=e.a*r+e.b*s,this.b=e.a*n+e.b*i,this.c=e.c*r+e.d*s,this.d=e.c*n+e.d*i,this.tx=e.tx*r+e.ty*s+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this}appendFrom(e,r){const n=e.a,s=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,d=r.d;return this.a=n*c+s*h,this.b=n*u+s*d,this.c=i*c+o*h,this.d=i*u+o*d,this.tx=a*c+l*h+r.tx,this.ty=a*u+l*d+r.ty,this}setTransform(e,r,n,s,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+s*this.c),this.ty=r-(n*this.b+s*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,s=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,s=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-s,i),l=Math.atan2(n,r),c=Math.abs(a+l);return c<1e-5||Math.abs(QP-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(s*s+i*i),e.position.x=this.tx+(o.x*r+o.y*s),e.position.y=this.ty+(o.x*n+o.y*i),e}invert(){const e=this.a,r=this.b,n=this.c,s=this.d,i=this.tx,o=e*s-r*n;return this.a=s/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-s*i)/o,this.ty=-(e*this.ty-r*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ge;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return ZP.identity()}static get shared(){return JP.identity()}}const JP=new ge,ZP=new ge,dn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],fn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],pn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],mn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ah=[],Wb=[],Lo=Math.sign;function eE(){for(let t=0;t<16;t++){const e=[];ah.push(e);for(let r=0;r<16;r++){const n=Lo(dn[t]*dn[r]+pn[t]*fn[r]),s=Lo(fn[t]*dn[r]+mn[t]*fn[r]),i=Lo(dn[t]*pn[r]+pn[t]*mn[r]),o=Lo(fn[t]*pn[r]+mn[t]*mn[r]);for(let a=0;a<16;a++)if(dn[a]===n&&fn[a]===s&&pn[a]===i&&mn[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new ge;e.set(dn[t],fn[t],pn[t],mn[t],0,0),Wb.push(e)}}eE();const ke={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>dn[t],uY:t=>fn[t],vX:t=>pn[t],vY:t=>mn[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>ah[t][e],sub:(t,e)=>ah[t][ke.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?ke.S:ke.N:Math.abs(e)*2<=Math.abs(t)?t>0?ke.E:ke.W:e>0?t>0?ke.SE:ke.SW:t>0?ke.NE:ke.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const s=Wb[ke.inv(e)];s.tx=r,s.ty=n,t.append(s)}},Do=[new gt,new gt,new gt,new gt];class Le{constructor(e=0,r=0,n=0,s=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Le(0,0,0,0)}clone(){return new Le(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,n,s=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=n*(1-s),u=n-c,h=a-c,d=a+i+c,f=l-c,m=l+o+c,A=a+u,g=a+i-u,y=l+u,b=l+o-u;return e>=h&&e<=d&&r>=f&&r<=m&&!(e>A&&e<g&&r>y&&r<b)}intersects(e,r){if(!r){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const n=this.left,s=this.right,i=this.top,o=this.bottom;if(s<=n||o<=i)return!1;const a=Do[0].set(e.left,e.top),l=Do[1].set(e.left,e.bottom),c=Do[2].set(e.right,e.top),u=Do[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=n||Math.min(a.x,l.x,c.x,u.x)>=s||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),m=d*n+f*i,A=d*s+f*i,g=d*n+f*o,y=d*s+f*o;if(Math.max(m,A,g,y)<=d*a.x+f*a.y||Math.min(m,A,g,y)>=d*u.x+f*u.y)return!1;const b=h*(a.y-c.y),x=h*(c.x-a.x),w=b*n+x*i,V=b*s+x*i,_=b*n+x*o,v=b*s+x*o;return!(Math.max(w,V,_,v)<=b*a.x+x*a.y||Math.min(w,V,_,v)>=b*u.x+x*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=s,this.height=Math.max(i-s,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,s=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=s-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=s,this.height=i-s,this}getBounds(e){return e||(e=new Le),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,n=e.y,s=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height&&s>=this.x&&s<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Ec={default:-1};function De(t="default"){return Ec[t]===void 0&&(Ec[t]=-1),++Ec[t]}const mg={},mt="8.0.0",tE="8.3.4";function je(t,e,r=3){if(mg[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),mg[e]=!0}const Yb=()=>{};function Ma(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function gg(t){return!(t&t-1)&&!!t}function Qb(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const Ag=Object.create(null);function rE(t){const e=Ag[t];return e===void 0&&(Ag[t]=De("resource")),e}const Kb=class Xb extends Ar{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...Xb.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){je(mt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=rE(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Kb.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let nE=Kb;const Jb=class Zb extends Ar{constructor(e={}){super(),this.options=e,this.uid=De("textureSource"),this._resourceType="textureSource",this._resourceId=De("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...Zb.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new nE(Qb(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=De("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,n){n||(n=this._resolution),e||(e=this.width),r||(r=this.height);const s=Math.round(e*n),i=Math.round(r*n);return this.width=s/n,this.height=i/n,this._resolution=n,this.pixelWidth===s&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=i,this.emit("resize",this),this._resourceId=De("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=gg(this.pixelWidth)&&gg(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};Jb.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let yr=Jb;class Ud extends yr{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let n=e.format;n||(r instanceof Float32Array?n="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?n="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?n="rgba16uint":(r instanceof Int8Array,n="bgra8unorm")),super({...e,resource:r,format:n}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}Ud.extension=te.TextureSource;const yg=new ge;class sE{constructor(e,r){this.mapCoord=new ge,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let s=0;s<e.length;s+=2){const i=e[s],o=e[s+1];r[s]=i*n.a+o*n.c+n.tx,r[s+1]=i*n.b+o*n.d+n.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const n=e.orig,s=e.trim;s&&(yg.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(yg));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class me extends Ar{constructor({source:e,label:r,frame:n,orig:s,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=De("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Le,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new yr,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=s||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new sE(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:n,height:s}=this._source,i=r.x/n,o=r.y/s,a=r.width/n,l=r.height/s;let c=this.rotate;if(c){const u=a/2,h=l/2,d=i+u,f=o+h;c=ke.add(c,ke.NW),e.x0=d+u*ke.uX(c),e.y0=f+h*ke.uY(c),c=ke.add(c,2),e.x1=d+u*ke.uX(c),e.y1=f+h*ke.uY(c),c=ke.add(c,2),e.x2=d+u*ke.uX(c),e.y2=f+h*ke.uY(c),c=ke.add(c,2),e.x3=d+u*ke.uX(c),e.y3=f+h*ke.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return je(mt,"Texture.baseTexture is now Texture.source"),this._source}}me.EMPTY=new me({label:"EMPTY",source:new yr({label:"EMPTY"})});me.EMPTY.destroy=Yb;me.WHITE=new me({source:new Ud({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});me.WHITE.destroy=Yb;function iE(t,e,r){const{width:n,height:s}=r.orig,i=r.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*n,t.maxX=t.minX+o,t.minY=i.y-e._y*s,t.maxY=t.minY+a}else t.minX=-e._x*n,t.maxX=t.minX+n,t.minY=-e._y*s,t.maxY=t.minY+s}const xg=new ge;class sr{constructor(e=1/0,r=1/0,n=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=xg,this.minX=e,this.minY=r,this.maxX=n,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Le);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=xg,this}set(e,r,n,s){this.minX=e,this.minY=r,this.maxX=n,this.maxY=s}addFrame(e,r,n,s,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let d=this.minX,f=this.minY,m=this.maxX,A=this.maxY,g=o*e+l*r+u,y=a*e+c*r+h;g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*n+l*r+u,y=a*n+c*r+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*e+l*s+u,y=a*e+c*s+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*n+l*s+u,y=a*n+c*s+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),this.minX=d,this.minY=f,this.maxX=m,this.maxY=A}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,n=this.minY,s=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let d=o*r+l*n+u,f=a*r+c*n+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*s+l*n+u,f=a*s+c*n+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+l*i+u,f=a*r+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*s+l*i+u,f=a*s+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,n,s){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<n&&(this.minY=n),this.maxY>s&&(this.maxY=s),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new sr(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,n,s){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;s||(s=this.matrix);const c=s.a,u=s.b,h=s.c,d=s.d,f=s.tx,m=s.ty;for(let A=r;A<n;A+=2){const g=e[A],y=e[A+1],b=c*g+h*y+f,x=u*g+d*y+m;i=b<i?b:i,o=x<o?x:o,a=b>a?b:a,l=x>l?x:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var oE={grad:.9,turn:360,rad:360/(2*Math.PI)},qr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},tt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Kt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},ew=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},bg=function(t){return{r:Kt(t.r,0,255),g:Kt(t.g,0,255),b:Kt(t.b,0,255),a:Kt(t.a)}},Tc=function(t){return{r:tt(t.r),g:tt(t.g),b:tt(t.b),a:tt(t.a,3)}},aE=/^#([0-9a-f]{3,8})$/i,Fo=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},tw=function(t){var e=t.r,r=t.g,n=t.b,s=t.a,i=Math.max(e,r,n),o=i-Math.min(e,r,n),a=o?i===e?(r-n)/o:i===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:s}},rw=function(t){var e=t.h,r=t.s,n=t.v,s=t.a;e=e/360*6,r/=100,n/=100;var i=Math.floor(e),o=n*(1-r),a=n*(1-(e-i)*r),l=n*(1-(1-e+i)*r),c=i%6;return{r:255*[n,a,o,o,l,n][c],g:255*[l,n,n,a,o,o][c],b:255*[o,o,l,n,n,a][c],a:s}},wg=function(t){return{h:ew(t.h),s:Kt(t.s,0,100),l:Kt(t.l,0,100),a:Kt(t.a)}},qg=function(t){return{h:tt(t.h),s:tt(t.s),l:tt(t.l),a:tt(t.a,3)}},vg=function(t){return rw((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},qi=function(t){return{h:(e=tw(t)).h,s:(s=(200-(r=e.s))*(n=e.v)/100)>0&&s<200?r*n/100/(s<=100?s:200-s)*100:0,l:s/2,a:e.a};var e,r,n,s},lE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,hE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lh={string:[[function(t){var e=aE.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?tt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?tt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=uE.exec(t)||hE.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:bg({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=lE.exec(t)||cE.exec(t);if(!e)return null;var r,n,s=wg({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(oE[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return vg(s)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,s=t.a,i=s===void 0?1:s;return qr(e)&&qr(r)&&qr(n)?bg({r:Number(e),g:Number(r),b:Number(n),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,s=t.a,i=s===void 0?1:s;if(!qr(e)||!qr(r)||!qr(n))return null;var o=wg({h:Number(e),s:Number(r),l:Number(n),a:Number(i)});return vg(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,s=t.a,i=s===void 0?1:s;if(!qr(e)||!qr(r)||!qr(n))return null;var o=function(a){return{h:ew(a.h),s:Kt(a.s,0,100),v:Kt(a.v,0,100),a:Kt(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(i)});return rw(o)},"hsv"]]},Vg=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},dE=function(t){return typeof t=="string"?Vg(t.trim(),lh.string):typeof t=="object"&&t!==null?Vg(t,lh.object):[null,void 0]},Rc=function(t,e){var r=qi(t);return{h:r.h,s:Kt(r.s+100*e,0,100),l:r.l,a:r.a}},Mc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},_g=function(t,e){var r=qi(t);return{h:r.h,s:r.s,l:Kt(r.l+100*e,0,100),a:r.a}},ch=function(){function t(e){this.parsed=dE(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return tt(Mc(this.rgba),2)},t.prototype.isDark=function(){return Mc(this.rgba)<.5},t.prototype.isLight=function(){return Mc(this.rgba)>=.5},t.prototype.toHex=function(){return e=Tc(this.rgba),r=e.r,n=e.g,s=e.b,o=(i=e.a)<1?Fo(tt(255*i)):"","#"+Fo(r)+Fo(n)+Fo(s)+o;var e,r,n,s,i,o},t.prototype.toRgb=function(){return Tc(this.rgba)},t.prototype.toRgbString=function(){return e=Tc(this.rgba),r=e.r,n=e.g,s=e.b,(i=e.a)<1?"rgba("+r+", "+n+", "+s+", "+i+")":"rgb("+r+", "+n+", "+s+")";var e,r,n,s,i},t.prototype.toHsl=function(){return qg(qi(this.rgba))},t.prototype.toHslString=function(){return e=qg(qi(this.rgba)),r=e.h,n=e.s,s=e.l,(i=e.a)<1?"hsla("+r+", "+n+"%, "+s+"%, "+i+")":"hsl("+r+", "+n+"%, "+s+"%)";var e,r,n,s,i},t.prototype.toHsv=function(){return e=tw(this.rgba),{h:tt(e.h),s:tt(e.s),v:tt(e.v),a:tt(e.a,3)};var e},t.prototype.invert=function(){return cr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),cr(Rc(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),cr(Rc(this.rgba,-e))},t.prototype.grayscale=function(){return cr(Rc(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),cr(_g(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),cr(_g(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?cr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):tt(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=qi(this.rgba);return typeof e=="number"?cr({h:e,s:r.s,l:r.l,a:r.a}):tt(r.h)},t.prototype.isEqual=function(e){return this.toHex()===cr(e).toHex()},t}(),cr=function(t){return t instanceof ch?t:new ch(t)},Sg=[],fE=function(t){t.forEach(function(e){Sg.indexOf(e)<0&&(e(ch,lh),Sg.push(e))})};function pE(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var s in r)n[r[s]]=s;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=n[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,d="black";if(!i.length)for(var f in r)i[f]=new t(r[f]).toRgb();for(var m in r){var A=(a=u,l=i[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<h&&(h=A,d=m)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}fE([pE]);const qs=class ui{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof ui)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,o)=>i===r[o]);if(e!==null&&r!==null){const i=Object.keys(e),o=Object.keys(r);return i.length!==o.length?!1:i.every(a=>e[a]===r[a])}return e===r}toRgba(){const[e,r,n,s]=this._components;return{r:e,g:r,b:n,a:s}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(s*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,n,s,i]=this._components;return e[0]=r,e[1]=n,e[2]=s,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,n,s]=this._components;return e[0]=r,e[1]=n,e[2]=s,e}toNumber(){return this._int}toBgrNumber(){const[e,r,n]=this.toUint8RgbArray();return(n<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,s,i]=ui._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=s,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,s=this._int>>8&255,i=this._int&255;return r&&(n=n*e+.5|0,s=s*e+.5|0,i=i*e+.5|0),(e*255<<24)+(n<<16)+(s<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,n,s,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,s=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,s,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,s,i=255]=e,r/=255,n/=255,s/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=ui.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=cr(e);o.isValid()&&({r,g:n,b:s,a:i}=o.rgba,r/=255,n/=255,s/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=s,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((s,i)=>{e[i]=Math.min(Math.max(s,r),n)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof ui||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};qs.shared=new qs;qs._temp=new qs;qs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ut=qs;const mE={cullArea:null,cullable:!1,cullableChildren:!0};class Hd{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class gE{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Hd(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const n=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[n]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const Er=new gE,AE={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){je("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function yE(t,e,r){const n=t.length;let s;if(e>=n||r===0)return;r=e+r>n?n-e:r;const i=n-r;for(s=e;s<i;++s)t[s]=t[s+r];t.length=i}const xE={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,n=r-t,s=[];if(n>0&&n<=r){for(let o=r-1;o>=t;o--){const a=this.children[o];a&&(s.push(a),a.parent=null)}yE(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(s);for(let o=0;o<s.length;++o)this.emit("childRemoved",s[o],this,o),s[o].emit("removed",this);return s.length>0&&this._didViewChangeTick++,s}else if(n===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||je(mt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const s=t.parent.children.indexOf(t);if(t.parent===this&&s===e)return t;s!==-1&&t.parent.children.splice(s,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const n=this.worldTransform.clone();return n.invert(),r.prepend(n),t.setFromMatrix(r),t}},bE={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const n=this.children,s=n.length;for(let i=0;i<s;i++)n[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:n}=e;for(let s=0;s<this.effects.length;s++){const i=this.effects[s];n[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let s=this.effects.length-1;s>=0;s--){const i=this.effects[s];n[i.pipe].pop(i,this,t)}}};class kg{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class wE{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const n=this._tests[r];if(n.test(e))return Er.get(n.maskClass,e)}return e}returnMaskEffect(e){Er.return(e)}}const uh=new wE;Et.handleByList(te.MaskEffect,uh._effectClasses);const qE={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,n)=>r.priority-n.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),uh.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=uh.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new kg);t=t;const r=t?.length>0,n=e.filters?.length>0,s=r!==n;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),s&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new kg),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},vE={label:null,get name(){return je(mt,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){je(mt,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let n=0;n<r.length;n++){const s=r[n];if(s.label===t||t instanceof RegExp&&t.test(s.label))return s}if(e)for(let n=0;n<r.length;n++){const i=r[n].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const n=this.children;for(let s=0;s<n.length;s++){const i=n[s];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let s=0;s<n.length;s++)n[s].getChildrenByLabel(t,!0,r);return r}},qt=new Hd(ge),Tr=new Hd(sr),VE=new ge,_E={getFastGlobalBounds(t,e){e||(e=new sr),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let n=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const s=!!this.effects.length;if((this.renderGroup||s)&&(n=Tr.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;n.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,n,r)}if(s){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,n.applyMatrix(o.worldTransform)),this.effects[a].addBounds(n,!0));i&&(n.applyMatrix(o.worldTransform.copyTo(VE).invert()),e.addBounds(n,this.relativeGroupTransform)),e.addBounds(n),Tr.return(n)}else this.renderGroup&&(e.addBounds(n,this.relativeGroupTransform),Tr.return(n))}};function nw(t,e,r){r.clear();let n,s;return t.parent?e?n=t.parent.worldTransform:(s=qt.get().identity(),n=$d(t,s)):n=ge.IDENTITY,sw(t,r,n,e),s&&qt.return(s),r.isValid||r.set(0,0,0,0),r}function sw(t,e,r,n){if(!t.visible||!t.measurable)return;let s;n?s=t.worldTransform:(t.updateLocalTransform(),s=qt.get(),s.appendFrom(t.localTransform,r));const i=e,o=!!t.effects.length;if(o&&(e=Tr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,s);else{t.bounds&&(e.matrix=s,e.addBounds(t.bounds));for(let a=0;a<t.children.length;a++)sw(t.children[a],e,s,n)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,ge.IDENTITY),Tr.return(e)}n||qt.return(s)}function $d(t,e){const r=t.parent;return r&&($d(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function iw(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,n=t>>8&255,s=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=r*i/255|0,c=n*o/255|0,u=s*a/255|0;return(l<<16)+(c<<8)+u}const Cg=16777215;function Pg(t,e){return t===Cg?e:e===Cg?t:iw(t,e)}function ua(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const SE={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=$d(this,qt.get().identity());return t.appendFrom(this.localTransform,r),qt.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?ua(this.renderGroup.worldColor):this.parentRenderGroup?ua(Pg(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=Pg(e,r.localColor),r=r.parent;return ua(e)}};let Ic=0;const Eg=500;function Ce(...t){Ic!==Eg&&(Ic++,Ic===Eg?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function ow(t,e,r){return e.clear(),r||(r=ge.IDENTITY),aw(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function aw(t,e,r,n,s){let i;if(s)i=qt.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=qt.get(),i.appendFrom(l,r)}const o=e,a=!!t.effects.length;if(a&&(e=Tr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)aw(l[c],e,i,n,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,n);o.addBounds(e,ge.IDENTITY),Tr.return(e)}qt.return(i)}function lw(t,e){const r=t.children;for(let n=0;n<r.length;n++){const s=r[n],i=s.uid,o=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,s.children.length&&lw(s,e)}return e.didChange}const kE=new ge,CE={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new sr});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),lw(this,t),t.didChange&&ow(this,t.localBounds,kE),t.localBounds},getBounds(t,e){return nw(this,t,e||new sr)}},PE={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},EE={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(TE))}};function TE(t,e){return t._zIndex-e._zIndex}const RE={getGlobalPosition(t=new gt,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const n=this.getGlobalTransform(qt.get(),r);return e=n.apply(t,e),qt.return(n),e},toLocal(t,e,r,n){e&&(t=e.toGlobal(t,r,n));const s=this.getGlobalTransform(qt.get(),n);return r=s.applyInverse(t,r),qt.return(s),r}};class cw{constructor(){this.uid=De("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let ME=0;class IE{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,n){const s=new yr({...this.textureOptions,width:e,height:r,resolution:1,antialias:n,autoGarbageCollect:!1});return new me({source:s,label:`texturePool_${ME++}`})}getOptimalTexture(e,r,n=1,s){let i=Math.ceil(e*n-1e-6),o=Math.ceil(r*n-1e-6);i=Ma(i),o=Ma(o);const a=(i<<17)+(o<<1)+(s?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,s)),l.source._resolution=n,l.source.width=i/n,l.source.height=o/n,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,r=!1){const n=e.source;return this.getOptimalTexture(e.width,e.height,n._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const n=this._texturePool[r];if(n)for(let s=0;s<n.length;s++)n[s].destroy(!0)}this._texturePool={}}}const jE=new IE;class OE{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ge,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new cw,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let n=0;n<r.length;n++){const s=r[n];s._updateFlags=15,this.addChild(s)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(jE.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let n=0;n<r.length;n++)this.addChild(r[n])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let n=0;n<r.length;n++)this.removeChild(r[n])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let n=0;n<r.length;n++)this._getChildren(r[n],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const n=e.children;for(let s=0;s<n.length;s++)this._getChildren(n[s],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new ge),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new ge),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new ge),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function BE(t,e,r={}){for(const n in e)!r[n]&&e[n]!==void 0&&(t[n]=e[n])}const jc=new zt(null),Oc=new zt(null),Bc=new zt(null,1,1),Tg=1,NE=2,Nc=4;class co extends Ar{constructor(e={}){super(),this.uid=De("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ge,this.relativeGroupTransform=new ge,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new zt(this,0,0),this._scale=Bc,this._pivot=Oc,this._skew=jc,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],BE(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){je("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Et.mixin(co,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||je(mt,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let s=0;s<e.length;s++)this.addChild(e[s]);return e[0]}const r=e[0],n=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),n&&(n.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,n&&n.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let s=0;s<e.length;s++)this.removeChild(e[s]);return e[0]}const r=e[0],n=this.children.indexOf(r);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,n),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Er.get(OE,this),this.groupTransform=ge.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Er.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ge),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*KP}set angle(e){this.rotation=e*XP}get pivot(){return this._pivot===Oc&&(this._pivot=new zt(this,0,0)),this._pivot}set pivot(e){this._pivot===Oc&&(this._pivot=new zt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===jc&&(this._skew=new zt(this,0,0)),this._skew}set skew(e){this._skew===jc&&(this._skew=new zt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Bc&&(this._scale=new zt(this,1,1)),this._scale}set scale(e){this._scale===Bc&&(this._scale=new zt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const n=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,n.width),r!==void 0&&this._setHeight(r,n.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,n=this._scale,s=this._pivot,i=this._position,o=n._x,a=n._y,l=s._x,c=s._y;r.a=this._cx*o,r.b=this._sx*o,r.c=this._cy*a,r.d=this._sy*a,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Tg,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const n=ut.shared.setValue(e??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=Tg,this._onUpdate())}get tint(){return ua(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=NE,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Nc,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Nc,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Nc,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let s=0;s<r.length;++s)r[s].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Et.mixin(co,xE,_E,RE,PE,CE,qE,vE,EE,mE,AE,SE,bE);class zE extends co{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new sr(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:n,y:s}=e;return n>=r.minX&&n<=r.maxX&&s>=r.minY&&s<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,n){const{renderPipes:s,renderableGC:i}=r;s.blendMode.setBlendMode(this,this.groupBlendMode,e),s[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const a=this.children,l=a.length;for(let c=0;c<l;c++)a[c].collectRenderables(e,r,n)}}class Bi extends zE{constructor(e=me.EMPTY){e instanceof me&&(e={texture:e});const{texture:r=me.EMPTY,anchor:n,roundPixels:s,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new zt({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=s??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,r=!1){return e instanceof me?new Bi(e):new Bi(me.from(e,r))}set texture(e){e||(e=me.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return iE(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return je("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,n=this._bounds,{width:s,height:i}=r.orig;n.minX=-e._x*s,n.maxX=n.minX+s,n.minY=-e._y*i,n.maxY=n.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const LE=new sr;function uw(t,e,r){const n=LE;t.measurable=!0,nw(t,r,n),e.addBoundsMask(n),t.measurable=!1}function hw(t,e,r){const n=Tr.get();t.measurable=!0;const s=qt.get().identity(),i=dw(t,r,s);ow(t,n,i),t.measurable=!1,e.addBoundsMask(n),qt.return(s),Tr.return(n)}function dw(t,e,r){return t?(t!==e&&(dw(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(Ce("Mask bounds, renderable is not inside the root container"),r)}class fw{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Bi),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||uw(this.mask,e,r)}addLocalBounds(e,r){hw(this.mask,e,r)}containsPoint(e,r){const n=this.mask;return r(n,e)}destroy(){this.reset()}static test(e){return e instanceof Bi}}fw.extension=te.MaskEffect;class pw{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}pw.extension=te.MaskEffect;class mw{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){uw(this.mask,e,r)}addLocalBounds(e,r){hw(this.mask,e,r)}containsPoint(e,r){const n=this.mask;return r(n,e)}destroy(){this.reset()}static test(e){return e instanceof co}}mw.extension=te.MaskEffect;const DE={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let Rg=DE;const Qe={get(){return Rg},set(t){Rg=t}};class gw extends yr{constructor(e){e.resource||(e.resource=Qe.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,n=this._resolution){const s=super.resize(e,r,n);return s&&this.resizeCanvas(),s}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}gw.extension=te.TextureSource;class Tn extends yr{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=Qe.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,Ce("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Tn.extension=te.TextureSource;var Ia=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ia||{});class zc{constructor(e,r=null,n=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=n,this._once=s}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Aw=class Ot{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new zc(null,null,1/0),this.deltaMS=1/Ot.targetFPMS,this.elapsedMS=1/Ot.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Ia.NORMAL){return this._addListener(new zc(e,r,n))}addOnce(e,r,n=Ia.NORMAL){return this._addListener(new zc(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Ot.targetFPMS;const n=this._head;let s=n.next;for(;s;)s=s.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Ot.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Ot._shared){const e=Ot._shared=new Ot;e.autoStart=!0,e._protected=!0}return Ot._shared}static get system(){if(!Ot._system){const e=Ot._system=new Ot;e.autoStart=!0,e._protected=!0}return Ot._system}};Aw.targetFPMS=.06;let Ct=Aw,Lc;async function yw(){return Lc??(Lc=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!r)return"premultiply-alpha-on-upload";const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(s),e.deleteTexture(n),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Lc}const sl=class xw extends yr{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...xw.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=Ct.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await yw(),this._load=new Promise((n,s)=>{this.isValid?n(this):(this._resolve=n,this._reject=s,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ct.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};sl.extension=te.TextureSource;sl.defaultOptions={...yr.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};sl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ha=sl;const tr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t);class FE{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||Ce(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=tr(e);let s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){s=c.getCacheableAssets(n,r);break}}const i=new Map(Object.entries(s||{}));s||n.forEach(l=>{i.set(l,r)});const o=[...i.keys()],a={cacheKeys:o,keys:n};n.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=s?s[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&Ce("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){Ce(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(s=>{this._cache.delete(s)}),r.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Me=new FE,hh=[];Et.handleByList(te.TextureSource,hh);function bw(t={}){const e=t&&t.resource,r=e?t.resource:t,n=e?t:{resource:t};for(let s=0;s<hh.length;s++){const i=hh[s];if(i.test(r))return new i(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function UE(t={},e=!1){const r=t&&t.resource,n=r?t.resource:t,s=r?t:{resource:t};if(!e&&Me.has(n))return Me.get(n);const i=new me({source:bw(s)});return i.on("destroy",()=>{Me.has(n)&&Me.remove(n)}),e||Me.set(n,i),i}function HE(t,e=!1){return typeof t=="string"?Me.get(t):t instanceof yr?new me({source:t}):UE(t,e)}me.from=HE;yr.from=bw;Et.add(fw,pw,mw,ha,Tn,gw,Ud);var rn=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(rn||{});function Jt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Zs(t){return t.split("?")[0].split("#")[0]}function $E(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function GE(t,e,r){return t.replace(new RegExp($E(e),"g"),r)}function WE(t,e){let r="",n=0,s=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),s=a,i=0;continue}}else if(r.length===2||r.length===1){r="",n=0,s=a,i=0;continue}}}else r.length>0?r+=`/${t.slice(s+1,a)}`:r=t.slice(s+1,a),n=a-s-1;s=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}const Ft={toPosix(t){return GE(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Jt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(Jt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=Zs(this.toPosix(e??Qe.get().getBaseUrl())),s=Zs(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?Ft.join(s,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(Jt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=WE(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Jt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(Jt(n),n.length>0)if(e===void 0)e=n;else{const s=t[r-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Jt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,s=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!s){n=a;break}}else s=!1;return n===-1?r?"/":this.isUrl(o)?i+t:i:r&&n===1?"//":i+t.slice(0,n)},rootname(t){Jt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Jt(t),e&&Jt(e),t=Zs(this.toPosix(t));let r=0,n=-1,s=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!s){r=i+1;break}}else a===-1&&(s=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=i):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!s){r=i+1;break}}else n===-1&&(s=!1,n=i+1);return n===-1?"":t.slice(r,n)},extname(t){Jt(t),t=Zs(this.toPosix(t));let e=-1,r=0,n=-1,s=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!s){r=o+1;break}continue}n===-1&&(s=!1,n=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||n===-1||i===0||i===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){Jt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Zs(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let s;e.root=this.rootname(t),n||this.hasProtocol(t)?s=1:s=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=s;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function ww(t,e,r,n,s){const i=e[r];for(let o=0;o<i.length;o++){const a=i[o];r<e.length-1?ww(t.replace(n[r],a),e,r+1,n,s):s.push(t.replace(n[r],a))}}function YE(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const s=[];r.forEach(i=>{const o=i.substring(1,i.length-1).split(",");s.push(o)}),ww(t,s,0,r,n)}else n.push(t);return n}const ja=t=>!Array.isArray(t);class Os{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,src:n}=e;return tr(r||n,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&Ce("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];let s=r;Array.isArray(r)||(s=Object.entries(r).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),s.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);n.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));n.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=n}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let n;n=i=>{this.hasKey(i)&&Ce(`[Resolver] already has key: ${i} overwriting`)},tr(r).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c}=i;const u=tr(o).map(f=>typeof f=="string"?YE(f):Array.isArray(f)?f:[f]),h=this.getAlias(i);Array.isArray(h)?h.forEach(n):n(h);const d=[];u.forEach(f=>{f.forEach(m=>{let A={};if(typeof m!="object"){A.src=m;for(let g=0;g<this._parsers.length;g++){const y=this._parsers[g];if(y.test(m)){A=y.parse(m);break}}}else a=m.data??a,l=m.format??l,c=m.loadParser??c,A={...A,...m};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${A.src}`);A=this._buildResolvedAsset(A,{aliases:h,data:a,format:l,loadParser:c}),d.push(A)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const r=ja(e);e=tr(e);const n={};return e.forEach(s=>{const i=this._bundles[s];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(s,l)]=c}n[s]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const s in r)n[s]=r[s].src;return n}return r.src}resolve(e){const r=ja(e);e=tr(e);const n={};return e.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let i=this._assetMap[s];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[s]=i[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});n[s]=this._resolverHash[s]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[r],s=this._preferredOrder.find(i=>i.params.format.includes(n.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:n,data:s,loadParser:i,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=Ft.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...s||{},...e.data},e.loadParser=i??e.loadParser,e.format=o??e.format??QE(e.src),e}}Os.RETINA_PREFIX=/@([0-9\.]+)x/;function QE(t){return t.split(".").pop().split("?").shift().split("#").shift()}const dh=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},qw=class hi{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof me?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const n=parseFloat(r.meta.scale);n?(this.resolution=n,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=hi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=hi.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const s=this._frameKeys[r],i=this._frames[s],o=i.frame;if(o){let a=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Le(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?a=new Le(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Le(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Le(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new me({source:this.textureSource,frame:a,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:s.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const s=e[r][n];this.animations[r].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*hi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*hi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};qw.BATCH_SIZE=1e3;let fh=qw;const KE=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function vw(t,e,r){const n={};if(t.forEach(s=>{n[s]=e}),Object.keys(e.textures).forEach(s=>{n[s]=e.textures[s]}),!r){const s=Ft.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=vw([`${s}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(n,a)})}return n}const XE={extension:te.Asset,cache:{test:t=>t instanceof fh,getCacheableAssets:(t,e)=>vw(t,e,!1)},resolver:{extension:{type:te.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),n=r.pop(),s=r.pop();return n==="json"&&KE.includes(s)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Os.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:te.LoadParser,priority:rn.Normal,name:"spritesheetLoader"},async testParse(t,e){return Ft.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:n,imageFilename:s,textureOptions:i}=e?.data??{};let o=Ft.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n instanceof me)a=n;else{const u=dh(o+(s??t.meta.image),e.src);a=(await r.load([{src:u,data:i}]))[u]}const l=new fh(a.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const d of c){if(typeof d!="string")continue;let f=o+d;e.data?.ignoreMultiPack||(f=dh(f,e.src),u.push(r.load({src:f,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(d=>{d.linkedSheets=[l].concat(l.linkedSheets.filter(f=>f!==d))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};Et.add(XE);const Dc=Object.create(null),Mg=Object.create(null);function Gd(t,e){let r=Mg[t];return r===void 0&&(Dc[e]===void 0&&(Dc[e]=1),Mg[t]=r=Dc[e]++),r}let Uo;function Vw(){return(!Uo||Uo?.isContextLost())&&(Uo=Qe.get().createCanvas().getContext("webgl",{})),Uo}let Ho;function JE(){if(!Ho){Ho="mediump";const t=Vw();t&&t.getShaderPrecisionFormat&&(Ho=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return Ho}function ZE(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function eT(t,e,r){const n=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let s=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return s==="highp"&&n!=="highp"&&(s="mediump"),`precision ${s} float;
${t}`}else if(n!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function tT(t,e){return e?`#version 300 es
${t}`:t}const rT={},nT={};function sT(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const n=r?rT:nT;return n[e]?(n[e]++,e+=`-${n[e]}`):n[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function iT(t,e){return e?t.replace("#version 300 es",""):t}const Fc={stripVersion:iT,ensurePrecision:eT,addProgramDefines:ZE,setProgramName:sT,insertVersion:tT},Uc=Object.create(null),_w=class ph{constructor(e){e={...ph.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:JE()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let s=e.fragment,i=e.vertex;Object.keys(Fc).forEach(o=>{const a=n[o];s=Fc[o](s,a,!0),i=Fc[o](i,a,!1)}),this.fragment=s,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=Gd(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return Uc[r]||(Uc[r]=new ph(e)),Uc[r]}};_w.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Sw=_w;const Ig={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function oT(t){return Ig[t]??Ig.float32}const aT={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function lT({source:t,entryPoint:e}){const r={},n=t.indexOf(`fn ${e}`);if(n!==-1){const s=t.indexOf("->",n);if(s!==-1){const i=t.substring(n,s),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=aT[a[3]]??"float32";r[a[2]]={location:parseInt(a[1],10),format:l,stride:oT(l).stride,offset:0,instance:!1,start:0}}}}return r}function Hc(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,s=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(n)[1],10),name:h.match(s)[2],isUniform:h.match(s)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((m,A)=>{const[g,y]=A.split(":");return m[g.trim()]=y.trim(),m},{});return f?{name:d,members:f}:null}).filter(({name:h})=>c.some(d=>d.type===h))??[];return{groups:c,structs:u}}var di=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(di||{});function cT({groups:t}){const e=[];for(let r=0;r<t.length;r++){const n=t[r];e[n.group]||(e[n.group]=[]),n.isUniform?e[n.group].push({binding:n.binding,visibility:di.VERTEX|di.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?e[n.group].push({binding:n.binding,visibility:di.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&e[n.group].push({binding:n.binding,visibility:di.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function uT({groups:t}){const e=[];for(let r=0;r<t.length;r++){const n=t[r];e[n.group]||(e[n.group]={}),e[n.group][n.name]=n.binding}return e}function hT(t,e){const r=new Set,n=new Set,s=[...t.structs,...e.structs].filter(o=>r.has(o.name)?!1:(r.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return n.has(a)?!1:(n.add(a),!0)});return{structs:s,groups:i}}const $c=Object.create(null);class il{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:n,layout:s,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=r,this.vertex=n,r.source===n.source){const a=Hc(r.source);this.structsAndGroups=a}else{const a=Hc(n.source),l=Hc(r.source);this.structsAndGroups=hT(a,l)}this.layout=s??uT(this.structsAndGroups),this.gpuLayout=i??cT(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,n=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=Gd(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=lT(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return $c[r]||($c[r]=new il(e)),$c[r]}}const kw=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],dT=kw.reduce((t,e)=>(t[e]=!0,t),{});function fT(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Cw=class Pw{constructor(e,r){this._touched=0,this.uid=De("uniform"),this._resourceType="uniformGroup",this._resourceId=De("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...Pw.defaultOptions,...r},this.uniformStructures=e;const n={};for(const s in e){const i=e[s];if(i.name=s,i.size=i.size??1,!dT[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${kw.join(", ")}`);i.value??(i.value=fT(i.type,i.size)),n[s]=i.value}this.uniforms=n,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=Gd(Object.keys(n).map(s=>`${s}-${e[s].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Cw.defaultOptions={ubo:!1,isStatic:!1};let Ew=Cw;class da{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const n in e){const s=e[n];this.setResource(s,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const n in this.resources)e[r++]=this.resources[n]._resourceId;this._key=e.join("|")}setResource(e,r){const n=this.resources[r];e!==n&&(n&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const n in r)r[n]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const n in r)r[n]===e&&(r[n]=null)}else this._updateKey()}}var mh=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(mh||{});class Wd extends Ar{constructor(e){super(),this.uid=De("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:n,groups:s,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=r,this.glProgram=n,o===void 0&&(o=0,r&&(o|=mh.WEBGPU),n&&(o|=mh.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!s&&(i={}),i&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&s&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&s&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&s&&!a){const c=r.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){s={},a={},r&&r.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(s[99]||(s[99]=new da,this._ownedBindGroups.push(s[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let d=i[u];!d.source&&!d._resourceType&&(d=new Ew(d));const f=l[h];f&&(s[f.group]||(s[f.group]=new da,this._ownedBindGroups.push(s[f.group])),s[f.group].setResource(d,f.binding))}}this.groups=s,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(s,l)}addResource(e,r,n){var s,i;(s=this._uniformBindMap)[r]||(s[r]={}),(i=this._uniformBindMap[r])[n]||(i[n]=e),this.groups[r]||(this.groups[r]=new da,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const n={};for(const s in r){const i=r[s];Object.defineProperty(n,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return n}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:n,...s}=e;let i,o;return r&&(i=il.from(r)),n&&(o=Sw.from(n)),new Wd({gpuProgram:i,glProgram:o,...s})}}var $o={exports:{}},jg;function pT(){if(jg)return $o.exports;jg=1,$o.exports=t,$o.exports.default=t;function t(q,k,P){P=P||2;var M=k&&k.length,T=M?k[0]*P:q.length,j=e(q,0,T,P,!0),O=[];if(!j||j.next===j.prev)return O;var N,D,F,G,Q,re,ie;if(M&&(j=l(q,k,j,P)),q.length>80*P){N=F=q[0],D=G=q[1];for(var ne=P;ne<T;ne+=P)Q=q[ne],re=q[ne+1],Q<N&&(N=Q),re<D&&(D=re),Q>F&&(F=Q),re>G&&(G=re);ie=Math.max(F-N,G-D),ie=ie!==0?32767/ie:0}return n(j,O,P,N,D,ie,0),O}function e(q,k,P,M,T){var j,O;if(T===U(q,k,P,M)>0)for(j=k;j<P;j+=M)O=B(j,q[j],q[j+1],O);else for(j=P-M;j>=k;j-=M)O=B(j,q[j],q[j+1],O);return O&&w(O,O.next)&&(z(O),O=O.next),O}function r(q,k){if(!q)return q;k||(k=q);var P=q,M;do if(M=!1,!P.steiner&&(w(P,P.next)||x(P.prev,P,P.next)===0)){if(z(P),P=k=P.prev,P===P.next)break;M=!0}else P=P.next;while(M||P!==k);return k}function n(q,k,P,M,T,j,O){if(q){!O&&j&&f(q,M,T,j);for(var N=q,D,F;q.prev!==q.next;){if(D=q.prev,F=q.next,j?i(q,M,T,j):s(q)){k.push(D.i/P|0),k.push(q.i/P|0),k.push(F.i/P|0),z(q),q=F.next,N=F.next;continue}if(q=F,q===N){O?O===1?(q=o(r(q),k,P),n(q,k,P,M,T,j,2)):O===2&&a(q,k,P,M,T,j):n(r(q),k,P,M,T,j,1);break}}}}function s(q){var k=q.prev,P=q,M=q.next;if(x(k,P,M)>=0)return!1;for(var T=k.x,j=P.x,O=M.x,N=k.y,D=P.y,F=M.y,G=T<j?T<O?T:O:j<O?j:O,Q=N<D?N<F?N:F:D<F?D:F,re=T>j?T>O?T:O:j>O?j:O,ie=N>D?N>F?N:F:D>F?D:F,ne=M.next;ne!==k;){if(ne.x>=G&&ne.x<=re&&ne.y>=Q&&ne.y<=ie&&y(T,N,j,D,O,F,ne.x,ne.y)&&x(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function i(q,k,P,M){var T=q.prev,j=q,O=q.next;if(x(T,j,O)>=0)return!1;for(var N=T.x,D=j.x,F=O.x,G=T.y,Q=j.y,re=O.y,ie=N<D?N<F?N:F:D<F?D:F,ne=G<Q?G<re?G:re:Q<re?Q:re,At=N>D?N>F?N:F:D>F?D:F,Ue=G>Q?G>re?G:re:Q>re?Q:re,it=A(ie,ne,k,P,M),It=A(At,Ue,k,P,M),oe=q.prevZ,xe=q.nextZ;oe&&oe.z>=it&&xe&&xe.z<=It;){if(oe.x>=ie&&oe.x<=At&&oe.y>=ne&&oe.y<=Ue&&oe!==T&&oe!==O&&y(N,G,D,Q,F,re,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,xe.x>=ie&&xe.x<=At&&xe.y>=ne&&xe.y<=Ue&&xe!==T&&xe!==O&&y(N,G,D,Q,F,re,xe.x,xe.y)&&x(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;oe&&oe.z>=it;){if(oe.x>=ie&&oe.x<=At&&oe.y>=ne&&oe.y<=Ue&&oe!==T&&oe!==O&&y(N,G,D,Q,F,re,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;xe&&xe.z<=It;){if(xe.x>=ie&&xe.x<=At&&xe.y>=ne&&xe.y<=Ue&&xe!==T&&xe!==O&&y(N,G,D,Q,F,re,xe.x,xe.y)&&x(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function o(q,k,P){var M=q;do{var T=M.prev,j=M.next.next;!w(T,j)&&V(T,M,M.next,j)&&E(T,j)&&E(j,T)&&(k.push(T.i/P|0),k.push(M.i/P|0),k.push(j.i/P|0),z(M),z(M.next),M=q=j),M=M.next}while(M!==q);return r(M)}function a(q,k,P,M,T,j){var O=q;do{for(var N=O.next.next;N!==O.prev;){if(O.i!==N.i&&b(O,N)){var D=I(O,N);O=r(O,O.next),D=r(D,D.next),n(O,k,P,M,T,j,0),n(D,k,P,M,T,j,0);return}N=N.next}O=O.next}while(O!==q)}function l(q,k,P,M){var T=[],j,O,N,D,F;for(j=0,O=k.length;j<O;j++)N=k[j]*M,D=j<O-1?k[j+1]*M:q.length,F=e(q,N,D,M,!1),F===F.next&&(F.steiner=!0),T.push(g(F));for(T.sort(c),j=0;j<T.length;j++)P=u(T[j],P);return P}function c(q,k){return q.x-k.x}function u(q,k){var P=h(q,k);if(!P)return k;var M=I(P,q);return r(M,M.next),r(P,P.next)}function h(q,k){var P=k,M=q.x,T=q.y,j=-1/0,O;do{if(T<=P.y&&T>=P.next.y&&P.next.y!==P.y){var N=P.x+(T-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(N<=M&&N>j&&(j=N,O=P.x<P.next.x?P:P.next,N===M))return O}P=P.next}while(P!==k);if(!O)return null;var D=O,F=O.x,G=O.y,Q=1/0,re;P=O;do M>=P.x&&P.x>=F&&M!==P.x&&y(T<G?M:j,T,F,G,T<G?j:M,T,P.x,P.y)&&(re=Math.abs(T-P.y)/(M-P.x),E(P,q)&&(re<Q||re===Q&&(P.x>O.x||P.x===O.x&&d(O,P)))&&(O=P,Q=re)),P=P.next;while(P!==D);return O}function d(q,k){return x(q.prev,q,k.prev)<0&&x(k.next,q,q.next)<0}function f(q,k,P,M){var T=q;do T.z===0&&(T.z=A(T.x,T.y,k,P,M)),T.prevZ=T.prev,T.nextZ=T.next,T=T.next;while(T!==q);T.prevZ.nextZ=null,T.prevZ=null,m(T)}function m(q){var k,P,M,T,j,O,N,D,F=1;do{for(P=q,q=null,j=null,O=0;P;){for(O++,M=P,N=0,k=0;k<F&&(N++,M=M.nextZ,!!M);k++);for(D=F;N>0||D>0&&M;)N!==0&&(D===0||!M||P.z<=M.z)?(T=P,P=P.nextZ,N--):(T=M,M=M.nextZ,D--),j?j.nextZ=T:q=T,T.prevZ=j,j=T;P=M}j.nextZ=null,F*=2}while(O>1);return q}function A(q,k,P,M,T){return q=(q-P)*T|0,k=(k-M)*T|0,q=(q|q<<8)&16711935,q=(q|q<<4)&252645135,q=(q|q<<2)&858993459,q=(q|q<<1)&1431655765,k=(k|k<<8)&16711935,k=(k|k<<4)&252645135,k=(k|k<<2)&858993459,k=(k|k<<1)&1431655765,q|k<<1}function g(q){var k=q,P=q;do(k.x<P.x||k.x===P.x&&k.y<P.y)&&(P=k),k=k.next;while(k!==q);return P}function y(q,k,P,M,T,j,O,N){return(T-O)*(k-N)>=(q-O)*(j-N)&&(q-O)*(M-N)>=(P-O)*(k-N)&&(P-O)*(j-N)>=(T-O)*(M-N)}function b(q,k){return q.next.i!==k.i&&q.prev.i!==k.i&&!S(q,k)&&(E(q,k)&&E(k,q)&&R(q,k)&&(x(q.prev,q,k.prev)||x(q,k.prev,k))||w(q,k)&&x(q.prev,q,q.next)>0&&x(k.prev,k,k.next)>0)}function x(q,k,P){return(k.y-q.y)*(P.x-k.x)-(k.x-q.x)*(P.y-k.y)}function w(q,k){return q.x===k.x&&q.y===k.y}function V(q,k,P,M){var T=v(x(q,k,P)),j=v(x(q,k,M)),O=v(x(P,M,q)),N=v(x(P,M,k));return!!(T!==j&&O!==N||T===0&&_(q,P,k)||j===0&&_(q,M,k)||O===0&&_(P,q,M)||N===0&&_(P,k,M))}function _(q,k,P){return k.x<=Math.max(q.x,P.x)&&k.x>=Math.min(q.x,P.x)&&k.y<=Math.max(q.y,P.y)&&k.y>=Math.min(q.y,P.y)}function v(q){return q>0?1:q<0?-1:0}function S(q,k){var P=q;do{if(P.i!==q.i&&P.next.i!==q.i&&P.i!==k.i&&P.next.i!==k.i&&V(P,P.next,q,k))return!0;P=P.next}while(P!==q);return!1}function E(q,k){return x(q.prev,q,q.next)<0?x(q,k,q.next)>=0&&x(q,q.prev,k)>=0:x(q,k,q.prev)<0||x(q,q.next,k)<0}function R(q,k){var P=q,M=!1,T=(q.x+k.x)/2,j=(q.y+k.y)/2;do P.y>j!=P.next.y>j&&P.next.y!==P.y&&T<(P.next.x-P.x)*(j-P.y)/(P.next.y-P.y)+P.x&&(M=!M),P=P.next;while(P!==q);return M}function I(q,k){var P=new L(q.i,q.x,q.y),M=new L(k.i,k.x,k.y),T=q.next,j=k.prev;return q.next=k,k.prev=q,P.next=T,T.prev=P,M.next=P,P.prev=M,j.next=M,M.prev=j,M}function B(q,k,P,M){var T=new L(q,k,P);return M?(T.next=M.next,T.prev=M,M.next.prev=T,M.next=T):(T.prev=T,T.next=T),T}function z(q){q.next.prev=q.prev,q.prev.next=q.next,q.prevZ&&(q.prevZ.nextZ=q.nextZ),q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function L(q,k,P){this.i=q,this.x=k,this.y=P,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(q,k,P,M){var T=k&&k.length,j=T?k[0]*P:q.length,O=Math.abs(U(q,0,j,P));if(T)for(var N=0,D=k.length;N<D;N++){var F=k[N]*P,G=N<D-1?k[N+1]*P:q.length;O-=Math.abs(U(q,F,G,P))}var Q=0;for(N=0;N<M.length;N+=3){var re=M[N]*P,ie=M[N+1]*P,ne=M[N+2]*P;Q+=Math.abs((q[re]-q[ne])*(q[ie+1]-q[re+1])-(q[re]-q[ie])*(q[ne+1]-q[re+1]))}return O===0&&Q===0?0:Math.abs((Q-O)/O)};function U(q,k,P,M){for(var T=0,j=k,O=P-M;j<P;j+=M)T+=(q[O]-q[j])*(q[j+1]+q[O+1]),O=j;return T}return t.flatten=function(q){for(var k=q[0][0].length,P={vertices:[],holes:[],dimensions:k},M=0,T=0;T<q.length;T++){for(var j=0;j<q[T].length;j++)for(var O=0;O<k;O++)P.vertices.push(q[T][j][O]);T>0&&(M+=q[T-1].length,P.holes.push(M))}return P},$o.exports}var mT=pT();const gT=st(mT);class Tw extends Ar{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return je(mt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return je(mt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return je(mt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return je(mt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return je(mt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Og=[{offset:0,color:"white"},{offset:1,color:"black"}],Yd=class gh{constructor(...e){this.uid=De("fillGradient"),this.type="linear",this.colorStops=[];let r=AT(e);r={...r.type==="radial"?gh.defaultRadialOptions:gh.defaultLinearOptions,...Qb(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(s=>{this.addColorStop(s.offset,s.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:ut.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Og,r=this._textureSize,{canvas:n,context:s}=Ng(r,1),i=s.createLinearGradient(0,0,this._textureSize,0);Bg(i,e),s.fillStyle=i,s.fillRect(0,0,r,1),this.texture=new me({source:new Tn({resource:n})});const{x:o,y:a}=this.start,{x:l,y:c}=this.end,u=new ge,h=l-o,d=c-a,f=Math.sqrt(h*h+d*d),m=Math.atan2(d,h);u.scale(f/r,1),u.rotate(m),u.translate(o,a),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Og,r=this._textureSize,{canvas:n,context:s}=Ng(r,r),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,d=l-u,f=r/(u*2),m=(i-h)*f,A=(o-d)*f,g=s.createRadialGradient(m,A,c*f,(a-h)*f,(l-d)*f,u*f);Bg(g,e),s.fillStyle=e[e.length-1].color,s.fillRect(0,0,r,r),s.fillStyle=g,s.translate(m,A),s.rotate(this.rotation),s.scale(1,this.scale),s.translate(-m,-A),s.fillRect(0,0,r,r),this.texture=new me({source:new Tn({resource:n,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const y=new ge;y.scale(1/f,1/f),y.translate(h,d),this.textureSpace==="local"&&y.scale(r,r),this.transform=y}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};Yd.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};Yd.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let Yr=Yd;function Bg(t,e){for(let r=0;r<e.length;r++){const n=e[r];t.addColorStop(n.offset,n.color)}}function Ng(t,e){const r=Qe.get().createCanvas(t,e),n=r.getContext("2d");return{canvas:r,context:n}}function AT(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(je("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??Yr.defaultLinearOptions.textureSize}),e}const zg={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ol{constructor(e,r){this.uid=De("fillPattern"),this.transform=new ge,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=zg[r].addressModeU,e.source.style.addressModeV=zg[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Gc,Lg;function yT(){if(Lg)return Gc;Lg=1,Gc=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=s(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(i){var o=i.match(n);return o?o.map(Number):[]}return Gc}var xT=yT();const bT=st(xT);function wT(t,e){const r=bT(t),n=[];let s=null,i=0,o=0;for(let a=0;a<r.length;a++){const l=r[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),n.length>0&&(s=n.pop(),s?(i=s.startX,o=s.startY):(i=0,o=0)),s=null;break;default:Ce(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&s===null&&(s={startX:i,startY:o},n.push(s))}return e}class Qd{constructor(e=0,r=0,n=0){this.type="circle",this.x=e,this.y=r,this.radius=n}clone(){return new Qd(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let s=this.x-e,i=this.y-r;return s*=s,i*=i,s+i<=n}strokeContains(e,r,n,s=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-r,a=this.radius,l=(1-s)*n,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(n-l)}getBounds(e){return e||(e=new Le),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Kd{constructor(e=0,r=0,n=0,s=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=n,this.halfHeight=s}clone(){return new Kd(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(e-this.x)/this.halfWidth,s=(r-this.y)/this.halfHeight;return n*=n,s*=s,n+s<=1}strokeContains(e,r,n,s=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=n*(1-s),l=n-a,c=i-l,u=o-l,h=i+a,d=o+a,f=e-this.x,m=r-this.y,A=f*f/(c*c)+m*m/(u*u),g=f*f/(h*h)+m*m/(d*d);return A>1&&g<=1}getBounds(e){return e||(e=new Le),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function qT(t,e,r,n,s,i){const o=t-r,a=e-n,l=s-r,c=i-n,u=o*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,m;d<0?(f=r,m=n):d>1?(f=s,m=i):(f=r+d*l,m=n+d*c);const A=t-f,g=e-m;return A*A+g*g}let vT,VT;class vi{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let s=0,i=r.length;s<i;s++)n.push(r[s].x,r[s].y);r=n}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,n=r.length;for(let s=0;s<n;s+=2){const i=r[s],o=r[s+1],a=r[(s+2)%n],l=r[(s+3)%n];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const r=this.getBounds(vT),n=e.getBounds(VT);if(!r.containsRect(n))return!1;const s=e.points;for(let i=0;i<s.length;i+=2){const o=s[i],a=s[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),r=new vi(e);return r.closePath=this.closePath,r}contains(e,r){let n=!1;const s=this.points.length/2;for(let i=0,o=s-1;i<s;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(n=!n)}return n}strokeContains(e,r,n,s=.5){const i=n*n,o=i*(1-s),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],d=l[u+1],f=l[(u+2)%l.length],m=l[(u+3)%l.length],A=qT(e,r,h,d,f,m),g=Math.sign((f-h)*(r-d)-(m-d)*(e-h));if(A<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new Le);const r=this.points;let n=1/0,s=-1/0,i=1/0,o=-1/0;for(let a=0,l=r.length;a<l;a+=2){const c=r[a],u=r[a+1];n=c<n?c:n,s=c>s?c:s,i=u<i?u:i,o=u>o?u:o}return e.x=n,e.width=s-n,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Go=(t,e,r,n,s,i,o)=>{const a=t-r,l=e-n,c=Math.sqrt(a*a+l*l);return c>=s-i&&c<=s+o};class Xd{constructor(e=0,r=0,n=0,s=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=n,this.height=s,this.radius=i}getBounds(e){return e||(e=new Le),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Xd(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let s=e-(this.x+n),i=r-(this.y+n);const o=n*n;if(s*s+i*i<=o||(s=e-(this.x+this.width-n),s*s+i*i<=o)||(i=r-(this.y+this.height-n),s*s+i*i<=o)||(s=e-(this.x+n),s*s+i*i<=o))return!0}return!1}strokeContains(e,r,n,s=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=n*(1-s),h=n-u,d=i+c,f=o+c,m=a-c*2,A=l-c*2,g=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=g-h&&e<=g+u)&&r>=f&&r<=f+A||(r>=o-u&&r<=o+h||r>=y-h&&r<=y+u)&&e>=d&&e<=d+m?!0:e<d&&r<f&&Go(e,r,d,f,c,h,u)||e>g-c&&r<f&&Go(e,r,g-c,f,c,h,u)||e>g-c&&r>y-c&&Go(e,r,g-c,y-c,c,h,u)||e<d&&r>y-c&&Go(e,r,d,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const _T=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ST(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function kT(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const n=_T.replace(/%forloop%/gi,ST(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let Xn=null;function Rw(){if(Xn)return Xn;const t=Vw();return Xn=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Xn=kT(Xn,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Xn}const Mw={};function CT(t,e){let r=2166136261;for(let n=0;n<e;n++)r^=t[n].uid,r=Math.imul(r,16777619),r>>>=0;return Mw[r]||PT(t,e,r)}let Wc=0;function PT(t,e,r){const n={};let s=0;Wc||(Wc=Rw());for(let o=0;o<Wc;o++){const a=o<e?t[o]:me.EMPTY.source;n[s++]=a.source,n[s++]=a.style}const i=new da(n);return Mw[r]=i,i}class Dg{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Fg(t,e){const r=t.byteLength/8|0,n=new Float64Array(t,0,r);new Float64Array(e,0,r).set(n);const i=t.byteLength-r*8;if(i>0){const o=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(o)}}const ET={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var TT=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(TT||{});function Ug(t,e){return e.alphaMode==="no-premultiply-alpha"&&ET[t]||t}class RT{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class MT{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new RT,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Iw=[];let Ah=0;function Hg(){return Ah>0?Iw[--Ah]:new MT}function $g(t){Iw[Ah++]=t}let ei=0;const jw=class fa{constructor(e={}){this.uid=De("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],fa.defaultOptions.maxTextures=fa.defaultOptions.maxTextures??Rw(),e={...fa.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:n,indicesInitialSize:s}=e;this.attributeBuffer=new Dg(n*4),this.indexBuffer=new Uint16Array(s),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)$g(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const n=e._batch.textures.ids[r._source.uid];return!n&&n!==0?!1:(e._textureId=n,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let n=Hg(),s=n.textures;s.clear();const i=r[this.elementStart];let o=Ug(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const m=this.maxTextures;for(let A=this.elementStart;A<this.elementSize;++A){const g=r[A];r[A]=null;const b=g.texture._source,x=Ug(g.blendMode,b),w=o!==x||a!==g.topology;if(b._batchTick===ei&&!w){g._textureId=b._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=n;continue}b._batchTick=ei,(s.count>=m||w)&&(this._finishBatch(n,d,h-d,s,o,a,e,f),f="renderBatch",d=h,o=x,a=g.topology,n=Hg(),s=n.textures,s.clear(),++ei),g._textureId=b._textureBindLocation=s.count,s.ids[b.uid]=s.count,s.textures[s.count++]=b,g._batch=n,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}s.count>0&&(this._finishBatch(n,d,h-d,s,o,a,e,f),d=h,++ei),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=h}_finishBatch(e,r,n,s,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=s,e.blendMode=i,e.topology=o,e.start=r,e.size=n,++ei,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),n=new Dg(r);Fg(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(e){const r=this.indexBuffer;let n=Math.max(e,r.length*1.5);n+=n%2;const s=n>65535?new Uint32Array(n):new Uint16Array(n);if(s.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)s[i]=r[i];else Fg(r.buffer,s.buffer);this.indexBuffer=s}packQuadIndex(e,r,n){e[r]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3}packIndex(e,r,n,s){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)r[n++]=s+i[c+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)$g(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};jw.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let IT=jw;var kt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(kt||{});let Ni=class extends Ar{constructor(e){let{data:r,size:n}=e;const{usage:s,label:i,shrinkToFit:o}=e;super(),this.uid=De("buffer"),this._resourceType="buffer",this._resourceId=De("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,n??(n=r?.byteLength);const a=!!r;this.descriptor={size:n,usage:s,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&kt.STATIC)}set static(e){e?this.descriptor.usage|=kt.STATIC:this.descriptor.usage&=~kt.STATIC}setDataWithSize(e,r,n){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){n&&this.emit("update",this);return}const s=this._data;if(this._data=e,this._dataInt32=null,!s||s.length!==e.length){!this.shrinkToFit&&s&&e.byteLength<s.byteLength?n&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=De("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Ow(t,e){if(!(t instanceof Ni)){let r=e?kt.INDEX:kt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=kt.INDEX|kt.COPY_DST):(t=new Float32Array(t),r=kt.VERTEX|kt.COPY_DST)),t=new Ni({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function jT(t,e,r){const n=t.getAttribute(e);if(!n)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const s=n.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=s.BYTES_PER_ELEMENT,u=(n.offset||0)/c,h=(n.stride||2*4)/c;for(let d=u;d<s.length;d+=h){const f=s[d],m=s[d+1];f>a&&(a=f),m>l&&(l=m),f<i&&(i=f),m<o&&(o=m)}return r.minX=i,r.minY=o,r.maxX=a,r.maxY=l,r}function OT(t){return(t instanceof Ni||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Ow(t.buffer,!1),t}class BT extends Ar{constructor(e={}){super(),this.uid=De("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new sr,this._boundsDirty=!0;const{attributes:r,indexBuffer:n,topology:s}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,n&&this.addIndex(n),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const n=OT(r);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=n}addIndex(e){this.indexBuffer=Ow(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,jT(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const NT=new Float32Array(1),zT=new Uint32Array(1);class LT extends BT{constructor(){const r=new Ni({data:NT,label:"attribute-batch-buffer",usage:kt.VERTEX|kt.COPY_DST,shrinkToFit:!1}),n=new Ni({data:zT,label:"index-batch-buffer",usage:kt.INDEX|kt.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:s,offset:0},aUV:{buffer:r,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:r,format:"unorm8x4",stride:s,offset:4*4},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:s,offset:5*4}},indexBuffer:n})}}function Gg(t,e,r){if(t)for(const n in t){const s=n.toLocaleLowerCase(),i=e[s];if(i){let o=t[n];n==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(o)}else Ce(`${n} placement hook does not exist in shader`)}}const DT=/\{\{(.*?)\}\}/g;function Wg(t){const e={};return(t.match(DT)?.map(n=>n.replace(/[{()}]/g,""))??[]).forEach(n=>{e[n]=[]}),e}function Yg(t,e){let r;const n=/@in\s+([^;]+);/g;for(;(r=n.exec(t))!==null;)e.push(r[1])}function Qg(t,e,r=!1){const n=[];Yg(e,n),t.forEach(a=>{a.header&&Yg(a.header,n)});const s=n;r&&s.sort();const i=s.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Kg(t,e){let r;const n=/@out\s+([^;]+);/g;for(;(r=n.exec(t))!==null;)e.push(r[1])}function FT(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function UT(t){const e=/@.*?\s+/g;return t.replace(e,"")}function HT(t,e){const r=[];Kg(e,r),t.forEach(l=>{l.header&&Kg(l.header,r)});let n=0;const s=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${n++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${UT(l)};`).join(`
`),o=`return VSOutput(
            ${r.sort().map(l=>` ${FT(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${s}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Xg(t,e){let r=t;for(const n in e){const s=e[n];s.join(`
`).length?r=r.replace(`{{${n}}}`,`//-----${n} START-----//
${s.join(`
`)}
//----${n} FINISH----//`):r=r.replace(`{{${n}}}`,"")}return r}const Fr=Object.create(null),Yc=new Map;let $T=0;function GT({template:t,bits:e}){const r=Bw(t,e);if(Fr[r])return Fr[r];const{vertex:n,fragment:s}=YT(t,e);return Fr[r]=Nw(n,s,e),Fr[r]}function WT({template:t,bits:e}){const r=Bw(t,e);return Fr[r]||(Fr[r]=Nw(t.vertex,t.fragment,e)),Fr[r]}function YT(t,e){const r=e.map(o=>o.vertex).filter(o=>!!o),n=e.map(o=>o.fragment).filter(o=>!!o);let s=Qg(r,t.vertex,!0);s=HT(r,s);const i=Qg(n,t.fragment,!0);return{vertex:s,fragment:i}}function Bw(t,e){return e.map(r=>(Yc.has(r)||Yc.set(r,$T++),Yc.get(r))).sort((r,n)=>r-n).join("-")+t.vertex+t.fragment}function Nw(t,e,r){const n=Wg(t),s=Wg(e);return r.forEach(i=>{Gg(i.vertex,n,i.name),Gg(i.fragment,s,i.name)}),{vertex:Xg(t,n),fragment:Xg(e,s)}}const QT=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,KT=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,XT=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,JT=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,ZT={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},eR={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function tR({bits:t,name:e}){const r=GT({template:{fragment:KT,vertex:QT},bits:[ZT,...t]});return il.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function rR({bits:t,name:e}){return new Sw({name:e,...WT({template:{vertex:XT,fragment:JT},bits:[eR,...t]})})}const nR={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},sR={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Qc={};function iR(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let n=0;n<t;n++)e.push(`@group(1) @binding(${r++}) var textureSource${n+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${n+1}: sampler;`)}return e.join(`
`)}function oR(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function aR(t){return Qc[t]||(Qc[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${iR(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${oR(t)}
            `}}),Qc[t]}const Kc={};function lR(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function cR(t){return Kc[t]||(Kc[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${lR(t)}
            `}}),Kc[t]}const uR={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},hR={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Jg={};function dR(t){let e=Jg[t];if(e)return e;const r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=n;return e=Jg[t]=new Ew({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class fR extends Wd{constructor(e){const r=rR({name:"batch",bits:[sR,cR(e),hR]}),n=tR({name:"batch",bits:[nR,aR(e),uR]});super({glProgram:r,gpuProgram:n,resources:{batchSamplers:dR(e)}})}}let Zg=null;const zw=class Lw extends IT{constructor(){super(...arguments),this.geometry=new LT,this.shader=Zg||(Zg=new fR(this.maxTextures)),this.name=Lw.extension.name,this.vertexSize=6}packAttributes(e,r,n,s,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,{positions:m,uvs:A}=e,g=e.color,y=e.attributeOffset,b=y+e.attributeSize;for(let x=y;x<b;x++){const w=x*2,V=m[w],_=m[w+1];r[s++]=l*V+u*_+d,r[s++]=h*_+c*V+f,r[s++]=A[w],r[s++]=A[w+1],n[s++]=g,n[s++]=o}}packQuadAttributes(e,r,n,s,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,m=e.bounds,A=m.maxX,g=m.minX,y=m.maxY,b=m.minY,x=o.uvs,w=e.color,V=i<<16|e.roundPixels&65535;r[s+0]=l*g+u*b+d,r[s+1]=h*b+c*g+f,r[s+2]=x.x0,r[s+3]=x.y0,n[s+4]=w,n[s+5]=V,r[s+6]=l*A+u*b+d,r[s+7]=h*b+c*A+f,r[s+8]=x.x1,r[s+9]=x.y1,n[s+10]=w,n[s+11]=V,r[s+12]=l*A+u*y+d,r[s+13]=h*y+c*A+f,r[s+14]=x.x2,r[s+15]=x.y2,n[s+16]=w,n[s+17]=V,r[s+18]=l*g+u*y+d,r[s+19]=h*y+c*g+f,r[s+20]=x.x3,r[s+21]=x.y3,n[s+22]=w,n[s+23]=V}};zw.extension={type:[te.Batcher],name:"default"};let pR=zw;function mR(t,e,r,n,s,i,o,a=null){let l=0;r*=e,s*=i;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,m=a.ty;for(;l<o;){const A=t[r],g=t[r+1];n[s]=c*A+h*g+f,n[s+1]=u*A+d*g+m,s+=i,r+=e,l++}}function gR(t,e,r,n){let s=0;for(e*=r;s<n;)t[e]=0,t[e+1]=0,e+=r,s++}function Dw(t,e,r,n,s){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),n||(n=2),s||(s=t.length/n-r);let h=r*n;for(let d=0;d<s;d++){const f=t[h],m=t[h+1];t[h]=i*f+a*m+c,t[h+1]=o*f+l*m+u,h+=n}}const AR=new ge;class Fw{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,n=this.renderable;return n?iw(r,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||AR}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const zi={extension:{type:te.ShapeBuilder,name:"circle"},build(t,e){let r,n,s,i,o,a;if(t.type==="circle"){const w=t;r=w.x,n=w.y,o=a=w.radius,s=i=0}else if(t.type==="ellipse"){const w=t;r=w.x,n=w.y,o=w.halfWidth,a=w.halfHeight,s=i=0}else{const w=t,V=w.width/2,_=w.height/2;r=w.x+V,n=w.y+_,o=a=Math.max(0,Math.min(w.radius,Math.min(V,_))),s=V-o,i=_-a}if(!(o>=0&&a>=0&&s>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(s?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+s,e[1]=e[3]=n+i,e[2]=e[4]=r-s,e[5]=e[7]=n-i,e;let u=0,h=l*4+(s?2:0)+2,d=h,f=c,m=s+o,A=i,g=r+m,y=r-m,b=n+A;if(e[u++]=g,e[u++]=b,e[--h]=b,e[--h]=y,i){const w=n-A;e[d++]=y,e[d++]=w,e[--f]=w,e[--f]=g}for(let w=1;w<l;w++){const V=Math.PI/2*(w/l),_=s+Math.cos(V)*o,v=i+Math.sin(V)*a,S=r+_,E=r-_,R=n+v,I=n-v;e[u++]=S,e[u++]=R,e[--h]=R,e[--h]=E,e[d++]=E,e[d++]=I,e[--f]=I,e[--f]=S}m=s,A=i+a,g=r+m,y=r-m,b=n+A;const x=n-A;return e[u++]=g,e[u++]=b,e[--f]=x,e[--f]=g,s&&(e[u++]=y,e[u++]=b,e[--f]=x,e[--f]=y),e},triangulate(t,e,r,n,s,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=n;e[l*r]=o,e[l*r+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(s[i++]=l,s[i++]=c,s[i++]=l-1),l++;s[i++]=c+1,s[i++]=c,s[i++]=l-1}},yR={...zi,extension:{...zi.extension,name:"ellipse"}},xR={...zi,extension:{...zi.extension,name:"roundedRectangle"}},Uw=1e-4,eA=1e-4;function bR(t){const e=t.length;if(e<6)return 1;let r=0;for(let n=0,s=t[e-2],i=t[e-1];n<e;n+=2){const o=t[n],a=t[n+1];r+=(o-s)*(a+i),s=o,i=a}return r<0?-1:1}function tA(t,e,r,n,s,i,o,a){const l=t-r*s,c=e-n*s,u=t+r*i,h=e+n*i;let d,f;o?(d=n,f=-r):(d=-n,f=r);const m=l+d,A=c+f,g=u+d,y=h+f;return a.push(m,A),a.push(g,y),2}function cn(t,e,r,n,s,i,o,a){const l=r-t,c=n-e;let u=Math.atan2(l,c),h=Math.atan2(s-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,m=Math.abs(f),A=Math.sqrt(l*l+c*c),g=(15*m*Math.sqrt(A)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(t,e),o.push(r,n);for(let b=1,x=d;b<g;b++,x+=y)o.push(t,e),o.push(t+Math.sin(x)*A,e+Math.cos(x)*A);o.push(t,e),o.push(s,i)}else{o.push(r,n),o.push(t,e);for(let b=1,x=d;b<g;b++,x+=y)o.push(t+Math.sin(x)*A,e+Math.cos(x)*A),o.push(t,e);o.push(s,i),o.push(t,e)}return g*2}function wR(t,e,r,n,s,i){const o=Uw;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let M=bR(t);l=(l-.5)*M+.5}const c=new gt(t[0],t[1]),u=new gt(t[t.length-2],t[t.length-1]),h=n,d=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),d&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const M=(c.x+u.x)*.5,T=(u.y+c.y)*.5;t.unshift(M,T),t.push(M,T)}const f=s,m=t.length/2;let A=t.length;const g=f.length/2,y=a.width/2,b=y*y,x=a.miterLimit*a.miterLimit;let w=t[0],V=t[1],_=t[2],v=t[3],S=0,E=0,R=-(V-v),I=w-_,B=0,z=0,L=Math.sqrt(R*R+I*I);R/=L,I/=L,R*=y,I*=y;const U=l,q=(1-U)*2,k=U*2;h||(a.cap==="round"?A+=cn(w-R*(q-k)*.5,V-I*(q-k)*.5,w-R*q,V-I*q,w+R*k,V+I*k,f,!0)+2:a.cap==="square"&&(A+=tA(w,V,R,I,q,k,!0,f))),f.push(w-R*q,V-I*q),f.push(w+R*k,V+I*k);for(let M=1;M<m-1;++M){w=t[(M-1)*2],V=t[(M-1)*2+1],_=t[M*2],v=t[M*2+1],S=t[(M+1)*2],E=t[(M+1)*2+1],R=-(V-v),I=w-_,L=Math.sqrt(R*R+I*I),R/=L,I/=L,R*=y,I*=y,B=-(v-E),z=_-S,L=Math.sqrt(B*B+z*z),B/=L,z/=L,B*=y,z*=y;const T=_-w,j=V-v,O=_-S,N=E-v,D=T*O+j*N,F=j*O-N*T,G=F<0;if(Math.abs(F)<.001*Math.abs(D)){f.push(_-R*q,v-I*q),f.push(_+R*k,v+I*k),D>=0&&(a.join==="round"?A+=cn(_,v,_-R*q,v-I*q,_-B*q,v-z*q,f,!1)+4:A+=2,f.push(_-B*k,v-z*k),f.push(_+B*q,v+z*q));continue}const Q=(-R+w)*(-I+v)-(-R+_)*(-I+V),re=(-B+S)*(-z+v)-(-B+_)*(-z+E),ie=(T*re-O*Q)/F,ne=(N*Q-j*re)/F,At=(ie-_)*(ie-_)+(ne-v)*(ne-v),Ue=_+(ie-_)*q,it=v+(ne-v)*q,It=_-(ie-_)*k,oe=v-(ne-v)*k,xe=Math.min(T*T+j*j,O*O+N*N),Tf=G?q:k,Mv=xe+Tf*Tf*b;At<=Mv?a.join==="bevel"||At/b>x?(G?(f.push(Ue,it),f.push(_+R*k,v+I*k),f.push(Ue,it),f.push(_+B*k,v+z*k)):(f.push(_-R*q,v-I*q),f.push(It,oe),f.push(_-B*q,v-z*q),f.push(It,oe)),A+=2):a.join==="round"?G?(f.push(Ue,it),f.push(_+R*k,v+I*k),A+=cn(_,v,_+R*k,v+I*k,_+B*k,v+z*k,f,!0)+4,f.push(Ue,it),f.push(_+B*k,v+z*k)):(f.push(_-R*q,v-I*q),f.push(It,oe),A+=cn(_,v,_-R*q,v-I*q,_-B*q,v-z*q,f,!1)+4,f.push(_-B*q,v-z*q),f.push(It,oe)):(f.push(Ue,it),f.push(It,oe)):(f.push(_-R*q,v-I*q),f.push(_+R*k,v+I*k),a.join==="round"?G?A+=cn(_,v,_+R*k,v+I*k,_+B*k,v+z*k,f,!0)+2:A+=cn(_,v,_-R*q,v-I*q,_-B*q,v-z*q,f,!1)+2:a.join==="miter"&&At/b<=x&&(G?(f.push(It,oe),f.push(It,oe)):(f.push(Ue,it),f.push(Ue,it)),A+=2),f.push(_-B*q,v-z*q),f.push(_+B*k,v+z*k),A+=2)}w=t[(m-2)*2],V=t[(m-2)*2+1],_=t[(m-1)*2],v=t[(m-1)*2+1],R=-(V-v),I=w-_,L=Math.sqrt(R*R+I*I),R/=L,I/=L,R*=y,I*=y,f.push(_-R*q,v-I*q),f.push(_+R*k,v+I*k),h||(a.cap==="round"?A+=cn(_-R*(q-k)*.5,v-I*(q-k)*.5,_-R*q,v-I*q,_+R*k,v+I*k,f,!1)+2:a.cap==="square"&&(A+=tA(_,v,R,I,q,k,!1,f)));const P=eA*eA;for(let M=g;M<A+g-2;++M)w=f[M*2],V=f[M*2+1],_=f[(M+1)*2],v=f[(M+1)*2+1],S=f[(M+2)*2],E=f[(M+2)*2+1],!(Math.abs(w*(v-E)+_*(E-V)+S*(V-v))<P)&&i.push(M,M+1,M+2)}function qR(t,e,r,n){const s=Uw;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<s&&Math.abs(o-l)<s,u=r,h=t.length/2,d=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)n.push(d+f,d+f+1);c&&n.push(d+h-1,d)}function Hw(t,e,r,n,s,i,o){const a=gT(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+s,i[o++]=a[c+1]+s,i[o++]=a[c+2]+s;let l=s*n;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=n}const vR=[],VR={extension:{type:te.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,n,s,i){Hw(t,vR,e,r,n,s,i)}},_R={extension:{type:te.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,n=r.x,s=r.y,i=r.width,o=r.height;return i>=0&&o>=0&&(e[0]=n,e[1]=s,e[2]=n+i,e[3]=s,e[4]=n+i,e[5]=s+o,e[6]=n,e[7]=s+o),e},triangulate(t,e,r,n,s,i){let o=0;n*=r,e[n+o]=t[0],e[n+o+1]=t[1],o+=r,e[n+o]=t[2],e[n+o+1]=t[3],o+=r,e[n+o]=t[6],e[n+o+1]=t[7],o+=r,e[n+o]=t[4],e[n+o+1]=t[5],o+=r;const a=n/r;s[i++]=a,s[i++]=a+1,s[i++]=a+2,s[i++]=a+1,s[i++]=a+3,s[i++]=a+2}},SR={extension:{type:te.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,n,s,i){let o=0;n*=r,e[n+o]=t[0],e[n+o+1]=t[1],o+=r,e[n+o]=t[2],e[n+o+1]=t[3],o+=r,e[n+o]=t[4],e[n+o+1]=t[5];const a=n/r;s[i++]=a,s[i++]=a+1,s[i++]=a+2}},kR=new ge,CR=new Le;function PR(t,e,r,n){const s=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(CR);s.translate(-i.x,-i.y),s.scale(1/i.width,1/i.height)}else{s.translate(e.texture.frame.x,e.texture.frame.y),s.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return n&&s.append(kR.copyFrom(n).invert()),s}const al={};Et.handleByMap(te.ShapeBuilder,al);Et.add(_R,VR,SR,zi,yR,xR);const ER=new Le,TR=new ge;function RR(t,e){const{geometryData:r,batches:n}=e;n.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let s=0;s<t.instructions.length;s++){const i=t.instructions[s];if(i.action==="texture")MR(i.data,n,r);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&rA(c.shapePath,l,!0,n,r),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),rA(a,l,o,n,r)}}}function MR(t,e,r){const{vertices:n,uvs:s,indices:i}=r,o=i.length,a=n.length/2,l=[],c=al.rectangle,u=ER,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const d=t.transform;c.build(u,l),d&&Dw(l,d),c.triangulate(l,n,2,a,i,o);const f=h.uvs;s.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const m=Er.get(Fw);m.indexOffset=o,m.indexSize=i.length-o,m.attributeOffset=a,m.attributeSize=n.length/2-a,m.baseColor=t.style,m.alpha=t.alpha,m.texture=h,m.geometryData=r,e.push(m)}function rA(t,e,r,n,s){const{vertices:i,uvs:o,indices:a}=s;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=a.length,d=i.length/2,f=[],m=al[l.type];let A="triangle-list";if(m.build(l,f),c&&Dw(f,c),r){const x=l.closePath??!0,w=e;w.pixelLine?(qR(f,x,i,a),A="line-list"):wR(f,w,!1,x,i,a)}else if(u){const x=[],w=f.slice();IR(u).forEach(_=>{x.push(w.length/2),w.push(..._)}),Hw(w,x,i,2,d,a,h)}else m.triangulate(f,i,2,d,a,h);const g=o.length/2,y=e.texture;if(y!==me.WHITE){const x=PR(TR,e,l,c);mR(i,2,d,o,g,2,i.length/2-d,x)}else gR(o,g,2,i.length/2-d);const b=Er.get(Fw);b.indexOffset=h,b.indexSize=a.length-h,b.attributeOffset=d,b.attributeSize=i.length/2-d,b.baseColor=e.color,b.alpha=e.alpha,b.texture=y,b.geometryData=s,b.topology=A,n.push(b)})}function IR(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r].shape,s=[];al[n.type].build(n,s),e.push(s)}return e}class jR{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class OR{constructor(){this.batcher=new pR,this.instructions=new cw}init(){this.instructions.reset()}get geometry(){return je(tE,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Jd=class yh{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){yh.defaultOptions.bezierSmoothness=e?.bezierSmoothness??yh.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),RR(e,r);const n=e.batchMode;e.customShader||n==="no-batch"?r.isBatchable=!1:n==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=Er.get(OR),{batches:n,geometryData:s}=this._gpuContextHash[e.uid],i=s.vertices.length,o=s.indices.length;for(let u=0;u<n.length;u++)n[u].applyTransform=!1;const a=r.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let u=0;u<n.length;u++){const h=n[u];a.add(h)}a.finish(r.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=CT(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new jR;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(Er.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(n=>{Er.return(n)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};Jd.extension={type:[te.WebGLSystem,te.WebGPUSystem,te.CanvasSystem],name:"graphicsContext"};Jd.defaultOptions={bezierSmoothness:.5};let $w=Jd;const BR=8,Wo=11920929e-14,NR=1;function Gw(t,e,r,n,s,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??$w.defaultOptions.bezierSmoothness));let d=(NR-h)/1;return d*=d,zR(e,r,n,s,i,o,a,l,t,d),t}function zR(t,e,r,n,s,i,o,a,l,c){xh(t,e,r,n,s,i,o,a,l,c,0),l.push(o,a)}function xh(t,e,r,n,s,i,o,a,l,c,u){if(u>BR)return;const h=(t+r)/2,d=(e+n)/2,f=(r+s)/2,m=(n+i)/2,A=(s+o)/2,g=(i+a)/2,y=(h+f)/2,b=(d+m)/2,x=(f+A)/2,w=(m+g)/2,V=(y+x)/2,_=(b+w)/2;if(u>0){let v=o-t,S=a-e;const E=Math.abs((r-o)*S-(n-a)*v),R=Math.abs((s-o)*S-(i-a)*v);if(E>Wo&&R>Wo){if((E+R)*(E+R)<=c*(v*v+S*S)){l.push(V,_);return}}else if(E>Wo){if(E*E<=c*(v*v+S*S)){l.push(V,_);return}}else if(R>Wo){if(R*R<=c*(v*v+S*S)){l.push(V,_);return}}else if(v=V-(t+o)/2,S=_-(e+a)/2,v*v+S*S<=c){l.push(V,_);return}}xh(t,e,h,d,y,b,V,_,l,c,u+1),xh(V,_,x,w,A,g,o,a,l,c,u+1)}const LR=8,DR=11920929e-14,FR=1;function UR(t,e,r,n,s,i,o,a){const c=Math.min(.99,Math.max(0,a??$w.defaultOptions.bezierSmoothness));let u=(FR-c)/1;return u*=u,HR(e,r,n,s,i,o,t,u),t}function HR(t,e,r,n,s,i,o,a){bh(o,t,e,r,n,s,i,a,0),o.push(s,i)}function bh(t,e,r,n,s,i,o,a,l){if(l>LR)return;const c=(e+n)/2,u=(r+s)/2,h=(n+i)/2,d=(s+o)/2,f=(c+h)/2,m=(u+d)/2;let A=i-e,g=o-r;const y=Math.abs((n-i)*g-(s-o)*A);if(y>DR){if(y*y<=a*(A*A+g*g)){t.push(f,m);return}}else if(A=f-(e+i)/2,g=m-(r+o)/2,A*A+g*g<=a){t.push(f,m);return}bh(t,e,r,c,u,f,m,a,l+1),bh(t,f,m,h,d,i,o,a,l+1)}function Ww(t,e,r,n,s,i,o,a){let l=Math.abs(s-i);(!o&&s>i||o&&i>s)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=s;c*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),m=e+d*n,A=r+f*n;t.push(m,A),u+=c}}function $R(t,e,r,n,s,i){const o=t[t.length-2],l=t[t.length-1]-r,c=o-e,u=s-r,h=n-e,d=Math.abs(l*h-c*u);if(d<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const f=l*l+c*c,m=u*u+h*h,A=l*u+c*h,g=i*Math.sqrt(f)/d,y=i*Math.sqrt(m)/d,b=g*A/f,x=y*A/m,w=g*h+y*c,V=g*u+y*l,_=c*(y+b),v=l*(y+b),S=h*(g+x),E=u*(g+x),R=Math.atan2(v-V,_-w),I=Math.atan2(E-V,S-w);Ww(t,w+e,V+r,i,R,I,c*u>h*l)}const Vi=Math.PI*2,Xc={centerX:0,centerY:0,ang1:0,ang2:0},Jc=({x:t,y:e},r,n,s,i,o,a,l)=>{t*=r,e*=n;const c=s*t-i*e,u=i*t+s*e;return l.x=c+o,l.y=u+a,l};function GR(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=e===1.5707963267948966?.551915024494:r,s=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:s-i*n,y:i+s*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const nA=(t,e,r,n)=>{const s=t*n-e*r<0?-1:1;let i=t*r+e*n;return i>1&&(i=1),i<-1&&(i=-1),s*Math.acos(i)},WR=(t,e,r,n,s,i,o,a,l,c,u,h,d)=>{const f=Math.pow(s,2),m=Math.pow(i,2),A=Math.pow(u,2),g=Math.pow(h,2);let y=f*m-f*g-m*A;y<0&&(y=0),y/=f*g+m*A,y=Math.sqrt(y)*(o===a?-1:1);const b=y*s/i*h,x=y*-i/s*u,w=c*b-l*x+(t+r)/2,V=l*b+c*x+(e+n)/2,_=(u-b)/s,v=(h-x)/i,S=(-u-b)/s,E=(-h-x)/i,R=nA(1,0,_,v);let I=nA(_,v,S,E);a===0&&I>0&&(I-=Vi),a===1&&I<0&&(I+=Vi),d.centerX=w,d.centerY=V,d.ang1=R,d.ang2=I};function YR(t,e,r,n,s,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*Vi/360),h=Math.cos(a*Vi/360),d=h*(e-n)/2+u*(r-s)/2,f=-u*(e-n)/2+h*(r-s)/2;if(d===0&&f===0)return;i=Math.abs(i),o=Math.abs(o);const m=Math.pow(d,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(o,2);m>1&&(i*=Math.sqrt(m),o*=Math.sqrt(m)),WR(e,r,n,s,i,o,l,c,u,h,d,f,Xc);let{ang1:A,ang2:g}=Xc;const{centerX:y,centerY:b}=Xc;let x=Math.abs(g)/(Vi/4);Math.abs(1-x)<1e-7&&(x=1);const w=Math.max(Math.ceil(x),1);g/=w;let V=t[t.length-2],_=t[t.length-1];const v={x:0,y:0};for(let S=0;S<w;S++){const E=GR(A,g),{x:R,y:I}=Jc(E[0],i,o,h,u,y,b,v),{x:B,y:z}=Jc(E[1],i,o,h,u,y,b,v),{x:L,y:U}=Jc(E[2],i,o,h,u,y,b,v);Gw(t,V,_,R,I,B,z,L,U),V=L,_=U,A+=g}}function QR(t,e,r){const n=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},s=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??r;if(l<=0){s(o,a),i=a;continue}const c=e[(o+1)%e.length],u=n(a,i),h=n(a,c);if(u.len<1e-4||h.len<1e-4){s(o,a),i=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,m=!0):d>0&&(f=-1,m=!0);const A=d/2;let g,y=Math.abs(Math.cos(A)*l/Math.sin(A));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),g=Math.abs(y*Math.sin(A)/Math.cos(A))):g=l;const b=a.x+h.nx*y+-h.ny*g*f,x=a.y+h.ny*y+h.nx*g*f,w=Math.atan2(u.ny,u.nx)+Math.PI/2*f,V=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&t.moveTo(b+Math.cos(w)*g,x+Math.sin(w)*g),t.arc(b,x,g,w,V,m),i=a}}function KR(t,e,r,n){const s=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??r;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],d=s(u,l);let f;if(d<1e-4)f=l;else{const g=Math.min(d/2,c);f=i(l,u,g/d)}const m=s(h,l);let A;if(m<1e-4)A=l;else{const g=Math.min(m/2,c);A=i(l,h,g/m)}a===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,A.x,A.y,n)}}const XR=new Le;class JR{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new sr,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const n=this._currentPoly.points,s=n[n.length-2],i=n[n.length-1];return(s!==e||i!==r)&&n.push(e,r),this}arc(e,r,n,s,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Ww(a,e,r,n,s,i,o),this}arcTo(e,r,n,s,i){this._ensurePoly();const o=this._currentPoly.points;return $R(o,e,r,n,s,i),this}arcToSvg(e,r,n,s,i,o,a){const l=this._currentPoly.points;return YR(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,r,n,s,i),this}bezierCurveTo(e,r,n,s,i,o,a){this._ensurePoly();const l=this._currentPoly;return Gw(this._currentPoly.points,l.lastX,l.lastY,e,r,n,s,i,o,a),this}quadraticCurveTo(e,r,n,s,i){this._ensurePoly();const o=this._currentPoly;return UR(this._currentPoly.points,o.lastX,o.lastY,e,r,n,s,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const n=this.shapePrimitives,s=n.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&n.length-s>1){let i=null;for(let o=s;o<n.length;o++){const a=n[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),n.copyWithin(o,o+1),n.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,n,s,i){return this.drawShape(new Le(e,r,n,s),i),this}circle(e,r,n,s){return this.drawShape(new Qd(e,r,n),s),this}poly(e,r,n){const s=new vi(e);return s.closePath=r,this.drawShape(s,n),this}regularPoly(e,r,n,s,i=0,o){s=Math.max(s|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/s,c=[];for(let u=0;u<s;u++){const h=a-u*l;c.push(e+n*Math.cos(h),r+n*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,r,n,s,i,o=0,a){if(s=Math.max(s|0,3),i<=0)return this.regularPoly(e,r,n,s,o);const l=n*Math.sin(Math.PI/s)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/s,h=(s-2)*Math.PI/s/2;for(let d=0;d<s;d++){const f=d*u+c,m=e+n*Math.cos(f),A=r+n*Math.sin(f),g=f+Math.PI+h,y=f-Math.PI-h,b=m+i*Math.cos(g),x=A+i*Math.sin(g),w=m+i*Math.cos(y),V=A+i*Math.sin(y);d===0?this.moveTo(b,x):this.lineTo(b,x),this.quadraticCurveTo(m,A,w,V,a)}return this.closePath()}roundShape(e,r,n=!1,s){return e.length<3?this:(n?KR(this,e,r,s):QR(this,e,r),this.closePath())}filletRect(e,r,n,s,i){if(i===0)return this.rect(e,r,n,s);const o=Math.min(n,s)/2,a=Math.min(o,Math.max(-o,i)),l=e+n,c=r+s,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+n-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,n,s,i,o){if(i<=0)return this.rect(e,r,n,s);const a=Math.min(i,Math.min(n,s)/2),l=e+n,c=r+s,u=[e+a,r,l-a,r,l,r+a,l,c-a,l-a,c,e+a,c,e,c-a,e,r+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,r,n,s,i){return this.drawShape(new Kd(e,r,n,s),i),this}roundRect(e,r,n,s,i,o){return this.drawShape(new Xd(e,r,n,s,i),o),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let n=this._currentPoly;return n&&this.endPoly(),n=new vi,n.points.push(e,r),this._currentPoly=n,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new vi,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let n=r.shape.x,s=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,o=n;n=i.a*n+i.c*s+i.tx,s=i.b*o+i.d*s+i.ty}this._currentPoly.points.push(n,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const n=e.instructions[r];this[n.action](...n.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let n=0;n<r.length;n++){const s=r[n],i=s.shape.getBounds(XR);s.transform?e.addRect(i,s.transform):e.addRect(i)}return e}}class vs{constructor(e,r=!1){this.instructions=[],this.uid=De("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?wT(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new JR(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,n,s,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(gt.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,n,s,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,n){const s=this.instructions[this.instructions.length-1],i=this.getLastPoint(gt.shared);let o=0,a=0;if(!s||s.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=s.data[0],a=s.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,r,n]}),this._dirty=!0,this}rect(e,r,n,s,i){return this.instructions.push({action:"rect",data:[e,r,n,s,i]}),this._dirty=!0,this}circle(e,r,n,s){return this.instructions.push({action:"circle",data:[e,r,n,s]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,n,s,i,o,a){i||(i=s/2);const l=-1*Math.PI/2+o,c=n*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?i:s,m=d*u+l;h.push(e+f*Math.cos(m),r+f*Math.sin(m))}return this.poly(h,!0,a),this}clone(e=!1){const r=new vs;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const s=this.instructions[n];r.instructions.push({action:s.action,data:s.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,n=e.b,s=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,m=0,A=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],b=y.data;switch(y.action){case"moveTo":case"lineTo":l=b[0],c=b[1],b[0]=r*l+s*c+o,b[1]=n*l+i*c+a;break;case"bezierCurveTo":u=b[0],h=b[1],d=b[2],f=b[3],l=b[4],c=b[5],b[0]=r*u+s*h+o,b[1]=n*u+i*h+a,b[2]=r*d+s*f+o,b[3]=n*d+i*f+a,b[4]=r*l+s*c+o,b[5]=n*l+i*c+a;break;case"quadraticCurveTo":u=b[0],h=b[1],l=b[2],c=b[3],b[0]=r*u+s*h+o,b[1]=n*u+i*h+a,b[2]=r*l+s*c+o,b[3]=n*l+i*c+a;break;case"arcToSvg":l=b[5],c=b[6],m=b[0],A=b[1],b[0]=r*m+s*A,b[1]=n*m+i*A,b[5]=r*l+s*c+o,b[6]=n*l+i*c+a;break;case"circle":b[4]=ti(b[3],e);break;case"rect":b[4]=ti(b[4],e);break;case"ellipse":b[8]=ti(b[8],e);break;case"roundRect":b[5]=ti(b[5],e);break;case"addPath":b[0].transform(e);break;case"poly":b[2]=ti(b[2],e);break;default:Ce("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,n=this.instructions[r];if(!n)return e.x=0,e.y=0,e;for(;n.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;n=this.instructions[r]}switch(n.action){case"moveTo":case"lineTo":e.x=n.data[0],e.y=n.data[1];break;case"quadraticCurveTo":e.x=n.data[2],e.y=n.data[3];break;case"bezierCurveTo":e.x=n.data[4],e.y=n.data[5];break;case"arc":case"arcToSvg":e.x=n.data[5],e.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(e);break}return e}}function ti(t,e){return t?t.prepend(e):e.clone()}function Te(t,e,r){const n=t.getAttribute(e);return n?Number(n):r}function ZR(t,e){const r=t.querySelectorAll("defs");for(let n=0;n<r.length;n++){const s=r[n];for(let i=0;i<s.children.length;i++){const o=s.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=eM(o);break;case"radialgradient":e.defs[o.id]=tM();break}}}}function eM(t){const e=Te(t,"x1",0),r=Te(t,"y1",0),n=Te(t,"x2",1),s=Te(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new Yr(e,r,n,s,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Te(l,"offset",0),u=ut.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function tM(t){return Ce("[SVG Parser] Radial gradients are not yet supported"),new Yr(0,0,1,0)}function sA(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const iA={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Yw(t,e){const r=t.getAttribute("style"),n={},s={},i={strokeStyle:n,fillStyle:s,useFill:!1,useStroke:!1};for(const o in iA){const a=t.getAttribute(o);a&&oA(e,i,o,a.trim())}if(r){const o=r.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");iA[c]&&oA(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?n:null,fillStyle:i.useFill?s:null,useFill:i.useFill,useStroke:i.useStroke}}function oA(t,e,r,n){switch(r){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const s=sA(n);e.strokeStyle.fill=t.defs[s]}else e.strokeStyle.color=ut.shared.setValue(n).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const s=sA(n);e.fillStyle.fill=t.defs[s]}else e.fillStyle.color=ut.shared.setValue(n).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(n);break;case"stroke-opacity":e.strokeStyle.alpha=Number(n);break;case"opacity":e.fillStyle.alpha=Number(n),e.strokeStyle.alpha=Number(n);break}}function rM(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const r={context:e,defs:{},path:new vs};ZR(t,r);const n=t.children,{fillStyle:s,strokeStyle:i}=Yw(t,r);for(let o=0;o<n.length;o++){const a=n[o];a.nodeName.toLowerCase()!=="defs"&&Qw(a,r,s,i)}return e}function Qw(t,e,r,n){const s=t.children,{fillStyle:i,strokeStyle:o}=Yw(t,e);i&&r?r={...r,...i}:i&&(r=i),o&&n?n={...n,...o}:o&&(n=o);const a=!r&&!n;a&&(r={color:0});let l,c,u,h,d,f,m,A,g,y,b,x,w,V,_,v,S;switch(t.nodeName.toLowerCase()){case"path":V=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&Ce("SVG Evenodd fill rule not supported, your svg may render incorrectly"),_=new vs(V,!0),e.context.path(_),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"circle":m=Te(t,"cx",0),A=Te(t,"cy",0),g=Te(t,"r",0),e.context.ellipse(m,A,g,g),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"rect":l=Te(t,"x",0),c=Te(t,"y",0),v=Te(t,"width",0),S=Te(t,"height",0),y=Te(t,"rx",0),b=Te(t,"ry",0),y||b?e.context.roundRect(l,c,v,S,y||b):e.context.rect(l,c,v,S),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"ellipse":m=Te(t,"cx",0),A=Te(t,"cy",0),y=Te(t,"rx",0),b=Te(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,A,y,b),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"line":u=Te(t,"x1",0),h=Te(t,"y1",0),d=Te(t,"x2",0),f=Te(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(d,f),n&&e.context.stroke(n);break;case"polygon":w=t.getAttribute("points"),x=w.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!0),r&&e.context.fill(r),n&&e.context.stroke(n);break;case"polyline":w=t.getAttribute("points"),x=w.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!1),n&&e.context.stroke(n);break;case"g":case"svg":break;default:{Ce(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(r=null);for(let E=0;E<s.length;E++)Qw(s[E],e,r,n)}function nM(t){return ut.isColorLike(t)}function aA(t){return t instanceof ol}function lA(t){return t instanceof Yr}function sM(t){return t instanceof me}function iM(t,e,r){const n=ut.shared.setValue(e??0);return t.color=n.toNumber(),t.alpha=n.alpha===1?r.alpha:n.alpha,t.texture=me.WHITE,{...r,...t}}function oM(t,e,r){return t.texture=e,{...r,...t}}function cA(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function uA(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function aM(t,e){const r={...e,...t},n=ut.shared.setValue(r.color);return r.alpha*=n.alpha,r.color=n.toNumber(),r}function qn(t,e){if(t==null)return null;const r={},n=t;return nM(t)?iM(r,t,e):sM(t)?oM(r,t,e):aA(t)?cA(r,t,e):lA(t)?uA(r,t,e):n.fill&&aA(n.fill)?cA(n,n.fill,e):n.fill&&lA(n.fill)?uA(n,n.fill,e):aM(n,e)}function Oa(t,e){const{width:r,alignment:n,miterLimit:s,cap:i,join:o,pixelLine:a,...l}=e,c=qn(t,l);return c?{width:r,alignment:n,miterLimit:s,cap:i,join:o,pixelLine:a,...c}:null}const lM=new gt,hA=new ge,Zd=class ur extends Ar{constructor(){super(...arguments),this.uid=De("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new vs,this._transform=new ge,this._fillStyle={...ur.defaultFillStyle},this._strokeStyle={...ur.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new sr,this._boundsDirty=!0}clone(){const e=new ur;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=qn(e,ur.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Oa(e,ur.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=qn(e,ur.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=qn(e,ur.defaultStrokeStyle),this}texture(e,r,n,s,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:n||0,dy:s||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?ut.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new vs,this}fill(e,r){let n;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="stroke"?n=s.data.path:n=this._activePath.clone(),n?(e!=null&&(r!==void 0&&typeof e=="number"&&(je(mt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=qn(e,ur.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(gt.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?r=n.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=Oa(e,ur.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],n=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(n);else{r.data.hole=n;break}}return this._initNextPathLocation(),this}arc(e,r,n,s,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,n,s,i,o),this}arcTo(e,r,n,s,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*n+o.c*s+o.tx,o.b*n+o.d*s+o.ty,i),this}arcToSvg(e,r,n,s,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,n,s,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,r,n,s,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*n+l.c*s+l.tx,l.b*n+l.d*s+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,n,s){return this._tick++,this._activePath.ellipse(e,r,n,s,this._transform.clone()),this}circle(e,r,n){return this._tick++,this._activePath.circle(e,r,n,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*e+n.c*r+n.tx,n.b*e+n.d*r+n.ty),this}moveTo(e,r){this._tick++;const n=this._transform,s=this._activePath.instructions,i=n.a*e+n.c*r+n.tx,o=n.b*e+n.d*r+n.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=i,s[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,r,n,s,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*n+o.c*s+o.tx,o.b*n+o.d*s+o.ty,i),this}rect(e,r,n,s){return this._tick++,this._activePath.rect(e,r,n,s,this._transform.clone()),this}roundRect(e,r,n,s,i){return this._tick++,this._activePath.roundRect(e,r,n,s,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,n,s,i=0,o){return this._tick++,this._activePath.regularPoly(e,r,n,s,i,o),this}roundPoly(e,r,n,s,i,o){return this._tick++,this._activePath.roundPoly(e,r,n,s,i,o),this}roundShape(e,r,n,s){return this._tick++,this._activePath.roundShape(e,r,n,s),this}filletRect(e,r,n,s,i){return this._tick++,this._activePath.filletRect(e,r,n,s,i),this}chamferRect(e,r,n,s,i,o){return this._tick++,this._activePath.chamferRect(e,r,n,s,i,o),this}star(e,r,n,s,i=0,o=0){return this._tick++,this._activePath.star(e,r,n,s,i,o,this._transform.clone()),this}svg(e){return this._tick++,rM(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,n,s,i,o){return e instanceof ge?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,n,s,i,o),this)}transform(e,r,n,s,i,o){return e instanceof ge?(this._transform.append(e),this):(hA.set(e,r,n,s,i,o),this._transform.append(hA),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const n=this.instructions[r],s=n.action;if(s==="fill"){const i=n.data;e.addBounds(i.path.bounds)}else if(s==="texture"){const i=n.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(s==="stroke"){const i=n.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let n=!1;for(let s=0;s<r.length;s++){const i=r[s],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const d=c[u].transform,f=d?d.applyInverse(e,lM):e;if(i.action==="fill")n=h.contains(f.x,f.y);else{const A=l;n=h.strokeContains(f.x,f.y,A.width,A.alignment)}const m=o.hole;if(m){const A=m.shapePath?.shapePrimitives;if(A)for(let g=0;g<A.length;g++)A[g].shape.contains(f.x,f.y)&&(n=!1)}if(n)return!0}}return n}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(n),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(n)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Zd.defaultFillStyle={color:16777215,alpha:1,texture:me.WHITE,matrix:null,fill:null,textureSpace:"local"};Zd.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:me.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let gn=Zd;const dA=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function cM(t){const e=[];let r=0;for(let n=0;n<dA.length;n++){const s=`_${dA[n]}`;e[r++]=t[s]}return r=Kw(t._fill,e,r),r=uM(t._stroke,e,r),r=hM(t.dropShadow,e,r),e.join("-")}function Kw(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function uM(t,e,r){return t&&(r=Kw(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function hM(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=ut.shared.setValue(t.color).toNumber()),r}const ef=class ss extends Ar{constructor(e={}){super(),dM(e);const r={...ss.defaultTextStyle,...e};for(const n in r){const s=n;this[s]=r[n]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...ss.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...ss.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...gn.defaultFillStyle,...e},()=>{this._fill=qn({...this._originalFill},gn.defaultFillStyle)})),this._fill=qn(e===0?"black":e,gn.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...gn.defaultStrokeStyle,...e},()=>{this._stroke=Oa({...this._originalStroke},gn.defaultStrokeStyle)})),this._stroke=Oa(e,gn.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=cM(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=ss.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new ss({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(n),this._originalFill?.texture&&this._originalFill.texture.destroy(n),this._stroke?.texture&&this._stroke.texture.destroy(n),this._originalStroke?.texture&&this._originalStroke.texture.destroy(n)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(n,s,i)=>(n[s]=i,r?.(s,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(ut.isColorLike(e)||e instanceof Yr||e instanceof ol)}};ef.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};ef.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Li=ef;function dM(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=Li.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){je(mt,"strokeThickness is now a part of stroke");const r=e.stroke;let n={};if(ut.isColorLike(r))n.color=r;else if(r instanceof Yr||r instanceof ol)n.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))n=r;else throw new Error("Invalid stroke value.");t.stroke={...n,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){je(mt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=Li.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const n=new Yr({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),s=e.fillGradientStops.map(i=>ut.shared.setValue(i).toNumber());s.forEach((i,o)=>{const a=o/(s.length-1);n.addColorStop(a,i)}),t.fill={fill:n}}}class fM{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const n=Qe.get().createCanvas();n.width=e,n.height=r;const s=n.getContext("2d");return{canvas:n,context:s}}getOptimalCanvasAndContext(e,r,n=1){e=Math.ceil(e*n-1e-6),r=Math.ceil(r*n-1e-6),e=Ma(e),r=Ma(r);const s=(e<<17)+(r<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let i=this._canvasPool[s].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:n,height:s}=r,i=(n<<17)+(s<<1);e.context.clearRect(0,0,n,s),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const fA=new fM,pM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function wh(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let s=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!pM.includes(s)&&(s=`"${s}"`),r[n]=s}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const Zc={willReadFrequently:!0},ar=class X{static get experimentalLetterSpacingSupported(){let e=X._experimentalLetterSpacingSupported;if(e!==void 0){const r=Qe.get().getCanvasRenderingContext2D().prototype;e=X._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,s,i,o,a,l,c){this.text=e,this.style=r,this.width=n,this.height=s,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,n=X._canvas,s=r.wordWrap){const i=`${e}:${r.styleKey}`;if(X._measurementCache[i])return X._measurementCache[i];const o=wh(r),a=X.measureFont(o);a.fontSize===0&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const l=X.__context;l.font=o;const u=(s?X._wordWrap(e,r,n):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let b=0;b<u.length;b++){const x=X._measureText(u[b],r.letterSpacing,l);h[b]=x,d=Math.max(d,x)}const f=r._stroke?.width||0;let m=d+f;r.dropShadow&&(m+=r.dropShadow.distance);const A=r.lineHeight||a.fontSize;let g=Math.max(A,a.fontSize+f)+(u.length-1)*(A+r.leading);return r.dropShadow&&(g+=r.dropShadow.distance),new X(e,r,m,g,u,h,A+r.leading,d,a)}static _measureText(e,r,n){let s=!1;X.experimentalLetterSpacingSupported&&(X.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,s=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const i=n.measureText(e);let o=i.width;const a=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-a;if(o>0)if(s)o-=r,c-=r;else{const u=(X.graphemeSegmenter(e).length-1)*r;o+=u,c+=u}return Math.max(o,c)}static _wordWrap(e,r,n=X._canvas){const s=n.getContext("2d",Zc);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=X._collapseSpaces(u),d=X._collapseNewlines(u);let f=!h;const m=r.wordWrapWidth+c,A=X._tokenize(e);for(let g=0;g<A.length;g++){let y=A[g];if(X._isNewline(y)){if(!d){a+=X._addLine(o),f=!h,o="",i=0;continue}y=" "}if(h){const x=X.isBreakingSpace(y),w=X.isBreakingSpace(o[o.length-1]);if(x&&w)continue}const b=X._getFromCache(y,c,l,s);if(b>m)if(o!==""&&(a+=X._addLine(o),o="",i=0),X.canBreakWords(y,r.breakWords)){const x=X.wordWrapSplit(y);for(let w=0;w<x.length;w++){let V=x[w],_=V,v=1;for(;x[w+v];){const E=x[w+v];if(!X.canBreakChars(_,E,y,w,r.breakWords))V+=E;else break;_=E,v++}w+=v-1;const S=X._getFromCache(V,c,l,s);S+i>m&&(a+=X._addLine(o),f=!1,o="",i=0),o+=V,i+=S}}else{o.length>0&&(a+=X._addLine(o),o="",i=0);const x=g===A.length-1;a+=X._addLine(y,!x),f=!1,o="",i=0}else b+i>m&&(f=!1,a+=X._addLine(o),o="",i=0),(o.length>0||!X.isBreakingSpace(y)||f)&&(o+=y,i+=b)}return a+=X._addLine(o,!1),a}static _addLine(e,r=!0){return e=X._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,n,s){let i=n[e];return typeof i!="number"&&(i=X._measureText(e,r,s)+r,n[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!X.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:X._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:X._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let s=0;s<e.length;s++){const i=e[s],o=e[s+1];if(X.isBreakingSpace(i,o)||X._isNewline(i)){n!==""&&(r.push(n),n=""),r.push(i);continue}n+=i}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,s,i){return!0}static wordWrapSplit(e){return X.graphemeSegmenter(e)}static measureFont(e){if(X._fonts[e])return X._fonts[e];const r=X._context;r.font=e;const n=r.measureText(X.METRICS_STRING+X.BASELINE_SYMBOL),s={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return X._fonts[e]=s,s}static clearMetrics(e=""){e?delete X._fonts[e]:X._fonts={}}static get _canvas(){if(!X.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Zc)?.measureText)return X.__canvas=r,r;e=Qe.get().createCanvas()}catch{e=Qe.get().createCanvas()}e.width=e.height=10,X.__canvas=e}return X.__canvas}static get _context(){return X.__context||(X.__context=X._canvas.getContext("2d",Zc)),X.__context}};ar.METRICS_STRING="|ÉqÅ";ar.BASELINE_SYMBOL="M";ar.BASELINE_MULTIPLIER=1.4;ar.HEIGHT_MULTIPLIER=2;ar.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();ar.experimentalLetterSpacing=!1;ar._fonts={};ar._newlines=[10,13];ar._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ar._measurementCache={};let pA=ar;const mA=1e5;function gA(t,e,r,n=0){if(t.texture===me.WHITE&&!t.fill)return ut.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof ol){const s=t.fill,i=e.createPattern(s.texture.source.resource,"repeat"),o=s.transform.copyTo(ge.shared);return o.scale(s.texture.frame.width,s.texture.frame.height),i.setTransform(o),i}else if(t.fill instanceof Yr){const s=t.fill,i=s.type==="linear",o=s.textureSpace==="local";let a=1,l=1;o&&r&&(a=r.width+n,l=r.height+n);let c,u=!1;if(i){const{start:h,end:d}=s;c=e.createLinearGradient(h.x*a,h.y*l,d.x*a,d.y*l),u=Math.abs(d.x-h.x)<Math.abs((d.y-h.y)*.1)}else{const{center:h,innerRadius:d,outerCenter:f,outerRadius:m}=s;c=e.createRadialGradient(h.x*a,h.y*l,d*a,f.x*a,f.y*l,m*a)}if(u&&o&&r){const h=r.lineHeight/l;for(let d=0;d<r.lines.length;d++){const f=(d*r.lineHeight+n/2)/l;s.colorStops.forEach(m=>{const A=f+m.offset*h;c.addColorStop(Math.floor(A*mA)/mA,ut.shared.setValue(m.color).toHex())})}}else s.colorStops.forEach(h=>{c.addColorStop(h.offset,ut.shared.setValue(h.color).toHex())});return c}}else{const s=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(ge.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),s.setTransform(i),s}return Ce("FillStyle not recognised",t),"red"}function Xw(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const s=t[r];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(s[0].length===0||s[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(s))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Jw=class Zw extends Tw{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...Zw.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const n=r.style.clone();r.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=me.WHITE,n._fill.fill=null),this.applyFillAsTint=r.overrideFill;const s=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const i=wh(n);r.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/s):n.fontSize=this.baseRenderedFontSize=s,this._style=n,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=pA.measureFont(i),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(e){const r=Xw(e).filter(g=>!this._currentChars.includes(g)).filter((g,y,b)=>b.indexOf(g)===y);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let n;this._currentPageIndex===-1?n=this._nextPage():n=this.pages[this._currentPageIndex];let{canvas:s,context:i}=n.canvasAndContext,o=n.texture.source;const a=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let d=0,f=!1;const m=s.width/this.resolution,A=s.height/this.resolution;for(let g=0;g<r.length;g++){const y=r[g],b=pA.measureText(y,a,s,!1);b.lineHeight=b.height;const x=b.width*u,w=Math.ceil((a.fontStyle==="italic"?2:1)*x),V=b.height*u,_=w+h*2,v=V+h*2;if(f=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(f=!0,d=Math.ceil(Math.max(v,d))),l+_>m&&(c+=d,d=v,l=0,c+d>A)){o.update();const E=this._nextPage();s=E.canvasAndContext.canvas,i=E.canvasAndContext.context,o=E.texture.source,c=0}const S=x/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:S,kerning:{}},f){this._drawGlyph(i,b,l+h,c+h,u,a);const E=o.width*u,R=o.height*u,I=new Le(l/E*o.width,c/R*o.height,_/E*o.width,v/R*o.height);this.chars[y].texture=new me({source:o,frame:I}),l+=Math.ceil(_)}}o.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return je(mt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const n=this._measureCache;for(let s=0;s<e.length;s++){const i=e[s];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=n[i];l||(l=n[i]=r.measureText(i).width);let c=n[a];c||(c=n[a]=r.measureText(a).width);let u=r.measureText(i+a).width,h=u-(l+c);h&&(this.chars[i].kerning[a]=h),u=r.measureText(i+a).width,h=u-(l+c),h&&(this.chars[a].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=fA.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const n=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),s=new me({source:new Tn({resource:r.canvas,resolution:n,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:s};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,n){r.fontSize=this.baseRenderedFontSize,e.scale(n,n),e.font=wh(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const s=r._stroke,i=s?.width??0;if(s&&(e.lineWidth=i,e.lineJoin=s.join,e.miterLimit=s.miterLimit,e.strokeStyle=gA(s,e)),r._fill&&(e.fillStyle=gA(r._fill,e)),r.dropShadow){const o=r.dropShadow,a=ut.shared.setValue(o.color).toArray(),l=o.blur*n,c=o.distance*n;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*c,e.shadowOffsetY=Math.sin(o.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,n,s,i,o){const a=r.text,l=r.fontProperties,u=(o._stroke?.width??0)*i,h=n+u/2,d=s-u/2,f=l.descent*i,m=r.lineHeight*i;o.stroke&&u&&e.strokeText(a,h,d+m-f),o._fill&&e.fillText(a,h,d+m-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:n}=this.pages[e];fA.returnCanvasAndContext(r),n.destroy(!0)}this.pages=null}};Jw.defaultOptions={textureSize:512,style:new Li,mipmap:!0};let AA=Jw;function mM(t,e,r,n){const s={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=r.baseLineOffset;let i=s.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=m=>{const A=i.width;for(let g=0;g<l.index;g++){const y=m.positions[g];i.chars.push(m.chars[g]),i.charPositions.push(y+A)}i.width+=m.width,a=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let m=i.chars.length-1;if(n){let A=i.chars[m];for(;A===" ";)i.width-=r.chars[A].xAdvance,A=i.chars[--m]}s.width=Math.max(s.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,s.lines.push(i),s.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let m=0;m<t.length+1;m++){let A;const g=m===t.length;g||(A=t[m]);const y=r.chars[A]||r.chars[" "];if(/(?:\s)/.test(A)||A==="\r"||A===`
`||g){if(!a&&e.wordWrap&&i.width+l.width-d>f?(u(),c(l),g||i.charPositions.push(0)):(l.start=i.width,c(l),g||i.charPositions.push(0)),A==="\r"||A===`
`)i.width!==0&&u();else if(!g){const V=y.xAdvance+(y.kerning[o]||0)+d;i.width+=V,i.spaceWidth=V,i.spacesIndex.push(i.charPositions.length),i.chars.push(A)}}else{const w=y.kerning[o]||0,V=y.xAdvance+w+d;l.positions[l.index++]=l.width+w,l.chars.push(A),l.width+=V}o=A}return u(),e.align==="center"?gM(s):e.align==="right"?AM(s):e.align==="justify"&&yM(s),s}function gM(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],n=t.width/2-r.width/2;for(let s=0;s<r.charPositions.length;s++)r.charPositions[s]+=n}}function AM(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],n=t.width-r.width;for(let s=0;s<r.charPositions.length;s++)r.charPositions[s]+=n}}function yM(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const n=t.lines[r];let s=0,i=n.spacesIndex[s++],o=0;const a=n.spacesIndex.length,c=(e-n.width)/a;for(let u=0;u<n.charPositions.length;u++)u===i&&(i=n.spacesIndex[s++],o+=c),n.charPositions[u]+=o}}let Yo=0;class xM{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let n=`${r.fontFamily}-bitmap`,s=!0;if(r._fill.fill&&!r._stroke)n+=r._fill.fill.styleKey,s=!1;else if(r._stroke||r.dropShadow){let o=r.styleKey;o=o.substring(0,o.lastIndexOf("-")),n=`${o}-bitmap`,s=!1}if(!Me.has(n)){const o=new AA({style:r,overrideFill:s,overrideSize:!0,...this.defaultOptions});Yo++,Yo>50&&Ce("BitmapText",`You have dynamically created ${Yo} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Yo--,Me.remove(n)}),Me.set(n,o)}const i=Me.get(n);return i.ensureCharacters?.(e),i}getLayout(e,r,n=!0){const s=this.getFont(e,r);return mM([...e],r,s,n)}measureText(e,r,n=!0){return this.getLayout(e,r,n)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},je(mt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=r?.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const s=r.style,i=s instanceof Li?s:new Li(s),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new AA({style:i,overrideFill:o,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=Xw(r.chars);return a.ensureCharacters(l.join("")),Me.set(`${n}-bitmap`,a),a.once("destroy",()=>Me.remove(`${n}-bitmap`)),a}uninstall(e){const r=`${e}-bitmap`,n=Me.get(r);n&&n.destroy()}}const yA=new xM;class eq extends Tw{constructor(e,r){super();const{textures:n,data:s}=e;Object.keys(s.pages).forEach(i=>{const o=s.pages[parseInt(i,10)],a=n[o.id];this.pages.push({texture:a})}),Object.keys(s.chars).forEach(i=>{const o=s.chars[i],{frame:a,source:l}=n[o.page],c=new Le(o.x+a.x,o.y+a.y,o.width,o.height),u=new me({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:u}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){yA.install(e)}static uninstall(e){yA.uninstall(e)}}const eu={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const A in f){const g=f[A].split("="),y=g[0],b=g[1].replace(/"/gm,""),x=parseFloat(b),w=isNaN(x)?b:x;m[y]=w}r[d].push(m)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=r.info,[i]=r.common,[o]=r.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(s.size,10),n.fontFamily=s.face,n.lineHeight=parseInt(i.lineHeight,10);const a=r.page;for(let h=0;h<a.length;h++)n.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let m=d.letter??d.char??String.fromCharCode(f);m==="space"&&(m=" "),l[f]=m,n.chars[m]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),m=parseInt(u[h].amount,10);n.chars[l[f]].kerning[l[d]]=m}return n}},xA={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],n=t.getElementsByTagName("common")[0],s=t.getElementsByTagName("distanceField")[0];s&&(e.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(n.getAttribute("base"),10);for(let c=0;c<o.length;c++){const u=o[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const u=parseInt(a[c].getAttribute("first"),10),h=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},bA={test(t){return typeof t=="string"&&t.includes("<font>")?xA.test(Qe.get().parseXML(t)):!1},parse(t){return xA.parse(Qe.get().parseXML(t))}},bM=[".xml",".fnt"],wM={extension:{type:te.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof eq,getCacheableAssets(t,e){const r={};return t.forEach(n=>{r[n]=e,r[`${n}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},qM={extension:{type:te.LoadParser,priority:rn.Normal},name:"loadBitmapFont",test(t){return bM.includes(Ft.extname(t).toLowerCase())},async testParse(t){return eu.test(t)||bA.test(t)},async parse(t,e,r){const n=eu.test(t)?eu.parse(t):bA.parse(t),{src:s}=e,{pages:i}=n,o=[],a=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const d=i[h].file;let f=Ft.join(Ft.dirname(s),d);f=dh(f,s),o.push({src:f,data:a})}const l=await r.load(o),c=o.map(h=>l[h.src]);return new eq({data:n,textures:c},s)},async load(t,e){return await(await Qe.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(n=>r.unload(n.texture.source._sourceOrigin))),t.destroy()}};class vM{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const VM={extension:{type:te.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof me),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((s,i)=>{r[n+(i===0?"":i+1)]=s})}),r}};async function tq(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const _M={extension:{type:te.DetectionParser,priority:1},test:async()=>tq("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},wA=["png","jpg","jpeg"],SM={extension:{type:te.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...wA],remove:async t=>t.filter(e=>!wA.includes(e))},kM="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function tf(t){return kM?!1:document.createElement("video").canPlayType(t)!==""}const CM={extension:{type:te.DetectionParser,priority:0},test:async()=>tf("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},PM={extension:{type:te.DetectionParser,priority:0},test:async()=>tf("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},EM={extension:{type:te.DetectionParser,priority:0},test:async()=>tf("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},TM={extension:{type:te.DetectionParser,priority:0},test:async()=>tq("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class RM{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{let s=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||Ce(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,r,this)){i=a;break}}if(!i)return Ce(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await i.load(e,r,this),n.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(s,r,this)&&(s=await a.parse(s,r,this)||s,n.parser=a)}return s})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const s={},i=ja(e),o=tr(e,c=>({alias:[c],src:c,data:{}})),a=o.length,l=o.map(async c=>{const u=Ft.toAbsolute(c.src);if(!s[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),s[c.src]=await this.promiseCache[u].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[u],delete s[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?s[o[0].src]:s}async unload(e){const n=tr(e,s=>({alias:[s],src:s})).map(async s=>{const i=Ft.toAbsolute(s.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,s,this)}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&Ce(`[Assets] loadParser name conflict "${r.name}"`):Ce("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function Bs(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Ns(t,e){const r=t.split("?")[0],n=Ft.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const MM=".json",IM="application/json",jM={extension:{type:te.LoadParser,priority:rn.Low},name:"loadJson",test(t){return Bs(t,IM)||Ns(t,MM)},async load(t){return await(await Qe.get().fetch(t)).json()}},OM=".txt",BM="text/plain",NM={name:"loadTxt",extension:{type:te.LoadParser,priority:rn.Low,name:"loadTxt"},test(t){return Bs(t,BM)||Ns(t,OM)},async load(t){return await(await Qe.get().fetch(t)).text()}},zM=["normal","bold","100","200","300","400","500","600","700","800","900"],LM=[".ttf",".otf",".woff",".woff2"],DM=["font/ttf","font/otf","font/woff","font/woff2"],FM=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function UM(t){const e=Ft.extname(t),s=Ft.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=s.length>0;for(const a of s)if(!a.match(FM)){i=!1;break}let o=s.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const HM=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function $M(t){return HM.test(t)?t:encodeURI(t)}const GM={extension:{type:te.LoadParser,priority:rn.Low},name:"loadWebFont",test(t){return Bs(t,DM)||Ns(t,LM)},async load(t,e){const r=Qe.get().getFontFaceSet();if(r){const n=[],s=e.data?.family??UM(t),i=e.data?.weights?.filter(a=>zM.includes(a))??["normal"],o=e.data??{};for(let a=0;a<i.length;a++){const l=i[a],c=new FontFace(s,`url(${$M(t)})`,{...o,weight:l});await c.load(),r.add(c),n.push(c)}return Me.set(`${s}-and-url`,{url:t,fontFaces:n}),n.length===1?n[0]:n}return Ce("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{Me.remove(`${e.family}-and-url`),Qe.get().getFontFaceSet().delete(e)})}};function rf(t,e=1){const r=Os.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function nf(t,e,r){t.label=r,t._sourceOrigin=r;const n=new me({source:t,label:r}),s=()=>{delete e.promiseCache[r],Me.has(r)&&Me.remove(r)};return n.source.once("destroy",()=>{e.promiseCache[r]&&(Ce("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),n.once("destroy",()=>{t.destroyed||(Ce("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),n}const WM=".svg",YM="image/svg+xml",QM={extension:{type:te.LoadParser,priority:rn.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return Bs(t,YM)||Ns(t,WM)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?XM(t):KM(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function KM(t,e,r,n){const i=await(await Qe.get().fetch(t)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=n,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||rf(t),h=e.data?.width??a.width,d=e.data?.height??a.height;l.width=h*u,l.height=d*u,c.drawImage(a,0,0,h*u,d*u);const{parseAsGraphicsContext:f,...m}=e.data??{},A=new Tn({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...m});return nf(A,r,t)}async function XM(t){const r=await(await Qe.get().fetch(t)).text(),n=new gn;return n.svg(r),n}const JM=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let hs=null,qh=class{constructor(){hs||(hs=URL.createObjectURL(new Blob([JM],{type:"application/javascript"}))),this.worker=new Worker(hs)}};qh.revokeObjectURL=function(){hs&&(URL.revokeObjectURL(hs),hs=null)};const ZM=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ds=null;class rq{constructor(){ds||(ds=URL.createObjectURL(new Blob([ZM],{type:"application/javascript"}))),this.worker=new Worker(ds)}}rq.revokeObjectURL=function(){ds&&(URL.revokeObjectURL(ds),ds=null)};let qA=0,tu;class eI{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new qh;r.addEventListener("message",n=>{r.terminate(),qh.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){tu===void 0&&(tu=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<tu&&(this._createdWorkers++,e=new rq().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((s,i)=>{this._queue.push({id:e,arguments:r,resolve:s,reject:i})});return this._next(),n}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),n=r.id;this._resolveHash[qA]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:qA++,id:n})}}const vA=new eI,tI=[".jpeg",".jpg",".png",".webp",".avif"],rI=["image/jpeg","image/png","image/webp","image/avif"];async function nI(t,e){const r=await Qe.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const n=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}const nq={name:"loadTextures",extension:{type:te.LoadParser,priority:rn.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Bs(t,rI)||Ns(t,tI)},async load(t,e,r){let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await vA.isImageBitmapSupported()?n=await vA.loadImageBitmap(t,e):n=await nI(t,e):n=await new Promise((i,o)=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=t,n.complete?i(n):(n.onload=()=>{i(n)},n.onerror=o)});const s=new Tn({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||rf(t),...e.data});return nf(s,r,t)},unload(t){t.destroy(!0)}},sq=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],sI=sq.map(t=>`video/${t.substring(1)}`);function iI(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=aI(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function oI(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",n),t.addEventListener("error",s),t.load();function n(){i(),e()}function s(o){i(),r(o)}function i(){t.removeEventListener("canplaythrough",n),t.removeEventListener("error",s)}})}function aI(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const lI={name:"loadVideo",extension:{type:te.LoadParser,name:"loadVideo"},test(t){const e=Bs(t,sI),r=Ns(t,sq);return e||r},async load(t,e,r){const n={...ha.defaultOptions,resolution:e.data?.resolution||rf(t),alphaMode:e.data?.alphaMode||await yw(),...e.data},s=document.createElement("video"),i={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&s.setAttribute(l,c)}),n.muted===!0&&(s.muted=!0),iI(s,t,n.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=ha.MIME_TYPES[l]||`video/${l}`}return o.src=t,a&&(o.type=a),new Promise(l=>{const c=async()=>{const u=new ha({...n,resource:s});s.removeEventListener("canplay",c),e.data.preload&&await oI(s),l(nf(u,r,t))};s.addEventListener("canplay",c),s.appendChild(o)})},unload(t){t.destroy(!0)}},iq={extension:{type:te.ResolveParser,name:"resolveTexture"},test:nq.test,parse:t=>({resolution:parseFloat(Os.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},cI={extension:{type:te.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Os.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:iq.parse};class uI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Os,this.loader=new RM,this.cache=Me,this._backgroundLoader=new vM(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){Ce("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,n=typeof r=="number"?[r]:r,s=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const n=ja(e),s=tr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(s),o=await this._mapLoadToResolve(i,r);return n?o[s[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const s=this.resolver.resolveBundle(e),i={},o=Object.keys(s);let a=0,l=0;const c=()=>{r?.(++a/l)},u=o.map(h=>{const d=s[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{i[h]=f})});return await Promise.all(u),n?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Me.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=Me.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const i={};return n.forEach(o=>{const a=s[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(c=>{i[c]=a}),Me.set(l,a)}),i}async unload(e){this._initialized||await this.init();const r=tr(e).map(s=>typeof s!="string"?s.src:s),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=tr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(s=>this._unloadFromResolved(r[s]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{Me.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,s)=>r.indexOf(n)===s),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const fi=new uI;Et.handleByList(te.LoadParser,fi.loader.parsers).handleByList(te.ResolveParser,fi.resolver.parsers).handleByList(te.CacheParser,fi.cache.parsers).handleByList(te.DetectionParser,fi.detections);Et.add(VM,SM,_M,TM,CM,PM,EM,jM,NM,GM,QM,nq,lI,qM,wM,iq,cI);const VA={loader:te.LoadParser,resolver:te.ResolveParser,cache:te.CacheParser,detection:te.DetectionParser};Et.handle(te.Asset,t=>{const e=t.ref;Object.entries(VA).filter(([r])=>!!e[r]).forEach(([r,n])=>Et.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(VA).filter(r=>!!e[r]).forEach(r=>Et.remove(e[r]))});Et.add($P,GP);const oq="/assets/sprites-LF-sXJLF.png";let _i;const hI=async()=>{if(_i!==void 0)return _i;let t;try{t=await fi.load(oq)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=me.EMPTY}const e=new fh(t,Lt);return await e.parse(),e.textureSource.scaleMode="nearest",_i=e,e},dI=()=>{if(_i===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return _i},fI=({className:t,children:e})=>t?p.jsx("div",{className:`contents ${t}`,children:e}):e,pI=t=>t.replaceAll(/(?<!\.)\./g,"_"),H=({children:t,className:e,noSlitWords:r,classnameCycle:n,onClick:s,noTint:i=!1,TagName:o="span",role:a})=>{const l=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(l.length===0)return null;const c=r?[l.toUpperCase()]:l.toUpperCase().split(/\s+/);return p.jsxs(o,{className:e,onClick:s,children:[p.jsx("span",{className:"sr-only",children:l}),c.map((u,h)=>p.jsx("span",{className:rt("text-nowrap inline-block",h===c.length-1?"":"me-1"),children:Array.from(u).map((d,f)=>{const m=`hud.char.${Lb(d)}`;return ih(m)||console.error("no texture for char",d,d.charCodeAt(0),m,"we have:",Object.keys(dI().textures)),p.jsx("span",{role:a,className:`sprite ${ih(m)?`texture-${pI(m)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${n===void 0?"":n[f%n.length]}`},f)})},h))]})},mI=t=>t.props.children!==void 0,xt=({children:t,className:e})=>p.jsx(fI,{className:e,children:Array.isArray(t)?t.map((r,n)=>p.jsx(xt,{children:r},n)):typeof t=="number"?p.jsx(H,{children:String(t)}):typeof t=="string"?p.jsx(H,{children:t}):C.isValidElement(t)?t.type===H||t.type===xt?t:mI(t)?C.cloneElement(t,void 0,typeof t.props.children=="string"?p.jsx(H,{children:`${t.props.children}`}):p.jsx(xt,{children:t.props.children})):t:t});function $(t,e){const r=qd();return C.useCallback(()=>{r(t(e))},[t,r,e])}const gI={count:0},Ba=_r({name:"manualLoading",initialState:gI,reducers:{manualLoadingStarted(t){t.count++},manualLoadingFinished(t){t.count=Math.max(0,t.count-1)}},selectors:{selectManualLoadingCount(t){return t.count}}}),{manualLoadingStarted:AI,manualLoadingFinished:_A}=Ba.actions,{selectManualLoadingCount:yI}=Ba.selectors,xI=t=>{const{queries:e}=t[En.reducerPath],{mutations:r}=t[En.reducerPath],n=Object.values(e??{}).some(o=>o?.status==="pending"),s=Object.values(r??{}).some(o=>o?.status==="pending"),i=yI(t)>0;return n||s||i},aq=Xx(xI),Fe=({className:t,onClick:e})=>aq()?p.jsx(jv,{}):p.jsx("div",{className:`fixed inset-0 z-border ${t??""}`,onClick:e});var ll=Hy();const bI=st(ll),fs=({children:t,scaleFactor:e})=>{const r=ao();return p.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},Ne=({children:t})=>ll.createPortal(p.jsx(fs,{children:t}),document.body),wI=({text:t})=>p.jsxs("div",{className:"flex flex-col h-full items-center justify-center gap-y-1",children:[p.jsx("span",{className:"sprite texture-animated-dalek"}),p.jsx(H,{children:t})]}),qI=()=>p.jsx("div",{className:"flex h-full items-center justify-center loading-border zx:zx-loading-border",children:p.jsx("span",{className:"sprite texture-animated-head_walking_right"})});var Yt={},Jn={},Zn={},SA;function cl(){if(SA)return Zn;SA=1;var t=Zn&&Zn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Zn,"__esModule",{value:!0});const r=t(Ps()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return Zn.default=r,Zn}var kA;function vI(){if(kA)return Jn;kA=1;var t=Jn&&Jn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Jn,"__esModule",{value:!0});const e=t(Ps()),r=t(Hy()),n=t(cl()),s=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(n.default),c=a[i],u=l[i];return c?u?r.default.createPortal(u(o),c,i):r.default.createPortal(o,c,i):null};return Jn.default=s,Jn}var es={},CA;function VI(){if(CA)return es;CA=1;var t=es&&es.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(es,"__esModule",{value:!0});const e=t(Ps()),r=t(cl()),n=({id:s,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(s,c.current,i),()=>l(s)),[s,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${s}`,o].filter(u=>!!u).join(" "),ref:c})};return es.default=n,es}var Br={},PA;function _I(){if(PA)return Br;PA=1;var t=Br&&Br.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=Br&&Br.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Br,"__esModule",{value:!0});const r=e(Ps()),n=e(cl()),s=({children:i})=>{const[o,a]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((f,m,A)=>{a(g=>Object.assign(Object.assign({},g),{[f]:m})),c(g=>Object.assign(Object.assign({},g),{[f]:A}))},[]),h=r.default.useCallback(f=>{a(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])}),c(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])})},[]),d=r.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return r.default.createElement(n.default.Provider,{value:d},i)};return Br.default=s,Br}var EA;function SI(){if(EA)return Yt;EA=1;var t=Yt&&Yt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.Context=Yt.Placeholder=Yt.Provider=void 0;const e=t(vI()),r=t(VI()),n=t(_I()),s=t(cl());Yt.Provider=n.default,Yt.Placeholder=r.default,Yt.Context=s.default;const i=e.default;return i.Context=s.default,i.Placeholder=r.default,i.Provider=n.default,Yt.default=i,Yt}var kI=SI();const Nn=st(kI),CI=()=>({directionVector:ae,lookVector:{...ae},...Rs(jx.map(t=>[t,!1]))});var ri={},Qo={},Ko={},TA;function PI(){if(TA)return Ko;TA=1,Ko.__esModule=!0,Ko.default=s;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function n(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function s(i){var o="".concat(i,"Storage");return n(o)?self[o]:r}return Ko}var RA;function EI(){if(RA)return Qo;RA=1,Qo.__esModule=!0,Qo.default=r;var t=e(PI());function e(n){return n&&n.__esModule?n:{default:n}}function r(n){var s=(0,t.default)(n);return{getItem:function(o){return new Promise(function(a,l){a(s.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(s.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(s.removeItem(o))})}}}return Qo}var MA;function TI(){if(MA)return ri;MA=1,ri.__esModule=!0,ri.default=void 0;var t=e(EI());function e(n){return n&&n.__esModule?n:{default:n}}var r=(0,t.default)("local");return ri.default=r,ri}var RI=TI();const MI=st(RI),ot=t=>{const e=nh.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},II=l_({1:ot,2:ot,3:ot,4:ot,5:ot,6:ot,7:ot,8:ot,9:ot,10:ot,11:ot,12:ot,13:ot,14:ot,15:ot,16:ot,17:ot}),jI=["userSettings","savedGames"],OI=17,BI={key:"hohol/gameMenus/userSettings",version:OI,migrate:II,storage:MI,whitelist:jI},NI=t_(BI,lo.reducer),zI=()=>{Pt()!=="server"&&kx({actionCreator:Dd,effect(t,{dispatch:e,getState:r}){const{emulatedResolution:n}=r().gameMenus.userSettings.displaySettings;n!==void 0&&e(Tb(jd(n)))}})},vh=z0({[lo.reducerPath]:NI,[Ea.reducerPath]:Ea.reducer,[En.reducerPath]:En.reducer,[Ba.reducerPath]:Ba.reducer}).withLazyLoadedSlices();vh.inject;const LI=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?vh(void 0,e):vh(t,e),we=s0({reducer:LI,middleware:t=>t({serializableCheck:{ignoredActions:[ld,ro,cd,ud,hd,dd,fP.type]}}).prepend(Sx.middleware).concat(En.middleware)});zI();const DI=a_(we),ru={x:1,y:0,z:0},nu={x:-1,y:0,z:0},su={x:0,y:-1,z:0},iu={x:0,y:1,z:0},be={away:iu,left:ru,right:nu,towards:su,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:wn(ee(iu,nu)),towardsRight:wn(ee(su,nu)),towardsLeft:wn(ee(su,ru)),awayLeft:wn(ee(iu,ru))},FI={left:{axis:"x",direction:-1},right:{axis:"x",direction:1},towards:{axis:"y",direction:1},away:{axis:"y",direction:-1},lookLeft:{axis:"xLook",direction:-1},lookRight:{axis:"xLook",direction:1},lookUp:{axis:"yLook",direction:1},lookDown:{axis:"yLook",direction:-1}},lq=t=>FI[t],UI=Math.cos(13*(Math.PI/180)),IA=-Math.PI/4,cq=t=>{const e=Math.cos(IA),r=Math.sin(IA);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};wn({x:1,y:2,z:0});wn({x:-1,y:2,z:0});const HI=t=>{const e=A_(t);return e===void 0?ae:be[e]},$I=t=>{const e=md(t);return e===void 0?ae:be[e]},GI=(t,e=UI)=>{const{x:r,y:n}=t,s=Math.sqrt(r*r+n*n);if(s===0)return ae;const i=r/s,o=n/s,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(r)*s,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(n)*s,z:0};return t},WI={"4-way":HI,"8-way":$I,analogue:GI},YI=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),QI={lookLeft:be.left,lookRight:be.right,lookUp:be.away,lookDown:be.towards},KI=.2,XI=45,JI=(t,e)=>!!t.keyboardState.has(e),uq=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},Vh=.5,hq=(t,e,r)=>{for(const n of t.gamepads)if(!(n===null||n.axes.length<=e)){if(r===void 0){if(Math.abs(n.axes[e])>Vh)return!0}else if(n.axes[e]*r>Vh)return!0}return!1},Xo=(t,e,r=!0)=>{const n=Ta(we.getState()),s=n.presses[e];if(t.hudInputState[e])return!0;for(const i of s.keys)if(JI(t,i))return!0;for(const i of s.gamepadButtons)if(uq(t,i))return!0;if(r){const i=lq(e);if(i!==void 0){const o=n.axes[i.axis];for(const a of o)if(hq(t,a,i.direction))return!0}}return!1},jA=t=>{const e=Mx(t);return e>1?Rt(t,1/e):t};class ZI{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=ae;#n=ae;actionsHandled=new Set;#o=()=>{let e,r,n,s;switch("tap"){case(e=this.currentActionPress("left")):return be.left;case(r=this.currentActionPress("right")):return be.right;case(n=this.currentActionPress("away")):return be.away;case(s=this.currentActionPress("towards")):return be.towards}const i=(e!=="released"?1:0)+(r!=="released"?1:0)+(n!=="released"?1:0)+(s!=="released"?1:0);if(i>1)return this.#t;if(i===1)switch("hold"){case e:return be.left;case r:return be.right;case n:return be.away;case s:return be.towards}return ae};*#r(e,r,n){for(const s of r)Xo(e,s,!1)&&(yield n[s])}*#s(e,r,n,s,i){const o=Ta(we.getState()).axes,a=o[r],l=o[n];for(const c of e.gamepads){if(c===null)continue;let u=0,h=0;for(const f of a)c.axes.length<=f||(u+=c.axes[f]*s);for(const f of l)c.axes.length<=f||(h+=c.axes[f]*i);const d={x:u,y:h,z:0};no(d)>KI&&(yield d)}}#a(){const e=this.#e.at(0);if(e===void 0)return ae;let r=[...this.#r(e,Ti,be)],n;if(r.length===1){const[s]=r,i=[...Oe(this.#e).drop(1).map(o=>[...this.#r(o,Ti,be)])];e:for(const o of i){if(o.length>2)break e;if(o.length===2&&o.some(a=>pd(a,s))){const a=o.find(l=>_a(l,s)<.001);if(a!==void 0){n=a;break e}}}if(!n)for(const o of i)o.length===0&&(r=Qx)}return ee(n??ae,...r,...this.#s(e,"x","y",-1,-1))}#l(){const e=this.#e.at(0);return e===void 0?ae:jA(ee(...this.#r(e,Ix,QI),...this.#s(e,"xLook","yLook",-1,-1)))}#i=({lastTime:e})=>{const r=Bd(we.getState()),i=ZC(we.getState())&&r?cq:u=>u,o=WI[r];this.#t=jA(o(ee(i(r==="4-way"?this.#o():this.#a()),this.hudInputState.directionVector))),this.#n=this.#l();const a={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:YI(navigator.getGamepads()),atTime:e};this.#e.unshift(a);const l=e-XI,c=this.#e.findIndex(u=>u.atTime<l);c!==-1&&this.#e.splice(c+1);for(const u of this.actionsHandled)Xo(a,u)||this.actionsHandled.delete(u)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const n=Xo(r,e);if(this.actionsHandled.has(e))return"released";if(n){const s=this.#e.at(1);return(s===void 0?!1:Xo(s,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const n of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(n))return{type:"key",input:n};for(const n of e.gamepads)if(n!==null){for(const[s,i]of n.buttons.entries())if(i.pressed&&(r===void 0||!uq(r,s)))return{type:"gamepadButtons",input:s};for(const[s,i]of n.axes.entries())if(Math.abs(i)>Vh&&(r===void 0||!hq(r,s)))return{type:"gamepadAxes",input:s}}}}get directionVector(){return this.#t}get lookVector(){return this.#n}startTicking(){Ct.shared.add(this.#i,void 0,Ia.INTERACTION)}stopTicking(){Ct.shared.remove(this.#i)}}const ej=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Å","Ä","Ö","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape","§"],tj=t=>ej.includes(t);let rj=1;const nj=()=>rj++,sj=3,OA=({key:t,location:e,repeat:r})=>{if(r)return;const n=t.length===1?t.toUpperCase():t,s=e===sj?`Numpad${n}`:n;if(tj(s))return s;console.warn("unrecognised key",t)},ij=()=>new Map,oj=t=>{const e=s=>{const i=OA(s);i!==void 0&&t.set(i,nj())},r=s=>{const i=OA(s);i!==void 0&&t.delete(i)},n=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",n,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",n,!1)}},dq=C.createContext(null),aj=({children:t})=>{const[e]=C.useState(ij),[r]=C.useState(()=>new ZI(e,CI()));return C.useEffect(()=>{const n=oj(e);return r.startTicking(),()=>{n(),r.stopTicking()}},[r,e]),p.jsx(dq,{value:r,children:t})},sf=()=>{const t=C.useContext(dq);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},bt=({handler:t,action:e,disabled:r=!1})=>{const n=C.useMemo(()=>Array.isArray(e)?e:[e],[e]),s=sf();C.useEffect(()=>{if(r)return;const i=()=>{for(const o of n)if(s.currentActionPress(o)==="tap"){if(!t(o))for(const c of n)s.actionsHandled.add(c);break}};return Ct.shared.add(i),()=>{Ct.shared.remove(i)}},[n,r,s,t])},lj=({handler:t,disabled:e=!1})=>{const r=sf();C.useEffect(()=>{if(e)return;const n=()=>{const s=r.inputTap();s!==void 0&&t(s,r)};return Ct.shared.add(n),()=>{Ct.shared.remove(n)}},[e,t,r])},cj=({flip:t=!1,focussed:e=!1})=>p.jsx(H,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":""),children:e?"⏩⏩":"⁌⁍"}),qe="leading-none [&_[class*='texture-hud']]:mb-oneScaledPix",uj=["menu_select","swop","jump"],Di="data-menuitem_id",fq="data-menuitem_hidden",pq="data-menuitem_disabled",hj=()=>{},K=({id:t,label:e,valueElement:r,flipLeader:n=!1,doubleHeightWhenFocussed:s,onSelect:i=hj,hidden:o=!1,disabled:a=!1,hintInline:l=!1,className:c,hint:u,leader:h})=>{const d=C.useRef(!0),f=ue(g=>g.gameMenus.openMenus.at(0)?.scrollableSelection??!1),m=ue(g=>g.gameMenus.openMenus.at(0)?.focussedItemId===t);bt({action:uj,handler:i,disabled:!m||o||a});const A=p.jsxs("li",{[Di]:t,[fq]:o,[pq]:a,tabIndex:0,className:rt("contents",o?"hidden":"",s&&m?"sprites-double-height":"",m?"selectedMenuItem":"",c),onMouseMove:$(Fd,{focussedItemId:t,scrollableSelection:!1}),onClick:a?void 0:i,children:[h||p.jsx(cj,{flip:n,focussed:m}),p.jsx("div",{ref:g=>{m&&f&&g?.scrollIntoView({behavior:d.current?"instant":"smooth",block:"center"}),d.current=!1},className:rt(r===void 0?"col-span-2":""),children:typeof e=="string"?p.jsx(p.Fragment,{children:p.jsx(H,{children:e})}):e}),r!==void 0&&r,!m||u===void 0||l?null:p.jsx(Nn,{children:typeof u=="string"?p.jsx(H,{className:qe,children:u}):u})]});return l&&u?p.jsxs(p.Fragment,{children:[A,p.jsx("div",{className:"col-span-2 col-start-2 mb-2",children:u})]}):A},Mt=({customLabel:t})=>p.jsx(K,{id:"back",label:t||"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:$(Be)}),mq=()=>{const t=document.body.querySelectorAll(`[${Di}]`);return Array.from(t)},BA=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=we.getState();if(e===void 0)return!0;const r=mq();if(r.length<=1)return!0;const n=r.findIndex(i=>i.getAttribute(Di)===e);if(n===-1)return!0;let s=n;do s=(s+t+r.length)%r.length;while(r[s].getAttribute(fq)==="true"||r[s].getAttribute(pq)==="true");return we.dispatch(Fd({focussedItemId:r[s].getAttribute(Di),scrollableSelection:!0})),!1},dj=t=>{const e=Mb();bt({action:"away",handler:C.useCallback(()=>{if(t.current!==null)return BA(-1)},[t]),disabled:e}),bt({action:"towards",handler:C.useCallback(()=>{if(t.current!==null)return BA(1)},[t]),disabled:e})},Pe=({className:t="",children:e})=>{const r=C.useRef(null);return C.useEffect(()=>{if(r.current===null||we.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const n=mq();we.dispatch(Fd({focussedItemId:n[0].getAttribute(Di),scrollableSelection:!0}))},[]),dj(r),p.jsx("menu",{ref:r,className:rt("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})},nn=({className:t})=>p.jsxs("div",{className:rt("text-redShadow zx:text-zxMagenta sprites-double-height flex flex-row gap-1",t),children:[p.jsx(H,{className:"inline-block scale-[-1]",onClick:$(Be),children:"⏩⏩"}),p.jsx(H,{className:"inline-block",onClick:$(Be),children:"Back"})]});var fj=["second","minute","hour","day","week","month","year"];function pj(t,e){if(e===0)return["just now","right now"];var r=fj[Math.floor(e/2)];return t>1&&(r+="s"),[t+" "+r+" ago","in "+t+" "+r]}var mj=["秒","分钟","小时","天","周","个月","年"];function gj(t,e){if(e===0)return["刚刚","片刻后"];var r=mj[~~(e/2)];return[t+" "+r+"前",t+" "+r+"后"]}var _h={},gq=function(t,e){_h[t]=e},Aj=function(t){return _h[t]||_h.en_US},ou=[60,60,24,7,365/7/12,12];function yj(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function xj(t,e){var r=t<0?1:0;t=Math.abs(t);for(var n=t,s=0;t>=ou[s]&&s<ou.length;s++)t/=ou[s];return t=Math.floor(t),s*=2,t>(s===0?9:1)&&(s+=1),e(t,s,n)[r].replace("%s",t.toString())}function bj(t,e){var r=new Date;return(+r-+yj(t))/1e3}var wj=function(t,e,r){var n=bj(t);return xj(n,Aj(e))};gq("en_US",pj);gq("zh_CN",gj);const qj={"":C.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},NA=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),vj=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),au=t=>t.replace(/^\s+|\s+$/g," "),Je=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),pi=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,n=0;const s=Je("");let i,o;e?(i=Je("p"),o=[s,i],s.c.push(i)):(i=s,o=[s]);let a;const l=(h,d=!0)=>(d&&o.push(h),i.c.push(h),d&&(i=h),h),c=h=>{const d=o.findIndex(f=>f.t===h);o=o.slice(0,d),i=o.at(-1)};for(;a=r.exec(t);){const h=t.substring(n,a.index);if(n=r.lastIndex,h!=="")if(i===s&&e){const d=Je("p",au(h));s.c.push(d),o=[s,d],i=d}else i.c.push(au(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const d=Je("pre",a[4]?NA(a[4]):Je("code",NA(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));s.c.push(d),o=[s],i=s}else if(a[6]){const d=a[6],f=d!==">",m=!!d.match(/\./),A=f?m?"ol":"ul":"blockquote",g=a[5].split(`
`).map(b=>b.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(b=>b.trim()!==""),y=Je(A,f?g.map(b=>Je("li",pi(b).c)):pi(g.join(`
`)).c);s.c.push(y),o=[s,y],i=s}else if(a[8]){const d=Je("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===s){const f=Je("p",d);s.c.push(f),i=f,o=[s,f]}else l(d,!1)}else if(a[10]){const d=o.find(f=>f.t==="a");d&&(d.p.href=a[11])}else if(a[9])l(Je("a"));else if(a[14]){const d="h"+a[14].length;s.c.push(Je(d,pi(a[15]).c)),o=[s],i=s}else if(a[13])s.c.push(Je("h1",pi(a[12]).c)),o=[s],i=s;else if(a[16])l(Je("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const m=s.c;let A;for(A=m.length-1;A>=0&&!vj(m[A]);A--);if(A!==s.c.length-1){const g=s.c.splice(A+1);s.c.push(Je("p",g))}}const f=Je("p");s.c.push(f),o=[s,f],i=f}else if(a[1])s.c.push(Je("hr")),o=[s],i=s;else if(a[17]){const d=a[17].length===2?"strong":"em";o.findIndex(m=>m.t===d)===-1?l(Je(d)):c(d)}}}const u=au(t.substring(n));if(u.length){const h=s.c.at(-1);let d;h?.t==="p"?d=h:e?(d=Je("p"),s.c.push(d)):d=s,d.c.push(u)}return s.c=s.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),s},Vj=(t,e={})=>{const r={...qj,...e},n=(s,i=0)=>{const o=s.t===""?C.Fragment:r[s.t];return C.createElement(o,{...s.p,key:i},s.c.length===0?void 0:s.c.map((a,l)=>typeof a=="string"?a:n(a,l)))};return n(pi(t,!0))},_j=({markdown:t,customComponents:e})=>Vj(t,e),Sj={h2:function({children:e}){return p.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${qe}`,children:p.jsx(xt,{children:e})})},h3:function({children:e}){return p.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:p.jsx(xt,{children:e})})},blockquote:function({children:e}){return p.jsx("blockquote",{className:`${qe} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:p.jsxs(xt,{children:["> ",e]})})},p:function({children:e}){return p.jsx("div",{className:`mb-1 last:mb-0 ${qe}`,children:p.jsx(xt,{children:e})})},a:function({children:e,href:r}){return p.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:p.jsx(xt,{children:e})})},li:function({children:e}){return p.jsx("div",{className:`mb-1 clear-both ${qe}`,children:p.jsxs(xt,{children:[p.jsx(H,{className:"text-metallicBlue zx:text-zxYellow",children:"•"}),e]})})},strong:function({children:e}){return p.jsx(xt,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return p.jsx(xt,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=ao();if(e===void 0)throw new Error("image without src");const n=e.split(/\?|&/);return p.jsx("span",{style:{"--scale":r*2},children:p.jsx("span",{className:rt("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",n.join(" "))})})},hr:function(){return p.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},Ie=({markdown:t,className:e})=>p.jsx("div",{className:`contents ${e}`,children:p.jsx(_j,{customComponents:Sj,markdown:t})}),kj=({userId:t,campaignName:e,label:r})=>p.jsx(K,{id:`campaign-${t}-${e}`,label:r,doubleHeightWhenFocussed:!0,onSelect:$(Oi,{campaignLocator:{userId:t,campaignName:e,version:-1}})}),Cj=({campaigns:t})=>p.jsx(p.Fragment,{children:p.jsx("div",{className:"zx:text-zxCyan  resHandheld:mt-half flex flex-col gap-2",children:Object.values(t).flatMap(e=>p.jsxs("div",{className:"flex flex-col gap-half",children:[p.jsx(H,{className:"text-metallicBlue",children:e.user.username}),Object.values(e.campaigns).map(r=>p.jsxs(p.Fragment,{children:[p.jsx(Pe,{children:p.jsx(kj,{userId:e.user.id,campaignName:r.name,label:`'${r.name}'`})}),p.jsx("div",{className:"pl-3",children:p.jsx(Ie,{className:"text-midGrey",markdown:` v.${r.version} updated ${wj(r.created_at)}`})})]},r.name))]},e.user.id))})}),Pj=t=>{const{data:e,error:r,isLoading:n,refetch:s}=jC({publishedOnly:!0});return C.useEffect(()=>{s()},[s]),p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:$(Be)}),p.jsxs(Se,{tall:!0,className:"bg-metallicBlueHalfbrite selectedMenuItem:text-white text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[Ye()&&p.jsx(nn,{className:"text-highlightBeige"}),p.jsx(H,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-3",children:"Community Contributed"})]}),r!==void 0?p.jsx(wI,{text:"Failed to load campaigns"}):null,n?p.jsx(qI,{}):null,e!==void 0?p.jsx(Cj,{campaigns:e}):null,Ye()||p.jsx(Pe,{children:p.jsx(Mt,{})})]})]})},Aq="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",_e="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow",Ej="**4-way**: true to the 1987 original - move in x directions only",Tj="**8-way**: the original with *4-way* movement, plus *diagonals*",Rj="**analogue**: move in *any* direction with analogue stick",Mj=()=>{const t=Ob();return p.jsx(K,{id:"analogueControl",label:"Directions",leader:p.jsx("span",{className:`${_e} texture-joystick`}),valueElement:p.jsx(H,{className:Aq,children:t}),onSelect:$(xP),hintInline:!0,hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:t==="analogue"?Rj:t==="8-way"?Tj:Ej})})};function yq(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=yq(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function xq(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=yq(t))&&(n&&(n+=" "),n+=e);return n}function Ij(...t){return rt(xq(t))}const jj=t=>t.replace(/ArrowLeft/g,"⬅").replace(/ArrowRight/g,"➡").replace(/ArrowUp/g,"⬆").replace(/ArrowDown/g,"⬇"),zA=t=>{const e=t.map(jj);return e.length===1?`

key: **${e[0]}**`:`

keys: ${e.map(r=>`**${r}**`).join(" or ")}`},Oj=(t,e)=>e?t?`${t}${zA(e)}`:zA(e):t;function kr(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t?.(s),r===!1||!s.defaultPrevented)return e?.(s)}}function LA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function bq(...t){return e=>{let r=!1;const n=t.map(s=>{const i=LA(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():LA(t[s],null)}}}}function zn(...t){return C.useCallback(bq(...t),t)}function wq(t,e=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:d,children:f,...m}=h,A=d?.[t]?.[l]||a,g=C.useMemo(()=>m,Object.values(m));return p.jsx(A.Provider,{value:g,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,m=C.useContext(f);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=a?.[t]||i;return C.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[n,Bj(s,...e)]}function Bj(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function Nj(t){const e=zj(t),r=C.forwardRef((n,s)=>{const{children:i,...o}=n,a=C.Children.toArray(i),l=a.find(Dj);if(l){const c=l.props.children,u=a.map(h=>h===l?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:h);return p.jsx(e,{...o,ref:s,children:C.isValidElement(c)?C.cloneElement(c,void 0,u):null})}return p.jsx(e,{...o,ref:s,children:i})});return r.displayName=`${t}.Slot`,r}function zj(t){const e=C.forwardRef((r,n)=>{const{children:s,...i}=r;if(C.isValidElement(s)){const o=Uj(s),a=Fj(i,s.props);return s.type!==C.Fragment&&(a.ref=n?bq(n,o):o),C.cloneElement(s,a)}return C.Children.count(s)>1?C.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var qq=Symbol("radix.slottable");function Lj(t){const e=({children:r})=>p.jsx(p.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=qq,e}function Dj(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===qq}function Fj(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function Uj(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Hj=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],sn=Hj.reduce((t,e)=>{const r=Nj(`Primitive.${e}`),n=C.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...a,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function $j(t,e){t&&ll.flushSync(()=>t.dispatchEvent(e))}function ul(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...r)=>e.current?.(...r),[])}function Gj(t,e=globalThis?.document){const r=ul(t);C.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var Wj="DismissableLayer",Sh="dismissableLayer.update",Yj="dismissableLayer.pointerDownOutside",Qj="dismissableLayer.focusOutside",DA,vq=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vq=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=C.useContext(vq),[u,h]=C.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=C.useState({}),m=zn(e,v=>h(v)),A=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=A.indexOf(g),b=u?A.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,w=b>=y,V=Jj(v=>{const S=v.target,E=[...c.branches].some(R=>R.contains(S));!w||E||(s?.(v),o?.(v),v.defaultPrevented||a?.())},d),_=Zj(v=>{const S=v.target;[...c.branches].some(R=>R.contains(S))||(i?.(v),o?.(v),v.defaultPrevented||a?.())},d);return Gj(v=>{b===c.layers.size-1&&(n?.(v),!v.defaultPrevented&&a&&(v.preventDefault(),a()))},d),C.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(DA=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),FA(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=DA)}},[u,d,r,c]),C.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),FA())},[u,c]),C.useEffect(()=>{const v=()=>f({});return document.addEventListener(Sh,v),()=>document.removeEventListener(Sh,v)},[]),p.jsx(sn.div,{...l,ref:m,style:{pointerEvents:x?w?"auto":"none":void 0,...t.style},onFocusCapture:kr(t.onFocusCapture,_.onFocusCapture),onBlurCapture:kr(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:kr(t.onPointerDownCapture,V.onPointerDownCapture)})});Vq.displayName=Wj;var Kj="DismissableLayerBranch",Xj=C.forwardRef((t,e)=>{const r=C.useContext(vq),n=C.useRef(null),s=zn(e,n);return C.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),p.jsx(sn.div,{...t,ref:s})});Xj.displayName=Kj;function Jj(t,e=globalThis?.document){const r=ul(t),n=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let l=function(){_q(Yj,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function Zj(t,e=globalThis?.document){const r=ul(t),n=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!n.current&&_q(Qj,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function FA(){const t=new CustomEvent(Sh);document.dispatchEvent(t)}function _q(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?$j(s,i):s.dispatchEvent(i)}var Qr=globalThis?.document?C.useLayoutEffect:()=>{},eO=Uh[" useId ".trim().toString()]||(()=>{}),tO=0;function rO(t){const[e,r]=C.useState(eO());return Qr(()=>{r(n=>n??String(tO++))},[t]),e?`radix-${e}`:""}const nO=["top","right","bottom","left"],Kr=Math.min,Dt=Math.max,Na=Math.round,Jo=Math.floor,dr=t=>({x:t,y:t}),sO={left:"right",right:"left",bottom:"top",top:"bottom"},iO={start:"end",end:"start"};function kh(t,e,r){return Dt(t,Kr(e,r))}function Mr(t,e){return typeof t=="function"?t(e):t}function Ir(t){return t.split("-")[0]}function zs(t){return t.split("-")[1]}function of(t){return t==="x"?"y":"x"}function af(t){return t==="y"?"height":"width"}function Xr(t){return["top","bottom"].includes(Ir(t))?"y":"x"}function lf(t){return of(Xr(t))}function oO(t,e,r){r===void 0&&(r=!1);const n=zs(t),s=lf(t),i=af(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=za(o)),[o,za(o)]}function aO(t){const e=za(t);return[Ch(t),e,Ch(e)]}function Ch(t){return t.replace(/start|end/g,e=>iO[e])}function lO(t,e,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?i:o;default:return[]}}function cO(t,e,r,n){const s=zs(t);let i=lO(Ir(t),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Ch)))),i}function za(t){return t.replace(/left|right|bottom|top/g,e=>sO[e])}function uO(t){return{top:0,right:0,bottom:0,left:0,...t}}function Sq(t){return typeof t!="number"?uO(t):{top:t,right:t,bottom:t,left:t}}function La(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function UA(t,e,r){let{reference:n,floating:s}=t;const i=Xr(e),o=lf(e),a=af(o),l=Ir(e),c=i==="y",u=n.x+n.width/2-s.width/2,h=n.y+n.height/2-s.height/2,d=n[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:n.y-s.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:h};break;case"left":f={x:n.x-s.width,y:h};break;default:f={x:n.x,y:n.y}}switch(zs(e)){case"start":f[o]-=d*(r&&c?-1:1);break;case"end":f[o]+=d*(r&&c?-1:1);break}return f}const hO=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=UA(c,n,l),d=n,f={},m=0;for(let A=0;A<a.length;A++){const{name:g,fn:y}=a[A],{x:b,y:x,data:w,reset:V}=await y({x:u,y:h,initialPlacement:n,placement:d,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=b??u,h=x??h,f={...f,[g]:{...f[g],...w}},V&&m<=50&&(m++,typeof V=="object"&&(V.placement&&(d=V.placement),V.rects&&(c=V.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):V.rects),{x:u,y:h}=UA(c,d,l)),A=-1)}return{x:u,y:h,placement:d,strategy:s,middlewareData:f}};async function Fi(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=Mr(e,t),m=Sq(f),g=a[d?h==="floating"?"reference":"floating":h],y=La(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=h==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),w=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},V=La(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:x,strategy:l}):b);return{top:(y.top-V.top+m.top)/w.y,bottom:(V.bottom-y.bottom+m.bottom)/w.y,left:(y.left-V.left+m.left)/w.x,right:(V.right-y.right+m.right)/w.x}}const dO=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Mr(t,e)||{};if(c==null)return{};const h=Sq(u),d={x:r,y:n},f=lf(s),m=af(f),A=await o.getDimensions(c),g=f==="y",y=g?"top":"left",b=g?"bottom":"right",x=g?"clientHeight":"clientWidth",w=i.reference[m]+i.reference[f]-d[f]-i.floating[m],V=d[f]-i.reference[f],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let v=_?_[x]:0;(!v||!await(o.isElement==null?void 0:o.isElement(_)))&&(v=a.floating[x]||i.floating[m]);const S=w/2-V/2,E=v/2-A[m]/2-1,R=Kr(h[y],E),I=Kr(h[b],E),B=R,z=v-A[m]-I,L=v/2-A[m]/2+S,U=kh(B,L,z),q=!l.arrow&&zs(s)!=null&&L!==U&&i.reference[m]/2-(L<B?R:I)-A[m]/2<0,k=q?L<B?L-B:L-z:0;return{[f]:d[f]+k,data:{[f]:U,centerOffset:L-U-k,...q&&{alignmentOffset:k}},reset:q}}}),fO=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:A=!0,...g}=Mr(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Ir(s),b=Xr(a),x=Ir(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),V=d||(x||!A?[za(a)]:aO(a)),_=m!=="none";!d&&_&&V.push(...cO(a,A,m,w));const v=[a,...V],S=await Fi(e,g),E=[];let R=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&E.push(S[y]),h){const L=oO(s,o,w);E.push(S[L[0]],S[L[1]])}if(R=[...R,{placement:s,overflows:E}],!E.every(L=>L<=0)){var I,B;const L=(((I=i.flip)==null?void 0:I.index)||0)+1,U=v[L];if(U)return{data:{index:L,overflows:R},reset:{placement:U}};let q=(B=R.filter(k=>k.overflows[0]<=0).sort((k,P)=>k.overflows[1]-P.overflows[1])[0])==null?void 0:B.placement;if(!q)switch(f){case"bestFit":{var z;const k=(z=R.filter(P=>{if(_){const M=Xr(P.placement);return M===b||M==="y"}return!0}).map(P=>[P.placement,P.overflows.filter(M=>M>0).reduce((M,T)=>M+T,0)]).sort((P,M)=>P[1]-M[1])[0])==null?void 0:z[0];k&&(q=k);break}case"initialPlacement":q=a;break}if(s!==q)return{reset:{placement:q}}}return{}}}};function HA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function $A(t){return nO.some(e=>t[e]>=0)}const pO=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=Mr(t,e);switch(n){case"referenceHidden":{const i=await Fi(e,{...s,elementContext:"reference"}),o=HA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:$A(o)}}}case"escaped":{const i=await Fi(e,{...s,altBoundary:!0}),o=HA(i,r.floating);return{data:{escapedOffsets:o,escaped:$A(o)}}}default:return{}}}}};async function mO(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Ir(r),a=zs(r),l=Xr(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=Mr(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const gO=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await mO(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},AO=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:b}=g;return{x:y,y:b}}},...l}=Mr(t,e),c={x:r,y:n},u=await Fi(e,l),h=Xr(Ir(s)),d=of(h);let f=c[d],m=c[h];if(i){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=f+u[g],x=f-u[y];f=kh(b,f,x)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",b=m+u[g],x=m-u[y];m=kh(b,m,x)}const A=a.fn({...e,[d]:f,[h]:m});return{...A,data:{x:A.x-r,y:A.y-n,enabled:{[d]:i,[h]:o}}}}}},yO=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Mr(t,e),u={x:r,y:n},h=Xr(s),d=of(h);let f=u[d],m=u[h];const A=Mr(a,e),g=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=d==="y"?"height":"width",w=i.reference[d]-i.floating[x]+g.mainAxis,V=i.reference[d]+i.reference[x]-g.mainAxis;f<w?f=w:f>V&&(f=V)}if(c){var y,b;const x=d==="y"?"width":"height",w=["top","left"].includes(Ir(s)),V=i.reference[h]-i.floating[x]+(w&&((y=o.offset)==null?void 0:y[h])||0)+(w?0:g.crossAxis),_=i.reference[h]+i.reference[x]+(w?0:((b=o.offset)==null?void 0:b[h])||0)-(w?g.crossAxis:0);m<V?m=V:m>_&&(m=_)}return{[d]:f,[h]:m}}}},xO=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Mr(t,e),u=await Fi(e,c),h=Ir(s),d=zs(s),f=Xr(s)==="y",{width:m,height:A}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=d==="end"?"top":"bottom");const b=A-u.top-u.bottom,x=m-u.left-u.right,w=Kr(A-u[g],b),V=Kr(m-u[y],x),_=!e.middlewareData.shift;let v=w,S=V;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(S=x),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(v=b),_&&!d){const R=Dt(u.left,0),I=Dt(u.right,0),B=Dt(u.top,0),z=Dt(u.bottom,0);f?S=m-2*(R!==0||I!==0?R+I:Dt(u.left,u.right)):v=A-2*(B!==0||z!==0?B+z:Dt(u.top,u.bottom))}await l({...e,availableWidth:S,availableHeight:v});const E=await o.getDimensions(a.floating);return m!==E.width||A!==E.height?{reset:{rects:!0}}:{}}}};function hl(){return typeof window<"u"}function Ls(t){return kq(t)?(t.nodeName||"").toLowerCase():"#document"}function Ut(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function xr(t){var e;return(e=(kq(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function kq(t){return hl()?t instanceof Node||t instanceof Ut(t).Node:!1}function ir(t){return hl()?t instanceof Element||t instanceof Ut(t).Element:!1}function mr(t){return hl()?t instanceof HTMLElement||t instanceof Ut(t).HTMLElement:!1}function GA(t){return!hl()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ut(t).ShadowRoot}function uo(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=or(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function bO(t){return["table","td","th"].includes(Ls(t))}function dl(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function cf(t){const e=uf(),r=ir(t)?or(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function wO(t){let e=Jr(t);for(;mr(e)&&!Vs(e);){if(cf(e))return e;if(dl(e))return null;e=Jr(e)}return null}function uf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Vs(t){return["html","body","#document"].includes(Ls(t))}function or(t){return Ut(t).getComputedStyle(t)}function fl(t){return ir(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Jr(t){if(Ls(t)==="html")return t;const e=t.assignedSlot||t.parentNode||GA(t)&&t.host||xr(t);return GA(e)?e.host:e}function Cq(t){const e=Jr(t);return Vs(e)?t.ownerDocument?t.ownerDocument.body:t.body:mr(e)&&uo(e)?e:Cq(e)}function Ui(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=Cq(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),o=Ut(s);if(i){const a=Ph(o);return e.concat(o,o.visualViewport||[],uo(s)?s:[],a&&r?Ui(a):[])}return e.concat(s,Ui(s,[],r))}function Ph(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Pq(t){const e=or(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=mr(t),i=s?t.offsetWidth:r,o=s?t.offsetHeight:n,a=Na(r)!==i||Na(n)!==o;return a&&(r=i,n=o),{width:r,height:n,$:a}}function hf(t){return ir(t)?t:t.contextElement}function ps(t){const e=hf(t);if(!mr(e))return dr(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=Pq(e);let o=(i?Na(r.width):r.width)/n,a=(i?Na(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const qO=dr(0);function Eq(t){const e=Ut(t);return!uf()||!e.visualViewport?qO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function vO(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ut(t)?!1:e}function Rn(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=hf(t);let o=dr(1);e&&(n?ir(n)&&(o=ps(n)):o=ps(t));const a=vO(i,r,n)?Eq(i):dr(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const d=Ut(i),f=n&&ir(n)?Ut(n):n;let m=d,A=Ph(m);for(;A&&n&&f!==m;){const g=ps(A),y=A.getBoundingClientRect(),b=or(A),x=y.left+(A.clientLeft+parseFloat(b.paddingLeft))*g.x,w=y.top+(A.clientTop+parseFloat(b.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=x,c+=w,m=Ut(A),A=Ph(m)}}return La({width:u,height:h,x:l,y:c})}function df(t,e){const r=fl(t).scrollLeft;return e?e.left+r:Rn(xr(t)).left+r}function Tq(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:df(t,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function VO(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",o=xr(n),a=e?dl(e.floating):!1;if(n===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=dr(1);const u=dr(0),h=mr(n);if((h||!h&&!i)&&((Ls(n)!=="body"||uo(o))&&(l=fl(n)),mr(n))){const f=Rn(n);c=ps(n),u.x=f.x+n.clientLeft,u.y=f.y+n.clientTop}const d=o&&!h&&!i?Tq(o,l,!0):dr(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function _O(t){return Array.from(t.getClientRects())}function SO(t){const e=xr(t),r=fl(t),n=t.ownerDocument.body,s=Dt(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Dt(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+df(t);const a=-r.scrollTop;return or(n).direction==="rtl"&&(o+=Dt(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function kO(t,e){const r=Ut(t),n=xr(t),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=uf();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function CO(t,e){const r=Rn(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=mr(t)?ps(t):dr(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=n*i.y;return{width:o,height:a,x:l,y:c}}function WA(t,e,r){let n;if(e==="viewport")n=kO(t,r);else if(e==="document")n=SO(xr(t));else if(ir(e))n=CO(e,r);else{const s=Eq(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return La(n)}function Rq(t,e){const r=Jr(t);return r===e||!ir(r)||Vs(r)?!1:or(r).position==="fixed"||Rq(r,e)}function PO(t,e){const r=e.get(t);if(r)return r;let n=Ui(t,[],!1).filter(a=>ir(a)&&Ls(a)!=="body"),s=null;const i=or(t).position==="fixed";let o=i?Jr(t):t;for(;ir(o)&&!Vs(o);){const a=or(o),l=cf(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||uo(o)&&!l&&Rq(t,o))?n=n.filter(u=>u!==o):s=a,o=Jr(o)}return e.set(t,n),n}function EO(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const o=[...r==="clippingAncestors"?dl(e)?[]:PO(e,this._c):[].concat(r),n],a=o[0],l=o.reduce((c,u)=>{const h=WA(e,u,s);return c.top=Dt(h.top,c.top),c.right=Kr(h.right,c.right),c.bottom=Kr(h.bottom,c.bottom),c.left=Dt(h.left,c.left),c},WA(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function TO(t){const{width:e,height:r}=Pq(t);return{width:e,height:r}}function RO(t,e,r){const n=mr(e),s=xr(e),i=r==="fixed",o=Rn(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=dr(0);if(n||!n&&!i)if((Ls(e)!=="body"||uo(s))&&(a=fl(e)),n){const d=Rn(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else s&&(l.x=df(s));const c=s&&!n&&!i?Tq(s,a):dr(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function lu(t){return or(t).position==="static"}function YA(t,e){if(!mr(t)||or(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return xr(t)===r&&(r=r.ownerDocument.body),r}function Mq(t,e){const r=Ut(t);if(dl(t))return r;if(!mr(t)){let s=Jr(t);for(;s&&!Vs(s);){if(ir(s)&&!lu(s))return s;s=Jr(s)}return r}let n=YA(t,e);for(;n&&bO(n)&&lu(n);)n=YA(n,e);return n&&Vs(n)&&lu(n)&&!cf(n)?r:n||wO(t)||r}const MO=async function(t){const e=this.getOffsetParent||Mq,r=this.getDimensions,n=await r(t.floating);return{reference:RO(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function IO(t){return or(t).direction==="rtl"}const jO={convertOffsetParentRelativeRectToViewportRelativeRect:VO,getDocumentElement:xr,getClippingRect:EO,getOffsetParent:Mq,getElementRects:MO,getClientRects:_O,getDimensions:TO,getScale:ps,isElement:ir,isRTL:IO};function Iq(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function OO(t,e){let r=null,n;const s=xr(t);function i(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const m=Jo(h),A=Jo(s.clientWidth-(u+d)),g=Jo(s.clientHeight-(h+f)),y=Jo(u),x={rootMargin:-m+"px "+-A+"px "+-g+"px "+-y+"px",threshold:Dt(0,Kr(1,l))||1};let w=!0;function V(_){const v=_[0].intersectionRatio;if(v!==l){if(!w)return o();v?o(!1,v):n=setTimeout(()=>{o(!1,1e-7)},1e3)}v===1&&!Iq(c,t.getBoundingClientRect())&&o(),w=!1}try{r=new IntersectionObserver(V,{...x,root:s.ownerDocument})}catch{r=new IntersectionObserver(V,x)}r.observe(t)}return o(!0),i}function BO(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=hf(t),u=s||i?[...c?Ui(c):[],...Ui(e)]:[];u.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const h=c&&a?OO(c,r):null;let d=-1,f=null;o&&(f=new ResizeObserver(y=>{let[b]=y;b&&b.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let m,A=l?Rn(t):null;l&&g();function g(){const y=Rn(t);A&&!Iq(A,y)&&r(),A=y,m=requestAnimationFrame(g)}return r(),()=>{var y;u.forEach(b=>{s&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),h?.(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const NO=gO,zO=AO,LO=fO,DO=xO,FO=pO,QA=dO,UO=yO,HO=(t,e,r)=>{const n=new Map,s={platform:jO,...r},i={...s.platform,_c:n};return hO(t,e,{...s,platform:i})};var pa=typeof document<"u"?C.useLayoutEffect:C.useEffect;function Da(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!Da(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!Da(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function jq(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function KA(t,e){const r=jq(t);return Math.round(e*r)/r}function cu(t){const e=C.useRef(t);return pa(()=>{e.current=t}),e}function $O(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=C.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=C.useState(n);Da(d,n)||f(n);const[m,A]=C.useState(null),[g,y]=C.useState(null),b=C.useCallback(P=>{P!==_.current&&(_.current=P,A(P))},[]),x=C.useCallback(P=>{P!==v.current&&(v.current=P,y(P))},[]),w=i||m,V=o||g,_=C.useRef(null),v=C.useRef(null),S=C.useRef(u),E=l!=null,R=cu(l),I=cu(s),B=cu(c),z=C.useCallback(()=>{if(!_.current||!v.current)return;const P={placement:e,strategy:r,middleware:d};I.current&&(P.platform=I.current),HO(_.current,v.current,P).then(M=>{const T={...M,isPositioned:B.current!==!1};L.current&&!Da(S.current,T)&&(S.current=T,ll.flushSync(()=>{h(T)}))})},[d,e,r,I,B]);pa(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,h(P=>({...P,isPositioned:!1})))},[c]);const L=C.useRef(!1);pa(()=>(L.current=!0,()=>{L.current=!1}),[]),pa(()=>{if(w&&(_.current=w),V&&(v.current=V),w&&V){if(R.current)return R.current(w,V,z);z()}},[w,V,z,R,E]);const U=C.useMemo(()=>({reference:_,floating:v,setReference:b,setFloating:x}),[b,x]),q=C.useMemo(()=>({reference:w,floating:V}),[w,V]),k=C.useMemo(()=>{const P={position:r,left:0,top:0};if(!q.floating)return P;const M=KA(q.floating,u.x),T=KA(q.floating,u.y);return a?{...P,transform:"translate("+M+"px, "+T+"px)",...jq(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:M,top:T}},[r,a,q.floating,u.x,u.y]);return C.useMemo(()=>({...u,update:z,refs:U,elements:q,floatingStyles:k}),[u,z,U,q,k])}const GO=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?QA({element:n.current,padding:s}).fn(r):{}:n?QA({element:n,padding:s}).fn(r):{}}}},WO=(t,e)=>({...NO(t),options:[t,e]}),YO=(t,e)=>({...zO(t),options:[t,e]}),QO=(t,e)=>({...UO(t),options:[t,e]}),KO=(t,e)=>({...LO(t),options:[t,e]}),XO=(t,e)=>({...DO(t),options:[t,e]}),JO=(t,e)=>({...FO(t),options:[t,e]}),ZO=(t,e)=>({...GO(t),options:[t,e]});var eB="Arrow",Oq=C.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return p.jsx(sn.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});Oq.displayName=eB;var tB=Oq;function rB(t){const[e,r]=C.useState(void 0);return Qr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var ff="Popper",[Bq,Nq]=wq(ff),[nB,zq]=Bq(ff),Lq=t=>{const{__scopePopper:e,children:r}=t,[n,s]=C.useState(null);return p.jsx(nB,{scope:e,anchor:n,onAnchorChange:s,children:r})};Lq.displayName=ff;var Dq="PopperAnchor",Fq=C.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=zq(Dq,r),o=C.useRef(null),a=zn(e,o);return C.useEffect(()=>{i.onAnchorChange(n?.current||o.current)}),n?null:p.jsx(sn.div,{...s,ref:a})});Fq.displayName=Dq;var pf="PopperContent",[sB,iB]=Bq(pf),Uq=C.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:m,...A}=t,g=zq(pf,r),[y,b]=C.useState(null),x=zn(e,Q=>b(Q)),[w,V]=C.useState(null),_=rB(w),v=_?.width??0,S=_?.height??0,E=n+(i!=="center"?"-"+i:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(c)?c:[c],B=I.length>0,z={padding:R,boundary:I.filter(aB),altBoundary:B},{refs:L,floatingStyles:U,placement:q,isPositioned:k,middlewareData:P}=$O({strategy:"fixed",placement:E,whileElementsMounted:(...Q)=>BO(...Q,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[WO({mainAxis:s+S,alignmentAxis:o}),l&&YO({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?QO():void 0,...z}),l&&KO({...z}),XO({...z,apply:({elements:Q,rects:re,availableWidth:ie,availableHeight:ne})=>{const{width:At,height:Ue}=re.reference,it=Q.floating.style;it.setProperty("--radix-popper-available-width",`${ie}px`),it.setProperty("--radix-popper-available-height",`${ne}px`),it.setProperty("--radix-popper-anchor-width",`${At}px`),it.setProperty("--radix-popper-anchor-height",`${Ue}px`)}}),w&&ZO({element:w,padding:a}),lB({arrowWidth:v,arrowHeight:S}),d&&JO({strategy:"referenceHidden",...z})]}),[M,T]=Gq(q),j=ul(m);Qr(()=>{k&&j?.()},[k,j]);const O=P.arrow?.x,N=P.arrow?.y,D=P.arrow?.centerOffset!==0,[F,G]=C.useState();return Qr(()=>{y&&G(window.getComputedStyle(y).zIndex)},[y]),p.jsx("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:k?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:F,"--radix-popper-transform-origin":[P.transformOrigin?.x,P.transformOrigin?.y].join(" "),...P.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(sB,{scope:r,placedSide:M,onArrowChange:V,arrowX:O,arrowY:N,shouldHideArrow:D,children:p.jsx(sn.div,{"data-side":M,"data-align":T,...A,ref:x,style:{...A.style,animation:k?void 0:"none"}})})})});Uq.displayName=pf;var Hq="PopperArrow",oB={top:"bottom",right:"left",bottom:"top",left:"right"},$q=C.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=iB(Hq,n),o=oB[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(tB,{...s,ref:r,style:{...s.style,display:"block"}})})});$q.displayName=Hq;function aB(t){return t!==null}var lB=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:s}=e,o=s.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Gq(r),h={start:"0%",center:"50%",end:"100%"}[u],d=(s.arrow?.x??0)+a/2,f=(s.arrow?.y??0)+l/2;let m="",A="";return c==="bottom"?(m=o?h:`${d}px`,A=`${-l}px`):c==="top"?(m=o?h:`${d}px`,A=`${n.floating.height+l}px`):c==="right"?(m=`${-l}px`,A=o?h:`${f}px`):c==="left"&&(m=`${n.floating.width+l}px`,A=o?h:`${f}px`),{data:{x:m,y:A}}}});function Gq(t){const[e,r="center"]=t.split("-");return[e,r]}var cB=Lq,uB=Fq,hB=Uq,dB=$q,fB="Portal",Wq=C.forwardRef((t,e)=>{const{container:r,...n}=t,[s,i]=C.useState(!1);Qr(()=>i(!0),[]);const o=r||s&&globalThis?.document?.body;return o?bI.createPortal(p.jsx(sn.div,{...n,ref:e}),o):null});Wq.displayName=fB;function pB(t,e){return C.useReducer((r,n)=>e[r][n]??r,t)}var mf=t=>{const{present:e,children:r}=t,n=mB(e),s=typeof r=="function"?r({present:n.isPresent}):C.Children.only(r),i=zn(n.ref,gB(s));return typeof r=="function"||n.isPresent?C.cloneElement(s,{ref:i}):null};mf.displayName="Presence";function mB(t){const[e,r]=C.useState(),n=C.useRef(null),s=C.useRef(t),i=C.useRef("none"),o=t?"mounted":"unmounted",[a,l]=pB(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=Zo(n.current);i.current=a==="mounted"?c:"none"},[a]),Qr(()=>{const c=n.current,u=s.current;if(u!==t){const d=i.current,f=Zo(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Qr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const A=Zo(n.current).includes(f.animationName);if(f.target===e&&A&&(l("ANIMATION_END"),!s.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},d=f=>{f.target===e&&(i.current=Zo(n.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function Zo(t){return t?.animationName||"none"}function gB(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var AB=Uh[" useInsertionEffect ".trim().toString()]||Qr;function yB({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,i,o]=xB({defaultProp:e,onChange:r}),a=t!==void 0,l=a?t:s;{const u=C.useRef(t!==void 0);C.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,n])}const c=C.useCallback(u=>{if(a){const h=bB(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function xB({defaultProp:t,onChange:e}){const[r,n]=C.useState(t),s=C.useRef(r),i=C.useRef(e);return AB(()=>{i.current=e},[e]),C.useEffect(()=>{s.current!==r&&(i.current?.(r),s.current=r)},[r,s]),[r,n,i]}function bB(t){return typeof t=="function"}var wB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qB="VisuallyHidden",Yq=C.forwardRef((t,e)=>p.jsx(sn.span,{...t,ref:e,style:{...wB,...t.style}}));Yq.displayName=qB;var vB=Yq,[pl,XF]=wq("Tooltip",[Nq]),ml=Nq(),VB="TooltipProvider",Eh="tooltip.open",[JF,gf]=pl(VB),Hi="Tooltip",[_B,ho]=pl(Hi),Qq=t=>{const{__scopeTooltip:e,children:r,open:n,defaultOpen:s,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=gf(Hi,t.__scopeTooltip),c=ml(e),[u,h]=C.useState(null),d=rO(),f=C.useRef(0),m=o??l.disableHoverableContent,A=a??l.delayDuration,g=C.useRef(!1),[y,b]=yB({prop:n,defaultProp:s??!1,onChange:v=>{v?(l.onOpen(),document.dispatchEvent(new CustomEvent(Eh))):l.onClose(),i?.(v)},caller:Hi}),x=C.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),w=C.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g.current=!1,b(!0)},[b]),V=C.useCallback(()=>{window.clearTimeout(f.current),f.current=0,b(!1)},[b]),_=C.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{g.current=!0,b(!0),f.current=0},A)},[A,b]);return C.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),p.jsx(cB,{...c,children:p.jsx(_B,{scope:e,contentId:d,open:y,stateAttribute:x,trigger:u,onTriggerChange:h,onTriggerEnter:C.useCallback(()=>{l.isOpenDelayedRef.current?_():w()},[l.isOpenDelayedRef,_,w]),onTriggerLeave:C.useCallback(()=>{m?V():(window.clearTimeout(f.current),f.current=0)},[V,m]),onOpen:w,onClose:V,disableHoverableContent:m,children:r})})};Qq.displayName=Hi;var Th="TooltipTrigger",Kq=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=ho(Th,r),i=gf(Th,r),o=ml(r),a=C.useRef(null),l=zn(e,a,s.onTriggerChange),c=C.useRef(!1),u=C.useRef(!1),h=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),p.jsx(uB,{asChild:!0,...o,children:p.jsx(sn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:kr(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:kr(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:kr(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:kr(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:kr(t.onBlur,s.onClose),onClick:kr(t.onClick,s.onClose)})})});Kq.displayName=Th;var Af="TooltipPortal",[SB,kB]=pl(Af,{forceMount:void 0}),Xq=t=>{const{__scopeTooltip:e,forceMount:r,children:n,container:s}=t,i=ho(Af,e);return p.jsx(SB,{scope:e,forceMount:r,children:p.jsx(mf,{present:r||i.open,children:p.jsx(Wq,{asChild:!0,container:s,children:n})})})};Xq.displayName=Af;var _s="TooltipContent",Jq=C.forwardRef((t,e)=>{const r=kB(_s,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,o=ho(_s,t.__scopeTooltip);return p.jsx(mf,{present:n||o.open,children:o.disableHoverableContent?p.jsx(Zq,{side:s,...i,ref:e}):p.jsx(CB,{side:s,...i,ref:e})})}),CB=C.forwardRef((t,e)=>{const r=ho(_s,t.__scopeTooltip),n=gf(_s,t.__scopeTooltip),s=C.useRef(null),i=zn(e,s),[o,a]=C.useState(null),{trigger:l,onClose:c}=r,u=s.current,{onPointerInTransitChange:h}=n,d=C.useCallback(()=>{a(null),h(!1)},[h]),f=C.useCallback((m,A)=>{const g=m.currentTarget,y={x:m.clientX,y:m.clientY},b=MB(y,g.getBoundingClientRect()),x=IB(y,b),w=jB(A.getBoundingClientRect()),V=BB([...x,...w]);a(V),h(!0)},[h]);return C.useEffect(()=>()=>d(),[d]),C.useEffect(()=>{if(l&&u){const m=g=>f(g,u),A=g=>f(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",A)}}},[l,u,f,d]),C.useEffect(()=>{if(o){const m=A=>{const g=A.target,y={x:A.clientX,y:A.clientY},b=l?.contains(g)||u?.contains(g),x=!OB(y,o);b?d():x&&(d(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,d]),p.jsx(Zq,{...t,ref:i})}),[PB,EB]=pl(Hi,{isInside:!1}),TB=Lj("TooltipContent"),Zq=C.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=ho(_s,r),c=ml(r),{onClose:u}=l;return C.useEffect(()=>(document.addEventListener(Eh,u),()=>document.removeEventListener(Eh,u)),[u]),C.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),p.jsx(Vq,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:p.jsxs(hB,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(TB,{children:n}),p.jsx(PB,{scope:r,isInside:!0,children:p.jsx(vB,{id:l.contentId,role:"tooltip",children:s||n})})]})})});Jq.displayName=_s;var ev="TooltipArrow",RB=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=ml(r);return EB(ev,r).isInside?null:p.jsx(dB,{...s,...n,ref:e})});RB.displayName=ev;function MB(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function IB(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function jB(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function OB(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>n!=d>n&&r<(h-c)*(n-u)/(d-u)+c&&(s=!s)}return s}function BB(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),NB(e)}function NB(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var zB=Qq;const LB=({triggerContent:t,tooltipContent:e})=>e?p.jsxs(zB,{children:[p.jsx(Kq,{asChild:!0,children:t}),p.jsx(Xq,{children:p.jsx(fs,{scaleFactor:2,children:p.jsx(Jq,{side:"bottom",align:"end",className:"bg-highlightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?p.jsx("div",{className:"max-w-16",children:p.jsx(Ie,{markdown:e})}):e})})})]}):t,DB=/^(?<modifiers>[⇧⌘^⌥]*)(?<key>.+)$/,FB=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},UB=(t,e,r,n=void 0)=>{const s=t?.join(" ");C.useEffect(()=>{if(!t||t.length===0||n===null)return;const i=n??window,o=a=>{let c=a.target;for(;c&&c!==i;){if(c.classList.contains("no-keyboard-shortcuts"))return;c=c.parentElement}for(const u of t){const h=u.match(DB);if(!h||!h.groups)continue;const{modifiers:d,key:f}=h.groups;if(FB(d)){console.warn(`Invalid shortcut "${u}": duplicate modifiers`);continue}const m=d.includes("^"),A=d.includes("⌘"),g=d.includes("⇧"),y=d.includes("⌥"),b=m||A||g||y,x=m===a.ctrlKey&&A===a.metaKey&&g===a.shiftKey&&y===a.altKey&&(b||!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey);if((y&&a.altKey?a.code.replace(/^Key/,"").toLowerCase():a.key.toLowerCase())===f.toLowerCase()&&x){e||r?.(),a.preventDefault();break}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[e,r,s,n])},HB=({label:t})=>p.jsx(H,{className:"inline-block mr-1 text-lightGrey py-half",noSlitWords:!0,children:t}),vn=({className:t,value:e,onChange:r,trueLabel:n="ON",falseLabel:s="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(n.length,s.length)+1,c=n.padStart(l," "),u=s.padEnd(l," ");UB(o,!1,()=>{r?.(!e,void 0)});const h=p.jsxs("span",{onClick:f=>r?.(!e,f),className:Ij("inline-flex justify-between leading-none",t),children:[i&&p.jsx(HB,{label:i}),p.jsx(H,{role:"switch",className:xq("inline-block w-min h-min py-half px-half",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),d=Oj(typeof a=="string"?a:void 0,o)??a;return p.jsx(LB,{triggerContent:h,tooltipContent:d})},$B=()=>p.jsx(K,{id:"controlOptions",label:"on-screen controls",valueElement:p.jsx(vn,{value:nP()}),onSelect:$(hr,"userSettings.onScreenControls")}),yf="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",xf="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",GB="**world**: Control is relative to directions in the isometric world",WB=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but requires inputting diagonals a lot`,YB=({className:t})=>p.jsxs("span",{children:[p.jsx(H,{className:rt("text-nowrap me-1","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:Ra()?"screen":"world"}),p.jsx(H,{className:rt("text-nowrap","text-moss zx:text-zxBlue selectedMenuItem:text-mossHalfbrite zx:selectedMenuItem:text-zxBlue",t),children:Ra()?"⬅ ➡ ⬆ ⬇":"↖ ↘ ↗ ↙"})]}),QB=()=>{const t=Ra();return p.jsx(K,{id:"screenRelativeControl",label:"input axes",leader:p.jsx("span",{className:`${_e} ${t?"texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections":"texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_worldDirections"}`}),valueElement:p.jsx(YB,{}),onSelect:$(hr,"userSettings.screenRelativeControl"),hintInline:!0,hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:t?WB:GB})})},yn="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",KB=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:yn,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:yn,children:"Cursor"}),"⬇"]});case"ArrowUp":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:yn,children:"Cursor"}),"⬆"]});case"ArrowLeft":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:yn,children:"Cursor"}),"⬅"]});case"ArrowRight":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:yn,children:"Cursor"}),"➡"]});default:return t}},XB=["⬅➡","⬆⬇","R⬅➡","R⬆⬇"],JB=t=>XB[t]??`axis${t}`,ZB=t=>{switch(Am[t]){case"dPadDown":return"d-Pad⬇";case"dPadUp":return"d-Pad⬆";case"dPadLeft":return"d-Pad⬅";case"dPadRight":return"d-Pad➡";case"a":return p.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return p.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return p.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return p.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return Am[t]??t},bf=({action:t,keyClassName:e,className:r,flashingCursor:n=!1})=>{const s=ue(o=>o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput?.presses:Ta(o).presses[t]),i=ue(o=>{const a=lq(t);return a===void 0?Qx:o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput.axes:Ta(o).axes[a.axis]});return p.jsxs("div",{className:r,children:[s.keys.map(o=>p.jsx("span",{className:rt("text-nowrap",e),children:p.jsx(xt,{children:KB(o)})},`key:${o}`)),i.map(o=>p.jsx("span",{className:rt("text-nowrap",e),children:p.jsxs(xt,{children:[p.jsx("span",{className:yn,children:"🕹"}),JB(o)]})},`gamePadAxis:${o}`)),s.gamepadButtons.map(o=>p.jsx("span",{className:rt("text-nowrap",e),children:p.jsxs(xt,{children:[p.jsx("span",{className:yn,children:"🕹"}),ZB(o)]})},`gamePadButton:${o}`)),n&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]})},XA="text-pink zx:text-zxCyan",eN=()=>{const t=ue(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:p.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${qe} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[p.jsx(H,{children:"Press "}),p.jsx(bf,{className:`inline ${XA}`,action:"menu_openOrExit",keyClassName:"me-1"}),p.jsx(H,{children:"when done selecting keys for "}),p.jsx(H,{className:XA,children:t})]})},Ze=({className:t,action:e})=>{const r=ue(n=>n.gameMenus.assigningInput?.action===e);return p.jsx(bf,{className:rt("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:Aq,flashingCursor:r})},tN=({className:t})=>{const e=ue(GC);return p.jsx(H,{className:rt("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},rN=()=>{const t=Ra();return p.jsxs(p.Fragment,{children:[p.jsx(K,{id:"preset",label:p.jsx(H,{className:`inline-block w-6 ${qe}`,children:"key/ button preset"}),valueElement:p.jsx(tN,{}),onSelect:$(wt,"inputPreset")}),p.jsx(K,{id:"left",label:`Left ${t?"⬅":"↖"}`,leader:p.jsx("span",{className:`${_e} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:p.jsx(Ze,{action:"left"}),onSelect:$(Xe,"left")}),p.jsx(K,{id:"right",label:`Right ${t?"➡":"↘"}`,leader:p.jsx("span",{className:`${_e} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:p.jsx(Ze,{action:"right"}),onSelect:$(Xe,"right")}),p.jsx(K,{id:"up",label:`Up ${t?"⬆":"↗"}`,leader:p.jsx("span",{className:`${_e} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:p.jsx(Ze,{action:"away"}),onSelect:$(Xe,"away")}),p.jsx(K,{id:"down",label:`Down ${t?"⬇":"↙"}`,leader:p.jsx("span",{className:`${_e} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:p.jsx(Ze,{action:"towards"}),onSelect:$(Xe,"towards")}),p.jsxs("div",{className:`${qe} col-span-3`,children:[p.jsx(H,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),p.jsx(H,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),p.jsx(K,{id:"jump",label:"Jump",leader:p.jsx("span",{className:`${_e} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:p.jsx(Ze,{action:"jump"}),onSelect:$(Xe,"jump")}),p.jsx(K,{id:"carry",label:"Carry",leader:p.jsx("span",{className:`${_e} texture-bag`}),valueElement:p.jsx(Ze,{action:"carry"}),onSelect:$(Xe,"carry"),hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:"**carrying is heels only**. requires the bag"}),hintInline:!0}),p.jsx(K,{id:"fire",label:p.jsx(H,{className:`inline-block w-6 ${qe}`,children:"fire dough- nuts"}),leader:p.jsx("span",{className:`${_e} texture-doughnuts`}),hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:"**firing doughnuts is head only**. requires the hooter"}),hintInline:!0,valueElement:p.jsx(Ze,{action:"fire"}),onSelect:$(Xe,"fire")}),p.jsx(K,{id:"swop",label:"Swop",valueElement:p.jsx(Ze,{action:"swop"}),onSelect:$(Xe,"swop"),hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:p.jsxs("span",{className:`${_e} texture-blank relative overflow-hidden`,children:[p.jsx("span",{className:`${_e} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),p.jsx("span",{className:`${_e} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),p.jsx(K,{id:"swopHead",label:p.jsx(H,{className:`inline-block w-6 ${qe}`,children:"Swop to head"}),valueElement:p.jsx(Ze,{action:"swop.head"}),onSelect:$(Xe,"swop.head"),hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${_e} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),p.jsx(K,{id:"swopHeels",label:p.jsxs("div",{className:`w-6 ${qe}`,children:[p.jsx(H,{className:"me-1",children:"Swop to"}),p.jsx(H,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:p.jsx(Ze,{action:"swop.heels"}),onSelect:$(Xe,"swop.heels"),hint:p.jsx(Ie,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${_e} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),p.jsx(K,{id:"map",label:"Map",valueElement:p.jsx(Ze,{action:"map"}),onSelect:$(Xe,"map"),leader:p.jsx("span",{className:`${_e} texture-scroll`})}),p.jsx(K,{id:"hold",label:"Pause",valueElement:p.jsx(Ze,{action:"hold"}),onSelect:$(Xe,"hold"),leader:p.jsx("span",{className:`${_e} texture-drum`})}),p.jsxs("div",{className:"col-span-3",children:[p.jsx(H,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${qe} pt-1`,children:"Look controls"}),p.jsx(H,{TagName:"h2",className:`text-midGrey zx:text-zxBlack ${qe}`,children:"useful for seeing more of larger rooms that don't fit on the screen."})]}),p.jsx(K,{id:"lookLeft",label:"Look ⬅",valueElement:p.jsx(Ze,{action:"lookLeft"}),onSelect:$(Xe,"lookLeft")}),p.jsx(K,{id:"lookRight",label:"Look ➡",valueElement:p.jsx(Ze,{action:"lookRight"}),onSelect:$(Xe,"lookRight")}),p.jsx(K,{id:"lookUp",label:"Look ⬆",valueElement:p.jsx(Ze,{action:"lookUp"}),onSelect:$(Xe,"lookUp")}),p.jsx(K,{id:"lookDown",label:"Look ⬇",valueElement:p.jsx(Ze,{action:"lookDown"}),onSelect:$(Xe,"lookDown")}),p.jsx("div",{className:"col-span-3",children:p.jsx(H,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${qe} pt-1`,children:"Remake option toggles"})}),p.jsx(K,{id:"toggleColourisation",label:p.jsx(H,{className:`inline-block w-6 ${qe}`,children:"toggle colour- isation"}),valueElement:p.jsx(Ze,{action:"toggleColourisation"}),onSelect:$(Xe,"toggleColourisation")}),p.jsx(K,{id:"cycleRes",label:p.jsx(H,{className:`inline-block w-6 ${qe}`,children:"cycle res- olution"}),valueElement:p.jsx(Ze,{action:"cycleResolution"}),onSelect:$(Xe,"cycleResolution")})]})},nN=()=>{const t=!Mb();bt({action:"menu_openOrExit",handler:C.useCallback(()=>{we.dispatch(pP())},[]),disabled:t}),lj({handler:C.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&Rb(we.getState())&&we.dispatch(mP(e))},[]),disabled:t})},sN=({showAll:t})=>p.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[p.jsx(H,{className:`block mb-1 ${qe}`,children:"Detected that you are on a phone or tablet"}),p.jsx(H,{className:`block mb-1 ${qe}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),p.jsx(H,{className:`block mb-1 text-midRed zx:text-zxRed ${qe} mb-1`,onClick:t,children:"Tap here to show all settings"})]}),JA=yf+" !gap-y-1 !sprites-normal-height",iN=()=>{nN();const[t,e]=C.useState(!Ye()),r=Ob();return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Be)}),p.jsxs(Se,{tall:!0,wide:!0,className:"bg-white zx:bg-zxWhite pr-0 pl-1",children:[p.jsxs("div",{className:"flex flex-col gap-y-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+xf,children:[Ye()&&p.jsx(nn,{className:"mb-1"}),p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block",children:"control options"}),p.jsxs(Pe,{className:JA,children:[p.jsx(Mj,{}),p.jsx($B,{}),r!=="4-way"&&t&&p.jsx(QB,{})]}),t?p.jsxs(p.Fragment,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),p.jsxs(Pe,{className:JA,children:[p.jsx(rN,{}),Ye()||p.jsx(Mt,{})]})]}):p.jsx(p.Fragment,{children:p.jsx(sN,{showAll:()=>e(!0)})})]}),p.jsx(eN,{})]})]})},oN="/assets/rock-C4e7VvX5.mp3",de=t=>t,ZA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},aN={egyptus:de("texture-crown_egyptus"),blacktooth:de("texture-crown_blacktooth"),bookworld:de("texture-crown_bookworld"),penitentiary:de("texture-crown_penitentiary"),safari:de("texture-crown_safari")},ni=({planet:t,className:e,label:r=t})=>{const n=ue(i=>i.gameMenus.gameInPlay.planetsLiberated[t]),s=!Od();return p.jsxs("div",{className:`flex flex-col ${e}`,children:[p.jsx("span",{className:`sprite block ${aN[t]} ${n?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),p.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${n?"":"colourised:brightness-halfBrite"} ${ZA[t][0]}`}),p.jsx(H,{classnameCycle:s?ZA[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${n?"":"colourised:brightness-halfBrite"}`,children:r})]})},lN=()=>p.jsxs(p.Fragment,{children:[p.jsx(H,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),p.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[p.jsx(ni,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(ni,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(ni,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(ni,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(ni,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),cN=({playMusic:t=!1})=>{const e=aq(),r=$(Be);return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsxs(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,children:[t&&p.jsx("audio",{src:oN,autoPlay:!0,loop:!0}),p.jsx(lN,{}),p.jsx(Pe,{className:"hidden",children:!e&&p.jsx(Mt,{})})]})]})},Ds=t=>p.jsx("div",{className:`col-span-3 h-1 ${t}`}),Fs=({className:t})=>p.jsx("div",{className:rt("contents",t),children:p.jsx(Nn.Placeholder,{})}),uN=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),hN=({resolutionName:t})=>{const e=ue(nl),r=Is[t];return p.jsx(K,{id:t,label:`${e===t?"* ":""}${uN(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:$(Dd,t)},t)},dN=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Be)}),p.jsx(Se,{className:"bg-white pl-1",children:p.jsxs(Nn.Provider,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),p.jsxs(Pe,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[Yx(Is).map(t=>p.jsx(hN,{resolutionName:t})),p.jsx(Ds,{}),p.jsx(Mt,{})]}),p.jsx(Fs,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),fN="/Users/jim/dev/hohjs",pN=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),n=[...t.matchAll(e)],s=[];return r.forEach((i,o)=>{s.push(i);const a=n[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){s.push(l);return}const u=`${fN}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),d=h?`:${h[1]}:${h[2]}`:"",f=`vscode://file${u}${d}`;s.push(p.jsx("a",{href:f,target:"_blank",children:c.pathname},o))}catch{s.push(a[0])}}),p.jsx(C.Fragment,{children:s})},mN=t=>{const{message:e,stack:r}=t;if(!r)return{message:e,sanitizedStack:""};const n=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,s=n.test(r);let i=r;s&&(i=i.replace(n,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},gN=`##The game crashed!
You could:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord server](https://discord.gg/XmV9QNWY)
* play [the msx remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,AN=({errors:t})=>{const e=ue(o=>o.gameMenus.gameInPlay.reincarnationPoint!==void 0),[r,n]=C.useState(!1),s=$(Ld),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=mN(o);return`
${a}

${l}
  `}).join(`
    
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
⬆ ERROR        CAUGHT, WRAPPED, & RETHROWN ⬇
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

`);return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"loading-border"}),p.jsx(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,children:p.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[p.jsx(Ie,{markdown:gN}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsxs(Pe,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${qe}`,children:[p.jsx(K,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:$(ag,"ignore")}),e&&p.jsx(K,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:s}),p.jsx(K,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:$(ag,"clearAllData")}),r?p.jsx(H,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):p.jsx(K,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>n(!0))})]}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsx(H,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),p.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max min-w-full",children:p.jsx(pN,{children:i})})]})})]})},yN=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>p.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:Pt()==="desktop"?p.jsxs(p.Fragment,{children:[p.jsx(H,{className:"me-1",children:"Press"}),p.jsx(H,{className:rt("me-1",r),children:t}),p.jsx(H,{children:"to continue"}),p.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[p.jsx(H,{children:"("}),p.jsx(bf,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),p.jsx(H,{children:")"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx(H,{className:rt("me-1",r),children:"Tap"}),p.jsx(H,{children:"to continue"})]})}),xN=()=>p.jsx(Ne,{children:p.jsxs(Se,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:$(Be),children:[p.jsx(H,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),p.jsx("span",{className:"zx",children:p.jsx(yN,{className:`${qe} px-1`,action:"hold"})})]})}),bN=({presetName:t})=>p.jsx(K,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:xs[t].description,onSelect:$(gP,t)},t),wN=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Be)}),p.jsx(Se,{className:"bg-white pl-1",children:p.jsxs(Nn.Provider,{children:[p.jsx(H,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),p.jsxs(Pe,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[Yx(xs).map(t=>p.jsx(bN,{presetName:t},t)),p.jsx(Ds,{}),p.jsx(Mt,{})]}),p.jsx(Fs,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),qN="https://github.com/jimhigson/head-over-heels-online/",vN=()=>{const[t,e]=C.useReducer(r=>!r,!1);return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"flex absolute top-oneScaledPix right-1 z-dialog",children:p.jsxs("a",{href:qN,className:"bitmap-text-link bg-transparent zx:bg-zxBlack",children:[p.jsx(H,{className:"text-highlightBeige zx:text-zxYellow",children:"★"}),p.jsxs("span",{className:"text-lightGrey zx:text-whiteHalfbrite",children:[p.jsx(H,{className:"resHandheld:hidden",children:" on"}),p.jsx(H,{children:Fb}),p.jsx(H,{className:"resHandheld:hidden",children:"github"})]})]})}),p.jsx("div",{className:"flex absolute bottom-oneScaledPix right-oneScaledPix z-dialog",children:p.jsxs("div",{onClick:e,className:"text-metallicBlue zx:text-zxMagenta",children:[!t&&p.jsx(H,{children:"v"}),t&&p.jsxs(H,{className:"bg-metallicBlueHalfbrite block",children:["b75b0a0","2025-08-27"]})]})})]})},Cr=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],VN=({className:t})=>p.jsxs("div",{className:`flex justify-center gap-2 resHandheld:gap-1 leading-none ${t??""}`,children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Cr,children:"Jon"}),p.jsx(H,{classnameCycle:Cr,children:"Ritman"})]}),p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Cr,children:"Bernie"}),p.jsx(H,{classnameCycle:Cr,children:"Drummand"})]})]})]}),p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),p.jsx("address",{className:"flex",children:p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(H,{classnameCycle:Cr,children:"Jim"}),p.jsx(H,{classnameCycle:Cr,children:"Higson"})]})})]})]}),Ss=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return de("texture-animated-head_walking_away");case"towards":return de("texture-animated-head_walking_towards");case"left":return de("texture-animated-head_walking_left");case"right":return de("texture-animated-head_walking_right");case"awayRight":return de("texture-animated-head_walking_awayRight");case"towardsRight":return de("texture-animated-head_walking_towardsRight");case"towardsLeft":return de("texture-animated-head_walking_towardsLeft");case"awayLeft":return de("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return de("texture-animated-head_idle_towards");case"right":return de("texture-animated-head_idle_right");case"awayRight":return de("texture-animated-head_idle_awayRight");case"towardsRight":return de("texture-animated-head_idle_towardsRight");case"towardsLeft":return de("texture-animated-head_idle_towardsLeft");case"away":return de("texture-head_walking_away_2");case"left":return de("texture-head_walking_left_2");case"awayLeft":return de("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return de("texture-animated-heels_walking_away");case"towards":return de("texture-animated-heels_walking_towards");case"left":return de("texture-animated-heels_walking_left");case"right":return de("texture-animated-heels_walking_right");case"awayRight":return de("texture-animated-heels_walking_awayRight");case"towardsRight":return de("texture-animated-heels_walking_towardsRight");case"towardsLeft":return de("texture-animated-heels_walking_towardsLeft");case"awayLeft":return de("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return de("texture-heels_walking_towards_2");case"right":return de("texture-heels_walking_right_2");case"awayRight":return de("texture-heels_walking_awayRight_2");case"towardsRight":return de("texture-heels_walking_towardsRight_2");case"towardsLeft":return de("texture-heels_walking_towardsLeft_2");case"away":return de("texture-heels_walking_away_2");case"left":return de("texture-heels_walking_left_2");case"awayLeft":return de("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},_N=(t,e,r)=>{const n=t.getBoundingClientRect(),s=n.left+n.width/2,i=n.top+n.height/2,o=s-e,a=i-r,c=cq({x:o,y:a});return md(c)},ey=({character:t,defaultFacing:e,className:r=""})=>{const[n,s]=C.useState(e),[i,o]=C.useState(!1),a=C.useRef(null);C.useEffect(()=>{const d=m=>{a.current&&s(_N(a.current,m.clientX,m.clientY)||"right")},f=()=>{s(e),o(!1)};return window.addEventListener("mousemove",d),document.addEventListener("mouseleave",f),()=>{window.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",f)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=Ss({character:t,facingXy8:n,action:i?"walking":"idle"});return p.jsxs("div",{ref:a,className:`relative ${r}`,onMouseEnter:l,onMouseLeave:c,children:[p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),p.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})},tv=({noSubtitle:t,className:e})=>p.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[p.jsxs("h1",{className:"flex",children:[p.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[p.jsx(H,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),p.jsx(ey,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),p.jsx(H,{classnameCycle:Cr,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),p.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[p.jsx(H,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),p.jsx(ey,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||p.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[p.jsx(H,{className:"text-midRed zx:text-zxCyan",children:"block"}),p.jsx(H,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),p.jsx(H,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),p.jsx(H,{className:"text-moss zx:text-zxWhite",children:"ing"}),p.jsx(H,{classnameCycle:Cr,children:" remake"})]})]}),SN=()=>{const t=ws(),e=$(hP),r=$(wt,"whichGame");return t?p.jsx(K,{id:"playGame",label:p.jsx(H,{children:"Resume the game"}),doubleHeightWhenFocussed:!0,onSelect:e}):p.jsx(K,{id:"playGame",label:p.jsx(H,{children:"Play the game"}),doubleHeightWhenFocussed:!0,onSelect:r})},kN=()=>p.jsx(K,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:$(wt,"installGuide")}),CN=()=>p.jsx(K,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:$(wt,"sureWantEditor")}),PN=()=>{const t=ws(),e=ue(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0);return p.jsx(K,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:$(wt,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},ty="https://discord.gg/Se5Jznc2jm",EN=t=>{const e=ws(),r=$(wt,"crowns"),n=$(wt,"score"),s=C.useCallback(()=>{r(),n()},[r,n]),i=MS();return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),p.jsxs(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[p.jsx(tv,{noSubtitle:e,className:e?"resHandheld:hidden":""}),p.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[p.jsxs(Pe,{className:"w-24 mx-auto",children:[p.jsx(SN,{}),!e&&Pt()==="desktop"&&p.jsx(CN,{}),p.jsx(K,{id:"map",label:"use the Map",onSelect:$(wt,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),p.jsx(K,{id:"viewCrowns",label:"Progress so far",onSelect:s,doubleHeightWhenFocussed:!0,hidden:!e})]}),p.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[p.jsxs(Pe,{children:[p.jsx(K,{id:"options",label:"Options",doubleHeightWhenFocussed:!0,onSelect:$(wt,"modernisationOptions")}),p.jsx(K,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:$(wt,"readTheManual")})]}),p.jsxs(Pe,{children:[i?null:p.jsx(kN,{}),p.jsx(K,{id:"discord",leader:p.jsx(H,{children:Db}),label:p.jsx("a",{href:ty,target:"_blank",children:p.jsx(H,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:C.useCallback(()=>{window.open(ty,"_blank")},[])}),i?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"})]}):null]})]}),e&&p.jsx(Pe,{className:"w-24 mx-auto",children:p.jsx(PN,{})})]}),!e&&p.jsx(VN,{className:"resHandheld:mt-1"})]}),p.jsx(vN,{})]})};var uu,ry;function wf(){if(ry)return uu;ry=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return uu=t,uu}var hu,ny;function TN(){if(ny)return hu;ny=1;var t=typeof fo=="object"&&fo&&fo.Object===Object&&fo;return hu=t,hu}var du,sy;function rv(){if(sy)return du;sy=1;var t=TN(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return du=r,du}var fu,iy;function RN(){if(iy)return fu;iy=1;var t=rv(),e=function(){return t.Date.now()};return fu=e,fu}var pu,oy;function MN(){if(oy)return pu;oy=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return pu=e,pu}var mu,ay;function IN(){if(ay)return mu;ay=1;var t=MN(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return mu=r,mu}var gu,ly;function nv(){if(ly)return gu;ly=1;var t=rv(),e=t.Symbol;return gu=e,gu}var Au,cy;function jN(){if(cy)return Au;cy=1;var t=nv(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,s=t?t.toStringTag:void 0;function i(o){var a=r.call(o,s),l=o[s];try{o[s]=void 0;var c=!0}catch{}var u=n.call(o);return c&&(a?o[s]=l:delete o[s]),u}return Au=i,Au}var yu,uy;function ON(){if(uy)return yu;uy=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return yu=r,yu}var xu,hy;function BN(){if(hy)return xu;hy=1;var t=nv(),e=jN(),r=ON(),n="[object Null]",s="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?s:n:i&&i in Object(a)?e(a):r(a)}return xu=o,xu}var bu,dy;function NN(){if(dy)return bu;dy=1;function t(e){return e!=null&&typeof e=="object"}return bu=t,bu}var wu,fy;function zN(){if(fy)return wu;fy=1;var t=BN(),e=NN(),r="[object Symbol]";function n(s){return typeof s=="symbol"||e(s)&&t(s)==r}return wu=n,wu}var qu,py;function LN(){if(py)return qu;py=1;var t=IN(),e=wf(),r=zN(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return n;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):s.test(c)?n:+c}return qu=l,qu}var vu,my;function sv(){if(my)return vu;my=1;var t=wf(),e=RN(),r=LN(),n="Expected a function",s=Math.max,i=Math.min;function o(a,l,c){var u,h,d,f,m,A,g=0,y=!1,b=!1,x=!0;if(typeof a!="function")throw new TypeError(n);l=r(l)||0,t(c)&&(y=!!c.leading,b="maxWait"in c,d=b?s(r(c.maxWait)||0,l):d,x="trailing"in c?!!c.trailing:x);function w(z){var L=u,U=h;return u=h=void 0,g=z,f=a.apply(U,L),f}function V(z){return g=z,m=setTimeout(S,l),y?w(z):f}function _(z){var L=z-A,U=z-g,q=l-L;return b?i(q,d-U):q}function v(z){var L=z-A,U=z-g;return A===void 0||L>=l||L<0||b&&U>=d}function S(){var z=e();if(v(z))return E(z);m=setTimeout(S,_(z))}function E(z){return m=void 0,x&&u?w(z):(u=h=void 0,f)}function R(){m!==void 0&&clearTimeout(m),g=0,u=A=h=m=void 0}function I(){return m===void 0?f:E(e())}function B(){var z=e(),L=v(z);if(u=arguments,h=this,A=z,L){if(m===void 0)return V(A);if(b)return clearTimeout(m),m=setTimeout(S,l),w(A)}return m===void 0&&(m=setTimeout(S,l)),f}return B.cancel=R,B.flush=I,B}return vu=o,vu}var DN=sv();const FN=st(DN);var Vu,gy;function UN(){if(gy)return Vu;gy=1;var t=sv(),e=wf(),r="Expected a function";function n(s,i,o){var a=!0,l=!0;if(typeof s!="function")throw new TypeError(r);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(s,i,{leading:a,maxWait:i,trailing:l})}return Vu=n,Vu}var HN=UN();const $N=st(HN),GN=(t,e,r,n)=>{switch(e){case"debounce":return FN(t,r,n);case"throttle":return $N(t,r,n);default:return t}},WN=t=>{const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...r)=>{var n;return(n=e.current)===null||n===void 0?void 0:n.call(e,...r)},[])},YN=t=>{const[e,r]=C.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:C.useMemo(()=>new Proxy(s=>{s!==e&&r(s)},{get(s,i){return i==="current"?e:s[i]},set(s,i,o){return i==="current"?r(o):s[i]=o,!0}}),[e]),refElement:e,setRefElement:r}},QN=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function KN({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:n,handleWidth:s=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=C.useRef(t),u=WN(l),[h,d]=C.useState({width:void 0,height:void 0}),{refProxy:f,refElement:m}=YN(o),{box:A}=a||{},g=C.useCallback(b=>{if(!s&&!i)return;if(c.current){c.current=!1;return}const x=(w,V)=>s&&w.width!==V.width||i&&w.height!==V.height;b.forEach(w=>{const V=QN(w,A);d(_=>x(_,V)?(u?.({width:V.width,height:V.height,entry:w}),V):_)})},[s,i,c,A]),y=C.useCallback(GN(g,e,r,n),[g,e,r,n]);return C.useEffect(()=>{let b;return m?(b=new window.ResizeObserver(y),b.observe(m,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),d({width:void 0,height:void 0})),()=>{var x,w,V;(x=b?.disconnect)===null||x===void 0||x.call(b),(V=(w=y).cancel)===null||V===void 0||V.call(w)}},[y,m]),Object.assign({ref:f},h)}const ce={w:16,d:16,h:12},Ay={x:16,y:16,z:12},XN=["head","heels"],JN=[...XN,"headOverHeels"],ms=t=>t==="head"?"heels":"head",iv="@@original",ZN="original",ez={userId:iv,campaignName:ZN,version:-1},Ee=(...t)=>{if(t.length===1){const[e]=t;return r=>r.type===e}return e=>t.includes(e.type)},tz=Ee("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),rz=(t,e)=>tz(t)||is(t)&&(e!==void 0&&lv(e)||t.config.direction.z!==0)||uv(t)&&t.config.floorType==="none",$i=(t,e)=>!rz(t,e),nz=t=>t.type==="movingPlatform"||t.type==="pushableBlock",ov=(t,e,r=!1)=>ks(e)&&!(!r&&lv(e)&&e.state.autoWalk)&&!(uz(t)&&nz(e))&&!(qf(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),av=["ball","slidingBlock","slidingDeadly"],sz=Ee(...av),iz=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],oz=["dalek","turtle","elephantHead","homingBot","helicopterBug"],ZF=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?oz.includes(t.config.which):iz.includes(t.type),lv=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function ks(t){return cv.includes(t.type)}const cv=[...JN,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],az=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],lz=Ee(...az),eU=t=>qf(t)&&!t.state.activated?!1:lz(t)||t.type==="floor"&&t.config.floorType==="deadly",cz=t=>t.config.times!==void 0,is=Ee("portal"),tU=Ee("teleporter");Ee("heels");Ee("head");const rU=Ee("heels","headOverHeels"),nU=Ee("head","headOverHeels"),uz=Ee("lift"),sU=Ee("button"),iU=Ee("emitter"),qf=Ee("monster"),uv=Ee("floor"),hz=Ee("pickup"),oU=t=>hz(t)&&t.config.gives==="crown",aU=Ee("spring"),lU=Ee("joystick"),cU=Ee("monster","movingPlatform"),uU=t=>qf(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,hv=Ee("head"),dv=Ee("heels"),Fa=Ee("headOverHeels"),jr=(t,e)=>t.characterRooms[e]?.items[e],hU=t=>jr(t,t.currentCharacterName),dU=t=>{if(hv(t))return t.state;if(Fa(t))return t.state.head},dz=t=>{if(dv(t))return t.state;if(Fa(t))return t.state.heels},fz=(t,e)=>{const r=jr(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&hv(r)||e==="heels"&&dv(r))return r.state;if(e==="head"&&Fa(r))return r.state.head;if(e==="heels"&&Fa(r))return r.state.heels}},fU=fz,pz=t=>{const e=jr(t,"head"),r=jr(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},yt={x:12,y:12,z:ce.h},mz={x:14,y:14,z:ce.h},xn={x:16,y:16,z:ce.h},ma={...yt,z:ce.h*2},fv=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:yt};case"slidingBlock":return t.config.style==="book"?{aabb:xn}:{aabb:yt};case"lift":return{aabb:{...yt,z:yt.z}};case"switch":return{aabb:{...yt,z:yt.z}};case"button":return{aabb:{x:15,y:15,z:2}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:yt};case"charles":return{aabb:ma};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:xn};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:xn};case"tower":return{aabb:{x:11,y:11,z:ce.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...yt,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:ma};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:yt};case"turtle":return{aabb:yt};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:xn};case"bubbles":return{aabb:yt};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:xn};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:ce.h}:{x:15,y:3,z:ce.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:ma}:{aabb:yt};case"emitter":return{aabb:ae};default:return{aabb:mz}}},pt={aabb:yt,castsShadowWhileStoodOn:!1},vf=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),pU=t=>t.type==="wall"?vf(t.config):cz(t)?t.config.times:void 0,Rh=(t=Za)=>({x:t.x??1,y:t.y??1,z:t.z??1}),mU=t=>({x:t.x??1,y:t.y??1}),yy=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?Rh(vf(t.config)):e(t)?Rh(t.config.times):Za},gU=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},Gi=(t,e={})=>{const r=Rh(e),n=Rr(Ay,t);return Rr(h_(r,Ay),n)},AU=1e3,Sn=-2,Ge=Number.MIN_SAFE_INTEGER,He=io/1e3,yU={head:15e-5,heels:15e-5},xU=1e3/110,bU=240,gz=2e-4,Az={head:ce.h*2/1e3,others:ce.h*6/1e3},wU=gz*.35,qU=Az.others*.5,vU=.8,VU=.001,yz={head:He,heels:2*He,charles:He,dalek:Math.SQRT2*He,bubbleRobot:(Math.SQRT2+1)/2*He,cyberman:1*He,skiHead:He,helicopterBug:He,homingBot:2*He,monkey:He,elephant:He,elephantHead:0,emperor:He,emperorsGuardian:Math.SQRT2*He,computerBot:He,turtle:He,ball:2*He,firedDoughnut:2*He,movingPlatform:He,floatingText:He},xz=(t=1)=>t*io/1e3,_U=xz(),SU=2,xy=1.1,kU={head:ce.h*2.6+xy,heels:ce.h+xy},bz=10,CU=6e4,wz=8,PU=750,EU=1500,TU=200,RU=.15,MU=150,qz=8,vz=Nt.h-Nt.w/2,pv=vz+2,Vf=9999,IU=({x:t=0,y:e=0})=>e-t,We=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),ze=({x:t=0,y:e=0,z:r=0})=>({x:t*ce.w,y:e*ce.d,z:r*ce.h}),jU=t=>We(ze(t)),Mh=t=>{const e=ze(t.position),{aabb:r}=fv(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:ee(e,{x:ce.w-r.x>>1,y:ce.d-r.y>>1})},lt=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Ge,stoodOnUntilRoomTime:Ge,actedOnAt:{roomTime:Ge,by:ye}}),Wi=()=>({standingOnItemId:null,vels:{gravity:ae,movingFloor:ae},latentMovement:[],collidedWith:{roomTime:Ge,by:ye},controlledWithJoystickAtRoomTime:Ge}),Vz=t=>{const e=cv.includes(t.type);return{...lt(),position:Mh(t),...e?{standingOnItemId:null,vels:{gravity:ae,movingFloor:ae,...av.includes(t.type)?{sliding:ae}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:ae}:{}},latentMovement:[],collidedWith:{roomTime:Ge,by:ye}}:{},...t.type==="joystick"||t.type==="emitter"||t.type==="lift"||t.type==="conveyor"||t.type==="teleporter"?{...structuredClone(t.config)}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:be[t.config.startDirection]}:{facing:be.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:be[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="button"?{pressed:!1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:ae}}:{},...t.type==="charles"?{facing:be.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Ge,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?Rt(be[t.config.direction],yz.firedDoughnut):ae}}:{}}},_z=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,_u=ce.h*2,Sz=4,ea=ce.h*Sz,kz=2,Cz=.5,by=2;function*Pz(t,e){const{config:{direction:r},position:n}=t,s=Tx(r),i=fd(s),o=_z(t),a={...ae,[i]:o?-.5:0},l=1,c={[i]:o?-1:0},u=l*ce.w,h={...ae,[i]:u},d=9,f=8,m=8;{const A={[s]:f,[i]:m,z:ea};yield{...t,...pt,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...lt(),position:ze(ee(n,{[s]:1.5},a,c)),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[s]:d,[i]:m,z:ea};yield{...t,...pt,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...lt(),position:ze(ee(n,a,c)),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[s]:2*ce.w-d-f,[i]:m,z:ea-_u};yield{...t,...pt,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...lt(),position:ee(ze(ee(n,a,c)),{[s]:d,z:_u}),stoodOnBy:ye},aabb:ee(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}yield{...t,...pt,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...lt(),position:ee(ze(ee(n,a,c)),{z:ea}),stoodOnBy:ye},aabb:ee(ze({[s]:2,[i]:l,z:Vf}),{[i]:m}),renderAabb:ae,fixedZIndex:Sn},yield{...t,...pt,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Ri(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:ze({...ae,[i]:o?l+.25:-.25}),direction:be[r]},fixedZIndex:Sn,state:{...lt(),position:ee(ze(ee(n,{[i]:o?-.5-l:.5})),{[s]:d}),stoodOnBy:ye},aabb:{[s]:kz*ce.w-d-f,[i]:u,z:_u}},n.z!==0&&(yield{...t,...pt,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:n.z},renders:!0,shadowCastTexture:o?{textureId:"shadow.door.floatingThreshold.double.y",flipX:s==="x"}:void 0,castsShadowWhileStoodOn:o,state:{...lt(),position:{...ze(ee(n,a,c)),z:0}},aabb:ee(ze({[s]:2,[i]:.5,z:n.z}),h),renderAabb:o?ee(ze({[s]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?ee({[s]:0,[i]:0,z:(n.z-.5)*ce.h},{[i]:h[i]}):void 0,shadowOffset:{z:n.z*ce.h,[i]:o?h[i]:void 0}}),yield{...pt,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:ze({[s]:2,[i]:by,z:2}),config:{},fixedZIndex:Sn,state:{...lt(),position:ze(Rr(n,Rt(be[r],Cz),o?ae:{[i]:by})),stoodOnBy:ye}}}const Ez=3,wy=10,qy=.52,vy=.5,Tz=(t,e,r)=>{const{config:{times:n},position:s}=e,i=ee(s,{z:-3}),o={...n,z:Ez};let a=i,l=o;const c=Oe(In(r.items)).filter(d=>d.type==="door");if(s.z===0){const d={};for(const f of c){const{position:m,config:{direction:A}}=f;switch(A){case"towards":!d.towards&&m.y===i.y&&m.x>=i.x&&m.x<=i.x+n.x-2&&(l=ee(l,{y:vy}),a=ee(a,{y:-.5}),d.towards=!0);break;case"away":!d.away&&m.y===i.y+n.y&&m.x>=i.x&&m.x<=i.x+n.x-2&&(l=ee(l,{y:qy}),d.away=!0);break;case"right":!d.right&&m.x===i.x&&m.y>=i.y&&m.y<=i.y+n.y-2&&(l=ee(l,{x:vy}),a=ee(a,{x:-.5}),d.right=!0);break;case"left":!d.left&&m.x===i.x+n.x&&m.y>=i.y&&m.y<=i.y+n.y-2&&(l=ee(l,{x:qy}),d.left=!0);break}}}const u=ze(a),h=Gi(xn,l);return{...pt,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Gi(xn,o),position:ze(i)}},aabb:h,renderAabb:{...h,z:wy},renderAabbOffset:{...ae,z:h.z-wy},shadowCastTexture:"shadow.fullBlock",state:{...lt(),position:u}}},Ua={config:ye,shadowCastTexture:"shadow.smallRound",castsShadowWhileStoodOn:!0,aabb:yt},Yi=()=>{const t=Ib(we.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:be.towards,walkStartFacing:be.towards,walkDistance:0,vels:{walking:ae,gravity:ae,movingFloor:ae},switchedToAt:Ge,lastDiedAt:Ge,gameTime:0,jumpStartTime:Ge,lives:t?"infinite":wz,jumpStartZ:0}},Rz=(t,e)=>{const r=jb(we.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...pt,...Ua,state:{...lt(),...Wi(),...Yi(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Ge,shieldCollectedAt:Ge,doughnuts:r?"infinite":0,position:Mh(t),stoodOnUntilRoomTime:Ge}}:{id:e,jsonItemId:e,type:"heels",...pt,...Ua,state:{...lt(),...Wi(),...Yi(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Ge,position:Mh(t),stoodOnUntilRoomTime:Ge}}},Mz=t=>t==="towards"||t==="right",mv=1,Iz={x:ce.w,y:ce.d*mv,z:Vf},jz={x:ce.w,y:0,z:pv},Oz={x:ce.w*mv,y:ce.d,z:Vf},Bz={x:0,y:ce.d,z:pv},Nz=(t,e)=>{const{config:{direction:r},position:n}=e,s=vf(e.config),i=Tx(r),o=fd(i),a=Mz(r),l={...ae,[o]:a?-1:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Gi(i==="y"?Oz:Iz,s),renderAabb:a?ae:Gi(i==="y"?Bz:jz,s),fixedZIndex:a?Sn:void 0,state:{...lt(),position:ze(ee(n,l)),stoodOnBy:ye},shadowCastTexture:i==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0},castsShadowWhileStoodOn:a}};function*_f(t,e,r,n=ye,s={},i=""){if(!n[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&s[e.config.page]))switch(!0){case e.type==="door":return yield*Pz(e,t);case e.type==="player":{yield Rz(e,t);return}case e.type==="wall":{yield Nz(t,e);return}case e.type==="floor":{yield Tz(t,e,r);return}case(e.type==="block"&&e.config.disappearing!==void 0&&no(yy(e))>=2):{const o=yy(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=Es(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=Za});yield*_f(t,u,r,n,s,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!we.getState().gameMenus.gameInPlay.planetsLiberated[e.config.planet]):return;default:{const o=fv(e),a=e.config.times!==void 0?{aabb:Gi(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=Vz(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...pt,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Sn:void 0,shadowCastTexture:zz(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const zz=t=>{switch(t.type){case"lift":case"switch":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Ex(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};let Lz=0;const Dz=({gameState:t,room:e,itemType:r,config:n,position:s})=>{const i={type:r,config:n,position:ae},o=`${r}/${Lz++}`,a=iS(_f(o,i,e.roomJson,t.pickupsCollected[e.id]??ye));if(a===void 0)throw console.error("failed to generate any items for json",o,i),new Error("failed to generate any items");return a.state.position=s,Ha({room:e,item:a}),a},Ha=({room:t,item:e})=>(t.items[e.id]=e,e),Fz=(t,e)=>Oe(bd(t)).map(r=>{const n=e.items[r];if(n===void 0)throw new Error(`item in stoodOnBy "${r}" is not in the room`);return n});function gv(t,e){return t===null?null:e.items[t]}const Ih=(t,e)=>{if(t.state.standingOnItemId!==null){const r=gv(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime}},Mn=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;ks(r)&&Ih(r,t);for(const n of Fz(r.state.stoodOnBy,t))Ih(n,t);typeof e=="string"?delete t.items[e]:delete t.items[r.id]},Sf=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0},Uz=t=>{const e={id:"head",type:"head",...pt,...Ua,state:{...lt(),...Wi(),...Yi(),...t.state.head,facing:t.state.facing,position:ee(t.state.position,{z:ce.h}),switchedToAt:Ge,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...pt,...Ua,state:{...lt(),...Wi(),...Yi(),...t.state.heels,facing:t.state.facing,position:ee(t.state.position),switchedToAt:Ge,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},Hz=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...pt,shadowCastTexture:e.shadowCastTexture,config:ye,aabb:ma,state:{...lt(),...Wi(),...Yi(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...Ri(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ge},heels:{...Ri(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ge}}}),$z=t=>{const e=t.characterRooms.head,r=jr(t,"head"),n=jr(t,"heels"),s=Hz({head:r,heels:n});Mn({room:e,item:"head"}),Mn({room:e,item:"heels"}),Ha({room:e,item:s}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},Gz=(t,e)=>{const r=t.characterRooms.headOverHeels,n=jr(t,"headOverHeels"),s=e??ms(t.previousPlayable),{head:i,heels:o}=Uz(n);Mn({room:r,item:"headOverHeels"}),Ha({room:r,item:i}),Ha({room:r,item:o}),Sf({above:i,below:o}),t.currentCharacterName=s,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},Wz=t=>{const e=jr(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},ga=(t,e)=>{pz(t)&&(!e||e===t.currentCharacterName)?$z(t):t.currentCharacterName==="headOverHeels"?Gz(t,e):(!e||e!==t.currentCharacterName)&&jr(t,ms(t.currentCharacterName))!==void 0&&(t.currentCharacterName=ms(t.currentCharacterName)),Wz(t)},Vy=4,_y=ca.h,Av=()=>{const t=ao(),e=C.useRef(null),r=C.useCallback(n=>{if(e.current===null)return;const{scrollTop:s,scrollLeft:i}=e.current,o=be[n],a=s+t*Vy*-o.y*_y,l=i+t*Vy*o.x*_y;e.current.scrollTo({left:l,top:a,behavior:"instant"})},[t]);return bt({handler:C.useCallback(()=>{r("towards")},[r]),action:"towards"}),bt({handler:C.useCallback(()=>{r("away")},[r]),action:"away"}),bt({handler:C.useCallback(()=>{r("left")},[r]),action:"left"}),bt({handler:C.useCallback(()=>{r("right")},[r]),action:"right"}),e},jh=(t,e)=>e?.[t],gl=t=>In(t),rr=t=>Oe(gl(t)),OU=t=>Oe(xd(t)),BU=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),Yz=(t,e,r)=>{if(e==="*")return!0;const n=r.meta.subRooms[e];return t.x>=n.physicalPosition.from.x&&t.y>=n.physicalPosition.from.y&&t.x<=n.physicalPosition.to.x&&t.y<=n.physicalPosition.to.y},yv=({position:t},e,r)=>Yz(t,e,r),Qz=(t,e,r)=>{if(e==="*")return 0;const n=r.meta.subRooms[e],{from:s,to:i}=n.physicalPosition;if(t.x>=s.x&&t.y>=s.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<s.x?o=s.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<s.y?a=s.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},xv=(t,e,r)=>{const n=r.meta?.subRooms;if(n===void 0)return"*";let s,i=1/0;const o=e==="fine"?{x:t.x/ce.w,y:t.y/ce.d}:t;for(const a of bd(n)){const l=Qz(o,a,r);if(l===0)return a;l<i&&(i=l,s=a)}if(s===void 0)throw new Error(`item not found in any subroom of ${r.id}
      item at 📍 ${JSON.stringify(o)}
      subrooms ${JSON.stringify(r.meta?.subRooms,null,2)}`);return s},Z=48,Pr=36,Qi=.55,St=Z*((1-Qi)/2),_t=Z-St,Ki=8,as=128,bn=({mapTitle:t,y:e=0,className:r,textOnly:n=!1})=>{const s=ao();return p.jsxs("g",{className:r,children:[n||p.jsx("rect",{y:e,width:1e4,height:1e4}),p.jsx("foreignObject",{width:s*(t.length+3)*8,height:s*16*3,x:Ki,y:e+16,children:p.jsx(H,{className:`left-2 relative sprites-double-height ${qe}`,children:t})})]})},Dr={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},Kz=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.lightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},bv=t=>(t&&Dr[t])??{bgClassName:"fill-shadow",containerClassName:""},Xt=t=>({x:(t.x??0)*Z,y:(t.y??0)*Z,z:(t.z??0)*Pr}),Cs=t=>Math.round(t*10)/10,kf=t=>{const e=We(t);return`translate(${Cs(e.x)},${Cs(e.y)})`},J=t=>{const e=We(t);return Bt(e)},Bt=t=>`${Cs(t.x)},${Cs(t.y)}`,Xz=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const n=ao(),s=e.r-e.l+2*Ki,i={x:-e.l+Ki+(r-s)/2,y:-e.t+as},o=(x,w=ae)=>$r(i,We(Xt(ee(t[x].gridPosition,w)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),d=o("blacktooth53market/*",{x:0,y:1,z:0}),f=o("blacktooth53market/*",{x:1,y:1,z:0}),m=o("blacktooth52market/*",{x:1,y:.5,z:0}),A=n*8*2,g="Market",y=(g.length+3)*n*8,b=n*8*2+32;return p.jsxs(p.Fragment,{children:[p.jsx("path",{className:`${Dr.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Bt({x:A,y:m.y+b})}
L ${Bt({x:y,y:m.y+b})}
L ${Bt({x:y,y:a.y})}
L ${Bt(a)}
L ${Bt(l)}
L ${Bt(c)}
L ${Bt(u)}
L ${Bt(h)}
L ${Bt(d)}
L ${Bt(f)}
L ${Bt(m)}
L ${Bt({...m,x:A})}
z`}),p.jsx(bn,{y:m.y,mapTitle:g,className:Dr.market.bgClassName,textOnly:!0})]})},Jz=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const n=t,s=We(Xt({x:1,y:1,z:0})).y,i=(o,a)=>{if(n[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(n[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=We(Xt(n[o].gridPosition)).y,c=We(Xt(n[a].gridPosition)).y+s;return(l+c)/2};return p.jsxs(p.Fragment,{children:[p.jsx(bn,{y:0,mapTitle:"Freedom",className:Dr.freedom.bgClassName}),p.jsx(bn,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+as,mapTitle:"Castle Blacktooth",className:Dr.blacktooth.bgClassName}),p.jsx(bn,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+as,mapTitle:"moonbase",className:Dr.moonbase.bgClassName}),p.jsx(bn,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+as,mapTitle:"Blacktooth escape",className:Dr.blacktooth.bgClassName}),p.jsx(Xz,{mapBounds:e,originalCampaignPositions:n,containerWidth:r}),p.jsx(bn,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+as,mapTitle:"Jail",className:Dr.jail.bgClassName})]})},Zz={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},e2=t=>{const{campaign:e,curRoomId:r}=t,n=e.locator.userId===iv&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),s=bv(t.curRoomScenery);return n?p.jsx(Jz,{...t}):p.jsx(bn,{mapTitle:Zz[e.rooms[r].planet],className:s.bgClassName})},Oh=t=>ee(t.state.position,Rt(t.aabb,.5)),t2={x:1,y:1,z:1},Sy=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),NU=t=>t,r2=t=>In(t.items),n2=t=>xd(t),s2=t=>Oe(r2(t)),zU=(t,...e)=>{const r=Oe(n2(t));return e.length===0?r:r.filter(([,n])=>e.includes(n.type))},i2={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},LU=t=>rr(t.items).reduce((e,r)=>{if(r.type==="floor"){const{config:{naturalFootprint:n},state:{position:s},renderAabb:i,renderAabbOffset:o,aabb:a}=r,l=We(ee(n.position,{x:n.aabb.x,z:n.aabb.z})).x,c=We(ee(n.position,{y:n.aabb.y,z:n.aabb.z})).x,u=We(ee(n.position,n.aabb)).y,h=We(ee(s,o??ae,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const n=We(ee(r.state.position,r.renderAabb??r.aabb??ae,r.renderAabbOffset??ae)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,n)},floors:e.floors}}},i2),o2={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},wv=t=>{const e=s2(t).filter(r=>r.type==="floor").reduce((r,n)=>{const{position:s,config:{times:i}}=n;return{from:{x:Math.min(r.from.x,s.x),y:Math.min(r.from.y,s.y),z:Math.min(r.from.z,s.z)},to:{x:Math.max(r.to.x,s.x+i.x),y:Math.max(r.to.y,s.y+i.y),z:Math.max(r.to.z,s.z)}}},o2);if(isFinite(e.from.x))return e},qv=({svg:t=!1,smooth:e=!1})=>{const r=C.useRef(null);return C.useLayoutEffect(()=>{r.current?.scrollIntoView({behavior:e?"smooth":"instant",block:"center"})}),t?p.jsx("g",{ref:r}):p.jsx("div",{ref:r})},Aa=({className:t,scrollTo:e=!1,onClick:r,yAdjust:n=0})=>p.jsxs("foreignObject",{x:-50,y:-100+n,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[p.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r,style:r?{pointerEvents:"all"}:{}}),e&&p.jsx(qv,{})]}),mi=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:n=!1,yAdjust:s=0,onClick:i})=>p.jsx(Aa,{className:`${n?"[--scale:2.5]":"[--scale:1.5]"}
                ${Ss({character:t,action:r?"walking":"idle",facingXy8:md(e)??"towards"})}`,scrollTo:r,yAdjust:s,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),a2=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return p.jsxs(p.Fragment,{children:[p.jsx(Aa,{className:`${r} texture-lift_static`}),p.jsx(Aa,{className:`${r} texture-lift_2`})]});const n=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return p.jsx(Aa,{className:`${r} ${n}`})},l2=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],c2=({x:t,y:e},{x:r,y:n})=>(t-r)**2+(e-n)**2,u2=(t,e)=>{const r=t%3,n=Math.floor(t/3),s=e%3,i=Math.floor(e/3);return Math.abs(r-s)<=1&&Math.abs(n-i)<=1&&t!==e},ky=t=>t.some((e,r)=>t.slice(r+1).some(n=>u2(e,n))),Si=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...n]=t;return[...Si(n,e),...Si(n,e-1).map(s=>[r,...s])]},vv=t=>t.length<=1?[t]:t.flatMap((e,r)=>vv([...t.slice(0,r),...t.slice(r+1)]).map(n=>[e,...n])),Cy={1:Si([...Array(9).keys()],1),2:Si([...Array(9).keys()],2).filter(t=>!ky(t)),3:Si([...Array(9).keys()],3).filter(t=>!ky(t))},Bh=3,Vv=({items:t,itemNormalisedPosition:e})=>{const r=so(t),n=r.length;if(n===0)return ye;if(n>Bh)throw new Error(`roomItemPositions supports up to ${Bh} items, but got ${n}: ${Object.keys(t).join(", ")}`);const s=r.map(([a,l])=>({id:a,pos:e(l)}));let i=ye,o=1/0;if(Cy[n]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${n}`);for(const a of Cy[n]){const l=a.map(c=>l2[c]);for(const c of vv(l)){const u={};let h=0;for(let d=0;d<n;d++){const{id:f,pos:m}=s[d],A=c[d];u[f]=A,h+=c2(m,A)}h<o&&(o=h,i=u)}}return i},_v=({items:t,positions:e,ItemComponent:r})=>p.jsx("g",{"data-class":"items",children:so(e).sort(([n,s],[i,o])=>o.y-s.y+(o.x-s.x)).map(([n,s])=>p.jsx("g",{"data-position":JSON.stringify(s),transform:`${kf(Rx(s,Z*.5))} translate(0,-3)`,children:p.jsx(r,{item:t[n]})},n))}),h2=(t,e)=>{if(t==="*"){const r=wv(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},d2=({items:t,roomJson:e,subRoomId:r})=>{const n=C.useMemo(()=>Vv({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??ye,...t2},a=$r(i.position,Rt(o,.5)),l=h2(r,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return p.jsx(_v,{ItemComponent:a2,items:t,positions:n})},f2=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:n,onClick:s})=>{const i=C.useMemo(()=>({item:{type:l,state:{facing:c}}})=>p.jsx(mi,{characterName:l,facing:c,isCurrent:n===l,onlyPlayableInRoom:!1,onClick:s}),[n,s]),o=C.useMemo(()=>({head:t,heels:e}),[t,e]),a=C.useMemo(()=>Vv({items:o,itemNormalisedPosition:c=>{const u=Oh(c),h=f_(Oh(c),{x:1/ce.w,y:1/ce.d,z:1}),d=wv(r);if(d===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:Sy(h.x,d.from.x,d.to.x),y:Sy(u.y,d.from.y,d.to.y)}}}),[o,r]);return p.jsx(_v,{ItemComponent:i,items:o,positions:a})},p2=(t,e,r)=>yv(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),m2=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const n=Object.groupBy(r,i=>i[1].type),s=wS(e,gS(...In(n)));return Object.fromEntries(s)},g2=(t,e,r)=>C.useMemo(()=>{let n=!1,s=!1;const i=Oe(so(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(n)return!1;n=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(s)return!1;s=!0}return!0}).filter(o=>p2(o[1],r,t));return m2(Rs(i),Bh)},[t,e,r]),Sv=.15,ta=We(Xt({x:.5,y:.5,z:0})),Py=We(Xt({x:Sv,y:0,z:0})),Ey=We(Xt({x:Sv*1.66,y:0,z:0})),A2=({className:t})=>p.jsxs(p.Fragment,{children:[p.jsx("ellipse",{className:"fill-white",cx:ta.x,cy:ta.y,rx:Math.abs(Ey.x),ry:Math.abs(Ey.y)}),p.jsx("ellipse",{className:t,cx:ta.x,cy:ta.y,rx:Math.abs(Py.x),ry:Math.abs(Py.y)})]}),Qt=3,Ty=Mx(We({x:Z,y:0})),ra={wall:void 0,open:"0,999",doorway:`${Cs(Ty*((1-Qi)/2)-Qt/2)}, ${Cs(Ty*Qi+Qt)}, 999`},Su=`
M ${J({})}
L ${J({y:Z})}
L ${J({x:Z,y:Z})}
L ${J({x:Z})}
z`,na=(t,e=Qi)=>{const r=Z*((1-e)/2),n=Z-r,s=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${J({x:r,y:r})}`;return a&&(l+=`L${J({x:0,y:r})} L${J({x:0,y:n})}`),l+=`L${J({x:r,y:n})}`,s&&(l+=`L${J({x:r,y:Z})} L${J({x:n,y:Z})}`),l+=`L${J({x:n,y:n})}`,o&&(l+=`L${J({x:Z,y:n})} L${J({x:Z,y:r})}`),l+=`L${J({x:n,y:r})}`,i&&(l+=`L${J({x:n,y:0})} L${J({x:r,y:0})}`),l+="z",l},ku=4,y2=Oe(Gx(ku)).map(t=>`
M${J({x:Z*((t+.5)/ku),y:0})}
L${J({x:Z*((t+.5)/ku),y:Z})}`).toArray().join(""),Ry=t=>{const e=`
M${J({x:0,y:Z})}
L${J({x:0,y:Z,z:Pr})}
L${J({x:Z,y:Z,z:Pr})}
L${J({x:Z,y:Z})}
z
`;return t?e+`
M${J({x:St,y:Z})}
L${J({x:St,y:Z,z:Pr})}
L${J({x:_t,y:Z,z:Pr})}
L${J({x:_t,y:Z})}
L${J({x:St,y:Z})}`:e},x2=`            
M${J({x:Z,y:Z,z:Pr})}            
L${J({x:Z,y:Z})}            
M${J({x:Z,y:0,z:Pr})}            
L${J({x:Z,y:0})}            
M${J({x:0,y:Z,z:Pr})}            
L${J({x:0,y:Z})}            
`,b2=`            
M${J({x:0,y:0,z:Pr})}            
L0, 0            
`,w2=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:n,roomVisited:s,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:d,color:f,items:m}=n,A=n.meta?.label,g=g2(n,r,e),y=Object.values(m).filter(w=>w.type==="floor"),b=y.every(w=>w.config.floorType==="none"),x=y.some(w=>w.config.floorType==="deadly");return p.jsxs("g",{"data-room-id":h,strokeWidth:Qt,className:Kz(f),children:[b?p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${Su} ${na(t)}`}),p.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${na(t)} ${na(t,Qi*.7)}`})]}):p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:Su}),p.jsx("path",{className:"fill-white",d:na(t)}),x&&p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:y2})]}),n.id==="blacktooth11"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${J({x:St,y:St})}
L${J({x:_t,y:St})}
L${J({x:_t,y:St-Qt*2})}
L${J({x:St,y:St-Qt*2})}
z
M${J({x:St,y:_t})}
L${J({x:_t,y:_t})}
L${J({x:_t,y:_t+Qt*2})}
L${J({x:St,y:_t+Qt*2})}
z
`}):n.id==="moonbase20"||n.id==="moonbase23"?p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Qt*2,d:`
M${J({x:St,y:Z/2})}
L${J({x:_t,y:Z/2})}

M${J({x:Z/2,y:St})}
L${J({x:_t,y:Z/2})}

M${J({x:Z/2,y:_t})}
L${J({x:_t,y:Z/2})}
`}):n.id==="blacktooth77"||n.id==="safari26"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${J({x:Z/2-Qt,y:0})}
L${J({x:Z/2+Qt,y:0})}
L${J({x:Z/2+Qt,y:Z})}
L${J({x:Z/2-Qt,y:Z})}
z
`}):null,d&&p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:Ry(t.away==="doorway")}),p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:Ry(t.left==="doorway")})]}),p.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[p.jsx("path",{d:`M${J({x:0,y:Z})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:ra[t.right]}),p.jsx("path",{d:`M${J({x:Z,y:0})} L${J({x:Z,y:Z})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:ra[t.left]}),p.jsx("path",{d:`M${J({x:Z,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:ra[t.towards]}),p.jsx("path",{d:`M${J({x:0,y:Z})} L${J({x:Z,y:Z})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:ra[t.away]})]}),s&&p.jsx(A2,{className:"fill-[var(--roomHintColor)]"}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:x2}),i&&o?p.jsx(f2,{roomJson:n,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?p.jsx(mi,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?p.jsx(mi,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?p.jsxs(p.Fragment,{children:[p.jsx(mi,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),p.jsx(mi,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):p.jsx(d2,{roomJson:n,subRoomId:e,items:g}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:b2}),A&&p.jsx("g",{transform:kf(Xt($r(A.gridOffset,{x:.5,y:.5}))),children:p.jsx("foreignObject",{width:A.text.length*16,height:16,y:-8,x:A.align==="left"?0:A.text.length*-16,children:p.jsx(H,{noTint:!0,className:"[--scale:2] [--block:16px]",children:A.text})})}),u?p.jsx("path",{className:"fill-transparent cursor-pointer",d:Su,onClick:()=>{u(h)}}):null]})},Cu=(t,e,r,n)=>{const s=jh(e,t[e]?.items);return s&&r===t[e].roomJson.id&&n===xv(s.state.position,"fine",t[e].roomJson)?s:void 0},q2=t=>{const{campaign:e,pickupsCollected:r,gridPositions:n,currentCharacterName:s,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const d=o.r-o.l+2*Ki,f=o.b-o.t+2*as,m=Object.values(n);return p.jsxs("svg",{className:"w-full",style:{minWidth:`${d}px`,height:`${f}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:p.jsx(e2,{...t,curRoomId:u,containerWidth:a}),p.jsx("g",{transform:`translate(${-o.l+Ki+(a-d)/2},${-o.t+128})`,children:m.map(A=>{const{roomId:g,subRoomId:y,gridPosition:b}=A,x=`${g}/${y}`;return p.jsxs("g",{"data-id":x,transform:kf(Xt(b)),children:[p.jsx(w2,{roomGridPositionSpec:A,roomPickupsCollected:r[g]??ye,roomJson:e.rooms[g],headItemInRoom:Cu(i,"head",g,y),heelsItemInRoom:Cu(i,"heels",g,y),headOverHeelsItemInRoom:Cu(i,"headOverHeels",g,y),currentCharacterName:s,roomVisited:l[g]??!1,onPlayableClick:c,onRoomClick:h}),u===g?p.jsx(qv,{svg:!0,smooth:!0}):null]},x)})})]})},v2=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(ga(t),!0):e.currentActionPress("swop.head")==="tap"?(ga(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(ga(t,"heels"),!0):!1},V2=()=>{const t=Ts(),[e,r]=C.useState(t.gameState.currentCharacterName);return C.useEffect(()=>{const n=()=>{r(t.gameState.currentCharacterName)};return Ct.shared.add(n),()=>{Ct.shared.remove(n)}},[t.gameState]),e},_2=()=>{const t=Ts();C.useEffect(()=>{const e=()=>{v2(t.gameState)};return Ct.shared.add(e),()=>{Ct.shared.remove(e)}},[t.gameState])},S2=t=>t.characterRooms[t.currentCharacterName],Nh=t=>JSON.parse(JSON.stringify(t)),k2=()=>Ur().get("cheats")==="1",C2=(t,e)=>{const r=new URL(e),n=r.hash.substring(1);if(n!==""&&t.rooms[n]!==void 0)return r.hash.substring(1)},Cf=({aabb:t,state:{position:e}},{aabb:r,state:{position:n}})=>!(e.x+t.x<=n.x||e.x>=n.x+r.x)&&!(e.y+t.y<=n.y||e.y>=n.y+r.y)&&!(e.z+t.z<=n.z||e.z>=n.z+r.z),Pf=(t,e)=>[...Oe(e).filter(r=>t.id!==r.id&&Cf(t,r))],My=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),Iy={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,button:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},kv=(t,e)=>Iy[t.type]-Iy[e.type],P2=(t,e)=>e.toSorted((r,n)=>{const s=kv(r,n);if(s!==0)return s;const i=_a(t,My(t,r)),o=_a(t,My(t,n));return Math.abs(i-o)<1e-4?r.id<n.id?-1:1:i-o}),E2=(t,e,r,n)=>{const s=Math.max(0,Math.min(t.x+e.x,r.x+n.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+n.y)-Math.max(t.y,r.y));return s*i},jy=({state:{position:t},aabb:e},{state:{position:r},aabb:n})=>E2(t,e,r,n),T2=(t,e,r=.001)=>{if(!$i(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:n}}}}=t;return n>0?!1:Cf({state:{position:ee(t.state.position,{x:0,y:0,z:-1e-4})},aabb:{...t.aabb,z:r+cs},id:t.id},{state:{position:ee(e.state.position,{x:0,y:0,z:e.aabb.z})},aabb:{...e.aabb,z:0},id:e.id})},R2=(t,e)=>{const n=[...Oe(e).filter(i=>T2(t,i))];return n.length===0?void 0:n.reduce((i,o)=>{const a=kv(o,i);return a<0||a===0&&jy(t,o)>jy(t,i)?o:i})},sa=ce.h,M2=-12,I2=t=>{const e=rr(t).filter(uv).reduce((r,{config:{naturalFootprint:{position:{x:n,y:s},aabb:{x:i,y:o}}}})=>{const a=n+i,l=s+o;return{minX:Math.min(r.minX,n),maxX:Math.max(r.maxX,a),minY:Math.min(r.minY,s),maxY:Math.max(r.maxY,l)}},{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0});if(!(e.minX>e.maxY))return e};function*j2(t,e){const r=I2(e);if(r===void 0)return;const{minX:n,maxX:s,minY:i,maxY:o}=r;t.roomBelow!==void 0&&(yield{...pt,type:"portal",id:"portal/toRoomBelow",fixedZIndex:Sn,config:{toRoom:t.roomBelow,relativePoint:{x:(n+s)/2,y:(i+o)/2,z:sa+ce.h},direction:be.down},aabb:{x:s-n,y:o-i,z:sa},state:{...lt(),position:{x:n,y:i,z:M2-sa}},renders:!1}),t.roomAbove!==void 0&&(yield{...pt,type:"portal",id:"portal/toRoomAbove",fixedZIndex:Sn,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?ze(t.ceilingRelativePoint):{x:(n+s)/2,y:(i+o)/2},z:-12},direction:be.up},aabb:{x:s-n,y:o-i,z:sa},state:{...lt(),position:ee({x:n,y:i},{z:ce.h*(t.height??bz)})}})}function*O2(t,e,r,n){const s=so(t.items);for(const[i,o]of s)o.type==="player"&&!n||(yield*_f(i,o,t,e,r))}const Oy=t=>Oe(t).reduce((e,r)=>({...e,[r.id]:r}),{}),zh=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:n=!1})=>{const s=Oy(O2(t,e,r,n)),i={...Oy(j2(t,s)),...s};for(const a of rr(i)){const c=Pf(a,gl(i)).find(u=>$i(a)&&$i(u)&&!(a.type==="wall"&&u.type==="wall"));c!==void 0&&console.error(`in room ${t.id} item ${a.id} @${JSON.stringify(a.state.position)} #${JSON.stringify(a.aabb)} is colliding with (solid item) ${c.id} @${JSON.stringify(c.state.position)} #${JSON.stringify(c.aabb)} on loading room ${t.id}`)}for(const a of rr(i).filter(ks)){const l=R2(a,rr(i).filter(c=>c.id!==a.id));l!==void 0&&Sf({above:a,below:l})}return{...t,roomJson:t,items:i,roomTime:0}},B2=.5,N2=(t,e,r,n)=>t.x<r.x+n.x&&t.x+e.x>r.x&&t.y<r.y+n.y&&t.y+e.y>r.y&&t.z<r.z+n.z&&t.z+e.z>r.z,z2=(t,e,r,n,s)=>{if(no(s)<1e-4)return{x:0,y:0,z:0};const o=wn(s);if(!N2(t,e,r,n))return{x:0,y:0,z:0};let a=-1/0,l=1/0;for(const c of g_){const u=o[c];if(Math.abs(u)<1e-4){const x=t[c],w=t[c]+e[c],V=r[c],_=r[c]+n[c];if(w<=V||x>=_)return{x:0,y:0,z:0};continue}const h=r[c],d=r[c]+n[c],f=t[c],m=t[c]+e[c],A=(h-m)/u,g=(d-f)/u,y=Math.min(A,g),b=Math.max(A,g);a=Math.max(a,y),l=Math.min(l,b)}return a>l?{x:0,y:0,z:0}:l>0&&(a>=0||l<-a)?Rt(o,l):a<0?Rt(o,a):{x:0,y:0,z:0}},Lh=(t,e,r,n)=>{const s=r.x+n.x-t.x,i=r.y+n.y-t.y,o=r.z+n.z-t.z,a=t.x+e.x-r.x,l=t.y+e.y-r.y,c=t.z+e.z-r.z,u=Math.abs(s)<Math.abs(a)?s:-a,h=Math.abs(i)<Math.abs(l)?i:-l,d=Math.abs(o)<Math.abs(c)?o:-c,f=Math.abs(u),m=Math.abs(h),A=Math.abs(d)*B2;return f<m&&f<A?{x:u,y:0,z:0}:m<A?{x:0,y:h,z:0}:{x:0,y:0,z:d}},By=(t,e,r)=>{const n=e.state.actedOnAt;n!==void 0&&(n.roomTime===r.roomTime?t&&(n.by[t.id]=!0):(n.by=t?{[t.id]:!0}:{},n.roomTime=r.roomTime))},L2=(t,e,r)=>{const n=(s,i)=>{const{collidedWith:o}=s.state;o.roomTime===r.roomTime?o.by[i.id]=!0:(o.by={[i.id]:!0},o.roomTime=r.roomTime)};n(t,e),ks(e)&&n(e,t)},D2=(t,e,r,n)=>{const s=ov(t,e,r),i=Lh(t.state.position,t.aabb,e.state.position,e.aabb);if(s&&i.z===0){const o=Rr(n,t.state.position),a=d_(o);if(_a(i,o)/a>.44)return z2(t.state.position,t.aabb,e.state.position,e.aabb,{...o,z:0})}return i},Cv=({subjectItem:t,posDelta:e,gameState:r,room:n,pusher:s,deltaMS:i,forceful:o=Ee("lift")(t)&&s===void 0,onTouch:a,path:l=new Set})=>{if(pd(e,ae))return;const{state:{position:c}}=t;t.state.position=ee(c,e),s===void 0&&By(void 0,t,n);const u=P2(e,Pf(t,gl(n.items)));for(const h of u){if(l.has(h.id)||!Cf(t,h))continue;if(By(t,h,n),a?.({movingItem:t,touchedItem:h,movementVector:Rr(t.state.position,c),gameState:r,deltaMS:i,room:n}),n.items[t.id]===void 0)return;if(n.items[h.id]===void 0||!$i(h,t)||!$i(t))continue;const d=ov(t,h,o),f=D2(t,h,o,c),m=Hr(no(Lh(c,t.aabb,h.state.position,h.aabb)),0);if(d){const A=o||sz(h)?-1:-.5,g=Rt(f,A);if(t.state.position=ee(t.state.position,f,g),l.size<qz?(Cv({subjectItem:h,posDelta:g,gameState:r,room:n,deltaMS:i,forceful:o,pusher:t,path:l.add(t.id),onTouch:a}),l.delete(t.id)):console.warn("hit recursion depth limit",new Error),n.items[h.id]===void 0)continue;t.state.position=ee(t.state.position,Lh(t.state.position,t.aabb,h.state.position,h.aabb))}else t.state.position=ee(t.state.position,f);ks(t)&&f.z>0&&e.z<0&&(t.state.standingOnItemId===null||!u.includes(gv(t.state.standingOnItemId,n)))&&(Ih(t,n),Sf({above:t,below:h})),ks(t)&&!m&&L2(t,h,n)}},Dh=({state:{position:t,facing:e,autoWalk:r,action:n,vels:s}})=>({position:t,facing:e,autoWalk:r,action:n,vels:{...s}}),F2=1e3/25,Pv=t=>{const e=Lt.animations[t],r=e.length,{animationSpeed:n}=e;return r*F2/n};Pv("bubbles.white");const U2=Pv("head.fadeOut"),H2=({touchedItem:t,room:e,gameState:r})=>{Mn({room:e,item:t});const n=Dz({itemType:"bubbles",config:{style:"white",was:t.type==="pickup"?{type:"pickup",gives:t.config.gives}:t.type==="hushPuppy"?{type:"hushPuppy"}:{type:"disappearing"}},position:ae,room:e,gameState:r}),s=Oh(t);n.state.position=Rr(s,Rt(n.aabb,.5)),n.state.expires=e.roomTime+U2},$2=(t,e)=>{const r=rr(t.items).filter(Ee("hushPuppy"));for(const n of r)H2({touchedItem:n,gameState:e,room:t})},G2=(t,e,{changeType:r,sourceItem:n})=>{switch(r){case"portal":return rr(t.items).find(s=>is(s)&&s.config.toRoom===e.id&&(n.config.toDoor===void 0||s.jsonItemId===n.config.toDoor)&&pd(Rt(n.config.direction,-1),s.config.direction));case"level-select":return rr(t.items).find(s=>is(s)&&s.config.toRoom===e.id&&s.config.direction.z===0)??rr(t.items).find(s=>is(s)&&s.config.direction.z===0)??rr(t.items).find(s=>is(s)&&s.config.direction.z>0)??rr(t.items).find(is)}},W2=(t,e,r,n)=>{const s=1*ce.w;t.state.position=ee(t.state.position,Rt(e,s));for(let i=0;i<s;i++)Cv({subjectItem:t,posDelta:Rt(e,-1),gameState:r,room:n,deltaMS:16,forceful:!0,onTouch:void 0})},Y2=t=>{const{playableItem:e,gameState:r,toRoomId:n,changeType:s,sourceItem:i}=t,o=r.characterRooms[e.id];if(o===void 0)throw new Error(`${e.id} is not in a room on the gameState`);if(n===o.id)throw new Error(`Can't move ${e.id} to the same room "${n}""`);let a;switch(s){case"portal":{const{config:{relativePoint:m},state:{position:A}}=i;a=Rr(e.state.position,ee(A,m));break}case"teleport":{const{state:{position:m}}=i;a=Rr(e.state.position,m);break}case"level-select":a={x:0,y:0,z:0};break;default:throw new Error}const l=e.type==="headOverHeels"?void 0:r.characterRooms[ms(e.id)],u=Bb(we.getState()).rooms[n];if(u===void 0)throw new Error(`room ${n} does not exist in campaign`);const h=l?.id===n?l:zh({roomJson:u,roomPickupsCollected:r.pickupsCollected[n]??ye,scrollsRead:we.getState().gameMenus.gameInPlay.scrollsRead});Mn({room:o,item:e});const d=dz(e);if(d!==void 0&&(d.carrying=null),e.state.latentMovement=[],(e.type==="head"||e.type==="headOverHeels")&&$2(h,r),Mn({room:h,item:e}),h.items[e.id]=e,r.characterRooms[e.id]=h,t.changeType==="teleport"){const{state:{toPosition:m}}=t.sourceItem;e.state.position=ee(ze(m),a)}else{const m=G2(h,o,t);if(m===void 0)if(t.changeType==="level-select")e.state.position=ze({x:1,y:1,z:8});else throw new Error(`trying to move ${e.id} from ${o.id} --to-> ${n} but no destination portal found to locate with`);else{e.state.position=ee(m.state.position,m.config.relativePoint,a,s==="portal"&&i.config.direction.z>0?{z:ce.h}:{});const{config:{direction:A}}=m;A.z===0&&(e.state.autoWalk=!0,e.state.facing=Rt(A,-1),e.state.action==="idle"&&(e.state.action="moving"),W2(e,A,r,h))}}const f=Pf(e,Oe(gl(h.items)).filter(m=>m.type!=="portal"));f.length>0&&console.warn("on entering room",n,"character",e.id,"at",e.state.position,"collides with",f),r.entryState[e.id]=Dh(e),e.id==="headOverHeels"?(delete r.entryState.head,delete r.entryState.heels):(r.entryState[ms(e.id)]||(r.entryState[ms(e.id)]=r.entryState.headOverHeels),delete r.entryState.headOverHeels),we.dispatch(bP(n)),we.dispatch(uP({characterName:e.type,roomId:n}))},Ev=t=>{const e={};for(const r of Object.values(t.rooms))for(const n of Object.values(r.items))if(n.type==="player"){const{which:s}=n.config;if(e[s]!==void 0)throw new Error(`Campaign has duplicate starting rooms for ${s}`);e[s]=r.id}return e},Q2=t=>{const e=Ev(t),r={...e};if(e.head===void 0&&e.heels===void 0)throw new Error("couldn't find either head or heels in campaign");let n=Ur().get("playAsHeels")==="1"?"heels":e.head!==void 0?"head":"heels";const s=k2()?C2(t,window.location.href):void 0;return s!==void 0&&(r[n]=s),r.head===void 0&&(n="heels"),{campaignStartingRoomIds:e,startingRoomIds:r,startAs:n,changedCharacterRoomFromCampaign:s!==void 0&&e[n]!==r[n]}},K2=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:n={}})=>{if(r){const m=r.gameState.characterRooms,A=Nh(m);return m.head!==void 0&&m.head?.id===m.heels?.id&&(A.heels=A.head),Object.assign(n,{inputStateTracker:e,gameSpeed:1,...Nh(r.gameState),characterRooms:A})}const{startAs:s,startingRoomIds:i,campaignStartingRoomIds:o,changedCharacterRoomFromCampaign:a}=Q2(t),l={roomPickupsCollected:ye,scrollsRead:ye,isNewGame:!0},c=o.head&&zh({roomJson:t.rooms[o.head],...l}),u=o.heels===o.head?c:o.heels&&zh({roomJson:t.rooms[o.heels],...l}),h=c===void 0?void 0:jh("head",c?.items),d=u===void 0?void 0:jh("heels",u?.items),f=Object.assign(n,{inputStateTracker:e,gameSpeed:1,currentCharacterName:s,entryState:{head:h===void 0?void 0:Dh(h),heels:d===void 0?void 0:Dh(d)},pickupsCollected:{},gameTime:0,progression:0,characterRooms:{head:c,heels:u,headOverHeels:void 0}});return a&&Y2({changeType:"level-select",gameState:f,playableItem:s==="head"?h:d,toRoomId:i[s],sourceItem:void 0}),f},DU=t=>{try{return K2(t)}catch(e){throw new Error("failed to load game state",{cause:e})}},X2=We(Xt({x:1,y:1,z:1})).y,Ny=We(Xt({x:0,y:1,z:0})).x,J2=t=>t.reduce((e,{gridPosition:r})=>{const n=We(Xt(r));return{t:Math.min(e.t,n.y+X2),b:Math.max(e.b,n.y),l:Math.min(e.l,n.x-Ny),r:Math.max(e.r,n.x+Ny)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),ia=(t,e,r,n)=>e.some(s=>s.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:s})=>p_(be[t],u_(s,n)))?"open":"wall";function*os(t){try{yield*Z2(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*Z2({roomId:t,subRoomId:e="*",campaign:r,visited:n={},vectorFromPrevious:s,previousRoomGridPosition:i=ae}){if(t==="nowhere"||n[t]?.[e])return;n[t]===void 0&&(n[t]={}),n[t][e]=!0;const o=r.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...Oe(In(o.items)).filter(f=>f.type==="door").filter(f=>yv(f,e,o))],l=ee(i,s===void 0?m_:s),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:ia("left",a,c,u),right:ia("right",a,c,u),away:ia("away",a,c,u),towards:ia("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:m}]of Oe(so(c)))f!==e&&(yield*os({roomId:t,subRoomId:f,campaign:r,visited:n,vectorFromPrevious:Rr({...m,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:m}=o;yield*os({roomId:f,subRoomId:m,campaign:r,visited:n,vectorFromPrevious:be.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:m}=o;yield*os({roomId:f,subRoomId:m,campaign:r,visited:n,vectorFromPrevious:be.down,previousRoomGridPosition:l})}for(const f of a){const{toRoom:m}=f.config;try{yield*os({roomId:m,campaign:r,visited:n,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:be[f.config.direction],previousRoomGridPosition:l})}catch(A){throw new Error(`error while traversing door ${JSON.stringify(f,null,2)} in room ${t} to room ${m}`,{cause:A})}}const d=o.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:f},gridOffset:m}=d;yield*os({roomId:f,campaign:r,visited:n,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const eL=t=>{const r=[...t].sort(({gridPosition:n},{gridPosition:s})=>n.z!==s.z?n.z-s.z:s.x+s.y-(n.x+n.y)).map(n=>[`${n.roomId}/${n.subRoomId}`,n]);return Rs(r)},tL=()=>{const t=V2(),e=sP(),{gameState:r}=Ts(),n=Nb();return C.useMemo(()=>{try{const s=S2(r),i=s?.roomJson.id??Ev(n).head;let o;if(!r)o="*";else if(!s?.roomJson.meta?.subRooms)o="*";else{const u=s?.items[t];u?o=xv(u.state.position,"fine",s.roomJson):o="*"}const a=[...os({campaign:n,roomId:i,subRoomId:o})],l=eL(a);return{mapBounds:J2(a),curRoomId:s?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:r.pickupsCollected,characterRooms:r.characterRooms,campaign:n,roomsExplored:e,curRoomScenery:s?.planet}}catch(s){throw new Error("error getting map data",{cause:s})}},[n,t,r,e])},rL=()=>{const{ref:t,width:e}=KN(),r=Av(),n=Ts();_2();const s=tL(),i=bv(s.curRoomScenery);return p.jsx(Ne,{children:p.jsx(Se,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:$(Be),children:p.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:r,children:p.jsx(q2,{onPlayableClick:o=>ga(n.gameState,o),containerWidth:e,...s})})})})},nL=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bag’s icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,sL=`## BLACKTOOTH

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,iL=`## BOOK WORLD

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,oL=`## CONVEYOR BELTS

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,aL=`## CREDITS

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
©1987 Ocean Software Limited.

### 38 years later, a Remake

* code by Jim Higson
* Playtesting, ideas, map design, and general support by my brother, Tom Higson
* Playtesting, moral support, and constant comms by [Jon Albaugh](https://x.com/fextwolf?s=21&t=PEqxJblCn3JB_NH8AOR6Zg)
* Head over heels [font](https://fontstruct.com/fontstructions/show/996776/head_over_heels)
recreated by [Patrick H. Lauke](http://splintered.co.uk/)

This project is licensed under the GNU Affero General Public License v3.0 (only) - see the LICENSE file for details. All code is original except where indicated otherwise.

©2025 Jim Higson`,lL=`## CROWNS

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,cL=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
if you pick them up while head and heels are joined, they get *two each*

## Iron pills ![](texture-hud_shield?sprite-tinted&text-metallicBlue&sprites-normal-height)

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud_bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height)♨ Jump higher bunny ♨

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud_fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height)⚡ Go faster bunny ⚡
![](texture-animated-head_idle_right?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,uL=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so don’t waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,hL=`## EGYPTUS

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,dL=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,fL=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heels’s evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,pL=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_walking_towards_2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heels’s bag and Head’s hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the other’s back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Head’s jumps and Heels’s jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you can’t understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,mL=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown_blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_walking_right_2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,gL=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,AL=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Head’s race, they disappear and won’t return until they are sure the coast is
clear.

> Head Over Heels Manual
`,yL=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,xL=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,bL=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* To the right of the address bar, click the **install icon: **. It might also look like a 'download' icon.
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if you’re not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock 󱂩**
* **Head over heels** is now installed on your mac
* If you don’t want to keep the game in the Dock, right-click the doc icon and uncheck **Options ➡ keep in doc**. It is still available in Applications

---

## Firefox 

* Firefox doesn't support PWAs out of the box, but there is a [browser extension](https://addons.mozilla.org/en-US/firefox/addon/pwas-for-firefox/).
* Probably easier to play in the browser until Mozilla adds support`,wL=`## Supported platforms

Almost anything with an up-to-date browser can play

Here’s some I’ve tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,qL=`## SAFARI

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,vL=`## SPRINGS

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,VL=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Head Over Heels Manual, revised for remake
`,_L=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,SL=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minion’s back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, they’ll never get this far!

*> Your humble minion*
`,kL=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,CL=`## THE EMPEROR’S GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,PL=`## THE GAME

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain ‘keep fit’ equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,ve=Object.assign({"./bag.md":nL,"./blacktooth.md":sL,"./bookWorld.md":iL,"./conveyorBelts.md":oL,"./credits.md":aL,"./crowns.md":lL,"./cuddlyStuffedWhiteRabbits.md":cL,"./doughnuts.md":uL,"./egyptus.md":hL,"./head.md":dL,"./heels.md":fL,"./hintsAndTips.md":pL,"./historyOfTheBlacktoothEmpire.md":mL,"./hooter.md":gL,"./hushPuppies.md":AL,"./penitentiary.md":yL,"./reincarnationFish.md":xL,"./remake/installGuide.md":bL,"./remake/supportedPlatforms.md":wL,"./safari.md":qL,"./springs.md":vL,"./switches.md":VL,"./swopKey.md":_L,"./teleportBack.md":SL,"./teleports.md":kL,"./theEmperorsGuardian.md":CL,"./theGame.md":PL}),Ef={historyOfTheBlacktoothEmpire:ve["./historyOfTheBlacktoothEmpire.md"],theGame:ve["./theGame.md"],egyptus:ve["./egyptus.md"],penitentiary:ve["./penitentiary.md"],safari:ve["./safari.md"],bookWorld:ve["./bookWorld.md"],blacktooth:ve["./blacktooth.md"],head:ve["./head.md"],heels:ve["./heels.md"],reincarnationFish:ve["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:ve["./cuddlyStuffedWhiteRabbits.md"],hooter:ve["./hooter.md"],doughnuts:ve["./doughnuts.md"],bag:ve["./bag.md"],crowns:ve["./crowns.md"],teleports:ve["./teleports.md"],springs:ve["./springs.md"],switches:ve["./switches.md"],conveyorBelts:ve["./conveyorBelts.md"],hushPuppies:ve["./hushPuppies.md"],theEmperorsGuardian:ve["./theEmperorsGuardian.md"],swopKey:ve["./swopKey.md"],hintsAndTips:ve["./hintsAndTips.md"],credits:ve["./credits.md"],installGuide:ve["./remake/installGuide.md"]},EL={...Ef,teleportBack:ve["./teleportBack.md"]},TL=/^##\s+(.*)$/m,RL=t=>{const e=t.match(TL);if(e===null)return"no title found";const[,r]=e;return r},Pu=t=>{const e=t.source==="manual"?EL[t.pageName]:t.markdown,r=Av();return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:$(Be)}),p.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:$(Be),children:[p.jsxs("div",{className:rt("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[Ye()&&p.jsx(nn,{className:"pb-1"}),p.jsx(Ie,{markdown:e})]}),p.jsx(Pe,{className:"hidden",children:p.jsx(Mt,{})})]})]})},Tv=t=>{t.reincarnateFrom(we.getState().gameMenus.gameInPlay.reincarnationPoint),we.dispatch(Ld())},ML="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",IL=()=>{const t=Ts();return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midRed zx:bg-zxYellow"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed px-1",children:[p.jsx(H,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),p.jsx(Ie,{markdown:ML,className:"text-redShadow zx:text-zxWhite"}),p.jsxs(Pe,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(K,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{Tv(t)}}),p.jsx(K,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:$(zd,{offerReincarnation:!1})})]})]})]})},si=de("[&_.em]:text-lightBeige zx:[&_.em]:text-zxCyan text-lightGrey zx:text-zxBlack sprites-normal-height"),jL=`![](texture-animated-head_walking_towards?float-right)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,OL=`pokes can’t be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,BL="everything to *select the keys* and other input settings",NL=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Be)}),p.jsx(Se,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+xf,children:[Ye()&&p.jsx(nn,{className:"text-highlightBeige"}),p.jsx(H,{TagName:"h1",className:"ml-4 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),p.jsxs(Pe,{className:`${yf} gap-y-half`,children:[p.jsx(K,{hintInline:!0,id:"controlOptions",label:"Control options",doubleHeightWhenFocussed:!0,onSelect:$(wt,"controlOptions"),hint:p.jsx(Ie,{className:si,markdown:BL}),leader:p.jsx("span",{className:`${_e} sprite texture-joystick sprites-normal-height zx:sprite-revert-to-white`})}),p.jsx(K,{hintInline:!0,id:"sound",label:"Sound options",doubleHeightWhenFocussed:!0,onSelect:$(wt,"sound")}),p.jsx(K,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:p.jsx(vn,{value:!Od()}),onSelect:$(hr,"userSettings.displaySettings.uncolourised"),hint:p.jsx(Ie,{className:si,markdown:jL})}),p.jsx(K,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"livesModel",label:"∞ Lives poke",hint:p.jsx(Ie,{className:si,markdown:OL}),valueElement:p.jsx(vn,{value:ue(Ib)}),onSelect:$(hr,"userSettings.infiniteLivesPoke"),disabled:ws()}),p.jsx(K,{hintInline:!0,leader:p.jsx("span",{className:`${_e} sprite texture-doughnuts sprites-normal-height zx:sprite-revert-to-white`}),doubleHeightWhenFocussed:!0,id:"infiniteDoughnutsPoke",label:"∞ doughnuts poke",valueElement:p.jsx(vn,{value:ue(jb)}),onSelect:$(hr,"userSettings.infiniteDoughnutsPoke"),disabled:ws()}),p.jsx(K,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"showFps",label:"Show FPS",valueElement:p.jsx(vn,{value:ue(WC)}),onSelect:$(hr,"userSettings.showFps"),hint:p.jsx(Ie,{className:si,markdown:"frames-per-second shown during gameplay"})}),p.jsx(K,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:$(wt,"emulatedResolution"),hint:p.jsx(Ie,{className:si,markdown:"see more of the room by choosing a higher resolution to emulate"})}),p.jsx(Ds,{}),Ye()||p.jsx(Mt,{})]})]})})]}),zL=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsx(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:$(Be),children:p.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[p.jsxs("div",{className:"flex gap-7",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),p.jsxs("div",{className:"flex flex-col items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_walking_towards_2 hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),p.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[p.jsx(H,{children:"The people salute your heroism"}),p.jsx(H,{children:"and proclaim you"})]}),p.jsx(H,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),p.jsx(Pe,{className:"hidden",children:p.jsx(Mt,{})})]})})]}),LL=()=>{const t=ue(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0),e=Ts();return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midRed zx:bg-zxYellow"}),p.jsx(Se,{className:"bg-white zx:bg-zxRed px-1",children:p.jsx(Nn.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[p.jsx(H,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),p.jsxs(Pe,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(K,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:p.jsx("span",{className:`${_e} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:$(Be),hint:"Back to the game"}),t&&p.jsx(K,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:p.jsx("span",{className:`${_e} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>Tv(e),hint:"Go back and continue from the last reincarnation fish you ate"}),p.jsx(K,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:$(zd,{offerReincarnation:!1}),leader:p.jsx("span",{className:`${_e} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ie,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"})})]}),p.jsx(Fs,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},DL=({pageName:t})=>{const e=Ef[t],r=RL(e),n=Pt()==="desktop";return p.jsx(K,{id:`markdown/${t}`,label:r,onSelect:$(wt,`markdown/${t}`),doubleHeightWhenFocussed:n})},FL=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-midGrey zx:bg-zxCyan",onClick:$(Be)}),p.jsx(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:p.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${qe} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[Ye()&&p.jsx(nn,{className:"mb-1"}),p.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[p.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),p.jsx(H,{className:"sprites-double-height mx-1",children:"Read the manual"}),p.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),p.jsxs(Pe,{children:[[...Oe(bd(Ef)).map(t=>p.jsx(DL,{pageName:t},t))],p.jsx(Ds,{}),Ye()||p.jsx(Mt,{})]})]})})]}),UL=()=>p.jsx(Ne,{children:p.jsxs(Se,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:$(Be),children:[p.jsx(H,{className:`${qe} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You don’t go towards the light"}),p.jsx(H,{className:`${qe} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),p.jsx(H,{className:`${qe} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),p.jsx(H,{className:`${qe} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),p.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),p.jsx(Pe,{className:"hidden",children:p.jsx(Mt,{})})]})}),ii=94e3,zy=(t,e)=>t*160+e*1e4,HL=[{upToProportion:8e3/ii,label:"beginner"},{upToProportion:2e4/ii,label:"novice"},{upToProportion:3e4/ii,label:"spy"},{upToProportion:55e3/ii,label:"master-spy"},{upToProportion:84e3/ii,label:"hero"},{upToProportion:1,label:"liberator"},{upToProportion:1/0,label:"completionist"}],$L=(t,e)=>{const r=t/e;for(const{upToProportion:n,label:s}of HL)if(r<n)return s;return"completionist"},GL=()=>{const t=Nb(),e=ue(KC),r=ue(({gameMenus:{gameInPlay:{roomsExplored:a}}})=>Fu(Oe(In(a)))),n=zy(r,e),s=Fu($x(t.rooms)),i=zy(s,5),o=$L(n,i);return p.jsxs(p.Fragment,{children:[p.jsx(tv,{noSubtitle:!0,className:"resHandheld:hidden"}),p.jsx(H,{classnameCycle:Cr,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:o}),p.jsxs("div",{className:`contents ${qe}`,children:[p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",n.toLocaleString()]}),p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",s," rooms"," ",`(${(100*r/s).toFixed(1)}%)`]}),p.jsxs(H,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),p.jsx(Pe,{className:"hidden",children:p.jsx(Mt,{})})]})]})},WL=()=>p.jsx(Ne,{children:p.jsxs(C.Suspense,{fallback:p.jsxs(p.Fragment,{children:[p.jsx(Fe,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[p.jsx(Fe,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:$(Be),children:p.jsx(GL,{})})]})}),YL=()=>{const t=ue(tP),e=ue(rP);return p.jsxs(p.Fragment,{children:[p.jsx(Fe,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:$(Be)}),p.jsx(Se,{className:"bg-white zx:bg-zxWhite pb-0 pl-1",children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+xf,children:[Ye()&&p.jsx(nn,{className:"text-highlightBeige"}),p.jsx(H,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Sound Options"}),p.jsxs(Pe,{className:yf,children:[p.jsx(K,{doubleHeightWhenFocussed:!0,id:"mute",label:"Mute",valueElement:p.jsx(vn,{value:t}),onSelect:$(hr,"userSettings.soundSettings.mute")}),p.jsx(K,{doubleHeightWhenFocussed:!0,id:"footsteps",label:"Footstep sounds",valueElement:p.jsx(vn,{value:!t&&!e}),onSelect:$(hr,"userSettings.soundSettings.noFootsteps"),disabled:t}),p.jsx(Ds,{}),Ye()||p.jsx(Mt,{})]}),Ye()||p.jsx(Fs,{className:"text-moss zx:text-zxGreen"})]})})]})},QL=`##*HoH-ed ➡* The Level editor
I built an *editor* so I could make the **sequel levels**

![](texture-headlessBase?float-left)**Make puzzles**!

*Challenge* others to **solve them**!

**in beta**; expect occasional crashes and *frequent confusion*`,KL=()=>{const t=C.useCallback(()=>{window.location.href="/editor/"},[]);return p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-pureBlack zx:bg-zxBlack",onClick:$(Be)}),p.jsx(Se,{className:"bg-shadowHalfbrite zx:bg-zxBlack px-1",children:p.jsx(Nn.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[Ye()&&p.jsx(nn,{className:"text-midGrey zx:text-zxWhite"}),p.jsx("div",{children:p.jsx(Ie,{className:"text-midGrey zx:text-zxWhite",markdown:QL})}),p.jsxs(Pe,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[p.jsx(K,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),Ye()||p.jsx(Mt,{customLabel:"I’m scared, go back"})]}),Ye()||p.jsx(Fs,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},XL="2924c962-99f1-4dd2-9b9c-fef832dc991b",JL=t=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:$(Be)}),p.jsx(Se,{tall:!0,className:"bg-metallicBlueHalfbrite text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:p.jsxs(Nn.Provider,{children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[Ye()&&p.jsx(nn,{className:"text-highlightBeige"}),p.jsx(H,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-4",children:"Select which game"})]}),p.jsx("div",{className:"zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:p.jsxs(Pe,{className:"gap-y-1",children:[p.jsx(K,{id:"originalGame",label:"original remastered",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(Oi,{campaignLocator:ez}),leader:p.jsx("span",{className:`${_e} sprite texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ie,{className:"text-lightGrey sprites-normal-height",markdown:"remaster of the **300-some** rooms from the original game"})}),p.jsx(K,{id:"remake",label:"Sequel",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(Oi,{campaignLocator:{userId:XL,campaignName:"sequel",version:-1}}),leader:p.jsx("span",{className:`${_e} sprite texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ie,{className:"text-lightGrey sprites-normal-height",markdown:`unofficial; **work in progress**

the story continues **38 years later**: All-new levels designed for the remake`})}),p.jsx(K,{id:"community",label:"Community contributed",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:$(wt,"communityGames"),leader:p.jsx("span",{className:`${_e} sprite texture-charles_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(Ie,{className:"text-lightGrey sprites-normal-height",markdown:"check out what people have made in the editor"})}),p.jsx(Ds,{}),Ye()||p.jsx(Mt,{})]})}),Ye()||p.jsx(Fs,{className:"text-highlightBeige zx:text-zxCyan text-center max-w-32 mx-auto"})]})})]}),ZL=t=>t.startsWith("markdown/"),eD=t=>{const e=ue(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(ZL(e.menuId))return e.menuId==="markdown/inline"?p.jsx(Pu,{source:"inline",markdown:e.menuParam.markdown}):p.jsx(Pu,{source:"manual",pageName:e.menuId.slice(9)});switch(e.menuId){case"communityGames":return p.jsx(Pj,{});case"controlOptions":return p.jsx(iN,{});case"crowns":return p.jsx(cN,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return p.jsx(dN,{});case"errorCaught":return p.jsx(AN,{errors:e.menuParam});case"hold":return p.jsx(xN,{});case"inputPreset":return p.jsx(wN,{});case"installGuide":return p.jsx(Pu,{source:"manual",pageName:"installGuide"});case"mainMenu":return p.jsx(EN,{});case"map":return p.jsx(rL,{});case"modernisationOptions":return p.jsx(NL,{});case"offerReincarnation":return p.jsx(IL,{});case"proclaimEmperor":return p.jsx(zL,{});case"quitGameConfirm":return p.jsx(LL,{});case"readTheManual":return p.jsx(FL,{});case"reincarnatedRestart":return p.jsx(UL,{});case"score":return p.jsx(WL,{});case"sound":return p.jsx(YL,{});case"sureWantEditor":return p.jsx(KL,{});case"whichGame":return p.jsx(JL,{});default:return e.menuId,p.jsx(Se,{children:p.jsx(H,{children:`unknown dialog ${e}`})})}},tD=Xi(()=>gr(()=>import("./gameMain-yJlnr7HI.js").then(t=>t.g),__vite__mapDeps([9,7,4,1,2]))),rD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAARAAALSQBAQEBAQFZWVlZWVmNjY2NjY3FxcXFxcX5+fn5+fomJiYmJiZSUlJSUlJ6enp6enqmpqamptLS0tLS0v7+/v7+/ysrKysrK1NTU1NTU39/f39/f6urq6urq9fX19fX1//////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAZAQQABuAAAC0mIpRnOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABGwBW7QAACH6lCs/NvBI1AAbSkgF4ABRZcPlz4Pg+D4IROD74Pn+q3wQ/KOwQOQQBAMAAOJTDmiIJGRsnW4gAAAAGHBw0GGr6h1QsZCJmtI5hYgmsYoAR0Ag4JBUuUZAsPJMg6JJglclhHUckcsioTqgczgUZ3kIHEq4rEwqNkFsLgn2Y+C3J43WE3Xo9BYGhDDkPxFE+X4CQuplOyOZfBxw0udCrX3zOQVmZoMIXhedAAJChVEEU7wAEGTZdNwgH7mWw5DSFJLPdV2KNnLuOzSTEqBeEAdPlZlTEwHqxNqs1LMcxMM1a1djNU425jGjLFpvdlvuYsfO+n1l+gAR6tolOGFYmwQBCMWKqZ1qMDBIZELiWfE5pVNre897tRKIpRXrvmoG1vegftCy+Kzbj//LZEz9fMoQA2aXZklv4AAYkhwMhQNKHAIx0Fw6iMOQxEpgKZZPRYJ8qBGb7ZHoZqcMofVh2ktwoGiAkzC8VF9v2AAkLDsqNzd5lQAV49Xg4qgYi4La1Xx8Tg0zFyPZIkpbTT7GNSxffKqESjUh0B0DZvlpu/0wBWqpZVsm4AAVjWOro4yB/tqpNY8ZjQNFXPky40t8krDdfZpDHvm58XRUg0XCIpf4nF7nTcVfLwQBXeXdXlvCymVErYmUA1UDNKRHROOh7OHcKWss9aNWDMxPfS5VDJocqMY8plQWcUpemgAGiJhlSS8AABLZawwON1FlnaA2kBuSB6H4eRSYmC0sEFJ6AoX2k5armpKStllLC7mA2Ui/iAAsTEyzX/hw2PKNiagjPDYWlUyDk62rR+41nJr50i0hS0p5W1D/+1DE3YBJfKlV/ZQAKOYGqrWNMBWNB1CoYU2F1bm1AEiIiHeP/wAAGeu00cmu3GAFjOSBwqEpNHHeS+xC60FPuHFcS+ddde3vq92QACKzvDvtwGIfpxBPjpjH+mmJx5JgBEY8FLXit5bva+ElTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVEBiZgJkAAAAFhBRpzk2oF9X2Vys7kT6VmBXM0AAAqVgiMgd0ljw7xocqTEFNRTMuMTAwqqqqqqqqqqqq//sgxPgAR1RxXeywY2jRjir9lIldqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoQSXcAAAAAADsYgVwgUZnVIPsgaXAKRyFrIA7uFp1MQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7IMT3AEcIR1PsvMMoyQ5p/ZYMdVVVVVVVVVVVVVVVVVVVVVUiUAAABiblGtCRdQPwAdAVA2HQVHNLqkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqhPQAAAO8d7/+yDE+ABGtHNJ7LBlKLsNKX2GDHRUNQVKqAeAFALgMUhOTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIoAAABVRRqMgKxqApRNAYEQONA1MQU1FMy4xMDBVVVVV//sQxPwARZQhSewwZmiDgmj894QUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUwAAABgK0HQWBEQADnZgKHRLExBTUUzLjEwMKqqqqr/+xDE6wDDBBlNxj2AYEQCajjEsAWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIgAAACRH2BRkK4jAAqJ6MYhqTEFNRTMuMTAwqqqqqv/7EMTlAcJAEUnGMeAoLoJpuLYEFKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqjQAAABWHpJWVawACtQ6Yp1MQU1FMy4xMDBVVVVV//sQxOGBwWQNQoY9YCAsAihQxawEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWAAAAoBIFQJYcX1UxBTUUzLjEwMFVVVVX/+xDE4AHBgA1Ah72AKB8BaJDGLARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVXCAQAAAAAA4GyRY0NlTjf/5362Fc93KTEFNRTMuMTAwqqqqqv/7EMTgAcE0Cz6HvMAgKQGn0PYkBaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN8BwTQLOQesQCAhAaeQ9IgEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE3wHBRA04h6RAIB2BZxC2CASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTeAcEoCTEGPAAoGYFmIMeEBKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNuBwPAHKqYcACgMASVCkgAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE4YACzBk0mYAAAAAAP8OAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",nD="/assets/bonus-CvVo342Z.mp3",sD="/assets/bubblesLoop-B_LY362Z.mp3",iD="/assets/conveyorLoop-CF-OA6qJ.mp3",oD="/assets/conveyorStart-CcCK4MGd.mp3",aD="/assets/conveyorStop-D5zeg8cv.mp3",lD="/assets/destroy-CZDN4Ktz.mp3",cD="/assets/detect-D_kRR5uD.mp3",uD="data:audio/mpeg;base64,SUQzAwAAAAABZlRZRVIAAAALAAAAMjAxOS0wNy0yMlREUkMAAAALAAAAMjAxOS0wNy0yMlRJVDIAAAARAAAASGl0IEdsYXNzIEJvdHRsZVRBTEIAAAAlAAAAR2xhc3MgRXNzZW50aWFscyBmb3IgU291bmQgRGVzaWduZXJzVFJDSwAAAAQAAAA3OTdDT01NAAAAKAAAAAAAAABIaXR0aW5nIEdsYXNzIEJvdHRsZSwgU2luZ2xlLCBDbGlua0NPTU0AAAAoAAAAWFhYAEhpdHRpbmcgR2xhc3MgQm90dGxlLCBTaW5nbGUsIENsaW5r//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAOAAAJ3QBLS0tLS0tLZWVlZWVlZXR0dHR0dHSBgYGBgYGBjo6Ojo6Ojpqampqampqnp6enp6entLS0tLS0tLTAwMDAwMDAzc3Nzc3Nzdra2tra2trm5ubm5ubm8/Pz8/Pz8/////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAXAQQABuAAACd1hx+LLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAAA5wBYfQAACIEmGp/N6ABmZYgAzErrwAAAfB8cQKLB83lwfD5c+X6w/BM/y8XQAAAAAAABkLQ3wlAAAAEQCwAwww0+WFa3dKgv4UAX3JSIKgDXzlh5HA2onSwloqV6WFcNjBcHO5I/A2nao/IO7QNDrL5DEV7sGilCECu5N2ZdD6x5VWsTCGjFa9mHHFiEu5P37Hf9oTWJXUhuJbi0f3jf/////Kx/6w1IqXWNbDPhkACAABbeAAglG0QILxOnB7jM6izYniEZDiombEIbu2UDNAsCoiDAR8RMrHzFdtSTKSlIhwndIvEFQJoni8dPVGKK060UeUVmT39aE/l8mXwVKPLZsuYARADU+sYvG5LsvtYZ1nAN6GjBlThtPbQ41qaNRKnLBREVTK3U1235+UqDZrLmni127D6GP7hQP7esoGjUNUiyqt5YQVQCibgADqFMeHg1YBC+v1Uf8WImfCX2fb7uOELxKpF7Zo0YMEJXiHq9QV1GuBcuGQ1oIy1R5Yyaq4EFYAiXvMoZmtw887IpW1j30JKl6XVIj/aMvP6BTW7aIDIRXh8oxbkyFCdKLvuxAmEf7gAACUdZaUJZc/MUygMRlgX4rXomhjhgAI61iUMeob/9VyliVmmGAHcGncdaLpwYClXWFmpAllZeRCMRufXVZ9fSZpuIF6SzMlVALqhB5WdwAAAKqjzk1H9osoBA0+eS2xDa9B7PvtMmf9YBVVYZdVwAMnzjOLOixgcJ+o4iHkTm4Ghzqw+dUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVQC6tguqngAAACpVR4j+BDEUApT/+1DE34BKpKlb/YkAIQkVa32VnlRNmgn05U6qyId3/pItAN3GDc4OCrmmUNA+BOcus1KXqDolTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAJiVCAgAAACCtZrSkAaFXbQN8xwByrKrBKAC3GVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUAWg0A//sgxPEAR1hjU+ZgpaC5CGo9l5WUPFJEWDoMAGAGAMAKSkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoEAAWFJYIvgAC3XiY3TEFNRTMuMTAwqqqqqv/7EMTzAMVIXVvg4QNgk4hpOBykZKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoAMAAAg8N5aA1MQU1FMy4xMDCqqqqq//sQxPSARBQ/T+BhIyBviCq8B6hsqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpRlYUFXUxBTUUzLjEwMFVVVVX/+xDE8IDEAEFT4D0jYFMGK7gEoG1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUF9aTEFNRTMuMTAwqqqqqv/7EMTkgMIYG0/ACYJgMQOo0AQsXaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN6AwTwdQIAFZGgaA6jgACQeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjEwMKqqqqr/+xDE3IHA5B82oAGA8BeDp1AAPByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTag8D4HTUAKeggBQNmQAAcJKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNiDwFAdKACB4SAJg6WAECQkqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE14PALBsuAIBBIAUAZoAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA/wAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNYDwAAB/gAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",hD="/assets/headFall-rxdxTCeK.mp3",dD="/assets/headJump-GCHlCfni.mp3",fD="/assets/headWalk-B5kQ4tvC.mp3",pD="/assets/heelsFall-IsGtipMw.mp3",mD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAANvQA8PDw8PDw8PFFRUVFRUVFRYGBgYGBgYGBtbW1tbW1tbW2Dg4ODg4ODg5SUlJSUlJSUpaWlpaWlpaWltra2tra2trbFxcXFxcXFxeTk5OTk5OTk5PX19fX19fX1//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAP3QQABuAAADb3ce6y6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBabQAACL+Jyq/M5AAAATd0rslm3BwuD4PvKAgCEMYIAmD4Pg+fiAEDivB//BB2CYP8EPlHQfB8PygIfUcwfD+CAYAAU4EERahmVG1qTLSTRQACHQxwMcMsQaNBDJykQAnheOVsEjpbtBSluhY8aLnhkR3SqInu5pvluoCGSNeIPEP7PIsMVAof8vqJIx+WjoAGziDvEiannoTqQJv+0KPDobqTKkIbRlSwicofK9BcD9jj2flFuRxqG4IZpVoIx+cf3jH3bymJbbxuRDmnwwrxLmpba+3O/ErHaWc5hR9j1FX+EfSxTtJf5Xw7U3zPLtX93P13n8q0H8rc1fcf/2L9C1KBFc4gxM3ZCYJmGinxCyQF6IUdQ+jRISyQlcGwEOLFUWAlRJGCxiiZGykUUUVOsZRsxqgbLdYXQljEukqSpKi1RH0CbCYiMlaKRuVF4rBUmhlRRMaI9x4osiymzPfWyRkizL17nqukpI37b1Ge+cSSMm1qSMlXb1mySRvqU6jZJX5hhAoPEGrCrl7RMBc4xmIkmS2dx0kvlSGcyItAQ7CyS/Im6bufIFqiY2tBakdJ/EMFq2Y8EqwmDkowf3YIWW1NR58qp/W7OkvEWr123iWK4i96wY5eleVa7basASy6Q4hZ3I4etRFgbWA2XHZiHG+y+QF2HYI4TiV1JEWkxrXwwxLraLURInnGvIxrj7qZAZf79rQT06eVSprKvhjzbStl/25YYBkc4lld1tgADlzyqygh+XOi5b8cqWXJOiCP7izoTNBbakKzalazLiaPx0MIQUFDj5qZnDbNvW2IU+d2jMC5bmOa8HfWbaEuoX7/ofcHaTKCaoIKVk2lFU+TQADpM9RDdyAlEXAlK6OnRKRHINRFtwMUFl3Ww9da+P2qv+f9wJyyJoxE4yTEFEzrrqIhw+nan+4Rr4+fSdsUW2CB/VrcgGS3iLl3+/+YAKdlIf/+2DE6IAQdVFb/PaAKUGVLDz0HfSlDIIgrA4H92yr5cAuKkFkhW7a1rZDWricNKm+oQmq25qlRr91S79meUexMW6rst5aLH/u71fzQAASKHmP0cFUb7VH5vUUppI9RQrVs0alF94d2ECivnfDHRKkw9EiSy+l0e9T0ZWd9/+VdAkigRcGdFAl0okAoEAYAGo0SOObDj4QAiD0ej4AgBlyt9sGDiq7XKjYyg9chwAXABM+F9A2wiAZ2BFwwv6A8DLkTGIKBDZQJ/qw48QoSwtg54XyHPC5AKQRD8+M2TQ4BKBASSJMTwOk2E8/zcn0jQuNEZFAQmFpEaFknP+ybn0GZOVxKBb/+0DE9oAKEM1b56BxoUaZ6j2HoHzIsM2LgLJoOP/+yC001MhOmyJkTpkiXjUC/9Px8VpHYGaDBR8uiAKF8r1kDRHDX4oVTRp+YZj9/B+amUqE46DOi2iMgeRvJRI0UbIol0GwSzzNFnNjzwVsLijM2QdMjvDbESjW1pamwzi0XV5/MiX/mmkX/6G5mv9B8w8lZyVnElvL/WTmDRAgheNxEAEpQIGsN80TuDtnMlnLCfqHrw9W6v/7MMT1gAmoqUvsMWkg9hKqfPYcfN6tr/F+M71h8j3JG2a6y9rzqELFmDWmPrNcwiQ3x9Yx5d7yYJeaTwdV93Lez9HjRkfpuBZ9+T4gf8k+Ofwyb/wZcF/jSPK0VRZQmIIVTzbNFgy35L0whBPTi0mVYsmen3JU+67Wsf3+vqmmtSMcfb6BjyXvzl3rN6V+dzRCgGviO9U/CAFSYf/7YMTzgAcggUW1gYAijidqvzUgQMuLnVQWVPiV9H5VjRT+l4F/loQ7f2y/1//HSPI0C6Arwaur2vcIA1LBQ1CmHEbm/92uTTvv7VilrsRcXsK1podo2HzUrH28/H2+s2xDoV7j4OrbvFiq45nCusWz8+uDvOmIzTwab00QnIdiifcX+1rm//wUyqAZ+Y55mmFp3cW+r60EQodkND92jYAHly9vYGehmTdM7jmwO2uF1uEPasNO/xbMbdfbC2q3jC4RpNQZtty5YosXMHWHuWZnGnLj3xjbbDzokInKmkiNVQwC2u+qOiCn+WaVJAHULvSc1/1e5YSQGimpk5emQAJmsIhLFf/7UMT9AAytA2H9hoAhkyVrfPOLzJ5Dq4L0DQ7J62Vxt8JluDcoVZzyxqZ/vK7D0v3Vy3vmW98ZlT8pHDMyplRSBo1RDRa19VLISV72ThYEndXbNx8RnOPmsqocxH+YuO3/+Q5K3pUdP/A++awgAFaY1HlRQE1pyZC4MNyGrFsX1Rk4g8uOQDy8migDCo2qNSQJkdzViTxUPc1as8PHZeyNmD329Pyw+W2dr28AAACXPUDhVn4l8Krv/KY7A1uJOFqxOElu6aP/XB4yPrLtiJn/+1DE9QALhSth56y6YZKdKr2HofzIIFy1rTeWqGGuSgIXr6P3ff/22dn/6/QqeAmgqWaTeECCoYEAIAAAAFx64msnKFFjiqafYSTbc7jgMvUbJcvn2WWYebpAZ1KBr1dlseUBqw4bKBhRfoGjmgWVgZAIGFBc/f8G5geoRACwMPQ//C6gWcHqE4JzEYf/44BZZsaDliC4yf//5qQMiYsggh4Zgihp///5EzhcK9Zd///B8PA+CAADH////0gRAAPWKgvFMiPaNosABEAHoAl0//tQxPIAC+TRTew9TeGBnWi9hJ8MSKp0muQGavaZwAYYcqcx4NWwzRUyBVtEChJaWRYSccwPwYGPXRGDgriBR0rsBHi4miGPAaDyCpmAyZmwBGiik74hC1I0kNEgq0+y0YFAQVFhpSX9SsFcooM3eyd5LciIoQXmEASMEoABlYV0/ADR1PU+P0cRUY/SZLkBAmw2bgB3uSmFZaoKeSPi/FXCCp1cESzkj+R2rWhqnz5q9Tf+qb/1yd39yD3Qy+MyyNy2rlF9Svf8nZnuvqXrH//7QMTvgAf0oUesNKzhBg3n9rCwBPq3U//3dpu3LwPSVTb6tbitOoA2ukN5JkSUlAYEHAkImfuZKXlcalg2WtxgSRyynjiOaVCSKxNdDDxfaS3FUFgWr/1qggwvnORt7jEkVEEK3/fkP/u2Vb/ouhP9cs7yMQ/PWeppkGmHU1dd1YgNOQoHEnhLKEyJ4q2cuajZ1ezv45cQpiPGANEEFppumtSaaA7BL2rOpvbQ4sUXetNNabGJ//uAxP8AEdUxU/maAEN8KSq/NbIAoaDkBwDWbz5s6epY8E1piGSZRghd6ytqAzpb/qd0zMna/6HX/6noGC9vzqDiKkYFYKYBUCQBUFBAGAwAAADvUU0NTsnI/zOjRFNNZI7/EV6cC3lMf9MQEvCS4LEcRMLC6P3JYepIl0TIdxfC6+XhxDGNZNJUT4yNvuXR7D2TOf/pGJqTVP//zpdJFJR1EW/56W2KTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1DE9AAKYOtn/YUAIamnrD6e0AWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sgxPKADKDVUfmWggAAADSDgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",gD="/assets/heelsWalk-Bmk6WOTI.mp3",AD="/assets/helicopter-BYGzJTF2.mp3",yD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAAMtwBBQUFBQUFBQVlZWVlZWVlZbGxsbGxsbGx+fn5+fn5+fn6Pj4+Pj4+Pj6KioqKioqKisrKysrKysrKyxcXFxcXFxcXV1dXV1dXV1ePj4+Pj4+Pj4/b29vb29vb2//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJASdQQABuAAADLeLlBWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBYbQAACJ3neu/MYIARAV1lrd0u4AfKAgGHA+8EAQB8Hwf4gBB2D4fygIO5cHHcH+UDH+oEAQdic/lAQBAHz+BAxoAQBSAwTDAgNkVT1nptAgAY0GGiYh7PCRB7DVx5YfkOOROSqQUSkYfHnOLhrEBoy3a5IOd+kTrUdfJXD4SqC23fdhrDn9VGu+Qt0nmCOG6FaA4Ae1uz4xaWQfGZLemJfSQmknrk/Sbv07+xC9L5HMUtuU1Z2IWbs/K5fqB5uzEpTRT0owszM/3m/13/pM963rffzrw+CDbv8oNBhIDE6rYGQNTY0KMcsuARgjTREBw4Ri4lBZ+m7rPl2FVO9Pq/kQ4BaQPIVXUKQENMSs4tYXKPuiQMhXx8Eia0h0D0uidKzaBOkTmQyhqtjMmzY+qs2ugouvY8esZuYoqRL5s6a2WgiyJcNs6bpJoGR5lMsxVTWpVajya1S+gtkEKa6k3pmakUy2aqnjiVBBJddqmzCMI+j4M53RLH3dr+TYQYGiM7BLic4Eo1vSFBQHNUD7gA7zX+eZpX/cgD8G5e0Aiykc7yJof/8qNc77txu/HHXJpxv1HGzQozYRplB3VRUOpE5BFOINWjpk9L0nTn/SMyKfmfY94QSU9P4JHMjMRbGE+VP+vc3EYseEuQRzpwWcUP1S6128evAlRtUZ2GCGlx9iSNLeJR73naPocpt+dCjFKam+tERuTgd3X1CJg1b+jOpjB+y8U3EeTz+F6hvN7e3v0IdXVj1S27Iys96P1br/29/T7f16yuznaZnRLUY52tV20UJIr14XBsyPEEAbe5M2jVjT0bJYkSst1YAV9QsBlIMsO420Vg3RFs0KkLW0T89yeZ+J6n9/Tze3t0P0Xq/QvX0/6U7ps3t0/vEzK2GAWU5xQGFIs71p31HkDDNVsDTRZJmyrDjWPDvT0PZ0eYWm5QFdneDMKSaLz5v82JA7nkUz/+2DE+QATXVdp/YmAKeew7jzzjuXvVgAmb8f43qGvqIdS+f29/+LdD9X4w5E1botnbanUfp//fSmWaLWXxRdb4Fg7oqyjEC5KUFvVVSNicwizxubAxpbaJEgc4fE0K6beiDOD+eQxEdoE7y3kTbh89FHuyUffVviXPW1On5d0/S6GpvEtT0sozsS7ez7f33VobykDRRNpAA7tweNRCwUpRA8TjHZszi8fHMMpd2wWVP8lndHsHk1AfbUT/Hvv5fRu93uk68hvhupsNwFWcpoZIyodR2duivvqW1DGKbJzwUhHSO8lCcm5RC1A69cnygdbFgWDl+KyHFStDWHLqwBAlUNItbj/+1DE5oAMBZt57LxH6WAlr/2GiTQMep4YoZGdlTlAcef7+WxXdBGt8PVDJN5d0jU+Q83vukqDKnO3SaN9tVs3iZlalUwZIEMiSJgFJ02unBmHeFs3iCULufW9bJig6ZlFPe/gKmS+kPtQEosYaOz4j6UDhepvTpbQf29eD9W4Z0jvUyrbXXtqXTjqPukiTPZURy3A72GCaqjPGzFI8E5tsJme5qpARahVmLv2NwroO9ktPvW6hfpUnoC2q4Ys7wHod8ls5vbq2gRV2Jx3fU3V//tQxOeACdTHf+essmFFje89h6i8LkZughomPzcg5KKXwPs693/8Kmt2K0btqo0bB0xEkpBIzcmxus0lWdT0kc/jYXLy3pPwtc97LrhYFTbzQEq1ig7CFXwhtGdG7mbQP+3VtxL0Tl9S8YLyzpCJP6KnsZRQaUUMKeOKyz1EXLc/WSlYq6+hyIolpBwBHU3ZRac/EQ8hsjZQLw39Gat+9BZgVjNTQXwzN4wUDlLWpdnlGAHNTK+XbkegidC9W4IX0V9m6jcEnt0bovL7+qf5W//7QMT1AAmscXfnoVIBU5HvvYWc9NNbaq7FKMIrPqI1L3KxbX+SqgYAJCViAAC/R5CDjKFMyod7VAJ3owRV6tUkYiFq1LMpdwYgF5UNM+DDSvAqXVTQs2o0U1YufUdbiU/X/ne3Kt0/5zccO/2+/+vufspHUwxTZc5BX7k/8hrVFAggckSAAAu8TzVmHJLlQu6Ro9dwE2f1VIAlvWSReDGSvEKzsoep7UMZJdZNPdN+N1Auo3iv//tQxPQACgzHdeesUKFQGS889QpMtqXp9fN09N5m5fXyFupO6M1TEWYpN6loJG307mHqigcARERIIUjOCbmQrBhghVs8Alr8FwKrW8mCl4uciKnnrwUL7rH9a3lJHW+Kr99wwwNYqoNej9RHQB6k6epOrdH6N0p//K+z9D8j5o3ZmePjKHdDWEAMqCGwQUnwpOQw8q5F1T9KtGfIUKixhTdWStnxrTQ/i4Z1A0/UBpPjZuJvAvP5upeYM3X05VbKnN6fGXp7dX/1+3X6mxINlv/7QMT/AAt4tXfsMLBhXSVuvPOKlDSXnp8LBm5prFKy8ASXKlJrkaq9yDqsE40hao+rGAJISmPYaBjasuyzLBdxYBKDOr5JU3fRuj8L5PL5NVZrba/ty+/QaoN0uUQt3W16KHwYBmlXSRJW8AEXpGg6hBRrB0mdOMovLTXRYw8rWsFkt+9wzCt17HdbQVB6rEQYTIvzPzdH8vl9PL4NtX6N0N0CG5+nxttGdvpqShcCOjZ2y7cA//tQxPYACz0ra+w85eFOpW09honkCvyYY3iQkUX0uU57GJb3KEkarUaAhhO03QDsJObmZfCfjZxxJayme5efo/fr9LWmXmIDcRPtkt8Q7bazoRABQCAQUH8uLYAAAADVy4BE4GkD9DAk+0dUxRax4cC0Njc941/ykiERi5N1kFqSAvTfcJhhS4f4hA61y9QEFSWOlMqpOHkkXAt2FiEUrLIp8Hi1LJ+UjMmViBO5x5HTBikJ5qFjG9Z/+frWv4B4Mgh/3mb//3k7V//99weuKf/7QMT8gAp1K2nnrFEhMaWsvYOJ5NMhHICZLKAAVQEg1BqA04KwNjJawIQlCUTicfLlgYCYGgaUDQNYNA0e8Gg5lgaBVygaBnxKCrsSgqpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//swxP0ACWDJa+w8R+ElHiy884qMqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPYACKyNYfT2gCH6F2o3MPAIqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTxg8csL028wYAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",xD="/assets/hushPuppyVanish-CZOUg83F.mp3",bD="data:audio/mpeg;base64,SUQzAwAAAAABJlRZRVIAAAALAAAAMjAxMC0wMy0xMlREUkMAAAALAAAAMjAxMC0wMy0xMlRJVDIAAAATAAAARGlzYXBwZWFyaW5nIGFjdCAxQ09NTQAAABUAAAAAAAAAd3d3LmJsYXp6bmV0LmNvbUNPTU0AAAAVAAAAWFhYAHd3dy5ibGF6em5ldC5jb21UQ09OAAAAFwAAAFNGWCBwcm9kdWN0aW9uIGVsZW1lbnT/+5BkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYaW5nAAAADwAAAAkAAAzXAEpKSkpKSkpKSkpKYWFhYWFhYWFhYWF5eXl5eXl5eXl5eZCQkJCQkJCQkJCQrKysrKysrKysrKzDw8PDw8PDw8PDw9/f39/f39/f39/f9vb29vb29vb29vb//////////////wAAAChMQU1FMy4xMDAEpQAAAAAAAAAANSAkBqtNAAG4AAAM17UwrB8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+9BkAAACtwDY7QQACj7AGq2ggAFNOH9J+aeAATUMKT8w8AEMl2x223XXYDXgACBOHh4eGCMAAADw8PDwwAAAAADw//0AAAAAB4eHh6QAd/h4eHh4YAAAAIDw8PD0gAACPDw8PDwwAAAAADw8PD0gAAAAgPDw8/AAABARKUssltuoAAp4eHgAAYAAYeHh4eACAAARh4eHjwAAAAADDx/+7wAAAw8P/YAAAAABh4eHjwAAAABGHh4fOAARoKg7m7q6w7fVgAAAAAAGVKJXHUQiRk6oIINAoes5bwJAnhHlxWSwCXhBQ4eYKkPgwBYAjh/EQSIvJdVKdKtimtsHgLcGcQpNLbPBbVFBjQTRQliNKZ1AxndK/MbMEYe///////////1mAojQbrDKzs7a0AAAAAAAB7QJFv27F509ww88gEd4/eNh1yFVTUcCJrEChbRFDkUKUUMJucGNVq023rZFZbsyxDy2QG1zkZoQKMR8sHoBBtNuO78AAAElR0jwLGOESSdqKEepFF9W1Oo451rAyxzhrsgmsz7mnMl0D8i1tkwUVjFzNVCPnf5YRjd4hoDKVyPf4AAASJEoONd/pWjpJ8pLpZp6aT8QEHzBGb0DFf7Q4wE4lEe6McUGC0yHgQTrtuh2bXAAIDG6r9xMwDkvQmgw2IUkUjltYRzNqJIYlSM76znywZCgohD3yXY2XqjBQ6wWPg0GDi4lv7SDBckyAxuy7cKELMpl0jVcWNjXdF684oREQm1IzzVBysxBAYZvB9u478ju+v+kb+t1ACZNdUu+4AEOkhKBm7axdX8Gmw9GBeGbK5SSamYgKsmjRLPttZMyFZ1U+4yxCD6yZEILmJqp7F5FT6JIpmAOSq34AAIebpRB0lUf5c5QGQHz8ioSLPpHVp5C5x+qR5CPRbQ//ERuuky8/jnf0BGEJUt78BQVZzncUifJYTRzMg5z8STzEJDzVlETIKRNS7NXeGx8pmLKI3TMjIGVOgRuxpZvU69awVWAkSjf8AASnYk4DvsrXiFkPJbUwQOdD2PF0tSYVTOpCdis1f6a3ZZ3ETuzFpyvI4lyRjKk0AFGNLv/AAFRFhLJmSoUNFAcIIlhArCocHTs//tgZOkBEewa0+88wAo3Q2p954wBRxBdU6exBWC4h6p09IzdOAPemIppHGks/UH26Xud1aZ9w0aovRKm0/lgzsFRytntsc/wPEARgAFl34AABUD1nUwG7orCEBICgIUGiChKs4wUS4Yxe2/f1gfV/CdaHlge/oz+92AZLa++U3B6DMDOM2CK6ZZzoo/IB/yqVffKmEiTsqSaKKXyM8GLEJEsKMMNOuAw8JRc/LmzyIYM72zERskwE4Sy09vyBSxKzA2w1En4fDTARJQlmi4Ioje5PJR3P3KlQSClMFAQoXnuhs/DOU5ELNIVIc5rvAAAgLu3AATAOolOC/CEl72SNCijGyYA//tgZOuBAd4XVWsMMbgwwnqdPMI9Rxh1VaeYbKDakuo1hIkcIFLhOTmJNFrC9faW29ON3mIP7ZQlkP5uXkU6wQ4o5miMQZp9fQyLSeRk62+lEmgdpgFEVZfgACLCcOcZ6V0+eU0o0guqtj2s0lNaTapUPbHIDcnKk1//e/0uftMYOS4Fn47N2AJQSijL/8ADfA0TkLINJaN8Xc4xkSjXBIlabPkTR5sksFELBPcisaGNdznE18177gRISF6tY7Zxn0pE1fv6te1oH/sMWtwsqb+gABtmKfhJZ1MHyWhRmoXE0w7QGC4IohhpEBl0UXuXY413LLQe6F0Qe7IKlVRvBtchTL+V//tgZO4BEfod1NMMQTowIVqNPSMzR6RfVUw8waDeEiq1hIzlYVIRRae++AAdZFieIeStBCTCu7NA90eEq09CBLmkkaKTjUTY3Xms3lu9/WztuTjBsz+3kPQKO/DQyA+o9bvmZ+mdh/2A+EWZxoubf4AA4C3eITqgthPRnJExAmEb4jgEPC1Q4bSnmEd6lJBw7Kkd5ioUITYeX7Jg1sgEQ5MzsGUE0GTCr/9wAp4VAXcXmsPDIPGtNt32gFzmTShwXkSokUmjaS1NdHH/772KE3LG8aqBYfWIyd4xRD9zuUIRrg5YH0Mb26XktEB5v7d/6AdzkDit34ABsdkgl2JwKUSkUpeS//twZOyAAjwuVNMMGnozJFqqPCODSGxRWaekaqjljys09g1NaWLaY7EfyhhU3aeWJfyt97VaQ6GO4KTZZJSm3OycuQgFEHJ1vSogyRS5t+AEKHoLwLeU6eHUa4blkSQXLANPQia6oxNbKoUtHItxEF57mT0/+f8OlD6acz3HR4hOmV/db5jOOTn/scnAK6SCCk3/ACoJEoQcx3YKI42Ukj5DUahEYwFIsauzFsNku/6+kY8zUFx2w6AFi944gDSQGWNoaOMAPTYRf1HALAKClvwAgkhctZTpqkPhKIghFcSARBseLlpnY8/1hy/WYIHlnmZsZGluCM3ROlwWhS5/5KR+WEEhND33hzbc9lIgkgAMUCU3fbxCpX1wTFQYhiTQJh0IIiXLaf1jqT2jVXGo7U9GZz10tOEfCP/7YGT7AAIvGtdp7DKKOeQK7T2DRUmgm2GsJG1o5pHr9PCOlMChiAIimDe8XfTYbSSCzxp3Ypz2UCdJGiCKUAAZPPgAYAgQryPVAywACUqiL4W5DkdvCec14MFi+HSFZWe5jILCuYxjFazTKWUrvsaispjP0KUpHlURBIGh6Ni3LO4rJAINwgAKeegBLCbCPClLon4DqOldGiwHVDTp+KJtagg4nJjCjBS1JtmhrD9UJua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",wD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",qD="data:audio/mpeg;base64,SUQzAwAAAAACQFRQRTEAAAAOAAAAU21hcnRTb3VuZCBGWFRDT04AAAAHAAAASW1wYWN0Q09NTQAAAFcAAAAAAAAASW1wYWN0IG9uIGEgbWV0YWwgb2JqZWN0LCBjbGFuZ2luZyBzb3VuZC4gSGl0LCBJbXBhY3QsIENsYW5nLCBSYXR0bGUsIFJpbmcsIE1ldGFsLkNPTU0AAABXAAAAWFhYAEltcGFjdCBvbiBhIG1ldGFsIG9iamVjdCwgY2xhbmdpbmcgc291bmQuIEhpdCwgSW1wYWN0LCBDbGFuZywgUmF0dGxlLCBSaW5nLCBNZXRhbC5USVQyAAAAIQAAAElNUEFDVCBNRVRBTCBDbGFuZyBNZWRpdW0gMDMud2F2VFlFUgAAAAsAAAAyMDE5LTA2LTEzVERSQwAAAAsAAAAyMDE5LTA2LTEz//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAALAAALmQBJSUlJSUlJSUloaGhoaGhoaGh6enp6enp6enqNjY2NjY2NjY2fn5+fn5+fn5+xsbGxsbGxsbHDw8PDw8PDw8PT09PT09PT09Pl5eXl5eXl5eX19fX19fX19fX///////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJARIQQABuAAAC5m46ML8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB3gBcfQAACNdsy4/NPAAl3qJ2XMAAC5OFAgGFg4cLvKVlz8HwfeUB9QIHCgIAgGIIAgCDso7+Jw/8oGP6wfB8P/+fUclwfB8H/B+ZaZhnZ1QlUiApNnQ2Dw/ssBgMUS/OXDzBIYWCSMzRsxIovmBgqNiagGjBYWEBEzx/goyZdThDkwYJPk8hAWCGkxMpmP4BjK2KpwLQ9cFcqhCLEHYY20YVFrd0bJ0KFFGS0502YTUVvfKatEy5rW4NECdEKaZrXZ4bisksivixZZWF24f/UaLiBRgmW4fhMEGTLOrJZ8Xis7yDnWV1BgX7x5RngUYPGeUS0VzbMQ9SvI00kBthYzvXtX4zrxXBAN7HHxSLSBqlJbbf7iQM4h23qLA////9IqqlmW1dnVYCUkZmwP1KhxCSn+4ksNY9lhKlsa4LYlHMaIh4WDCoLTcwYPuGHxyTXRx1KQw9imHe0Q1rFXzBOURdSQIVyOpLHUYP4mxZ0YgfE7VbuMtqPfMEoxtmafQfWqra9Lt916Hr2k+trS98vExN21LdznsscrwPtumUtJ2zvdQ6MyTRAe0QEZW7Nye5yY401/mTv06Tc5dnjKpOtRAIV0E9S/85zK0YGqO2xsafTMy8tWKmc+G3PRezL36p1/qvmuV1TIyzv32WYCC4dIkVgyoWHITzw3pdZV3Z5mFVjZbISnjk1J+hIZGa4UBG6QlgNl5NbQvW0zrFub02qHmz/+VJ9wt+MSFCp5MCJNdDpELPxTTvtXUPrAo20gVmWiw/zqP/0fX/oqGWGhWUSiiQjmgfCkMlDy2FewHwttKMGyi4ZRImur10U2ZN6mehHCx9wIsOUUVcGwEHlB1R448XMNPuUdZHiY1zHGnxOkmFQUgGdMAr3//0F/Tv+ru77bNEEghzjUAgaR9BlIliQHghLyiTokNMXj84BMDKOpyBL9CnxDSqNLU7PS/sqNVt0V9xHD/+3DE2QAPrXV5/PQAAXAkb/2BifgKGiN0B1WPt3YZCJ1C1g6Fk3qraXWl7f4Rjnr9Tw0vUw6EgmDLupxvkAIAICojjUqF4jGA5lRglrF/vawwSwMfHCfSTmd4YOhi+GTnzLJPL525eU//ar/nCyPPlOmhw9NN78PNXaF5rhUsrcK4c+4pDesrX0//69f/vrCAUAAvBLYOxiRaHgKJrYiiC8TzMc4TNVW8n8ElLmcvasOAyFsUFYafMlr3KZVLenGOeZ3vcgrWElJPPJfiIUoON5JPQyr/9LP93VCM7s6qgEFJF3wh5hyOIsEYRQdBqdjt7ZLM9L+Q0BozlPNULoYuEQ2art2/xC/vMu5blVT2bvfo4bKLGE0Lvf4Bc4Ue5RUCx9EK5JC3G2bPT3+l0v2/sQARJT4LiOAg//tAxP4ACbCBe+ewY8FSDC789I1YqCWQACDyMCgRLkQzEo7fI6txjQO1wfAbH9XLQw7Duad79D0nmKj9itp70qzmWyHs6q/XWJ61NvJOcxjxlyEKubdN/q/uuQrPTNEMiANNKUGIExOH9AQR1AwIGDktJktNL1a1uWqFq8tPUPX8mZar8xTbY9dabezppbC7qbmKIlCYa3NSyZIUu6cov/4TthD5aqpdhcimNDR1eIeJUhILTdr/+0DE/YAKTJ9zpgxPQWqkLrz2DDgN4pB1MJOjAOqIijGLjCVLtHJA5NHuSKncLrGx87CKeWMUymQHpQkoN1M0it6HW16EaC9WU59DnXM9nkr+VnzZBb31SRjiWUmC0u8qswoiDYi5sMhiIYYZ0Jg/5jmykmZPQlyhbMGeNmjwTmzBnxCnXGMSTTpXdGXewchcHkkFCdih4gOxa0/1yR2eaho7c+yIl2WZciATkmARhCqgzy6nUv/7QMT3gAnMrXOnsGVhSZXuvPYMNBy7OuAhO3sijMsLhPD2R2i72/bKbGOZWugJk0RmfbRHz3Ei3K11K11bLoeRKtefSb/m6LKNyYou+uSKWokEkmgDkUBQEhIHFsbjsOpOyNiYmOtV2hAsJqxaeKwSjdIxf31SXEMAhrOWh5WlIqsnaxu3VV8N3N9uy9f/6Kg5b0kjrUAViXhniWMglLdwAvVAPHcGhKOBNC6ACsJu6TEM/UQW//tAxPeACkzXcaYMUOFGJG58wItkxMQCpKaRU4R9EsLIm5ulAeQmEhK4Bx40ILVCY0Xa05WJdzVkTzxdArVtKvEQxw7AABil4AtjafKpVCFWJWXCMivtWJ0gkIDHthgt3tezV4lUgaKkPkzvz6g7GZ0yL/Dcj9X9bcGNJCjBR08IlN1sDTFuE2xJZ7WD1XapQ2kxIB2bYAT5jO1JEuZyVnSdLEifjCFWjMLY1AXd6yoXiBJ0tc//+0DE9gBKTRNx55hNIRqR7jjxicx4p5/8hJumdLTUsjCchlDpUKfwLaBs6tf0dByzqaOogArLwAYbQUpeixNzITAhOi3UppYdtstEGriUYpioeztQLHOVZi55yo5jN+qGOdW1EfTHdN85Bx3dH/+Zj3bSTEFNRTMuMTAwqqqqqpxgGAgGAOMBQGAAAAAAG0E6MWwG0AmfBbSD5iJb4HqYnvx3DtJU4kqrxhRxF8vL/84YqcyNv//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",vD="/assets/metalicScraping-BqmM5ys4.mp3",VD="/assets/mojo-D9S1pz9n.mp3",_D="/assets/robotBeepingLoop-Cz0TGwJH.mp3",SD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAFAAAHBgCHh4eHh4eHh4eHh4eHh4eHh4eHpKSkpKSkpKSkpKSkpKSkpKSkpKTBwcHBwcHBwcHBwcHBwcHBwcHBwdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ//////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAM2QQABuAAABwbVZvomAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAACbQNZ7QwACnxFem3NvABAAAb/0m/2/DnECCBGAgAAHfHfAVjn/mAGf+YeHv9AI/9/mHh4AAAAABh4eHj3Sf6MPH////7zDw8PAAAAAAMPDw8PAAAAAFY4ef4AAAAAACAJLlcmslzaAAAAA2dhA8cuNgUzOZEQCemOB48SmLBSXoBIB4bRWLmodWkIyM3KQbxTk5MgkxYg5TEmKcVImoNot5fXBIMZ6wUILqZqPRipgksX3ycRsY3WhpPFfXD9wjP2WCzWi4Z9M1lU4rrEJyfbg4tf5nlSFyl9BDltdXPvf+ALefotw91Kg4XKLrKnrM7XFKkPlm0r62lQG0SkaIee1fdc3yedKObrKqLVO1Tt+09AQj4eK79+e/bVR/unc8uLTcn34t3eGbDHckkUd3K0+q+QaU3nU3EvM2q0GCgoYcv1QP5+7LldGULYTd9qYJKpfHTDNTWlWkCVxEXsA0NJe8kpbGX1Q1lrpG7f/wAFfElzwgk5nDf0u0JoQI2sRE3BsCSljdGmx70Q5Yg/U20rsJ0NItx4T1FXM2t7V2/dZ76daq/iuwEHOUVVLy7f8AGSoqMcpzEIGFVQPIdxGC1g8eyzUJPB/m+Vs40oU0Ln1rchVwreG7jwtkrzwk2XyO1OjltCtYM8yWuSW38AFFsUh7NgmT2ISQn6LxK5lZATETo/wgKuhIPbwWTCUA+ZF4ZAKFIVcWqQvTeka0Plby4pSVnEKmgzDXm45rtwAUOrrpafToPNcaq3bO4tWy+kVpIIrlC3c+YfE4bc9y8bUa2N0mmqfTltWw+ALkINOReTXarVeRKPhu81QCgSjCUVpZ2R/d7LQIAgAAESQ6DJhyCwQEJtFbpvkLRAB6vDAgDTBYBzU1CDEMllappkMZMWwCMNhdXkshDm11YEBBJYB5BLIsRiSvE0FyqJQbB1edgF+H3iZhEhOTOBh3ebtKNyZ/40/D/Qw//+zDE/gBJ6HVjvYWAKPOObHWGCVwKxYYhmDMqGV0sjpqeHI3F5XTO1EpE6NWHdd33HPcYpoxbkErn9b1lrtX/////+vlSZWM7FcLhJQUAvy5QGCQfCwlYIiJ07/dd0KUFAKVYWZ////50YkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+zDE+wAH+IllqLyhqPyJrL0nrByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+yDE/wAH8EtjrDxjoQyNbHawYASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPQAGFTpVfncAEAAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",kD="/assets/rollingBallLoop-BUA084C_.mp3",CD="/assets/servosLoop-Bn-haKck.mp3",PD="/assets/servosStart-BgsySGJF.mp3",ED="/assets/servosStop-BR1i0gi5.mp3",TD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",RD="data:audio/mp4;base64,AAAAGGZ0eXBNNEEgAAACAGlzb21pc28yAAAACGZyZWUAAAlobWRhdN4CAExhdmM1OC41NC4xMDAAQlWf9//8AAEpcYIhBFqBGRQAAAA97ly4/W7ly4EMAr/I3BeMvTftX4WZhy4eZzkGiJpIQdAJpikETSZbmQrGQ9ASwuBIs5sT79jSHhnziR7YAlgsuQ3EQlPYQxkfA4hCfEJrWQS4mF1aJqNVvDqEn8b7j8dyjvbrC89mU/YHX1WltsXR1mPUZdxh3qNKbGvRyG0E4PywN1Og9Z9qEhMwYGXgaVGju3eGzZG9yAKgsXDXrRipQopEpC14TqqRFcx5dEfVOcou6R6Cjpwnnqii/bz0oKLILvDqfOAAAAHvcuXJAAAfMgeYTNdaHZPHGH9DwRZWxw+f9PuAAAAAAA4hTGycB+B+B+BKXBW62TGArVJOBNtuCQDx1ersONau7/PfHkvrjrJ/r4+pOvb4Gw1XKTHhalzUhLJ4X1DFmVFX4jvrfVYDTunTfnyIMPRdJ3IWBG/D/0e5fR6L6c7zIh/L4ax/LWHw1gNYAs0k7c/O3XREBLXu5AlTNVny9RUDwrvQVUiNCrn1UxG+TaG1NLKDAwNellBmc3RSgwMDGwYGBgYGBgYGBgYGBtDAwMDAwMDSygwMDA17PVU9HO7euUdYVFduSw1C68jtMj5X20/nXy++7Xup3U10101t8vlPOqZUpaGbiNkZ+tIhX62T/APHV3qw40BnfHkgOfH1J1lMgNWUSZMfYuXAdbuZt2Lf8nI/QMYxAAGUTHsEc7kftclvf1XtsqR2ErdUACl804UU0XxFEOAhesvPq74AAIikWZkoYiil6a2ADW9cRckqJcgulzLCazMmzY05StZ3E4mNcJuVfViQSkktJQ5JKhZJYTPktP34nouaEcniyNeaRiOIoHrVUiVPT1T09RbwR8MMMMJBOlmZmYCd3fBxNsccWQHevDB3EGpxxmZABf+KCqCv+UFLBQUFUFBRQ5Ch2KTgqXIi6GsCoaQUFWYGjT/GS1uz30Fk+DHHv7g/x8Cz30A/x4hPvCD15gn39w8PJbL1MPhMGAxYTdIcgOIyE+NTzWV5RlKC9OP2MFoMPYyXhEwEiWo1/F4a2AA1xmrkklISkpTLGDhZ/f3hnm2bZirU1NS0eUblrVeQ86S63GJRgEig/jevESh+02SkPFioYs1HjYZv+VwjCdK5r/yulRKE+ijEA1BsX4AhGsp7u/wBAHNkWRiohzEcSqmQrfPb46tUAfPd8W1SUpSqACjksHNJo1aOHH0ueIMeMbBKRsyXQ/hkS/BP1Ul2bAS+1kd6unVn9Pxxqm4RwoGhbeaGkL1p+u0wpsqgfK6XmCHpKVfrWFE6stGD8ACe+2NeFbDnOkvoN+06RrYHV6KtPYvd5866OOxvl6DKvPa9/aDywOVzQXP+GWTxjnwIwRf90/lhRSTQZhElIAVKHFxdHgvp+4OpypkSIeICyhtJhnbKj3Ox0RgrKAqFgB4pNjgqIc3jIPocUhT124+rAD1yvUVLq6maqhyFaiEqMsmIozFMleoGCjoU01vkQcGI1/tSQ9c/SIhj9DtA0aqZaJuaUmCTZUYExQwTgwM93e1JCbPbufUzRc25vAPsi8xmy0mCjRiZ+KAQmvW96w6m23Y39scOG7rYbtitSTh7Dq9iuNhDp6yzsB06Ur6vRMfUzbDwSJQnHyI+I/6OIRrP/7/8AAByoKHsqMc5IEbcQJ/Z/OgAeubuXahSlB00iI+4ZrzXmrGNgQvs4TGYnM5yS9t8cu7Pe9LKcLiWVbbiwzXkFLp6mNKygBXjsZNoYoNBy7MmJEd0UHfHMCkycmUFR+bp48WW7mjHrDV2q8U6dJejtOPidbtX6+KdTnM/RTd+LmjfyMCPaup7GcVTwKpSaltVRnhmwzyvev3h6snhPRQT3QtjK2P5rWNHS7LDy/aU+cnZMr5ngSszmKB6D1iHSximUpCkf9HhKexMdI8VZ5iS8G+2QREub2PEQJ/Z8fQAPHc4apE3eWmxvp/CjLjx08qn3hWVZq2b/fo/pFWeZYkzJzYh+OZcqdW4SIvLr4l8jQ9+t44tdevmvxRdC9E2z9zNkgEU+eX2mqiR6GjcGitv40gegfxuFPfWmCDuvfs+uOxm+nJHWy1uHLLmONgv4uZ4Omy0uaGr2mNV1dxfF0mbqdNOfqohn30Csk8hGsiX+AUAAHK2Q1DCx+klRm+S/jTcSVK19pUk1V71UmOOWmGSP/zDYJJDwTea2igh3mDJEQhlH6P2r/HmH6vVvweO+mMeBrWTXfciC+aEIDsVzWrVDw1EJloRLufgxEasr7He8vP2Hgb/d0u4i8OvuLSXjpbQnLj5GJZ46W0Jq36ESXPQqA1ZdCJTnwMLbPQITLgYhniYDTLkTD9QfxDWUDBtBy8YBhRXf8pV0S1ylCXAJzHSABkQArMdioHLW38MYt5QCYotM0qcAFZMzQjAWlFSZnmT/LTCCZZVJ1IC84zlLGopYD9cWV4lD69D4WlVV+JyX8aRJpjPWHVcZQFPWDsPeGPB8+kxj6q+T1HkMVThrQGPB99EClzEQAPfedEfuLTQTiRSR8WQT8JyPaPg0Tx+xu5xBaPHP4fh+Ga059x+HL33DgH2PrfdHYFe8Xuq221GDg+fx5+NeVHZLllfKN0XhEDfLeiKQEYAUXgE8LndAKMRerzoo3ReoIajEKpT+tUoMYArABO01XBfripv4ZchGsgP8F5QAHOE2MxM5B6ERaEQ6ERaEQ6J3KbzkF+c0l6yx4rzvT83qJyzV4LrGGzA0XUvXU6jNwVKGVHm2Qfu37sjKwpHJYwjXZbDaQ/ggyO9/hGFXXo7sL/CMFxmrkpxjAcaK3Zic8UrkZq8BZHNkrkNocWSvBWJxZidmLAaUrkp83ha4A7njjM2MxPg74YOAAbMNif8EVJHVhQV/NBXzrRVlV6o1TsijyAA8QS8QBEAeYDLgeqRZIMiGIYvEIfCIfEIfDoRC5VVAL8+YAN6qUajOWHhQwuNmTyedWWZdIvr1YoPFM8RjT4Ll4iKKQkhJaXmBLrXUSXHcvj9PZtzfeucVDbDovcK2k2tztZm6fua1oqGa5Q/tX3qiBYgW1baCUZaIKKDSSUk1WCsApLEuxo0Kw1r/xT6/NoIQr8n89ryBT5sWAGSvDCvHHHHHHHHHHr82OOGGGEjiFfd2vXhhh/evvr+9dK5onw4W9whjeFjfwhjAD+EAJfwhwAABB9tb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAAnQABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACQXRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAnQAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAIUAAAQAAAEAAAAAAbltZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAa+FXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAFkbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEoc3RibAAAAGpzdHNkAAAAAAAAAAEAAABabXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAA2ZXNkcwAAAAADgICAJQABAASAgIAXQBUAAAAAAfQAAAHfEQWAgIAFEhBW5QAGgICAAQIAAAAgc3R0cwAAAAAAAAACAAAABgAABAAAAAABAAAC+AAAABxzdHNjAAAAAAAAAAEAAAABAAAABwAAAAEAAAAwc3RzegAAAAAAAAAAAAAABwAAAQ8AAAE1AAABMgAAAWwAAAFwAAABkgAAAXwAAAAUc3RjbwAAAAAAAAABAAAAKAAAABpzZ3BkAQAAAHJvbGwAAAACAAAAAf//AAAAHHNiZ3AAAAAAcm9sbAAAAAEAAAAHAAAAAQAAAWp1ZHRhAAABYm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAABNWlsc3QAAAArqW5hbQAAACNkYXRhAAAAAQAAAABNTUJlZXBfQlcuMjE2Mzcud2F2AAAAJKlBUlQAAAAcZGF0YQAAAAEAAAAAQmxhc3R3YXZlIEZYAAAAIqlkYXkAAAAaZGF0YQAAAAEAAAAAMjAxNS0wNS0zMQAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1OC4yOS4xMDAAAAAcqWNtdAAAABRkYXRhAAAAAQAAAABCZWVwAAAAHalnZW4AAAAVZGF0YQAAAAEAAAAAQmVlcHMAAABeY3BydAAAAFZkYXRhAAAAAQAAAAAyMDE1IFBybyBTb3VuZCBFZmZlY3RzIChCbGFzdGRyaXZlIDMuMCkgaHR0cDovL3d3dy5wcm9zb3VuZGVmZmVjdHMuY29t",MD="/assets/jetpack-loop-1-XbLJ84YF.m4a",ID="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",jD="/assets/spring-CP3uOhml.mp3",OD="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",BD="/assets/teleportIn-DZAhHW9-.mp3",ND="/assets/teleportOut-Bra-ABlh.mp3",zD="/assets/teleportWarningSiren-Boo1HoAB.mp3",LD="/assets/toasterPopUp-CNfTxQPs.mp3",DD=new window.AudioContext;let $a;const le=async t=>await DD.decodeAudioData(await(await fetch(t)).arrayBuffer()),FD=Xi(async()=>({bonus:await le(nD),bubbleRobotLoop:await le(sD),carry:await le(ID),conveyorEnd:await le(aD),conveyorLoop:await le(iD),conveyorStart:await le(oD),destroy:await le(lD),detect:await le(cD),drum:await le(rD),glassClink:await le(uD),headFall:await le(hD),headJump:await le(dD),headWalk:await le(fD),heelsFall:await le(pD),heelsJump:await le(mD),heelsWalk:await le(gD),helicopter:await le(AD),hooter:await le(yD),hushPuppyVanish:await le(xD),jetpackLoop:await le(MD),jetpackTurnaround:await le(bD),landing:await le(wD),metalHit:await le(qD),mojoLoop:await le(VD),mojoTurn:await le(RD),robotBeepingLoop:await le(_D),robotWhirLoop:await le(SD),rollingBallLoop:await le(kD),servoLoop:await le(CD),servoStart:await le(PD),servoStop:await le(ED),softBump:await le(TD),springBoing:await le(jD),stepStoolScraping:await le(vD),switchClick:await le(OD),toasterPopUpSoundUrl:await le(LD),teleportIn:await le(BD),teleportOut:await le(ND),teleportWarningSiren:await le(zD)})),UD=async()=>{$a===void 0&&($a=await FD())},FU=()=>{if($a===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return $a},HD=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],$D=(t,e,r)=>{const n=Nh({saveTime:Date.now(),gameState:Ri(t,...HD),store:{gameMenus:{gameInPlay:e.gameMenus.gameInPlay}}});if(r!==void 0){const s=n.gameState,i=s.characterRooms[s.currentCharacterName];if(!i)throw new Error("how are we saving from a pickup if there is no current room?");Mn({room:i,item:i.items[r]})}return n},GD=()=>{const t=qd(),e=_x();C.useEffect(()=>{if(e===void 0)return;const r=()=>{wd()||(t(wP($D(e.gameState,we.getState()))),DI.flush())},n=()=>{document.visibilityState==="hidden"&&(t(zb("hold")),r())};return document.addEventListener("visibilitychange",n),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",n),window.removeEventListener("beforeunload",r)}},[t,e])},WD=()=>{const t=ue(r=>r.gameMenus.assigningInput!==void 0),e=ue(r=>r.gameMenus.openMenus.length>0);bt({action:"menu_openOrExit",handler:C.useCallback(()=>{wd()&&window.close(),we.dispatch(lg())},[]),disabled:t}),bt({action:"menu_exit",handler:$(lg),disabled:!e}),bt({action:"toggleShowFps",handler:$(hr,"userSettings.showFps"),disabled:e}),bt({action:"hold",handler:$(zb,"toggle"),disabled:t}),bt({action:"map",handler:$(yP),disabled:t}),C.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),bt({action:"toggleColourisation",handler:$(hr,"userSettings.displaySettings.uncolourised"),disabled:t}),bt({action:"cycleResolution",handler:$(Dd,void 0),disabled:t})},Ly=(t,e)=>{we.dispatch(Tb(jd(nl(we.getState()),e)))},YD=(t,e)=>{const r=qd();C.useLayoutEffect(()=>{Ly()},[]),C.useLayoutEffect(()=>{const n=()=>Ly(t,e);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r,e,t])},QD=()=>(YD(),WD(),GD(),null);class KD extends C.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("Error caught in DispatchingErrorBoundary:",e),we.dispatch(Nd(wi(e)))}render(){return this.props.children}}const XD=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=ue(UC);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},Dy=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,JD=()=>{const t=YC(),e=ue(FC);C.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",Pt())},[]),C.useEffect(()=>{document.body.classList.remove(...Object.keys(Is).map(Dy)),document.body.classList.add(Dy(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},ZD=C.lazy(SP),Fy=Xi(()=>Promise.all([tD(),hI(),UD()])),eF=()=>{const[t,e]=C.useState(),r=ws(),n=ue(i=>i.gameMenus.gameInPlay.campaignLocator),s=sf();return C.useEffect(()=>{if(!r){e(void 0),Fy();return}let i=!1,o;return(async()=>{let l=!1;try{if(n===void 0)throw new Error("game is marked as running, but we have no campaign locator, no way to know which campaign to load");l=!0,we.dispatch(AI());const[{default:c}]=await Fy();we.dispatch(_A()),i||(o=await c(n,s),e(o))}catch(c){l&&we.dispatch(_A()),console.error(c),we.dispatch(Nd(wi(new Error("error in loading game assets or state",{cause:c}))))}})(),()=>{o?.stop(),i=!0}},[r,s,n]),t},tF=()=>{const[t,e]=C.useState(null),r=$C(),n=eF(),s=ue(DC),i=XD();return JD(),C.useEffect(()=>{t===null||n===void 0||(n.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[n,t]),C.useEffect(()=>{n?.resizeTo(s)},[s,n]),p.jsxs(p.Fragment,{children:[p.jsx("div",{tabIndex:0,className:"fixed top-0",style:i,ref:e}),p.jsxs(L0,{gameApi:n,children:[p.jsxs(KD,{children:[p.jsx(_P,{}),p.jsx(QD,{}),p.jsx(eD,{})]}),n&&r&&p.jsx(C.Suspense,{fallback:null,children:p.jsx(ZD,{})})]})]})},Fh=4,oa=20,rF=({textureId:t,spritesheetSize:e})=>{const{frame:r}=Lt.frames[t];return p.jsx("div",{className:"absolute border hover:bg-white",style:{left:`${r.x/e.x*100}%`,top:`${r.y/e.y*100}%`,width:`${r.w/e.x*100}%`,height:`${r.h/e.y*100}%`}})},nF=()=>{const[t,e]=C.useState(null),[r,n]=C.useState(null),s=C.useRef(null),i=C.useRef(null);C.useEffect(()=>{const c=()=>{s.current&&n({x:s.current.naturalWidth,y:s.current.naturalHeight})},u=s.current;if(u)if(u.complete)c();else return u.addEventListener("load",c),()=>u.removeEventListener("load",c)},[]);const o=c=>{if(!s.current||!r)return;const u=s.current.getBoundingClientRect(),h=r.x/u.width,d=r.y/u.height,f=Math.floor((c.clientX-u.left)*h),m=Math.floor((c.clientY-u.top)*d);f>=0&&f<r.x&&m>=0&&m<r.y&&e({x:f,y:m})},a=()=>{e(null)},l=Object.keys(Lt.frames).sort();return p.jsxs("div",{ref:i,className:"relative w-full",onMouseMove:o,onMouseLeave:a,children:[p.jsx("img",{ref:s,src:oq,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),r&&l.map(c=>p.jsx(rF,{textureId:c,spritesheetSize:r},c)),t&&r&&s.current&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"absolute pointer-events-none border bg-pink outline-2",style:{left:`${t.x/r.x*100}%`,top:`${t.y/r.y*100}%`,width:`${1/r.x*100}%`,height:`${1/r.y*100}%`}}),p.jsxs("div",{className:"absolute pointer-events-none bg-black text-white px-1 text-xs font-mono",style:{left:`${t.x/r.x*100}%`,top:`calc(${t.y/r.y*100}% + 40px)`,transform:"translate(8px, -100%)"},children:[t.x,",",t.y]})]})]})},sF=()=>{const t=Object.keys(Lt.frames).sort();return p.jsxs(p.Fragment,{children:[p.jsx(nF,{}),p.jsx("title",{children:"Sprites"}),p.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:t.map(e=>{const{frame:r}=Lt.frames[e],n=r;return p.jsxs("div",{className:"bg-shadow m-[8px] p-[16px] text-center flex flex-col",children:[p.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border-1 mb-1 box-content mx-auto w-min",style:{"--x":`${Lt.frames[e].frame.x}px`,"--y":`${Lt.frames[e].frame.y}px`,"--h":`${Lt.frames[e].frame.h}px`,"--w":`${Lt.frames[e].frame.w}px`},children:n.pivot?p.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${oa}px`,height:`${oa}px`,left:`${n.pivot.x*Fh-oa/2}px`,top:`${n.pivot.y*Fh-oa/2}px`}}):null}),p.jsx("div",{className:"flex-grow"}),p.jsx("div",{className:"text-moss",children:e}),p.jsxs("div",{className:"text-lightGrey",children:[r.w," x ",r.h]}),p.jsx("div",{className:"text-midRed",children:n.pivot?p.jsxs(p.Fragment,{children:["pivot: (",n.pivot.x,", ",n.pivot.y,")"]}):"no pivot"}),p.jsxs("div",{className:"text-midGrey",children:["@(",r.x,", ",r.y,")"]})]},e)})})]})},iF=()=>p.jsx(fs,{scaleFactor:Fh,children:p.jsx(sF,{})}),oF=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"loading-border"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:ys.map(t=>p.jsx("span",{className:`sprite ${Ss({action:"walking",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(H,{className:"sprites-double-height",children:"404 Not found"}),p.jsx(H,{className:`${qe} p-1 pt-2 text-metallicBlue`,children:"whatever you’re looking for, it ain’t here"})]}),p.jsx("div",{className:"flex flex-col",children:ys.toReversed().map(t=>p.jsx("span",{className:`sprite ${Ss({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),aF=()=>p.jsxs(Ne,{children:[p.jsx(Fe,{className:"loading-border"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:ys.map(t=>p.jsx("span",{className:`sprite ${Ss({action:"idle",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(H,{className:"sprites-double-height mb-1",children:"This is not the editor"}),p.jsxs(xt,{className:`${qe} p-1 pt-2 text-metallicBlue`,children:[p.jsx("p",{children:"If you’re seeing this, you’re trying to access the level editor, but the web manifest is getting in the way and redirected you to the game’s client-side routing."}),p.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",p.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),p.jsx("div",{className:"flex flex-col",children:ys.toReversed().map(t=>p.jsx("span",{className:`sprite ${Ss({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),Rv=Ur(),Uy=Rv.get("campaignName");Uy!==null&&we.dispatch(Oi({campaignLocator:{userId:Rv.get("campaignAuthorUserId")||"editorUser",campaignName:Uy,version:-1},noShowCrowns:!0}));const lF=()=>{const t=Od();return C.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),p.jsxs(VV,{children:[p.jsx(po,{path:"/",children:p.jsx(fs,{children:p.jsx(aj,{children:p.jsx(tF,{})})})}),p.jsx(po,{path:"/sprites",children:p.jsx(iF,{})}),p.jsx(po,{path:"/editor",children:p.jsx(fs,{children:p.jsx(aF,{})})}),p.jsx(po,{children:p.jsx(fs,{children:p.jsx(oF,{})})})]})},cF=()=>p.jsx(Xv,{store:we,children:p.jsx(lF,{})}),UU=Object.freeze(Object.defineProperty({__proto__:null,App:cF},Symbol.toStringTag,{value:"Module"}));export{BT as $,pR as A,kt as B,co as C,Qe as D,te as E,Er as F,gn as G,nw as H,sr as I,jE as J,kg as K,oT as L,ge as M,De as N,Le as O,gt as P,Pg as Q,mh as R,Bi as S,Ct as T,Ia as U,zE as V,Nc as W,Tg as X,NE as Y,ut as Z,ow as _,Ar as a,EF as a$,rR as a0,sR as a1,cR as a2,hR as a3,dR as a4,ll as a5,UB as a6,Ij as a7,Oj as a8,LB as a9,vn as aA,UF as aB,hU as aC,S2 as aD,ms as aE,jh as aF,Y2 as aG,$z as aH,jr as aI,Dz as aJ,ce as aK,NU as aL,en as aM,$t as aN,U_ as aO,Y_ as aP,zt as aQ,Me as aR,Li as aS,pA as aT,we as aU,En as aV,CU as aW,qF as aX,Wx as aY,Qx as aZ,vS as a_,bI as aa,iV as ab,$O as ac,WO as ad,YO as ae,KO as af,XO as ag,ZO as ah,JO as ai,QO as aj,BO as ak,ye as al,H as am,fs as an,qd as ao,IF as ap,NF as aq,FF as ar,Ts as as,kx as at,uP as au,fP as av,Ee as aw,ks as ax,C2 as ay,jF as az,TT as b,AU as b$,EU as b0,BU as b1,yF as b2,qf as b3,MF as b4,$i as b5,ae as b6,u_ as b7,Rt as b8,dF as b9,SU as bA,kU as bB,no as bC,Rr as bD,VU as bE,vU as bF,yU as bG,eU as bH,T2 as bI,Sf as bJ,H2 as bK,Fz as bL,F2 as bM,By as bN,_a as bO,rr as bP,hr as bQ,Tx as bR,dP as bS,$D as bT,LF as bU,DF as bV,dz as bW,dU as bX,Oh as bY,Ha as bZ,lt as b_,Mx as ba,be as bb,A_ as bc,p_ as bd,m_ as be,xF as bf,fd as bg,wn as bh,In as bi,yz as bj,pd as bk,Lh as bl,Ti as bm,ys as bn,c_ as bo,ee as bp,BF as bq,U2 as br,gv as bs,aU as bt,tU as bu,hz as bv,lv as bw,gz as bx,xy as by,wF as bz,Ni as c,zU as c$,pt as c0,av as c1,R2 as c2,ZF as c3,gl as c4,Cv as c5,Mn as c6,Pf as c7,Rh as c8,jU as c9,Nt as cA,uU as cB,W as cC,Kx as cD,vF as cE,HC as cF,cq as cG,GI as cH,KI as cI,Ri as cJ,XN as cK,fU as cL,WC as cM,DD as cN,FU as cO,vd as cP,LU as cQ,bz as cR,wS as cS,td as cT,Es as cU,xd as cV,zh as cW,GF as cX,Gx as cY,bF as cZ,iS as c_,dI as ca,Lt as cb,Fu as cc,WF as cd,Lb as ce,ca as cf,Oe as cg,bd as ch,lU as ci,Ge as cj,Ex as ck,cz as cl,pU as cm,iP as cn,We as co,$r as cp,vf as cq,IU as cr,Sn as cs,md as ct,zP as cu,PU as cv,TU as cw,RU as cx,ih as cy,YF as cz,je as d,$F as d$,$x as d0,so as d1,mU as d2,xv as d3,fF as d4,os as d5,Za as d6,yy as d7,Ay as d8,D0 as d9,Ih as dA,mF as dB,gF as dC,AF as dD,MU as dE,_f as dF,Az as dG,wU as dH,qU as dI,_U as dJ,oU as dK,rU as dL,nU as dM,uz as dN,cU as dO,iU as dP,sU as dQ,OU as dR,v2 as dS,Nd as dT,wi as dU,HF as dV,RF as dW,OF as dX,Bd as dY,xU as dZ,bU as d_,VF as da,gU as db,Ou as dc,s2 as dd,Mz as de,f_ as df,_r as dg,Qy as dh,Cf as di,Vf as dj,XC as dk,QC as dl,Hr as dm,g_ as dn,Pt as dp,pF as dq,cs as dr,Rx as ds,AP as dt,zd as du,Uz as dv,Dh as dw,Hz as dx,Bb as dy,$2 as dz,Et as e,DU as e0,zF as e1,bP as e2,nE as e3,cM as e4,Fw as e5,Ug as e6,Dg as e7,yA as e8,mM as e9,iE as ea,Ma as eb,wh as ec,gA as ed,$w as ee,UU as ef,Fg as f,CT as g,da as h,Gd as i,gw as j,yr as k,Ew as l,fA as m,tR as n,nR as o,aR as p,uR as q,yE as r,Rw as s,Wd as t,me as u,mt as v,Ce as w,sE as x,il as y,Sw as z};
