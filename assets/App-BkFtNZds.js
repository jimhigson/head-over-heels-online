const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-wZKcmVtX.js","assets/webworkerAll-B7SBID59.js","assets/colorToUniform-3MxHuUz8.js","assets/CanvasTextGenerator-CEIFTU8f.js","assets/CanvasPool-DiTMBv_5.js","assets/index-B6ZbdD-Y.js","assets/index-1Vnbml5S.css","assets/campaign-DnV-Ati-.js","assets/Cheats-CEPH09uH.js","assets/pixiContainerToString-D_OhUIAn.js","assets/spritesheetPalette-BVAZQxSJ.js","assets/gameMain-Ah4XAijo.js","assets/spectrumLut-BNqsVju9.js","assets/LutPage-BU_FXVTI.js"])))=>i.map(i=>d[i]);
import{a as Nn,r as v,R as ed,j as d,g as Qe,_ as sr,i as zn,b as bw,t as at,d as Ey,D as Se,L as Vw,c as Io}from"./index-B6ZbdD-Y.js";var Xl={exports:{}},Jl={};var Bf;function qw(){if(Bf)return Jl;Bf=1;var t=Nn();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return Jl.useSyncExternalStoreWithSelector=function(l,c,u,h,f){var p=n(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=o(function(){function g(w){if(!y){if(y=!0,V=w,w=h(w),f!==void 0&&m.hasValue){var _=m.value;if(f(_,w))return x=_}return x=w}if(_=x,r(V,w))return _;var q=h(w);return f!==void 0&&f(_,q)?(V=w,_):(V=w,x=q)}var y=!1,V,x,b=u===void 0?null:u;return[function(){return g(c())},b===null?void 0:function(){return g(b())}]},[c,u,h,f]);var A=s(l,p[0],p[1]);return i(function(){m.hasValue=!0,m.value=A},[A]),a(A),A},Jl}var Df;function ww(){return Df||(Df=1,Xl.exports=qw()),Xl.exports}var vw=ww();function Ty(t){t()}function _w(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Ty(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var Ff={notify(){},get:()=>[]};function Sw(t,e){let r,s=Ff,n=0,i=!1;function o(A){u();const g=s.subscribe(A);let y=!1;return()=>{y||(y=!0,g(),h())}}function a(){s.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){n++,r||(r=t.subscribe(l),s=_w())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=Ff)}function f(){i||(i=!0,u())}function p(){i&&(i=!1,h())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>s};return m}var kw=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Cw=kw(),Pw=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Ew=Pw(),Tw=()=>Cw||Ew?v.useLayoutEffect:v.useEffect,Mw=Tw();function Lf(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Mi(t,e){if(Lf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(e,r[n])||!Lf(t[r[n]],e[r[n]]))return!1;return!0}var Rw=Symbol.for("react-redux-context"),Iw=typeof globalThis<"u"?globalThis:{};function jw(){if(!v.createContext)return{};const t=Iw[Rw]??=new Map;let e=t.get(v.createContext);return e||(e=v.createContext(null),t.set(v.createContext,e)),e}var Xr=jw();function Ow(t){const{children:e,context:r,serverState:s,store:n}=t,i=v.useMemo(()=>{const l=Sw(n);return{store:n,subscription:l,getServerState:s?()=>s:void 0}},[n,s]),o=v.useMemo(()=>n.getState(),[n]);Mw(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=r||Xr;return v.createElement(a.Provider,{value:i},e)}var Nw=Ow;function td(t=Xr){return function(){return v.useContext(t)}}var My=td();function Ry(t=Xr){const e=t===Xr?My:td(t),r=()=>{const{store:s}=e();return s};return Object.assign(r,{withTypes:()=>r}),r}var rd=Ry();function zw(t=Xr){const e=t===Xr?rd:Ry(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var Iy=zw(),Bw=(t,e)=>t===e;function Dw(t=Xr){const e=t===Xr?My:td(t),r=(s,n={})=>{const{equalityFn:i=Bw}=typeof n=="function"?{equalityFn:n}:n,o=e(),{store:a,subscription:l,getServerState:c}=o;v.useRef(!0);const u=v.useCallback({[s.name](f){return s(f)}}[s.name],[s]),h=vw.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return v.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var jy=Dw(),Fw=Ty;function Lw(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(o.push(r),a+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~s?s:~i?i:n.length)),a+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~s?"?":"")+"\\"+n.substring(i))):a+="/"+n;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var Zl={exports:{}},ec={};var Uf;function Uw(){if(Uf)return ec;Uf=1;var t=Nn();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:e,s=t.useState,n=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,f){var p=f(),m=s({inst:{value:p,getSnapshot:f}}),A=m[0].inst,g=m[1];return i(function(){A.value=p,A.getSnapshot=f,l(A)&&g({inst:A})},[h,p,f]),n(function(){return l(A)&&g({inst:A}),h(function(){l(A)&&g({inst:A})})},[h]),o(p),p}function l(h){var f=h.getSnapshot;h=h.value;try{var p=f();return!r(h,p)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return ec.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,ec}var $f;function $w(){return $f||($f=1,Zl.exports=Uw()),Zl.exports}var Hw=$w();const Gw=ed.useInsertionEffect,Ww=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Yw=Ww?v.useLayoutEffect:v.useEffect,Qw=Gw||Yw,Oy=t=>{const e=v.useRef([t,(...r)=>e[0](...r)]).current;return Qw(()=>{e[0]=t}),e[1]},Kw="popstate",sd="pushState",nd="replaceState",Xw="hashchange",Hf=[Kw,sd,nd,Xw],Jw=t=>{for(const e of Hf)addEventListener(e,t);return()=>{for(const e of Hf)removeEventListener(e,t)}},Ny=(t,e)=>Hw.useSyncExternalStore(Jw,t,e),Gf=()=>location.search,Zw=({ssrSearch:t}={})=>Ny(Gf,t!=null?()=>t:Gf),Wf=()=>location.pathname,ev=({ssrPath:t}={})=>Ny(Wf,t!=null?()=>t:Wf),tv=(t,{replace:e=!1,state:r=null}={})=>history[e?nd:sd](r,"",t),rv=(t={})=>[ev(t),tv],Yf=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Yf]>"u"){for(const t of[sd,nd]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,Yf,{value:!0})}const sv=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",zy=(t="")=>t==="/"?"":t,nv=(t,e)=>t[0]==="~"?t.slice(1):zy(e)+t,iv=(t="",e)=>sv(Qf(zy(t)),Qf(e)),Qf=t=>{try{return decodeURI(t)}catch{return t}},By={hook:rv,searchHook:Zw,parser:Lw,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t,aroundNav:(t,e,r)=>t(e,r)},Dy=v.createContext(By),wl=()=>v.useContext(Dy),Fy={},Ly=v.createContext(Fy),ov=()=>v.useContext(Ly),id=t=>{const[e,r]=t.hook(t);return[iv(t.base,e),Oy((s,n)=>t.aroundNav(r,nv(s,t.base),n))]},Uy=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),o=n.exec(r)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,f)=>[h,l[f]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[a]:[]]:[!1,null]},av=({children:t,...e})=>{const r=wl(),s=e.hook?By:r;let n=s;const[i,o=e.ssrSearch??""]=e.ssrPath?.split("?")??[];i&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs,e.searchHook=e.searchHook??e.hook?.searchHook;let a=v.useRef({}),l=a.current,c=l;for(let u in s){const h=u==="base"?s[u]+(e[u]??""):e[u]??s[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,(h!==s[u]||h!==n[u])&&(n=c)}return v.createElement(Dy.Provider,{value:n,children:t})},Kf=({children:t,component:e},r)=>e?v.createElement(e,{params:r}):typeof t=="function"?t(r):t,lv=t=>{let e=v.useRef(Fy);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},Zn=({path:t,nest:e,match:r,...s})=>{const n=wl(),[i]=id(n),[o,a,l]=r??Uy(n.parser,t,i,e),c=lv({...ov(),...a});if(!o)return null;const u=l?v.createElement(av,{base:l},Kf(s,c)):Kf(s,c);return v.createElement(Ly.Provider,{value:c,children:u})};v.forwardRef((t,e)=>{const r=wl(),[s,n]=id(r),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:f,transition:p,...m}=t,A=Oy(y=>{y.ctrlKey||y.metaKey||y.altKey||y.shiftKey||y.button!==0||(a?.(y),y.defaultPrevented||(y.preventDefault(),n(o,t)))}),g=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return l&&v.isValidElement(c)?v.cloneElement(c,{onClick:A,href:g}):v.createElement("a",{...m,onClick:A,href:g,className:u?.call?u(s===o):u,children:c,ref:e})});const $y=t=>Array.isArray(t)?t.flatMap(e=>$y(e&&e.type===v.Fragment?e.props.children:e)):[t],cv=({children:t,location:e})=>{const r=wl(),[s]=id(r);for(const n of $y(t)){let i=0;if(v.isValidElement(n)&&(i=Uy(r.parser,n.props.path,e||s,n.props.nest))[0])return v.cloneElement(n,{match:i})}return null},Kt=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t);function Xe(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var uv=typeof Symbol=="function"&&Symbol.observable||"@@observable",Xf=uv,tc=()=>Math.random().toString(36).substring(7).split("").join("."),hv={INIT:`@@redux/INIT${tc()}`,REPLACE:`@@redux/REPLACE${tc()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${tc()}`},Ga=hv;function bn(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function od(t,e,r){if(typeof t!="function")throw new Error(Xe(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Xe(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Xe(1));return r(od)(t,e)}let s=t,n=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(l)throw new Error(Xe(3));return n}function h(g){if(typeof g!="function")throw new Error(Xe(4));if(l)throw new Error(Xe(5));let y=!0;c();const V=a++;return o.set(V,g),function(){if(y){if(l)throw new Error(Xe(6));y=!1,c(),o.delete(V),i=null}}}function f(g){if(!bn(g))throw new Error(Xe(7));if(typeof g.type>"u")throw new Error(Xe(8));if(typeof g.type!="string")throw new Error(Xe(17));if(l)throw new Error(Xe(9));try{l=!0,n=s(n,g)}finally{l=!1}return(i=o).forEach(V=>{V()}),g}function p(g){if(typeof g!="function")throw new Error(Xe(10));s=g,f({type:Ga.REPLACE})}function m(){const g=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Xe(11));function V(){const b=y;b.next&&b.next(u())}return V(),{unsubscribe:g(V)}},[Xf](){return this}}}return f({type:Ga.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:p,[Xf]:m}}function dv(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Ga.INIT})>"u")throw new Error(Xe(12));if(typeof r(void 0,{type:Ga.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Xe(13))})}function ad(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const s=Object.keys(r);let n;try{dv(r)}catch(i){n=i}return function(o={},a){if(n)throw n;let l=!1;const c={};for(let u=0;u<s.length;u++){const h=s[u],f=r[h],p=o[h],m=f(p,a);if(typeof m>"u")throw a&&a.type,new Error(Xe(14));c[h]=m,l=l||m!==p}return l=l||s.length!==Object.keys(o).length,l?c:o}}function Wa(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function fv(...t){return e=>(r,s)=>{const n=e(r,s);let i=()=>{throw new Error(Xe(15))};const o={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=Wa(...a)(n.dispatch),{...n,dispatch:i}}}function ld(t){return bn(t)&&"type"in t&&typeof t.type=="string"}var cd=Symbol.for("immer-nothing"),Ri=Symbol.for("immer-draftable"),vt=Symbol.for("immer-state");function Ze(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ps=Object.getPrototypeOf;function dr(t){return!!t&&!!t[vt]}function Zt(t){return t?Hy(t)||Array.isArray(t)||!!t[Ri]||!!t.constructor?.[Ri]||Ao(t)||yo(t):!1}var pv=Object.prototype.constructor.toString();function Hy(t){if(!t||typeof t!="object")return!1;const e=Ps(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===pv}function mv(t){return dr(t)||Ze(15,t),t[vt].base_}function Hi(t,e){Es(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,s)=>e(s,r,t))}function Es(t){const e=t[vt];return e?e.type_:Array.isArray(t)?1:Ao(t)?2:yo(t)?3:0}function Gi(t,e){return Es(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function rc(t,e){return Es(t)===2?t.get(e):t[e]}function Gy(t,e,r){const s=Es(t);s===2?t.set(e,r):s===3?t.add(r):t[e]=r}function gv(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Ao(t){return t instanceof Map}function yo(t){return t instanceof Set}function fs(t){return t.copy_||t.base_}function Lu(t,e){if(Ao(t))return new Map(t);if(yo(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Hy(t);if(e===!0||e==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[vt];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const o=n[i],a=s[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(s[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Ps(t),s)}else{const s=Ps(t);if(s!==null&&r)return{...t};const n=Object.create(s);return Object.assign(n,t)}}function ud(t,e=!1){return vl(t)||dr(t)||!Zt(t)||(Es(t)>1&&(t.set=t.add=t.clear=t.delete=Av),Object.freeze(t),e&&Object.entries(t).forEach(([r,s])=>ud(s,!0))),t}function Av(){Ze(2)}function vl(t){return Object.isFrozen(t)}var Uu={};function Ts(t){const e=Uu[t];return e||Ze(0,t),e}function yv(t,e){Uu[t]||(Uu[t]=e)}var Wi;function Wy(){return Wi}function xv(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Jf(t,e){e&&(Ts("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function $u(t){Hu(t),t.drafts_.forEach(bv),t.drafts_=null}function Hu(t){t===Wi&&(Wi=t.parent_)}function Zf(t){return Wi=xv(Wi,t)}function bv(t){const e=t[vt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function ep(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[vt].modified_&&($u(e),Ze(4)),Zt(t)&&(t=Ya(e,t),e.parent_||Qa(e,t)),e.patches_&&Ts("Patches").generateReplacementPatches_(r[vt].base_,t,e.patches_,e.inversePatches_)):t=Ya(e,r,[]),$u(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==cd?t:void 0}function Ya(t,e,r){if(vl(e))return e;const s=e[vt];if(!s)return Hi(e,(n,i)=>tp(t,s,e,n,i,r)),e;if(s.scope_!==t)return e;if(!s.modified_)return Qa(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,o=!1;s.type_===3&&(i=new Set(n),n.clear(),o=!0),Hi(i,(a,l)=>tp(t,s,n,a,l,r,o)),Qa(t,n,!1),r&&t.patches_&&Ts("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function tp(t,e,r,s,n,i,o){if(dr(n)){const a=i&&e&&e.type_!==3&&!Gi(e.assigned_,s)?i.concat(s):void 0,l=Ya(t,n,a);if(Gy(r,s,l),dr(l))t.canAutoFreeze_=!1;else return}else o&&r.add(n);if(Zt(n)&&!vl(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Ya(t,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,s)&&Qa(t,n)}}function Qa(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ud(e,r)}function Vv(t,e){const r=Array.isArray(t),s={type_:r?1:0,scope_:e?e.scope_:Wy(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=hd;r&&(n=[s],i=Yi);const{revoke:o,proxy:a}=Proxy.revocable(n,i);return s.draft_=a,s.revoke_=o,a}var hd={get(t,e){if(e===vt)return t;const r=fs(t);if(!Gi(r,e))return qv(t,r,e);const s=r[e];return t.finalized_||!Zt(s)?s:s===sc(t.base_,e)?(nc(t),t.copy_[e]=Wu(s,t)):s},has(t,e){return e in fs(t)},ownKeys(t){return Reflect.ownKeys(fs(t))},set(t,e,r){const s=Yy(fs(t),e);if(s?.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const n=sc(fs(t),e),i=n?.[vt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(gv(r,n)&&(r!==void 0||Gi(t.base_,e)))return!0;nc(t),Gu(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return sc(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,nc(t),Gu(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=fs(t),s=Reflect.getOwnPropertyDescriptor(r,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:r[e]}},defineProperty(){Ze(11)},getPrototypeOf(t){return Ps(t.base_)},setPrototypeOf(){Ze(12)}},Yi={};Hi(hd,(t,e)=>{Yi[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Yi.deleteProperty=function(t,e){return Yi.set.call(this,t,e,void 0)};Yi.set=function(t,e,r){return hd.set.call(this,t[0],e,r,t[0])};function sc(t,e){const r=t[vt];return(r?fs(r):t)[e]}function qv(t,e,r){const s=Yy(e,r);return s?"value"in s?s.value:s.get?.call(t.draft_):void 0}function Yy(t,e){if(!(e in t))return;let r=Ps(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,e);if(s)return s;r=Ps(r)}}function Gu(t){t.modified_||(t.modified_=!0,t.parent_&&Gu(t.parent_))}function nc(t){t.copy_||(t.copy_=Lu(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var wv=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,s)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(l=i,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Ze(6),s!==void 0&&typeof s!="function"&&Ze(7);let n;if(Zt(e)){const i=Zf(this),o=Wu(e,void 0);let a=!0;try{n=r(o),a=!1}finally{a?$u(i):Hu(i)}return Jf(i,s),ep(n,i)}else if(!e||typeof e!="object"){if(n=r(e),n===void 0&&(n=e),n===cd&&(n=void 0),this.autoFreeze_&&ud(n,!0),s){const i=[],o=[];Ts("Patches").generateReplacementPatches_(e,n,i,o),s(i,o)}return n}else Ze(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let s,n;return[this.produce(e,r,(o,a)=>{s=o,n=a}),s,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Zt(t)||Ze(8),dr(t)&&(t=vv(t));const e=Zf(this),r=Wu(t,void 0);return r[vt].isManual_=!0,Hu(e),r}finishDraft(t,e){const r=t&&t[vt];(!r||!r.isManual_)&&Ze(9);const{scope_:s}=r;return Jf(s,e),ep(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(e=e.slice(r+1));const s=Ts("Patches").applyPatches_;return dr(t)?s(t,e):this.produce(t,n=>s(n,e))}};function Wu(t,e){const r=Ao(t)?Ts("MapSet").proxyMap_(t,e):yo(t)?Ts("MapSet").proxySet_(t,e):Vv(t,e);return(e?e.scope_:Wy()).drafts_.push(r),r}function vv(t){return dr(t)||Ze(10,t),Qy(t)}function Qy(t){if(!Zt(t)||vl(t))return t;const e=t[vt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Lu(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Lu(t,!0);return Hi(r,(s,n)=>{Gy(r,s,Qy(n))}),e&&(e.finalized_=!1),r}function _v(){const e="replace",s="remove";function n(f,p,m,A){switch(f.type_){case 0:case 2:return o(f,p,m,A);case 1:return i(f,p,m,A);case 3:return a(f,p,m,A)}}function i(f,p,m,A){let{base_:g,assigned_:y}=f,V=f.copy_;V.length<g.length&&([g,V]=[V,g],[m,A]=[A,m]);for(let x=0;x<g.length;x++)if(y[x]&&V[x]!==g[x]){const b=p.concat([x]);m.push({op:e,path:b,value:h(V[x])}),A.push({op:e,path:b,value:h(g[x])})}for(let x=g.length;x<V.length;x++){const b=p.concat([x]);m.push({op:"add",path:b,value:h(V[x])})}for(let x=V.length-1;g.length<=x;--x){const b=p.concat([x]);A.push({op:s,path:b})}}function o(f,p,m,A){const{base_:g,copy_:y}=f;Hi(f.assigned_,(V,x)=>{const b=rc(g,V),w=rc(y,V),_=x?Gi(g,V)?e:"add":s;if(b===w&&_===e)return;const q=p.concat(V);m.push(_===s?{op:_,path:q}:{op:_,path:q,value:w}),A.push(_==="add"?{op:s,path:q}:_===s?{op:"add",path:q,value:h(b)}:{op:e,path:q,value:h(b)})})}function a(f,p,m,A){let{base_:g,copy_:y}=f,V=0;g.forEach(x=>{if(!y.has(x)){const b=p.concat([V]);m.push({op:s,path:b,value:x}),A.unshift({op:"add",path:b,value:x})}V++}),V=0,y.forEach(x=>{if(!g.has(x)){const b=p.concat([V]);m.push({op:"add",path:b,value:x}),A.unshift({op:s,path:b,value:x})}V++})}function l(f,p,m,A){m.push({op:e,path:[],value:p===cd?void 0:p}),A.push({op:e,path:[],value:f})}function c(f,p){return p.forEach(m=>{const{path:A,op:g}=m;let y=f;for(let w=0;w<A.length-1;w++){const _=Es(y);let q=A[w];typeof q!="string"&&typeof q!="number"&&(q=""+q),(_===0||_===1)&&(q==="__proto__"||q==="constructor")&&Ze(19),typeof y=="function"&&q==="prototype"&&Ze(19),y=rc(y,q),typeof y!="object"&&Ze(18,A.join("/"))}const V=Es(y),x=u(m.value),b=A[A.length-1];switch(g){case e:switch(V){case 2:return y.set(b,x);case 3:Ze(16);default:return y[b]=x}case"add":switch(V){case 1:return b==="-"?y.push(x):y.splice(b,0,x);case 2:return y.set(b,x);case 3:return y.add(x);default:return y[b]=x}case s:switch(V){case 1:return y.splice(b,1);case 2:return y.delete(b);case 3:return y.delete(m.value);default:return delete y[b]}default:Ze(17,g)}}),f}function u(f){if(!Zt(f))return f;if(Array.isArray(f))return f.map(u);if(Ao(f))return new Map(Array.from(f.entries()).map(([m,A])=>[m,u(A)]));if(yo(f))return new Set(Array.from(f).map(u));const p=Object.create(Ps(f));for(const m in f)p[m]=u(f[m]);return Gi(f,Ri)&&(p[Ri]=f[Ri]),p}function h(f){return dr(f)?u(f):f}yv("Patches",{applyPatches_:c,generatePatches_:n,generateReplacementPatches_:l})}var jt=new wv,Bn=jt.produce,Ky=jt.produceWithPatches.bind(jt);jt.setAutoFreeze.bind(jt);jt.setUseStrictShallowCopy.bind(jt);var rp=jt.applyPatches.bind(jt);jt.createDraft.bind(jt);jt.finishDraft.bind(jt);function Sv(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function kv(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function Cv(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${e}[${r}]`)}}var sp=t=>Array.isArray(t)?t:[t];function Pv(t){const e=Array.isArray(t[0])?t[0]:t;return Cv(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function Ev(t,e){const r=[],{length:s}=t;for(let n=0;n<s;n++)r.push(t[n].apply(null,e));return r}var Tv=class{constructor(t){this.value=t}deref(){return this.value}},Mv=typeof WeakRef<"u"?WeakRef:Tv,Rv=0,np=1;function jo(){return{s:Rv,v:void 0,o:null,p:null}}function Ka(t,e={}){let r=jo();const{resultEqualityCheck:s}=e;let n,i=0;function o(){let a=r;const{length:l}=arguments;for(let h=0,f=l;h<f;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const A=m.get(p);A===void 0?(a=jo(),m.set(p,a)):a=A}else{let m=a.p;m===null&&(a.p=m=new Map);const A=m.get(p);A===void 0?(a=jo(),m.set(p,a)):a=A}}const c=a;let u;if(a.s===np)u=a.v;else if(u=t.apply(null,arguments),i++,s){const h=n?.deref?.()??n;h!=null&&s(h,u)&&(u=h,i!==0&&i--),n=typeof u=="object"&&u!==null||typeof u=="function"?new Mv(u):u}return c.s=np,c.v=u,u}return o.clearCache=()=>{r=jo(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function Iv(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,s=(...n)=>{let i=0,o=0,a,l={},c=n.pop();typeof c=="object"&&(l=c,c=n.pop()),Sv(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:f=[],argsMemoize:p=Ka,argsMemoizeOptions:m=[]}=u,A=sp(f),g=sp(m),y=Pv(n),V=h(function(){return i++,c.apply(null,arguments)},...A),x=p(function(){o++;const w=Ev(y,arguments);return a=V.apply(null,w),a},...g);return Object.assign(x,{resultFunc:c,memoizedResultFunc:V,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:p})};return Object.assign(s,{withTypes:()=>s}),s}var _l=Iv(Ka),jv=Object.assign((t,e=_l)=>{kv(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),s=r.map(i=>t[i]);return e(s,(...i)=>i.reduce((o,a,l)=>(o[r[l]]=a,o),{}))},{withTypes:()=>jv});function Xy(t){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,t):n(i)}var Ov=Xy(),Nv=Xy,zv=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Wa:Wa.apply(null,arguments)},Bv=t=>t&&typeof t.match=="function";function ft(t,e){function r(...s){if(e){let n=e(...s);if(!n)throw new Error(Ye(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>ld(s)&&s.type===t,r}var Jy=class Vi extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Vi.prototype)}static get[Symbol.species](){return Vi}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Vi(...e[0].concat(this)):new Vi(...e.concat(this))}};function ip(t){return Zt(t)?Bn(t,()=>{}):t}function Yu(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Dv(t){return typeof t=="boolean"}var Fv=()=>function(e){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let o=new Jy;return r&&(Dv(r)?o.push(Ov):o.push(Nv(r.extraArgument))),o},Sl="RTK_autoBatch",ei=()=>t=>({payload:t,meta:{[Sl]:!0}}),op=t=>e=>{setTimeout(e,t)},Lv=(t={type:"raf"})=>e=>(...r)=>{const s=e(...r);let n=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:op(10):t.type==="callback"?t.queueNotification:op(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const h=()=>n&&u(),f=s.subscribe(h);return a.add(u),()=>{f(),a.delete(u)}},dispatch(u){try{return n=!u?.meta?.[Sl],i=!n,i&&(o||(o=!0,l(c))),s.dispatch(u)}finally{n=!0}}})},Uv=t=>function(r){const{autoBatch:s=!0}=r??{};let n=new Jy(t);return s&&n.push(Lv(typeof s=="object"?s:void 0)),n};function $v(t){const e=Fv(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(bn(r))a=ad(r);else throw new Error(Ye(1));let l;typeof s=="function"?l=s(e):l=e();let c=Wa;n&&(c=zv({trace:!1,...typeof n=="object"&&n}));const u=fv(...l),h=Uv(u);let f=typeof o=="function"?o(h):h();const p=c(...f);return od(a,i,p)}function Zy(t){const e={},r=[];let s;const n={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(Ye(28));if(a in e)throw new Error(Ye(29));return e[a]=o,n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return s=i,n}};return t(n),[e,r,s]}function Hv(t){return typeof t=="function"}function Gv(t,e){let[r,s,n]=Zy(e),i;if(Hv(t))i=()=>ip(t());else{const a=ip(t);i=()=>a}function o(a=i(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(dr(u)){const p=h(u,l);return p===void 0?u:p}else{if(Zt(u))return Bn(u,f=>h(f,l));{const f=h(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},a)}return o.getInitialState=i,o}var ex=(t,e)=>Bv(t)?t.match(e):t(e);function fr(...t){return e=>t.some(r=>ex(r,e))}function Ii(...t){return e=>t.every(r=>ex(r,e))}function kl(t,e){if(!t||!t.meta)return!1;const r=typeof t.meta.requestId=="string",s=e.indexOf(t.meta.requestStatus)>-1;return r&&s}function xo(t){return typeof t[0]=="function"&&"pending"in t[0]&&"fulfilled"in t[0]&&"rejected"in t[0]}function dd(...t){return t.length===0?e=>kl(e,["pending"]):xo(t)?fr(...t.map(e=>e.pending)):dd()(t[0])}function Vn(...t){return t.length===0?e=>kl(e,["rejected"]):xo(t)?fr(...t.map(e=>e.rejected)):Vn()(t[0])}function Cl(...t){const e=r=>r&&r.meta&&r.meta.rejectedWithValue;return t.length===0?Ii(Vn(...t),e):xo(t)?Ii(Vn(...t),e):Cl()(t[0])}function Jr(...t){return t.length===0?e=>kl(e,["fulfilled"]):xo(t)?fr(...t.map(e=>e.fulfilled)):Jr()(t[0])}function Qu(...t){return t.length===0?e=>kl(e,["pending","fulfilled","rejected"]):xo(t)?fr(...t.flatMap(e=>[e.pending,e.rejected,e.fulfilled])):Qu()(t[0])}var Wv="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bo=(t=21)=>{let e="",r=t;for(;r--;)e+=Wv[Math.random()*64|0];return e},Yv=["name","message","stack","code"],ic=class{constructor(t,e){this.payload=t,this.meta=e}_type},ap=class{constructor(t,e){this.payload=t,this.meta=e}_type},Qv=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of Yv)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},lp="External signal was aborted",cp=(()=>{function t(e,r,s){const n=ft(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=ft(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=ft(e+"/rejected",(l,c,u,h,f)=>({payload:h,error:(s&&s.serializeError||Qv)(l||"Rejected"),meta:{...f||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,f)=>{const p=s?.idGenerator?s.idGenerator(l):bo(),m=new AbortController;let A,g;function y(x){g=x,m.abort()}c&&(c.aborted?y(lp):c.addEventListener("abort",()=>y(lp),{once:!0}));const V=(async function(){let x;try{let w=s?.condition?.(l,{getState:h,extra:f});if(Xv(w)&&(w=await w),w===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const _=new Promise((q,S)=>{A=()=>{S({name:"AbortError",message:g||"Aborted"})},m.signal.addEventListener("abort",A)});u(i(p,l,s?.getPendingMeta?.({requestId:p,arg:l},{getState:h,extra:f}))),x=await Promise.race([_,Promise.resolve(r(l,{dispatch:u,getState:h,extra:f,requestId:p,signal:m.signal,abort:y,rejectWithValue:(q,S)=>new ic(q,S),fulfillWithValue:(q,S)=>new ap(q,S)})).then(q=>{if(q instanceof ic)throw q;return q instanceof ap?n(q.payload,p,l,q.meta):n(q,p,l)})])}catch(w){x=w instanceof ic?o(null,p,l,w.payload,w.meta):o(w,p,l)}finally{A&&m.signal.removeEventListener("abort",A)}return s&&!s.dispatchConditionRejection&&o.match(x)&&x.meta.condition||u(x),x})();return Object.assign(V,{abort:y,requestId:p,arg:l,unwrap(){return V.then(Kv)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:n,settled:fr(o,n),typePrefix:e})}return t.withTypes=()=>t,t})();function Kv(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Xv(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var Jv=Symbol.for("rtk-slice-createasyncthunk");function Zv(t,e){return`${t}/${e}`}function e0({creators:t}={}){const e=t?.asyncThunk?.[Jv];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(Ye(11));const o=(typeof s.reducers=="function"?s.reducers(r0()):s.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(V,x){const b=typeof V=="string"?V:V.type;if(!b)throw new Error(Ye(12));if(b in l.sliceCaseReducersByType)throw new Error(Ye(13));return l.sliceCaseReducersByType[b]=x,c},addMatcher(V,x){return l.sliceMatchers.push({matcher:V,reducer:x}),c},exposeAction(V,x){return l.actionCreators[V]=x,c},exposeCaseReducer(V,x){return l.sliceCaseReducersByName[V]=x,c}};a.forEach(V=>{const x=o[V],b={reducerName:V,type:Zv(n,V),createNotation:typeof s.reducers=="function"};n0(x)?o0(b,x,c,e):s0(b,x,c)});function u(){const[V={},x=[],b=void 0]=typeof s.extraReducers=="function"?Zy(s.extraReducers):[s.extraReducers],w={...V,...l.sliceCaseReducersByType};return Gv(s.initialState,_=>{for(let q in w)_.addCase(q,w[q]);for(let q of l.sliceMatchers)_.addMatcher(q.matcher,q.reducer);for(let q of x)_.addMatcher(q.matcher,q.reducer);b&&_.addDefaultCase(b)})}const h=V=>V,f=new Map;let p;function m(V,x){return p||(p=u()),p(V,x)}function A(){return p||(p=u()),p.getInitialState()}function g(V,x=!1){function b(_){let q=_[V];return typeof q>"u"&&x&&(q=A()),q}function w(_=h){const q=Yu(f,x,()=>new WeakMap);return Yu(q,_,()=>{const S={};for(const[k,C]of Object.entries(s.selectors??{}))S[k]=t0(C,_,A,x);return S})}return{reducerPath:V,getSelectors:w,get selectors(){return w(b)},selectSlice:b}}const y={name:n,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:A,...g(i),injectInto(V,{reducerPath:x,...b}={}){const w=x??i;return V.inject({reducerPath:w,reducer:m},b),{...y,...g(w,!0)}}};return y}}function t0(t,e,r,s){function n(i,...o){let a=e(i);return typeof a>"u"&&s&&(a=r()),t(a,...o)}return n.unwrapped=t,n}var vr=e0();function r0(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function s0({type:t,reducerName:e,createNotation:r},s,n){let i,o;if("reducer"in s){if(r&&!i0(s))throw new Error(Ye(17));i=s.reducer,o=s.prepare}else i=s;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?ft(t,o):ft(t))}function n0(t){return t._reducerDefinitionType==="asyncThunk"}function i0(t){return t._reducerDefinitionType==="reducerWithPrepare"}function o0({type:t,reducerName:e},r,s,n){if(!n)throw new Error(Ye(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=n(t,i,u);s.exposeAction(e,h),o&&s.addCase(h.fulfilled,o),a&&s.addCase(h.pending,a),l&&s.addCase(h.rejected,l),c&&s.addMatcher(h.settled,c),s.exposeCaseReducer(e,{fulfilled:o||Oo,pending:a||Oo,rejected:l||Oo,settled:c||Oo})}function Oo(){}var a0="task",tx="listener",rx="completed",fd="cancelled",l0=`task-${fd}`,c0=`task-${rx}`,Ku=`${tx}-${fd}`,u0=`${tx}-${rx}`,Pl=class{constructor(t){this.code=t,this.message=`${a0} ${fd} (reason: ${t})`}name="TaskAbortError";message},pd=(t,e)=>{if(typeof t!="function")throw new TypeError(Ye(32))},Xa=()=>{},sx=(t,e=Xa)=>(t.catch(e),t),nx=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Ss=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},ks=t=>{if(t.aborted){const{reason:e}=t;throw new Pl(e)}};function ix(t,e){let r=Xa;return new Promise((s,n)=>{const i=()=>n(new Pl(t.reason));if(t.aborted){i();return}r=nx(t,i),e.finally(()=>r()).then(s,n)}).finally(()=>{r=Xa})}var h0=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Pl?"cancelled":"rejected",error:r}}finally{e?.()}},Ja=t=>e=>sx(ix(t,e).then(r=>(ks(t),r))),ox=t=>{const e=Ja(t);return r=>e(new Promise(s=>setTimeout(s,r)))},{assign:fn}=Object,up={},El="listenerMiddleware",d0=(t,e)=>{const r=s=>nx(t,()=>Ss(s,t.reason));return(s,n)=>{pd(s);const i=new AbortController;r(i);const o=h0(async()=>{ks(t),ks(i.signal);const a=await s({pause:Ja(i.signal),delay:ox(i.signal),signal:i.signal});return ks(i.signal),a},()=>Ss(i,c0));return n?.autoJoin&&e.push(o.catch(Xa)),{result:Ja(t)(o),cancel(){Ss(i,l0)}}}},f0=(t,e)=>{const r=async(s,n)=>{ks(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:s,effect:(h,f)=>{f.unsubscribe(),l([h,f.getState(),f.getOriginalState()])}});i=()=>{u(),c()}})];n!=null&&a.push(new Promise(l=>setTimeout(l,n,null)));try{const l=await ix(e,Promise.race(a));return ks(e),l}finally{i()}};return(s,n)=>sx(r(s,n))},ax=t=>{let{type:e,actionCreator:r,matcher:s,predicate:n,effect:i}=t;if(e)n=ft(e).match;else if(r)e=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(Ye(21));return pd(i),{predicate:n,type:e,effect:i}},lx=fn(t=>{const{type:e,predicate:r,effect:s}=ax(t);return{id:bo(),effect:s,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ye(22))}}},{withTypes:()=>lx}),hp=(t,e)=>{const{type:r,effect:s,predicate:n}=ax(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},Xu=t=>{t.pending.forEach(e=>{Ss(e,Ku)})},p0=t=>()=>{t.forEach(Xu),t.clear()},dp=(t,e,r)=>{try{t(e,r)}catch(s){setTimeout(()=>{throw s},0)}},cx=fn(ft(`${El}/add`),{withTypes:()=>cx}),m0=ft(`${El}/removeAll`),ux=fn(ft(`${El}/remove`),{withTypes:()=>ux}),g0=(...t)=>{console.error(`${El}/error`,...t)},A0=(t={})=>{const e=new Map,{extra:r,onError:s=g0}=t;pd(s);const n=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Xu(u)}),i=u=>{const h=hp(e,u)??lx(u);return n(h)};fn(i,{withTypes:()=>i});const o=u=>{const h=hp(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Xu(h)),!!h};fn(o,{withTypes:()=>o});const a=async(u,h,f,p)=>{const m=new AbortController,A=f0(i,m.signal),g=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,fn({},f,{getOriginalState:p,condition:(y,V)=>A(y,V).then(Boolean),take:A,delay:ox(m.signal),pause:Ja(m.signal),extra:r,signal:m.signal,fork:d0(m.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,V,x)=>{y!==m&&(Ss(y,Ku),x.delete(y))})},cancel:()=>{Ss(m,Ku),u.pending.delete(m)},throwIfCancelled:()=>{ks(m.signal)}})))}catch(y){y instanceof Pl||dp(s,y,{raisedBy:"effect"})}finally{await Promise.all(g),Ss(m,u0),u.pending.delete(m)}},l=p0(e);return{middleware:u=>h=>f=>{if(!ld(f))return h(f);if(cx.match(f))return i(f.payload);if(m0.match(f)){l();return}if(ux.match(f))return o(f.payload);let p=u.getState();const m=()=>{if(p===up)throw new Error(Ye(23));return p};let A;try{if(A=h(f),e.size>0){const g=u.getState(),y=Array.from(e.values());for(const V of y){let x=!1;try{x=V.predicate(f,g,p)}catch(b){x=!1,dp(s,b,{raisedBy:"predicate"})}x&&a(V,f,u,m)}}}finally{p=up}return A},startListening:i,stopListening:o,clearListeners:l}},y0=t=>"reducerPath"in t&&typeof t.reducerPath=="string",x0=t=>t.flatMap(e=>y0(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),md=Symbol.for("rtk-state-proxy-original"),b0=t=>!!t&&!!t[md],V0=new WeakMap,q0=(t,e)=>Yu(V0,t,()=>new Proxy(t,{get:(r,s,n)=>{if(s===md)return r;const i=Reflect.get(r,s,n);if(typeof i>"u"){const o=e[s.toString()];if(o){const a=o(void 0,{type:bo()});if(typeof a>"u")throw new Error(Ye(24));return a}}return i}})),w0=t=>{if(!b0(t))throw new Error(Ye(25));return t[md]},v0=(t={})=>t;function _0(...t){const e=Object.fromEntries(x0(t)),r=()=>Object.keys(e).length?ad(e):v0;let s=r();function n(a,l){return s(a,l)}n.withLazyLoadedSlices=()=>n;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,s=r()),n},o=Object.assign(function(l,c){return function(h,...f){return l(q0(c?c(h,...f):h,e),...f)}},{original:w0});return Object.assign(n,{inject:i,selector:o})}function Ye(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const gd=v.createContext(null),S0=({gameApi:t,children:e})=>d.jsx(gd,{value:t,children:e}),Dn=()=>{const t=v.useContext(gd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},hx=()=>{const t=v.useContext(gd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},dx=A0(),Ad=dx.startListening.withTypes();function k0(t){var e="";return r(t),e;function r(n){if(n===null||typeof n!="object"||n.toJSON!=null)e+=JSON.stringify(n);else if(Array.isArray(n)){e+="[";var i=!1;n.forEach(function(a){i&&(e+=","),i=!0,a===void 0&&(a=null),r(a)}),e+="]"}else{e+="{";var o=Object.keys(n).filter(function(a){return n[a]!==void 0}).sort();o.forEach(function(a,l){return s(n,a,l)}),e+="}"}}function s(n,i,o){o>0&&(e+=","),e+=JSON.stringify(i),e+=":",r(n[i])}}var yd="persist:",xd="persist/FLUSH",Vo="persist/REHYDRATE",bd="persist/PAUSE",Vd="persist/PERSIST",qd="persist/PURGE",wd="persist/REGISTER",fx=-1;function Ia(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ia=function(r){return typeof r}:Ia=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ia(t)}function fp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function C0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fp(r,!0).forEach(function(s){P0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fp(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function P0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E0(t,e,r,s){s.debug;var n=C0({},r);return t&&Ia(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(n[i]=t[i])}),n}function T0(t){var e=t.blacklist||null,r=t.whitelist||null,s=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:yd).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(w){return w}:typeof t.serialize=="function"?a=t.serialize:a=M0;var l=t.writeFailHandler||null,c={},u={},h=[],f=null,p=null,m=function(w){Object.keys(w).forEach(function(_){y(_)&&c[_]!==w[_]&&h.indexOf(_)===-1&&h.push(_)}),Object.keys(c).forEach(function(_){w[_]===void 0&&y(_)&&h.indexOf(_)===-1&&c[_]!==void 0&&h.push(_)}),f===null&&(f=setInterval(A,n)),c=w};function A(){if(h.length===0){f&&clearInterval(f),f=null;return}var b=h.shift(),w=s.reduce(function(_,q){return q.in(_,b,c)},c[b]);if(w!==void 0)try{u[b]=a(w)}catch(_){console.error("redux-persist/createPersistoid: error serializing state",_)}else delete u[b];h.length===0&&g()}function g(){Object.keys(u).forEach(function(b){c[b]===void 0&&delete u[b]}),p=o.setItem(i,a(u)).catch(V)}function y(b){return!(r&&r.indexOf(b)===-1&&b!=="_persist"||e&&e.indexOf(b)!==-1)}function V(b){l&&l(b)}var x=function(){for(;h.length!==0;)A();return p||Promise.resolve()};return{update:m,flush:x}}function M0(t){return JSON.stringify(t)}function R0(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:yd).concat(t.key),s=t.storage;t.debug;var n;return t.deserialize===!1?n=function(o){return o}:typeof t.deserialize=="function"?n=t.deserialize:n=I0,s.getItem(r).then(function(i){if(i)try{var o={},a=n(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},n(a[l]))}),o}catch(l){throw l}else return})}function I0(t){return JSON.parse(t)}function j0(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:yd).concat(t.key);return e.removeItem(r,O0)}function O0(t){}function pp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function xr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pp(r,!0).forEach(function(s){N0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pp(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function N0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z0(t,e){if(t==null)return{};var r=B0(t,e),s,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function B0(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}var D0=5e3;function F0(t,e){var r=t.version!==void 0?t.version:fx;t.debug;var s=t.stateReconciler===void 0?E0:t.stateReconciler,n=t.getStoredState||R0,i=t.timeout!==void 0?t.timeout:D0,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var f=u||{},p=f._persist,m=z0(f,["_persist"]),A=m;if(h.type===Vd){var g=!1,y=function(S,k){g||(h.rehydrate(t.key,S,k),g=!0)};if(i&&setTimeout(function(){!g&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=T0(t)),p)return xr({},e(A,h),{_persist:p});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(q){var S=t.migrate||function(k,C){return Promise.resolve(k)};S(q,r).then(function(k){y(k)},function(k){y(void 0,k)})},function(q){y(void 0,q)}),xr({},e(A,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===qd)return a=!0,h.result(j0(t)),xr({},e(A,h),{_persist:p});if(h.type===xd)return h.result(o&&o.flush()),xr({},e(A,h),{_persist:p});if(h.type===bd)l=!0;else if(h.type===Vo){if(a)return xr({},A,{_persist:xr({},p,{rehydrated:!0})});if(h.key===t.key){var V=e(A,h),x=h.payload,b=s!==!1&&x!==void 0?s(x,u,V,t):V,w=xr({},b,{_persist:xr({},p,{rehydrated:!0})});return c(w)}}}if(!p)return e(u,h);var _=e(A,h);return _===A?u:c(xr({},_,{_persist:p}))}}function mp(t){return $0(t)||U0(t)||L0()}function L0(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function U0(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function $0(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function gp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Ju(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gp(r,!0).forEach(function(s){H0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gp(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function H0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var px={registry:[],bootstrapped:!1},G0=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:px,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case wd:return Ju({},e,{registry:[].concat(mp(e.registry),[r.key])});case Vo:var s=e.registry.indexOf(r.key),n=mp(e.registry);return n.splice(s,1),Ju({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function W0(t,e,r){var s=od(G0,px,void 0),n=function(l){s.dispatch({type:wd,key:l})},i=function(l,c,u){var h={type:Vo,payload:c,err:u,key:l};t.dispatch(h),s.dispatch(h)},o=Ju({},s,{purge:function(){var l=[];return t.dispatch({type:qd,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:xd,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:bd})},persist:function(){t.dispatch({type:Vd,register:n,rehydrate:i})}});return o.persist(),o}function Y0(t,e){return function(r,s){if(!r)return Promise.resolve(void 0);var n=r._persist&&r._persist.version!==void 0?r._persist.version:fx;if(n===s||n>s)return Promise.resolve(r);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return s>=a&&a>n}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},r);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const Gr=1e-4,Xt=(t,e)=>Math.abs(t-e)<Gr,CL=t=>t===0?Gr:Math.abs(t)<Gr?Gr*Math.sign(t):t,pn=["away","towards","left","right"],Q0=["awayRight","towardsRight","towardsLeft","awayLeft"],qn=[...pn,...Q0],mx=t=>t==="away"||t==="towards"?"y":"x",PL=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",gx=t=>Tl(mx(t)),Tl=t=>t==="x"?"y":"x",Wr=(t,...e)=>{const r={x:t.x,y:t.y};for(const s of e)r.x+=s.x??0,r.y+=s.y??0;return r},K0=(t,...e)=>{const r={x:t.x,y:t.y};for(const s of e)r.x-=s.x??0,r.y-=s.y??0;return r},Ax=(t,e)=>({x:t.x*e,y:t.y*e}),EL=(t,e)=>(t.x*=e,t.y*=e,t),Ut=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),Ap=(t,e,r)=>{const s=t;return s.x=e.x*r,s.y=e.y*r,s.z=e.z*r,s},X0=(t,e)=>(t.x*=e,t.y*=e,t.z*=e,t),J0=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),Fn=({x:t,y:e,z:r})=>Math.hypot(t,e,r),yx=({x:t,y:e})=>Math.hypot(t,e),Z0=({x:t,y:e,z:r})=>t**2+e**2+r**2,e_=({x:t,y:e})=>t**2+e**2,t_=t=>{const e=Fn(t);if(e===0)throw new Error("unitVector called with zero length vector");return Ut(t,1/e)},hn=t=>{const e=Fn(t);if(e===0)throw new Error("unitVectorInPlace called with zero length vector");return X0(t,1/e)},U=(...t)=>{if(t.length===0)return{x:0,y:0,z:0};const[e,...r]=t,s={x:e.x??0,y:e.y??0,z:e.z??0};for(const n of r)s.x+=n.x??0,s.y+=n.y??0,s.z+=n.z??0;return s},r_=(t,...e)=>{for(const r of e)t.x+=r.x??0,t.y+=r.y??0,t.z+=r.z??0;return t},xx=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n,y:i,z:o})=>({x:e*n,y:r*i,z:s*o}),qo),Tr=(t,...e)=>{const r={x:t.x,y:t.y,z:t.z};for(const s of e)r.x-=s.x??0,r.y-=s.y??0,r.z-=s.z??0;return r},s_=(t,...e)=>{for(const r of e)t.x-=r.x??0,t.y-=r.y??0,t.z-=r.z??0;return t},vd=({x:t,y:e,z:r},{x:s,y:n,z:i})=>t===s&&e===n&&r===i,n_=({x:t,y:e},{x:r,y:s})=>t===r&&e===s,TL=t=>{const{x:e}=t,r=Math.round(e),s=!Number.isInteger(e)&&Xt(e,r),{y:n}=t,i=Math.round(n),o=!Number.isInteger(n)&&Xt(n,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&Xt(t.z,l);return s||o||c?{x:s?r:e,y:o?i:n,z:c?l:a}:t},ML=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),RL=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),bx=Object.freeze({x:0,y:0}),X=Object.freeze({x:0,y:0,z:0}),qo=Object.freeze({x:1,y:1,z:1}),IL=Object.freeze({x:1,y:1,z:0}),jL=Object.freeze({x:1,y:0,z:1}),OL=Object.freeze({x:0,y:1,z:1}),NL=Object.freeze({x:1,y:0,z:0}),zL=Object.freeze({x:0,y:1,z:0}),i_=["x","y","z"],Za=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,o_=({x:t,y:e})=>{if(!(Xt(t,0)&&Xt(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},a_=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],_d=({x:t,y:e})=>{if(Xt(t,0)&&Xt(e,0))return;const r=Math.atan2(-e,-t),s=Math.round(8*r/(2*Math.PI))&7;return a_[s]},BL=({x:t,y:e},{x:r,y:s})=>Math.abs(r-t)**2+Math.abs(s-e)**2,DL=(t,e)=>{const r=t.x*e.x+t.y*e.y+t.z*e.z;if(r<=0)return!1;const s=t.x*t.x+t.y*t.y+t.z*t.z,n=e.x*e.x+e.y*e.y+e.z*e.z;return Math.abs(r*r-s*n)<Gr},FL=t=>{t.x=0,t.y=0,t.z=0},Vx=["lookUp","lookDown","lookLeft","lookRight"],qx=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","toggleCrtFilter","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...pn,"lookShift",...Vx,"pageUp","pageDown","home","end"],wx=[...qx];var kt={},oc={},ac={},yp;function Ml(){if(yp)return ac;yp=1;function t(e){return typeof e<"u"}return ac.notUndefined=t,ac}var xp;function vx(){if(xp)return oc;xp=1;const{notUndefined:t}=Ml();function e(r){return r!=null&&t(r[Symbol.iterator])}return oc.isIterable=e,oc}var lc={},bp;function l_(){return bp||(bp=1,lc.isLoopable=vx().isIterable),lc}var cc={},Vp;function c_(){if(Vp)return cc;Vp=1;const{notUndefined:t}=Ml();function e(r){return r==null||t(r[Symbol.iterator])}return cc.isWrappable=e,cc}var No={},qp;function u_(){if(qp)return No;qp=1;function*t(r){yield*r}No.wrap=t;function*e(r){r!=null&&(yield*r)}return No.nullableWrap=e,No}var zo={},wp;function h_(){if(wp)return zo;wp=1;function t(s,n=s.length,i=[]){return(...o)=>n<=o.length?s(...i,...o):t(s,n-o.length,[...i,...o])}zo.curry=t;function e(s,n){const{fn:i,validateArgs:o,variadic:a,reduces:l,growRight:c,minArgs:u,maxArgs:h,isIterable:f,iterableType:p,applyOnIterableArgs:m,IterableClass:A}=s;if(n.length>u){let g=!0;const y=a?n.findIndex((x,b)=>f(x)&&b>=u):Math.min(h,n.length-1),V=a?n.length:y+1;if(a)for(let x=y;x<n.length;x++)g=g&&f(n[x]);else g=f(n[y]);if(n.length>h&&(y===-1||!g)){const x=a?`...${p}s`:p,b=`${i.name} takes up to ${h} arguments, followed by ${x}. You already passed ${n.length} arguments`;throw a?new Error(`${b} and the following arguments were not all ${p}s`):new Error(`${b} and the last argument was not ${p}`)}if(y>=0&&g){for(let b=y;b<V;b++)n[b]=m(n[b]);const x=a?n.slice(y):n[y];return n.splice(y),c||n.reverse(),n.unshift(x),o(n),l?i(...n):new A(i,n)}}return r(s,n)}function r(s,n=[]){return(...i)=>{if(i.length===0)throw new Error("Cannot make a partial application with no arguments");return i.unshift(...n),e(s,i)}}return zo.variadicCurryWithValidation=r,zo}var ti={},vp;function d_(){if(vp)return ti;vp=1;const t=Symbol.for("_");ti._=t;const e=Symbol("__iterate");ti.__iterate=e;const r=Symbol("split");return ti.split=r,ti}var _p;function _t(){if(_p)return kt;_p=1;const{isIterable:t}=vx(),{isLoopable:e}=l_(),{isWrappable:r}=c_(),{nullableWrap:s}=u_(),{variadicCurryWithValidation:n}=h_(),{_:i,__iterate:o}=d_();kt.wrap=s,kt.isIterable=t,kt.isLoopable=e,kt.isWrappable=r;function a(A){if(r(A))return t(A)?A:s(A);throw typeof A.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}kt.ensureIterable=a;function l(A){"return"in A&&A.return()}kt.callReturn=l;function c(A,g){this[i]={fn:A,args:g,staticIterator:null}}kt.BaseIterableIterator=c,Object.assign(c.prototype,{constructor:c,[o](){const{fn:A,args:g}=this[i];return A(...g)},next(){const A=this[i];return A.staticIterator=A.staticIterator||this[o](),A.staticIterator.next()},return(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.return(A)},throw(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.throw(A)}});function u(...A){c.apply(this,A)}kt.IterableIterator=u,u.prototype=Object.assign(Object.create(c.prototype),{constructor:u,[Symbol.iterator](){return this[o]()}});function h(A,g={}){const{validateArgs:y=S=>{},variadic:V=!1,reduces:x=!1,growRight:b=!1,minArgs:w=A.length-1,maxArgs:_=A.length-1,applyOnIterableArgs:q=a}=g;return{fn:A,validateArgs:y,variadic:V,reduces:x,growRight:b,minArgs:w,maxArgs:_,isIterable:r,iterableType:"iterable",applyOnIterableArgs:q,IterableClass:u}}function f(A){return[...A]}kt.cache=f;function p(A,{validateArgs:g=y=>y}={}){return(...y)=>(g(y),new u(A,y))}kt.wrapWithIterableIterator=p;const m=(A,g)=>n(h(A,g));return kt.iterableCurry=m,kt}var uc={},Sp;function f_(){if(Sp)return uc;Sp=1;class t{[Symbol.iterator](){return this}}return uc.IterableIterator=t,uc}var ri={},kp;function _x(){if(kp)return ri;kp=1;function t(s,n=!1){return typeof s=="number"&&!isNaN(s)&&isFinite(s)&&!(n&&s===0)}ri.isInteger=t;function e(s,n=!1){return t(s)&&(n?s>0:s>=0)}ri.isPositiveInteger=e;function r(s,n=!1){return typeof s=="number"&&!isNaN(s)&&!(n&&s===0)}return ri.isIntegerOrInfinite=r,ri}var Bo={},Cp;function p_(){if(Cp)return Bo;Cp=1;const{iterableCurry:t}=_t();function*e(s,n){let i=0;for(const o of s)yield n(o,i++)}Bo.__map=e;const r=t(e);return Bo.map=r,Bo}var Do={},Pp;function m_(){if(Pp)return Do;Pp=1;const{ensureIterable:t}=_t();function e(s){const n=[];for(const i of s)n.push(i);return n}Do.__toArray=e;function r(s){return e(t(s))}return Do.toArray=r,Do}var hc={},Ep;function Sx(){if(Ep)return hc;Ep=1;function t(e){return typeof e=="object"&&e!==null}return hc.isObject=t,hc}var dc={},Tp;function g_(){if(Tp)return dc;Tp=1;function t(e,r){for(const s of e)r(s)}return dc.parallelEach=t,dc}var fc={},Mp;function A_(){if(Mp)return fc;Mp=1;const{ensureIterable:t,callReturn:e}=_t(),r=Symbol.for("_");class s{constructor(o){this.peekr=o}next(){const{peekr:o}=this,{current:a}=o;return o.advance(),a}return(){return this.peekr.return(),{value:void 0,done:!0}}[Symbol.iterator](){return this}}class n{static from(o,...a){const l=t(o)[Symbol.iterator](),c=l.next();return new this(l,c,...a)}constructor(o,a){this[r]={iterator:o,current:a,index:0}}get current(){return this[r].current}get value(){return this[r].current.value}get done(){return this[r].current.done}get index(){return this[r].index}advance(){const o=this[r];return o.current.done||(o.index++,o.current=o.iterator.next()),this}return(){const o=this[r];return this.done||e(o.iterator),o.current={value:void 0,done:!0},this}asIterator(){return new s(this)}}return fc.Peekerator=n,fc}var pc={},Rp;function y_(){if(Rp)return pc;Rp=1;const{isInteger:t}=_x(),{isObject:e}=Sx(),{notUndefined:r}=Ml(),s=n=>function(o){if(e(o[1])){const{start:a,step:l}=o[1];o[1]=a,o[2]=l}if(r(o[2])&&(o[2]=Number(o[2]),!t(o[2],!0)))throw new Error(`step argument to ${n} must be a non-zero integer`)};return pc.makeValidateArgs=s,pc}var si={},Ip;function x_(){if(Ip)return si;Ip=1;const{iterableCurry:t,callReturn:e}=_t(),{IterableIterator:r}=f_(),{parallelEach:s}=g_(),{Peekerator:n}=A_(),{__map:i}=p_(),{__toArray:o}=m_(),a=Symbol.for("_"),l=Symbol.for("__advance");class c extends n{constructor(g,y,V){super(g,y),this[a].inputSummary=V}advance(){this[a].inputSummary.advanceBuffer(this)}[l](){super.advance()}}class u{constructor(){this.buffers=[],this.notDoneBuffer=null,this.index=0}init(g){this.buffers=g,this.updateNotDone()}updateNotDone(){this.notDoneBuffer=this.buffers.find(g=>!g.done)}advanceBuffer(g){const y=g.done;g[l](),this.index++,!y&&g.done&&this.updateNotDone()}}class h{constructor(g){this[a]=g}advance(){throw new Error("advance() is not supported on an interleave summary")}get current(){return{value:this.value,done:this.done}}get value(){return this[a].notDoneBuffer}get done(){return this[a].notDoneBuffer===void 0}get index(){return this[a].index}}si.InputSummary=h;class f extends r{constructor(g,y,V){super(),this.sources=g,this.strategy=y,this.options=V,this.initialized=!1,this.inputSummary=new u(g)}init(){this.initialized=!0;const{strategy:g,options:y,inputSummary:V}=this;this.buffers=o(i(this.sources,x=>c.from(x,V))),this.iterator=g(y,new h(V),...this.buffers),V.init(this.buffers)}returnBuffers(){s(this.buffers,g=>g.return())}next(){this.initialized||this.init();const g=this.iterator.next();return g.done&&this.returnBuffers(),g}return(){return e(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}function p(A,g,y={}){return new f(A,g,y)}si.__interleave=p;const m=t(p,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return si.interleave=m,si}var Fo={},Lo={},jp;function kx(){if(jp)return Lo;jp=1;const{iterableCurry:t,callReturn:e}=_t();function r(n,i){const o=n[Symbol.iterator](),{value:a,done:l}=o.next();return l?i:(e(o),a)}Lo.__firstOr=r;const s=t(r,{reduces:!0});return Lo.firstOr=s,Lo}var Op;function b_(){if(Op)return Fo;Op=1;const{iterableCurry:t}=_t(),{__firstOr:e}=kx();function r(n){return e(n,void 0)}Fo.__first=r;const s=t(r,{reduces:!0});return Fo.first=s,Fo}var Uo={},Np;function V_(){if(Np)return Uo;Np=1;const{iterableCurry:t}=_t(),{__firstOr:e}=kx(),r=Symbol("none");function s(i){return e(i,r)===r}Uo.__isEmpty=s;const n=t(s,{reduces:!0});return Uo.isEmpty=n,Uo}var $o={},zp;function q_(){if(zp)return $o;zp=1;const{wrapWithIterableIterator:t}=_t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield[i,n[i]])}$o.__objectEntries=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return $o.objectEntries=s,$o}var Ho={},Bp;function w_(){if(Bp)return Ho;Bp=1;const{wrapWithIterableIterator:t}=_t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield i)}Ho.__objectKeys=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return Ho.objectKeys=s,Ho}var Go={},Dp;function v_(){if(Dp)return Go;Dp=1;const{wrapWithIterableIterator:t}=_t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield n[i])}Go.__objectValues=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return Go.objectValues=s,Go}var Wo={},Fp;function __(){if(Fp)return Wo;Fp=1;const{wrapWithIterableIterator:t}=_t(),{isInteger:e,isIntegerOrInfinite:r}=_x(),{isObject:s}=Sx(),{notUndefined:n}=Ml();function*i(a=0,l=1/0,c=1){for(let u=a;c>0?u<l:u>l;u+=c)yield u}Wo.__range=i;const o=t(i,{growRight:!0,validateArgs(a){let[l,c=1/0,u]=a,h;if(s(l)?{start:h,end:c,step:u}=l:a.length>1?h=l:c=l,n(h)&&!e(h))throw new TypeError("The specified start was not an integer");if(n(c)&&!r(c))throw new TypeError("The specified end was not an integer or infinite");if(n(u)&&!e(u,!0))throw new TypeError("The specified step was not a non-zero integer");a[0]=h,a[1]=c,a[2]=u}});return Wo.range=o,Wo}var Yo={},Lp;function S_(){if(Lp)return Yo;Lp=1;const{iterableCurry:t}=_t(),{__interleave:e}=x_(),{makeValidateArgs:r}=y_();function*s({start:o,step:a},l,...c){o=o%c.length;for(let u=o;!l.done;u=(u+a)%c.length){const h=c[u];h.done||(yield h.value,h.advance())}}function n(o,a=1,l=0){return e(o,s,{start:l,step:a})}Yo.__roundRobin=n;const i=t(n,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:r("roundRobin")});return Yo.roundRobin=i,Yo}var Qo={},Up;function k_(){if(Up)return Qo;Up=1;const{ensureIterable:t}=_t();function e(s){const n=t(s);let i=0;for(const o of n)i++;return i}Qo.__size=e;const r=e;return Qo.size=r,Qo}var Ko={},$p;function C_(){if($p)return Ko;$p=1;const{iterableCurry:t}=_t();function*e(s,n){if(n===0)return;let i=0;for(const o of s)if(yield o,++i===n)break}Ko.__take=e;const r=t(e);return Ko.take=r,Ko}var mc,Hp;function P_(){return Hp||(Hp=1,mc=b_().first),mc}var E_=P_();const Cx=Qe(E_);var gc,Gp;function T_(){return Gp||(Gp=1,gc=V_().isEmpty),gc}var M_=T_();const Wp=Qe(M_);var Ac,Yp;function R_(){return Yp||(Yp=1,Ac=q_().objectEntries),Ac}var I_=R_();const Sd=Qe(I_);var yc,Qp;function j_(){return Qp||(Qp=1,yc=w_().objectKeys),yc}var O_=j_();const Px=Qe(O_);var xc,Kp;function N_(){return Kp||(Kp=1,xc=v_().objectValues),xc}var z_=N_();const jr=Qe(z_);var bc,Xp;function B_(){return Xp||(Xp=1,bc=__().range),bc}var D_=B_();const Ex=Qe(D_);var Vc,Jp;function F_(){return Jp||(Jp=1,Vc=S_().roundRobin),Vc}var L_=F_();const U_=Qe(L_);var qc,Zp;function $_(){return Zp||(Zp=1,qc=k_().size),qc}var H_=$_();const Zu=Qe(H_);var wc,em;function G_(){return em||(em=1,wc=C_().take),wc}var W_=G_();const Y_=Qe(W_),Fe=t=>t[Symbol.iterator](),wo=Object.entries,Tx=Sd,Mx=Object.keys,Rx=Px,Q_=Object.fromEntries,Ln=Object.fromEntries,kd=(t,e)=>{const s=Fe(Tx(t)).map(e).filter(n=>n!==void 0);return Q_(s)},Ix={presses:Ln(wx.map(t=>[t,{keys:[],gamepadButtons:[]}])),axes:{x:[],y:[],xLook:[],yLook:[]},radialAxes:{xy:[]}},Xo=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Os(...t){const e=new Set,r=new Set,s=new Set,n=new Set;return t.reduceRight((i,o)=>{const a=new Set(e),l=new Set(r),c=new Set(s),u=new Set(n);for(const p of wx){const m=o?.presses?.[p]?.keys??[],A=o?.presses?.[p]?.gamepadButtons??[],g=m.filter(V=>!a.has(V)),y=A.filter(V=>!l.has(V));i.presses[p]={keys:Xo(i.presses[p]?.keys,g),gamepadButtons:Xo(i.presses[p]?.gamepadButtons,y)};for(const V of m)e.add(V);for(const V of A)r.add(V)}for(const p of["x","y","xLook","yLook"]){const m=o.axes?.[p]??[],A=m.filter(g=>!c.has(g));i.axes[p]=Xo(i.axes[p],A);for(const g of m)s.add(g)}const h=o.radialAxes?.xy??[],f=h.filter(p=>!u.has(p));i.radialAxes&&(i.radialAxes.xy=Xo(i.radialAxes.xy,f));for(const p of h)n.add(p);return i},structuredClone(Ix))}const Un={buttons:{dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,lPress:10,rPress:11},axes:{lStickX:0,lStickY:1,rStickX:2,rStickY:3},radialAxes:{}},K_={buttons:{a:0,b:1,x:3,y:4,lb:6,lt:8,rb:7,rt:9,select:10,start:11,l3:2,r3:5},axes:{lStickX:0,lStickY:1,rStickX:2,rStickY:5},radialAxes:{xy:9}},tm=kd(Un.buttons,([t,e])=>[e,t]),X_={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},Ds={directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},Ot={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},Ns={presses:{right:{keys:["ArrowRight"]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},jump:{keys:[" ","`","Z","\\"]},carry:{keys:["Shift","`","Z","\\"]},fire:{keys:["D"]},swop:{keys:["Enter"]},"swop.head":{keys:["[","A"]},"swop.heels":{keys:["]","S"]},hold:{keys:["P"]},map:{keys:["M","Tab"]},menu_openOrExit:{keys:["Escape",""]},menu_select:{keys:["Enter"]},toggleCrtFilter:{keys:["F8","T"]},toggleShowFps:{keys:["F9"]},toggleColourisation:{keys:["F10"]},cycleResolution:{keys:["0"]},pageDown:{keys:["PageDown"]},pageUp:{keys:["PageUp"]},home:{keys:["Home"]},end:{keys:["End"]}}},$n=({buttons:t,axes:e,radialAxes:r})=>{const s=n=>n!==void 0;return{presses:{right:{gamepadButtons:[t.dPadRight].filter(s)},towards:{gamepadButtons:[t.dPadDown].filter(s)},left:{gamepadButtons:[t.dPadLeft].filter(s)},away:{gamepadButtons:[t.dPadUp].filter(s)},jump:{gamepadButtons:[t.a,t.y].filter(s)},carry:{gamepadButtons:[t.x,t.y].filter(s)},fire:{gamepadButtons:[t.b].filter(s)},lookShift:{gamepadButtons:[t.rb].filter(s)},"swop.head":{gamepadButtons:[t.lt].filter(s)},"swop.heels":{gamepadButtons:[t.rt].filter(s)},hold:{gamepadButtons:[t.start].filter(s)},menu_select:{gamepadButtons:[t.a].filter(s)},menu_exit:{gamepadButtons:[t.b].filter(s)},menu_openOrExit:{gamepadButtons:[t.select].filter(s)},map:{gamepadButtons:[t.lb].filter(s)},toggleCrtFilter:{gamepadButtons:[t.l3].filter(s)},toggleShowFps:{gamepadButtons:[t.r3].filter(s)}},axes:{x:[e.lStickX].filter(s),y:[e.lStickY].filter(s),xLook:[e.rStickX].filter(s),yLook:[e.rStickY].filter(s)},radialAxes:{xy:[r.xy].filter(s)}}},J_={inputAssignment:Os(Ns,$n(Un),{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"Closely matches the ZX Spectrum original game's keys"},Z_={inputAssignment:Os(Ns,$n(Un),{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"Closely matches Amiga version keys - heavy on the F-keys"},eS={inputAssignment:Os(Ns,$n(Un),{presses:{lookUp:{keys:["I"]},lookDown:{keys:["K"]},lookLeft:{keys:["J"]},lookRight:{keys:["L"]},lookShift:{keys:["C"]}}}),description:"Combined key and joystick/gamepad assignment, should work on most setups"},tS={inputAssignment:Os(Ns,$n(Un),{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},rS={inputAssignment:Os(Ns,$n(Un),{presses:{right:{keys:[Ot.dPadRight]},towards:{keys:[Ot.dPadDown]},left:{keys:[Ot.dPadLeft]},away:{keys:[Ot.dPadUp]},jump:{keys:[Ot.a,Ot.y]},carry:{keys:[Ot.b,Ot.y]},fire:{keys:[Ot.x]},swop:{keys:[Ot.rb]},hold:{keys:[Ot.start]},menu_openOrExit:{keys:[Ot.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that dont support controllers"},sS={inputAssignment:Os(Ns,$n(K_)),description:"8Bitdo Ultimate 2c Wired reports in a non-standard way on some systems - use this if you have this controller and it doesn't work as expected"},nS=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]},lookShift:{keys:[t.buttons[5]]}}}),iS={inputAssignment:Os(Ix,Ns,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},nS(X_),{presses:{lookDown:{keys:[Ds.directions.down]},lookLeft:{keys:[Ds.directions.left]},lookRight:{keys:[Ds.directions.right]},lookUp:{keys:[Ds.directions.up]},"swop.head":{keys:[Ds.buttons[0]]},"swop.heels":{keys:[Ds.buttons[1]]}}}),description:"Arcade-style control panels"},wn={Default:eS,"ZX Spec":J_,Amiga:Z_,MAME:iS,WASD:tS," 8b kbd":rS," 8b U2c":sS},Cd=()=>Kt().get("campaignName")?.startsWith("data:");var Ce=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(Ce||{});const eh=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Jo=(t,e)=>eh(t).priority??e,Or={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(eh).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(eh).forEach(e=>{e.type.forEach(r=>{const s=this._addHandlers,n=this._queue;s[r]?s[r]?.(e):(n[r]=n[r]||[],n[r]?.push(e))})}),this},handle(t,e,r){const s=this._addHandlers,n=this._removeHandlers;if(s[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,n[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,s=>{e.findIndex(i=>i.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((i,o)=>Jo(o.value,r)-Jo(i.value,r)))},s=>{const n=e.findIndex(i=>i.name===s.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,r=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((n,i)=>Jo(i,r)-Jo(n,r)))},s=>{const n=e.indexOf(s.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},oS={extension:{type:Ce.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await sr(()=>import("./browserAll-wZKcmVtX.js"),__vite__mapDeps([0,1,2,3,4,5,6]))}},aS={extension:{type:Ce.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await sr(()=>import("./webworkerAll-B7SBID59.js"),__vite__mapDeps([1,2,3,4,5,6]))}};class st{constructor(e,r,s){this._x=r||0,this._y=s||0,this._observer=e}clone(e){return new st(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var vc={exports:{}},rm;function lS(){return rm||(rm=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new n(u,h||l,f),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,p=h.length,m=new Array(p);f<p;f++)m[f]=h[f].fn;return m},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,f,p,m){var A=r?r+c:c;if(!this._events[A])return!1;var g=this._events[A],y=arguments.length,V,x;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,f),!0;case 5:return g.fn.call(g.context,u,h,f,p),!0;case 6:return g.fn.call(g.context,u,h,f,p,m),!0}for(x=1,V=new Array(y-1);x<y;x++)V[x-1]=arguments[x];g.fn.apply(g.context,V)}else{var b=g.length,w;for(x=0;x<b;x++)switch(g[x].once&&this.removeListener(c,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,u);break;case 3:g[x].fn.call(g[x].context,u,h);break;case 4:g[x].fn.call(g[x].context,u,h,f);break;default:if(!V)for(w=1,V=new Array(y-1);w<y;w++)V[w-1]=arguments[w];g[x].fn.apply(g[x].context,V)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,f){var p=r?r+c:c;if(!this._events[p])return this;if(!u)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===u&&(!f||m.once)&&(!h||m.context===h)&&o(this,p);else{for(var A=0,g=[],y=m.length;A<y;A++)(m[A].fn!==u||f&&!m[A].once||h&&m[A].context!==h)&&g.push(m[A]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(vc)),vc.exports}var cS=lS();const ss=Qe(cS),uS=Math.PI*2,hS=180/Math.PI,dS=Math.PI/180;class lt{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new lt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return _c.x=0,_c.y=0,_c}}const _c=new lt;class de{constructor(e=1,r=0,s=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,s,n,i,o){return this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,r){r=r||new lt;const s=e.x,n=e.y;return r.x=this.a*s+this.c*n+this.tx,r.y=this.b*s+this.d*n+this.ty,r}applyInverse(e,r){r=r||new lt;const s=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(s*o+i*-n),u=e.x,h=e.y;return r.x=o*c*u+-i*c*h+(l*i-a*o)*c,r.y=s*c*h+-n*c*u+(-l*s+a*n)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*r-this.b*s,this.b=n*s+this.b*r,this.c=i*r-this.d*s,this.d=i*s+this.d*r,this.tx=o*r-this.ty*s,this.ty=o*s+this.ty*r,this}append(e){const r=this.a,s=this.b,n=this.c,i=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*s+e.b*i,this.c=e.c*r+e.d*n,this.d=e.c*s+e.d*i,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*i+this.ty,this}appendFrom(e,r){const s=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,f=r.d;return this.a=s*c+n*h,this.b=s*u+n*f,this.c=i*c+o*h,this.d=i*u+o*f,this.tx=a*c+l*h+r.tx,this.ty=a*u+l*f+r.ty,this}setTransform(e,r,s,n,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(s*this.a+n*this.c),this.ty=r-(s*this.b+n*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,s=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),l=Math.atan2(s,r),c=Math.abs(a+l);return c<1e-5||Math.abs(uS-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+s*s),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*r+o.y*n),e.position.y=this.ty+(o.x*s+o.y*i),e}invert(){const e=this.a,r=this.b,s=this.c,n=this.d,i=this.tx,o=e*n-r*s;return this.a=n/o,this.b=-r/o,this.c=-s/o,this.d=e/o,this.tx=(s*this.ty-n*i)/o,this.ty=-(e*this.ty-r*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new de;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return pS.identity()}static get shared(){return fS.identity()}}const fS=new de,pS=new de,ps=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ms=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],gs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],As=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],th=[],jx=[],Zo=Math.sign;function mS(){for(let t=0;t<16;t++){const e=[];th.push(e);for(let r=0;r<16;r++){const s=Zo(ps[t]*ps[r]+gs[t]*ms[r]),n=Zo(ms[t]*ps[r]+As[t]*ms[r]),i=Zo(ps[t]*gs[r]+gs[t]*As[r]),o=Zo(ms[t]*gs[r]+As[t]*As[r]);for(let a=0;a<16;a++)if(ps[a]===s&&ms[a]===n&&gs[a]===i&&As[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new de;e.set(ps[t],ms[t],gs[t],As[t],0,0),jx.push(e)}}mS();const be={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>ps[t],uY:t=>ms[t],vX:t=>gs[t],vY:t=>As[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>th[t][e],sub:(t,e)=>th[t][be.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?be.S:be.N:Math.abs(e)*2<=Math.abs(t)?t>0?be.E:be.W:e>0?t>0?be.SE:be.SW:t>0?be.NE:be.NW,matrixAppendRotationInv:(t,e,r=0,s=0)=>{const n=jx[be.inv(e)];n.tx=r,n.ty=s,t.append(n)},transformRectCoords:(t,e,r,s)=>{const{x:n,y:i,width:o,height:a}=t,{x:l,y:c,width:u,height:h}=e;return r===be.E?(s.set(n+l,i+c,o,a),s):r===be.S?s.set(u-i-a+l,n+c,a,o):r===be.W?s.set(u-n-o+l,h-i-a+c,o,a):r===be.N?s.set(i+l,h-n-o+c,a,o):s.set(n+l,i+c,o,a)}},ea=[new lt,new lt,new lt,new lt];class We{constructor(e=0,r=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new We(0,0,0,0)}clone(){return new We(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,s,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=s*(1-n),u=s-c,h=a-c,f=a+i+c,p=l-c,m=l+o+c,A=a+u,g=a+i-u,y=l+u,V=l+o-u;return e>=h&&e<=f&&r>=p&&r<=m&&!(e>A&&e<g&&r>y&&r<V)}intersects(e,r){if(!r){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}const s=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=s||o<=i)return!1;const a=ea[0].set(e.left,e.top),l=ea[1].set(e.left,e.bottom),c=ea[2].set(e.right,e.top),u=ea[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=s||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const f=h*(l.y-a.y),p=h*(a.x-l.x),m=f*s+p*i,A=f*n+p*i,g=f*s+p*o,y=f*n+p*o;if(Math.max(m,A,g,y)<=f*a.x+p*a.y||Math.min(m,A,g,y)>=f*u.x+p*u.y)return!1;const V=h*(a.y-c.y),x=h*(c.x-a.x),b=V*s+x*i,w=V*n+x*i,_=V*s+x*o,q=V*n+x*o;return!(Math.max(b,w,_,q)<=V*a.x+x*a.y||Math.min(b,w,_,q)>=V*u.x+x*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(s-r,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,r=.001){const s=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=s-this.x,this.height=n-this.y,this}scale(e,r=e){return this.x*=e,this.y*=r,this.width*=e,this.height*=r,this}enlarge(e){const r=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=s-r,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new We),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,s=e.y,n=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(e,r,s,n){return this.x=e,this.y=r,this.width=s,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Sc={default:-1};function De(t="default"){return Sc[t]===void 0&&(Sc[t]=-1),++Sc[t]}const sm=new Set,nt="8.0.0",gS="8.3.4",dn={quiet:!1,noColor:!1},ve=(t,e,r=3)=>{if(dn.quiet||sm.has(e))return;let s=new Error().stack;const n=`${e}
Deprecated since v${t}`,i=typeof console.groupCollapsed=="function"&&!dn.noColor;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",n):(s=s.split(`
`).splice(r).join(`
`),i?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",n),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",n),console.warn(s))),sm.add(e)};Object.defineProperties(ve,{quiet:{get:()=>dn.quiet,set:t=>{dn.quiet=t},enumerable:!0,configurable:!1},noColor:{get:()=>dn.noColor,set:t=>{dn.noColor=t},enumerable:!0,configurable:!1}});const Ox=()=>{};function nm(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function im(t){return!(t&t-1)&&!!t}function Nx(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const om=Object.create(null);function AS(t){const e=om[t];return e===void 0&&(om[t]=De("resource")),e}const zx=class Bx extends ss{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...Bx.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){ve(nt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this._sharedResourceId=null,this.emit("change",this)}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=AS(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};zx.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Dx=zx;const Fx=class Lx extends ss{constructor(e={}){super(),this.options=e,this._gpuData=Object.create(null),this._gcLastUsed=-1,this.uid=De("textureSource"),this._resourceType="textureSource",this._resourceId=De("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...Lx.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new Dx(Nx(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=De("resource"),this.emit("change",this),this.emit("unload",this);for(const e in this._gpuData)this._gpuData[e]?.destroy?.();this._gpuData=Object.create(null)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,s){s||(s=this._resolution),e||(e=this.width),r||(r=this.height);const n=Math.round(e*s),i=Math.round(r*s);return this.width=n/s,this.height=i/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=De("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=im(this.pixelWidth)&&im(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};Fx.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Ht=Fx;class Pd extends Ht{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(r instanceof Float32Array?s="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?s="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?s="rgba16uint":(r instanceof Int8Array,s="bgra8unorm")),super({...e,resource:r,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}Pd.extension=Ce.TextureSource;const am=new de;class yS{constructor(e,r){this.mapCoord=new de,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];r[n]=i*s.a+o*s.c+s.tx,r[n+1]=i*s.b+o*s.d+s.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(am.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(am));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class Ae extends ss{constructor({source:e,label:r,frame:s,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=De("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new We,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new Ht,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new yS(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:s,height:n}=this._source,i=r.x/s,o=r.y/n,a=r.width/s,l=r.height/n;let c=this.rotate;if(c){const u=a/2,h=l/2,f=i+u,p=o+h;c=be.add(c,be.NW),e.x0=f+u*be.uX(c),e.y0=p+h*be.uY(c),c=be.add(c,2),e.x1=f+u*be.uX(c),e.y1=p+h*be.uY(c),c=be.add(c,2),e.x2=f+u*be.uX(c),e.y2=p+h*be.uY(c),c=be.add(c,2),e.x3=f+u*be.uX(c),e.y3=p+h*be.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ve(nt,"Texture.baseTexture is now Texture.source"),this._source}}Ae.EMPTY=new Ae({label:"EMPTY",source:new Ht({label:"EMPTY"})});Ae.EMPTY.destroy=Ox;Ae.WHITE=new Ae({source:new Pd({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ae.WHITE.destroy=Ox;function xS(t,e,r){const{width:s,height:n}=r.orig,i=r.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*s,t.maxX=t.minX+o,t.minY=i.y-e._y*n,t.maxY=t.minY+a}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*n,t.maxY=t.minY+n}const lm=new de;class er{constructor(e=1/0,r=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=lm,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new We);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=lm,this}set(e,r,s,n){this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(e,r,s,n,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let f=this.minX,p=this.minY,m=this.maxX,A=this.maxY,g=o*e+l*r+u,y=a*e+c*r+h;g<f&&(f=g),y<p&&(p=y),g>m&&(m=g),y>A&&(A=y),g=o*s+l*r+u,y=a*s+c*r+h,g<f&&(f=g),y<p&&(p=y),g>m&&(m=g),y>A&&(A=y),g=o*e+l*n+u,y=a*e+c*n+h,g<f&&(f=g),y<p&&(p=y),g>m&&(m=g),y>A&&(A=y),g=o*s+l*n+u,y=a*s+c*n+h,g<f&&(f=g),y<p&&(p=y),g>m&&(m=g),y>A&&(A=y),this.minX=f,this.minY=p,this.maxX=m,this.maxY=A}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,s=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let f=o*r+l*s+u,p=a*r+c*s+h;this.minX=f,this.minY=p,this.maxX=f,this.maxY=p,f=o*n+l*s+u,p=a*n+c*s+h,this.minX=f<this.minX?f:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=p>this.maxY?p:this.maxY,f=o*r+l*i+u,p=a*r+c*i+h,this.minX=f<this.minX?f:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=p>this.maxY?p:this.maxY,f=o*n+l*i+u,p=a*n+c*i+h,this.minX=f<this.minX?f:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=p>this.maxY?p:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,s,n){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new er(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,s,n){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,f=n.d,p=n.tx,m=n.ty;for(let A=r;A<s;A+=2){const g=e[A],y=e[A+1],V=c*g+h*y+p,x=u*g+f*y+m;i=V<i?V:i,o=x<o?x:o,a=V>a?V:a,l=x>l?x:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var bS={grad:.9,turn:360,rad:360/(2*Math.PI)},br=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},He=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Dt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},Ux=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},cm=function(t){return{r:Dt(t.r,0,255),g:Dt(t.g,0,255),b:Dt(t.b,0,255),a:Dt(t.a)}},kc=function(t){return{r:He(t.r),g:He(t.g),b:He(t.b),a:He(t.a,3)}},VS=/^#([0-9a-f]{3,8})$/i,ta=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},$x=function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=Math.max(e,r,s),o=i-Math.min(e,r,s),a=o?i===e?(r-s)/o:i===r?2+(s-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},Hx=function(t){var e=t.h,r=t.s,s=t.v,n=t.a;e=e/360*6,r/=100,s/=100;var i=Math.floor(e),o=s*(1-r),a=s*(1-(e-i)*r),l=s*(1-(1-e+i)*r),c=i%6;return{r:255*[s,a,o,o,l,s][c],g:255*[l,s,s,a,o,o][c],b:255*[o,o,l,s,s,a][c],a:n}},um=function(t){return{h:Ux(t.h),s:Dt(t.s,0,100),l:Dt(t.l,0,100),a:Dt(t.a)}},hm=function(t){return{h:He(t.h),s:He(t.s),l:He(t.l),a:He(t.a,3)}},dm=function(t){return Hx((r=(e=t).s,{h:e.h,s:(r*=((s=e.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:e.a}));var e,r,s},ji=function(t){return{h:(e=$x(t)).h,s:(n=(200-(r=e.s))*(s=e.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,s,n},qS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,wS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_S=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rh={string:[[function(t){var e=VS.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?He(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?He(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=vS.exec(t)||_S.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:cm({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=qS.exec(t)||wS.exec(t);if(!e)return null;var r,s,n=um({h:(r=e[1],s=e[2],s===void 0&&(s="deg"),Number(r)*(bS[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return dm(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=n===void 0?1:n;return br(e)&&br(r)&&br(s)?cm({r:Number(e),g:Number(r),b:Number(s),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,s=t.l,n=t.a,i=n===void 0?1:n;if(!br(e)||!br(r)||!br(s))return null;var o=um({h:Number(e),s:Number(r),l:Number(s),a:Number(i)});return dm(o)},"hsl"],[function(t){var e=t.h,r=t.s,s=t.v,n=t.a,i=n===void 0?1:n;if(!br(e)||!br(r)||!br(s))return null;var o=(function(a){return{h:Ux(a.h),s:Dt(a.s,0,100),v:Dt(a.v,0,100),a:Dt(a.a)}})({h:Number(e),s:Number(r),v:Number(s),a:Number(i)});return Hx(o)},"hsv"]]},fm=function(t,e){for(var r=0;r<e.length;r++){var s=e[r][0](t);if(s)return[s,e[r][1]]}return[null,void 0]},SS=function(t){return typeof t=="string"?fm(t.trim(),rh.string):typeof t=="object"&&t!==null?fm(t,rh.object):[null,void 0]},Cc=function(t,e){var r=ji(t);return{h:r.h,s:Dt(r.s+100*e,0,100),l:r.l,a:r.a}},Pc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},pm=function(t,e){var r=ji(t);return{h:r.h,s:r.s,l:Dt(r.l+100*e,0,100),a:r.a}},sh=(function(){function t(e){this.parsed=SS(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return He(Pc(this.rgba),2)},t.prototype.isDark=function(){return Pc(this.rgba)<.5},t.prototype.isLight=function(){return Pc(this.rgba)>=.5},t.prototype.toHex=function(){return e=kc(this.rgba),r=e.r,s=e.g,n=e.b,o=(i=e.a)<1?ta(He(255*i)):"","#"+ta(r)+ta(s)+ta(n)+o;var e,r,s,n,i,o},t.prototype.toRgb=function(){return kc(this.rgba)},t.prototype.toRgbString=function(){return e=kc(this.rgba),r=e.r,s=e.g,n=e.b,(i=e.a)<1?"rgba("+r+", "+s+", "+n+", "+i+")":"rgb("+r+", "+s+", "+n+")";var e,r,s,n,i},t.prototype.toHsl=function(){return hm(ji(this.rgba))},t.prototype.toHslString=function(){return e=hm(ji(this.rgba)),r=e.h,s=e.s,n=e.l,(i=e.a)<1?"hsla("+r+", "+s+"%, "+n+"%, "+i+")":"hsl("+r+", "+s+"%, "+n+"%)";var e,r,s,n,i},t.prototype.toHsv=function(){return e=$x(this.rgba),{h:He(e.h),s:He(e.s),v:He(e.v),a:He(e.a,3)};var e},t.prototype.invert=function(){return lr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),lr(Cc(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),lr(Cc(this.rgba,-e))},t.prototype.grayscale=function(){return lr(Cc(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),lr(pm(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),lr(pm(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?lr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):He(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=ji(this.rgba);return typeof e=="number"?lr({h:e,s:r.s,l:r.l,a:r.a}):He(r.h)},t.prototype.isEqual=function(e){return this.toHex()===lr(e).toHex()},t})(),lr=function(t){return t instanceof sh?t:new sh(t)},mm=[],kS=function(t){t.forEach(function(e){mm.indexOf(e)<0&&(e(sh,rh),mm.push(e))})};function CS(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in r)s[r[n]]=n;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=s[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,f="black";if(!i.length)for(var p in r)i[p]=new t(r[p]).toRgb();for(var m in r){var A=(a=u,l=i[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<h&&(h=A,f=m)}return f}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}kS([CS]);const vn=class qi{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof qi)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const s=typeof e;if(s!==typeof r)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,o)=>i===r[o]);if(e!==null&&r!==null){const i=Object.keys(e),o=Object.keys(r);return i.length!==o.length?!1:i.every(a=>e[a]===r[a])}return e===r}toRgba(){const[e,r,s,n]=this._components;return{r:e,g:r,b:s,a:n}}toRgb(){const[e,r,s]=this._components;return{r:e,g:r,b:s}}toRgbaString(){const[e,r,s]=this.toUint8RgbArray();return`rgba(${e},${r},${s},${this.alpha})`}toUint8RgbArray(e){const[r,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(s*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,s,n,i]=this._components;return e[0]=r,e[1]=s,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,s,n]=this._components;return e[0]=r,e[1]=s,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,r,s]=this.toUint8RgbArray();return(s<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,s,n,i]=qi._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=s,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return r&&(s=s*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,s,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,s=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,s,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,s,n,i=255]=e,r/=255,s/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=qi.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=lr(e);o.isValid()&&({r,g:s,b:n,a:i}=o.rgba,r/=255,s/=255,n/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=s,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,s]=this._components;this._int=(e*255<<16)+(r*255<<8)+(s*255|0)}_clamp(e,r=0,s=1){return typeof e=="number"?Math.min(Math.max(e,r),s):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,r),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof qi||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};vn.shared=new vn;vn._temp=new vn;vn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ve=vn;const PS={cullArea:null,cullable:!1,cullableChildren:!0};let Ec=0;const gm=500;function Rt(...t){Ec!==gm&&(Ec++,Ec===gm?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}const Ed={_registeredResources:new Set,register(t){this._registeredResources.add(t)},unregister(t){this._registeredResources.delete(t)},release(){this._registeredResources.forEach(t=>t.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(t){return this._registeredResources.has(t)},reset(){this._registeredResources.clear()}};class ES{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:(r=new this._classType,this._count++),r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class TS{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new ES(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const s=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[s]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const $t=new TS;Ed.register($t);const MS={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){ve("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function RS(t,e,r){const s=t.length;let n;if(e>=s||r===0)return;r=e+r>s?s-e:r;const i=s-r;for(n=e;n<i;++n)t[n]=t[n+r];t.length=i}const IS={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,s=r-t,n=[];if(s>0&&s<=r){for(let o=r-1;o>=t;o--){const a=this.children[o];a&&(n.push(a),a.parent=null)}RS(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let o=0;o<n.length;++o){const a=n[o];a.parentRenderLayer?.detach(a),this.emit("childRemoved",a,this,o),n[o].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(s===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||ve(nt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),r.prepend(s),t.setFromMatrix(r),t},replaceChild(t,e){t.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(t)),e.setFromMatrix(t.localTransform),e.updateLocalTransform(),this.removeChild(t)}},jS={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const s=this.children,n=s.length;for(let i=0;i<n;i++)s[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:s}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];s[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];s[i.pipe].pop(i,this,t)}}};class Am{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class OS{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const s=this._tests[r];if(s.test(e))return $t.get(s.maskClass,e)}return e}returnMaskEffect(e){$t.return(e)}}const nh=new OS;Or.handleByList(Ce.MaskEffect,nh._effectClasses);const NS={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,s)=>r.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),nh.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=nh.getMaskEffect(t),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Am);t=t;const r=t?.length>0,s=e.filters?.length>0,n=r!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Am),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},zS={label:null,get name(){return ve(nt,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){ve(nt,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let s=0;s<r.length;s++){const n=r[s];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let s=0;s<r.length;s++){const i=r[s].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const s=this.children;for(let n=0;n<s.length;n++){const i=s[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let n=0;n<s.length;n++)s[n].getChildrenByLabel(t,!0,r);return r}},ht=$t.getPool(de),Pr=$t.getPool(er),BS=new de,DS={getFastGlobalBounds(t,e){e||(e=new er),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(s=Pr.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;s.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,s,r)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,s.applyMatrix(o.worldTransform)),this.effects[a].addBounds(s,!0));i&&s.applyMatrix(o.worldTransform.copyTo(BS).invert()),e.addBounds(s),Pr.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Pr.return(s))}};function Gx(t,e,r){r.clear();let s,n;return t.parent?e?s=t.parent.worldTransform:(n=ht.get().identity(),s=Td(t,n)):s=de.IDENTITY,Wx(t,r,s,e),n&&ht.return(n),r.isValid||r.set(0,0,0,0),r}function Wx(t,e,r,s){if(!t.visible||!t.measurable)return;let n;s?n=t.worldTransform:(t.updateLocalTransform(),n=ht.get(),n.appendFrom(t.localTransform,r));const i=e,o=!!t.effects.length;if(o&&(e=Pr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{const a=t.bounds;a&&!a.isEmpty()&&(e.matrix=n,e.addBounds(a));for(let l=0;l<t.children.length;l++)Wx(t.children[l],e,n,s)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,de.IDENTITY),Pr.return(e)}s||ht.return(n)}function Td(t,e){const r=t.parent;return r&&(Td(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function Yx(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,s=t>>8&255,n=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=r*i/255|0,c=s*o/255|0,u=n*a/255|0;return(l<<16)+(c<<8)+u}const ym=16777215;function xm(t,e){return t===ym?e:e===ym?t:Yx(t,e)}function ja(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const FS={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t=new de,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=Td(this,ht.get().identity());return t.appendFrom(this.localTransform,r),ht.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?ja(this.renderGroup.worldColor):this.parentRenderGroup?ja(xm(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=xm(e,r.localColor),r=r.parent;return ja(e)}};function Qx(t,e,r){return e.clear(),r||(r=de.IDENTITY),Kx(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function Kx(t,e,r,s,n){let i;if(n)i=ht.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=ht.get(),i.appendFrom(l,r)}const o=e,a=!!t.effects.length;if(a&&(e=Pr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)Kx(l[c],e,i,s,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);o.addBounds(e,de.IDENTITY),Pr.return(e)}ht.return(i)}function Xx(t,e){const r=t.children;for(let s=0;s<r.length;s++){const n=r[s],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,n.children.length&&Xx(n,e)}return e.didChange}const LS=new de,US={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new er});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),Xx(this,t),t.didChange&&Qx(this,t.localBounds,LS),t.localBounds},getBounds(t,e){return Gx(this,t,e||new er)}},$S={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},HS={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(GS))}};function GS(t,e){return t._zIndex-e._zIndex}const WS={getGlobalPosition(t=new lt,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const s=this.getGlobalTransform(ht.get(),r);return e=s.apply(t,e),ht.return(s),e},toLocal(t,e,r,s){e&&(t=e.toGlobal(t,r,s));const n=this.getGlobalTransform(ht.get(),s);return r=n.applyInverse(t,r),ht.return(n),r}};class Jx{constructor(){this.uid=De("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let YS=0;class QS{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new Dx(this.textureOptions)}createTexture(e,r,s){const n=new Ht({...this.textureOptions,width:e,height:r,resolution:1,antialias:s,autoGarbageCollect:!1});return new Ae({source:n,label:`texturePool_${YS++}`})}getOptimalTexture(e,r,s=1,n){let i=Math.ceil(e*s-1e-6),o=Math.ceil(r*s-1e-6);i=nm(i),o=nm(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,n)),l.source._resolution=s,l.source.width=i/s,l.source.height=o/s,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,r=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,r)}returnTexture(e,r=!1){const s=this._poolKeyHash[e.uid];r&&(e.source.style=this.textureStyle),this._texturePool[s].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const s=this._texturePool[r];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const Zx=new QS;Ed.register(Zx);class KS{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new de,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Jx,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let s=0;s<r.length;s++){const n=r[s];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Zx.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let s=0;s<r.length;s++)this.addChild(r[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let s=0;s<r.length;s++)this.removeChild(r[s])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const s=e.children;for(let n=0;n<s.length;n++)this._getChildren(s[n],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new de),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new de),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new de),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function XS(t,e,r={}){for(const s in e)!r[s]&&e[s]!==void 0&&(t[s]=e[s])}const Tc=new st(null),ra=new st(null),Mc=new st(null,1,1),sa=new st(null),bm=1,JS=2,Rc=4;class Hn extends ss{constructor(e={}){super(),this.uid=De("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new de,this.relativeGroupTransform=new de,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new st(this,0,0),this._scale=Mc,this._pivot=ra,this._origin=sa,this._skew=Tc,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],XS(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){ve("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Or.mixin(Hn,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||ve(nt,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const r=e[0],s=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),s&&(s.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,s&&s.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const r=e[0],s=this.children.indexOf(r);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,s),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=$t.get(KS,this),this.groupTransform=de.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),$t.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new de),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*hS}set angle(e){this.rotation=e*dS}get pivot(){return this._pivot===ra&&(this._pivot=new st(this,0,0)),this._pivot}set pivot(e){this._pivot===ra&&(this._pivot=new st(this,0,0),this._origin!==sa&&Rt("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Tc&&(this._skew=new st(this,0,0)),this._skew}set skew(e){this._skew===Tc&&(this._skew=new st(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Mc&&(this._scale=new st(this,1,1)),this._scale}set scale(e){this._scale===Mc&&(this._scale=new st(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===sa&&(this._origin=new st(this,0,0)),this._origin}set origin(e){this._origin===sa&&(this._origin=new st(this,0,0),this._pivot!==ra&&Rt("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const s=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,s=this._scale,n=this._pivot,i=this._origin,o=this._position,a=s._x,l=s._y,c=n._x,u=n._y,h=-i._x,f=-i._y;r.a=this._cx*a,r.b=this._sx*a,r.c=this._cy*l,r.d=this._sy*l,r.tx=o._x-(c*r.a+u*r.c)+(h*r.a+f*r.c)-h,r.ty=o._y-(c*r.b+u*r.d)+(h*r.b+f*r.d)-f}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=bm,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=Ve.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=bm,this._onUpdate())}get tint(){return ja(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=JS,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rc,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rc,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Rc,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let n=0;n<r.length;++n)r[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Or.mixin(Hn,IS,DS,WS,$S,US,NS,zS,HS,PS,MS,FS,jS);class eb extends Hn{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this._bounds=new er(0,1,0,0),this._boundsDirty=!0,this.autoGarbageCollect=e.autoGarbageCollect??!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:s,y:n}=e;return s>=r.minX&&s<=r.maxX&&n>=r.minY&&n<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}unload(){this.emit("unload",this);for(const e in this._gpuData)this._gpuData[e]?.destroy();this._gpuData=Object.create(null),this.onViewUpdate()}destroy(e){this.unload(),super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,s){const{renderPipes:n}=r;n.blendMode.pushBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let l=0;l<a;l++)o[l].collectRenderables(e,r,s);n.blendMode.popBlendMode(e)}}class Ms extends eb{constructor(e=Ae.EMPTY){e instanceof Ae&&(e={texture:e});const{texture:r=Ae.EMPTY,anchor:s,roundPixels:n,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new st({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,r=!1){return e instanceof Ae?new Ms(e):new Ms(Ae.from(e,r))}set texture(e){e||(e=Ae.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return xS(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return ve("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,s=this._bounds,{width:n,height:i}=r.orig;s.minX=-e._x*n,s.maxX=s.minX+n,s.minY=-e._y*i,s.maxY=s.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const ZS=new er;function tb(t,e,r){const s=ZS;t.measurable=!0,Gx(t,r,s),e.addBoundsMask(s),t.measurable=!1}function rb(t,e,r){const s=Pr.get();t.measurable=!0;const n=ht.get().identity(),i=sb(t,r,n);Qx(t,s,i),t.measurable=!1,e.addBoundsMask(s),ht.return(n),Pr.return(s)}function sb(t,e,r){return t?(t!==e&&(sb(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(Rt("Mask bounds, renderable is not inside the root container"),r)}class nb{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Ms),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,r){this.inverse||tb(this.mask,e,r)}addLocalBounds(e,r){rb(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Ms}}nb.extension=Ce.MaskEffect;class ib{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}ib.extension=Ce.MaskEffect;class ob{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,r){tb(this.mask,e,r)}addLocalBounds(e,r){rb(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Hn}}ob.extension=Ce.MaskEffect;const ek={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let Vm=ek;const vo={get(){return Vm},set(t){Vm=t}};class ab extends Ht{constructor(e){e.resource||(e.resource=vo.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,s=this._resolution){const n=super.resize(e,r,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ab.extension=Ce.TextureSource;class el extends Ht{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}el.extension=Ce.TextureSource;var tl=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(tl||{});class Ic{constructor(e,r=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=s,this._once=n}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const lb=class Ct{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ic(null,null,1/0),this.deltaMS=1/Ct.targetFPMS,this.elapsedMS=1/Ct.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,s=tl.NORMAL){return this._addListener(new Ic(e,r,s))}addOnce(e,r,s=tl.NORMAL){return this._addListener(new Ic(e,r,s,!0))}_addListener(e){let r=this._head.next,s=this._head;if(!r)e.connect(s);else{for(;r;){if(e.priority>r.priority){e.connect(s);break}s=r,r=r.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,r){let s=this._head.next;for(;s;)s.match(e,r)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Ct.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,r)/1e3,Ct.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Ct._shared){const e=Ct._shared=new Ct;e.autoStart=!0,e._protected=!0}return Ct._shared}static get system(){if(!Ct._system){const e=Ct._system=new Ct;e.autoStart=!0,e._protected=!0}return Ct._system}};lb.targetFPMS=.06;let dt=lb,jc;async function tk(){return jc??(jc=(async()=>{const e=vo.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!r)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),jc}const Rl=class cb extends Ht{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...cb.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=dt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await tk(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(dt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(dt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(dt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Rl.extension=Ce.TextureSource;Rl.defaultOptions={...Ht.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Rl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let rk=Rl;const on=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||r?e(s):s):t);class sk{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||Rt(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const s=on(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(s,r);break}}const i=new Map(Object.entries(n||{}));n||s.forEach(l=>{i.set(l,r)});const o=[...i.keys()],a={cacheKeys:o,keys:s};s.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=n?n[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&Rt("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){Rt(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const an=new sk,ih=[];Or.handleByList(Ce.TextureSource,ih);function ub(t={}){const e=t&&t.resource,r=e?t.resource:t,s=e?t:{resource:t};for(let n=0;n<ih.length;n++){const i=ih[n];if(i.test(r))return new i(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function nk(t={},e=!1){const r=t&&t.resource,s=r?t.resource:t,n=r?t:{resource:t};if(!e&&an.has(s))return an.get(s);const i=new Ae({source:ub(n)});return i.on("destroy",()=>{an.has(s)&&an.remove(s)}),e||an.set(s,i),i}function ik(t,e=!1){return typeof t=="string"?an.get(t):t instanceof Ht?new Ae({source:t}):nk(t,e)}Ae.from=ik;Ht.from=ub;Or.add(nb,ib,ob,rk,el,ab,Pd);var hb=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(hb||{});function Wt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function ni(t){return t.split("?")[0].split("#")[0]}function ok(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ak(t,e,r){return t.replace(new RegExp(ok(e),"g"),r)}function lk(t,e){let r="",s=0,n=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",s=0):(r=r.slice(0,l),s=r.length-1-r.lastIndexOf("/")),n=a,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,n=a,i=0;continue}}}else r.length>0?r+=`/${t.slice(n+1,a)}`:r=t.slice(n+1,a),s=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}const Qi={toPosix(t){return ak(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Wt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(Wt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=ni(this.toPosix(e??vo.get().getBaseUrl())),n=ni(this.toPosix(r??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?Qi.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(Wt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=lk(t),t.length>0&&s&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Wt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const s=t[r];if(Wt(s),s.length>0)if(e===void 0)e=s;else{const n=t[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Wt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let s=-1,n=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){s=a;break}}else n=!1;return s===-1?r?"/":this.isUrl(o)?i+t:i:r&&s===1?"//":i+t.slice(0,s)},rootname(t){Wt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Wt(t),e&&Wt(e),t=ni(this.toPosix(t));let r=0,s=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){r=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(s=i):(o=-1,s=a))}return r===s?s=a:s===-1&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){r=i+1;break}}else s===-1&&(n=!1,s=i+1);return s===-1?"":t.slice(r,s)},extname(t){Wt(t),t=ni(this.toPosix(t));let e=-1,r=0,s=-1,n=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!n){r=o+1;break}continue}s===-1&&(n=!1,s=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||s===-1||i===0||i===1&&e===s-1&&e===r+1?"":t.slice(e,s)},parse(t){Wt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=ni(this.toPosix(t));let r=t.charCodeAt(0);const s=this.isAbsolute(t);let n;e.root=this.rootname(t),s||this.hasProtocol(t)?n=1:n=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&s?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&s?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function db(t,e,r,s,n){const i=e[r];for(let o=0;o<i.length;o++){const a=i[o];r<e.length-1?db(t.replace(s[r],a),e,r+1,s,n):n.push(t.replace(s[r],a))}}function ck(t){const e=/\{(.*?)\}/g,r=t.match(e),s=[];if(r){const n=[];r.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),db(t,n,0,r,s)}else s.push(t);return s}const qm=t=>!Array.isArray(t);class fb{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}getAlias(e){const{alias:r,src:s}=e;return on(r||s,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&Rt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const s=[];let n=r;Array.isArray(r)||(n=Object.entries(r).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);s.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));s.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=s}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let s;s=i=>{this.hasKey(i)&&Rt(`[Resolver] already has key: ${i} overwriting`)},on(r).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c,parser:u}=i;const h=on(o).map(A=>typeof A=="string"?ck(A):Array.isArray(A)?A:[A]),f=this.getAlias(i);Array.isArray(f)?f.forEach(s):s(f);const p=[],m=A=>({...this._parsers.find(y=>y.test(A))?.parse(A),src:A});h.forEach(A=>{A.forEach(g=>{let y={};if(typeof g!="object"?y=m(g):(a=g.data??a,l=g.format??l,(g.loadParser||g.parser)&&(c=g.loadParser??c,u=g.parser??u),y={...m(g.src),...g}),!f)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:f,data:a,format:l,loadParser:c,parser:u,progressSize:i.progressSize}),p.push(y)})}),f.forEach(A=>{this._assetMap[A]=p})})}resolveBundle(e){const r=qm(e);e=on(e);const s={};return e.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(n,l)]=c}s[n]=a}}),r?s[e[0]]:s}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const s={};for(const n in r)s[n]=r[n].src;return s}return r.src}resolve(e){const r=qm(e);e=on(e);const s={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),r?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const s=e[r],n=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:s,data:n,loadParser:i,parser:o,format:a,progressSize:l}=r;return(this._basePath||this._rootPath)&&(e.src=Qi.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.parser=o??e.parser,e.format=a??e.format??uk(e.src),l!==void 0&&(e.progressSize=l),e}}fb.RETINA_PREFIX=/@([0-9\.]+)x/;function uk(t){return t.split(".").pop().split("?").shift().split("#").shift()}const wm=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},pb=class wi{constructor(e,r){this.linkedSheets=[];let s=e;e?.source instanceof Ht&&(s={texture:e,data:r});const{texture:n,data:i,cachePrefix:o=""}=s;this.cachePrefix=o,this._texture=n instanceof Ae?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=wi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}parseSync(){return this._processFrames(0,!0),this._processAnimations(),this.textures}_processFrames(e,r=!1){let s=e;const n=r?1/0:wi.BATCH_SIZE;for(;s-e<n&&s<this._frameKeys.length;){const i=this._frameKeys[s],o=this._frames[i],a=o.frame;if(a){let l=null,c=null;const u=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,h=new We(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);o.rotated?l=new We(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):l=new We(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(c=new We(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new Ae({source:this.textureSource,frame:l,orig:h,trim:c,rotate:o.rotated?2:0,defaultAnchor:o.anchor,defaultBorders:o.borders,label:i.toString()})}s++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let s=0;s<e[r].length;s++){const n=e[r][s];this.animations[r].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*wi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*wi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};pb.BATCH_SIZE=1e3;let oh=pb;const hk=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function mb(t,e,r){const s={};if(t.forEach(n=>{s[n]=e}),Object.keys(e.textures).forEach(n=>{s[`${e.cachePrefix}${n}`]=e.textures[n]}),!r){const n=Qi.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=mb([`${n}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(s,a)})}return s}const dk={extension:Ce.Asset,cache:{test:t=>t instanceof oh,getCacheableAssets:(t,e)=>mb(t,e,!1)},resolver:{extension:{type:Ce.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),s=r.pop(),n=r.pop();return s==="json"&&hk.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(fb.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:Ce.LoadParser,priority:hb.Normal,name:"spritesheetLoader"},async testParse(t,e){return Qi.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:s,imageFilename:n,textureOptions:i,cachePrefix:o}=e?.data??{};let a=Qi.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(s instanceof Ae)l=s;else{const h=wm(a+(n??t.meta.image),e.src);l=(await r.load([{src:h,data:i}]))[h]}const c=new oh({texture:l.source,data:t,cachePrefix:o});await c.parse();const u=t?.meta?.related_multi_packs;if(Array.isArray(u)){const h=[];for(const p of u){if(typeof p!="string")continue;let m=a+p;e.data?.ignoreMultiPack||(m=wm(m,e.src),h.push(r.load({src:m,data:{textureOptions:i,ignoreMultiPack:!0}})))}const f=await Promise.all(h);c.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[c].concat(c.linkedSheets.filter(m=>m!==p))})}return c},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};Or.add(dk);const Oc=Object.create(null),vm=Object.create(null);function Md(t,e){let r=vm[t];return r===void 0&&(Oc[e]===void 0&&(Oc[e]=1),vm[t]=r=Oc[e]++),r}let na;function gb(){return(!na||na?.isContextLost())&&(na=vo.get().createCanvas().getContext("webgl",{})),na}let ia;function fk(){if(!ia){ia="mediump";const t=gb();t&&t.getShaderPrecisionFormat&&(ia=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return ia}function pk(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function mk(t,e,r){const s=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&s!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function gk(t,e){return e?`#version 300 es
${t}`:t}const Ak={},yk={};function xk(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const s=r?Ak:yk;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function bk(t,e){return e?t.replace("#version 300 es",""):t}const Nc={stripVersion:bk,ensurePrecision:mk,addProgramDefines:pk,setProgramName:xk,insertVersion:gk},ii=Object.create(null),Ab=class ah{constructor(e){e={...ah.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:fk()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let n=e.fragment,i=e.vertex;Object.keys(Nc).forEach(o=>{const a=s[o];n=Nc[o](n,a,!0),i=Nc[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=Md(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,ii[this._cacheKey]=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return ii[r]||(ii[r]=new ah(e),ii[r]._cacheKey=r),ii[r]}};Ab.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Il=Ab;const _m={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Vk(t){return _m[t]??_m.float32}const qk={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function wk({source:t,entryPoint:e}){const r={},s=t.indexOf(`fn ${e}`);if(s!==-1){const n=t.indexOf("->",s);if(n!==-1){const i=t.substring(s,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=qk[a[3]]??"float32";r[a[2]]={location:parseInt(a[1],10),format:l,stride:Vk(l).stride,offset:0,instance:!1,start:0}}}}return r}function zc(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const f=h.match(l)[1],p=h.match(a).reduce((m,A)=>{const[g,y]=A.split(":");return m[g.trim()]=y.trim(),m},{});return p?{name:f,members:p}:null}).filter(({name:h})=>c.some(f=>f.type===h))??[];return{groups:c,structs:u}}var vi=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(vi||{});function vk({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:vi.VERTEX|vi.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:vi.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:vi.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function _k({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function Sk(t,e){const r=new Set,s=new Set,n=[...t.structs,...e.structs].filter(o=>r.has(o.name)?!1:(r.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return s.has(a)?!1:(s.add(a),!0)});return{structs:n,groups:i}}const oi=Object.create(null);class _o{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:s,layout:n,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=r,this.vertex=s,r.source===s.source){const a=zc(r.source);this.structsAndGroups=a}else{const a=zc(s.source),l=zc(r.source);this.structsAndGroups=Sk(a,l)}this.layout=n??_k(this.structsAndGroups),this.gpuLayout=i??vk(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,s=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=Md(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=wk(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,oi[this._cacheKey]=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return oi[r]||(oi[r]=new _o(e),oi[r]._cacheKey=r),oi[r]}}const yb=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],kk=yb.reduce((t,e)=>(t[e]=!0,t),{});function Ck(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const xb=class bb{constructor(e,r){this._touched=0,this.uid=De("uniform"),this._resourceType="uniformGroup",this._resourceId=De("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...bb.defaultOptions,...r},this.uniformStructures=e;const s={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!kk[i.type]){const o=i.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,l]=o;throw new Error(`Uniform type ${i.type} is not supported. Use type: '${a}', size: ${l} instead.`)}throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${yb.join(", ")}`)}i.value??(i.value=Ck(i.type,i.size)),s[n]=i.value}this.uniforms=s,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=Md(Object.keys(s).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};xb.defaultOptions={ubo:!1,isStatic:!1};let Vb=xb;class Oa{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const s in e){const n=e[s];this.setResource(n,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const s in this.resources)e[r++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,r){const s=this.resources[r];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e,r){const s=this.resources;for(const n in s)s[n]._gcLastUsed=e,s[n]._touched=r}destroy(){const e=this.resources;for(const r in e)e[r]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const s in r)r[s]===e&&(r[s]=null)}else this._updateKey()}}var lh=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(lh||{});class jl extends ss{constructor(e){super(),this.uid=De("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:r,glProgram:s,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=r,this.glProgram=s,o===void 0&&(o=0,r&&(o|=lh.WEBGPU),s&&(o|=lh.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&n&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&n&&!a){const c=r.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},a={},r&&r.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new Oa,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let f=i[u];!f.source&&!f._resourceType&&(f=new Vb(f));const p=l[h];p&&(n[p.group]||(n[p.group]=new Oa,this._ownedBindGroups.push(n[p.group])),n[p.group].setResource(f,p.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,l)}addResource(e,r,s){var n,i;(n=this._uniformBindMap)[r]||(n[r]={}),(i=this._uniformBindMap[r])[s]||(i[s]=e),this.groups[r]||(this.groups[r]=new Oa,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const s={};for(const n in r){const i=r[n];Object.defineProperty(s,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return s}destroy(e=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:r,gl:s,...n}=e;let i,o;return r&&(i=_o.from(r)),s&&(o=Il.from(s)),new jl({gpuProgram:i,glProgram:o,...n})}}const Pk={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Bc=0,Dc=1,Fc=2,Lc=3,Uc=4,$c=5,ch=class qb{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Bc)}set blend(e){!!(this.data&1<<Bc)!==e&&(this.data^=1<<Bc)}get offsets(){return!!(this.data&1<<Dc)}set offsets(e){!!(this.data&1<<Dc)!==e&&(this.data^=1<<Dc)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Fc)}set culling(e){!!(this.data&1<<Fc)!==e&&(this.data^=1<<Fc)}get depthTest(){return!!(this.data&1<<Lc)}set depthTest(e){!!(this.data&1<<Lc)!==e&&(this.data^=1<<Lc)}get depthMask(){return!!(this.data&1<<$c)}set depthMask(e){!!(this.data&1<<$c)!==e&&(this.data^=1<<$c)}get clockwiseFrontFace(){return!!(this.data&1<<Uc)}set clockwiseFrontFace(e){!!(this.data&1<<Uc)!==e&&(this.data^=1<<Uc)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=Pk[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new qb;return e.depthTest=!1,e.blend=!0,e}};ch.default2d=ch.for2d();let Ek=ch;const wb=class uh extends jl{constructor(e){e={...uh.defaultOptions,...e},super(e),this.enabled=!0,this._state=Ek.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1),e.blendRequired&&this.addResource("uBackTexture",0,3)}apply(e,r,s,n){e.applyFilter(this,r,s,n)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:r,gl:s,...n}=e;let i,o;return r&&(i=_o.from(r)),s&&(o=Il.from(s)),new uh({gpuProgram:i,glProgram:o,...n})}};wb.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Tk=wb;function Sm(t,e,r=2){const s=e&&e.length,n=s?e[0]*r:t.length;let i=vb(t,0,n,r,!0);const o=[];if(!i||i.next===i.prev)return o;let a,l,c;if(s&&(i=Ok(t,e,i,r)),t.length>80*r){a=t[0],l=t[1];let u=a,h=l;for(let f=r;f<n;f+=r){const p=t[f],m=t[f+1];p<a&&(a=p),m<l&&(l=m),p>u&&(u=p),m>h&&(h=m)}c=Math.max(u-a,h-l),c=c!==0?32767/c:0}return Ki(i,o,r,a,l,c,0),o}function vb(t,e,r,s,n){let i;if(n===Wk(t,e,r,s)>0)for(let o=e;o<r;o+=s)i=km(o/s|0,t[o],t[o+1],i);else for(let o=r-s;o>=e;o-=s)i=km(o/s|0,t[o],t[o+1],i);return i&&_n(i,i.next)&&(Ji(i),i=i.next),i}function Rs(t,e){if(!t)return t;e||(e=t);let r=t,s;do if(s=!1,!r.steiner&&(_n(r,r.next)||Pe(r.prev,r,r.next)===0)){if(Ji(r),r=e=r.prev,r===r.next)break;s=!0}else r=r.next;while(s||r!==e);return e}function Ki(t,e,r,s,n,i,o){if(!t)return;!o&&i&&Fk(t,s,n,i);let a=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(i?Rk(t,s,n,i):Mk(t)){e.push(l.i,t.i,c.i),Ji(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=Ik(Rs(t),e),Ki(t,e,r,s,n,i,2)):o===2&&jk(t,e,r,s,n,i):Ki(Rs(t),e,r,s,n,i,1);break}}}function Mk(t){const e=t.prev,r=t,s=t.next;if(Pe(e,r,s)>=0)return!1;const n=e.x,i=r.x,o=s.x,a=e.y,l=r.y,c=s.y,u=Math.min(n,i,o),h=Math.min(a,l,c),f=Math.max(n,i,o),p=Math.max(a,l,c);let m=s.next;for(;m!==e;){if(m.x>=u&&m.x<=f&&m.y>=h&&m.y<=p&&_i(n,a,i,l,o,c,m.x,m.y)&&Pe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Rk(t,e,r,s){const n=t.prev,i=t,o=t.next;if(Pe(n,i,o)>=0)return!1;const a=n.x,l=i.x,c=o.x,u=n.y,h=i.y,f=o.y,p=Math.min(a,l,c),m=Math.min(u,h,f),A=Math.max(a,l,c),g=Math.max(u,h,f),y=hh(p,m,e,r,s),V=hh(A,g,e,r,s);let x=t.prevZ,b=t.nextZ;for(;x&&x.z>=y&&b&&b.z<=V;){if(x.x>=p&&x.x<=A&&x.y>=m&&x.y<=g&&x!==n&&x!==o&&_i(a,u,l,h,c,f,x.x,x.y)&&Pe(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=p&&b.x<=A&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&_i(a,u,l,h,c,f,b.x,b.y)&&Pe(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=y;){if(x.x>=p&&x.x<=A&&x.y>=m&&x.y<=g&&x!==n&&x!==o&&_i(a,u,l,h,c,f,x.x,x.y)&&Pe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=V;){if(b.x>=p&&b.x<=A&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&_i(a,u,l,h,c,f,b.x,b.y)&&Pe(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Ik(t,e){let r=t;do{const s=r.prev,n=r.next.next;!_n(s,n)&&Sb(s,r,r.next,n)&&Xi(s,n)&&Xi(n,s)&&(e.push(s.i,r.i,n.i),Ji(r),Ji(r.next),r=t=n),r=r.next}while(r!==t);return Rs(r)}function jk(t,e,r,s,n,i){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&$k(o,a)){let l=kb(o,a);o=Rs(o,o.next),l=Rs(l,l.next),Ki(o,e,r,s,n,i,0),Ki(l,e,r,s,n,i,0);return}a=a.next}o=o.next}while(o!==t)}function Ok(t,e,r,s){const n=[];for(let i=0,o=e.length;i<o;i++){const a=e[i]*s,l=i<o-1?e[i+1]*s:t.length,c=vb(t,a,l,s,!1);c===c.next&&(c.steiner=!0),n.push(Uk(c))}n.sort(Nk);for(let i=0;i<n.length;i++)r=zk(n[i],r);return r}function Nk(t,e){let r=t.x-e.x;if(r===0&&(r=t.y-e.y,r===0)){const s=(t.next.y-t.y)/(t.next.x-t.x),n=(e.next.y-e.y)/(e.next.x-e.x);r=s-n}return r}function zk(t,e){const r=Bk(t,e);if(!r)return e;const s=kb(r,t);return Rs(s,s.next),Rs(r,r.next)}function Bk(t,e){let r=e;const s=t.x,n=t.y;let i=-1/0,o;if(_n(t,r))return r;do{if(_n(t,r.next))return r.next;if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){const h=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=s&&h>i&&(i=h,o=r.x<r.next.x?r:r.next,h===s))return o}r=r.next}while(r!==e);if(!o)return null;const a=o,l=o.x,c=o.y;let u=1/0;r=o;do{if(s>=r.x&&r.x>=l&&s!==r.x&&_b(n<c?s:i,n,l,c,n<c?i:s,n,r.x,r.y)){const h=Math.abs(n-r.y)/(s-r.x);Xi(r,t)&&(h<u||h===u&&(r.x>o.x||r.x===o.x&&Dk(o,r)))&&(o=r,u=h)}r=r.next}while(r!==a);return o}function Dk(t,e){return Pe(t.prev,t,e.prev)<0&&Pe(e.next,t,t.next)<0}function Fk(t,e,r,s){let n=t;do n.z===0&&(n.z=hh(n.x,n.y,e,r,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,Lk(n)}function Lk(t){let e,r=1;do{let s=t,n;t=null;let i=null;for(e=0;s;){e++;let o=s,a=0;for(let c=0;c<r&&(a++,o=o.nextZ,!!o);c++);let l=r;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||s.z<=o.z)?(n=s,s=s.nextZ,a--):(n=o,o=o.nextZ,l--),i?i.nextZ=n:t=n,n.prevZ=i,i=n;s=o}i.nextZ=null,r*=2}while(e>1);return t}function hh(t,e,r,s,n){return t=(t-r)*n|0,e=(e-s)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Uk(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function _b(t,e,r,s,n,i,o,a){return(n-o)*(e-a)>=(t-o)*(i-a)&&(t-o)*(s-a)>=(r-o)*(e-a)&&(r-o)*(i-a)>=(n-o)*(s-a)}function _i(t,e,r,s,n,i,o,a){return!(t===o&&e===a)&&_b(t,e,r,s,n,i,o,a)}function $k(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Hk(t,e)&&(Xi(t,e)&&Xi(e,t)&&Gk(t,e)&&(Pe(t.prev,t,e.prev)||Pe(t,e.prev,e))||_n(t,e)&&Pe(t.prev,t,t.next)>0&&Pe(e.prev,e,e.next)>0)}function Pe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function _n(t,e){return t.x===e.x&&t.y===e.y}function Sb(t,e,r,s){const n=aa(Pe(t,e,r)),i=aa(Pe(t,e,s)),o=aa(Pe(r,s,t)),a=aa(Pe(r,s,e));return!!(n!==i&&o!==a||n===0&&oa(t,r,e)||i===0&&oa(t,s,e)||o===0&&oa(r,t,s)||a===0&&oa(r,e,s))}function oa(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function aa(t){return t>0?1:t<0?-1:0}function Hk(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Sb(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Xi(t,e){return Pe(t.prev,t,t.next)<0?Pe(t,e,t.next)>=0&&Pe(t,t.prev,e)>=0:Pe(t,e,t.prev)<0||Pe(t,t.next,e)<0}function Gk(t,e){let r=t,s=!1;const n=(t.x+e.x)/2,i=(t.y+e.y)/2;do r.y>i!=r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next;while(r!==t);return s}function kb(t,e){const r=dh(t.i,t.x,t.y),s=dh(e.i,e.x,e.y),n=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,s.next=r,r.prev=s,i.next=s,s.prev=i,s}function km(t,e,r,s){const n=dh(t,e,r);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function Ji(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function dh(t,e,r){return{i:t,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Wk(t,e,r,s){let n=0;for(let i=e,o=r-s;i<r;i+=s)n+=(t[o]-t[i])*(t[i+1]+t[o+1]),o=i;return n}const Yk=Sm.default||Sm,Cm=[{offset:0,color:"white"},{offset:1,color:"black"}],Rd=class fh{constructor(...e){this.uid=De("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let r=Qk(e);r={...r.type==="radial"?fh.defaultRadialOptions:fh.defaultLinearOptions,...Nx(r)},this._textureSize=r.textureSize,this._wrapMode=r.wrapMode,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:Ve.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:r}=this.start,{x:s,y:n}=this.end,i=s-e,o=n-r;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const g=e;e=s,s=g,i*=-1}if(o<0){const g=r;r=n,n=g,o*=-1}}const l=this.colorStops.length?this.colorStops:Cm,c=this._textureSize,{canvas:u,context:h}=Em(c,1),f=a?h.createLinearGradient(this._textureSize,0,0,0):h.createLinearGradient(0,0,this._textureSize,0);Pm(f,l),h.fillStyle=f,h.fillRect(0,0,c,1),this.texture=new Ae({source:new el({resource:u,addressMode:this._wrapMode})});const p=Math.sqrt(i*i+o*o),m=Math.atan2(o,i),A=new de;A.scale(p/c,1),A.rotate(m),A.translate(e,r),this.textureSpace==="local"&&A.scale(c,c),this.transform=A}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Cm,r=this._textureSize,{canvas:s,context:n}=Em(r,r),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,f=l-u,p=r/(u*2),m=(i-h)*p,A=(o-f)*p,g=n.createRadialGradient(m,A,c*p,(a-h)*p,(l-f)*p,u*p);Pm(g,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,r,r),n.fillStyle=g,n.translate(m,A),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-A),n.fillRect(0,0,r,r),this.texture=new Ae({source:new el({resource:s,addressMode:this._wrapMode})});const y=new de;y.scale(1/p,1/p),y.translate(h,f),this.textureSpace==="local"&&y.scale(r,r),this.transform=y}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};Rd.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Rd.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let So=Rd;function Pm(t,e){for(let r=0;r<e.length;r++){const s=e[r];t.addColorStop(s.offset,s.color)}}function Em(t,e){const r=vo.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}function Qk(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(ve("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??So.defaultLinearOptions.textureSize}),e}const Tm={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Kk{constructor(e,r){this.uid=De("fillPattern"),this._tick=0,this.transform=new de,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=Tm[r].addressModeU,e.source.style.addressModeV=Tm[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var Hc,Mm;function Xk(){if(Mm)return Hc;Mm=1,Hc=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(s);return o?o.map(Number):[]}return Hc}var Jk=Xk();const Zk=Qe(Jk);function e1(t,e){const r=Zk(t),s=[];let n=null,i=0,o=0;for(let a=0;a<r.length;a++){const l=r[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),s.length>0&&(n=s.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:Rt(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:o},s.push(n))}return e}class Id{constructor(e=0,r=0,s=0){this.type="circle",this.x=e,this.y=r,this.radius=s}clone(){return new Id(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-e,i=this.y-r;return n*=n,i*=i,n+i<=s}strokeContains(e,r,s,n=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-r,a=this.radius,l=(1-n)*s,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(s-l)}getBounds(e){return e||(e=new We),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class jd{constructor(e=0,r=0,s=0,n=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=s,this.halfHeight=n}clone(){return new jd(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,n=(r-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(e,r,s,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=s*(1-n),l=s-a,c=i-l,u=o-l,h=i+a,f=o+a,p=e-this.x,m=r-this.y,A=p*p/(c*c)+m*m/(u*u),g=p*p/(h*h)+m*m/(f*f);return A>1&&g<=1}getBounds(e){return e||(e=new We),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function t1(t,e,r,s,n,i){const o=t-r,a=e-s,l=n-r,c=i-s,u=o*l+a*c,h=l*l+c*c;let f=-1;h!==0&&(f=u/h);let p,m;f<0?(p=r,m=s):f>1?(p=n,m=i):(p=r+f*l,m=s+f*c);const A=t-p,g=e-m;return A*A+g*g}let r1,s1;class Oi{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const s=[];for(let n=0,i=r.length;n<i;n++)s.push(r[n].x,r[n].y);r=s}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,s=r.length;for(let n=0;n<s;n+=2){const i=r[n],o=r[n+1],a=r[(n+2)%s],l=r[(n+3)%s];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const r=this.getBounds(r1),s=e.getBounds(s1);if(!r.containsRect(s))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),r=new Oi(e);return r.closePath=this.closePath,r}contains(e,r){let s=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(s=!s)}return s}strokeContains(e,r,s,n=.5){const i=s*s,o=i*(1-n),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],f=l[u+1],p=l[(u+2)%l.length],m=l[(u+3)%l.length],A=t1(e,r,h,f,p,m),g=Math.sign((p-h)*(r-f)-(m-f)*(e-h));if(A<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new We);const r=this.points;let s=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,l=r.length;a<l;a+=2){const c=r[a],u=r[a+1];s=c<s?c:s,n=c>n?c:n,i=u<i?u:i,o=u>o?u:o}return e.x=s,e.width=n-s,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return ve("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return ve("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const la=(t,e,r,s,n,i,o)=>{const a=t-r,l=e-s,c=Math.sqrt(a*a+l*l);return c>=n-i&&c<=n+o};class Od{constructor(e=0,r=0,s=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=s,this.height=n,this.radius=i}getBounds(e){return e||(e=new We),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Od(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let n=e-(this.x+s),i=r-(this.y+s);const o=s*s;if(n*n+i*i<=o||(n=e-(this.x+this.width-s),n*n+i*i<=o)||(i=r-(this.y+this.height-s),n*n+i*i<=o)||(n=e-(this.x+s),n*n+i*i<=o))return!0}return!1}strokeContains(e,r,s,n=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=s*(1-n),h=s-u,f=i+c,p=o+c,m=a-c*2,A=l-c*2,g=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=g-h&&e<=g+u)&&r>=p&&r<=p+A||(r>=o-u&&r<=o+h||r>=y-h&&r<=y+u)&&e>=f&&e<=f+m?!0:e<f&&r<p&&la(e,r,f,p,c,h,u)||e>g-c&&r<p&&la(e,r,g-c,p,c,h,u)||e>g-c&&r>y-c&&la(e,r,g-c,y-c,c,h,u)||e<f&&r>y-c&&la(e,r,f,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Cb={};function n1(t,e,r){let s=2166136261;for(let n=0;n<e;n++)s^=t[n].uid,s=Math.imul(s,16777619),s>>>=0;return Cb[s]||i1(t,e,s,r)}function i1(t,e,r,s){const n={};let i=0;for(let a=0;a<s;a++){const l=a<e?t[a]:Ae.EMPTY.source;n[i++]=l.source,n[i++]=l.style}const o=new Oa(n);return Cb[r]=o,o}class Rm{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Im(t,e){const r=t.byteLength/8|0,s=new Float64Array(t,0,r);new Float64Array(e,0,r).set(s);const i=t.byteLength-r*8;if(i>0){const o=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(o)}}const o1={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var a1=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(a1||{});function jm(t,e){return e.alphaMode==="no-premultiply-alpha"&&o1[t]||t}const l1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function c1(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function u1(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=l1.replace(/%forloop%/gi,c1(t));if(e.shaderSource(r,s),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let Fs=null;function h1(){if(Fs)return Fs;const t=gb();return Fs=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Fs=u1(Fs,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Fs}class d1{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class f1{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new d1,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Ni=[];let rl=0;Ed.register({clear:()=>{if(Ni.length>0)for(const t of Ni)t&&t.destroy();Ni.length=0,rl=0}});function Om(){return rl>0?Ni[--rl]:new f1}function Nm(t){Ni[rl++]=t}let ai=0;const Pb=class Eb{constructor(e){this.uid=De("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...Eb.defaultOptions,...e},e.maxTextures||(ve("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=h1());const{maxTextures:r,attributesInitialSize:s,indicesInitialSize:n}=e;this.attributeBuffer=new Rm(s*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Nm(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const s=e._batch.textures.ids[r._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let s=Om(),n=s.textures;n.clear();const i=r[this.elementStart];let o=jm(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,f=this._batchIndexStart,p="startBatch";const m=this.maxTextures;for(let A=this.elementStart;A<this.elementSize;++A){const g=r[A];r[A]=null;const V=g.texture._source,x=jm(g.blendMode,V),b=o!==x||a!==g.topology;if(V._batchTick===ai&&!b){g._textureId=V._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=s;continue}V._batchTick=ai,(n.count>=m||b)&&(this._finishBatch(s,f,h-f,n,o,a,e,p),p="renderBatch",f=h,o=x,a=g.topology,s=Om(),n=s.textures,n.clear(),++ai),g._textureId=V._textureBindLocation=n.count,n.ids[V.uid]=n.count,n.textures[n.count++]=V,g._batch=s,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(s,f,h-f,n,o,a,e,p),f=h,++ai),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=h}_finishBatch(e,r,s,n,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=o,e.start=r,e.size=s,++ai,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),s=new Rm(r);Im(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const r=this.indexBuffer;let s=Math.max(e,r.length*1.5);s+=s%2;const n=s>65535?new Uint32Array(s):new Uint16Array(s);if(n.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)n[i]=r[i];else Im(r.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,r,s){e[r]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+3]=s+0,e[r+4]=s+2,e[r+5]=s+3}packIndex(e,r,s,n){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)r[s++]=n+i[c+a]-l}destroy(e={}){if(this.batches!==null){for(let r=0;r<this.batchIndex;r++)Nm(this.batches[r]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&(this.shader?.destroy(),this.shader=null);for(let r=0;r<this._elements.length;r++)this._elements[r]&&(this._elements[r]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};Pb.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let p1=Pb;var wt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(wt||{});let Zi=class extends ss{constructor(e){let{data:r,size:s}=e;const{usage:n,label:i,shrinkToFit:o}=e;super(),this._gpuData=Object.create(null),this._gcLastUsed=-1,this.autoGarbageCollect=!0,this.uid=De("buffer"),this._resourceType="buffer",this._resourceId=De("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,s??(s=r?.byteLength);const a=!!r;this.descriptor={size:s,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&wt.STATIC)}set static(e){e?this.descriptor.usage|=wt.STATIC:this.descriptor.usage&=~wt.STATIC}setDataWithSize(e,r,s){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=De("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}unload(){this.emit("unload",this);for(const e in this._gpuData)this._gpuData[e]?.destroy();this._gpuData=Object.create(null)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Tb(t,e){if(!(t instanceof Zi)){let r=e?wt.INDEX:wt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=wt.INDEX|wt.COPY_DST):(t=new Float32Array(t),r=wt.VERTEX|wt.COPY_DST)),t=new Zi({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function m1(t,e,r){const s=t.getAttribute(e);if(!s)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const n=s.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(s.offset||0)/c,h=(s.stride||8)/c;for(let f=u;f<n.length;f+=h){const p=n[f],m=n[f+1];p>a&&(a=p),m>l&&(l=m),p<i&&(i=p),m<o&&(o=m)}return r.minX=i,r.minY=o,r.maxX=a,r.maxY=l,r}function g1(t){return(t instanceof Zi||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Tb(t.buffer,!1),t}class A1 extends ss{constructor(e={}){super(),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=De("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new er,this._boundsDirty=!0;const{attributes:r,indexBuffer:s,topology:n}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const s=g1(r);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=Tb(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,m1(this,"aPosition",this._bounds)):this._bounds}unload(){this.emit("unload",this);for(const e in this._gpuData)this._gpuData[e]?.destroy();this._gpuData=Object.create(null)}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.unload(),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const y1=new Float32Array(1),x1=new Uint32Array(1);class b1 extends A1{constructor(){const r=new Zi({data:y1,label:"attribute-batch-buffer",usage:wt.VERTEX|wt.COPY_DST,shrinkToFit:!1}),s=new Zi({data:x1,label:"index-batch-buffer",usage:wt.INDEX|wt.COPY_DST,shrinkToFit:!1}),n=24;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:n,offset:0},aUV:{buffer:r,format:"float32x2",stride:n,offset:8},aColor:{buffer:r,format:"unorm8x4",stride:n,offset:16},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:n,offset:20}},indexBuffer:s})}}function zm(t,e,r){if(t)for(const s in t){const n=s.toLocaleLowerCase(),i=e[n];if(i){let o=t[s];s==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(o)}else Rt(`${s} placement hook does not exist in shader`)}}const V1=/\{\{(.*?)\}\}/g;function Bm(t){const e={};return(t.match(V1)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function Dm(t,e){let r;const s=/@in\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function Fm(t,e,r=!1){const s=[];Dm(e,s),t.forEach(a=>{a.header&&Dm(a.header,s)});const n=s;r&&n.sort();const i=n.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Lm(t,e){let r;const s=/@out\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function q1(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function w1(t){const e=/@.*?\s+/g;return t.replace(e,"")}function v1(t,e){const r=[];Lm(e,r),t.forEach(l=>{l.header&&Lm(l.header,r)});let s=0;const n=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${w1(l)};`).join(`
`),o=`return VSOutput(
            ${r.sort().map(l=>` ${q1(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Um(t,e){let r=t;for(const s in e){const n=e[s];n.join(`
`).length?r=r.replace(`{{${s}}}`,`//-----${s} START-----//
${n.join(`
`)}
//----${s} FINISH----//`):r=r.replace(`{{${s}}}`,"")}return r}const $r=Object.create(null),Gc=new Map;let _1=0;function S1({template:t,bits:e}){const r=Mb(t,e);if($r[r])return $r[r];const{vertex:s,fragment:n}=C1(t,e);return $r[r]=Rb(s,n,e),$r[r]}function k1({template:t,bits:e}){const r=Mb(t,e);return $r[r]||($r[r]=Rb(t.vertex,t.fragment,e)),$r[r]}function C1(t,e){const r=e.map(o=>o.vertex).filter(o=>!!o),s=e.map(o=>o.fragment).filter(o=>!!o);let n=Fm(r,t.vertex,!0);n=v1(r,n);const i=Fm(s,t.fragment,!0);return{vertex:n,fragment:i}}function Mb(t,e){return e.map(r=>(Gc.has(r)||Gc.set(r,_1++),Gc.get(r))).sort((r,s)=>r-s).join("-")+t.vertex+t.fragment}function Rb(t,e,r){const s=Bm(t),n=Bm(e);return r.forEach(i=>{zm(i.vertex,s,i.name),zm(i.fragment,n,i.name)}),{vertex:Um(t,s),fragment:Um(e,n)}}const P1=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,E1=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,T1=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,M1=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,R1={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},I1={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function j1({bits:t,name:e}){const r=S1({template:{fragment:E1,vertex:P1},bits:[R1,...t]});return _o.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function O1({bits:t,name:e}){return new Il({name:e,...k1({template:{vertex:T1,fragment:M1},bits:[I1,...t]})})}const N1={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},z1={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Wc={};function B1(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${r++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function D1(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function F1(t){return Wc[t]||(Wc[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${B1(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${D1(t)}
            `}}),Wc[t]}const Yc={};function L1(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function U1(t){return Yc[t]||(Yc[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${L1(t)}
            `}}),Yc[t]}const $1={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},H1={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},$m={};function G1(t){let e=$m[t];if(e)return e;const r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=s;return e=$m[t]=new Vb({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class Hm extends jl{constructor(e){const r=O1({name:"batch",bits:[z1,U1(e),H1]}),s=j1({name:"batch",bits:[N1,F1(e),$1]});super({glProgram:r,gpuProgram:s,resources:{batchSamplers:G1(e)}}),this.maxTextures=e}}let li=null;const Ib=class jb extends p1{constructor(e){super(e),this.geometry=new b1,this.name=jb.extension.name,this.vertexSize=6,li??(li=new Hm(e.maxTextures)),this.shader=li}packAttributes(e,r,s,n,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,f=a.tx,p=a.ty,{positions:m,uvs:A}=e,g=e.color,y=e.attributeOffset,V=y+e.attributeSize;for(let x=y;x<V;x++){const b=x*2,w=m[b],_=m[b+1];r[n++]=l*w+u*_+f,r[n++]=h*_+c*w+p,r[n++]=A[b],r[n++]=A[b+1],s[n++]=g,s[n++]=o}}packQuadAttributes(e,r,s,n,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,f=a.tx,p=a.ty,m=e.bounds,A=m.maxX,g=m.minX,y=m.maxY,V=m.minY,x=o.uvs,b=e.color,w=i<<16|e.roundPixels&65535;r[n+0]=l*g+u*V+f,r[n+1]=h*V+c*g+p,r[n+2]=x.x0,r[n+3]=x.y0,s[n+4]=b,s[n+5]=w,r[n+6]=l*A+u*V+f,r[n+7]=h*V+c*A+p,r[n+8]=x.x1,r[n+9]=x.y1,s[n+10]=b,s[n+11]=w,r[n+12]=l*A+u*y+f,r[n+13]=h*y+c*A+p,r[n+14]=x.x2,r[n+15]=x.y2,s[n+16]=b,s[n+17]=w,r[n+18]=l*g+u*y+f,r[n+19]=h*y+c*g+p,r[n+20]=x.x3,r[n+21]=x.y3,s[n+22]=b,s[n+23]=w}_updateMaxTextures(e){this.shader.maxTextures!==e&&(li=new Hm(e),this.shader=li)}destroy(){this.shader=null,super.destroy()}};Ib.extension={type:[Ce.Batcher],name:"default"};let W1=Ib;class Y1{constructor(e){this.items=Object.create(null);const{renderer:r,type:s,onUnload:n,priority:i,name:o}=e;this._renderer=r,r.gc.addResourceHash(this,"items",s,i??0),this._onUnload=n,this.name=o}add(e){return this.items[e.uid]?!1:(this.items[e.uid]=e,e.once("unload",this.remove,this),e._gcLastUsed=this._renderer.gc.now,!0)}remove(e,...r){if(!this.items[e.uid])return;const s=e._gpuData[this._renderer.uid];s&&(this._onUnload?.(e,...r),s.destroy(),e._gpuData[this._renderer.uid]=null,this.items[e.uid]=null)}removeAll(...e){Object.values(this.items).forEach(r=>r&&this.remove(r,...e))}destroy(...e){this.removeAll(...e),this.items=Object.create(null),this._renderer=null,this._onUnload=null}}function Q1(t,e,r,s,n,i,o,a=null){let l=0;r*=e,n*=i;const c=a.a,u=a.b,h=a.c,f=a.d,p=a.tx,m=a.ty;for(;l<o;){const A=t[r],g=t[r+1];s[n]=c*A+h*g+p,s[n+1]=u*A+f*g+m,n+=i,r+=e,l++}}function K1(t,e,r,s){let n=0;for(e*=r;n<s;)t[e]=0,t[e+1]=0,e+=r,n++}function Ob(t,e,r,s,n){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),s||(s=2),n||(n=t.length/s-r);let h=r*s;for(let f=0;f<n;f++){const p=t[h],m=t[h+1];t[h]=i*p+a*m+c,t[h+1]=o*p+l*m+u,h+=s}}const X1=new de;class Nb{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?Yx(r,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||X1}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const eo={extension:{type:Ce.ShapeBuilder,name:"circle"},build(t,e){let r,s,n,i,o,a;if(t.type==="circle"){const b=t;if(o=a=b.radius,o<=0)return!1;r=b.x,s=b.y,n=i=0}else if(t.type==="ellipse"){const b=t;if(o=b.halfWidth,a=b.halfHeight,o<=0||a<=0)return!1;r=b.x,s=b.y,n=i=0}else{const b=t,w=b.width/2,_=b.height/2;r=b.x+w,s=b.y+_,o=a=Math.max(0,Math.min(b.radius,Math.min(w,_))),n=w-o,i=_-a}if(n<0||i<0)return!1;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return!1;if(l===0)return e[0]=e[6]=r+n,e[1]=e[3]=s+i,e[2]=e[4]=r-n,e[5]=e[7]=s-i,!0;let u=0,h=l*4+(n?2:0)+2,f=h,p=c,m=n+o,A=i,g=r+m,y=r-m,V=s+A;if(e[u++]=g,e[u++]=V,e[--h]=V,e[--h]=y,i){const b=s-A;e[f++]=y,e[f++]=b,e[--p]=b,e[--p]=g}for(let b=1;b<l;b++){const w=Math.PI/2*(b/l),_=n+Math.cos(w)*o,q=i+Math.sin(w)*a,S=r+_,k=r-_,C=s+q,P=s-q;e[u++]=S,e[u++]=C,e[--h]=C,e[--h]=k,e[f++]=k,e[f++]=P,e[--p]=P,e[--p]=S}m=n,A=i+a,g=r+m,y=r-m,V=s+A;const x=s-A;return e[u++]=g,e[u++]=V,e[--p]=x,e[--p]=g,n&&(e[u++]=y,e[u++]=V,e[--p]=x,e[--p]=y),!0},triangulate(t,e,r,s,n,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=s;e[l*r]=o,e[l*r+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},J1={...eo,extension:{...eo.extension,name:"ellipse"}},Z1={...eo,extension:{...eo.extension,name:"roundedRectangle"}},zb=1e-4,Gm=1e-4;function eC(t){const e=t.length;if(e<6)return 1;let r=0;for(let s=0,n=t[e-2],i=t[e-1];s<e;s+=2){const o=t[s],a=t[s+1];r+=(o-n)*(a+i),n=o,i=a}return r<0?-1:1}function Wm(t,e,r,s,n,i,o,a){const l=t-r*n,c=e-s*n,u=t+r*i,h=e+s*i;let f,p;o?(f=s,p=-r):(f=-s,p=r);const m=l+f,A=c+p,g=u+f,y=h+p;return a.push(m,A),a.push(g,y),2}function os(t,e,r,s,n,i,o,a){const l=r-t,c=s-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let f=u;const p=h-u,m=Math.abs(p),A=Math.sqrt(l*l+c*c),g=(15*m*Math.sqrt(A)/Math.PI>>0)+1,y=p/g;if(f+=y,a){o.push(t,e),o.push(r,s);for(let V=1,x=f;V<g;V++,x+=y)o.push(t,e),o.push(t+Math.sin(x)*A,e+Math.cos(x)*A);o.push(t,e),o.push(n,i)}else{o.push(r,s),o.push(t,e);for(let V=1,x=f;V<g;V++,x+=y)o.push(t+Math.sin(x)*A,e+Math.cos(x)*A),o.push(t,e);o.push(n,i),o.push(t,e)}return g*2}function tC(t,e,r,s,n,i){const o=zb;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let F=eC(t);l=(l-.5)*F+.5}const c=new lt(t[0],t[1]),u=new lt(t[t.length-2],t[t.length-1]),h=s,f=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),f&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const F=(c.x+u.x)*.5,W=(u.y+c.y)*.5;t.unshift(F,W),t.push(F,W)}const p=n,m=t.length/2;let A=t.length;const g=p.length/2,y=a.width/2,V=y*y,x=a.miterLimit*a.miterLimit;let b=t[0],w=t[1],_=t[2],q=t[3],S=0,k=0,C=-(w-q),P=b-_,T=0,M=0,I=Math.sqrt(C*C+P*P);C/=I,P/=I,C*=y,P*=y;const B=l,E=(1-B)*2,R=B*2;h||(a.cap==="round"?A+=os(b-C*(E-R)*.5,w-P*(E-R)*.5,b-C*E,w-P*E,b+C*R,w+P*R,p,!0)+2:a.cap==="square"&&(A+=Wm(b,w,C,P,E,R,!0,p))),p.push(b-C*E,w-P*E),p.push(b+C*R,w+P*R);for(let F=1;F<m-1;++F){b=t[(F-1)*2],w=t[(F-1)*2+1],_=t[F*2],q=t[F*2+1],S=t[(F+1)*2],k=t[(F+1)*2+1],C=-(w-q),P=b-_,I=Math.sqrt(C*C+P*P),C/=I,P/=I,C*=y,P*=y,T=-(q-k),M=_-S,I=Math.sqrt(T*T+M*M),T/=I,M/=I,T*=y,M*=y;const W=_-b,me=w-q,ie=_-S,te=k-q,ge=W*ie+me*te,oe=me*ie-te*W,ce=oe<0;if(Math.abs(oe)<.001*Math.abs(ge)){p.push(_-C*E,q-P*E),p.push(_+C*R,q+P*R),ge>=0&&(a.join==="round"?A+=os(_,q,_-C*E,q-P*E,_-T*E,q-M*E,p,!1)+4:A+=2,p.push(_-T*R,q-M*R),p.push(_+T*E,q+M*E));continue}const Be=(-C+b)*(-P+q)-(-C+_)*(-P+w),nr=(-T+S)*(-M+q)-(-T+_)*(-M+k),yt=(W*nr-ie*Be)/oe,Gt=(te*Be-me*nr)/oe,Ar=(yt-_)*(yt-_)+(Gt-q)*(Gt-q),St=_+(yt-_)*E,xt=q+(Gt-q)*E,ir=_-(yt-_)*R,yr=q-(Gt-q)*R,yw=Math.min(W*W+me*me,ie*ie+te*te),zf=ce?E:R,xw=yw+zf*zf*V;Ar<=xw?a.join==="bevel"||Ar/V>x?(ce?(p.push(St,xt),p.push(_+C*R,q+P*R),p.push(St,xt),p.push(_+T*R,q+M*R)):(p.push(_-C*E,q-P*E),p.push(ir,yr),p.push(_-T*E,q-M*E),p.push(ir,yr)),A+=2):a.join==="round"?ce?(p.push(St,xt),p.push(_+C*R,q+P*R),A+=os(_,q,_+C*R,q+P*R,_+T*R,q+M*R,p,!0)+4,p.push(St,xt),p.push(_+T*R,q+M*R)):(p.push(_-C*E,q-P*E),p.push(ir,yr),A+=os(_,q,_-C*E,q-P*E,_-T*E,q-M*E,p,!1)+4,p.push(_-T*E,q-M*E),p.push(ir,yr)):(p.push(St,xt),p.push(ir,yr)):(p.push(_-C*E,q-P*E),p.push(_+C*R,q+P*R),a.join==="round"?ce?A+=os(_,q,_+C*R,q+P*R,_+T*R,q+M*R,p,!0)+2:A+=os(_,q,_-C*E,q-P*E,_-T*E,q-M*E,p,!1)+2:a.join==="miter"&&Ar/V<=x&&(ce?(p.push(ir,yr),p.push(ir,yr)):(p.push(St,xt),p.push(St,xt)),A+=2),p.push(_-T*E,q-M*E),p.push(_+T*R,q+M*R),A+=2)}b=t[(m-2)*2],w=t[(m-2)*2+1],_=t[(m-1)*2],q=t[(m-1)*2+1],C=-(w-q),P=b-_,I=Math.sqrt(C*C+P*P),C/=I,P/=I,C*=y,P*=y,p.push(_-C*E,q-P*E),p.push(_+C*R,q+P*R),h||(a.cap==="round"?A+=os(_-C*(E-R)*.5,q-P*(E-R)*.5,_-C*E,q-P*E,_+C*R,q+P*R,p,!1)+2:a.cap==="square"&&(A+=Wm(_,q,C,P,E,R,!1,p)));const D=Gm*Gm;for(let F=g;F<A+g-2;++F)b=p[F*2],w=p[F*2+1],_=p[(F+1)*2],q=p[(F+1)*2+1],S=p[(F+2)*2],k=p[(F+2)*2+1],!(Math.abs(b*(q-k)+_*(k-w)+S*(w-q))<D)&&i.push(F,F+1,F+2)}function rC(t,e,r,s){const n=zb;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<n&&Math.abs(o-l)<n,u=r,h=t.length/2,f=u.length/2;for(let p=0;p<h;p++)u.push(t[p*2]),u.push(t[p*2+1]);for(let p=0;p<h-1;p++)s.push(f+p,f+p+1);c&&s.push(f+h-1,f)}function Bb(t,e,r,s,n,i,o){const a=Yk(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+n,i[o++]=a[c+1]+n,i[o++]=a[c+2]+n;let l=n*s;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=s}const sC=[],nC={extension:{type:Ce.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return!0},triangulate(t,e,r,s,n,i){Bb(t,sC,e,r,s,n,i)}},iC={extension:{type:Ce.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,s=r.x,n=r.y,i=r.width,o=r.height;return i>0&&o>0?(e[0]=s,e[1]=n,e[2]=s+i,e[3]=n,e[4]=s+i,e[5]=n+o,e[6]=s,e[7]=n+o,!0):!1},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[6],e[s+o+1]=t[7],o+=r,e[s+o]=t[4],e[s+o+1]=t[5],o+=r;const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},oC={extension:{type:Ce.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,!0},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[4],e[s+o+1]=t[5];const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},aC=new de,lC=new We;function cC(t,e,r,s){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const o=r.getBounds(lC);e.width&&o.pad(e.width);const{x:a,y:l}=o,c=1/o.width,u=1/o.height,h=-a*c,f=-l*u,p=n.a,m=n.b,A=n.c,g=n.d;n.a*=c,n.b*=c,n.c*=u,n.d*=u,n.tx=h*p+f*A+n.tx,n.ty=h*m+f*g+n.ty}else n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;return!(e.fill instanceof So)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),s&&n.append(aC.copyFrom(s).invert()),n}const Ol={};Or.handleByMap(Ce.ShapeBuilder,Ol);Or.add(iC,nC,oC,eo,J1,Z1);const uC=new We,hC=new de;function dC(t,e){const{geometryData:r,batches:s}=e;s.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")fC(i.data,s,r);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&Ym(c.shapePath,l,!0,s,r),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Ym(a,l,o,s,r)}}}function fC(t,e,r){const s=[],n=Ol.rectangle,i=uC;i.x=t.dx,i.y=t.dy,i.width=t.dw,i.height=t.dh;const o=t.transform;if(!n.build(i,s))return;const{vertices:a,uvs:l,indices:c}=r,u=c.length,h=a.length/2;o&&Ob(s,o),n.triangulate(s,a,2,h,c,u);const f=t.image,p=f.uvs;l.push(p.x0,p.y0,p.x1,p.y1,p.x3,p.y3,p.x2,p.y2);const m=$t.get(Nb);m.indexOffset=u,m.indexSize=c.length-u,m.attributeOffset=h,m.attributeSize=a.length/2-h,m.baseColor=t.style,m.alpha=t.alpha,m.texture=f,m.geometryData=r,e.push(m)}function Ym(t,e,r,s,n){const{vertices:i,uvs:o,indices:a}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=[],f=Ol[l.type];if(!f.build(l,h))return;const p=a.length,m=i.length/2;let A="triangle-list";if(c&&Ob(h,c),r){const x=l.closePath??!0,b=e;b.pixelLine?(rC(h,x,i,a),A="line-list"):tC(h,b,!1,x,i,a)}else if(u){const x=[],b=h.slice();pC(u).forEach(_=>{x.push(b.length/2),b.push(..._)}),Bb(b,x,i,2,m,a,p)}else f.triangulate(h,i,2,m,a,p);const g=o.length/2,y=e.texture;if(y!==Ae.WHITE){const x=cC(hC,e,l,c);Q1(i,2,m,o,g,2,i.length/2-m,x)}else K1(o,g,2,i.length/2-m);const V=$t.get(Nb);V.indexOffset=p,V.indexSize=a.length-p,V.attributeOffset=m,V.attributeSize=i.length/2-m,V.baseColor=e.color,V.alpha=e.alpha,V.texture=y,V.geometryData=n,V.topology=A,s.push(V)})}function pC(t){const e=[];for(let r=0;r<t.length;r++){const s=t[r].shape,n=[];Ol[s.type].build(s,n)&&e.push(n)}return e}class mC{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(e=>{$t.return(e)}),this.graphicsData&&$t.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}}class gC{constructor(){this.instructions=new Jx}init(e){const r=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(r):this.batcher=new W1({maxTextures:r}),this.instructions.reset()}get geometry(){return ve(gS,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Nd=class ph{constructor(e){this._renderer=e,this._managedContexts=new Y1({renderer:e,type:"resource",name:"graphicsContext"})}init(e){ph.defaultOptions.bezierSmoothness=e?.bezierSmoothness??ph.defaultOptions.bezierSmoothness}getContextRenderData(e){return e._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(e)}updateGpuContext(e){const r=!!e._gpuData[this._renderer.uid],s=e._gpuData[this._renderer.uid]||this._initContext(e);if(e.dirty||!r){r&&s.reset(),dC(e,s);const n=e.batchMode;e.customShader||n==="no-batch"?s.isBatchable=!1:n==="auto"?s.isBatchable=s.geometryData.vertices.length<400:s.isBatchable=!0,e.dirty=!1}return s}getGpuContext(e){return e._gpuData[this._renderer.uid]||this._initContext(e)}_initContextRenderData(e){const r=$t.get(gC,{maxTextures:this._renderer.limits.maxBatchableTextures}),s=e._gpuData[this._renderer.uid],{batches:n,geometryData:i}=s;s.graphicsData=r;const o=i.vertices.length,a=i.indices.length;for(let h=0;h<n.length;h++)n[h].applyTransform=!1;const l=r.batcher;l.ensureAttributeBuffer(o),l.ensureIndexBuffer(a),l.begin();for(let h=0;h<n.length;h++){const f=n[h];l.add(f)}l.finish(r.instructions);const c=l.geometry;c.indexBuffer.setDataWithSize(l.indexBuffer,l.indexSize,!0),c.buffers[0].setDataWithSize(l.attributeBuffer.float32View,l.attributeSize,!0);const u=l.batches;for(let h=0;h<u.length;h++){const f=u[h];f.bindGroup=n1(f.textures.textures,f.textures.count,this._renderer.limits.maxBatchableTextures)}return r}_initContext(e){const r=new mC;return r.context=e,e._gpuData[this._renderer.uid]=r,this._managedContexts.add(e),r}destroy(){this._managedContexts.destroy(),this._renderer=null}};Nd.extension={type:[Ce.WebGLSystem,Ce.WebGPUSystem,Ce.CanvasSystem],name:"graphicsContext"};Nd.defaultOptions={bezierSmoothness:.5};let Db=Nd;const AC=8,ca=11920929e-14,yC=1;function Fb(t,e,r,s,n,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??Db.defaultOptions.bezierSmoothness));let f=(yC-h)/1;return f*=f,xC(e,r,s,n,i,o,a,l,t,f),t}function xC(t,e,r,s,n,i,o,a,l,c){mh(t,e,r,s,n,i,o,a,l,c,0),l.push(o,a)}function mh(t,e,r,s,n,i,o,a,l,c,u){if(u>AC)return;const h=(t+r)/2,f=(e+s)/2,p=(r+n)/2,m=(s+i)/2,A=(n+o)/2,g=(i+a)/2,y=(h+p)/2,V=(f+m)/2,x=(p+A)/2,b=(m+g)/2,w=(y+x)/2,_=(V+b)/2;if(u>0){let q=o-t,S=a-e;const k=Math.abs((r-o)*S-(s-a)*q),C=Math.abs((n-o)*S-(i-a)*q);if(k>ca&&C>ca){if((k+C)*(k+C)<=c*(q*q+S*S)){l.push(w,_);return}}else if(k>ca){if(k*k<=c*(q*q+S*S)){l.push(w,_);return}}else if(C>ca){if(C*C<=c*(q*q+S*S)){l.push(w,_);return}}else if(q=w-(t+o)/2,S=_-(e+a)/2,q*q+S*S<=c){l.push(w,_);return}}mh(t,e,h,f,y,V,w,_,l,c,u+1),mh(w,_,x,b,A,g,o,a,l,c,u+1)}const bC=8,VC=11920929e-14,qC=1;function wC(t,e,r,s,n,i,o,a){const c=Math.min(.99,Math.max(0,a??Db.defaultOptions.bezierSmoothness));let u=(qC-c)/1;return u*=u,vC(e,r,s,n,i,o,t,u),t}function vC(t,e,r,s,n,i,o,a){gh(o,t,e,r,s,n,i,a,0),o.push(n,i)}function gh(t,e,r,s,n,i,o,a,l){if(l>bC)return;const c=(e+s)/2,u=(r+n)/2,h=(s+i)/2,f=(n+o)/2,p=(c+h)/2,m=(u+f)/2;let A=i-e,g=o-r;const y=Math.abs((s-i)*g-(n-o)*A);if(y>VC){if(y*y<=a*(A*A+g*g)){t.push(p,m);return}}else if(A=p-(e+i)/2,g=m-(r+o)/2,A*A+g*g<=a){t.push(p,m);return}gh(t,e,r,c,u,p,m,a,l+1),gh(t,p,m,h,f,i,o,a,l+1)}function Lb(t,e,r,s,n,i,o,a){let l=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=n;c*=o?-1:1;for(let h=0;h<a+1;h++){const f=Math.cos(u),p=Math.sin(u),m=e+f*s,A=r+p*s;t.push(m,A),u+=c}}function _C(t,e,r,s,n,i){const o=t[t.length-2],l=t[t.length-1]-r,c=o-e,u=n-r,h=s-e,f=Math.abs(l*h-c*u);if(f<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const p=l*l+c*c,m=u*u+h*h,A=l*u+c*h,g=i*Math.sqrt(p)/f,y=i*Math.sqrt(m)/f,V=g*A/p,x=y*A/m,b=g*h+y*c,w=g*u+y*l,_=c*(y+V),q=l*(y+V),S=h*(g+x),k=u*(g+x),C=Math.atan2(q-w,_-b),P=Math.atan2(k-w,S-b);Lb(t,b+e,w+r,i,C,P,c*u>h*l)}const zi=Math.PI*2,Qc={centerX:0,centerY:0,ang1:0,ang2:0},Kc=({x:t,y:e},r,s,n,i,o,a,l)=>{t*=r,e*=s;const c=n*t-i*e,u=i*t+n*e;return l.x=c+o,l.y=u+a,l};function SC(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:r,n=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:n-i*s,y:i+n*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Qm=(t,e,r,s)=>{const n=t*s-e*r<0?-1:1;let i=t*r+e*s;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},kC=(t,e,r,s,n,i,o,a,l,c,u,h,f)=>{const p=Math.pow(n,2),m=Math.pow(i,2),A=Math.pow(u,2),g=Math.pow(h,2);let y=p*m-p*g-m*A;y<0&&(y=0),y/=p*g+m*A,y=Math.sqrt(y)*(o===a?-1:1);const V=y*n/i*h,x=y*-i/n*u,b=c*V-l*x+(t+r)/2,w=l*V+c*x+(e+s)/2,_=(u-V)/n,q=(h-x)/i,S=(-u-V)/n,k=(-h-x)/i,C=Qm(1,0,_,q);let P=Qm(_,q,S,k);a===0&&P>0&&(P-=zi),a===1&&P<0&&(P+=zi),f.centerX=b,f.centerY=w,f.ang1=C,f.ang2=P};function CC(t,e,r,s,n,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*zi/360),h=Math.cos(a*zi/360),f=h*(e-s)/2+u*(r-n)/2,p=-u*(e-s)/2+h*(r-n)/2;if(f===0&&p===0)return;i=Math.abs(i),o=Math.abs(o);const m=Math.pow(f,2)/Math.pow(i,2)+Math.pow(p,2)/Math.pow(o,2);m>1&&(i*=Math.sqrt(m),o*=Math.sqrt(m)),kC(e,r,s,n,i,o,l,c,u,h,f,p,Qc);let{ang1:A,ang2:g}=Qc;const{centerX:y,centerY:V}=Qc;let x=Math.abs(g)/(zi/4);Math.abs(1-x)<1e-7&&(x=1);const b=Math.max(Math.ceil(x),1);g/=b;let w=t[t.length-2],_=t[t.length-1];const q={x:0,y:0};for(let S=0;S<b;S++){const k=SC(A,g),{x:C,y:P}=Kc(k[0],i,o,h,u,y,V,q),{x:T,y:M}=Kc(k[1],i,o,h,u,y,V,q),{x:I,y:B}=Kc(k[2],i,o,h,u,y,V,q);Fb(t,w,_,C,P,T,M,I,B),w=I,_=B,A+=g}}function PC(t,e,r){const s=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,f=c/u;return{len:u,nx:h,ny:f}},n=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??r;if(l<=0){n(o,a),i=a;continue}const c=e[(o+1)%e.length],u=s(a,i),h=s(a,c);if(u.len<1e-4||h.len<1e-4){n(o,a),i=a;continue}let f=Math.asin(u.nx*h.ny-u.ny*h.nx),p=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,p=-1,m=!0):f>0&&(p=-1,m=!0);const A=f/2;let g,y=Math.abs(Math.cos(A)*l/Math.sin(A));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),g=Math.abs(y*Math.sin(A)/Math.cos(A))):g=l;const V=a.x+h.nx*y+-h.ny*g*p,x=a.y+h.ny*y+h.nx*g*p,b=Math.atan2(u.ny,u.nx)+Math.PI/2*p,w=Math.atan2(h.ny,h.nx)-Math.PI/2*p;o===0&&t.moveTo(V+Math.cos(b)*g,x+Math.sin(b)*g),t.arc(V,x,g,b,w,m),i=a}}function EC(t,e,r,s){const n=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??r;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],f=n(u,l);let p;if(f<1e-4)p=l;else{const g=Math.min(f/2,c);p=i(l,u,g/f)}const m=n(h,l);let A;if(m<1e-4)A=l;else{const g=Math.min(m/2,c);A=i(l,h,g/m)}a===0?t.moveTo(p.x,p.y):t.lineTo(p.x,p.y),t.quadraticCurveTo(l.x,l.y,A.x,A.y,s)}}const TC=new We;class MC{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new er,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],i=s[s.length-1];return(n!==e||i!==r)&&s.push(e,r),this}arc(e,r,s,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Lb(a,e,r,s,n,i,o),this}arcTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly.points;return _C(o,e,r,s,n,i),this}arcToSvg(e,r,s,n,i,o,a){const l=this._currentPoly.points;return CC(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,r,s,n,i),this}bezierCurveTo(e,r,s,n,i,o,a){this._ensurePoly();const l=this._currentPoly;return Fb(this._currentPoly.points,l.lastX,l.lastY,e,r,s,n,i,o,a),this}quadraticCurveTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly;return wC(this._currentPoly.points,o.lastX,o.lastY,e,r,s,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const s=this.shapePrimitives,n=s.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&s.length-n>1){let i=null;for(let o=n;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,s,n,i){return this.drawShape(new We(e,r,s,n),i),this}circle(e,r,s,n){return this.drawShape(new Id(e,r,s),n),this}poly(e,r,s){const n=new Oi(e);return n.closePath=r,this.drawShape(n,s),this}regularPoly(e,r,s,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=a-u*l;c.push(e+s*Math.cos(h),r+s*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,r,s,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,r,s,n,o);const l=s*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const p=f*u+c,m=e+s*Math.cos(p),A=r+s*Math.sin(p),g=p+Math.PI+h,y=p-Math.PI-h,V=m+i*Math.cos(g),x=A+i*Math.sin(g),b=m+i*Math.cos(y),w=A+i*Math.sin(y);f===0?this.moveTo(V,x):this.lineTo(V,x),this.quadraticCurveTo(m,A,b,w,a)}return this.closePath()}roundShape(e,r,s=!1,n){return e.length<3?this:(s?EC(this,e,r,n):PC(this,e,r),this.closePath())}filletRect(e,r,s,n,i){if(i===0)return this.rect(e,r,s,n);const o=Math.min(s,n)/2,a=Math.min(o,Math.max(-o,i)),l=e+s,c=r+n,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+s-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,s,n,i,o){if(i<=0)return this.rect(e,r,s,n);const a=Math.min(i,Math.min(s,n)/2),l=e+s,c=r+n,u=[e+a,r,l-a,r,l,r+a,l,c-a,l-a,c,e+a,c,e,c-a,e,r+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,r,s,n,i){return this.drawShape(new jd(e,r,s,n),i),this}roundRect(e,r,s,n,i,o){return this.drawShape(new Od(e,r,s,n,i),o),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let s=this._currentPoly;return s&&this.endPoly(),s=new Oi,s.points.push(e,r),this._currentPoly=s,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Oi,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let s=r.shape.x,n=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,o=s;s=i.a*s+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const s=e.instructions[r];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let s=0;s<r.length;s++){const n=r[s],i=n.shape.getBounds(TC);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class Er{constructor(e,r=!1){this.instructions=[],this.uid=De("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?e1(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new MC(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,s,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(lt.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,s,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,s){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(lt.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,r,s]}),this._dirty=!0,this}rect(e,r,s,n,i){return this.instructions.push({action:"rect",data:[e,r,s,n,i]}),this._dirty=!0,this}circle(e,r,s,n){return this.instructions.push({action:"circle",data:[e,r,s,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,s,n,i,o,a){i||(i=n/2);const l=-1*Math.PI/2+o,c=s*2,u=Math.PI*2/c,h=[];for(let f=0;f<c;f++){const p=f%2?i:n,m=f*u+l;h.push(e+p*Math.cos(m),r+p*Math.sin(m))}return this.poly(h,!0,a),this}clone(e=!1){const r=new Er;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];r.instructions.push({action:n.action,data:n.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,s=e.b,n=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,f=0,p=0,m=0,A=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],V=y.data;switch(y.action){case"moveTo":case"lineTo":l=V[0],c=V[1],V[0]=r*l+n*c+o,V[1]=s*l+i*c+a;break;case"bezierCurveTo":u=V[0],h=V[1],f=V[2],p=V[3],l=V[4],c=V[5],V[0]=r*u+n*h+o,V[1]=s*u+i*h+a,V[2]=r*f+n*p+o,V[3]=s*f+i*p+a,V[4]=r*l+n*c+o,V[5]=s*l+i*c+a;break;case"quadraticCurveTo":u=V[0],h=V[1],l=V[2],c=V[3],V[0]=r*u+n*h+o,V[1]=s*u+i*h+a,V[2]=r*l+n*c+o,V[3]=s*l+i*c+a;break;case"arcToSvg":l=V[5],c=V[6],m=V[0],A=V[1],V[0]=r*m+n*A,V[1]=s*m+i*A,V[5]=r*l+n*c+o,V[6]=s*l+i*c+a;break;case"circle":V[4]=ci(V[3],e);break;case"rect":V[4]=ci(V[4],e);break;case"ellipse":V[8]=ci(V[8],e);break;case"roundRect":V[5]=ci(V[5],e);break;case"addPath":V[0].transform(e);break;case"poly":V[2]=ci(V[2],e);break;default:Rt("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,s=this.instructions[r];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;s=this.instructions[r]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function ci(t,e){return t?t.prepend(e):e.clone()}function Me(t,e,r){const s=t.getAttribute(e);return s?Number(s):r}function RC(t,e){const r=t.querySelectorAll("defs");for(let s=0;s<r.length;s++){const n=r[s];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=IC(o);break;case"radialgradient":e.defs[o.id]=jC();break}}}}function IC(t){const e=Me(t,"x1",0),r=Me(t,"y1",0),s=Me(t,"x2",1),n=Me(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new So(e,r,s,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Me(l,"offset",0),u=Ve.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function jC(t){return Rt("[SVG Parser] Radial gradients are not yet supported"),new So(0,0,1,0)}function Km(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Xm={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Ub(t,e){const r=t.getAttribute("style"),s={},n={},i={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const o in Xm){const a=t.getAttribute(o);a&&Jm(e,i,o,a.trim())}if(r){const o=r.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");Xm[c]&&Jm(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?s:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function Jm(t,e,r,s){switch(r){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=Km(s);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=Ve.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=Km(s);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=Ve.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function OC(t){if(t.length<=2)return!0;const e=t.map(a=>a.area).sort((a,l)=>l-a),[r,s]=e,n=e[e.length-1],i=r/s,o=s/n;return!(i>3&&o<2)}function NC(t){return t.split(/(?=[Mm])/).filter(s=>s.trim().length>0)}function zC(t){const e=t.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const r=e.map(Number),s=[],n=[];for(let u=0;u<r.length;u+=2)u+1<r.length&&(s.push(r[u]),n.push(r[u+1]));if(s.length===0||n.length===0)return 0;const i=Math.min(...s),o=Math.max(...s),a=Math.min(...n),l=Math.max(...n);return(o-i)*(l-a)}function Zm(t,e){const r=new Er(t,!1);for(const s of r.instructions)e.instructions.push(s)}function BC(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const r={context:e,defs:{},path:new Er};RC(t,r);const s=t.children,{fillStyle:n,strokeStyle:i}=Ub(t,r);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&$b(a,r,n,i)}return e}function $b(t,e,r,s){const n=t.children,{fillStyle:i,strokeStyle:o}=Ub(t,e);i&&r?r={...r,...i}:i&&(r=i),o&&s?s={...s,...o}:o&&(s=o);const a=!r&&!s;a&&(r={color:0});let l,c,u,h,f,p,m,A,g,y,V,x,b,w,_,q,S;switch(t.nodeName.toLowerCase()){case"path":{w=t.getAttribute("d");const k=t.getAttribute("fill-rule"),C=NC(w),P=k==="evenodd",T=C.length>1;if(P&&T){const I=C.map(E=>({path:E,area:zC(E)}));if(I.sort((E,R)=>R.area-E.area),C.length>3||!OC(I))for(let E=0;E<I.length;E++){const R=I[E],D=E===0;e.context.beginPath();const F=new Er(void 0,!0);Zm(R.path,F),e.context.path(F),D?(r&&e.context.fill(r),s&&e.context.stroke(s)):e.context.cut()}else for(let E=0;E<I.length;E++){const R=I[E],D=E%2===1;e.context.beginPath();const F=new Er(void 0,!0);Zm(R.path,F),e.context.path(F),D?e.context.cut():(r&&e.context.fill(r),s&&e.context.stroke(s))}}else{const I=k?k==="evenodd":!0;_=new Er(w,I),e.context.path(_),r&&e.context.fill(r),s&&e.context.stroke(s)}break}case"circle":m=Me(t,"cx",0),A=Me(t,"cy",0),g=Me(t,"r",0),e.context.ellipse(m,A,g,g),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"rect":l=Me(t,"x",0),c=Me(t,"y",0),q=Me(t,"width",0),S=Me(t,"height",0),y=Me(t,"rx",0),V=Me(t,"ry",0),y||V?e.context.roundRect(l,c,q,S,y||V):e.context.rect(l,c,q,S),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"ellipse":m=Me(t,"cx",0),A=Me(t,"cy",0),y=Me(t,"rx",0),V=Me(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,A,y,V),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"line":u=Me(t,"x1",0),h=Me(t,"y1",0),f=Me(t,"x2",0),p=Me(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(f,p),s&&e.context.stroke(s);break;case"polygon":b=t.getAttribute("points"),x=b.match(/-?\d+/g).map(k=>parseInt(k,10)),e.context.poly(x,!0),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"polyline":b=t.getAttribute("points"),x=b.match(/-?\d+/g).map(k=>parseInt(k,10)),e.context.poly(x,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{Rt(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(r=null);for(let k=0;k<n.length;k++)$b(n[k],e,r,s)}function DC(t){return Ve.isColorLike(t)}function eg(t){return t instanceof Kk}function tg(t){return t instanceof So}function FC(t){return t instanceof Ae}function LC(t,e,r){const s=Ve.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?r.alpha:s.alpha,t.texture=Ae.WHITE,{...r,...t}}function UC(t,e,r){return t.texture=e,{...r,...t}}function rg(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function sg(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function $C(t,e){const r={...e,...t},s=Ve.shared.setValue(r.color);return r.alpha*=s.alpha,r.color=s.toNumber(),r}function Si(t,e){if(t==null)return null;const r={},s=t;return DC(t)?LC(r,t,e):FC(t)?UC(r,t,e):eg(t)?rg(r,t,e):tg(t)?sg(r,t,e):s.fill&&eg(s.fill)?rg(s,s.fill,e):s.fill&&tg(s.fill)?sg(s,s.fill,e):$C(s,e)}function ng(t,e){const{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...l}=e,c=Si(t,l);return c?{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...c}:null}const HC=new lt,ig=new de,zd=class cr extends ss{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=De("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new Er,this._transform=new de,this._fillStyle={...cr.defaultFillStyle},this._strokeStyle={...cr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new er,this._boundsDirty=!0}clone(){const e=new cr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Si(e,cr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=ng(e,cr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Si(e,cr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Si(e,cr.defaultStrokeStyle),this}texture(e,r,s,n,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:n||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?Ve.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Er,this}fill(e,r){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n?.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(e!=null&&(r!==void 0&&typeof e=="number"&&(ve(nt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=Si(e,cr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(lt.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s?.action==="fill"?r=s.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=ng(e,cr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(s);else{r.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,r,s,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,s,n,i,o),this}arcTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}arcToSvg(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,s,n,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*s+l.c*n+l.tx,l.b*s+l.d*n+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,s,n){return this._tick++,this._activePath.ellipse(e,r,s,n,this._transform.clone()),this}circle(e,r,s){return this._tick++,this._activePath.circle(e,r,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*r+s.tx,s.b*e+s.d*r+s.ty),this}moveTo(e,r){this._tick++;const s=this._transform,n=this._activePath.instructions,i=s.a*e+s.c*r+s.tx,o=s.b*e+s.d*r+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}rect(e,r,s,n){return this._tick++,this._activePath.rect(e,r,s,n,this._transform.clone()),this}roundRect(e,r,s,n,i){return this._tick++,this._activePath.roundRect(e,r,s,n,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,s,n,i=0,o){return this._tick++,this._activePath.regularPoly(e,r,s,n,i,o),this}roundPoly(e,r,s,n,i,o){return this._tick++,this._activePath.roundPoly(e,r,s,n,i,o),this}roundShape(e,r,s,n){return this._tick++,this._activePath.roundShape(e,r,s,n),this}filletRect(e,r,s,n,i){return this._tick++,this._activePath.filletRect(e,r,s,n,i),this}chamferRect(e,r,s,n,i,o){return this._tick++,this._activePath.chamferRect(e,r,s,n,i,o),this}star(e,r,s,n,i=0,o=0){return this._tick++,this._activePath.star(e,r,s,n,i,o,this._transform.clone()),this}svg(e){return this._tick++,BC(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,s,n,i,o){return e instanceof de?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,s,n,i,o),this)}transform(e,r,s,n,i,o){return e instanceof de?(this._transform.append(e),this):(ig.set(e,r,s,n,i,o),this._transform.append(ig),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r],n=s.action;if(n==="fill"){const i=s.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=s.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=s.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let s=!1;for(let n=0;n<r.length;n++){const i=r[n],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const f=c[u].transform,p=f?f.applyInverse(e,HC):e;if(i.action==="fill")s=h.contains(p.x,p.y);else{const A=l;s=h.strokeContains(p.x,p.y,A.width,A.alignment)}const m=o.hole;if(m){const A=m.shapePath?.shapePrimitives;if(A)for(let g=0;g<A.length;g++)A[g].shape.contains(p.x,p.y)&&(s=!1)}if(s)return!0}}return s}unload(){this.emit("unload",this);for(const e in this._gpuData)this._gpuData[e]?.destroy();this._gpuData=Object.create(null)}destroy(e=!1){if(this.destroyed)return;if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(s)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(s))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};zd.defaultFillStyle={color:16777215,alpha:1,texture:Ae.WHITE,matrix:null,fill:null,textureSpace:"local"};zd.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ae.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let ui=zd;var GC=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;class sl extends eb{constructor(e){e instanceof ui&&(e={context:e});const{context:r,roundPixels:s,...n}=e||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",r?this.context=r:(this.context=this._ownedContext=new ui,this.context.autoGarbageCollect=this.autoGarbageCollect),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=s??!1}set context(e){e!==this._context&&(this._context&&(this._context.off("update",this.onViewUpdate,this),this._context.off("unload",this.unload,this)),this._context=e,this._context.on("update",this.onViewUpdate,this),this._context.on("unload",this.unload,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_onTouch(e){this._gcLastUsed=e,this._context._gcLastUsed=e}_callContextMethod(e,r){return this.context[e](...r),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new sl(this._context.clone()):(this._ownedContext=null,new sl(this._context))}lineStyle(e,r,s){ve(nt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return e&&(n.width=e),r&&(n.color=r),s&&(n.alpha=s),this.context.strokeStyle=n,this}beginFill(e,r){ve(nt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return e!==void 0&&(s.color=e),r!==void 0&&(s.alpha=r),this.context.fillStyle=s,this}endFill(){ve(nt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==ui.defaultStrokeStyle.width||e.color!==ui.defaultStrokeStyle.color||e.alpha!==ui.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return ve(nt,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return ve(nt,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return ve(nt,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return ve(nt,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return ve(nt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return ve(nt,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class Nl extends Ae{static create(e){const{dynamic:r,...s}=e;return new Nl({source:new Ht(s),dynamic:r??!1})}resize(e,r,s){return this.source.resize(e,r,s),this}}Or.add(oS,aS);const UL=["yellow","cyan","green","magenta","white"],ko=25,$L=1e3/ko,Gn={amigaHiResPal:{name:"Amiga Hi-Res PAL",size:{x:640,y:512}},classicMac:{name:"Classic Mac",size:{x:512,y:384}},amigaLowResPal:{name:"Amiga Lo-Res PAL",size:{x:320,y:256}},zxSpectrum:{name:"ZX Spectrum",size:{x:256,y:192}},handheld:{name:"Handheld",size:{x:256,y:135}}},WC=Object.keys(Gn),YC={red:new Ve("#f00"),green:new Ve("#0f0"),blue:new Ve("#00f"),cyan:new Ve("#0ff"),magenta:new Ve("#f0f"),yellow:new Ve("#ff0"),black:new Ve("#000"),white:new Ve("#fff")},QC={red:new Ve("#B00"),green:new Ve("#0B0"),blue:new Ve("#00B"),cyan:new Ve("#0BB"),magenta:new Ve("#B0B"),yellow:new Ve("#BB0"),black:new Ve("#000"),white:new Ve("#BBB")};function HL(t,e){const{hue:r,shade:s}=typeof t=="object"?t:{hue:t,shade:e??"basic"};return(s==="dimmed"?QC:YC)[r]}const Na=()=>pt()==="mobile"||pt()==="tablet",pt=()=>{if(typeof globalThis.window>"u")return"server";const t=Kt().get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},KC=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,mn=[],Hb=new Set,GL=new Map;Hb.add=()=>{throw new Error("emptySet.add")};Hb.clear=()=>{throw new Error("emptySet.clear")};const fe=Object.freeze({}),nl=(t,e)=>e.split(".").reduce((r,s)=>r[s],t),XC=(t,e,r)=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){const o=s[i];n=n[o]}n[s[s.length-1]]=r},ua=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]},to=(t,...e)=>{const r={};for(const s of e)r[s]=t[s];return r},WL=(t,...e)=>{const r={...t};for(const s of e)delete r[s];return r},Gb=["world","screen","mixed"];var Xc,og;function JC(){if(og)return Xc;og=1;function t(s){if(Array.isArray(s))return!0;var n=s.length;return typeof n=="number"&&n>-1?n?0 in s&&n-1 in s:!0:!1}function e(s){var n=typeof s;return n==="object"?s===null?"null":t(s)?"array":s.constructor===Object?"pure-object":"object":n}function r(s,n){if(s===n||s!==s&&n!==n)return!0;var i=e(s),o=e(n);if(i!==o)return!1;if(i==="pure-object"){if(s===n)return!0;var a=Object.keys(s),l=Object.keys(n).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!n.hasOwnProperty(a[c]))return!1;var f=s[h],p=n[h];if(f===s||p===n||f===n||p===s)return f===p;if(!r(f,p))return!1}return!0}else if(i==="array"){if(s.length===n.length)for(var m=0;m<s.length;m++){var A=s[m],g=n[m];if(A===s||g===n||A===n||g===s)return A===g;if(!r(A,g))return!1}else return!1;return!0}else if(i==="object"){if(s.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return s.valueOf()===n.valueOf();if(s.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return s.toString()===n.toString()}return!1}return Xc=r,Xc}var ZC=JC();const eP=Qe(ZC),Bd=Iy.withTypes(),Y=jy.withTypes();rd.withTypes();const Wb=t=>()=>Y(t);var Yb=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(Yb||{});function ag(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var lg=bn;function Qb(t,e){if(t===e||!(lg(t)&&lg(e)||Array.isArray(t)&&Array.isArray(e)))return e;const r=Object.keys(e),s=Object.keys(t);let n=r.length===s.length;const i=Array.isArray(e)?[]:{};for(const o of r)i[o]=Qb(t[o],e[o]),n&&(n=t[o]===i[o]);return n?t:i}function gn(t){let e=0;for(const r in t)e++;return e}var cg=t=>[].concat(...t);function tP(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function il(t){return t!=null}function rP(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}function sP(t,e,r){return t.has(e)?t.get(e):t.set(e,r).get(e)}var ug=class{constructor(t,e=void 0){this.value=t,this.meta=e}},Dd=ft("__rtkq/focused"),Kb=ft("__rtkq/unfocused"),Fd=ft("__rtkq/online"),Xb=ft("__rtkq/offline");function Ld(t){return t.type==="query"}function nP(t){return t.type==="mutation"}function Ud(t){return t.type==="infinitequery"}function $d(t,e,r,s,n,i){return iP(t)?t(e,r,s,n).filter(il).map(Ah).map(i):Array.isArray(t)?t.map(Ah).map(i):[]}function iP(t){return typeof t=="function"}function Ah(t){return typeof t=="string"?{type:t}:t}function oP(t,e){return t.catch(e)}var ro=Symbol("forceQueryFn"),yh=t=>typeof t[ro]=="function";function aP({serializeQueryArgs:t,queryThunk:e,infiniteQueryThunk:r,mutationThunk:s,api:n,context:i}){const o=new Map,a=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:u}=n.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:y,buildInitiateMutation:V,getRunningQueryThunk:h,getRunningMutationThunk:f,getRunningQueriesThunk:p,getRunningMutationsThunk:m};function h(x,b){return w=>{const _=i.endpointDefinitions[x],q=t({queryArgs:b,endpointDefinition:_,endpointName:x});return o.get(w)?.[q]}}function f(x,b){return w=>a.get(w)?.[b]}function p(){return x=>Object.values(o.get(x)||{}).filter(il)}function m(){return x=>Object.values(a.get(x)||{}).filter(il)}function A(x,b){const w=(_,{subscribe:q=!0,forceRefetch:S,subscriptionOptions:k,[ro]:C,...P}={})=>(T,M)=>{const I=t({queryArgs:_,endpointDefinition:b,endpointName:x});let B;const E={...P,type:"query",subscribe:q,forceRefetch:S,subscriptionOptions:k,endpointName:x,originalArgs:_,queryCacheKey:I,[ro]:C};if(Ld(b))B=e(E);else{const{direction:ce,initialPageParam:Be}=P;B=r({...E,direction:ce,initialPageParam:Be})}const R=n.endpoints[x].select(_),D=T(B),F=R(M()),{requestId:W,abort:me}=D,ie=F.requestId!==W,te=o.get(T)?.[I],ge=()=>R(M()),oe=Object.assign(C?D.then(ge):ie&&!te?Promise.resolve(F):Promise.all([te,D]).then(ge),{arg:_,requestId:W,subscriptionOptions:k,queryCacheKey:I,abort:me,async unwrap(){const ce=await oe;if(ce.isError)throw ce.error;return ce.data},refetch:()=>T(w(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){q&&T(l({queryCacheKey:I,requestId:W}))},updateSubscriptionOptions(ce){oe.subscriptionOptions=ce,T(u({endpointName:x,requestId:W,queryCacheKey:I,options:ce}))}});if(!te&&!ie&&!C){const ce=sP(o,T,{});ce[I]=oe,oe.then(()=>{delete ce[I],gn(ce)||o.delete(T)})}return oe};return w}function g(x,b){return A(x,b)}function y(x,b){return A(x,b)}function V(x){return(b,{track:w=!0,fixedCacheKey:_}={})=>(q,S)=>{const k=s({type:"mutation",endpointName:x,originalArgs:b,track:w,fixedCacheKey:_}),C=q(k),{requestId:P,abort:T,unwrap:M}=C,I=oP(C.unwrap().then(D=>({data:D})),D=>({error:D})),B=()=>{q(c({requestId:P,fixedCacheKey:_}))},E=Object.assign(I,{arg:C.arg,requestId:P,abort:T,unwrap:M,reset:B}),R=a.get(q)||{};return a.set(q,R),R[P]=E,E.then(()=>{delete R[P],gn(R)||a.delete(q)}),_&&(R[_]=E,E.then(()=>{R[_]===E&&(delete R[_],gn(R)||a.delete(q))})),E}}}function lP(t){return t}var ha=(t={})=>({...t,[Sl]:!0});function cP({reducerPath:t,baseQuery:e,context:{endpointDefinitions:r},serializeQueryArgs:s,api:n,assertTagType:i,selectors:o}){const a=(S,k,C,P)=>(T,M)=>{const I=r[S],B=s({queryArgs:k,endpointDefinition:I,endpointName:S});if(T(n.internalActions.queryResultPatched({queryCacheKey:B,patches:C})),!P)return;const E=n.endpoints[S].select(k)(M()),R=$d(I.providesTags,E.data,void 0,k,{},i);T(n.internalActions.updateProvidedBy({queryCacheKey:B,providedTags:R}))};function l(S,k,C=0){const P=[k,...S];return C&&P.length>C?P.slice(0,-1):P}function c(S,k,C=0){const P=[...S,k];return C&&P.length>C?P.slice(1):P}const u=(S,k,C,P=!0)=>(T,M)=>{const B=n.endpoints[S].select(k)(M()),E={patches:[],inversePatches:[],undo:()=>T(n.util.patchQueryData(S,k,E.inversePatches,P))};if(B.status==="uninitialized")return E;let R;if("data"in B)if(Zt(B.data)){const[D,F,W]=Ky(B.data,C);E.patches.push(...F),E.inversePatches.push(...W),R=D}else R=C(B.data),E.patches.push({op:"replace",path:[],value:R}),E.inversePatches.push({op:"replace",path:[],value:B.data});return E.patches.length===0||T(n.util.patchQueryData(S,k,E.patches,P)),E},h=(S,k,C)=>P=>P(n.endpoints[S].initiate(k,{subscribe:!1,forceRefetch:!0,[ro]:()=>({data:C})})),f=(S,k)=>S.query&&S[k]?S[k]:lP,p=async(S,{signal:k,abort:C,rejectWithValue:P,fulfillWithValue:T,dispatch:M,getState:I,extra:B})=>{const E=r[S.endpointName];try{let R=f(E,"transformResponse");const D={signal:k,abort:C,dispatch:M,getState:I,extra:B,endpoint:S.endpointName,type:S.type,forced:S.type==="query"?m(S,I()):void 0,queryCacheKey:S.type==="query"?S.queryCacheKey:void 0},F=S.type==="query"?S[ro]:void 0;let W;const me=async(te,ge,oe,ce)=>{if(ge==null&&te.pages.length)return Promise.resolve({data:te});const Be={queryArg:S.originalArgs,pageParam:ge},nr=await ie(Be),yt=ce?l:c;return{data:{pages:yt(te.pages,nr.data,oe),pageParams:yt(te.pageParams,ge,oe)}}};async function ie(te){let ge;const{extraOptions:oe}=E;if(F?ge=F():E.query?ge=await e(E.query(te),D,oe):ge=await E.queryFn(te,D,oe,Be=>e(Be,D,oe)),typeof process<"u",ge.error)throw new ug(ge.error,ge.meta);const ce=await R(ge.data,ge.meta,te);return{...ge,data:ce}}if(S.type==="query"&&"infiniteQueryOptions"in E){const{infiniteQueryOptions:te}=E,{maxPages:ge=1/0}=te;let oe;const ce={pages:[],pageParams:[]},Be=o.selectQueryEntry(I(),S.queryCacheKey)?.data,yt=m(S,I())&&!S.direction||!Be?ce:Be;if("direction"in S&&S.direction&&yt.pages.length){const Gt=S.direction==="backward",St=(Gt?Jb:xh)(te,yt);oe=await me(yt,St,ge,Gt)}else{const{initialPageParam:Gt=te.initialPageParam}=S,Ar=Be?.pageParams??[],St=Ar[0]??Gt,xt=Ar.length;oe=await me(yt,St,ge),F&&(oe={data:oe.data.pages[0]});for(let ir=1;ir<xt;ir++){const yr=xh(te,oe.data);oe=await me(oe.data,yr,ge)}}W=oe}else W=await ie(S.originalArgs);return T(W.data,ha({fulfilledTimeStamp:Date.now(),baseQueryMeta:W.meta}))}catch(R){let D=R;if(D instanceof ug){let F=f(E,"transformErrorResponse");try{return P(await F(D.value,D.meta,S.originalArgs),ha({baseQueryMeta:D.meta}))}catch(W){D=W}}throw console.error(D),D}};function m(S,k){const C=o.selectQueryEntry(k,S.queryCacheKey),P=o.selectConfig(k).refetchOnMountOrArgChange,T=C?.fulfilledTimeStamp,M=S.forceRefetch??(S.subscribe&&P);return M?M===!0||(Number(new Date)-Number(T))/1e3>=M:!1}const A=()=>cp(`${t}/executeQuery`,p,{getPendingMeta({arg:k}){const C=r[k.endpointName];return ha({startedTimeStamp:Date.now(),...Ud(C)?{direction:k.direction}:{}})},condition(k,{getState:C}){const P=C(),T=o.selectQueryEntry(P,k.queryCacheKey),M=T?.fulfilledTimeStamp,I=k.originalArgs,B=T?.originalArgs,E=r[k.endpointName],R=k.direction;return yh(k)?!0:T?.status==="pending"?!1:m(k,P)||Ld(E)&&E?.forceRefetch?.({currentArg:I,previousArg:B,endpointState:T,state:P})?!0:!(M&&!R)},dispatchConditionRejection:!0}),g=A(),y=A(),V=cp(`${t}/executeMutation`,p,{getPendingMeta(){return ha({startedTimeStamp:Date.now()})}}),x=S=>"force"in S,b=S=>"ifOlderThan"in S,w=(S,k,C)=>(P,T)=>{const M=x(C)&&C.force,I=b(C)&&C.ifOlderThan,B=(R=!0)=>{const D={forceRefetch:R,isPrefetch:!0};return n.endpoints[S].initiate(k,D)},E=n.endpoints[S].select(k)(T());if(M)P(B());else if(I){const R=E?.fulfilledTimeStamp;if(!R){P(B());return}(Number(new Date)-Number(new Date(R)))/1e3>=I&&P(B())}else P(B(!1))};function _(S){return k=>k?.meta?.arg?.endpointName===S}function q(S,k){return{matchPending:Ii(dd(S),_(k)),matchFulfilled:Ii(Jr(S),_(k)),matchRejected:Ii(Vn(S),_(k))}}return{queryThunk:g,mutationThunk:V,infiniteQueryThunk:y,prefetch:w,updateQueryData:u,upsertQueryData:h,patchQueryData:a,buildMatchThunkActions:q}}function xh(t,{pages:e,pageParams:r}){const s=e.length-1;return t.getNextPageParam(e[s],e,r[s],r)}function Jb(t,{pages:e,pageParams:r}){return t.getPreviousPageParam?.(e[0],e,r[0],r)}function Zb(t,e,r,s){return $d(r[t.meta.arg.endpointName][e],Jr(t)?t.payload:void 0,Cl(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,s)}function da(t,e,r){const s=t[e];s&&r(s)}function so(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function hg(t,e,r){const s=t[so(e)];s&&r(s)}var hi={};function uP({reducerPath:t,queryThunk:e,mutationThunk:r,serializeQueryArgs:s,context:{endpointDefinitions:n,apiUid:i,extractRehydrationInfo:o,hasRehydrationInfo:a},assertTagType:l,config:c}){const u=ft(`${t}/resetApiState`);function h(q,S,k,C){q[S.queryCacheKey]??={status:"uninitialized",endpointName:S.endpointName},da(q,S.queryCacheKey,P=>{P.status="pending",P.requestId=k&&P.requestId?P.requestId:C.requestId,S.originalArgs!==void 0&&(P.originalArgs=S.originalArgs),P.startedTimeStamp=C.startedTimeStamp;const T=n[C.arg.endpointName];Ud(T)&&"direction"in S&&(P.direction=S.direction)})}function f(q,S,k,C){da(q,S.arg.queryCacheKey,P=>{if(P.requestId!==S.requestId&&!C)return;const{merge:T}=n[S.arg.endpointName];if(P.status="fulfilled",T)if(P.data!==void 0){const{fulfilledTimeStamp:M,arg:I,baseQueryMeta:B,requestId:E}=S;let R=Bn(P.data,D=>T(D,k,{arg:I.originalArgs,baseQueryMeta:B,fulfilledTimeStamp:M,requestId:E}));P.data=R}else P.data=k;else P.data=n[S.arg.endpointName].structuralSharing??!0?Qb(dr(P.data)?mv(P.data):P.data,k):k;delete P.error,P.fulfilledTimeStamp=S.fulfilledTimeStamp})}const p=vr({name:`${t}/queries`,initialState:hi,reducers:{removeQueryResult:{reducer(q,{payload:{queryCacheKey:S}}){delete q[S]},prepare:ei()},cacheEntriesUpserted:{reducer(q,S){for(const k of S.payload){const{queryDescription:C,value:P}=k;h(q,C,!0,{arg:C,requestId:S.meta.requestId,startedTimeStamp:S.meta.timestamp}),f(q,{arg:C,requestId:S.meta.requestId,fulfilledTimeStamp:S.meta.timestamp,baseQueryMeta:{}},P,!0)}},prepare:q=>({payload:q.map(C=>{const{endpointName:P,arg:T,value:M}=C,I=n[P];return{queryDescription:{type:"query",endpointName:P,originalArgs:C.arg,queryCacheKey:s({queryArgs:T,endpointDefinition:I,endpointName:P})},value:M}}),meta:{[Sl]:!0,requestId:bo(),timestamp:Date.now()}})},queryResultPatched:{reducer(q,{payload:{queryCacheKey:S,patches:k}}){da(q,S,C=>{C.data=rp(C.data,k.concat())})},prepare:ei()}},extraReducers(q){q.addCase(e.pending,(S,{meta:k,meta:{arg:C}})=>{const P=yh(C);h(S,C,P,k)}).addCase(e.fulfilled,(S,{meta:k,payload:C})=>{const P=yh(k.arg);f(S,k,C,P)}).addCase(e.rejected,(S,{meta:{condition:k,arg:C,requestId:P},error:T,payload:M})=>{da(S,C.queryCacheKey,I=>{if(!k){if(I.requestId!==P)return;I.status="rejected",I.error=M??T}})}).addMatcher(a,(S,k)=>{const{queries:C}=o(k);for(const[P,T]of Object.entries(C))(T?.status==="fulfilled"||T?.status==="rejected")&&(S[P]=T)})}}),m=vr({name:`${t}/mutations`,initialState:hi,reducers:{removeMutationResult:{reducer(q,{payload:S}){const k=so(S);k in q&&delete q[k]},prepare:ei()}},extraReducers(q){q.addCase(r.pending,(S,{meta:k,meta:{requestId:C,arg:P,startedTimeStamp:T}})=>{P.track&&(S[so(k)]={requestId:C,status:"pending",endpointName:P.endpointName,startedTimeStamp:T})}).addCase(r.fulfilled,(S,{payload:k,meta:C})=>{C.arg.track&&hg(S,C,P=>{P.requestId===C.requestId&&(P.status="fulfilled",P.data=k,P.fulfilledTimeStamp=C.fulfilledTimeStamp)})}).addCase(r.rejected,(S,{payload:k,error:C,meta:P})=>{P.arg.track&&hg(S,P,T=>{T.requestId===P.requestId&&(T.status="rejected",T.error=k??C)})}).addMatcher(a,(S,k)=>{const{mutations:C}=o(k);for(const[P,T]of Object.entries(C))(T?.status==="fulfilled"||T?.status==="rejected")&&P!==T?.requestId&&(S[P]=T)})}}),A=vr({name:`${t}/invalidation`,initialState:hi,reducers:{updateProvidedBy:{reducer(q,S){const{queryCacheKey:k,providedTags:C}=S.payload;for(const P of Object.values(q))for(const T of Object.values(P)){const M=T.indexOf(k);M!==-1&&T.splice(M,1)}for(const{type:P,id:T}of C){const M=(q[P]??={})[T||"__internal_without_id"]??=[];M.includes(k)||M.push(k)}},prepare:ei()}},extraReducers(q){q.addCase(p.actions.removeQueryResult,(S,{payload:{queryCacheKey:k}})=>{for(const C of Object.values(S))for(const P of Object.values(C)){const T=P.indexOf(k);T!==-1&&P.splice(T,1)}}).addMatcher(a,(S,k)=>{const{provided:C}=o(k);for(const[P,T]of Object.entries(C))for(const[M,I]of Object.entries(T)){const B=(S[P]??={})[M||"__internal_without_id"]??=[];for(const E of I)B.includes(E)||B.push(E)}}).addMatcher(fr(Jr(e),Cl(e)),(S,k)=>{g(S,k)}).addMatcher(p.actions.cacheEntriesUpserted.match,(S,k)=>{for(const{queryDescription:C,value:P}of k.payload)g(S,{type:"UNKNOWN",payload:P,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:C}})})}});function g(q,S){const k=Zb(S,"providesTags",n,l),{queryCacheKey:C}=S.meta.arg;A.caseReducers.updateProvidedBy(q,A.actions.updateProvidedBy({queryCacheKey:C,providedTags:k}))}const y=vr({name:`${t}/subscriptions`,initialState:hi,reducers:{updateSubscriptionOptions(q,S){},unsubscribeQueryResult(q,S){},internal_getRTKQSubscriptions(){}}}),V=vr({name:`${t}/internalSubscriptions`,initialState:hi,reducers:{subscriptionsUpdated:{reducer(q,S){return rp(q,S.payload)},prepare:ei()}}}),x=vr({name:`${t}/config`,initialState:{online:rP(),focused:tP(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(q,{payload:S}){q.middlewareRegistered=q.middlewareRegistered==="conflict"||i!==S?"conflict":!0}},extraReducers:q=>{q.addCase(Fd,S=>{S.online=!0}).addCase(Xb,S=>{S.online=!1}).addCase(Dd,S=>{S.focused=!0}).addCase(Kb,S=>{S.focused=!1}).addMatcher(a,S=>({...S}))}}),b=ad({queries:p.reducer,mutations:m.reducer,provided:A.reducer,subscriptions:V.reducer,config:x.reducer}),w=(q,S)=>b(u.match(S)?void 0:q,S),_={...x.actions,...p.actions,...y.actions,...V.actions,...m.actions,...A.actions,resetApiState:u};return{reducer:w,actions:_}}var _r=Symbol.for("RTKQ/skipToken"),eV={status:"uninitialized"},dg=Bn(eV,()=>{}),fg=Bn(eV,()=>{});function hP({serializeQueryArgs:t,reducerPath:e,createSelector:r}){const s=x=>dg,n=x=>fg;return{buildQuerySelector:f,buildInfiniteQuerySelector:p,buildMutationSelector:m,selectInvalidatedBy:A,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function i(x){return{...x,...ag(x.status)}}function o(x){return x[e]}function a(x){return o(x)?.queries}function l(x,b){return a(x)?.[b]}function c(x){return o(x)?.mutations}function u(x){return o(x)?.config}function h(x,b,w){return _=>{if(_===_r)return r(s,w);const q=t({queryArgs:_,endpointDefinition:b,endpointName:x});return r(k=>l(k,q)??dg,w)}}function f(x,b){return h(x,b,i)}function p(x,b){const{infiniteQueryOptions:w}=b;function _(q){const S={...q,...ag(q.status)},{isLoading:k,isError:C,direction:P}=S,T=P==="forward",M=P==="backward";return{...S,hasNextPage:y(w,S.data),hasPreviousPage:V(w,S.data),isFetchingNextPage:k&&T,isFetchingPreviousPage:k&&M,isFetchNextPageError:C&&T,isFetchPreviousPageError:C&&M}}return h(x,b,_)}function m(){return x=>{let b;return typeof x=="object"?b=so(x)??_r:b=x,r(b===_r?n:q=>o(q)?.mutations?.[b]??fg,i)}}function A(x,b){const w=x[e],_=new Set;for(const q of b.filter(il).map(Ah)){const S=w.provided[q.type];if(!S)continue;let k=(q.id!==void 0?S[q.id]:cg(Object.values(S)))??[];for(const C of k)_.add(C)}return cg(Array.from(_.values()).map(q=>{const S=w.queries[q];return S?[{queryCacheKey:q,endpointName:S.endpointName,originalArgs:S.originalArgs}]:[]}))}function g(x,b){return Object.values(a(x)).filter(w=>w?.endpointName===b&&w.status!=="uninitialized").map(w=>w.originalArgs)}function y(x,b){return b?xh(x,b)!=null:!1}function V(x,b){return!b||!x.getPreviousPageParam?!1:Jb(x,b)!=null}}var pg=WeakMap?new WeakMap:void 0,bh=({endpointName:t,queryArgs:e})=>{let r="";const s=pg?.get(e);if(typeof s=="string")r=s;else{const n=JSON.stringify(e,(i,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=bn(o)?Object.keys(o).sort().reduce((a,l)=>(a[l]=o[l],a),{}):o,o));bn(e)&&pg?.set(e,n),r=n}return`${t}(${r})`};function tV(...t){return function(r){const s=Ka(c=>r.extractRehydrationInfo?.(c,{reducerPath:r.reducerPath??"api"})),n={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:s,serializeQueryArgs(c){let u=bh;if("serializeQueryArgs"in c.endpointDefinition){const h=c.endpointDefinition.serializeQueryArgs;u=f=>{const p=h(f);return typeof p=="string"?p:bh({...f,queryArgs:p})}}else r.serializeQueryArgs&&(u=r.serializeQueryArgs);return u(c)},tagTypes:[...r.tagTypes||[]]},i={endpointDefinitions:{},batch(c){c()},apiUid:bo(),extractRehydrationInfo:s,hasRehydrationInfo:Ka(c=>s(c)!=null)},o={injectEndpoints:l,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const h of c)n.tagTypes.includes(h)||n.tagTypes.push(h);if(u)for(const[h,f]of Object.entries(u))typeof f=="function"?f(i.endpointDefinitions[h]):Object.assign(i.endpointDefinitions[h]||{},f);return o}},a=t.map(c=>c.init(o,n,i));function l(c){const u=c.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"}),infiniteQuery:h=>({...h,type:"infinitequery"})});for(const[h,f]of Object.entries(u)){if(c.overrideExisting!==!0&&h in i.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(Ye(39));continue}i.endpointDefinitions[h]=f;for(const p of a)p.injectEndpoint(h,f)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function dP(){return function(){throw new Error(Ye(33))}}function Vr(t,...e){return Object.assign(t,...e)}var fP=({api:t,queryThunk:e,internalState:r})=>{const s=`${t.reducerPath}/subscriptions`;let n=null,i=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=t.internalActions,l=(p,m)=>{if(o.match(m)){const{queryCacheKey:g,requestId:y,options:V}=m.payload;return p?.[g]?.[y]&&(p[g][y]=V),!0}if(a.match(m)){const{queryCacheKey:g,requestId:y}=m.payload;return p[g]&&delete p[g][y],!0}if(t.internalActions.removeQueryResult.match(m))return delete p[m.payload.queryCacheKey],!0;if(e.pending.match(m)){const{meta:{arg:g,requestId:y}}=m,V=p[g.queryCacheKey]??={};return V[`${y}_running`]={},g.subscribe&&(V[y]=g.subscriptionOptions??V[y]??{}),!0}let A=!1;if(e.fulfilled.match(m)||e.rejected.match(m)){const g=p[m.meta.arg.queryCacheKey]||{},y=`${m.meta.requestId}_running`;A||=!!g[y],delete g[y]}if(e.rejected.match(m)){const{meta:{condition:g,arg:y,requestId:V}}=m;if(g&&y.subscribe){const x=p[y.queryCacheKey]??={};x[V]=y.subscriptionOptions??x[V]??{},A=!0}}return A},c=()=>r.currentSubscriptions,f={getSubscriptions:c,getSubscriptionCount:p=>{const A=c()[p]??{};return gn(A)},isRequestSubscribed:(p,m)=>!!c()?.[p]?.[m]};return(p,m)=>{if(n||(n=JSON.parse(JSON.stringify(r.currentSubscriptions))),t.util.resetApiState.match(p))return n=r.currentSubscriptions={},i=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(p))return[!1,f];const A=l(r.currentSubscriptions,p);let g=!0;if(A){i||(i=setTimeout(()=>{const x=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,b]=Ky(n,()=>x);m.next(t.internalActions.subscriptionsUpdated(b)),n=x,i=null},500));const y=typeof p.type=="string"&&!!p.type.startsWith(s),V=e.rejected.match(p)&&p.meta.condition&&!!p.meta.arg.subscribe;g=!y&&!V}return[g,!1]}};function pP(t){for(const e in t)return!1;return!0}var mP=2147483647/1e3-1,gP=({reducerPath:t,api:e,queryThunk:r,context:s,internalState:n,selectors:{selectQueryEntry:i,selectConfig:o}})=>{const{removeQueryResult:a,unsubscribeQueryResult:l,cacheEntriesUpserted:c}=e.internalActions,u=fr(l.match,r.fulfilled,r.rejected,c.match);function h(g){const y=n.currentSubscriptions[g];return!!y&&!pP(y)}const f={},p=(g,y,V)=>{const x=y.getState(),b=o(x);if(u(g)){let w;if(c.match(g))w=g.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=l.match(g)?g.payload:g.meta.arg;w=[_]}m(w,y,b)}if(e.util.resetApiState.match(g))for(const[w,_]of Object.entries(f))_&&clearTimeout(_),delete f[w];if(s.hasRehydrationInfo(g)){const{queries:w}=s.extractRehydrationInfo(g);m(Object.keys(w),y,b)}};function m(g,y,V){const x=y.getState();for(const b of g){const w=i(x,b);A(b,w?.endpointName,y,V)}}function A(g,y,V,x){const w=s.endpointDefinitions[y]?.keepUnusedDataFor??x.keepUnusedDataFor;if(w===1/0)return;const _=Math.max(0,Math.min(w,mP));if(!h(g)){const q=f[g];q&&clearTimeout(q),f[g]=setTimeout(()=>{h(g)||V.dispatch(a({queryCacheKey:g})),delete f[g]},_*1e3)}}return p},mg=new Error("Promise never resolved before cacheEntryRemoved."),AP=({api:t,reducerPath:e,context:r,queryThunk:s,mutationThunk:n,internalState:i,selectors:{selectQueryEntry:o,selectApiState:a}})=>{const l=Qu(s),c=Qu(n),u=Jr(s,n),h={};function f(y,V,x){const b=h[y];b?.valueResolved&&(b.valueResolved({data:V,meta:x}),delete b.valueResolved)}function p(y){const V=h[y];V&&(delete h[y],V.cacheEntryRemoved())}const m=(y,V,x)=>{const b=A(y);function w(_,q,S,k){const C=o(x,q),P=o(V.getState(),q);!C&&P&&g(_,k,q,V,S)}if(s.pending.match(y))w(y.meta.arg.endpointName,b,y.meta.requestId,y.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(y))for(const{queryDescription:_,value:q}of y.payload){const{endpointName:S,originalArgs:k,queryCacheKey:C}=_;w(S,C,y.meta.requestId,k),f(C,q,{})}else if(n.pending.match(y))V.getState()[e].mutations[b]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,b,V,y.meta.requestId);else if(u(y))f(b,y.payload,y.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(y)||t.internalActions.removeMutationResult.match(y))p(b);else if(t.util.resetApiState.match(y))for(const _ of Object.keys(h))p(_)};function A(y){return l(y)?y.meta.arg.queryCacheKey:c(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:t.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:t.internalActions.removeMutationResult.match(y)?so(y.payload):""}function g(y,V,x,b,w){const _=r.endpointDefinitions[y],q=_?.onCacheEntryAdded;if(!q)return;const S={},k=new Promise(B=>{S.cacheEntryRemoved=B}),C=Promise.race([new Promise(B=>{S.valueResolved=B}),k.then(()=>{throw mg})]);C.catch(()=>{}),h[x]=S;const P=t.endpoints[y].select(_.type==="query"?V:x),T=b.dispatch((B,E,R)=>R),M={...b,getCacheEntry:()=>P(b.getState()),requestId:w,extra:T,updateCachedData:_.type==="query"?B=>b.dispatch(t.util.updateQueryData(y,V,B)):void 0,cacheDataLoaded:C,cacheEntryRemoved:k},I=q(V,M);Promise.resolve(I).catch(B=>{if(B!==mg)throw B})}return m},yP=({api:t,context:{apiUid:e},reducerPath:r})=>(s,n)=>{t.util.resetApiState.match(s)&&n.dispatch(t.internalActions.middlewareRegistered(e))},xP=({reducerPath:t,context:e,context:{endpointDefinitions:r},mutationThunk:s,queryThunk:n,api:i,assertTagType:o,refetchQuery:a,internalState:l})=>{const{removeQueryResult:c}=i.internalActions,u=fr(Jr(s),Cl(s)),h=fr(Jr(s,n),Vn(s,n));let f=[];const p=(g,y)=>{u(g)?A(Zb(g,"invalidatesTags",r,o),y):h(g)?A([],y):i.util.invalidateTags.match(g)&&A($d(g.payload,void 0,void 0,void 0,void 0,o),y)};function m(g){const{queries:y,mutations:V}=g;for(const x of[y,V])for(const b in x)if(x[b]?.status==="pending")return!0;return!1}function A(g,y){const V=y.getState(),x=V[t];if(f.push(...g),x.config.invalidationBehavior==="delayed"&&m(x))return;const b=f;if(f=[],b.length===0)return;const w=i.util.selectInvalidatedBy(V,b);e.batch(()=>{const _=Array.from(w.values());for(const{queryCacheKey:q}of _){const S=x.queries[q],k=l.currentSubscriptions[q]??{};S&&(gn(k)===0?y.dispatch(c({queryCacheKey:q})):S.status!=="uninitialized"&&y.dispatch(a(S)))}})}return p},bP=({reducerPath:t,queryThunk:e,api:r,refetchQuery:s,internalState:n})=>{const i={},o=(f,p)=>{(r.internalActions.updateSubscriptionOptions.match(f)||r.internalActions.unsubscribeQueryResult.match(f))&&l(f.payload,p),(e.pending.match(f)||e.rejected.match(f)&&f.meta.condition)&&l(f.meta.arg,p),(e.fulfilled.match(f)||e.rejected.match(f)&&!f.meta.condition)&&a(f.meta.arg,p),r.util.resetApiState.match(f)&&u()};function a({queryCacheKey:f},p){const m=p.getState()[t],A=m.queries[f],g=n.currentSubscriptions[f];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y,skipPollingIfUnfocused:V}=h(g);if(!Number.isFinite(y))return;const x=i[f];x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);const b=Date.now()+y;i[f]={nextPollTimestamp:b,pollingInterval:y,timeout:setTimeout(()=>{(m.config.focused||!V)&&p.dispatch(s(A)),a({queryCacheKey:f},p)},y)}}function l({queryCacheKey:f},p){const A=p.getState()[t].queries[f],g=n.currentSubscriptions[f];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y}=h(g);if(!Number.isFinite(y)){c(f);return}const V=i[f],x=Date.now()+y;(!V||x<V.nextPollTimestamp)&&a({queryCacheKey:f},p)}function c(f){const p=i[f];p?.timeout&&clearTimeout(p.timeout),delete i[f]}function u(){for(const f of Object.keys(i))c(f)}function h(f={}){let p=!1,m=Number.POSITIVE_INFINITY;for(let A in f)f[A].pollingInterval&&(m=Math.min(f[A].pollingInterval,m),p=f[A].skipPollingIfUnfocused||p);return{lowestPollingInterval:m,skipPollingIfUnfocused:p}}return o},VP=({api:t,context:e,queryThunk:r,mutationThunk:s})=>{const n=dd(r,s),i=Vn(r,s),o=Jr(r,s),a={};return(c,u)=>{if(n(c)){const{requestId:h,arg:{endpointName:f,originalArgs:p}}=c.meta,m=e.endpointDefinitions[f],A=m?.onQueryStarted;if(A){const g={},y=new Promise((w,_)=>{g.resolve=w,g.reject=_});y.catch(()=>{}),a[h]=g;const V=t.endpoints[f].select(m.type==="query"?p:h),x=u.dispatch((w,_,q)=>q),b={...u,getCacheEntry:()=>V(u.getState()),requestId:h,extra:x,updateCachedData:m.type==="query"?w=>u.dispatch(t.util.updateQueryData(f,p,w)):void 0,queryFulfilled:y};A(p,b)}}else if(o(c)){const{requestId:h,baseQueryMeta:f}=c.meta;a[h]?.resolve({data:c.payload,meta:f}),delete a[h]}else if(i(c)){const{requestId:h,rejectedWithValue:f,baseQueryMeta:p}=c.meta;a[h]?.reject({error:c.payload??c.error,isUnhandledError:!f,meta:p}),delete a[h]}}},qP=({reducerPath:t,context:e,api:r,refetchQuery:s,internalState:n})=>{const{removeQueryResult:i}=r.internalActions,o=(l,c)=>{Dd.match(l)&&a(c,"refetchOnFocus"),Fd.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){const u=l.getState()[t],h=u.queries,f=n.currentSubscriptions;e.batch(()=>{for(const p of Object.keys(f)){const m=h[p],A=f[p];if(!A||!m)continue;(Object.values(A).some(y=>y[c]===!0)||Object.values(A).every(y=>y[c]===void 0)&&u.config[c])&&(gn(A)===0?l.dispatch(i({queryCacheKey:p})):m.status!=="uninitialized"&&l.dispatch(s(m)))}})}return o};function wP(t){const{reducerPath:e,queryThunk:r,api:s,context:n}=t,{apiUid:i}=n,o={invalidateTags:ft(`${e}/invalidateTags`)},a=h=>h.type.startsWith(`${e}/`),l=[yP,gP,xP,bP,AP,VP];return{middleware:h=>{let f=!1;const m={...t,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},A=l.map(V=>V(m)),g=fP(m),y=qP(m);return V=>x=>{if(!ld(x))return V(x);f||(f=!0,h.dispatch(s.internalActions.middlewareRegistered(i)));const b={...h,next:V},w=h.getState(),[_,q]=g(x,b,w);let S;if(_?S=V(x):S=q,h.getState()[e]&&(y(x,b,w),a(x)||n.hasRehydrationInfo(x)))for(const k of A)k(x,b,w);return S}},actions:o};function u(h){return t.api.endpoints[h.endpointName].initiate(h.originalArgs,{subscribe:!1,forceRefetch:!0})}}var gg=Symbol(),rV=({createSelector:t=_l}={})=>({name:gg,init(e,{baseQuery:r,tagTypes:s,reducerPath:n,serializeQueryArgs:i,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u},h){_v();const f=ie=>ie;Object.assign(e,{reducerPath:n,endpoints:{},internalActions:{onOnline:Fd,onOffline:Xb,onFocus:Dd,onFocusLost:Kb},util:{}});const p=hP({serializeQueryArgs:i,reducerPath:n,createSelector:t}),{selectInvalidatedBy:m,selectCachedArgsForQuery:A,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:V}=p;Vr(e.util,{selectInvalidatedBy:m,selectCachedArgsForQuery:A});const{queryThunk:x,infiniteQueryThunk:b,mutationThunk:w,patchQueryData:_,updateQueryData:q,upsertQueryData:S,prefetch:k,buildMatchThunkActions:C}=cP({baseQuery:r,reducerPath:n,context:h,api:e,serializeQueryArgs:i,assertTagType:f,selectors:p}),{reducer:P,actions:T}=uP({context:h,queryThunk:x,mutationThunk:w,serializeQueryArgs:i,reducerPath:n,assertTagType:f,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:n,invalidationBehavior:u}});Vr(e.util,{patchQueryData:_,updateQueryData:q,upsertQueryData:S,prefetch:k,resetApiState:T.resetApiState,upsertQueryEntries:T.cacheEntriesUpserted}),Vr(e.internalActions,T);const{middleware:M,actions:I}=wP({reducerPath:n,context:h,queryThunk:x,mutationThunk:w,infiniteQueryThunk:b,api:e,assertTagType:f,selectors:p});Vr(e.util,I),Vr(e,{reducer:P,middleware:M});const{buildInitiateQuery:B,buildInitiateInfiniteQuery:E,buildInitiateMutation:R,getRunningMutationThunk:D,getRunningMutationsThunk:F,getRunningQueriesThunk:W,getRunningQueryThunk:me}=aP({queryThunk:x,mutationThunk:w,infiniteQueryThunk:b,api:e,serializeQueryArgs:i,context:h});return Vr(e.util,{getRunningMutationThunk:D,getRunningMutationsThunk:F,getRunningQueryThunk:me,getRunningQueriesThunk:W}),{name:gg,injectEndpoint(ie,te){const ge=e,oe=ge.endpoints[ie]??={};Ld(te)&&Vr(oe,{name:ie,select:g(ie,te),initiate:B(ie,te)},C(x,ie)),nP(te)&&Vr(oe,{name:ie,select:V(),initiate:R(ie)},C(w,ie)),Ud(te)&&Vr(oe,{name:ie,select:y(ie,te),initiate:E(ie,te)},C(x,ie))}}}});rV();function fa(t){return t.replace(t[0],t[0].toUpperCase())}function vP(t){return t.type==="query"}function _P(t){return t.type==="mutation"}function sV(t){return t.type==="infinitequery"}function di(t,...e){return Object.assign(t,...e)}var Jc=Symbol();function Ag(t,e,r,s){const n=v.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?e({queryArgs:t,endpointDefinition:r,endpointName:s}):t}),[t,e,r,s]),i=v.useRef(n);return v.useEffect(()=>{i.current.serialized!==n.serialized&&(i.current=n)},[n]),i.current.serialized===n.serialized?i.current.queryArgs:t}function pa(t){const e=v.useRef(t);return v.useEffect(()=>{Mi(e.current,t)||(e.current=t)},[t]),Mi(e.current,t)?e.current:t}var SP=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kP=SP(),CP=()=>typeof navigator<"u"&&navigator.product==="ReactNative",PP=CP(),EP=()=>kP||PP?v.useLayoutEffect:v.useEffect,TP=EP(),yg=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:Yb.pending}:t;function Zc(t,...e){const r={};return e.forEach(s=>{r[s]=t[s]}),r}var eu=["data","status","isLoading","isSuccess","isError","error"];function MP({api:t,moduleOptions:{batch:e,hooks:{useDispatch:r,useSelector:s,useStore:n},unstable__sideEffectsInRender:i,createSelector:o},serializeQueryArgs:a,context:l}){const c=i?b=>b():v.useEffect;return{buildQueryHooks:y,buildInfiniteQueryHooks:V,buildMutationHook:x,usePrefetch:f};function u(b,w,_){if(w?.endpointName&&b.isUninitialized){const{endpointName:T}=w,M=l.endpointDefinitions[T];_!==_r&&a({queryArgs:w.originalArgs,endpointDefinition:M,endpointName:T})===a({queryArgs:_,endpointDefinition:M,endpointName:T})&&(w=void 0)}let q=b.isSuccess?b.data:w?.data;q===void 0&&(q=b.data);const S=q!==void 0,k=b.isLoading,C=(!w||w.isLoading||w.isUninitialized)&&!S&&k,P=b.isSuccess||S&&(k&&!w?.isError||b.isUninitialized);return{...b,data:q,currentData:b.data,isFetching:k,isLoading:C,isSuccess:P}}function h(b,w,_){if(w?.endpointName&&b.isUninitialized){const{endpointName:T}=w,M=l.endpointDefinitions[T];a({queryArgs:w.originalArgs,endpointDefinition:M,endpointName:T})===a({queryArgs:_,endpointDefinition:M,endpointName:T})&&(w=void 0)}let q=b.isSuccess?b.data:w?.data;q===void 0&&(q=b.data);const S=q!==void 0,k=b.isLoading,C=(!w||w.isLoading||w.isUninitialized)&&!S&&k,P=b.isSuccess||k&&S;return{...b,data:q,currentData:b.data,isFetching:k,isLoading:C,isSuccess:P}}function f(b,w){const _=r(),q=pa(w);return v.useCallback((S,k)=>_(t.util.prefetch(b,S,{...q,...k})),[b,_,q])}function p(b,w,{refetchOnReconnect:_,refetchOnFocus:q,refetchOnMountOrArgChange:S,skip:k=!1,pollingInterval:C=0,skipPollingIfUnfocused:P=!1,...T}={}){const{initiate:M}=t.endpoints[b],I=r(),B=v.useRef(void 0);if(!B.current){const ce=I(t.internalActions.internal_getRTKQSubscriptions());B.current=ce}const E=Ag(k?_r:w,bh,l.endpointDefinitions[b],b),R=pa({refetchOnReconnect:_,refetchOnFocus:q,pollingInterval:C,skipPollingIfUnfocused:P}),D=v.useRef(!1),F=T.initialPageParam,W=pa(F),me=v.useRef(void 0);let{queryCacheKey:ie,requestId:te}=me.current||{},ge=!1;ie&&te&&(ge=B.current.isRequestSubscribed(ie,te));const oe=!ge&&D.current;return c(()=>{D.current=ge}),c(()=>{oe&&(me.current=void 0)},[oe]),c(()=>{const ce=me.current;if(E===_r){ce?.unsubscribe(),me.current=void 0;return}const Be=me.current?.subscriptionOptions;if(!ce||ce.arg!==E){ce?.unsubscribe();const nr=I(M(E,{subscriptionOptions:R,forceRefetch:S,...sV(l.endpointDefinitions[b])?{initialPageParam:W}:{}}));me.current=nr}else R!==Be&&ce.updateSubscriptionOptions(R)},[I,M,S,E,R,oe,W,b]),[me,I,M,R]}function m(b,w){return(q,{skip:S=!1,selectFromResult:k}={})=>{const{select:C}=t.endpoints[b],P=Ag(S?_r:q,a,l.endpointDefinitions[b],b),T=v.useRef(void 0),M=v.useMemo(()=>o([C(P),(D,F)=>F,D=>P],w,{memoizeOptions:{resultEqualityCheck:Mi}}),[C,P]),I=v.useMemo(()=>k?o([M],k,{devModeChecks:{identityFunctionCheck:"never"}}):M,[M,k]),B=s(D=>I(D,T.current),Mi),E=n(),R=M(E.getState(),T.current);return TP(()=>{T.current=R},[R]),B}}function A(b){v.useEffect(()=>()=>{b.current?.unsubscribe?.(),b.current=void 0},[b])}function g(b){if(!b.current)throw new Error(Ye(38));return b.current.refetch()}function y(b){const w=(S,k={})=>{const[C]=p(b,S,k);return A(C),v.useMemo(()=>({refetch:()=>g(C)}),[C])},_=({refetchOnReconnect:S,refetchOnFocus:k,pollingInterval:C=0,skipPollingIfUnfocused:P=!1}={})=>{const{initiate:T}=t.endpoints[b],M=r(),[I,B]=v.useState(Jc),E=v.useRef(void 0),R=pa({refetchOnReconnect:S,refetchOnFocus:k,pollingInterval:C,skipPollingIfUnfocused:P});c(()=>{const me=E.current?.subscriptionOptions;R!==me&&E.current?.updateSubscriptionOptions(R)},[R]);const D=v.useRef(R);c(()=>{D.current=R},[R]);const F=v.useCallback(function(me,ie=!1){let te;return e(()=>{E.current?.unsubscribe(),E.current=te=M(T(me,{subscriptionOptions:D.current,forceRefetch:!ie})),B(me)}),te},[M,T]),W=v.useCallback(()=>{E.current?.queryCacheKey&&M(t.internalActions.removeQueryResult({queryCacheKey:E.current?.queryCacheKey}))},[M]);return v.useEffect(()=>()=>{E?.current?.unsubscribe()},[]),v.useEffect(()=>{I!==Jc&&!E.current&&F(I,!0)},[I,F]),v.useMemo(()=>[F,I,{reset:W}],[F,I,W])},q=m(b,u);return{useQueryState:q,useQuerySubscription:w,useLazyQuerySubscription:_,useLazyQuery(S){const[k,C,{reset:P}]=_(S),T=q(C,{...S,skip:C===Jc}),M=v.useMemo(()=>({lastArg:C}),[C]);return v.useMemo(()=>[k,{...T,reset:P},M],[k,T,P,M])},useQuery(S,k){const C=w(S,k),P=q(S,{selectFromResult:S===_r||k?.skip?void 0:yg,...k}),T=Zc(P,...eu);return v.useDebugValue(T),v.useMemo(()=>({...P,...C}),[P,C])}}}function V(b){const w=(q,S={})=>{const[k,C,P,T]=p(b,q,S),M=v.useRef(T);c(()=>{M.current=T},[T]);const I=v.useCallback(function(B,E){let R;return e(()=>{k.current?.unsubscribe(),k.current=R=C(P(B,{subscriptionOptions:M.current,direction:E}))}),R},[k,C,P]);return A(k),v.useMemo(()=>({trigger:I,refetch:()=>g(k),fetchNextPage:()=>I(q,"forward"),fetchPreviousPage:()=>I(q,"backward")}),[k,I,q])},_=m(b,h);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:w,useInfiniteQuery(q,S){const{refetch:k,fetchNextPage:C,fetchPreviousPage:P}=w(q,S),T=_(q,{selectFromResult:q===_r||S?.skip?void 0:yg,...S}),M=Zc(T,...eu,"hasNextPage","hasPreviousPage");return v.useDebugValue(M),v.useMemo(()=>({...T,fetchNextPage:C,fetchPreviousPage:P,refetch:k}),[T,C,P,k])}}}function x(b){return({selectFromResult:w,fixedCacheKey:_}={})=>{const{select:q,initiate:S}=t.endpoints[b],k=r(),[C,P]=v.useState();v.useEffect(()=>()=>{C?.arg.fixedCacheKey||C?.reset()},[C]);const T=v.useCallback(function(me){const ie=k(S(me,{fixedCacheKey:_}));return P(ie),ie},[k,S,_]),{requestId:M}=C||{},I=v.useMemo(()=>q({fixedCacheKey:_,requestId:C?.requestId}),[_,C,q]),B=v.useMemo(()=>w?o([I],w):I,[w,I]),E=s(B,Mi),R=_==null?C?.arg.originalArgs:void 0,D=v.useCallback(()=>{e(()=>{C&&P(void 0),_&&k(t.internalActions.removeMutationResult({requestId:M,fixedCacheKey:_}))})},[k,_,C,M]),F=Zc(E,...eu,"endpointName");v.useDebugValue(F);const W=v.useMemo(()=>({...E,originalArgs:R,reset:D}),[E,R,D]);return v.useMemo(()=>[T,W],[T,W])}}}var RP=Symbol(),IP=({batch:t=Fw,hooks:e={useDispatch:Iy,useSelector:jy,useStore:rd},createSelector:r=_l,unstable__sideEffectsInRender:s=!1,...n}={})=>({name:RP,init(i,{serializeQueryArgs:o},a){const l=i,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:h,usePrefetch:f}=MP({api:i,moduleOptions:{batch:t,hooks:e,unstable__sideEffectsInRender:s,createSelector:r},serializeQueryArgs:o,context:a});return di(l,{usePrefetch:f}),di(a,{batch:t}),{injectEndpoint(p,m){if(vP(m)){const{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:V,useQuerySubscription:x}=c(p);di(l.endpoints[p],{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:V,useQuerySubscription:x}),i[`use${fa(p)}Query`]=A,i[`useLazy${fa(p)}Query`]=g}if(_P(m)){const A=h(p);di(l.endpoints[p],{useMutation:A}),i[`use${fa(p)}Mutation`]=A}else if(sV(m)){const{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}=u(p);di(l.endpoints[p],{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}),i[`use${fa(p)}InfiniteQuery`]=A}}}}}),jP=tV(rV(),IP());const OP=zn(()=>sr(()=>import("./campaign-DnV-Ati-.js"),__vite__mapDeps([7,5,6]))),zl=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const NP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ki=Array.prototype.slice.call(NP),ma=(t=>{let e={};return t.forEach((r,s)=>e[r]=s),e})(ki),zP=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,za=String.fromCharCode.bind(String),xg=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),BP=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),nV=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),DP=t=>{let e,r,s,n,i="";const o=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|s<<8|n,i+=ki[e>>18&63]+ki[e>>12&63]+ki[e>>6&63]+ki[e&63]}return o?i.slice(0,o-3)+"===".substring(o):i},FP=typeof btoa=="function"?t=>btoa(t):zl?t=>Buffer.from(t,"binary").toString("base64"):DP,bg=zl?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let s=0,n=t.length;s<n;s+=4096)r.push(za.apply(null,t.subarray(s,s+4096)));return FP(r.join(""))},LP=(t,e=!1)=>e?BP(bg(t)):bg(t),UP=t=>{if(t=t.replace(/\s+/g,""),!zP.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",s,n;for(let i=0;i<t.length;)e=ma[t.charAt(i++)]<<18|ma[t.charAt(i++)]<<12|(s=ma[t.charAt(i++)])<<6|(n=ma[t.charAt(i++)]),r+=s===64?za(e>>16&255):n===64?za(e>>16&255,e>>8&255):za(e>>16&255,e>>8&255,e&255);return r},$P=typeof atob=="function"?t=>atob(nV(t)):zl?t=>Buffer.from(t,"base64").toString("binary"):UP,HP=zl?t=>xg(Buffer.from(t,"base64")):t=>xg($P(t).split("").map(e=>e.charCodeAt(0))),GP=t=>HP(WP(t)),WP=t=>nV(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),YP=!0,iV="gzip",QP=async t=>{const e=JSON.stringify(t),s=new TextEncoder().encode(e),n=new Blob([s]),i=new CompressionStream(iV),o=n.stream().pipeThrough(i),a=await new Response(o).arrayBuffer(),l=new Uint8Array(a);return LP(l,YP)},oV=async t=>{try{const e=GP(t),r=new Blob([new Uint8Array(e)]),s=new DecompressionStream(iV),n=r.stream().pipeThrough(s),i=await new Response(n).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},KP=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>Wn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class Hd extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class XP extends Hd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Vg extends Hd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qg extends Hd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Vh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Vh||(Vh={}));var JP=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class ZP{constructor(e,{headers:r={},customFetch:s,region:n=Vh.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=KP(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return JP(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:u}).catch(A=>{throw new XP(A)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Vg(h);if(!h.ok)throw new qg(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return p==="application/json"?m=yield h.json():p==="application/octet-stream"?m=yield h.blob():p==="text/event-stream"?m=h:p==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof qg||n instanceof Vg?n.context:void 0}}})}}var Le={},Ls={},Us={},$s={},Hs={},Gs={},eE=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Sn=eE();const tE=Sn.fetch,aV=Sn.fetch.bind(Sn),lV=Sn.Headers,rE=Sn.Request,sE=Sn.Response,Wn=Object.freeze(Object.defineProperty({__proto__:null,Headers:lV,Request:rE,Response:sE,default:aV,fetch:tE},Symbol.toStringTag,{value:"Module"})),nE=bw(Wn);var ga={},wg;function cV(){if(wg)return ga;wg=1,Object.defineProperty(ga,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ga.default=t,ga}var vg;function uV(){if(vg)return Gs;vg=1;var t=Gs&&Gs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Gs,"__esModule",{value:!0});const e=t(nE),r=t(cV());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,f;let p=null,m=null,A=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const w=await c.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=w:m=JSON.parse(w))}const x=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&b&&b.length>1&&(A=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(p={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,A=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await c.text();try{p=JSON.parse(x),Array.isArray(p)&&c.status===404&&(m=[],p=null,g=200,y="OK")}catch{c.status===404&&x===""?(g=204,y="No Content"):p={message:x}}if(p&&this.isMaybeSingle&&(!((f=p?.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,g=200,y="OK"),p&&this.shouldThrowOnError)throw new r.default(p)}return{error:p,data:m,count:A,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,f;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c?.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Gs.default=s,Gs}var _g;function hV(){if(_g)return Hs;_g=1;var t=Hs&&Hs.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Hs,"__esModule",{value:!0});const e=t(uV());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Hs.default=r,Hs}var Sg;function Gd(){if(Sg)return $s;Sg=1;var t=$s&&$s.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($s,"__esModule",{value:!0});const e=t(hV());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return $s.default=r,$s}var kg;function dV(){if(kg)return Us;kg=1;var t=Us&&Us.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Us,"__esModule",{value:!0});const e=t(Gd());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Us.default=r,Us}var fi={},pi={},Cg;function iE(){return Cg||(Cg=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.version=void 0,pi.version="0.0.0-automated"),pi}var Pg;function oE(){if(Pg)return fi;Pg=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.DEFAULT_HEADERS=void 0;const t=iE();return fi.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},fi}var Eg;function aE(){if(Eg)return Ls;Eg=1;var t=Ls&&Ls.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ls,"__esModule",{value:!0});const e=t(dV()),r=t(Gd()),s=oE();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const f=new URL(`${this.url}/rpc/${o}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([A,g])=>g!==void 0).map(([A,g])=>[A,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([A,g])=>{f.searchParams.append(A,g)})):(h="POST",p=a);const m=Object.assign({},this.headers);return u&&(m.Prefer=`count=${u}`),new r.default({method:h,url:f,headers:m,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return Ls.default=n,Ls}var Tg;function lE(){if(Tg)return Le;Tg=1;var t=Le&&Le.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Le,"__esModule",{value:!0}),Le.PostgrestError=Le.PostgrestBuilder=Le.PostgrestTransformBuilder=Le.PostgrestFilterBuilder=Le.PostgrestQueryBuilder=Le.PostgrestClient=void 0;const e=t(aE());Le.PostgrestClient=e.default;const r=t(dV());Le.PostgrestQueryBuilder=r.default;const s=t(Gd());Le.PostgrestFilterBuilder=s.default;const n=t(hV());Le.PostgrestTransformBuilder=n.default;const i=t(uV());Le.PostgrestBuilder=i.default;const o=t(cV());return Le.PostgrestError=o.default,Le.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},Le}var cE=lE();const uE=Qe(cE),{PostgrestClient:hE,PostgrestQueryBuilder:YL,PostgrestFilterBuilder:QL,PostgrestTransformBuilder:KL,PostgrestBuilder:XL,PostgrestError:JL}=uE;function dE(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const fE=dE(),pE="2.11.15",mE=`realtime-js/${pE}`,gE="1.0.0",fV=1e4,AE=1e3;var Bi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Bi||(Bi={}));var rt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(rt||(rt={}));var Qt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Qt||(Qt={}));var qh;(function(t){t.websocket="websocket"})(qh||(qh={}));var xs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(xs||(xs={}));class yE{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const l=s.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class pV{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var we;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(we||(we={}));const Mg=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=xE(o,t,e,n),i),{})},xE=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?mV(i,o):wh(o)},mV=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return wE(e,r)}switch(t){case we.bool:return bE(e);case we.float4:case we.float8:case we.int2:case we.int4:case we.int8:case we.numeric:case we.oid:return VE(e);case we.json:case we.jsonb:return qE(e);case we.timestamp:return vE(e);case we.abstime:case we.date:case we.daterange:case we.int4range:case we.int8range:case we.money:case we.reltime:case we.text:case we.time:case we.timestamptz:case we.timetz:case we.tsrange:case we.tstzrange:return wh(e);default:return wh(e)}},wh=t=>t,bE=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},VE=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},qE=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},wE=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>mV(e,a))}return t},vE=t=>typeof t=="string"?t.replace(" ","T"):t,gV=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class tu{constructor(e,r,s={},n=fV){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Rg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Rg||(Rg={}));class Di{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Di.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Di.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Di.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const f=u.map(g=>g.presence_ref),p=h.map(g=>g.presence_ref),m=u.filter(g=>p.indexOf(g.presence_ref)<0),A=h.filter(g=>f.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),A.length>0&&(l[c]=A)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ig;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ig||(Ig={}));var jg;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(jg||(jg={}));var wr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(wr||(wr={}));class Wd{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=rt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new tu(this,Qt.join,this.params,this.timeout),this.rejoinTimer=new pV(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=rt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=rt.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qt.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Di(this),this.broadcastEndpointURL=gV(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==rt.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(wr.CHANNEL_ERROR,u)),this._onClose(()=>e?.(wr.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(wr.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f?.length)!==null&&h!==void 0?h:0,m=[];for(let A=0;A<p;A++){const g=f[A],{filter:{event:y,schema:V,table:x,filter:b}}=g,w=u&&u[A];if(w&&w.event===y&&w.schema===V&&w.table===x&&w.filter===b)m.push(Object.assign(Object.assign({},g),{id:w.id}));else{this.unsubscribe(),this.state=rt.errored,e?.(wr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(wr.SUBSCRIBED);return}}).receive("error",u=>{this.state=rt.errored,e?.(wr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(wr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=rt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new tu(this,Qt.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new tu(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Qt;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var m,A,g;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(A=p.filter)===null||A===void 0?void 0:A.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var m,A,g,y,V,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const b=p.id,w=(m=p.filter)===null||m===void 0?void 0:m.event;return b&&((A=r.ids)===null||A===void 0?void 0:A.includes(b))&&(w==="*"||w?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(V=(y=p?.filter)===null||y===void 0?void 0:y.event)===null||V===void 0?void 0:V.toLocaleLowerCase();return b==="*"||b===((x=r?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:A,table:g,commit_timestamp:y,type:V,errors:x}=m;f=Object.assign(Object.assign({},{schema:A,table:g,commit_timestamp:y,eventType:V,new:{},old:{},errors:x}),this._getPayloadRecords(m))}p.callback(f,s)})}_isClosed(){return this.state===rt.closed}_isJoined(){return this.state===rt.joined}_isJoining(){return this.state===rt.joining}_isLeaving(){return this.state===rt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Wd.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Qt.close,{},e)}_onError(e){this._on(Qt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=rt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Mg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Mg(e.columns,e.old_record)),r}}const Og=()=>{},_E=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class SE{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fV,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Og,this.ref=0,this.logger=Og,this.conn=null,this.sendBuffer=[],this.serializer=new yE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>sr(async()=>{const{default:l}=await Promise.resolve().then(()=>Wn);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${qh.websocket}`,this.httpEndpoint=gV(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new pV(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=fE),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:gE}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Bi.connecting:return xs.Connecting;case Bi.open:return xs.Open;case Bi.closing:return xs.Closing;default:return xs.Closed}}isConnected(){return this.connectionState()===xs.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new Wd(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:mE};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Qt.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(AE,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Qt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([_E],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class Yd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $e(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class kE extends Yd{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class vh extends Yd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var CE=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const AV=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>Wn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},PE=()=>CE(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield sr(()=>Promise.resolve().then(()=>Wn),void 0)).Response:Response}),_h=t=>{if(Array.isArray(t))return t.map(r=>_h(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=_h(s)}),e};var zs=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const ru=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),EE=(t,e,r)=>zs(void 0,void 0,void 0,function*(){const s=yield PE();t instanceof s&&!r?.noResolveJson?t.json().then(n=>{e(new kE(ru(n),t.status||500))}).catch(n=>{e(new vh(ru(n),n))}):e(new vh(ru(t),t))}),TE=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),r))};function Co(t,e,r,s,n,i){return zs(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,TE(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>EE(l,a,s))})})}function ol(t,e,r,s){return zs(this,void 0,void 0,function*(){return Co(t,"GET",e,r,s)})}function Dr(t,e,r,s,n){return zs(this,void 0,void 0,function*(){return Co(t,"POST",e,s,n,r)})}function ME(t,e,r,s,n){return zs(this,void 0,void 0,function*(){return Co(t,"PUT",e,s,n,r)})}function RE(t,e,r,s){return zs(this,void 0,void 0,function*(){return Co(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function yV(t,e,r,s,n){return zs(this,void 0,void 0,function*(){return Co(t,"DELETE",e,s,n,r)})}var bt=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const IE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ng={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class jE{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=AV(n)}uploadOrUpdate(e,r,s,n){return bt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ng),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if($e(i))return{data:null,error:i};throw i}})}upload(e,r,s){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return bt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Ng.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if($e(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return bt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield Dr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Yd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}update(e,r,s){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return bt(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}})}copy(e,r,s){return bt(this,void 0,void 0,function*(){try{return{data:{path:(yield Dr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return bt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Dr(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return bt(this,void 0,void 0,function*(){try{const n=yield Dr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}})}download(e,r){return bt(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ol(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if($e(a))return{data:null,error:a};throw a}})}info(e){return bt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield ol(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:_h(s),error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}exists(e){return bt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield RE(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if($e(s)&&s instanceof vh){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return bt(this,void 0,void 0,function*(){try{return{data:yield yV(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}list(e,r,s){return bt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},IE),r),{prefix:e||""});return{data:yield Dr(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const OE="2.7.1",NE={"X-Client-Info":`storage-js/${OE}`};var Ws=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class zE{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},NE),r),this.fetch=AV(s)}listBuckets(){return Ws(this,void 0,void 0,function*(){try{return{data:yield ol(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if($e(e))return{data:null,error:e};throw e}})}getBucket(e){return Ws(this,void 0,void 0,function*(){try{return{data:yield ol(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Ws(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Ws(this,void 0,void 0,function*(){try{return{data:yield ME(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ws(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Ws(this,void 0,void 0,function*(){try{return{data:yield yV(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}}class BE extends zE{constructor(e,r={},s){super(e,r,s)}from(e){return new jE(this.url,this.headers,e,this.fetch)}}const DE="2.51.0";let Ci="";typeof Deno<"u"?Ci="deno":typeof document<"u"?Ci="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ci="react-native":Ci="node";const FE={"X-Client-Info":`supabase-js-${Ci}/${DE}`},LE={headers:FE},UE={schema:"public"},$E={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HE={};var GE=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const WE=t=>{let e;return t?e=t:typeof fetch>"u"?e=aV:e=fetch,(...r)=>e(...r)},YE=()=>typeof Headers>"u"?lV:Headers,QE=(t,e,r)=>{const s=WE(r),n=YE();return(i,o)=>GE(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new n(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},o),{headers:c}))})};var KE=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function XE(t){return t.endsWith("/")?t:t+"/"}function JE(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(s=a?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>KE(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}const xV="2.71.0",ln=30*1e3,Sh=3,su=Sh*ln,ZE="http://localhost:9999",eT="supabase.auth.token",tT={"X-Client-Info":`gotrue-js/${xV}`},kh="X-Supabase-Api-Version",bV={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,sT=600*1e3;class Qd extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Z(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class nT extends Qd{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function iT(t){return Z(t)&&t.name==="AuthApiError"}class VV extends Qd{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class ns extends Qd{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Br extends ns{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oT(t){return Z(t)&&t.name==="AuthSessionMissingError"}class Aa extends ns{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ya extends ns{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xa extends ns{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aT(t){return Z(t)&&t.name==="AuthImplicitGrantRedirectError"}class zg extends ns{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ch extends ns{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function nu(t){return Z(t)&&t.name==="AuthRetryableFetchError"}class Bg extends ns{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Ph extends ns{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dg=` 	
\r=`.split(""),lT=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Dg.length;e+=1)t[Dg[e].charCodeAt(0)]=-2;for(let e=0;e<al.length;e+=1)t[al[e].charCodeAt(0)]=e;return t})();function Fg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(al[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(al[s]),e.queuedBits-=6}}function qV(t,e,r){const s=lT[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Lg(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{hT(o,s,r)};for(let o=0;o<t.length;o+=1)qV(t.charCodeAt(o),n,i);return e.join("")}function cT(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function uT(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}cT(s,e)}}function hT(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function dT(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)qV(t.charCodeAt(n),r,s);return new Uint8Array(e)}function fT(t){const e=[];return uT(t,r=>e.push(r)),new Uint8Array(e)}function pT(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>Fg(n,r,s)),Fg(null,r,s),e.join("")}function mT(t){return Math.round(Date.now()/1e3)+t}function gT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Yt=()=>typeof window<"u"&&typeof document<"u",as={tested:!1,writable:!1},wV=()=>{if(!Yt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(as.tested)return as.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),as.tested=!0,as.writable=!0}catch{as.tested=!0,as.writable=!1}return as.writable};function AT(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const vV=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>Wn);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},yT=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",cn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ls=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Nr=async(t,e)=>{await t.removeItem(e)};class Bl{constructor(){this.promise=new Bl.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Bl.promiseConstructor=Promise;function iu(t){const e=t.split(".");if(e.length!==3)throw new Ph("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!rT.test(e[s]))throw new Ph("JWT not in base64url format");return{header:JSON.parse(Lg(e[0])),payload:JSON.parse(Lg(e[1])),signature:dT(e[2]),raw:{header:e[0],payload:e[1]}}}async function xT(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function bT(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function VT(t){return("0"+t.toString(16)).substr(-2)}function qT(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,VT).join("")}async function wT(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function vT(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await wT(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ys(t,e,r=!1){const s=qT();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await cn(t,`${e}-code-verifier`,n);const i=await vT(s);return[i,s===i?"plain":"s256"]}const _T=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ST(t){const e=t.headers.get(kh);if(!e||!e.match(_T))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function kT(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function CT(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const PT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Qs(t){if(!PT.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ou(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var ET=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const ys=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),TT=[502,503,504];async function Ug(t){var e;if(!yT(t))throw new Ch(ys(t),0);if(TT.includes(t.status))throw new Ch(ys(t),t.status);let r;try{r=await t.json()}catch(i){throw new VV(ys(i),i)}let s;const n=ST(t);if(n&&n.getTime()>=bV["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Bg(ys(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Br}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Bg(ys(r),t.status,r.weak_password.reasons);throw new nT(ys(r),t.status||500,s)}const MT=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function ne(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[kh]||(i[kh]=bV["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await RT(t,e,r+a,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function RT(t,e,r,s,n,i){const o=MT(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new Ch(ys(l),0)}if(a.ok||await Ug(a),s?.noResolveJson)return a;try{return await a.json()}catch(l){await Ug(l)}}function qr(t){var e;let r=null;NT(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=mT(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function $g(t){const e=qr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Lr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function IT(t){return{data:t,error:null}}function jT(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=ET(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function OT(t){return t}function NT(t){return t.access_token&&t.refresh_token&&t.expires_in}const au=["global","local","others"];var zT=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class BT{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=vV(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=au[0]){if(au.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${au.join(", ")}`);try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Lr})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=zT(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:jT,redirectTo:r?.redirectTo})}catch(r){if(Z(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Lr})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:OT});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const A=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=A}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Z(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Qs(e);try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Lr})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Qs(e);try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Lr})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Qs(e);try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Lr})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Qs(e.userId);try{const{data:r,error:s}=await ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Qs(e.userId),Qs(e.id);try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}}function Hg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function DT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ks={debug:!!(globalThis&&wV()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _V extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class FT extends _V{}async function LT(t,e,r){Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new FT(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ks.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}DT();const UT={url:ZE,storageKey:eT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Gg(t,e,r){return await r()}const Xs={};class no{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=no.nextInstanceID,no.nextInstanceID+=1,this.instanceID>0&&Yt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},UT),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new BT({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=vV(n.fetch),this.lock=n.lock||Gg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Yt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=LT:this.lock=Gg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:wV()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hg(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Hg(this.memoryStorage)),Yt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Xs[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Xs[this.storageKey]=Object.assign(Object.assign({},Xs[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Xs[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xs[this.storageKey]=Object.assign(Object.assign({},Xs[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${xV}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=AT(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),Yt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),aT(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Z(r)?{error:r}:{error:new VV("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:qr}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Ys(this.storage,this.storageKey)),i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:h,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:m},xform:qr})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:qr})}else throw new ya("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:$g})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:$g})}else throw new ya("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Aa}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,l,c,u,h,f,p;let m,A;if("message"in e)m=e.message,A=e.signature;else{const{chain:g,wallet:y,statement:V,options:x}=e;let b;if(Yt())if(typeof y=="object")b=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))b=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const w=new URL((r=x?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const _=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),V?{statement:V}:null));let q;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")q=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)q=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)m=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),A=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${w.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...V?["",V,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(n=(s=x?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const _=await b.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=_}}try{const{data:g,error:y}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:pT(A)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:qr});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Aa}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(Z(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await ls(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:qr});if(await Nr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Aa}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(Z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:qr}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Aa}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ys(this.storage,this.storageKey));const{error:h}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new ya("You must provide either an email or phone number.")}catch(a){if(Z(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:qr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ys(this.storage,this.storageKey)),await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:IT})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Br;const{error:n}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(Z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await ne(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await ne(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new ya("You must provide either an email or phone number and a type")}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ls(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<su:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await ls(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=ou()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Lr}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Br}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Lr})})}catch(r){if(Z(r))return oT(r)&&(await this._removeSession(),await Nr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Br;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ys(this.storage,this.storageKey));const{data:c,error:u}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Lr});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Br;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=iu(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Z(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Br;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Yt())throw new xa("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xa(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xa("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zg("No code detected.");const{data:V,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:V.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new xa("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let f=u+h;l&&(f=parseInt(l));const p=f-u;p*1e3<=ln&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=f-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,u);const{data:A,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:c,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(Z(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ls(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(iT(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Nr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=gT(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ys(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Yt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(Z(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await bT(async n=>(n>0&&await xT(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:qr})),(n,i)=>{const o=200*Math.pow(2,n);return i&&nu(i)&&Date.now()+o-s<ln})}catch(s){if(this._debug(r,"error",s),Z(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Yt()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ls(this.storage,this.storageKey);if(n&&this.userStorage){let o=await ls(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await cn(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:ou()}else if(n&&!n.user&&!n.user){const o=await ls(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await Nr(this.storage,this.storageKey+"-user"),await cn(this.storage,this.storageKey,n)):n.user=ou()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<su;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${su}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),nu(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Br;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Bl;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Br;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),Z(i)){const o={session:null,error:i};return nu(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await cn(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=structuredClone(n);await cn(this.storage,this.storageKey,i)}else{const n=structuredClone(r);await cn(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Nr(this.storage,this.storageKey),await Nr(this.storage,this.storageKey+"-code-verifier"),await Nr(this.storage,this.storageKey+"-user"),this.userStorage&&await Nr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Yt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ln);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/ln);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ln}ms, refresh threshold is ${Sh} ticks`),n<=Sh&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof _V)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ys(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(Z(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Z(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=e?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=iu(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+sT>n)return s;const{data:i,error:o}=await ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:p,error:m}=await this.getSession();if(m||!p.session)return{data:null,error:m};s=p.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=iu(s);r?.allowExpired||kT(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:n,signature:o},error:null}}const u=CT(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,fT(`${a}.${l}`)))throw new Ph("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}}}no.nextInstanceID=0;const $T=no;class HT extends $T{constructor(e){super(e)}}var GT=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class WT{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=XE(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:UE,realtime:HE,auth:Object.assign(Object.assign({},$E),{storageKey:c}),global:LE},h=JE(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=QE(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new hE(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new ZP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new BE(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return GT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new HT({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new SE(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const YT=(t,e,r)=>new WT(t,e,r),Kd=YT("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),QT=async t=>{if(t.locator.campaignName===void 0)throw new Error("can not save a campaign without a name");const e=await Kd.rpc("save_campaign_version",{p_name:t.locator.campaignName,p_data:await QP(t),p_published:t.meta?.published??!1});if(e.error)throw new Error(`error saving to db ${e.error.message} ${e.error.details}`,{cause:e.error});return e.data},KT=async t=>{const e=await Kd.rpc("get_latest_campaign",{p_campaign_name:t.campaignName,p_user_id:t.userId,p_version:t.version===-1?void 0:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const r=await oV(e.data.data);return Object.values(r.rooms).forEach(s=>{delete s.size}),r.locator===void 0&&(r.locator={userId:t.userId||"upgraded, unknown",campaignName:t.campaignName,version:e.data.version}),delete r.name,r},XT=async({publishedOnly:t})=>{const e=await Kd.rpc("get_all_users_latest_campaigns",{p_published_only:t});if(e.error)throw new Error("could not get user campaigns",{cause:e.error});return e.data},Fi=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},Is=jP({reducerPath:"campaignsApi",baseQuery:dP(),endpoints:t=>({getCampaign:t.query({async queryFn(e){try{return e.userId==="@@original"&&e.campaignName==="original"?{data:(await OP()).campaign}:e.campaignName.startsWith("data:")?{data:await oV(e.campaignName.substring(5))}:{data:await KT(e)}}catch(r){return{error:Fi(new Error(`getCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}}),getAllUsersLatestCampaigns:t.query({async queryFn({publishedOnly:e}){try{return{data:await XT({publishedOnly:e})}}catch(r){return{error:Fi(new Error(`getAllUsersLatestCampaigns queryFn() failed: ${r}`))}}}}),saveCampaign:t.mutation({async queryFn(e){try{return{data:await QT(e)}}catch(r){return{error:Fi(new Error(`saveCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}})})}),{useGetAllUsersLatestCampaignsQuery:JT}=Is,ZT=Is.endpoints.getCampaign.select,eM=(t,e)=>ZT(e)(t).data,io={inputAssignment:wn.Default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:pt()==="mobile"?"handheld":"zxSpectrum"},gameSpeed:1.2,showFps:!1,onScreenControls:pt()==="mobile"||pt()==="tablet",inputDirectionMode:"8-way",directionsRelativeTo:"mixed",soundSettings:{mute:!1,noFootsteps:!1}},At=t=>e=>nl(e.gameMenus.userSettings,t)??nl(io,t),ll=At("inputAssignment"),ZL=t=>t.gameMenus.openMenus.length>0,tM=()=>Y(t=>t.gameMenus.cheatsOn),SV=t=>t.gameMenus.assigningInput!==void 0,kV=()=>Y(SV),rM=t=>{if(t.gameMenus.userSettings.inputAssignment===void 0)return"Default";for(const[e,r]of Fe(Tx(wn)))if(eP(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},kn=()=>Y(t=>t.gameMenus.gameRunning),sM=At("showFps"),Dl=At("displaySettings.emulatedResolution"),Xd=At("gameSpeed"),nM=()=>Y(Dl),iM=At("displaySettings.uncolourised"),Jd=()=>Y(iM),oM=At("displaySettings.crtFilter"),CV=At("infiniteLivesPoke"),PV=At("infiniteDoughnutsPoke"),eU=t=>t.gameMenus.gameInPlay.planetsLiberated.egyptus&&t.gameMenus.gameInPlay.planetsLiberated.bookworld&&t.gameMenus.gameInPlay.planetsLiberated.penitentiary&&t.gameMenus.gameInPlay.planetsLiberated.safari,Zd=At("directionsRelativeTo"),ef=()=>Y(Zd),tf=At("inputDirectionMode"),EV=()=>Y(tf),aM=t=>Zu(Fe(jr(t.gameMenus.gameInPlay.planetsLiberated)).filter(Boolean)),lM=At("displaySettings.showBoundingBoxes"),tU=()=>Y(lM),cM=At("displaySettings.showShadowMasks"),rU=()=>Y(cM),uM=At("onScreenControls"),hM=At("soundSettings.mute"),dM=At("soundSettings.noFootsteps"),sU=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??io.onScreenControls)&&e.upscale.rotate90===!1,fM=()=>Y(uM),pM=(t,e)=>!!(nl(t.userSettings,e)??nl(io,e)??!1),mM=()=>Y(t=>t.gameMenus.gameInPlay.roomsExplored),TV=t=>{const e=gM(t);if(!e)throw new Error(`No current campaign. Campaign locator is:
${JSON.stringify(t.gameMenus.gameInPlay.campaignLocator,null,2)}`);return e},MV=Wb(TV),gM=t=>{const e=t.gameMenus.gameInPlay.campaignLocator;return e===void 0?void 0:eM(t,e)},Eh=[1,1.2,1.5,2],nU=["none","non-wall","all"],mi=t=>k0(to(t,"userId","campaignName")),RV=["4-way","8-way","analogue"],AM=pt()!=="server",yM=AM?Kt().has("cheats"):!1,xM={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},Th={planetsLiberated:xM,roomsExplored:{},scrollsRead:{},reincarnationPoint:void 0,freeCharacters:{}},Mh={userSettings:{displaySettings:{},soundSettings:navigator.webdriver?{mute:!0}:{}},gameRunning:!1,gameInPlay:Th,openMenus:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:fe}],assigningInput:void 0,cheatsOn:yM,savedGames:{saves:{}}},Po=vr({name:"gameMenus",initialState:Mh,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=ua(WC,Dl({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},setGameSpeed(t,{payload:e}){let r;e===void 0?r=ua(Eh,Xd({gameMenus:t})):r=e,t.userSettings.gameSpeed=r},scrollRead(t,{payload:e}){e.source==="manual"?(t.gameInPlay.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:fe}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=ua(RV,tf({gameMenus:t}))},nextDirectionRelativeTo(t){t.userSettings.directionsRelativeTo=ua(Gb,Zd({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(o,a)=>{o.includes(a)||o.push(a)},{presses:s,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":r(s.keys,e.input);break;case"gamepadButtons":r(s.gamepadButtons,e.input);break;case"gamepadAxes":{pn.includes(i)&&r(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:s}=t.assigningInput,n=r.keys.length+r.gamepadButtons.length+s.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(wn.Default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=s),(e==="towards"||e==="away")&&(i.axes.y=s)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:fe}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},closeAllMenus(t){t.openMenus=[]},gameStarted(t,{payload:{campaignLocator:e,noShowCrowns:r}}){if(t.gameRunning)throw new Error("game is already running");t.openMenus=r?[]:[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.gameInPlay={...Th,campaignLocator:e}},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=wn[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[s]=t.openMenus;s.focussedItemId=e,s.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:fe}])},mapPressed(t){const e={menuId:"map",scrollableSelection:!1,menuParam:fe};if(t.openMenus.length>=1){const s=t.openMenus.at(0)?.menuId;if(s==="map"){const[,...n]=t.openMenus;t.openMenus=n}else s==="hold"&&(t.openMenus=[e,...t.openMenus])}else t.openMenus=[e]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleUserSetting(t,{payload:{path:e,value:r}}){XC(t.userSettings,e,r??!pM(t,e))},crownCollected(t,{payload:e}){t.gameInPlay.planetsLiberated[e]=!0;const r=Object.values(t.gameInPlay.planetsLiberated).every(n=>n),s={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:fe},s]:t.openMenus=[s]},roomExplored(t,{payload:e}){t.gameInPlay.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){if(e&&t.gameInPlay.reincarnationPoint!==void 0)t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:fe},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:fe}];else{t.gameRunning=!1,delete t.gameInPlay.reincarnationPoint;const r=t.gameInPlay.campaignLocator,s=r&&mi(r);s&&(delete t.savedGames.saves[s],delete t.savedGames.lastSavedCampaignLocator),t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:fe},{menuId:"mainMenu",scrollableSelection:!0,menuParam:fe}]}},reincarnationFishEaten(t,{payload:e}){t.gameInPlay.reincarnationPoint=e},reincarnationAccepted(t){delete t.gameInPlay.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:fe}]},saveGame(t,{payload:e}){const r=t.gameInPlay.campaignLocator;if(r===void 0)throw new Error("trying to save a game, but seems like there's no campaign to save against");if(Cd())throw new Error("shouldn't be saving in playtest mode");t.savedGames.saves[mi(r)]=e,t.savedGames.lastSavedCampaignLocator=r},gameRestoreFromSave(t,{payload:e}){t.gameInPlay={freeCharacters:{},...e},e.freeCharacters===void 0&&(t.gameInPlay.freeCharacters={})},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,Mh),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){},lostLife(t,e){},characterReachesFreedom(t,{payload:e}){t.gameInPlay.freeCharacters[e]=!0}},extraReducers(t){t.addCase(Vo,(e,r)=>{if(Kt().get("campaignName")?.startsWith("data:"))return;const s=[{menuId:"hold",scrollableSelection:!1,menuParam:fe}],n={userId:Kt().get("campaignAuthorUserId")??void 0,campaignName:Kt().get("campaignName")??void 0},i=r.payload?.savedGames;if((c=>c.userId!==void 0&&c.campaignName!==void 0)(n)){e.gameRunning=!0;const c=i?.saves[mi(n)];if(c){e.gameRunning=!0,e.gameInPlay={freeCharacters:{},...c.store.gameMenus.gameInPlay},e.openMenus=s;return}else{e.gameRunning=!0,e.gameInPlay={...Th,campaignLocator:n},e.openMenus=s;return}}const a=i?.lastSavedCampaignLocator,l=a&&i.saves[mi(a)];l&&(e.gameRunning=!0,e.gameInPlay={freeCharacters:{},...l.store.gameMenus.gameInPlay},e.openMenus=s)})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")},selectSaveForCampaign(t,e){return t.savedGames.saves[mi(e)]}}}),{assignInputStart:je,backToParentMenu:mt,characterReachesFreedom:iU,characterRoomChange:IV,closeAllMenus:bM,crownCollected:VM,debugItemClicked:qM,doneAssigningInput:wM,errorCaught:rf,errorDismissed:Wg,gameOver:sf,gameRestoreFromSave:oU,gameStarted:oo,goToSubmenu:ot,holdPressed:jV,inputAddedDuringAssignment:vM,keyAssignmentPresetChosen:_M,lostLife:SM,mapPressed:kM,menuOpenOrExitPressed:Yg,nextDirectionRelativeTo:CM,nextInputDirectionMode:PM,reincarnationAccepted:nf,reincarnationFishEaten:aU,roomExplored:EM,saveGame:TM,scrollRead:lU,setEmulatedResolution:of,setFocussedMenuItemId:af,setGameSpeed:MM,setShowBoundingBoxes:cU,setShowShadowMasks:uU,toggleUserSetting:Jt}=Po.actions,{selectHasError:hU}=Po.selectors,dU=Po.selectors.selectSaveForCampaign,RM=()=>{const{hostname:t}=window.location;if(t==="localhost"||t.endsWith(".local")||t==="::1"||t==="[::1]")return!0;const e=t.startsWith("[")?t.slice(1,-1):t;if(e.toLowerCase().startsWith("fe80:")||e.toLowerCase().startsWith("fc00:")||e.toLowerCase().startsWith("fd00:")||t.startsWith("127.")||t.startsWith("192.168.")||t.startsWith("10."))return!0;if(t.startsWith("172.")){const r=Number.parseInt(t.split(".")[1]);if(r>=16&&r<=31)return!0}return!1},Qg="https://cloud.umami.is/script.js",IM="11813495-5844-44e6-acd4-f81e9c955951",jM=()=>{const e=Kt().get("track");if(e!==null){const s=e==="1";return console.log(s?" tracking explicitly enabled via query param":" tracking explicitly disabled via query param"),s}const r=RM();return console.log(r?" not tracking because running on local network":" tracking enabled based on non-local network hostname"),!r},OM=fr(sf,nf,SM,rf,oo,VM,IV),NM=()=>{const t=hx();v.useEffect(()=>Ad({matcher:OM,effect(r,{getState:s}){const n=t?.gameState,[,i]=r.type.split("/"),o=s(),a=n?Math.round(n.gameTime/1e3):void 0,l=r.payload===void 0?{}:r.type==="gameMenus/crownCollected"?{crownForPlanet:r.payload}:r.type==="gameMenus/gameStarted"?void 0:r.type==="gameMenus/lostLife"?{position:r.payload.characterLosingLifeItem.state.position}:r.payload,c={gameTimeSeconds:a,cheatsOn:o.gameMenus.cheatsOn,...l,currentCharacter:n?.currentCharacterName,inRoom:n?.characterRooms[n.currentCharacterName]};window.umami?(console.debug(" umami event:",i,c),window.umami.track(i,c)):console.debug(" no umami for event:",i,c)}}),[t])},zM=()=>{if(document.querySelector(`script[src="${Qg}"]`))return;const t=document.createElement("script");t.src=Qg,t.dataset.websiteId=IM,t.onload=()=>console.log(" umami script dynamically loaded"),document.head.appendChild(t)},BM=()=>(NM(),v.useEffect(zM,[]),null),DM=()=>{const t=v.useRef(null);return t.current===null&&(t.current=jM()),t.current?d.jsx(BM,{}):null},FM=zn(()=>sr(()=>import("./Cheats-CEPH09uH.js"),__vite__mapDeps([8,5,6,9,10]))),Js=(t,e,r)=>{const s=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...Wr(r,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...Wr(r,{x:i+2,y:o}),w:a,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.whole`,{frame:{...s({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...s({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...s({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...s({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:37}})}}]}return Ln(n())},LM={frames:{...Js("generic","y",{x:580,y:415}),...Js("generic","x",{x:582,y:415}),...Js("moonbase","y",{x:752,y:232}),...Js("moonbase","x",{x:915,y:232}),...Js("moonbase.dark","y",{x:752,y:306}),...Js("moonbase.dark","x",{x:915,y:306})}},cs=(t,{x:e,y:r},s)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:r,...s}}],yield[`${t}.away`,{frame:{x:e+s.w+1,y:r,...s}}],yield[`${t}.towards`,{frame:{x:e,y:r+s.h+1,...s}}],yield[`${t}.right`,{frame:{x:e+s.w+1,y:r+s.h+1,...s}}]}return Object.fromEntries(n())},ye=(t,e,{x:r,y:s},n,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a%i*(n.w+1),y:s+Math.floor(a/i)*(n.h+1),...n}}]}return Object.fromEntries(o())},Kg=(t,{x:e,y:r},s,n=t.length,i)=>{function*o(){for(let a=0;a<t.length;a++)yield[i?`${i}.${t[a]}`:t[a],{frame:{x:e+a%n*(s.w+1),y:r+Math.floor(a/n)*(s.h+1),...s}}]}return Object.fromEntries(o())},UM=(t,e,r,s)=>({...ye(`${t}.left`,e,r,s),...ye(`${t}.away`,e,Wr(r,{x:(s.w+1)*e}),s),...ye(`${t}.towards`,e,Wr(r,{y:s.h+1}),s),...ye(`${t}.right`,e,Wr(r,{x:(s.w+1)*e,y:s.h+1}),s)}),Fr=(t,e)=>[...Fe(Ex(1,e+1)).map(r=>`${t}.${String(r)}`)],$M={frames:{...Kg(["share","save","open","pointer","eyedropper"],{x:640,y:10},{w:12,h:12},void 0,"editor.tool"),...Kg(["single","corridor","double","triple.line","triple.^","quad.square","quad.s","quad.31","quad.t","5.x"],{x:640,y:0},{w:9,h:9},void 0,"editor.addRoom")}},OV={" ":"space",",":"comma",";":"scolon",":":"colon",".":"dot","'":"sQuote","":"lQuote","":"rQuote","`":"backtick","<":"lt",">":"gt","?":"questMk","!":"exclMk","-":"hyph","/":"slash","\\":"bSlash"},Nt=t=>OV[t].toUpperCase(),NV=t=>OV[t]??t,Rh={w:32,h:16},Et={w:16,h:56},Q={w:32,h:28},N={w:24,h:24},Pi={w:8,h:8},HM={h:10},O=t=>({x:t.x*(N.w+1)+1,y:t.y*(N.h+1)+2}),ee=t=>({x:t.x*(Q.w+1)+1,y:t.y*(Q.h+1)+682}),zV="",BV="",GM="",WM="",YM="",QM="",KM=[{char:"a",width:8},{char:"b",width:8},{char:"c",width:7},{char:"d",width:8},{char:"e",width:8},{char:"f",width:6},{char:"g",width:8},{char:"h",width:8},{char:"i",width:4},{char:"j",width:5},{char:"k",width:8},{char:"l",width:5},{char:"m",width:9},{char:"n",width:8},{char:"o",width:8},{char:"p",width:8},{char:"q",width:8},{char:"r",width:5},{char:"s",width:6},{char:"t",width:6},{char:"u",width:8},{char:"v",width:8},{char:"w",width:9},{char:"x",width:8},{char:"y",width:8},{char:"z",width:6},{char:"?",width:6},{char:"!",width:4},{char:".",width:4},{char:",",width:4},{char:";",width:4},{char:":",width:3},{char:"/",width:7},{char:"\\",width:7},{char:"",width:4},{char:"",width:4},{char:"'",width:4},{char:"-",width:5}],XM=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","","","","",{char:"",width:16},{char:zV,width:16},{char:BV,width:16}],JM=[" ",Nt("?"),Nt("!"),Nt("."),Nt(","),Nt(";"),Nt(":"),Nt("/"),Nt("\\"),Nt(""),Nt(""),Nt("'"),"`",Nt("-"),"+","%","","","","","","","","","(",")","[","]","<",">","","","","EnterFullscreen","ExitFullscreen","","*","@","",GM,WM,YM,QM,"","","^","","","",""],lu=(t,e,r=Pi.h)=>{function*s(){let{x:n}=e;for(let i=0;i<t.length;i++){const o=t[i],a=typeof o=="string"?o:o.char,c=(typeof o=="string"?void 0:o.width)??Pi.w;yield[`hud.char.${NV(a)}`,{frame:{x:n,y:e.y,...Pi,w:c,h:r}}],n+=Math.max(c,Pi.w)+1}}return Ln(s())},ZM={frames:{...lu(KM,{x:1,y:994},10),...lu(XM,{x:1,y:1005}),...lu(JM,{x:1,y:1014})}},K=(t,e)=>Object.assign([...t],{animationSpeed:e});let ue=0,re=0;const eR={...ye("dalek",2,O({x:0,y:0}),N),...ye("dalek.dark",2,O({x:0,y:1}),N),"shadowMask.dalek":{frame:{...O({x:2,y:0}),...N}},headlessBase:{frame:{...O({x:7,y:0}),...N}},...ye("headlessBase",4,O({x:8,y:0}),N),"headlessBase.all":{frame:{...O({x:12,y:0}),...N}},...UM("turtle",2,O({x:0,y:3}),N),"shadowMask.turtle.away":{frame:{...O({x:4,y:3}),...N}},"shadowMask.turtle.right":{frame:{...O({x:4,y:4}),...N}},...cs("cyberman",O({x:6,y:3}),N),...cs("skiHead.greenAndPink",O({x:9,y:3}),{w:24,h:32}),...cs("skiHead.starsAndStripes",O({x:11,y:3}),{w:24,h:32}),"shadowMask.skiHead.away":{frame:{...O({x:13,y:3}),...N,h:32}},"shadowMask.skiHead.right":{frame:{...O({x:14,y:3}),...N,h:32}},...cs("charles",O({x:0,y:5}),N),"shadowMask.charles.away":{frame:{...O({x:2,y:5}),...N}},"shadowMask.charles.right":{frame:{...O({x:2,y:6}),...N}},...cs("monkey",O({x:0,y:7}),N),...cs("computerBot",O({x:3,y:7}),N),...cs("elephant",O({x:6,y:7}),N),...ye("helicopterBug",4,O({x:9,y:7}),N),"barrier.x.disappearing":{frame:{...O({x:17,y:0}),...N,pivot:{x:18,y:23}}},"barrier.y.disappearing":{frame:{...O({x:18,y:0}),...N,pivot:{x:6,y:23}}},"barrier.x":{frame:{...O({x:19,y:0}),...N,pivot:{x:18,y:23}}},"barrier.y":{frame:{...O({x:20,y:0}),...N,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...O({x:21,y:0}),...N,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...O({x:22,y:0}),...N,pivot:{x:6,y:22}}},"joystick.stick":{frame:{...O({x:18,y:1}),...N}},"joystick.ball":{frame:{...O({x:19,y:1}),...N}},"joystick.whole":{frame:{...O({x:20,y:1}),...N}},"shadowMask.joystick":{frame:{...O({x:21,y:1}),...N}},ball:{frame:{...O({x:17,y:2}),...N}},"shadowMask.ball":{frame:{...O({x:18,y:2}),...N}},"ball.uncolourised":{frame:{...O({x:19,y:2}),...N}},"spikyBall.1":{frame:{...O({x:20,y:2}),...N}},"spikyBall.2":{frame:{...O({x:21,y:2}),...N}},tower:{frame:{...O({x:15,y:3}),...N}},"shadowMask.tower":{frame:{...O({x:16,y:3}),...N}},sticks:{frame:{...O({x:18,y:3}),...N}},cube:{frame:{...O({x:19,y:3}),...N}},drum:{frame:{...O({x:21,y:3}),...N}},"shadowMask.drum":{frame:{...O({x:22,y:3}),...N}},puck:{frame:{...O({x:15,y:4}),...N}},"shadow.smallRound":{frame:{...O({x:16,y:4}),...N}},"shadowMask.smallRound":{frame:{...O({x:17,y:4}),...N}},"spring.compressed":{frame:{...O({x:19,y:4}),...N}},"spring.released":{frame:{...O({x:20,y:4}),...N}},"shadowMask.spring.compressed":{frame:{...O({x:21,y:4}),...N}},"shadowMask.spring.released":{frame:{...O({x:22,y:4}),...N}},...ye("fish",2,O({x:16,y:6}),N),doughnuts:{frame:{...O({x:18,y:6}),...N}},"shadowMask.doughnuts":{frame:{...O({x:19,y:6}),...N}},hooter:{frame:{...O({x:21,y:6}),...N}},bag:{frame:{...O({x:22,y:6}),...N}},whiteRabbit:{frame:{...O({x:24,y:6}),...N}},"shadowMask.whiteRabbit":{frame:{...O({x:25,y:6}),...N}},"crown.blacktooth":{frame:{...O({x:ue=16,y:re=7}),...N}},"crown.safari":{frame:{...O({x:++ue,y:re}),...N}},"crown.egyptus":{frame:{...O({x:++ue,y:re}),...N}},"crown.penitentiary":{frame:{...O({x:++ue,y:re}),...N}},"crown.bookworld":{frame:{...O({x:++ue,y:re}),...N}},"crown.uncolourised":{frame:{...O({x:++ue,y:re}),...N}},scroll:{frame:{...O({x:ue=16,y:re=8}),...N,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...O({x:++ue,y:re}),...N,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...O({x:++ue,y:re}),...N,pivot:{x:17,y:24}}},buttonInGame:{frame:{...O({x:ue=16,y:re=9}),...N}},"buttonInGame.pressed":{frame:{...O({x:++ue,y:re}),...N}},"shadowMask.buttonInGame":{frame:{...O({x:++ue,y:re}),...N}},"switch.left":{frame:{...O({x:++ue,y:re}),...N}},"switch.right":{frame:{...O({x:++ue,y:re}),...N}},"shadowMask.switch":{frame:{...O({x:++ue,y:re}),...N}},"lift.static":{frame:{...O({x:16,y:re=10}),...N}},...ye("lift",4,O({x:17,y:re}),N),"shadow.smallBlock":{frame:{...O({x:21,y:re}),...N}},"shadowMask.smallBlock":{frame:{...O({x:22,y:re}),...N}},"shadow.wallCorner":{frame:{...O({x:21,y:re+1}),...N}},...ye("shadow.lift",4,O({x:17,y:11}),N),...ye("bubbles.white",3,O({x:ue=23,y:re=9}),N),...ye("bubbles.taupe",3,O({x:ue,y:++re}),N),...ye("bubbles.jetpack",2,O({x:ue,y:++re}),N),...ye("bubbles.blueGreen",2,O({x:ue,y:++re}),N),...ye("bubbles.cold",2,O({x:ue,y:++re}),N),"block.organic":{frame:{...ee({x:0,y:0}),...Q}},"block.organic.disappearing":{frame:{...ee({x:1,y:0}),...Q}},"block.organic.dark":{frame:{...ee({x:2,y:0}),...Q}},"block.organic.dark.disappearing":{frame:{...ee({x:3,y:0}),...Q}},"shadowMask.organic":{frame:{...ee({x:4,y:0}),...Q}},"block.artificial":{frame:{...ee({x:5,y:0}),...Q}},"block.artificial.disappearing":{frame:{...ee({x:6,y:0}),...Q}},"shadowMask.artificial":{frame:{...ee({x:7,y:0}),...Q}},"book.x":{frame:{...ee({x:8,y:0}),...Q}},"book.y":{frame:{...ee({x:9,y:0}),...Q}},"shadowMask.book":{frame:{...ee({x:10,y:0}),...Q}},"shadowMask.fullBlock":{frame:{...ee({x:10,y:0}),...Q}},"shadow.fullBlock":{frame:{...ee({x:11,y:0}),...Q}},spikes:{frame:{...ee({x:12,y:0}),...Q}},"shadowMask.spikes":{frame:{...ee({x:13,y:0}),...Q}},stepStool:{frame:{...ee({x:ue=0,y:re=1}),...Q}},"shadowMask.stepStool":{frame:{...ee({x:++ue,y:re}),...Q}},"volcano.1":{frame:{...ee({x:++ue,y:re}),...Q}},"volcano.2":{frame:{...ee({x:++ue,y:re}),...Q}},"shadowMask.volcano":{frame:{...ee({x:++ue,y:re}),...Q}},hushPuppy:{frame:{...ee({x:++ue,y:re}),...Q}},"shadowMask.hushPuppy":{frame:{...ee({x:++ue,y:re}),...Q}},"toaster.on":{frame:{...ee({x:++ue,y:re}),...Q}},"toaster.off":{frame:{...ee({x:++ue,y:re}),...Q}},"toaster.off.1":{frame:{...ee({x:ue,y:re}),...Q}},"toaster.off.2":{frame:{...ee({x:++ue,y:re}),...Q}},"shadowMask.toaster":{frame:{...ee({x:++ue,y:re}),...Q}},sandwich:{frame:{...ee({x:++ue,y:re}),...Q}},"shadowMask.sandwich":{frame:{...ee({x:++ue,y:re}),...Q}},...ye("conveyor.x",7,ee({x:0,y:2}),Q),"shadowMask.conveyor":{frame:{...ee({x:7,y:2}),...Q}},button:{frame:{...ee({x:9,y:2}),...Q}},"button.pressed":{frame:{...ee({x:10,y:2}),...Q}},"button.surfaceMask":{frame:{...ee({x:11,y:2}),...Q}},...ye("conveyor.y",7,ee({x:0,y:3}),Q),teleporter:{frame:{...ee({x:7,y:3}),...Q}},...ye("teleporter.flashing",2,ee({x:8,y:3}),Q),"shadowMask.teleporter":{frame:{...ee({x:10,y:3}),...Q}},"shadowMask.teleporter.flashing":{frame:{...ee({x:11,y:3}),...Q}},...ye("particle.head",4,{x:100,y:798},{w:9,h:11}),...ye("particle.heels",4,{x:100,y:856},{w:9,h:11})},DV={frames:eR,animations:{"teleporter.flashing":K(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:K(["fish.1","fish.2"],.25),lift:K(["lift.1","lift.2","lift.3","lift.4"],.5),"shadow.lift":K(["shadow.lift.1","shadow.lift.2","shadow.lift.3","shadow.lift.4"],.5),dalek:K(["dalek.1","dalek.2"],.5),"dalek.dark":K(["dalek.dark.1","dalek.dark.2"],.5),"turtle.left":K(["turtle.left.1","turtle.left.2"],.25),"turtle.away":K(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":K(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":K(["turtle.right.1","turtle.right.2"],.25),helicopterBug:K(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":K(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.blueGreen":K(["bubbles.blueGreen.1","bubbles.blueGreen.2"],.25),"bubbles.white":K(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":K(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":K(["bubbles.taupe.1","bubbles.taupe.2"],.5),"bubbles.jetpack":K(["bubbles.jetpack.1","bubbles.jetpack.2"],.25),"conveyor.x":K(Fr("conveyor.x",7),.5),"conveyor.y":K(Fr("conveyor.y",7),.5),volcano:K(Fr("volcano",2),3/16),"toaster.off":K(Fr("toaster.off",2),3/16),"spring.bounce":K(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"shadowMask.spring.bounce":K(["shadowMask.spring.released","shadowMask.spring.compressed","shadowMask.spring.released","shadowMask.spring.compressed","shadowMask.spring.released"],.5),"headlessBase.scan":K(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":K(["headlessBase.all","headlessBase"],.5),switch:K(["switch.left","switch.right"],.02),"particle.head.fade":K(Fr("particle.head",4),.5),"particle.heels.fade":K(Fr("particle.heels",4),.5)}},tR=.5,FV=5e3,rR=FV*2,gi=(t,e)=>{const r=Math.round(FV/(ko*4)),s=`head.walking.${t}.${e}`,n=`head.blinking.${t}`,i=[...new Array(r-3).fill(s),n,s,n];return K(i,.5)},Ai=(t,e=2)=>{const r=Math.round(rR/(ko*4)),s=t==="towards"||t==="right"?`heels.standing.${t}`:`heels.walking.${t}.${e}`,n=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(s),...new Array(Math.ceil(r*.2)).fill(n)];return K(i,.5)},Xg=(t,e,r)=>{const s=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*n(){for(let i=0;i<qn.length;i++){const o=s[i];r[o]?.noShadowMaskFalling||(yield[`shadowMask.${t}.falling.${o}`,{frame:{...O({x:e.x,y:e.y+i}),...N}}]),r[o]?.noShadowMask||(yield[`shadowMask.${t}.${o}`,{frame:{...O({x:e.x+1,y:e.y+i}),...N}}]);for(let a=1;a<=3;a++)yield[`${t}.walking.${o}.${a}`,{frame:{...O({x:e.x+a+1,y:e.y+i}),...N}}];yield[`${t}.falling.${o}`,{frame:{...O({x:e.x+5,y:e.y+i}),...N}}],r[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...O({x:e.x+6,y:e.y+i}),...N}}]),r[o]?.noStanding||(yield[`${t}.standing.${o}`,{frame:{...O({x:e.x+7,y:e.y+i}),...N}}])}}return Object.fromEntries(n())};function Jg(t){function*e(r,s){yield`${r}.walking.${s}.1`,yield`${r}.walking.${s}.2`,yield`${r}.walking.${s}.3`,yield`${r}.walking.${s}.2`}return qn.reduce((r,s)=>({...r,[`${t}.walking.${s}`]:K([...e(t,s)],tR)}),{})}const sR={...ye("bubbles.head",6,O({x:1,y:10}),N),...Xg("head",{x:0,y:11},{awayLeft:{noBlinking:!0,noStanding:!0,noShadowMaskFalling:!0},away:{noBlinking:!0,noStanding:!0},awayRight:{noStanding:!0,noShadowMaskFalling:!0},right:{noStanding:!0},towardsRight:{noStanding:!0},towards:{noShadowMask:!0,noStanding:!0,noShadowMaskFalling:!0},towardsLeft:{noShadowMask:!0,noStanding:!0,noShadowMaskFalling:!0},left:{noBlinking:!0,noShadowMask:!0,noStanding:!0,noShadowMaskFalling:!0}}),...ye("bubbles.heels",6,O({x:9,y:10}),N),...Xg("heels",{x:8,y:11},{awayLeft:{noBlinking:!0,noStanding:!0,noShadowMaskFalling:!0},away:{noBlinking:!0,noStanding:!0,noShadowMaskFalling:!0},awayRight:{noStanding:!0,noShadowMaskFalling:!0},right:{noShadowMaskFalling:!0},towardsRight:{noStanding:!0,noShadowMaskFalling:!0},towards:{noShadowMask:!0,noShadowMaskFalling:!0},towardsLeft:{noShadowMask:!0,noStanding:!0,noShadowMaskFalling:!0},left:{noBlinking:!0,noShadowMask:!0,noStanding:!0,noShadowMaskFalling:!0}}),...ye("shine.head",6,ee({x:0,y:4}),Q,3),...ye("shine.heels",6,ee({x:0,y:6}),Q,3),blank:{frame:{...O({x:0,y:2}),...N}},"shadow.playable":{frame:{...O({x:7,y:10}),...N}}},LV={frames:sR,animations:{...Jg("head"),...Jg("heels"),"heels.screenDirections":K(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":K(["heels.standing.towards","heels.walking.left.2","heels.walking.away.2","heels.standing.right"],1/16),"heels.mixedDirections":K(["heels.walking.towardsRight.2","heels.standing.towards","heels.walking.towardsLeft.2","heels.walking.left.2","heels.walking.awayLeft.2","heels.walking.away.2","heels.walking.awayRight.2","heels.standing.right"],1/8),"head.idle.right":gi("right",3),"head.idle.towards":gi("towards",3),"head.idle.towardsRight":gi("towardsRight",2),"head.idle.towardsLeft":gi("towardsLeft",2),"head.idle.awayRight":gi("awayRight",2),"heels.idle.right":Ai("right"),"heels.idle.towards":Ai("towards"),"heels.idle.towardsRight":Ai("towardsRight",2),"heels.idle.towardsLeft":Ai("towardsLeft",2),"heels.idle.awayRight":Ai("awayRight",2),"head.fadeOut":K(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":K(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),"shine.head":K(Fr("shine.head",6),.5),"shine.heels":K(Fr("shine.heels",6),.5),"shine.headInSymbio":K(["shine.head.1","shine.head.2","shine.head.3","blank","blank","blank","blank","blank","blank","shine.head.4","shine.head.5","shine.head.6"],.5),"shine.heelsInSymbio":K(["blank","blank","blank","shine.heels.1","shine.heels.2","shine.heels.3","shine.heels.4","shine.heels.5","shine.heels.6","blank","blank","blank"],.5)}},nR={jail:["bars"],blacktooth:["plain","shield","armour"],bookworld:["book","cowboy"],egyptus:["hieroglyphics","sarcophagus"],market:["more-fruits","fruits","passage"],moonbase:["coil","window3","window2","window1","window-clear"],penitentiary:["skeleton","loop"],safari:["wall","shield","window"]},fU=["blacktooth","penitentiary","bookworld","egyptus","safari"],et=(t,e,r,s)=>{function*n(i,o,a){const l=nR[i],{w:c,h:u}=Et,h=c>>1;for(let f=0;f<l.length;f++)yield[`${i}${s}.wall.${l[f]}.left`,{frame:{x:o-c*(f+1),y:a+h*f,...Et}}],yield[`${i}${s}.wall.${l[f]}.away`,{frame:{x:o+c*f,y:a+h*f,...Et}}];yield[`${i}${s}.floor`,{frame:{x:o-c,y:a+u,...Rh}}]}return Object.fromEntries(n(t,e,r))},Zg={w:16,h:13},eA={w:8,h:9},or=74;let tt=53;const iR={...et("egyptus",834,tt,""),...et("egyptus",834,tt+=or,".dark"),...et("moonbase",834,tt+=or,""),...et("moonbase",834,tt+=or,".dark"),...et("bookworld",834,tt+=or,""),...et("bookworld",834,tt,".dark"),...et("jail",834,tt+=or,""),...et("jail",834,tt,".dark"),...et("blacktooth",834,tt+=or,""),...et("blacktooth",834,tt+=or,".dark"),...et("penitentiary",834,tt+=or,""),...et("penitentiary",834,tt,".dark"),...et("market",834,tt+=or,""),...et("market",834,tt,".dark"),...et("safari",834,tt+=or,""),...et("safari",834,tt,".dark"),"floorEdge.right":{frame:{x:418,y:466,...Zg,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...Zg,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...eA,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...eA,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Et.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"shadow.doorFrame.top.y":{frame:{x:432,y:402,w:36,h:32,pivot:{x:18,y:31.5}}},"generic.floor.deadly":{frame:{x:785,y:462,...Rh}},"generic.dark.floor.deadly":{frame:{x:785,y:479,...Rh}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Et.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Et.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Et.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Et.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Et.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Et.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Et.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...ye("moonbase.wall.screen.window1.away",3,{x:883,y:217},{w:10,h:7}),...ye("moonbase.wall.screen.window2.away",2,{x:867,y:209},{w:10,h:7}),...ye("moonbase.wall.screen.window3.away",4,{x:851,y:201},{w:10,h:7})},UV={frames:iR,animations:{"moonbase.wall.screen.window1.away":K(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":K(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":K(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},oR={...DV.frames,...LV.frames,...UV.frames,...ZM.frames,...LM.frames,...$M.frames},ut={frames:oR,animations:{...LV.animations,...DV.animations,...UV.animations},meta:{scale:1}},aR=Object.keys(ut.frames),ba={w:1024,h:1024};function pU(t){if(!Ih(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(ut.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function Ih(t){return ut.frames[t]!==void 0}function mU(t){return ut.animations[t]!==void 0}const $V="/assets/sprites-DISRg-RN.png";var lR=`#version 300 es
precision highp float;in vec2 vTextureCoord;out vec4 finalColor;uniform sampler2D uTexture;uniform sampler2D uMask;void main(void){vec4 c=texture(uTexture,vTextureCoord);float maskVal=texture(uMask,vTextureCoord).r;vec4 shadowColor=vec4(0.0,0.0,0.0,c.a*(1.0-c.r));finalColor=mix(c,shadowColor,maskVal);}`;const cR=Il.from({vertex:GC,fragment:lR,name:"preprocess-shadow-textures-filter"});class uR extends Tk{#e;constructor(e){super({glProgram:cR,resources:{uMask:e.source}}),this.#e=e}destroy(e){const r=e===!0||typeof e=="object"&&e.destroyPrograms;(e===!0||typeof e=="object"&&e.destroyMask)&&this.#e?.destroy(!0),this.#e=null,super.destroy(r)}}const hR=t=>{const e=new DataView(t),r=[];r.push(t.slice(0,8));let s=8;for(;s<t.byteLength;){const a=e.getUint32(s),l=new TextDecoder().decode(new Uint8Array(t,s+4,4)),c=12+a;l!=="iCCP"&&r.push(t.slice(s,s+c)),s+=c}const n=r.reduce((a,l)=>a+l.byteLength,0),i=new Uint8Array(n);let o=0;for(const a of r)i.set(new Uint8Array(a),o),o+=a.byteLength;return i.buffer},dR=new Ve(0),fR=new Ve(16777215),pR=t=>typeof t=="function"?Fe(aR).filter(t):t,mR=(t,{rects:e,placeholderColoursMasks:r,clearColour:s})=>{const n=new sl,i=new Hn({children:[n]});if(s!==void 0&&n.rect(0,0,ba.w,ba.h).fill(s),e!==void 0){const{textureIds:a,color:l}=e,c=pR(a);for(const u of c){const{frame:{x:h,y:f,w:p,h:m}}=ut.frames[u];n.rect(h,f,p,m).fill(l)}}if(r!==void 0&&r.textureIds.length>0){const{textureIds:a,filter:l,originalSpritesheet:c}=r;for(const u of a){const h=new Ms({texture:c.textures[u],x:c.data.frames[u].frame.x,y:c.data.frames[u].frame.y,filters:l});i.addChild(h)}}const o=Nl.create({width:ba.w,height:ba.h});return t.render({container:i,target:o}),o};let ao,Hr;const gR=async()=>{if(ao!==void 0)return ao;try{const e=await(await fetch($V)).arrayBuffer(),r=hR(e),s=new Blob([r],{type:"image/png"}),n=await createImageBitmap(s);Hr=Ae.from(n)}catch{console.warn("did not load textures - hopefully we are running under node"),Hr=Ae.EMPTY}},gU=t=>{if(Hr===void 0)throw new Error("cannot init original spritesheet before texture load");const e=mR(t,{rects:{textureIds:o=>o.startsWith("shadow."),color:fR},clearColour:dR}),r=new uR(e),s=new Ms(Hr);s.filters=r;const n=Nl.create({width:Hr.width,height:Hr.height});t.render({container:s,target:n});const i=new oh(n,ut);i.parseSync(),i.textureSource.scaleMode="nearest",ao=i,s.destroy(),e.destroy(!0)},AR=()=>{if(ao===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return ao},AU=()=>{if(Hr===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Hr},yR=({className:t,children:e})=>t?d.jsx("div",{className:`contents ${t}`,children:e}):e,xR=t=>t.replaceAll(/(?<!\.)\./g,"_"),j=({children:t,className:e,noSlitWords:r,classnameCycle:s,onClick:n,noTint:i=!1,TagName:o="span",role:a})=>{const l=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(l.length===0)return null;const c=r?[l]:l.split(/\s+/);return d.jsxs(o,{className:e,onClick:n,children:[d.jsx("span",{className:"sr-only",children:l}),c.map((u,h)=>d.jsx("span",{className:at("text-nowrap inline-block [&>*]:align-top",h===c.length-1?"":"me-threeQuarters sprites-uppercase:me-1"),children:Array.from(u).map((f,p)=>{const m=`hud.char.${NV(f)}`;return Ih(m)||console.error("no texture for char",f,f.charCodeAt(0),m,"we have:",Object.keys(AR().textures)),d.jsx("span",{role:a,className:`sprite ${Ih(m)?`texture-${xR(m)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${s===void 0?"":s[p%s.length]}`},p)})},h))]})},bR=t=>t.props.children!==void 0,Je=({children:t,className:e})=>d.jsx(yR,{className:e,children:Array.isArray(t)?t.map((r,s)=>d.jsx(Je,{children:r},s)):typeof t=="number"?d.jsx(j,{children:String(t)}):typeof t=="string"?d.jsx(j,{children:t}):v.isValidElement(t)?t.type===j||t.type===Je?t:bR(t)?v.cloneElement(t,void 0,typeof t.props.children=="string"?d.jsx(j,{children:`${t.props.children}`}):d.jsx(Je,{children:t.props.children})):t:t});var Fl=Ey();const VR=Qe(Fl),HV=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:s=pt(),maximumCanvasUpscale:n})=>{const i=Gn[e],{renderAreaSize:o,rotate90:a}=s!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},l=Ax(o,r),c=Math.max(Math.floor(Math.min(l.x/i.size.x,l.y/i.size.y)),1),u=Math.min(n,c),h=c/u/r,f={x:Math.floor(l.x/c),y:Math.floor(l.y/c)},p={x:Math.ceil(o.x/h),y:Math.ceil(o.y/h)};return{gameEngineUpscale:u,cssUpscale:h,gameEngineScreenSize:f,canvasSize:p,rotate90:a}},qR=t=>pt()==="server"?Gn.zxSpectrum.size:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},GV=(t,e,r)=>{const s=pt();return{renderAreaSize:qR(r),emulatedResolutionName:t,devicePixelRatio:s==="server"?1:window.devicePixelRatio,maximumCanvasUpscale:e.crtFilter?6:8}},wR={upscale:HV(GV(io.displaySettings.emulatedResolution,io.displaySettings))},cl=vr({name:"upscale",initialState:wR,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=HV(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:vR}=cl.actions,{selectCanvasSize:_R,selectRot90:SR,selectUpscale:kR,selectGameEngineUpscale:yU,selectTotalUpscale:CR,selectGameEngineScreenSize:xU}=cl.selectors,Eo=()=>Y(CR),An=({children:t,scaleFactor:e})=>{const r=Eo();return d.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},ze=({children:t})=>Fl.createPortal(d.jsx(An,{children:t}),document.body),PR=({text:t})=>d.jsxs("div",{className:"flex flex-col h-full items-center justify-center gap-y-1",children:[d.jsx("span",{className:"sprite texture-animated-dalek"}),d.jsx(j,{children:t})]}),ER=()=>d.jsx("div",{className:"flex h-full items-center justify-center loading-border zx:zx-loading-border",role:"status","aria-label":"Loading",children:d.jsx("span",{className:"sprite texture-animated-head_walking_right","aria-hidden":!0})});var yi={},Va={},qa={},tA;function TR(){if(tA)return qa;tA=1,qa.__esModule=!0,qa.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function s(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function n(i){var o="".concat(i,"Storage");return s(o)?self[o]:r}return qa}var rA;function MR(){if(rA)return Va;rA=1,Va.__esModule=!0,Va.default=r;var t=e(TR());function e(s){return s&&s.__esModule?s:{default:s}}function r(s){var n=(0,t.default)(s);return{getItem:function(o){return new Promise(function(a,l){a(n.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(n.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(n.removeItem(o))})}}}return Va}var sA;function RR(){if(sA)return yi;sA=1,yi.__esModule=!0,yi.default=void 0;var t=e(MR());function e(s){return s&&s.__esModule?s:{default:s}}var r=(0,t.default)("local");return yi.default=r,yi}var IR=RR();const jR=Qe(IR),Ke=t=>{const e=Mh.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},OR=Y0({1:Ke,2:Ke,3:Ke,4:Ke,5:Ke,6:Ke,7:Ke,8:Ke,9:Ke,10:Ke,11:Ke,12:Ke,13:Ke,14:Ke,15:Ke,16:Ke,17:Ke}),NR=["userSettings","savedGames"],zR=17,BR={key:"hohol/gameMenus/userSettings",version:zR,migrate:OR,storage:jR,whitelist:NR},DR=F0(BR,Po.reducer),FR={count:0},ul=vr({name:"manualLoading",initialState:FR,reducers:{manualLoadingStarted(t){t.count++},manualLoadingFinished(t){t.count=Math.max(0,t.count-1)}},selectors:{selectManualLoadingCount(t){return t.count}}}),{manualLoadingStarted:LR,manualLoadingFinished:nA}=ul.actions,{selectManualLoadingCount:UR}=ul.selectors,hl=(t,e,r,s)=>{t(vR(GV(Dl(e()),e().gameMenus.userSettings.displaySettings,s)))},$R=()=>{pt()!=="server"&&Ad({actionCreator:of,effect(t,{dispatch:e,getState:r}){hl(e,r)}})},HR=()=>{pt()!=="server"&&Ad({predicate(t,{gameMenus:{userSettings:{displaySettings:e}}},{gameMenus:{userSettings:{displaySettings:r}}}){return e!==r},effect(t,{dispatch:e,getState:r}){hl(e,r)}})},jh=_0({[Po.reducerPath]:DR,[cl.reducerPath]:cl.reducer,[Is.reducerPath]:Is.reducer,[ul.reducerPath]:ul.reducer}).withLazyLoadedSlices();jh.inject;const GR=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?jh(void 0,e):jh(t,e),le=$v({reducer:GR,middleware:t=>t({serializableCheck:{ignoredActions:[xd,Vo,bd,Vd,qd,wd,qM.type]}}).prepend(dx.middleware).concat(Is.middleware)});typeof window<"u"&&(window._e2e_store=le);$R();HR();const WR=W0(le),iA=t=>{let e=t.parentElement;for(;e!==null;){const{overflowY:r}=window.getComputedStyle(e);if(r==="scroll"||r==="auto")return e;e=e.parentElement}return null},YR=()=>({directionVector:X,lookVector:{...X},...Ln(qx.map(t=>[t,!1]))}),cu={x:1,y:0,z:0},uu={x:-1,y:0,z:0},hu={x:0,y:-1,z:0},du={x:0,y:1,z:0},he={away:du,left:cu,right:uu,towards:hu,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:hn(U(du,uu)),towardsRight:hn(U(hu,uu)),towardsLeft:hn(U(hu,cu)),awayLeft:hn(U(du,cu))},QR={left:{axis:"x",plane:"xy",direction:-1},right:{axis:"x",plane:"xy",direction:1},towards:{axis:"y",plane:"xy",direction:1},away:{axis:"y",plane:"xy",direction:-1},lookLeft:{axis:"xLook",plane:"look",direction:-1},lookRight:{axis:"xLook",plane:"look",direction:1},lookUp:{axis:"yLook",plane:"look",direction:1},lookDown:{axis:"yLook",plane:"look",direction:-1}},Oh=t=>QR[t],KR=Math.cos(13*(Math.PI/180)),dl=-Math.PI/4,XR=t=>{const e=Math.cos(dl),r=Math.sin(dl);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}},JR=t=>{const e=Math.cos(dl),r=Math.sin(dl),s=t.x;return t.x=s*e-t.y*r,t.y=s*r+t.y*e,t};hn({x:1,y:2,z:0});hn({x:-1,y:2,z:0});const ZR=t=>{const e=o_(t);return e===void 0?X:he[e]},eI=t=>{const e=_d(t);return e===void 0?X:he[e]},tI=(t,e=KR)=>{const{x:r,y:s}=t,n=Math.sqrt(r*r+s*s);if(n===0)return X;const i=r/n,o=s/n,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(r)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(s)*n,z:0};return t},rI={"4-way":ZR,"8-way":eI,analogue:tI},sI=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),nI={lookLeft:he.left,lookRight:he.right,lookUp:he.away,lookDown:he.towards},iI=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}],oI=t=>{const e=Math.round((t+1)*3.5);return iI[e]??bx},aI=.2,lI=45,cI=(t,e)=>!!t.keyboardState.has(e),WV=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},fl=.5,YV=(t,e,r)=>{for(const s of t.gamepads)if(!(s===null||s.axes.length<=e)){if(r===void 0){if(Math.abs(s.axes[e])>fl)return!0}else if(s.axes[e]*r>fl)return!0}return!1},us=(t,e,r=!0)=>{const s=ll(le.getState()),n=s.presses[e];if(t.hudInputState[e])return!0;for(const o of n.keys)if(cI(t,o))return!0;for(const o of n.gamepadButtons)if(WV(t,o))return!0;const i=s.radialAxes?.xy??mn;for(const o of i){const a=Oh(e);if(a!==void 0&&a.plane==="xy")for(const l of t.gamepads){if(l===null||l.axes.length<=o)continue;const c=l.axes[o];if(oI(c)[a.axis]*a.direction>fl)return!0}}if(r){const o=Oh(e);if(o!==void 0){const a=s.axes[o.axis];for(const l of a)if(YV(t,l,o.direction))return!0}}return!1},oA=t=>{const e=yx(t);return e>1?Ut(t,1/e):t},aA=(t,e)=>t?JR(e):e;class uI{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=X;#r=X;#s=new Map;#n=()=>{const e=this.#e.at(0);if(e===void 0||us(e,"lookShift",!1))return X;let r,s,n,i;switch("tap"){case(r=this.currentActionPress("left")):return he.left;case(s=this.currentActionPress("right")):return he.right;case(n=this.currentActionPress("away")):return he.away;case(i=this.currentActionPress("towards")):return he.towards}const o=(r!=="released"?1:0)+(s!=="released"?1:0)+(n!=="released"?1:0)+(i!=="released"?1:0);if(o>1)return this.#t;if(o===1)switch("hold"){case r:return he.left;case s:return he.right;case n:return he.away;case i:return he.towards}return X};*#i(e,r,s){for(const n of r)us(e,n,!1)&&(yield s[n])}*#o(e,r,s,n,i){const o=ll(le.getState()).axes,a=o[r],l=o[s];for(const c of e.gamepads){if(c===null)continue;let u=0,h=0;for(const p of a)c.axes.length<=p||(u+=c.axes[p]*n);for(const p of l)c.axes.length<=p||(h+=c.axes[p]*i);const f={x:u,y:h,z:0};Fn(f)>aI&&(yield f)}}#l(e){const r=this.#e.at(0);if(r===void 0||us(r,"lookShift",!1))return X;let s=[...this.#i(r,pn,he)],n;if(s.length===1){const[c]=s,u=[...Fe(this.#e).drop(1).map(h=>[...this.#i(h,pn,he)])];e:for(const h of u){if(h.length>2)break e;if(h.length===2&&h.some(f=>vd(f,c))){const f=h.find(p=>Za(p,c)<.001);if(f!==void 0){n=f;break e}}}if(!n)for(const h of u)h.length===0&&(s=mn)}const i=e==="screen",o=e==="screen"||e==="mixed",a=aA(i,U(...s)),l=aA(o,U(...this.#o(r,"x","y",-1,-1)));return U(n??X,a,l)}#c(){const e=this.#e.at(0);if(e===void 0)return X;const r=us(e,"lookShift",!1);return oA(U(...this.#i(e,Vx,nI),...this.#o(e,"xLook","yLook",-1,-1),...r?this.#i(e,pn,he):mn,...r?this.#o(e,"x","y",-1,-1):mn))}#a=({lastTime:e})=>{const r=tf(le.getState()),s=rI[r];this.#t=oA(s(U(r==="4-way"?this.#n():this.#l(Zd(le.getState())),this.hudInputState.directionVector))),this.#r=this.#c();const n={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:sI(navigator.getGamepads()),atTime:e};this.#e.unshift(n);const i=e-lI,o=this.#e.findIndex(a=>a.atTime<i);if(o!==-1&&this.#e.splice(o+1),this.#s.size>0){const a=performance.now();for(const[l,c]of this.#s)(!us(n,l)||a>=c)&&this.#s.delete(l)}};currentActionPress(e,r=!1){const s=this.#e.at(0);if(s===void 0||!r&&this.#s.has(e))return"released";if(us(s,e)){const i=this.#e.at(1);return(i===void 0?!1:us(i,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const s of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(s))return{type:"key",input:s};for(const s of e.gamepads)if(s!==null){for(const[n,i]of s.buttons.entries())if(i.pressed&&(r===void 0||!WV(r,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of s.axes.entries())if(Math.abs(i)>fl&&(r===void 0||!YV(r,n)))return{type:"gamepadAxes",input:n}}}}inputWasHandled(e,r=1/0){this.#s.set(e,performance.now()+r)}get directionVector(){return this.#t}get lookVector(){return this.#r}startTicking(){dt.shared.add(this.#a,void 0,tl.INTERACTION)}stopTicking(){dt.shared.remove(this.#a)}}const hI=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape",""],dI=t=>hI.includes(t);let fI=1;const pI=()=>fI++,mI=3,lA=({key:t,location:e,repeat:r})=>{if(r)return;const s=t.length===1?t.toUpperCase():t,n=e===mI&&!s.startsWith("Arrow")?`Numpad${s}`:s;if(dI(n))return n;console.warn("unrecognised key",t)},gI=()=>new Map,AI=t=>{const e=n=>{const i=lA(n);i!==void 0&&t.set(i,pI())},r=n=>{const i=lA(n);i!==void 0&&t.delete(i)},s=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",s,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",s,!1)}},QV=v.createContext(null),yI=({children:t})=>{const[e]=v.useState(gI),[r]=v.useState(()=>new uI(e,YR()));return v.useEffect(()=>{const s=AI(e);return r.startTicking(),()=>{s(),r.stopTicking()}},[r,e]),d.jsx(QV,{value:r,children:t})},lf=()=>{const t=v.useContext(QV);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},_e=({handler:t,action:e,disabled:r=!1})=>{const s=v.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=lf();v.useEffect(()=>{if(r)return;const i=()=>{for(const o of s)if(n.currentActionPress(o)==="tap"){if(!t(o))for(const c of s)n.inputWasHandled(c);break}};return dt.shared.add(i),()=>{dt.shared.remove(i)}},[s,r,n,t])},xI=({handler:t,disabled:e=!1})=>{const r=lf();v.useEffect(()=>{if(e)return;const s=()=>{const n=r.inputTap();n!==void 0&&t(n,r)};return dt.shared.add(s),()=>{dt.shared.remove(s)}},[e,t,r])},Cn="data-menuitem_id",Ba="data-menuitem_hidden",Da="data-menuitem_disabled",bI="grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",KV=()=>{const t=document.body.querySelectorAll(`[${Cn}]`);return Array.from(t)},VI=(t,e)=>{let r=t;for(;r!==null&&r!==e;){const{position:s}=window.getComputedStyle(r);if(s==="sticky")return r;r=r.parentElement}return null},cA=(t,e)=>{const r=t.firstChild,s=r.getBoundingClientRect().top,n=e??document.documentElement;return VI(t,n)!==null?(e?.firstChild?.getBoundingClientRect().top??0)-r.getBoundingClientRect().height:s},Zs=(t,e)=>{const{gameMenus:{openMenus:[{focussedItemId:r}]}}=le.getState();if(r===void 0)return!0;const s=KV();if(s.length<=1)return!0;const n=s.findIndex(c=>c.getAttribute(Cn)===r);if(n===-1)return!0;let i=n;const o=s[n],a=iA(o);switch(e){case"all":{for(i=t===-1?0:s.length-1;s[i].getAttribute(Ba)==="true"||s[i].getAttribute(Da)==="true";)if(i+=t,i<0||i>=s.length)return!0;break}case"page":{const c=cA(o,a),u=a?.clientHeight??window.innerHeight,h=c+t*u;let f=n,p=1/0;for(let m=0;m<s.length;m++){if(m===n)continue;const A=s[m];if(A.getAttribute(Ba)==="true"||A.getAttribute(Da)==="true")continue;const g=cA(A,a),y=Math.abs(g-h);(t===-1&&g<c||t===1&&g>c)&&y<p&&(p=y,f=m)}i=f;break}case"single":{do i=(i+t+s.length)%s.length;while(s[i].getAttribute(Ba)==="true"||s[i].getAttribute(Da)==="true");break}}if(i===n)return!0;const l=s[i];return a!==iA(l)&&a?.scrollTo({top:0,behavior:"smooth"}),le.dispatch(af({focussedItemId:s[i].getAttribute(Cn),scrollableSelection:!0})),!1},qI=t=>{const e=kV();_e({action:"away",handler:v.useCallback(()=>{if(t.current!==null)return Zs(-1,"single")},[t]),disabled:e}),_e({action:"towards",handler:v.useCallback(()=>{if(t.current!==null)return Zs(1,"single")},[t]),disabled:e}),_e({action:"pageUp",handler:v.useCallback(()=>{if(t.current!==null)return Zs(-1,"page")},[t]),disabled:e}),_e({action:"pageDown",handler:v.useCallback(()=>{if(t.current!==null)return Zs(1,"page")},[t]),disabled:e}),_e({action:"home",handler:v.useCallback(()=>{if(t.current!==null)return Zs(-1,"all")},[t]),disabled:e}),_e({action:"end",handler:v.useCallback(()=>{if(t.current!==null)return Zs(1,"all")},[t]),disabled:e})},Ee=({className:t="",children:e,inline:r=!1})=>{const s=v.useRef(null);return v.useEffect(()=>{if(s.current===null||le.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const n=KV(),i=n[0].getAttribute(Cn),o=i==="back"&&n.length>1?n[1].getAttribute(Cn):i;le.dispatch(af({focussedItemId:o,scrollableSelection:!0}))},[]),qI(s),d.jsx("menu",{ref:s,className:at(r?"":bI,t),children:e})};function z(t,e){const r=Bd();return v.useCallback(()=>{r(t(e))},[t,r,e])}const wI=["menu_select","swop","jump"],vI=()=>{},XV=({id:t,hidden:e=!1,disabled:r=!1,onSelect:s=vI})=>{const n=v.useRef(!0),i=Y(a=>a.gameMenus.openMenus.at(0)?.scrollableSelection??!1),o=Y(a=>a.gameMenus.openMenus.at(0)?.focussedItemId===t);return _e({action:wI,handler:s,disabled:!o||e||r}),{menuItemProps:{[Cn]:t,[Ba]:e,[Da]:r,onMouseMove:z(af,{focussedItemId:t,scrollableSelection:!1}),onClick:r?void 0:s,tabIndex:0,role:"menuitem"},ref(a){o&&i&&a?.scrollIntoView({behavior:n.current?"instant":"smooth",block:"center"}),n.current=!1},focussed:o}},JV=({className:t})=>{const e=z(mt),{menuItemProps:r,ref:s,focussed:n}=XV({id:"back",onSelect:e});return d.jsxs("div",{...r,className:at("sprites-double-height flex flex-row gap-1 cursor-pointer "+(n?"selectedMenuItem":""),t),"data-to-parent-menu":!0,ref:s,children:[d.jsx(j,{className:"inline-block scale-x-[-1]",children:""}),d.jsx(j,{className:"inline-block",children:"Back"})]})},mr=({path:t=mn,className:e})=>{const r=t.at(-1);return d.jsxs("div",{className:at("flex flex-row sticky top-0 z-slightlyAbove py-oneScaledPix gap-2 pl-2",e),children:[d.jsx(Ee,{inline:!0,children:d.jsx(JV,{})}),d.jsxs("div",{className:"flex flex-row items-center",children:[t.slice(0,-1).map((s,n)=>d.jsxs("div",{className:"flex flex-row",children:[d.jsx(j,{className:"text-midGrey zx:text-pureBlack",children:s}),d.jsx(j,{className:"text-midRed zx:text-zxRedDimmed",children:""})]},n)),r&&d.jsx("div",{className:"flex flex-row sprites-double-height text-midRed zx:text-zxBlue",children:d.jsx(j,{TagName:"h1",children:r})})]})]})};var _I=["second","minute","hour","day","week","month","year"];function SI(t,e){if(e===0)return["just now","right now"];var r=_I[Math.floor(e/2)];return t>1&&(r+="s"),[t+" "+r+" ago","in "+t+" "+r]}var kI=["","","","","","",""];function CI(t,e){if(e===0)return["",""];var r=kI[~~(e/2)];return[t+" "+r+"",t+" "+r+""]}var Nh={},ZV=function(t,e){Nh[t]=e},PI=function(t){return Nh[t]||Nh.en_US},fu=[60,60,24,7,365/7/12,12];function EI(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function TI(t,e){var r=t<0?1:0;t=Math.abs(t);for(var s=t,n=0;t>=fu[n]&&n<fu.length;n++)t/=fu[n];return t=Math.floor(t),n*=2,t>(n===0?9:1)&&(n+=1),e(t,n,s)[r].replace("%s",t.toString())}function MI(t,e){var r=new Date;return(+r-+EI(t))/1e3}var RI=function(t,e,r){var s=MI(t);return TI(s,PI(e))};ZV("en_US",SI);ZV("zh_CN",CI);var zt={},en={},tn={},uA;function Ll(){if(uA)return tn;uA=1;var t=tn&&tn.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(tn,"__esModule",{value:!0});const r=t(Nn()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return tn.default=r,tn}var hA;function II(){if(hA)return en;hA=1;var t=en&&en.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(en,"__esModule",{value:!0});const e=t(Nn()),r=t(Ey()),s=t(Ll()),n=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(s.default),c=a[i],u=l[i];return c?u?r.default.createPortal(u(o),c,i):r.default.createPortal(o,c,i):null};return en.default=n,en}var rn={},dA;function jI(){if(dA)return rn;dA=1;var t=rn&&rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rn,"__esModule",{value:!0});const e=t(Nn()),r=t(Ll()),s=({id:n,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,o].filter(u=>!!u).join(" "),ref:c})};return rn.default=s,rn}var zr={},fA;function OI(){if(fA)return zr;fA=1;var t=zr&&zr.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=zr&&zr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(zr,"__esModule",{value:!0});const r=e(Nn()),s=e(Ll()),n=({children:i})=>{const[o,a]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((p,m,A)=>{a(g=>Object.assign(Object.assign({},g),{[p]:m})),c(g=>Object.assign(Object.assign({},g),{[p]:A}))},[]),h=r.default.useCallback(p=>{a(m=>{const A=m,g=p;return A[g],t(A,[typeof g=="symbol"?g:g+""])}),c(m=>{const A=m,g=p;return A[g],t(A,[typeof g=="symbol"?g:g+""])})},[]),f=r.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return r.default.createElement(s.default.Provider,{value:f},i)};return zr.default=n,zr}var pA;function NI(){if(pA)return zt;pA=1;var t=zt&&zt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.Context=zt.Placeholder=zt.Provider=void 0;const e=t(II()),r=t(jI()),s=t(OI()),n=t(Ll());zt.Provider=s.default,zt.Placeholder=r.default,zt.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=r.default,i.Provider=s.default,zt.default=i,zt}var zI=NI();const Ul=Qe(zI),BI=({flip:t=!1,focussed:e=!1,verticalAlignItemsCentre:r=!1})=>d.jsx(j,{className:"inline-block col-start-1 w-min ml-auto "+(t?"scale-x-[-1] relative bottom-oneScaledPix":"")+(r===!0?"flex items-center h-3":""),children:e?"":""}),ae="leading-none [--line-gap:1px] [&_[class*='texture-hud']]:mb-[calc(var(--scale)*var(--line-gap))]",DI=["menu_select","swop","jump"],FI=()=>{},L=({id:t,label:e,valueElement:r,flipLeader:s=!1,doubleHeight:n=!1,doubleHeightWhenFocussed:i,onSelect:o=FI,hidden:a=!1,disabled:l=!1,hintInline:c=!1,className:u,hint:h,leader:f,verticalAlignItemsCentre:p=!1,opensSubMenu:m=!1,toParentMenu:A=!1})=>{const{menuItemProps:g,ref:y,focussed:V}=XV({id:t,hidden:a,disabled:l,onSelect:o});_e({action:DI,handler:o,disabled:!V||a||l});const x=d.jsxs("li",{...g,"data-opens-submenu":m,"data-to-parent-menu":A,className:at("contents cursor-pointer",a?"hidden":"",n||i&&V?"sprites-double-height":"",V?"selectedMenuItem":"",u),children:[f||d.jsx(BI,{verticalAlignItemsCentre:p,flip:s,focussed:V}),d.jsx("div",{ref:y,className:at(r===void 0?"col-span-2":"",p===!0?"flex items-center":""),children:typeof e=="string"?d.jsx(d.Fragment,{children:d.jsx(j,{children:e})}):e}),r&&d.jsx("div",{className:`flex ${p===!0?"items-center":""}`,children:r}),!V||h===void 0||c?null:d.jsx(Ul,{children:typeof h=="string"?d.jsx(j,{className:ae,children:h}):h})]});return c&&h?d.jsxs(d.Fragment,{children:[x,d.jsx("div",{className:"col-span-2 col-start-2 mb-1",children:h})]}):x},Fa="text-lightGrey zx:text-zxWhite sprites-normal-height",LI=({userId:t,campaignName:e,label:r,version:s,createdAt:n})=>d.jsx(L,{className:"sprites-double-height",id:`campaign-${t}-${e}`,label:r,doubleHeightWhenFocussed:!0,onSelect:z(oo,{campaignLocator:{userId:t,campaignName:e,version:-1}}),hintInline:!0,hint:d.jsx("div",{"data-screenshot-mask":!0,children:d.jsx(j,{className:Fa,children:`v.${s} updated ${RI(n)}`})})}),UI=({campaigns:t})=>d.jsx(d.Fragment,{children:d.jsx("div",{className:"zx:text-zxCyan  resHandheld:mt-half flex flex-col gap-2",children:Object.values(t).flatMap(e=>d.jsxs("div",{className:"flex flex-col gap-half",children:[d.jsxs(j,{className:"text-metallicBlue zx:text-zxYellow pl-4 sprites-double-height",children:["By ",e.user.username,":"]}),Object.values(e.campaigns).map(r=>d.jsx(d.Fragment,{children:d.jsx(Ee,{children:d.jsx(LI,{userId:e.user.id,campaignName:r.name,label:`'${r.name}'`,version:r.version,createdAt:r.created_at})})},r.name))]},e.user.id))})}),$I=t=>{const{data:e,error:r,isLoading:s,refetch:n}=JT({publishedOnly:!0});return v.useEffect(()=>{n()},[n]),d.jsx(ze,{children:d.jsxs(Se,{fullScreen:!0,className:"bg-metallicBlueHalfbrite text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white zx:bg-zxRed gap-y-2 resHandheld:gap-y-1",dialogId:"communityGames",children:[d.jsx(mr,{path:["Play","Community"],className:"mobile:px-4"}),d.jsxs("div",{className:"flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-lightGrey scrollbar-track-metallicBlueHalfbrite zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3 [--leader-col-width:theme(width.3)] ",children:[r!==void 0?d.jsx(PR,{text:"Failed to load campaigns"}):null,s?d.jsx(ER,{}):null,e!==void 0?d.jsx(UI,{campaigns:e}):null]})]})})},HI=t=>{const{queries:e}=t[Is.reducerPath],{mutations:r}=t[Is.reducerPath],s=Object.values(e??{}).some(o=>o?.status==="pending"),n=Object.values(r??{}).some(o=>o?.status==="pending"),i=UR(t)>0;return s||n||i},eq=Wb(HI),gt=({className:t,onClick:e})=>eq()?d.jsx(Vw,{}):d.jsx("div",{className:`fixed inset-0 z-border ${t??""}`,onClick:e});function tq(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=tq(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function cf(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=tq(t))&&(s&&(s+=" "),s+=e);return s}function uf(...t){return at(cf(t))}const GI=t=>t.replace(/ArrowLeft/g,"").replace(/ArrowRight/g,"").replace(/ArrowUp/g,"").replace(/ArrowDown/g,""),mA=t=>{const e=t.map(GI);return e.length===1?`

key: **${e[0]}**`:`

keys: ${e.map(r=>`**${r}**`).join(" or ")}`},hf=(t,e)=>e?t?`${t}${mA(e)}`:mA(e):t;function Sr(t,e,{checkForDefaultPrevented:r=!0}={}){return function(n){if(t?.(n),r===!1||!n.defaultPrevented)return e?.(n)}}function gA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function rq(...t){return e=>{let r=!1;const s=t.map(n=>{const i=gA(n,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let n=0;n<s.length;n++){const i=s[n];typeof i=="function"?i():gA(t[n],null)}}}}function Bs(...t){return v.useCallback(rq(...t),t)}function sq(t,e=[]){let r=[];function s(i,o){const a=v.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:f,children:p,...m}=h,A=f?.[t]?.[l]||a,g=v.useMemo(()=>m,Object.values(m));return d.jsx(A.Provider,{value:g,children:p})};c.displayName=i+"Provider";function u(h,f){const p=f?.[t]?.[l]||a,m=v.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const n=()=>{const i=r.map(o=>v.createContext(o));return function(a){const l=a?.[t]||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return n.scopeName=t,[s,WI(n,...e)]}function WI(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function YI(t){const e=QI(t),r=v.forwardRef((s,n)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(XI);if(l){const c=l.props.children,u=a.map(h=>h===l?v.Children.count(c)>1?v.Children.only(null):v.isValidElement(c)?c.props.children:null:h);return d.jsx(e,{...o,ref:n,children:v.isValidElement(c)?v.cloneElement(c,void 0,u):null})}return d.jsx(e,{...o,ref:n,children:i})});return r.displayName=`${t}.Slot`,r}function QI(t){const e=v.forwardRef((r,s)=>{const{children:n,...i}=r;if(v.isValidElement(n)){const o=ZI(n),a=JI(i,n.props);return n.type!==v.Fragment&&(a.ref=s?rq(s,o):o),v.cloneElement(n,a)}return v.Children.count(n)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var nq=Symbol("radix.slottable");function KI(t){const e=({children:r})=>d.jsx(d.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=nq,e}function XI(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===nq}function JI(t,e){const r={...e};for(const s in e){const n=t[s],i=e[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...a)=>{const l=i(...a);return n(...a),l}:n&&(r[s]=n):s==="style"?r[s]={...n,...i}:s==="className"&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...t,...r}}function ZI(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var ej=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],is=ej.reduce((t,e)=>{const r=YI(`Primitive.${e}`),s=v.forwardRef((n,i)=>{const{asChild:o,...a}=n,l=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function tj(t,e){t&&Fl.flushSync(()=>t.dispatchEvent(e))}function $l(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...r)=>e.current?.(...r),[])}function rj(t,e=globalThis?.document){const r=$l(t);v.useEffect(()=>{const s=n=>{n.key==="Escape"&&r(n)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[r,e])}var sj="DismissableLayer",zh="dismissableLayer.update",nj="dismissableLayer.pointerDownOutside",ij="dismissableLayer.focusOutside",AA,iq=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),oq=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=v.useContext(iq),[u,h]=v.useState(null),f=u?.ownerDocument??globalThis?.document,[,p]=v.useState({}),m=Bs(e,q=>h(q)),A=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=A.indexOf(g),V=u?A.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,b=V>=y,w=lj(q=>{const S=q.target,k=[...c.branches].some(C=>C.contains(S));!b||k||(n?.(q),o?.(q),q.defaultPrevented||a?.())},f),_=cj(q=>{const S=q.target;[...c.branches].some(C=>C.contains(S))||(i?.(q),o?.(q),q.defaultPrevented||a?.())},f);return rj(q=>{V===c.layers.size-1&&(s?.(q),!q.defaultPrevented&&a&&(q.preventDefault(),a()))},f),v.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(AA=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),yA(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=AA)}},[u,f,r,c]),v.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),yA())},[u,c]),v.useEffect(()=>{const q=()=>p({});return document.addEventListener(zh,q),()=>document.removeEventListener(zh,q)},[]),d.jsx(is.div,{...l,ref:m,style:{pointerEvents:x?b?"auto":"none":void 0,...t.style},onFocusCapture:Sr(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Sr(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Sr(t.onPointerDownCapture,w.onPointerDownCapture)})});oq.displayName=sj;var oj="DismissableLayerBranch",aj=v.forwardRef((t,e)=>{const r=v.useContext(iq),s=v.useRef(null),n=Bs(e,s);return v.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),d.jsx(is.div,{...t,ref:n})});aj.displayName=oj;function lj(t,e=globalThis?.document){const r=$l(t),s=v.useRef(!1),n=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){aq(nj,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=l,e.addEventListener("click",n.current,{once:!0})):l()}else e.removeEventListener("click",n.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",n.current)}},[e,r]),{onPointerDownCapture:()=>s.current=!0}}function cj(t,e=globalThis?.document){const r=$l(t),s=v.useRef(!1);return v.useEffect(()=>{const n=i=>{i.target&&!s.current&&aq(ij,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function yA(){const t=new CustomEvent(zh);document.dispatchEvent(t)}function aq(t,e,r,{discrete:s}){const n=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),s?tj(n,i):n.dispatchEvent(i)}var Zr=globalThis?.document?v.useLayoutEffect:()=>{},uj=ed[" useId ".trim().toString()]||(()=>{}),hj=0;function dj(t){const[e,r]=v.useState(uj());return Zr(()=>{r(s=>s??String(hj++))},[t]),e?`radix-${e}`:""}const fj=["top","right","bottom","left"],es=Math.min,Tt=Math.max,pl=Math.round,wa=Math.floor,hr=t=>({x:t,y:t}),pj={left:"right",right:"left",bottom:"top",top:"bottom"},mj={start:"end",end:"start"};function Bh(t,e,r){return Tt(t,es(e,r))}function Mr(t,e){return typeof t=="function"?t(e):t}function Rr(t){return t.split("-")[0]}function Yn(t){return t.split("-")[1]}function df(t){return t==="x"?"y":"x"}function ff(t){return t==="y"?"height":"width"}function ts(t){return["top","bottom"].includes(Rr(t))?"y":"x"}function pf(t){return df(ts(t))}function gj(t,e,r){r===void 0&&(r=!1);const s=Yn(t),n=pf(t),i=ff(n);let o=n==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=ml(o)),[o,ml(o)]}function Aj(t){const e=ml(t);return[Dh(t),e,Dh(e)]}function Dh(t){return t.replace(/start|end/g,e=>mj[e])}function yj(t,e,r){const s=["left","right"],n=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?n:s:e?s:n;case"left":case"right":return e?i:o;default:return[]}}function xj(t,e,r,s){const n=Yn(t);let i=yj(Rr(t),r==="start",s);return n&&(i=i.map(o=>o+"-"+n),e&&(i=i.concat(i.map(Dh)))),i}function ml(t){return t.replace(/left|right|bottom|top/g,e=>pj[e])}function bj(t){return{top:0,right:0,bottom:0,left:0,...t}}function lq(t){return typeof t!="number"?bj(t):{top:t,right:t,bottom:t,left:t}}function gl(t){const{x:e,y:r,width:s,height:n}=t;return{width:s,height:n,top:r,left:e,right:e+s,bottom:r+n,x:e,y:r}}function xA(t,e,r){let{reference:s,floating:n}=t;const i=ts(e),o=pf(e),a=ff(o),l=Rr(e),c=i==="y",u=s.x+s.width/2-n.width/2,h=s.y+s.height/2-n.height/2,f=s[a]/2-n[a]/2;let p;switch(l){case"top":p={x:u,y:s.y-n.height};break;case"bottom":p={x:u,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-n.width,y:h};break;default:p={x:s.x,y:s.y}}switch(Yn(e)){case"start":p[o]-=f*(r&&c?-1:1);break;case"end":p[o]+=f*(r&&c?-1:1);break}return p}const Vj=async(t,e,r)=>{const{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:h}=xA(c,s,l),f=s,p={},m=0;for(let A=0;A<a.length;A++){const{name:g,fn:y}=a[A],{x:V,y:x,data:b,reset:w}=await y({x:u,y:h,initialPlacement:s,placement:f,strategy:n,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});u=V??u,h=x??h,p={...p,[g]:{...p[g],...b}},w&&m<=50&&(m++,typeof w=="object"&&(w.placement&&(f=w.placement),w.rects&&(c=w.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:n}):w.rects),{x:u,y:h}=xA(c,f,l)),A=-1)}return{x:u,y:h,placement:f,strategy:n,middlewareData:p}};async function lo(t,e){var r;e===void 0&&(e={});const{x:s,y:n,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=Mr(e,t),m=lq(p),g=a[f?h==="floating"?"reference":"floating":h],y=gl(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),V=h==="floating"?{x:s,y:n,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},w=gl(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:V,offsetParent:x,strategy:l}):V);return{top:(y.top-w.top+m.top)/b.y,bottom:(w.bottom-y.bottom+m.bottom)/b.y,left:(y.left-w.left+m.left)/b.x,right:(w.right-y.right+m.right)/b.x}}const qj=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:s,placement:n,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Mr(t,e)||{};if(c==null)return{};const h=lq(u),f={x:r,y:s},p=pf(n),m=ff(p),A=await o.getDimensions(c),g=p==="y",y=g?"top":"left",V=g?"bottom":"right",x=g?"clientHeight":"clientWidth",b=i.reference[m]+i.reference[p]-f[p]-i.floating[m],w=f[p]-i.reference[p],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let q=_?_[x]:0;(!q||!await(o.isElement==null?void 0:o.isElement(_)))&&(q=a.floating[x]||i.floating[m]);const S=b/2-w/2,k=q/2-A[m]/2-1,C=es(h[y],k),P=es(h[V],k),T=C,M=q-A[m]-P,I=q/2-A[m]/2+S,B=Bh(T,I,M),E=!l.arrow&&Yn(n)!=null&&I!==B&&i.reference[m]/2-(I<T?C:P)-A[m]/2<0,R=E?I<T?I-T:I-M:0;return{[p]:f[p]+R,data:{[p]:B,centerOffset:I-B-R,...E&&{alignmentOffset:R}},reset:E}}}),wj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,s;const{placement:n,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:A=!0,...g}=Mr(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Rr(n),V=ts(a),x=Rr(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=f||(x||!A?[ml(a)]:Aj(a)),_=m!=="none";!f&&_&&w.push(...xj(a,A,m,b));const q=[a,...w],S=await lo(e,g),k=[];let C=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&k.push(S[y]),h){const I=gj(n,o,b);k.push(S[I[0]],S[I[1]])}if(C=[...C,{placement:n,overflows:k}],!k.every(I=>I<=0)){var P,T;const I=(((P=i.flip)==null?void 0:P.index)||0)+1,B=q[I];if(B)return{data:{index:I,overflows:C},reset:{placement:B}};let E=(T=C.filter(R=>R.overflows[0]<=0).sort((R,D)=>R.overflows[1]-D.overflows[1])[0])==null?void 0:T.placement;if(!E)switch(p){case"bestFit":{var M;const R=(M=C.filter(D=>{if(_){const F=ts(D.placement);return F===V||F==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(F=>F>0).reduce((F,W)=>F+W,0)]).sort((D,F)=>D[1]-F[1])[0])==null?void 0:M[0];R&&(E=R);break}case"initialPlacement":E=a;break}if(n!==E)return{reset:{placement:E}}}return{}}}};function bA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function VA(t){return fj.some(e=>t[e]>=0)}const vj=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:s="referenceHidden",...n}=Mr(t,e);switch(s){case"referenceHidden":{const i=await lo(e,{...n,elementContext:"reference"}),o=bA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:VA(o)}}}case"escaped":{const i=await lo(e,{...n,altBoundary:!0}),o=bA(i,r.floating);return{data:{escapedOffsets:o,escaped:VA(o)}}}default:return{}}}}};async function _j(t,e){const{placement:r,platform:s,elements:n}=t,i=await(s.isRTL==null?void 0:s.isRTL(n.floating)),o=Rr(r),a=Yn(r),l=ts(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=Mr(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const Sj=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,s;const{x:n,y:i,placement:o,middlewareData:a}=e,l=await _j(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},kj=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:s,placement:n}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:V}=g;return{x:y,y:V}}},...l}=Mr(t,e),c={x:r,y:s},u=await lo(e,l),h=ts(Rr(n)),f=df(h);let p=c[f],m=c[h];if(i){const g=f==="y"?"top":"left",y=f==="y"?"bottom":"right",V=p+u[g],x=p-u[y];p=Bh(V,p,x)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",V=m+u[g],x=m-u[y];m=Bh(V,m,x)}const A=a.fn({...e,[f]:p,[h]:m});return{...A,data:{x:A.x-r,y:A.y-s,enabled:{[f]:i,[h]:o}}}}}},Cj=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:s,placement:n,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Mr(t,e),u={x:r,y:s},h=ts(n),f=df(h);let p=u[f],m=u[h];const A=Mr(a,e),g=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=f==="y"?"height":"width",b=i.reference[f]-i.floating[x]+g.mainAxis,w=i.reference[f]+i.reference[x]-g.mainAxis;p<b?p=b:p>w&&(p=w)}if(c){var y,V;const x=f==="y"?"width":"height",b=["top","left"].includes(Rr(n)),w=i.reference[h]-i.floating[x]+(b&&((y=o.offset)==null?void 0:y[h])||0)+(b?0:g.crossAxis),_=i.reference[h]+i.reference[x]+(b?0:((V=o.offset)==null?void 0:V[h])||0)-(b?g.crossAxis:0);m<w?m=w:m>_&&(m=_)}return{[f]:p,[h]:m}}}},Pj=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,s;const{placement:n,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Mr(t,e),u=await lo(e,c),h=Rr(n),f=Yn(n),p=ts(n)==="y",{width:m,height:A}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=f==="end"?"top":"bottom");const V=A-u.top-u.bottom,x=m-u.left-u.right,b=es(A-u[g],V),w=es(m-u[y],x),_=!e.middlewareData.shift;let q=b,S=w;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(S=x),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(q=V),_&&!f){const C=Tt(u.left,0),P=Tt(u.right,0),T=Tt(u.top,0),M=Tt(u.bottom,0);p?S=m-2*(C!==0||P!==0?C+P:Tt(u.left,u.right)):q=A-2*(T!==0||M!==0?T+M:Tt(u.top,u.bottom))}await l({...e,availableWidth:S,availableHeight:q});const k=await o.getDimensions(a.floating);return m!==k.width||A!==k.height?{reset:{rects:!0}}:{}}}};function Hl(){return typeof window<"u"}function Qn(t){return cq(t)?(t.nodeName||"").toLowerCase():"#document"}function It(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function gr(t){var e;return(e=(cq(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function cq(t){return Hl()?t instanceof Node||t instanceof It(t).Node:!1}function tr(t){return Hl()?t instanceof Element||t instanceof It(t).Element:!1}function pr(t){return Hl()?t instanceof HTMLElement||t instanceof It(t).HTMLElement:!1}function qA(t){return!Hl()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof It(t).ShadowRoot}function To(t){const{overflow:e,overflowX:r,overflowY:s,display:n}=rr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+r)&&!["inline","contents"].includes(n)}function Ej(t){return["table","td","th"].includes(Qn(t))}function Gl(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function mf(t){const e=gf(),r=tr(t)?rr(t):t;return["transform","translate","scale","rotate","perspective"].some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(r.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(r.contain||"").includes(s))}function Tj(t){let e=rs(t);for(;pr(e)&&!Pn(e);){if(mf(e))return e;if(Gl(e))return null;e=rs(e)}return null}function gf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Pn(t){return["html","body","#document"].includes(Qn(t))}function rr(t){return It(t).getComputedStyle(t)}function Wl(t){return tr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function rs(t){if(Qn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||qA(t)&&t.host||gr(t);return qA(e)?e.host:e}function uq(t){const e=rs(t);return Pn(e)?t.ownerDocument?t.ownerDocument.body:t.body:pr(e)&&To(e)?e:uq(e)}function co(t,e,r){var s;e===void 0&&(e=[]),r===void 0&&(r=!0);const n=uq(t),i=n===((s=t.ownerDocument)==null?void 0:s.body),o=It(n);if(i){const a=Fh(o);return e.concat(o,o.visualViewport||[],To(n)?n:[],a&&r?co(a):[])}return e.concat(n,co(n,[],r))}function Fh(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function hq(t){const e=rr(t);let r=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const n=pr(t),i=n?t.offsetWidth:r,o=n?t.offsetHeight:s,a=pl(r)!==i||pl(s)!==o;return a&&(r=i,s=o),{width:r,height:s,$:a}}function Af(t){return tr(t)?t:t.contextElement}function yn(t){const e=Af(t);if(!pr(e))return hr(1);const r=e.getBoundingClientRect(),{width:s,height:n,$:i}=hq(e);let o=(i?pl(r.width):r.width)/s,a=(i?pl(r.height):r.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Mj=hr(0);function dq(t){const e=It(t);return!gf()||!e.visualViewport?Mj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Rj(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==It(t)?!1:e}function js(t,e,r,s){e===void 0&&(e=!1),r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=Af(t);let o=hr(1);e&&(s?tr(s)&&(o=yn(s)):o=yn(t));const a=Rj(i,r,s)?dq(i):hr(0);let l=(n.left+a.x)/o.x,c=(n.top+a.y)/o.y,u=n.width/o.x,h=n.height/o.y;if(i){const f=It(i),p=s&&tr(s)?It(s):s;let m=f,A=Fh(m);for(;A&&s&&p!==m;){const g=yn(A),y=A.getBoundingClientRect(),V=rr(A),x=y.left+(A.clientLeft+parseFloat(V.paddingLeft))*g.x,b=y.top+(A.clientTop+parseFloat(V.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=x,c+=b,m=It(A),A=Fh(m)}}return gl({width:u,height:h,x:l,y:c})}function yf(t,e){const r=Wl(t).scrollLeft;return e?e.left+r:js(gr(t)).left+r}function fq(t,e,r){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),n=s.left+e.scrollLeft-(r?0:yf(t,s)),i=s.top+e.scrollTop;return{x:n,y:i}}function Ij(t){let{elements:e,rect:r,offsetParent:s,strategy:n}=t;const i=n==="fixed",o=gr(s),a=e?Gl(e.floating):!1;if(s===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=hr(1);const u=hr(0),h=pr(s);if((h||!h&&!i)&&((Qn(s)!=="body"||To(o))&&(l=Wl(s)),pr(s))){const p=js(s);c=yn(s),u.x=p.x+s.clientLeft,u.y=p.y+s.clientTop}const f=o&&!h&&!i?fq(o,l,!0):hr(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:r.y*c.y-l.scrollTop*c.y+u.y+f.y}}function jj(t){return Array.from(t.getClientRects())}function Oj(t){const e=gr(t),r=Wl(t),s=t.ownerDocument.body,n=Tt(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Tt(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+yf(t);const a=-r.scrollTop;return rr(s).direction==="rtl"&&(o+=Tt(e.clientWidth,s.clientWidth)-n),{width:n,height:i,x:o,y:a}}function Nj(t,e){const r=It(t),s=gr(t),n=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(n){i=n.width,o=n.height;const c=gf();(!c||c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:a,y:l}}function zj(t,e){const r=js(t,!0,e==="fixed"),s=r.top+t.clientTop,n=r.left+t.clientLeft,i=pr(t)?yn(t):hr(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=n*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function wA(t,e,r){let s;if(e==="viewport")s=Nj(t,r);else if(e==="document")s=Oj(gr(t));else if(tr(e))s=zj(e,r);else{const n=dq(t);s={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return gl(s)}function pq(t,e){const r=rs(t);return r===e||!tr(r)||Pn(r)?!1:rr(r).position==="fixed"||pq(r,e)}function Bj(t,e){const r=e.get(t);if(r)return r;let s=co(t,[],!1).filter(a=>tr(a)&&Qn(a)!=="body"),n=null;const i=rr(t).position==="fixed";let o=i?rs(t):t;for(;tr(o)&&!Pn(o);){const a=rr(o),l=mf(o);!l&&a.position==="fixed"&&(n=null),(i?!l&&!n:!l&&a.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||To(o)&&!l&&pq(t,o))?s=s.filter(u=>u!==o):n=a,o=rs(o)}return e.set(t,s),s}function Dj(t){let{element:e,boundary:r,rootBoundary:s,strategy:n}=t;const o=[...r==="clippingAncestors"?Gl(e)?[]:Bj(e,this._c):[].concat(r),s],a=o[0],l=o.reduce((c,u)=>{const h=wA(e,u,n);return c.top=Tt(h.top,c.top),c.right=es(h.right,c.right),c.bottom=es(h.bottom,c.bottom),c.left=Tt(h.left,c.left),c},wA(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Fj(t){const{width:e,height:r}=hq(t);return{width:e,height:r}}function Lj(t,e,r){const s=pr(e),n=gr(e),i=r==="fixed",o=js(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=hr(0);if(s||!s&&!i)if((Qn(e)!=="body"||To(n))&&(a=Wl(e)),s){const f=js(e,!0,i,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else n&&(l.x=yf(n));const c=n&&!s&&!i?fq(n,a):hr(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function pu(t){return rr(t).position==="static"}function vA(t,e){if(!pr(t)||rr(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return gr(t)===r&&(r=r.ownerDocument.body),r}function mq(t,e){const r=It(t);if(Gl(t))return r;if(!pr(t)){let n=rs(t);for(;n&&!Pn(n);){if(tr(n)&&!pu(n))return n;n=rs(n)}return r}let s=vA(t,e);for(;s&&Ej(s)&&pu(s);)s=vA(s,e);return s&&Pn(s)&&pu(s)&&!mf(s)?r:s||Tj(t)||r}const Uj=async function(t){const e=this.getOffsetParent||mq,r=this.getDimensions,s=await r(t.floating);return{reference:Lj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function $j(t){return rr(t).direction==="rtl"}const Hj={convertOffsetParentRelativeRectToViewportRelativeRect:Ij,getDocumentElement:gr,getClippingRect:Dj,getOffsetParent:mq,getElementRects:Uj,getClientRects:jj,getDimensions:Fj,getScale:yn,isElement:tr,isRTL:$j};function gq(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Gj(t,e){let r=null,s;const n=gr(t);function i(){var a;clearTimeout(s),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:f,height:p}=c;if(a||e(),!f||!p)return;const m=wa(h),A=wa(n.clientWidth-(u+f)),g=wa(n.clientHeight-(h+p)),y=wa(u),x={rootMargin:-m+"px "+-A+"px "+-g+"px "+-y+"px",threshold:Tt(0,es(1,l))||1};let b=!0;function w(_){const q=_[0].intersectionRatio;if(q!==l){if(!b)return o();q?o(!1,q):s=setTimeout(()=>{o(!1,1e-7)},1e3)}q===1&&!gq(c,t.getBoundingClientRect())&&o(),b=!1}try{r=new IntersectionObserver(w,{...x,root:n.ownerDocument})}catch{r=new IntersectionObserver(w,x)}r.observe(t)}return o(!0),i}function Wj(t,e,r,s){s===void 0&&(s={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=Af(t),u=n||i?[...c?co(c):[],...co(e)]:[];u.forEach(y=>{n&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const h=c&&a?Gj(c,r):null;let f=-1,p=null;o&&(p=new ResizeObserver(y=>{let[V]=y;V&&V.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=p)==null||x.observe(e)})),r()}),c&&!l&&p.observe(c),p.observe(e));let m,A=l?js(t):null;l&&g();function g(){const y=js(t);A&&!gq(A,y)&&r(),A=y,m=requestAnimationFrame(g)}return r(),()=>{var y;u.forEach(V=>{n&&V.removeEventListener("scroll",r),i&&V.removeEventListener("resize",r)}),h?.(),(y=p)==null||y.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const Yj=Sj,Qj=kj,Kj=wj,Xj=Pj,Jj=vj,_A=qj,Zj=Cj,eO=(t,e,r)=>{const s=new Map,n={platform:Hj,...r},i={...n.platform,_c:s};return Vj(t,e,{...n,platform:i})};var La=typeof document<"u"?v.useLayoutEffect:v.useEffect;function Al(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,s,n;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(s=r;s--!==0;)if(!Al(t[s],e[s]))return!1;return!0}if(n=Object.keys(t),r=n.length,r!==Object.keys(e).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(e,n[s]))return!1;for(s=r;s--!==0;){const i=n[s];if(!(i==="_owner"&&t.$$typeof)&&!Al(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function Aq(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function SA(t,e){const r=Aq(t);return Math.round(e*r)/r}function mu(t){const e=v.useRef(t);return La(()=>{e.current=t}),e}function tO(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:s=[],platform:n,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=v.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=v.useState(s);Al(f,s)||p(s);const[m,A]=v.useState(null),[g,y]=v.useState(null),V=v.useCallback(D=>{D!==_.current&&(_.current=D,A(D))},[]),x=v.useCallback(D=>{D!==q.current&&(q.current=D,y(D))},[]),b=i||m,w=o||g,_=v.useRef(null),q=v.useRef(null),S=v.useRef(u),k=l!=null,C=mu(l),P=mu(n),T=mu(c),M=v.useCallback(()=>{if(!_.current||!q.current)return;const D={placement:e,strategy:r,middleware:f};P.current&&(D.platform=P.current),eO(_.current,q.current,D).then(F=>{const W={...F,isPositioned:T.current!==!1};I.current&&!Al(S.current,W)&&(S.current=W,Fl.flushSync(()=>{h(W)}))})},[f,e,r,P,T]);La(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,h(D=>({...D,isPositioned:!1})))},[c]);const I=v.useRef(!1);La(()=>(I.current=!0,()=>{I.current=!1}),[]),La(()=>{if(b&&(_.current=b),w&&(q.current=w),b&&w){if(C.current)return C.current(b,w,M);M()}},[b,w,M,C,k]);const B=v.useMemo(()=>({reference:_,floating:q,setReference:V,setFloating:x}),[V,x]),E=v.useMemo(()=>({reference:b,floating:w}),[b,w]),R=v.useMemo(()=>{const D={position:r,left:0,top:0};if(!E.floating)return D;const F=SA(E.floating,u.x),W=SA(E.floating,u.y);return a?{...D,transform:"translate("+F+"px, "+W+"px)",...Aq(E.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:F,top:W}},[r,a,E.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:M,refs:B,elements:E,floatingStyles:R}),[u,M,B,E,R])}const rO=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:n}=typeof t=="function"?t(r):t;return s&&e(s)?s.current!=null?_A({element:s.current,padding:n}).fn(r):{}:s?_A({element:s,padding:n}).fn(r):{}}}},sO=(t,e)=>({...Yj(t),options:[t,e]}),nO=(t,e)=>({...Qj(t),options:[t,e]}),iO=(t,e)=>({...Zj(t),options:[t,e]}),oO=(t,e)=>({...Kj(t),options:[t,e]}),aO=(t,e)=>({...Xj(t),options:[t,e]}),lO=(t,e)=>({...Jj(t),options:[t,e]}),cO=(t,e)=>({...rO(t),options:[t,e]});var uO="Arrow",yq=v.forwardRef((t,e)=>{const{children:r,width:s=10,height:n=5,...i}=t;return d.jsx(is.svg,{...i,ref:e,width:s,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});yq.displayName=uO;var hO=yq;function dO(t){const[e,r]=v.useState(void 0);return Zr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const i=n[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),e}var xf="Popper",[xq,bq]=sq(xf),[fO,Vq]=xq(xf),qq=t=>{const{__scopePopper:e,children:r}=t,[s,n]=v.useState(null);return d.jsx(fO,{scope:e,anchor:s,onAnchorChange:n,children:r})};qq.displayName=xf;var wq="PopperAnchor",vq=v.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:s,...n}=t,i=Vq(wq,r),o=v.useRef(null),a=Bs(e,o);return v.useEffect(()=>{i.onAnchorChange(s?.current||o.current)}),s?null:d.jsx(is.div,{...n,ref:a})});vq.displayName=wq;var bf="PopperContent",[pO,mO]=xq(bf),_q=v.forwardRef((t,e)=>{const{__scopePopper:r,side:s="bottom",sideOffset:n=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...A}=t,g=Vq(bf,r),[y,V]=v.useState(null),x=Bs(e,Be=>V(Be)),[b,w]=v.useState(null),_=dO(b),q=_?.width??0,S=_?.height??0,k=s+(i!=="center"?"-"+i:""),C=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(c)?c:[c],T=P.length>0,M={padding:C,boundary:P.filter(AO),altBoundary:T},{refs:I,floatingStyles:B,placement:E,isPositioned:R,middlewareData:D}=tO({strategy:"fixed",placement:k,whileElementsMounted:(...Be)=>Wj(...Be,{animationFrame:p==="always"}),elements:{reference:g.anchor},middleware:[sO({mainAxis:n+S,alignmentAxis:o}),l&&nO({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?iO():void 0,...M}),l&&oO({...M}),aO({...M,apply:({elements:Be,rects:nr,availableWidth:yt,availableHeight:Gt})=>{const{width:Ar,height:St}=nr.reference,xt=Be.floating.style;xt.setProperty("--radix-popper-available-width",`${yt}px`),xt.setProperty("--radix-popper-available-height",`${Gt}px`),xt.setProperty("--radix-popper-anchor-width",`${Ar}px`),xt.setProperty("--radix-popper-anchor-height",`${St}px`)}}),b&&cO({element:b,padding:a}),yO({arrowWidth:q,arrowHeight:S}),f&&lO({strategy:"referenceHidden",...M})]}),[F,W]=Cq(E),me=$l(m);Zr(()=>{R&&me?.()},[R,me]);const ie=D.arrow?.x,te=D.arrow?.y,ge=D.arrow?.centerOffset!==0,[oe,ce]=v.useState();return Zr(()=>{y&&ce(window.getComputedStyle(y).zIndex)},[y]),d.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:R?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:oe,"--radix-popper-transform-origin":[D.transformOrigin?.x,D.transformOrigin?.y].join(" "),...D.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:d.jsx(pO,{scope:r,placedSide:F,onArrowChange:w,arrowX:ie,arrowY:te,shouldHideArrow:ge,children:d.jsx(is.div,{"data-side":F,"data-align":W,...A,ref:x,style:{...A.style,animation:R?void 0:"none"}})})})});_q.displayName=bf;var Sq="PopperArrow",gO={top:"bottom",right:"left",bottom:"top",left:"right"},kq=v.forwardRef(function(e,r){const{__scopePopper:s,...n}=e,i=mO(Sq,s),o=gO[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(hO,{...n,ref:r,style:{...n.style,display:"block"}})})});kq.displayName=Sq;function AO(t){return t!==null}var yO=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:s,middlewareData:n}=e,o=n.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Cq(r),h={start:"0%",center:"50%",end:"100%"}[u],f=(n.arrow?.x??0)+a/2,p=(n.arrow?.y??0)+l/2;let m="",A="";return c==="bottom"?(m=o?h:`${f}px`,A=`${-l}px`):c==="top"?(m=o?h:`${f}px`,A=`${s.floating.height+l}px`):c==="right"?(m=`${-l}px`,A=o?h:`${p}px`):c==="left"&&(m=`${s.floating.width+l}px`,A=o?h:`${p}px`),{data:{x:m,y:A}}}});function Cq(t){const[e,r="center"]=t.split("-");return[e,r]}var xO=qq,bO=vq,VO=_q,qO=kq,wO="Portal",Pq=v.forwardRef((t,e)=>{const{container:r,...s}=t,[n,i]=v.useState(!1);Zr(()=>i(!0),[]);const o=r||n&&globalThis?.document?.body;return o?VR.createPortal(d.jsx(is.div,{...s,ref:e}),o):null});Pq.displayName=wO;function vO(t,e){return v.useReducer((r,s)=>e[r][s]??r,t)}var Vf=t=>{const{present:e,children:r}=t,s=_O(e),n=typeof r=="function"?r({present:s.isPresent}):v.Children.only(r),i=Bs(s.ref,SO(n));return typeof r=="function"||s.isPresent?v.cloneElement(n,{ref:i}):null};Vf.displayName="Presence";function _O(t){const[e,r]=v.useState(),s=v.useRef(null),n=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=vO(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const c=va(s.current);i.current=a==="mounted"?c:"none"},[a]),Zr(()=>{const c=s.current,u=n.current;if(u!==t){const f=i.current,p=va(c);t?l("MOUNT"):p==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,l]),Zr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const A=va(s.current).includes(p.animationName);if(p.target===e&&A&&(l("ANIMATION_END"),!n.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},f=p=>{p.target===e&&(i.current=va(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(c=>{s.current=c?getComputedStyle(c):null,r(c)},[])}}function va(t){return t?.animationName||"none"}function SO(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var kO=ed[" useInsertionEffect ".trim().toString()]||Zr;function CO({prop:t,defaultProp:e,onChange:r=()=>{},caller:s}){const[n,i,o]=PO({defaultProp:e,onChange:r}),a=t!==void 0,l=a?t:n;{const u=v.useRef(t!==void 0);v.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,s])}const c=v.useCallback(u=>{if(a){const h=EO(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function PO({defaultProp:t,onChange:e}){const[r,s]=v.useState(t),n=v.useRef(r),i=v.useRef(e);return kO(()=>{i.current=e},[e]),v.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}function EO(t){return typeof t=="function"}var TO=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),MO="VisuallyHidden",Eq=v.forwardRef((t,e)=>d.jsx(is.span,{...t,ref:e,style:{...TO,...t.style}}));Eq.displayName=MO;var RO=Eq,[Yl]=sq("Tooltip",[bq]),Ql=bq(),IO="TooltipProvider",Lh="tooltip.open",[bU,qf]=Yl(IO),uo="Tooltip",[jO,Mo]=Yl(uo),Tq=t=>{const{__scopeTooltip:e,children:r,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=qf(uo,t.__scopeTooltip),c=Ql(e),[u,h]=v.useState(null),f=dj(),p=v.useRef(0),m=o??l.disableHoverableContent,A=a??l.delayDuration,g=v.useRef(!1),[y,V]=CO({prop:s,defaultProp:n??!1,onChange:q=>{q?(l.onOpen(),document.dispatchEvent(new CustomEvent(Lh))):l.onClose(),i?.(q)},caller:uo}),x=v.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),b=v.useCallback(()=>{window.clearTimeout(p.current),p.current=0,g.current=!1,V(!0)},[V]),w=v.useCallback(()=>{window.clearTimeout(p.current),p.current=0,V(!1)},[V]),_=v.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{g.current=!0,V(!0),p.current=0},A)},[A,V]);return v.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),d.jsx(xO,{...c,children:d.jsx(jO,{scope:e,contentId:f,open:y,stateAttribute:x,trigger:u,onTriggerChange:h,onTriggerEnter:v.useCallback(()=>{l.isOpenDelayedRef.current?_():b()},[l.isOpenDelayedRef,_,b]),onTriggerLeave:v.useCallback(()=>{m?w():(window.clearTimeout(p.current),p.current=0)},[w,m]),onOpen:b,onClose:w,disableHoverableContent:m,children:r})})};Tq.displayName=uo;var Uh="TooltipTrigger",Mq=v.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=Mo(Uh,r),i=qf(Uh,r),o=Ql(r),a=v.useRef(null),l=Bs(e,a,n.onTriggerChange),c=v.useRef(!1),u=v.useRef(!1),h=v.useCallback(()=>c.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),d.jsx(bO,{asChild:!0,...o,children:d.jsx(is.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:l,onPointerMove:Sr(t.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:Sr(t.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:Sr(t.onPointerDown,()=>{n.open&&n.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Sr(t.onFocus,()=>{c.current||n.onOpen()}),onBlur:Sr(t.onBlur,n.onClose),onClick:Sr(t.onClick,n.onClose)})})});Mq.displayName=Uh;var wf="TooltipPortal",[OO,NO]=Yl(wf,{forceMount:void 0}),Rq=t=>{const{__scopeTooltip:e,forceMount:r,children:s,container:n}=t,i=Mo(wf,e);return d.jsx(OO,{scope:e,forceMount:r,children:d.jsx(Vf,{present:r||i.open,children:d.jsx(Pq,{asChild:!0,container:n,children:s})})})};Rq.displayName=wf;var En="TooltipContent",Iq=v.forwardRef((t,e)=>{const r=NO(En,t.__scopeTooltip),{forceMount:s=r.forceMount,side:n="top",...i}=t,o=Mo(En,t.__scopeTooltip);return d.jsx(Vf,{present:s||o.open,children:o.disableHoverableContent?d.jsx(jq,{side:n,...i,ref:e}):d.jsx(zO,{side:n,...i,ref:e})})}),zO=v.forwardRef((t,e)=>{const r=Mo(En,t.__scopeTooltip),s=qf(En,t.__scopeTooltip),n=v.useRef(null),i=Bs(e,n),[o,a]=v.useState(null),{trigger:l,onClose:c}=r,u=n.current,{onPointerInTransitChange:h}=s,f=v.useCallback(()=>{a(null),h(!1)},[h]),p=v.useCallback((m,A)=>{const g=m.currentTarget,y={x:m.clientX,y:m.clientY},V=UO(y,g.getBoundingClientRect()),x=$O(y,V),b=HO(A.getBoundingClientRect()),w=WO([...x,...b]);a(w),h(!0)},[h]);return v.useEffect(()=>()=>f(),[f]),v.useEffect(()=>{if(l&&u){const m=g=>p(g,u),A=g=>p(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",A)}}},[l,u,p,f]),v.useEffect(()=>{if(o){const m=A=>{const g=A.target,y={x:A.clientX,y:A.clientY},V=l?.contains(g)||u?.contains(g),x=!GO(y,o);V?f():x&&(f(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,f]),d.jsx(jq,{...t,ref:i})}),[BO,DO]=Yl(uo,{isInside:!1}),FO=KI("TooltipContent"),jq=v.forwardRef((t,e)=>{const{__scopeTooltip:r,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=Mo(En,r),c=Ql(r),{onClose:u}=l;return v.useEffect(()=>(document.addEventListener(Lh,u),()=>document.removeEventListener(Lh,u)),[u]),v.useEffect(()=>{if(l.trigger){const h=f=>{f.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),d.jsx(oq,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:d.jsxs(VO,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[d.jsx(FO,{children:s}),d.jsx(BO,{scope:r,isInside:!0,children:d.jsx(RO,{id:l.contentId,role:"tooltip",children:n||s})})]})})});Iq.displayName=En;var Oq="TooltipArrow",LO=v.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=Ql(r);return DO(Oq,r).isInside?null:d.jsx(qO,{...n,...s,ref:e})});LO.displayName=Oq;function UO(t,e){const r=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,s,n,i)){case i:return"left";case n:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function $O(t,e,r=5){const s=[];switch(e){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function HO(t){const{top:e,right:r,bottom:s,left:n}=t;return[{x:n,y:e},{x:r,y:e},{x:r,y:s},{x:n,y:s}]}function GO(t,e){const{x:r,y:s}=t;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,f=l.y;u>s!=f>s&&r<(h-c)*(s-u)/(f-u)+c&&(n=!n)}return n}function WO(t){const e=t.slice();return e.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),YO(e)}function YO(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const n=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const r=[];for(let s=t.length-1;s>=0;s--){const n=t[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var QO=Tq;const KO={"":v.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},kA=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),XO=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),gu=t=>t.replace(/^\s+|\s+$/g," "),Ue=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),Ei=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,s=0;const n=Ue("");let i,o;e?(i=Ue("p"),o=[n,i],n.c.push(i)):(i=n,o=[n]);let a;const l=(h,f=!0)=>(f&&o.push(h),i.c.push(h),f&&(i=h),h),c=h=>{const f=o.findIndex(p=>p.t===h);o=o.slice(0,f),i=o.at(-1)};for(;a=r.exec(t);){const h=t.substring(s,a.index);if(s=r.lastIndex,h!=="")if(i===n&&e){const f=Ue("p",gu(h));n.c.push(f),o=[n,f],i=f}else i.c.push(gu(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const f=Ue("pre",a[4]?kA(a[4]):Ue("code",kA(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));n.c.push(f),o=[n],i=n}else if(a[6]){const f=a[6],p=f!==">",m=!!f.match(/\./),A=p?m?"ol":"ul":"blockquote",g=a[5].split(`
`).map(V=>V.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(V=>V.trim()!==""),y=Ue(A,p?g.map(V=>Ue("li",Ei(V).c)):Ei(g.join(`
`)).c);n.c.push(y),o=[n,y],i=n}else if(a[8]){const f=Ue("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===n){const p=Ue("p",f);n.c.push(p),i=p,o=[n,p]}else l(f,!1)}else if(a[10]){const f=o.find(p=>p.t==="a");f&&(f.p.href=a[11])}else if(a[9])l(Ue("a"));else if(a[14]){const f="h"+a[14].length;n.c.push(Ue(f,Ei(a[15]).c)),o=[n],i=n}else if(a[13])n.c.push(Ue("h1",Ei(a[12]).c)),o=[n],i=n;else if(a[16])l(Ue("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const m=n.c;let A;for(A=m.length-1;A>=0&&!XO(m[A]);A--);if(A!==n.c.length-1){const g=n.c.splice(A+1);n.c.push(Ue("p",g))}}const p=Ue("p");n.c.push(p),o=[n,p],i=p}else if(a[1])n.c.push(Ue("hr")),o=[n],i=n;else if(a[17]){const f=a[17].length===2?"strong":"em";o.findIndex(m=>m.t===f)===-1?l(Ue(f)):c(f)}}}const u=gu(t.substring(s));if(u.length){const h=n.c.at(-1);let f;h?.t==="p"?f=h:e?(f=Ue("p"),n.c.push(f)):f=n,f.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},JO=(t,e={})=>{const r={...KO,...e},s=(n,i=0)=>{const o=n.t===""?v.Fragment:r[n.t];return v.createElement(o,{...n.p,key:i},n.c.length===0?void 0:n.c.map((a,l)=>typeof a=="string"?a:s(a,l)))};return s(Ei(t,!0))},ZO=({markdown:t,customComponents:e})=>JO(t,e),eN={h2:function({children:e}){return d.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${ae}`,children:d.jsx(Je,{children:e})})},h3:function({children:e}){return d.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:d.jsx(Je,{children:e})})},blockquote:function({children:e}){return d.jsx("blockquote",{className:`${ae} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:d.jsxs(Je,{children:["> ",e]})})},p:function({children:e}){return d.jsx("div",{className:`mb-1 last:mb-0 ${ae}`,children:d.jsx(Je,{children:e})})},a:function({children:e,href:r}){return d.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:d.jsx(Je,{children:e})})},li:function({children:e}){return d.jsx("div",{className:`mb-1 clear-both ${ae}`,children:d.jsxs(Je,{children:[d.jsx(j,{className:"text-metallicBlue zx:text-zxYellow",children:""}),e]})})},strong:function({children:e}){return d.jsx(Je,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return d.jsx(Je,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=Eo();if(e===void 0)throw new Error("image without src");const s=e.split(/\?|&/);return d.jsx("span",{style:{"--scale":r*2},children:d.jsx("span",{className:at("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",s.join(" "))})})},hr:function(){return d.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},pe=({markdown:t,className:e})=>d.jsx("div",{className:`contents ${e}`,children:d.jsx(ZO,{customComponents:eN,markdown:t})}),vf=({triggerContent:t,tooltipContent:e})=>e?d.jsxs(QO,{children:[d.jsx(Mq,{asChild:!0,children:t}),d.jsx(Rq,{children:d.jsx(An,{scaleFactor:2,children:d.jsx(Iq,{side:"bottom",align:"end",className:"bg-lightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?d.jsx("div",{className:"max-w-16",children:d.jsx(pe,{markdown:e})}):e})})})]}):t,tN=/^(?<modifiers>[^]*)(?<key>.+)$/,rN=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},_f=(t,e,r,s=void 0)=>{const n=t?.join(" ");v.useEffect(()=>{if(!t||t.length===0||s===null)return;const i=s??window,o=a=>{let c=a.target;for(;c&&c!==i;){if(c.classList.contains("no-keyboard-shortcuts"))return;c=c.parentElement}for(const u of t){const h=u.match(tN);if(!h||!h.groups)continue;const{modifiers:f,key:p}=h.groups;if(rN(f)){console.warn(`Invalid shortcut "${u}": duplicate modifiers`);continue}const m=f.includes("^"),A=f.includes(""),g=f.includes(""),y=f.includes(""),V=m||A||g||y,x=m===a.ctrlKey&&A===a.metaKey&&g===a.shiftKey&&y===a.altKey&&(V||!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey);if((y&&a.altKey?a.code.replace(/^Key/,"").toLowerCase():a.key.toLowerCase())===p.toLowerCase()&&x){e||r?.(),a.preventDefault();break}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[e,r,n,s])},sN=({className:t,selected:e,disabled:r=!1,onClick:s,ref:n,tooltipContent:i,shortcutKeys:o,children:a,...l})=>{_f(o,r,s);const c=d.jsx("button",{disabled:r,onClick:s,"data-selected":e,className:uf(`inline-flex items-center justify-center whitespace-nowrap 
          bg-metallicBlue zx:bg-zxBlue border-none border-shadow
          gap-2
           disabled:bg-midGrey disabled:text-lightGrey 
           data-[selected=true]:bg-lightBeige
           [&:not(:disabled):hover:not([data-selected=true])]:bg-pastelBlue 
           `,t),ref:n,...l,children:a}),u=hf(typeof i=="string"?i:void 0,o)??i;return d.jsx(vf,{triggerContent:c,tooltipContent:u})},Kn="bg-white zx:bg-zxWhite py-0 gap-y-0 text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen [--leader-col-width:theme(width.3)] ",Xn="flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3",Jn="bg-lightGrey zx:bg-zxWhiteDimmed mobile:px-4",J=t=>t,nN=t=>{const e=t.length;if(e===1)return[t[0]];let r=0;for(let n=0;n<e-1;n++)r=Math.max(r,t[n].length+n);const s=t[e-1].length+(e-1);return r=Math.max(r,s),t.map((n,i)=>{if(i===e-1){const a=r-n.length;return" ".repeat(a)+n}else{const a=i,l=r-n.length-a;return" ".repeat(a)+n+" ".repeat(l)}})},Nq=({label:t})=>d.jsx(j,{className:"inline-block mr-1 text-lightGrey py-half",noSlitWords:!0,children:t}),Yr=({className:t,value:e,onChange:r,trueLabel:s="ON",falseLabel:n="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(s.length,n.length)+1,c=s.padStart(l," "),u=n.padEnd(l," ");_f(o,!1,()=>{r?.(!e,void 0)});const h=d.jsxs("span",{onClick:p=>r?.(!e,p),className:uf("inline-flex justify-between leading-none",t),children:[i&&d.jsx(Nq,{label:i}),d.jsx(j,{role:"switch",className:cf("inline-block w-min h-min py-half px-half sprites-uppercase",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),f=hf(typeof a=="string"?a:void 0,o)??a;return d.jsx(vf,{triggerContent:h,tooltipContent:f})},CA=J(["bg-redShadowHalfbrite text-highlightBeige zx:bg-zxBlack zx:text-zxGreen","bg-metallicBlueHalfbrite text-pastelBlue zx:bg-zxBlack zx:text-zxBlue","bg-pinkHalfbrite text-pink zx:bg-zxBlack zx:text-zxYellow","bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"]),Sf=({className:t,value:e,onChange:r,values:s,valueLabels:n=s.map(l=>`${l}`),label:i,shortcutKeys:o,tooltipContent:a})=>{const l=s.indexOf(e),c=s.length,u=v.useCallback(()=>{const A=(l+1)%c;r?.(s[A],void 0)},[r,l,s,c]);_f(o,!1,()=>{u()});const h=nN(n),f=c>4?l%4:l,p=d.jsxs("span",{onClick:u,className:uf("inline-flex justify-between leading-none",t),children:[i&&d.jsx(Nq,{label:i}),d.jsx(j,{role:"switch",className:cf("inline-block w-min h-min py-half px-half sprites-uppercase",CA[f]??CA[0]),noSlitWords:!0,children:h[l]})]}),m=hf(typeof a=="string"?a:void 0,o)??a;return d.jsx(vf,{triggerContent:p,tooltipContent:m})},ke=J("[&_.em]:text-moss zx:[&_.em]:text-zxCyan [&_h2]:text-midRed zx:[&_h2]:text-zxBlue text-lightGrey zx:text-zxBlack sprites-normal-height"),xe="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow sprites-normal-height",iN="**4-way**: True to the 1987 original - move in x directions only",oN="**8-way**: The original with *4-way* movement, plus *diagonals*",aN="**Analogue**: Move in *any* direction with analogue stick",lN=()=>{const t=EV();return d.jsx(L,{id:"analogueControl",label:"Directions",leader:d.jsx("span",{className:`${xe} texture-joystick_whole sprites-normal-height`}),valueElement:d.jsx(Sf,{className:"ml-auto",values:RV,valueLabels:["4-way","8-way","anlg"],value:t}),onSelect:z(PM),verticalAlignItemsCentre:!0,className:"sprites-double-height",hintInline:!0,hint:d.jsx(pe,{className:ke,markdown:t==="analogue"?aN:t==="8-way"?oN:iN})})},cN=()=>d.jsx(L,{className:"sprites-double-height",id:"onScreenControls",label:d.jsx(j,{className:`${ae} mobile:w-max`,children:"Touch controls"}),valueElement:d.jsx(Yr,{className:"ml-auto",value:fM()}),onSelect:z(Jt,{path:"onScreenControls"}),verticalAlignItemsCentre:!0,hintInline:!0,hint:d.jsx(pe,{className:ke,markdown:`Enables on-screen controls: for mobile, tablet, or any device with a touch-screen.

You can turn this off for phones paired with joypads/keyboards`})}),uN="This blockstack.ing remake comes with modern default mappings for keyboard and controller. You can also select presets matching the original game or different systems.",hN=({className:t})=>{const e=Y(rM);return d.jsx(j,{className:at("text-nowrap","ml-auto","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},dN=()=>d.jsx(L,{id:"preset",doubleHeight:!0,label:d.jsx(j,{className:`${ae}`,children:"Key/button preset"}),valueElement:d.jsx(hN,{}),onSelect:z(ot,"inputPreset"),opensSubMenu:!0,hint:d.jsx(pe,{className:ke,markdown:uN}),hintInline:!0}),fN={screen:`**Screen**: Control is relative to the *screen*.
More intuitive if you find directions confusing in isometric games, but means hitting diagonals a lot`,world:"**World**: Control is relative to directions in the *isometric world* - like the original",mixed:"**Mixed (default)**: *Analogue sticks* move relative to the *screen*, digital inputs like *keys* and *d-pad* move relative to the *world*"},pN={screen:J("texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections"),world:J("texture-heels_standing_right selectedMenuItem:texture-animated-heels_worldDirections sprites-normal-height"),mixed:J("texture-heels_standing_right selectedMenuItem:texture-animated-heels_mixedDirections sprites-normal-height")},mN=()=>{const t=ef();return d.jsx(Sf,{className:"ml-auto",values:Gb,value:t})},gN=()=>{const t=ef();return d.jsx(L,{id:"screenRelativeControl",label:"Input axes",leader:d.jsx("span",{className:`${xe} ${pN[t]}`}),valueElement:d.jsx(mN,{}),onSelect:z(CM),hintInline:!0,verticalAlignItemsCentre:!0,className:"sprites-double-height",hint:d.jsx(pe,{className:ke,markdown:fN[t]})})},bs="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",AN=t=>{const e=r=>r.startsWith("Arrow")?1:r.startsWith("Numpad")?2:0;return t.toSorted((r,s)=>{const n=e(r)-e(s);if(n!==0)return n;const i=r===" "?"Space":r,o=s===" "?"Space":s,a=i.length-o.length;return a!==0?a:i.localeCompare(o)})},yN=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:bs,children:e[1]}),e[2]]});switch(t){case" ":return"Space";case"ArrowDown":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:bs,children:"Cursor"}),""]});case"ArrowUp":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:bs,children:"Cursor"}),""]});case"ArrowLeft":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:bs,children:"Cursor"}),""]});case"ArrowRight":return d.jsxs(d.Fragment,{children:[d.jsx("span",{className:bs,children:"Cursor"}),""]});default:return t}},xN=["","","R","R"],bN=t=>xN[t]??`axis${t}`,VN=t=>{switch(tm[t]){case"dPadDown":return"D-pad";case"dPadUp":return"D-pad";case"dPadLeft":return"D-pad";case"dPadRight":return"D-pad";case"a":return d.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"A"});case"b":return d.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"B"});case"x":return d.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"X"});case"y":return d.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"Y"});case"start":return"Start";case"select":return"Select"}return tm[t]?.toUpperCase()??t},yl=({action:t,keyClassName:e,className:r,flashingCursor:s=!1,inline:n=!1})=>{const i=Y(c=>c.gameMenus.assigningInput?.action===t?c.gameMenus.assigningInput?.presses:ll(c).presses[t]),o=Y(c=>{const u=Oh(t);return u===void 0?mn:c.gameMenus.assigningInput?.action===t?c.gameMenus.assigningInput.axes:ll(c).axes[u.axis]}),a=d.jsxs(d.Fragment,{children:[AN(i.keys).map(c=>d.jsx("span",{className:at("text-nowrap h-[calc(10px*var(--scale))]",e),children:d.jsx(Je,{children:yN(c)})},`key:${c}`)),s&&d.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]}),l=d.jsxs(d.Fragment,{children:[o.map(c=>d.jsx("span",{className:at("text-nowrap h-[calc(10px*var(--scale))]",e),children:d.jsxs(Je,{children:[d.jsx("span",{className:bs,children:""}),bN(c)]})},`gamePadAxis:${c}`)),i.gamepadButtons.map(c=>d.jsx("span",{className:at("text-nowrap h-[calc(10px*var(--scale))]",e),children:d.jsxs(Je,{children:[d.jsx("span",{className:bs,children:""}),VN(c)]})},`gamePadButton:${c}`)),s&&d.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]});return d.jsxs("div",{className:at(r,n?"inline":"w-full"),children:[n?a:d.jsx("div",{className:"flex flex-col w-[50%] gap-y-oneScaledPix",children:a}),n?l:d.jsx("div",{className:"flex flex-col",children:l})]})},PA="text-pink zx:text-zxCyan",qN=()=>{const t=Y(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:d.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${ae} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[d.jsx(j,{children:"Press: "}),d.jsx(yl,{inline:!0,className:`${PA}`,action:"menu_openOrExit",keyClassName:"me-1"}),d.jsx(j,{children:"when done selecting keys for "}),d.jsx(j,{className:PA,children:t})]})},wN="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",Oe=({className:t,action:e})=>{const r=Y(s=>s.gameMenus.assigningInput?.action===e);return d.jsx(yl,{className:at("flex flex-wrap gap-y-oneScaledPix gap-x-1 ml-2",t),action:e,keyClassName:wN,flashingCursor:r})},vN=()=>{const t=ef()==="screen";return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"col-span-3",children:d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1  sprites-double-height`,children:"Movement"})}),d.jsx(L,{id:"left",label:`Left ${t?"":""}`,leader:d.jsx("span",{className:`${xe} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:d.jsx(Oe,{action:"left"}),onSelect:z(je,"left")}),d.jsx(L,{id:"right",label:`Right ${t?"":""}`,leader:d.jsx("span",{className:`${xe} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:d.jsx(Oe,{action:"right"}),onSelect:z(je,"right")}),d.jsx(L,{id:"up",label:`Up ${t?"":""}`,leader:d.jsx("span",{className:`${xe} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:d.jsx(Oe,{action:"away"}),onSelect:z(je,"away")}),d.jsx(L,{id:"down",label:`Down ${t?"":""}`,leader:d.jsx("span",{className:`${xe} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:d.jsx(Oe,{action:"towards"}),onSelect:z(je,"towards")}),d.jsx(L,{id:"jump",label:"Jump",leader:d.jsx("span",{className:`${xe} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:d.jsx(Oe,{action:"jump"}),onSelect:z(je,"jump")}),d.jsx("div",{className:"col-span-3",children:d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1  sprites-double-height`,children:"Character-specific Abilities"})}),d.jsx("div",{className:`${ae} col-span-3`,children:d.jsx(pe,{markdown:`**NOTE:** Some puzzles require Heels to jump and pick up/down simultaneously - assign a key to *both jump and carry*
          `,className:ke})}),d.jsx(L,{id:"carry",label:"Carry",leader:d.jsx("span",{className:`${xe} texture-bag`}),valueElement:d.jsx(Oe,{action:"carry"}),onSelect:z(je,"carry"),hint:d.jsx(pe,{className:ke,markdown:"Carrying is **Heels only** and requires the bag"}),hintInline:!0}),d.jsx(L,{id:"fire",label:d.jsx(j,{className:`inline-block w-6 ${ae}`,children:"Fire dough- nuts"}),leader:d.jsx("span",{className:`${xe} texture-doughnuts`}),hint:d.jsx(pe,{className:ke,markdown:"Firing doughnuts is **Head only** and requires the hooter"}),hintInline:!0,valueElement:d.jsx(Oe,{action:"fire"}),onSelect:z(je,"fire")}),d.jsx("div",{className:"col-span-3",children:d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1  sprites-double-height`,children:"Character Swopping"})}),d.jsx(L,{id:"swop",label:"Swop",valueElement:d.jsx(Oe,{action:"swop"}),onSelect:z(je,"swop"),hint:d.jsx(pe,{className:ke,markdown:"Works like the original game. *Cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:d.jsxs("span",{className:`${xe} texture-blank relative overflow-hidden`,children:[d.jsx("span",{className:`${xe} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),d.jsx("span",{className:`${xe} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),d.jsx(L,{id:"swopHead",label:d.jsx(j,{className:`inline-block w-6 ${ae}`,children:"Swop to head"}),valueElement:d.jsx(Oe,{action:"swop.head"}),onSelect:z(je,"swop.head"),hint:d.jsx(pe,{className:ke,markdown:"Go *directly* to *Head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${xe} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),d.jsx(L,{id:"swopHeels",label:d.jsxs("div",{className:`w-6 ${ae}`,children:[d.jsx(j,{className:"me-1",children:"Swop to"}),d.jsx(j,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:d.jsx(Oe,{action:"swop.heels"}),onSelect:z(je,"swop.heels"),hint:d.jsx(pe,{className:ke,markdown:"Go *directly* to *Heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:d.jsx("span",{className:`${xe} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),d.jsx("div",{className:"col-span-3",children:d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1  sprites-double-height`,children:"Stopping the Game"})}),d.jsx(L,{id:"map",label:"Map",valueElement:d.jsx(Oe,{action:"map"}),onSelect:z(je,"map"),leader:d.jsx("span",{className:`${xe} texture-scroll`})}),d.jsx(L,{id:"hold",label:"Pause",valueElement:d.jsx(Oe,{action:"hold"}),onSelect:z(je,"hold"),leader:d.jsx("span",{className:`${xe} texture-drum`})}),d.jsx(L,{id:"menu",label:"Menu",valueElement:d.jsx(Oe,{action:"menu_openOrExit"}),onSelect:z(je,"menu_openOrExit")}),d.jsxs("div",{className:"col-span-3",children:[d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1 sprites-double-height pb-1`,children:"Look controls"}),d.jsx(pe,{markdown:"Look controls are useful for seeing more of larger rooms that dont fit on the screen.",className:ke})]}),d.jsx(L,{id:"lookShift",label:"Look",valueElement:d.jsx(Oe,{action:"lookShift"}),onSelect:z(je,"lookShift"),hint:d.jsx(pe,{className:ke,markdown:"Hold the look key and press a direction to look around the room"}),hintInline:!0}),d.jsx(L,{id:"lookLeft",label:"Look ",valueElement:d.jsx(Oe,{action:"lookLeft"}),onSelect:z(je,"lookLeft")}),d.jsx(L,{id:"lookRight",label:"Look ",valueElement:d.jsx(Oe,{action:"lookRight"}),onSelect:z(je,"lookRight")}),d.jsx(L,{id:"lookUp",label:"Look ",valueElement:d.jsx(Oe,{action:"lookUp"}),onSelect:z(je,"lookUp")}),d.jsx(L,{id:"lookDown",label:"Look ",valueElement:d.jsx(Oe,{action:"lookDown"}),onSelect:z(je,"lookDown")}),d.jsx("div",{className:"col-span-3",children:d.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${ae} pt-1  sprites-double-height`,children:"Remake Option Toggles"})}),d.jsx(L,{id:"toggleColourisation",label:d.jsx(j,{className:`inline-block w-6 ${ae}`,children:"Toggle colour- isation"}),valueElement:d.jsx(Oe,{action:"toggleColourisation"}),onSelect:z(je,"toggleColourisation"),leader:d.jsx("span",{className:`${xe} texture-switch_left sprites-normal-height`})}),d.jsx(L,{id:"cycleRes",label:d.jsx(j,{className:`inline-block w-6 ${ae}`,children:"Cycle res- olution"}),valueElement:d.jsx(Oe,{action:"cycleResolution"}),onSelect:z(je,"cycleResolution"),leader:d.jsx("span",{className:`${xe} texture-switch_left sprites-normal-height`})}),d.jsx(L,{id:"toggleCrt",label:d.jsx(j,{className:`inline-block w-6 ${ae}`,children:"Toggle CRT effect"}),valueElement:d.jsx(Oe,{action:"toggleCrtFilter"}),onSelect:z(je,"toggleCrtFilter"),leader:d.jsx("span",{className:`${xe} texture-switch_left sprites-normal-height`})})]})},_N=()=>{const t=!kV();_e({action:"menu_openOrExit",handler:v.useCallback(()=>{le.dispatch(wM())},[]),disabled:t}),xI({handler:v.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&SV(le.getState())&&le.dispatch(vM(e))},[]),disabled:t})},SN=({showAll:t})=>d.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[d.jsx(j,{className:`block mb-1 ${ae}`,children:"Detected that you are on a phone or tablet"}),d.jsx(j,{className:`block mb-1 ${ae}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),d.jsx(sN,{className:`block w-full mb-2 text-white p-1 bg-midRed zx:text-zxRed ${ae}`,onClick:t,children:d.jsx(j,{children:"Tap here to show all settings"})})]}),EA=" !gap-y-1 ",kN=()=>{_N();const[t,e]=v.useState(!Na()),r=EV();return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:z(mt)}),d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"controlOptions",children:[d.jsx(mr,{path:["Options","Controls"],className:Jn}),d.jsxs("div",{className:Xn,children:[d.jsxs(Ee,{className:`${EA} w-full`,children:[d.jsx(lN,{}),r!=="4-way"&&t&&d.jsx(gN,{}),d.jsx(cN,{}),t&&d.jsxs(d.Fragment,{children:[d.jsx(dN,{}),d.jsx(j,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3 text-center sprites-uppercase",children:"Select the Keys"})]})]}),t?d.jsx(d.Fragment,{children:d.jsx(Ee,{className:`${EA} !sprites-normal-height`,children:d.jsx(vN,{})})}):d.jsx(d.Fragment,{children:d.jsx(SN,{showAll:()=>e(!0)})})]}),d.jsx(qN,{})]})]})},CN="/assets/rock-C4e7VvX5.mp3",Ro=({customLabel:t})=>d.jsx(L,{id:"back",label:t||"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:z(mt),toParentMenu:!0}),TA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},PN={egyptus:J("texture-crown_egyptus"),blacktooth:J("texture-crown_blacktooth"),bookworld:J("texture-crown_bookworld"),penitentiary:J("texture-crown_penitentiary"),safari:J("texture-crown_safari")},xi=({planet:t,className:e,label:r=t})=>{const s=Y(i=>i.gameMenus.gameInPlay.planetsLiberated[t]),n=Jd();return d.jsxs("div",{className:`flex flex-col ${e}`,children:[d.jsx("span",{className:`sprite block mx-auto
          ${n?"texture-crown_uncolourised sprite-tinted":PN[t]} 
          ${s?"zx:text-zxYellow":"colourised:brightness-halfBrite zx:text-zxMagentaDimmed"}
          `}),d.jsx("span",{className:`sprite block 
          ${n?"texture-ball_uncolourised":"texture-ball"} 
          zx:sprite-tinted mx-auto 
          ${s?"zx:text-zxWhite":"zx:text-zxYellowDimmed colourised:brightness-halfBrite"} 
          ${TA[t][0]}
          `}),d.jsx(j,{classnameCycle:n?void 0:TA[t],className:`block mx-auto ${s?"zx:text-zxMagenta":"zx:text-zxMagentaDimmed colourised:brightness-halfBrite"}`,children:r})]})},EN=()=>d.jsxs(d.Fragment,{children:[d.jsx(j,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The Blacktooth Empire"}),d.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[d.jsx(xi,{planet:"egyptus",label:"Egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(xi,{planet:"penitentiary",label:"Penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),d.jsx(xi,{planet:"safari",label:"Safari",className:"w-12 left-m10 top-14 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(xi,{planet:"bookworld",label:"Book World",className:"w-12 absolute left-10 top-14 resHandheld:left-7 resHandheld:top-8 translate-x-[-50%]"}),d.jsx(xi,{planet:"blacktooth",label:"Blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),TN=({playMusic:t=!1})=>{const e=eq(),r=z(mt);return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsxs(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,dialogId:"crowns",children:[t&&d.jsx("audio",{src:CN,autoPlay:!0,loop:!0}),d.jsx(EN,{}),d.jsx(Ee,{className:"hidden",children:!e&&d.jsx(Ro,{})})]})]})},Kl=t=>d.jsx("div",{className:`col-span-3 h-1 ${t}`}),MN=`![](texture-animated-head_walking_towards?float-right&mt-1)**Off**: Original *two-tone* spectrum graphics

**On**: *16-colour* palette with colourised sprites`,RN=`Here for the nostalgia?

Make your fancy new screen look like its 1987 again.`,IN=()=>d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"displayOptions",children:[d.jsx(mr,{path:["Options","Display"],className:Jn}),d.jsx("div",{className:Xn,children:d.jsxs(Ee,{children:[d.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"colourise",label:"Colourise",valueElement:d.jsx(Yr,{className:"ml-auto",value:!Jd()}),onSelect:z(Jt,{path:"displaySettings.uncolourised"}),hint:d.jsx(pe,{className:ke,markdown:MN}),verticalAlignItemsCentre:!0}),d.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"crtFilter",verticalAlignItemsCentre:!0,label:d.jsxs("span",{className:"align-top",children:[d.jsxs("span",{className:"bg-shadow zx:bg-pureBlack inline-block",children:[d.jsx(j,{className:"text-midRed zx:text-zxRed",children:"C"}),d.jsx(j,{className:"text-moss zx:text-zxGreen",children:"R"}),d.jsx(j,{className:"text-pastelBlue zx:text-zxBlue",children:"T"})]}),d.jsx(j,{children:" TV Effect"})]}),valueElement:d.jsx(Yr,{className:"ml-auto",value:Y(oM)}),onSelect:z(Jt,{path:"displaySettings.crtFilter"}),hint:d.jsx(pe,{className:ke,markdown:RN})}),d.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"emulatedResolution",label:"Emulated Resolution",onSelect:z(ot,"emulatedResolution"),opensSubMenu:!0,verticalAlignItemsCentre:!0,hint:d.jsx(pe,{className:ke,markdown:"See more of the room by choosing a higher resolution to emulate."})}),d.jsx(L,{hintInline:!0,className:"sprites-double-height",verticalAlignItemsCentre:!0,id:"showFps",label:"Show FPS",valueElement:d.jsx(Yr,{className:"ml-auto",value:Y(sM)}),onSelect:z(Jt,{path:"showFps"}),hint:d.jsx(pe,{className:ke,markdown:"Frames per second shown during gameplay."})}),d.jsx(Kl,{})]})})]}),jN=({resolutionName:t})=>{const e=Y(Dl),r=Gn[t];return d.jsx(L,{id:t,label:`${e===t?"* ":""}${r.name}`,doubleHeightWhenFocussed:!0,hintInline:!0,hint:d.jsxs(j,{className:ke,children:[r.size.x," x ",r.size.y]}),onSelect:z(of,t)},t)},ON=()=>d.jsx(ze,{children:d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"emulatedResolution",children:[d.jsx(mr,{path:["Options","Display","Res."],className:Jn}),d.jsx("div",{className:Xn,children:d.jsx(Ee,{children:Mx(Gn).map(t=>d.jsx(jN,{resolutionName:t},t))})})]})}),NN="/Users/jim/dev/hohjs",zN=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),s=[...t.matchAll(e)],n=[];return r.forEach((i,o)=>{n.push(i);const a=s[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){n.push(l);return}const u=`${NN}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),f=h?`:${h[1]}:${h[2]}`:"",p=`vscode://file${u}${f}`;n.push(d.jsx("a",{href:p,target:"_blank",children:c.pathname},o))}catch{n.push(a[0])}}),d.jsx(v.Fragment,{children:n})},BN=t=>{const{message:e,stack:r}=t;if(!r)return{message:e,sanitizedStack:""};const s=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,n=s.test(r);let i=r;n&&(i=i.replace(s,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},DN=`##The game crashed!
You could:

* Open an [issue on Github](https://github.com/jimhigson/head-over-heels-online/issues)
* Email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* Rant on the [Discord server](https://discord.gg/XmV9QNWY)
* Play [the MSX remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,FN=({errors:t})=>{const e=Y(o=>o.gameMenus.gameInPlay.reincarnationPoint!==void 0),[r,s]=v.useState(!1),n=z(nf),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=BN(o);return`
${a}

${l}
  `}).join(`
    

 ERROR        CAUGHT, WRAPPED, & RETHROWN 


`);return d.jsxs(ze,{children:[d.jsx(gt,{className:"loading-border"}),d.jsx(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,dialogId:"errorCaught",children:d.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[d.jsx(pe,{markdown:DN}),d.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),d.jsxs(Ee,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${ae}`,children:[d.jsx(L,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:z(Wg,"ignore")}),e&&d.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:n}),d.jsx(L,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, reboot game",onSelect:z(Wg,"clearAllData")}),r?d.jsx(j,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):d.jsx(L,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>s(!0))})]}),d.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),d.jsx(j,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite",children:"Error message for nerds:"}),d.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max min-w-full",children:d.jsx(zN,{children:i})})]})})]})},LN=()=>d.jsx(ze,{children:d.jsxs(Se,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:z(mt),dialogId:"hold",children:[d.jsx(j,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix sprites-uppercase",children:"PAUSED"}),d.jsx("span",{className:"zx",children:pt()==="desktop"?d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:`${ae} px-1 bg-zxBlack py-oneScaledPix`,children:[d.jsxs(Je,{children:["Press to ",d.jsx("span",{className:"text-zxWhite",children:"continue"}),":"]}),d.jsx("div",{className:"flex flex-row gap-1 mx-auto",children:d.jsx(yl,{className:"flex flex-row gap-1",keyClassName:"text-pink zx:text-zxRed",action:"hold"})})]}),d.jsxs("div",{className:`${ae} px-1 bg-zxBlack py-oneScaledPix`,children:[d.jsxs(Je,{children:["Press for ",d.jsx("span",{className:"text-zxWhite",children:"Map"}),":"]}),d.jsx("div",{className:"flex flex-row gap-1 mx-auto",children:d.jsx(yl,{className:"flex flex-row gap-1",keyClassName:"text-pink zx:text-zxRed",action:"map"})})]})]}):d.jsxs("div",{className:`${ae} px-1 bg-zxBlack py-oneScaledPix`,children:[d.jsx(j,{className:"me-1 text-pink zx:text-zxRed",children:"Tap screen"}),d.jsx(j,{children:"to continue"})]})})]})}),UN=({presetName:t})=>{const{description:e}=wn[t];return d.jsx(L,{hintInline:!0,id:t,label:t,doubleHeightWhenFocussed:!0,hint:e&&d.jsx(j,{className:ke,children:e}),onSelect:z(_M,t)},t)},$N=()=>d.jsx(ze,{children:d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"inputPreset",children:[d.jsx(mr,{path:["Options","Controls","Presets"],className:Jn}),d.jsx("div",{className:Xn,children:d.jsx(Ee,{children:Mx(wn).map(t=>d.jsx(UN,{presetName:t},t))})})]})}),HN="1.16.1",MA="https://github.com/jimhigson/head-over-heels-online/",GN=()=>d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex absolute top-oneScaledPix right-1 z-dialog",children:d.jsxs("a",{href:MA,className:"bitmap-text-link bg-transparent zx:bg-zxBlack",children:[d.jsx(j,{className:"text-highlightBeige zx:text-zxYellow",children:""}),d.jsxs("span",{className:"text-lightGrey zx:text-whiteHalfbrite",children:[d.jsx(j,{className:"resHandheld:hidden",children:" on"}),d.jsx(j,{children:BV}),d.jsx(j,{className:"resHandheld:hidden",children:"Github"})]})]})}),d.jsx("footer",{className:"flex absolute bottom-0 right-0 z-dialog","data-screenshot-mask":!0,children:d.jsx("a",{href:`${MA}releases`,target:"_blank",className:"bitmap-text-link bg-pastelBlueHalfbrite text-metallicBlueHalfbrite zx:bg-zxBlack",children:d.jsx(j,{children:`v${HN} `})})})]}),ur=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],WN=({className:t})=>d.jsxs("footer",{className:`flex justify-center gap-2 resHandheld:gap-1 leading-none ${t??""}`,children:[d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx(j,{className:"text-pastelBlue zx:text-zxBlack relative left-oneScaledPix",children:"1987 Original"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsxs("address",{className:"flex flex-col items-center relative bottom-oneScaledPix",children:[d.jsx(j,{className:"relative left-[calc(6.5px*var(--scale))]",classnameCycle:ur,children:"Jon"}),d.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ur,children:"Ritman"})]}),d.jsxs("address",{className:"flex flex-col items-center relative bottom-oneScaledPix",children:[d.jsx(j,{classnameCycle:ur,children:"Bernie"}),d.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ur,children:"Drummand"})]})]})]}),d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx(j,{className:"text-pink zx:text-zxBlack",children:"2025 Remake"}),d.jsx("address",{className:"flex relative left-[calc(0.5px*var(--scale))] bottom-oneScaledPix",children:d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx(j,{className:"relative left-[calc(1.5px*var(--scale))]",classnameCycle:ur,children:"Jim"}),d.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ur,children:"Higson"})]})})]})]}),Tn=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return J("texture-animated-head_walking_away");case"towards":return J("texture-animated-head_walking_towards");case"left":return J("texture-animated-head_walking_left");case"right":return J("texture-animated-head_walking_right");case"awayRight":return J("texture-animated-head_walking_awayRight");case"towardsRight":return J("texture-animated-head_walking_towardsRight");case"towardsLeft":return J("texture-animated-head_walking_towardsLeft");case"awayLeft":return J("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return J("texture-animated-head_idle_towards");case"right":return J("texture-animated-head_idle_right");case"awayRight":return J("texture-animated-head_idle_awayRight");case"towardsRight":return J("texture-animated-head_idle_towardsRight");case"towardsLeft":return J("texture-animated-head_idle_towardsLeft");case"away":return J("texture-head_walking_away_2");case"left":return J("texture-head_walking_left_2");case"awayLeft":return J("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return J("texture-animated-heels_walking_away");case"towards":return J("texture-animated-heels_walking_towards");case"left":return J("texture-animated-heels_walking_left");case"right":return J("texture-animated-heels_walking_right");case"awayRight":return J("texture-animated-heels_walking_awayRight");case"towardsRight":return J("texture-animated-heels_walking_towardsRight");case"towardsLeft":return J("texture-animated-heels_walking_towardsLeft");case"awayLeft":return J("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return J("texture-animated-heels_idle_towards");case"right":return J("texture-animated-heels_idle_right");case"awayRight":return J("texture-heels_walking_awayRight_2");case"towardsRight":return J("texture-animated-heels_idle_towardsRight");case"towardsLeft":return J("texture-heels_walking_towardsLeft_2");case"away":return J("texture-heels_walking_away_2");case"left":return J("texture-heels_walking_left_2");case"awayLeft":return J("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},YN=(t,e,r)=>{const s=t.getBoundingClientRect(),n=s.left+s.width/2,i=s.top+s.height/2,o=n-e,a=i-r,c=XR({x:o,y:a});return _d(c)},RA=({character:t,defaultFacing:e,className:r=""})=>{const[s,n]=v.useState(e),[i,o]=v.useState(!1),a=v.useRef(null);v.useEffect(()=>{const f=m=>{a.current&&n(YN(a.current,m.clientX,m.clientY)||"right")},p=()=>{n(e),o(!1)};return window.addEventListener("mousemove",f),document.addEventListener("mouseleave",p),()=>{window.removeEventListener("mousemove",f),document.removeEventListener("mouseleave",p)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=Tn({character:t,facingXy8:s,action:i?"walking":"idle"});return d.jsxs("div",{ref:a,className:`relative ${r}`,onMouseEnter:l,onMouseLeave:c,children:[d.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),d.jsx("span",{className:"sprite zx:hidden texture-shadow_playable sprite-shadow absolute left-0 opacity-halfBrite"})]})},zq=({noSubtitle:t,className:e})=>d.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[d.jsxs("h1",{className:"flex",children:[d.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1 sprites-uppercase",children:[d.jsx(j,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),d.jsx(RA,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),d.jsx(j,{classnameCycle:ur,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),d.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center sprites-uppercase",children:[d.jsx(j,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),d.jsx(RA,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||d.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[d.jsx(j,{className:"text-midRed zx:text-zxCyan",children:"block"}),d.jsx(j,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),d.jsx(j,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),d.jsx(j,{className:"text-moss zx:text-zxWhite",children:"ing"}),d.jsx(j,{classnameCycle:ur,children:" remake"})]})]}),QN=()=>{const t=kn(),e=z(bM),r=z(ot,"whichGame");return t?d.jsx(L,{id:"playGame",label:d.jsx(j,{children:"Resume the game"}),doubleHeightWhenFocussed:!0,onSelect:e}):d.jsx(L,{id:"playGame",label:d.jsx(j,{children:"Play the game"}),doubleHeightWhenFocussed:!0,onSelect:r,opensSubMenu:!0})},KN=()=>d.jsx(L,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:z(ot,"markdown/installGuide"),opensSubMenu:!0}),XN=()=>d.jsx(L,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:z(ot,"sureWantEditor"),opensSubMenu:!0}),JN=()=>{const t=kn(),e=Y(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0);return d.jsx(L,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:z(ot,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t,opensSubMenu:!0})},IA="https://discord.gg/Se5Jznc2jm",ZN=t=>{const e=kn(),r=z(ot,"crowns"),s=z(ot,"score"),n=v.useCallback(()=>{r(),s()},[r,s]),i=KC();return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),d.jsxs(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",dialogId:"mainMenu",children:[d.jsx(zq,{noSubtitle:e,className:e?"resHandheld:hidden":""}),d.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1 sprites-uppercase",children:[d.jsxs(Ee,{className:"w-24 mx-auto",children:[d.jsx(QN,{}),!e&&pt()==="desktop"&&d.jsx(XN,{}),d.jsx(L,{id:"map",label:"use the Map",onSelect:z(ot,"map"),doubleHeightWhenFocussed:!0,hidden:!e,opensSubMenu:!0}),d.jsx(L,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e,opensSubMenu:!0})]}),d.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[d.jsxs(Ee,{children:[d.jsx(L,{id:"options",label:"Options",doubleHeightWhenFocussed:!0,onSelect:z(ot,"modernisationOptions"),opensSubMenu:!0}),d.jsx(L,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:z(ot,"readTheManual"),opensSubMenu:!0})]}),d.jsxs(Ee,{children:[i?null:d.jsx(KN,{}),d.jsx(L,{id:"discord",leader:d.jsx(j,{children:zV}),label:d.jsx("a",{href:IA,target:"_blank",children:d.jsx(j,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:v.useCallback(()=>{window.open(IA,"_blank")},[])}),i?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"h-1"}),d.jsx("div",{className:"h-1"}),d.jsx("div",{className:"h-1"})]}):null]})]}),e&&d.jsx(Ee,{className:"w-24 mx-auto",children:d.jsx(JN,{})})]}),!e&&d.jsx(WN,{className:"resHandheld:mt-1"})]}),d.jsx(GN,{})]})};var Au,jA;function kf(){if(jA)return Au;jA=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Au=t,Au}var yu,OA;function ez(){if(OA)return yu;OA=1;var t=typeof Io=="object"&&Io&&Io.Object===Object&&Io;return yu=t,yu}var xu,NA;function Bq(){if(NA)return xu;NA=1;var t=ez(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return xu=r,xu}var bu,zA;function tz(){if(zA)return bu;zA=1;var t=Bq(),e=function(){return t.Date.now()};return bu=e,bu}var Vu,BA;function rz(){if(BA)return Vu;BA=1;var t=/\s/;function e(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return Vu=e,Vu}var qu,DA;function sz(){if(DA)return qu;DA=1;var t=rz(),e=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(e,"")}return qu=r,qu}var wu,FA;function Dq(){if(FA)return wu;FA=1;var t=Bq(),e=t.Symbol;return wu=e,wu}var vu,LA;function nz(){if(LA)return vu;LA=1;var t=Dq(),e=Object.prototype,r=e.hasOwnProperty,s=e.toString,n=t?t.toStringTag:void 0;function i(o){var a=r.call(o,n),l=o[n];try{o[n]=void 0;var c=!0}catch{}var u=s.call(o);return c&&(a?o[n]=l:delete o[n]),u}return vu=i,vu}var _u,UA;function iz(){if(UA)return _u;UA=1;var t=Object.prototype,e=t.toString;function r(s){return e.call(s)}return _u=r,_u}var Su,$A;function oz(){if($A)return Su;$A=1;var t=Dq(),e=nz(),r=iz(),s="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?n:s:i&&i in Object(a)?e(a):r(a)}return Su=o,Su}var ku,HA;function az(){if(HA)return ku;HA=1;function t(e){return e!=null&&typeof e=="object"}return ku=t,ku}var Cu,GA;function lz(){if(GA)return Cu;GA=1;var t=oz(),e=az(),r="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&t(n)==r}return Cu=s,Cu}var Pu,WA;function cz(){if(WA)return Pu;WA=1;var t=sz(),e=kf(),r=lz(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return s;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):n.test(c)?s:+c}return Pu=l,Pu}var Eu,YA;function Fq(){if(YA)return Eu;YA=1;var t=kf(),e=tz(),r=cz(),s="Expected a function",n=Math.max,i=Math.min;function o(a,l,c){var u,h,f,p,m,A,g=0,y=!1,V=!1,x=!0;if(typeof a!="function")throw new TypeError(s);l=r(l)||0,t(c)&&(y=!!c.leading,V="maxWait"in c,f=V?n(r(c.maxWait)||0,l):f,x="trailing"in c?!!c.trailing:x);function b(M){var I=u,B=h;return u=h=void 0,g=M,p=a.apply(B,I),p}function w(M){return g=M,m=setTimeout(S,l),y?b(M):p}function _(M){var I=M-A,B=M-g,E=l-I;return V?i(E,f-B):E}function q(M){var I=M-A,B=M-g;return A===void 0||I>=l||I<0||V&&B>=f}function S(){var M=e();if(q(M))return k(M);m=setTimeout(S,_(M))}function k(M){return m=void 0,x&&u?b(M):(u=h=void 0,p)}function C(){m!==void 0&&clearTimeout(m),g=0,u=A=h=m=void 0}function P(){return m===void 0?p:k(e())}function T(){var M=e(),I=q(M);if(u=arguments,h=this,A=M,I){if(m===void 0)return w(A);if(V)return clearTimeout(m),m=setTimeout(S,l),b(A)}return m===void 0&&(m=setTimeout(S,l)),p}return T.cancel=C,T.flush=P,T}return Eu=o,Eu}var uz=Fq();const hz=Qe(uz);var Tu,QA;function dz(){if(QA)return Tu;QA=1;var t=Fq(),e=kf(),r="Expected a function";function s(n,i,o){var a=!0,l=!0;if(typeof n!="function")throw new TypeError(r);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(n,i,{leading:a,maxWait:i,trailing:l})}return Tu=s,Tu}var fz=dz();const pz=Qe(fz),mz=(t,e,r,s)=>{switch(e){case"debounce":return hz(t,r,s);case"throttle":return pz(t,r,s);default:return t}},gz=t=>{const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>((...r)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...r)}),[])},Az=t=>{const[e,r]=v.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:v.useMemo(()=>new Proxy(n=>{n!==e&&r(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,o){return i==="current"?r(o):n[i]=o,!0}}),[e]),refElement:e,setRefElement:r}},yz=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function xz({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:s,handleWidth:n=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=v.useRef(t),u=gz(l),[h,f]=v.useState({width:void 0,height:void 0}),{refProxy:p,refElement:m}=Az(o),{box:A}=a||{},g=v.useCallback(V=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const x=(b,w)=>n&&b.width!==w.width||i&&b.height!==w.height;V.forEach(b=>{const w=yz(b,A);f(_=>x(_,w)?(u?.({width:w.width,height:w.height,entry:b}),w):_)})},[n,i,c,A]),y=v.useCallback(mz(g,e,r,s),[g,e,r,s]);return v.useEffect(()=>{let V;return m?(V=new window.ResizeObserver(y),V.observe(m,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),f({width:void 0,height:void 0})),()=>{var x,b,w;(x=V?.disconnect)===null||x===void 0||x.call(V),(w=(b=y).cancel)===null||w===void 0||w.call(b)}},[y,m]),Object.assign({ref:p},h)}const G={x:16,y:16,z:12},Lq=ko/1e3,VU={head:15e-5,heels:15e-5},qU=1e3/110,wU=330,bz=2e-4,Vz={head:G.z*2/1e3,others:G.z*6/1e3},vU=bz*.13,_U=Vz.others*.85,SU=.8,kU=.001,Uq={head:1,heels:2,charles:1,dalek:Math.SQRT2,bubbleRobot:(Math.SQRT2+1)/2,cyberman:1,skiHead:1,helicopterBug:1,homingBot:2,monkey:1,elephant:1,elephantHead:0,emperor:1,emperorsGuardian:Math.SQRT2,computerBot:1,turtle:1,ball:2.625,firedDoughnut:2,movingPlatform:1,floatingText:1},CU=kd(Uq,([t,e])=>[t,e*Lq]),qz=kd(Uq,([t,e])=>[t,(e*.8+.4)*Lq]),PU=1.5,wz=(t=1)=>t*ko/1e3,EU=wz(),TU=2,KA=1.1,MU={head:G.z*2.6+KA,heels:G.z+1+KA},vz=10,RU=6e4,_z=8,IU=750,jU=1500,OU=200,NU=.25,zU=150,Sz=8,kz=Et.h-Et.w/2,$q=kz+2,Cf=9999,BU=1e3/12,Cz=1e3/12,DU=100,FU=150,Pz=["head","heels"],Ez=[...Pz,"headOverHeels"],xn=t=>t==="head"?"heels":"head";G.z;G.x/2;const Hq="@@original",Tz="original",Mz={userId:Hq,campaignName:Tz,version:-1},Te=(...t)=>{if(t.length===1){const[e]=t;return r=>r.type===e}return e=>t.includes(e.type)},Rz=Te("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),Iz=(t,e)=>Rz(t)||Vs(t)&&(e!==void 0&&xl(e)||t.config.direction.z!==0)||Xq(t)&&t.config.floorType==="none",Qr=(t,e)=>!Iz(t,e),jz=t=>t.type==="movingPlatform"||t.type==="pushableBlock",Pf=(t,e,r=!1)=>Cs(e)&&!(!r&&xl(e)&&e.state.autoWalk)&&!(Kq(t)&&jz(e))&&!(Ef(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),Gq=["ball","slidingBlock","slidingDeadly"],Oz=Te(...Gq),Nz=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],zz=["dalek","turtle","elephantHead","homingBot","helicopterBug"],LU=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?zz.includes(t.config.which):Nz.includes(t.type),xl=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function Cs(t){return Wq.includes(t.type)}const Wq=[...Ez,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],Bz=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],Dz=Te(...Bz),XA=t=>Ef(t)&&!t.state.activated?!1:Dz(t)||t.type==="floor"&&t.config.floorType==="deadly",Fz=t=>t.config.times!==void 0,Vs=Te("portal"),UU=Te("teleporter"),Yq=Te("heels"),Qq=Te("head"),bl=Te("headOverHeels"),$U=Te("heels","headOverHeels"),HU=Te("head","headOverHeels"),Kq=Te("lift"),GU=Te("button"),WU=Te("emitter"),Ef=Te("monster"),Xq=Te("floor"),Lz=Te("pickup"),YU=t=>t.type==="button"||t.type==="switch"&&t.config.type==="in-room",QU=t=>Lz(t)&&t.config.gives==="crown",KU=Te("spring"),Uz=Te("joystick"),XU=Te("conveyor"),$z=Te("hushPuppy"),JU=Te("firedDoughnut"),ZU=Te("wall","doorFrame"),e$=Te("monster","movingPlatform"),t$=t=>Ef(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,Ir=(t,e)=>t.characterRooms[e]?.items[e],r$=t=>Ir(t,t.currentCharacterName),s$=t=>{if(Qq(t))return t.state;if(bl(t))return t.state.head},Hz=t=>{if(Yq(t))return t.state;if(bl(t))return t.state.heels},Gz=(t,e)=>{const r=Ir(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&Qq(r)||e==="heels"&&Yq(r))return r.state;if(e==="head"&&bl(r))return r.state.head;if(e==="heels"&&bl(r))return r.state.heels}},n$=Gz,Wz=t=>{const e=Ir(t,"head"),r=Ir(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},$h=(t,e)=>e?.[t],Yz=t=>jr(t),Mt=t=>Fe(Yz(t)),i$=t=>Fe(Sd(t)),o$=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),Ft=Symbol("roomSpatialIndexKey"),ct={x:12,y:12,z:G.z},Qz={x:14,y:14,z:G.z},qs={x:16,y:16,z:G.z},Ua={...ct,z:G.z*2},Tf=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:ct};case"slidingBlock":return t.config.style==="book"?{aabb:qs}:{aabb:ct};case"lift":return{aabb:{...ct,z:ct.z}};case"switch":return{aabb:{...ct,z:ct.z}};case"button":return{aabb:{x:15,y:15,z:2}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:ct};case"charles":return{aabb:Ua};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:qs};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:qs};case"tower":return{aabb:{x:11,y:11,z:G.z}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...ct,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:Ua};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:ct};case"turtle":return{aabb:ct};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:qs};case"bubbles":return{aabb:ct};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:qs};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:G.z}:{x:15,y:3,z:G.z}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:Ua}:{aabb:ct};case"emitter":return{aabb:X};default:return{aabb:Qz}}},it={aabb:ct,castsShadowWhileStoodOn:!1},Mn=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x??1:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y??1:1}),a$=t=>t.type==="wall"?Mn(t.config):Fz(t)?t.config.times:void 0,ho=(t=qo)=>({x:t.x??1,y:t.y??1,z:t.z??1}),l$=t=>({x:t.x??1,y:t.y??1}),JA=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?ho(Mn(t.config)):e(t)?ho(t.config.times):qo},Kz=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?ho(Mn(t.config)):e(t)?ho(t.config.times):qo},c$=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},fo=(t,e={})=>{const r=ho(e),s=Tr(G,t);return s_(J0(r,G),s)},u$=1e3,Kr=-2,Ne=Number.MIN_SAFE_INTEGER,h$=({x:t=0,y:e=0})=>e-t,Ie=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),Re=({x:t=0,y:e=0,z:r=0})=>({x:t*G.x,y:e*G.y,z:r*G.z}),d$=t=>Ie(Re(t)),Hh=t=>{const e=Re(t.position),{aabb:r}=Tf(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:U(e,{x:G.x-r.x>>1,y:G.y-r.y>>1})},Ge=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Ne,stoodOnUntilRoomTime:Ne,actedOnAt:{roomTime:Ne,by:fe}}),Jq=()=>({gravity:X,movingFloor:X}),Rn=()=>({vels:Jq(),latentMovement:[],collidedWith:{roomTime:Ne,by:fe},controlledWithJoystickAtRoomTime:Ne,standingOnItemId:null,standingOnUntilRoomTime:Ne,previousStandingOnItemId:null}),Xz=t=>{const e=Wq.includes(t.type);return{...Ge(),position:Hh(t),...e?{...Rn(),vels:{...Jq(),...Gq.includes(t.type)?{sliding:X}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:X}:{}}}:{},...t.type==="joystick"||t.type==="emitter"||t.type==="lift"||t.type==="conveyor"||t.type==="teleporter"?{...structuredClone(t.config)}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:he[t.config.startDirection]}:{facing:he.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:he[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,lastToggledAtRoomTime:Ne}:{},...t.type==="button"?{pressed:!1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:X}}:{},...t.type==="charles"?{facing:he.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Ne,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?Ut(he[t.config.direction],qz.firedDoughnut):X}}:{}}},Jz=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,Zz=Object.freeze({textureId:"shadow.door.floatingThreshold.double.y",spritesheetVariant:"original"}),eB=Object.freeze({textureId:"shadow.doorFrame.top.y",spritesheetVariant:"original"}),tB=Object.freeze({textureId:"shadow.doorFrame.top.y",flipX:!0,spritesheetVariant:"original"}),rB=["doorLegs"],sB=Object.freeze({textureId:"shadow.door.floatingThreshold.double.y",flipX:!0,spritesheetVariant:"original"}),Mu=G.z*2,nB=4,_a=G.z*nB,iB=2;2*G.x;const oB=.5,ZA=2;function*aB(t,e){const{config:{direction:r},position:s}=t,n=gx(r),i=Tl(n),o=Jz(t),a={...X,[i]:o?-.5:0},l=1,c={[i]:o?-l:0},u=l*G.x,h={...X,[i]:u},f=9,p=8,m=8;{const A={[n]:p,[i]:m,z:_a};yield{...t,...it,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...Ge(),position:Re(U(s,{[n]:1.5},a,c)),stoodOnBy:fe},aabb:U(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:f,[i]:m,z:_a};yield{...t,...it,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...Ge(),position:Re(U(s,a,c)),stoodOnBy:fe},aabb:U(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:2*G.x-f-p,[i]:m,z:_a-Mu};yield{...t,...it,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...Ge(),position:U(Re(U(s,a,c)),{[n]:f,z:Mu}),stoodOnBy:fe},aabb:U(A,h),renderAabb:A,renderAabbOffset:o?h:void 0,shadowCastTexture:o?void 0:n==="x"?tB:eB,castsShadowWhileStoodOn:!0,noShadowCastOn:o?void 0:rB}}yield{...t,...it,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...Ge(),position:U(Re(U(s,a,c)),{z:_a}),stoodOnBy:fe},aabb:U(Re({[n]:2,[i]:l}),{[i]:m,z:Cf}),renderAabb:X,fixedZIndex:Kr},yield{...t,...it,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...to(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:Re({...X,[i]:o?l+.25:-.25}),direction:he[r]},fixedZIndex:Kr,state:{...Ge(),position:U(Re(U(s,{[i]:o?-.5-l:.5})),{[n]:f}),stoodOnBy:fe},aabb:{[n]:iB*G.x-f-p,[i]:u,z:Mu}},s.z!==0&&(yield{...t,...it,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:s.z},renders:!0,shadowCastTexture:o?n==="x"?sB:Zz:void 0,castsShadowWhileStoodOn:o,state:{...Ge(),position:{...Re(U(s,a,c)),z:0}},aabb:U(Re({[n]:2,[i]:.5,z:s.z}),h),renderAabb:o?U(Re({[n]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?U({[n]:0,[i]:0,z:(s.z-.5)*G.z},{[i]:h[i]}):void 0,shadowOffset:{z:s.z*G.z,[i]:o?h[i]:void 0}}),yield{...it,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:Re({[n]:2,[i]:ZA,z:2}),config:{},fixedZIndex:Kr,state:{...Ge(),position:Re(Tr(s,Ut(he[r],oB),o?X:{[i]:ZA})),stoodOnBy:fe}}}const ey=3,ty=10,ry=.52,Sa=.5,lB=Object.freeze({textureId:"shadow.fullBlock",spritesheetVariant:"original"}),cB=(t,e,r)=>{const{config:{times:s},position:n}=e,i=U(n,{z:-ey}),o={...s,z:ey};let a=i,l=o;const c=Fe(jr(r.items)).filter(f=>f.type==="door");if(n.z===0){const f={};for(const p of c){const{position:m,config:{direction:A}}=p;switch(A){case"towards":!f.towards&&m.y===i.y&&m.x>=i.x&&m.x<=i.x+s.x-2&&(l=U(l,{y:Sa}),a=U(a,{y:-Sa}),f.towards=!0);break;case"away":!f.away&&m.y===i.y+s.y&&m.x>=i.x&&m.x<=i.x+s.x-2&&(l=U(l,{y:ry}),f.away=!0);break;case"right":!f.right&&m.x===i.x&&m.y>=i.y&&m.y<=i.y+s.y-2&&(l=U(l,{x:Sa}),a=U(a,{x:-Sa}),f.right=!0);break;case"left":!f.left&&m.x===i.x+s.x&&m.y>=i.y&&m.y<=i.y+s.y-2&&(l=U(l,{x:ry}),f.left=!0);break}}}const u=Re(a),h=fo(qs,l);return{...it,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:fo(qs,o),position:Re(i)}},aabb:h,renderAabb:{...h,z:ty},renderAabbOffset:{...X,z:h.z-ty},shadowCastTexture:lB,state:{...Ge(),position:u}}},uB=Object.freeze({animationId:"shadow.lift",spritesheetVariant:"original"}),sy=Object.freeze({textureId:"shadow.smallBlock",spritesheetVariant:"original"}),sn=Object.freeze({textureId:"shadow.smallRound",spritesheetVariant:"original"}),ka=Object.freeze({textureId:"shadow.fullBlock",spritesheetVariant:"original"}),hB=Object.freeze({textureId:"shadow.fullBlock",flipX:!0,spritesheetVariant:"original"}),dB=Object.freeze({textureId:"shadow.barrier.y",spritesheetVariant:"original"}),fB=Object.freeze({textureId:"shadow.barrier.y",flipX:!0,spritesheetVariant:"original"}),pB=Object.freeze({textureId:"shadow.scroll",spritesheetVariant:"original"}),mB=t=>{switch(t.type){case"lift":return uB;case"switch":return sy;case"conveyor":return mx(t.config.direction)==="x"?hB:ka;case"barrier":return t.config.axis==="x"?fB:dB;case"spring":case"firedDoughnut":case"slidingDeadly":return sn;case"block":return t.config.style==="tower"?sn:ka;case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return ka;case"portableBlock":return t.config.style==="drum"?sn:sy;case"pickup":return t.config.gives==="scroll"?pB:sn;case"ball":case"charles":case"monster":return sn;case"slidingBlock":return t.config.style==="book"?ka:sn}},gB=Object.freeze({textureId:"shadow.playable",spritesheetVariant:"original"}),Vl={config:fe,shadowCastTexture:gB,castsShadowWhileStoodOn:!0,aabb:ct},po=()=>{const t=CV(le.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:he.towards,visualFacingVector:he.towards,walkStartFacing:he.towards,walkDistance:0,vels:{walking:X,gravity:X,movingFloor:X},switchedToAt:Ne,lastDiedAt:Ne,gameTime:0,jumpStartTime:Ne,lives:t?"infinite":_z,jumpStartZ:0}},AB=(t,e)=>{const r=PV(le.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...it,...Vl,state:{...Ge(),...Rn(),...po(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Ne,shieldCollectedAt:Ne,doughnuts:r?"infinite":0,position:Hh(t),stoodOnUntilRoomTime:Ne}}:{id:e,jsonItemId:e,type:"heels",...it,...Vl,state:{...Ge(),...Rn(),...po(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Ne,position:Hh(t),stoodOnUntilRoomTime:Ne}}},yB=t=>t==="towards"||t==="right",xB=Object.freeze({textureId:"shadow.wall.y",spritesheetVariant:"original"}),bB=Object.freeze({textureId:"shadow.wall.y",flipX:!0,spritesheetVariant:"original"}),Mf=1,VB={x:G.x,y:G.y*Mf,z:Cf},qB={x:G.x,y:0,z:$q},wB={x:G.x*Mf,y:G.y,z:Cf},vB={x:0,y:G.y,z:$q},_B=(t,e)=>{const{config:{direction:r},position:s}=e,n=Mn(e.config),i=gx(r),o=Tl(i),a=yB(r),l={...X,[o]:a?-Mf:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:fo(i==="y"?wB:VB,n),renderAabb:a?X:fo(i==="y"?vB:qB,n),fixedZIndex:a?Kr:void 0,state:{...Ge(),position:Re(U(s,l)),stoodOnBy:fe},shadowCastTexture:i!=="y"?bB:xB,castsShadowWhileStoodOn:a}};function*Rf(t,e,r,s=fe,n={},i=""){if(!s[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&n[e.config.page]))switch(!0){case e.type==="door":return yield*aB(e,t);case e.type==="player":{yield AB(e,t);return}case e.type==="wall":{yield _B(t,e);return}case e.type==="floor":{yield cB(t,e,r);return}case(e.type==="block"&&e.config.disappearing!==void 0&&Fn(JA(e))>=2):{const o=JA(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=Bn(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=qo});yield*Rf(t,u,r,s,n,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!le.getState().gameMenus.gameInPlay.planetsLiberated[e.config.planet]):return;default:{const o=Tf(e),a=e.config.times!==void 0?{aabb:fo(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=Xz(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...it,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Kr:void 0,shadowCastTexture:mB(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="cyberman"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const SB=({gameState:t,room:e,itemType:r,config:s,position:n,additionalIdPart:i})=>{const o={type:r,config:s,position:X},a=`${r}/${i}`,l=Cx(Rf(a,o,e.roomJson,t.pickupsCollected[e.id]??fe));if(l===void 0)throw console.error("failed to generate any items for json",a,o),new Error("failed to generate any items");return In({room:e,item:l,atPosition:n}),l},In=({room:t,item:e,atPosition:r})=>(t.items[e.id]=e,r!==void 0&&(e.state.position=r),t[Ft].addItem(e),e),kB=(t,e)=>Fe(Rx(t)).map(r=>{const s=e.items[r];if(s===void 0)throw new Error(`item ${r} in stoodOnBy is not in the room`);return s});function Zq(t,e){return t===null?null:e.items[t]}const f$=(t,{standingOnItemId:e,standingOnUntilRoomTime:r,previousStandingOnItemId:s,jumped:n})=>e!==null?e:!n&&r+Cz>t.roomTime&&t.items[s]?s:null,Gh=(t,e)=>{if(t.state.standingOnItemId!==null){const r=Zq(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.previousStandingOnItemId=t.state.standingOnItemId,t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime,t.state.standingOnUntilRoomTime=e.roomTime}},jn=({room:t,item:e})=>{const r=ew({room:t,item:e});t[Ft].removeItem(r)},ew=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;Cs(r)&&Gh(r,t);for(const s of kB(r.state.stoodOnBy,t))Gh(s,t);return typeof e=="string"?delete t.items[e]:delete t.items[r.id],r},If=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.previousStandingOnItemId=t.state.standingOnItemId,t.state.standingOnItemId=e.id,r[t.id]=!0},CB=t=>{const e={id:"head",type:"head",...it,...Vl,state:{...Ge(),...Rn(),...po(),...t.state.head,facing:t.state.facing,visualFacingVector:t.state.visualFacingVector,position:U(t.state.position,{z:G.z}),switchedToAt:Ne,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...it,...Vl,state:{...Ge(),...Rn(),...po(),...t.state.heels,facing:t.state.facing,visualFacingVector:t.state.visualFacingVector,position:U(t.state.position),switchedToAt:Ne,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},PB=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...it,shadowCastTexture:e.shadowCastTexture,castsShadowWhileStoodOn:e.castsShadowWhileStoodOn,config:fe,aabb:Ua,state:{...Ge(),...Rn(),...po(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,visualFacingVector:e.state.visualFacingVector,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...to(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ne},heels:{...to(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ne}}}),EB=t=>{const e=t.characterRooms.head,r=Ir(t,"head"),s=Ir(t,"heels"),n=PB({head:r,heels:s});jn({room:e,item:"head"}),jn({room:e,item:"heels"}),In({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},TB=(t,e)=>{const r=t.characterRooms.headOverHeels,s=Ir(t,"headOverHeels"),n=e??xn(t.previousPlayable),{head:i,heels:o}=CB(s);jn({room:r,item:"headOverHeels"}),In({room:r,item:i}),In({room:r,item:o}),If({above:i,below:o}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},MB=t=>{const e=Ir(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},$a=(t,e)=>{Wz(t)&&(!e||e===t.currentCharacterName)?EB(t):t.currentCharacterName==="headOverHeels"?TB(t,e):(!e||e!==t.currentCharacterName)&&Ir(t,xn(t.currentCharacterName))!==void 0&&(t.currentCharacterName=xn(t.currentCharacterName)),MB(t)},Ru=4,Iu=Pi.h,tw=()=>{const t=Eo(),e=v.useRef(null),r=v.useCallback((s,n="lines")=>{if(e.current===null)return;const{scrollTop:i,scrollLeft:o}=e.current,a=he[s],l=n==="all"?a.y<0?9999:0:n==="lines"?i+t*Ru*-a.y*Iu:i+-a.y*(e.current?.getBoundingClientRect().height-t*Iu*Ru),c=o+t*Ru*a.x*Iu;e.current.scrollTo({left:c,top:l,behavior:"smooth"})},[t]);return _e({handler:v.useCallback(()=>{r("towards")},[r]),action:"towards"}),_e({handler:v.useCallback(()=>{r("away")},[r]),action:"away"}),_e({handler:v.useCallback(()=>{r("towards","pages")},[r]),action:"pageDown"}),_e({handler:v.useCallback(()=>{r("away","pages")},[r]),action:"pageUp"}),_e({handler:v.useCallback(()=>{r("towards","all")},[r]),action:"end"}),_e({handler:v.useCallback(()=>{r("away","all")},[r]),action:"home"}),_e({handler:v.useCallback(()=>{r("left")},[r]),action:"left"}),_e({handler:v.useCallback(()=>{r("right")},[r]),action:"right"}),e},RB=(t,e,r)=>{if(e==="*")return!0;const s=r.meta.subRooms[e];return t.x>=s.physicalPosition.from.x&&t.y>=s.physicalPosition.from.y&&t.x<=s.physicalPosition.to.x&&t.y<=s.physicalPosition.to.y},IB=({position:t},e,r)=>RB(t,e,r),jB=(t,e,r)=>{if(e==="*")return 0;const s=r.meta.subRooms[e],{from:n,to:i}=s.physicalPosition;if(t.x>=n.x&&t.y>=n.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<n.x?o=n.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<n.y?a=n.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},jf=(t,e,r)=>{const s=r.meta?.subRooms;if(s===void 0)return"*";let n,i=1/0;const o=e==="fine"?{x:t.x/G.x,y:t.y/G.y}:t;for(const a of Rx(s)){const l=jB(o,a,r);if(l===0)return a;l<i&&(i=l,n=a)}if(n===void 0)throw new Error(`item not found in any subroom of ${r.id}
      item at  ${JSON.stringify(o)}
      subrooms ${JSON.stringify(r.meta?.subRooms,null,2)}`);return n},H=48,kr=36,mo=.55,qt=H*((1-mo)/2),Vt=H-qt,go=8,vs=128,ws=({mapTitle:t,y:e=0,className:r,textOnly:s=!1})=>{const n=Eo();return d.jsxs("g",{className:r,children:[s||d.jsx("rect",{y:e,width:1e4,height:1e4}),d.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:go,y:e+16,children:d.jsx(j,{className:`left-2 relative sprites-double-height ${ae}`,children:t})})]})},Ur={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},OB=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.highlightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},rw=t=>(t&&Ur[t])??{bgClassName:"fill-shadow",containerClassName:""},Lt=t=>({x:(t.x??0)*H,y:(t.y??0)*H,z:(t.z??0)*kr}),On=t=>Math.round(t*10)/10,Of=t=>{const e=Ie(t);return`translate(${On(e.x)},${On(e.y)})`},$=t=>{const e=Ie(t);return Pt(e)},Pt=t=>`${On(t.x)},${On(t.y)}`,NB=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const s=Eo(),n=e.r-e.l+2*go,i={x:-e.l+go+(r-n)/2,y:-e.t+vs},o=(x,b=X)=>Wr(i,Ie(Lt(U(t[x].gridPosition,b)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),f=o("blacktooth53market/*",{x:0,y:1,z:0}),p=o("blacktooth53market/*",{x:1,y:1,z:0}),m=o("blacktooth52market/*",{x:1,y:.5,z:0}),A=s*8*2,g="Market",y=(g.length+3)*s*8,V=s*8*2+32;return d.jsxs(d.Fragment,{children:[d.jsx("path",{className:`${Ur.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Pt({x:A,y:m.y+V})}
L ${Pt({x:y,y:m.y+V})}
L ${Pt({x:y,y:a.y})}
L ${Pt(a)}
L ${Pt(l)}
L ${Pt(c)}
L ${Pt(u)}
L ${Pt(h)}
L ${Pt(f)}
L ${Pt(p)}
L ${Pt(m)}
L ${Pt({...m,x:A})}
z`}),d.jsx(ws,{y:m.y,mapTitle:g,className:Ur.market.bgClassName,textOnly:!0})]})},zB=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const s=t,n=Ie(Lt({x:1,y:1,z:0})).y,i=(o,a)=>{if(s[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(s[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=Ie(Lt(s[o].gridPosition)).y,c=Ie(Lt(s[a].gridPosition)).y+n;return(l+c)/2};return d.jsxs(d.Fragment,{children:[d.jsx(ws,{y:0,mapTitle:"Freedom",className:Ur.freedom.bgClassName}),d.jsx(ws,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+vs,mapTitle:"Castle Blacktooth",className:Ur.blacktooth.bgClassName}),d.jsx(ws,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+vs,mapTitle:"Moonbase",className:Ur.moonbase.bgClassName}),d.jsx(ws,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+vs,mapTitle:"Blacktooth escape",className:Ur.blacktooth.bgClassName}),d.jsx(NB,{mapBounds:e,originalCampaignPositions:s,containerWidth:r}),d.jsx(ws,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+vs,mapTitle:"Jail",className:Ur.jail.bgClassName})]})},BB={blacktooth:"Blacktooth",bookworld:"Bookworld",jail:"Blacktooth",egyptus:"Egyptus",moonbase:"Moonbase",market:"Market",penitentiary:"Penitentiary",safari:"Safari"},DB=t=>{const{campaign:e,curRoomId:r}=t,s=e.locator.userId===Hq&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),n=rw(t.curRoomScenery);return s?d.jsx(zB,{...t}):d.jsx(ws,{mapTitle:BB[e.rooms[r].planet],className:n.bgClassName})},ny=t=>r_(Ut(t.aabb,.5),t.state.position),FB={x:1,y:1,z:1},iy=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),p$=t=>t,LB=t=>jr(t.items),UB=t=>Sd(t),sw=t=>Fe(LB(t)),m$=(t,...e)=>{const r=Fe(UB(t));return e.length===0?r:r.filter(([,s])=>e.includes(s.type))},$B={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},g$=t=>Mt(t.items).reduce((e,r)=>{if(r.type==="floor"){const{config:{naturalFootprint:s},state:{position:n},renderAabb:i,renderAabbOffset:o,aabb:a}=r,l=Ie(U(s.position,{x:s.aabb.x,z:s.aabb.z})).x,c=Ie(U(s.position,{y:s.aabb.y,z:s.aabb.z})).x,u=Ie(U(s.position,s.aabb)).y,h=Ie(U(n,o??X,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const s=Ie(U(r.state.position,r.renderAabb??r.aabb??X,r.renderAabbOffset??X)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,s)},floors:e.floors}}},$B),HB={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},nw=t=>{const e=sw(t).filter(r=>r.type==="floor").reduce((r,s)=>{const{position:n,config:{times:i}}=s;return{from:{x:Math.min(r.from.x,n.x),y:Math.min(r.from.y,n.y),z:Math.min(r.from.z,n.z)},to:{x:Math.max(r.to.x,n.x+i.x),y:Math.max(r.to.y,n.y+i.y),z:Math.max(r.to.z,n.z)}}},HB);if(isFinite(e.from.x))return e},iw=({svg:t=!1,smooth:e=!1})=>{const r=v.useRef(null);return v.useLayoutEffect(()=>{r.current?.scrollIntoView({behavior:e?"smooth":"instant",block:"center"})}),t?d.jsx("g",{ref:r}):d.jsx("div",{ref:r})},Ha=({className:t,scrollTo:e=!1,onClick:r,yAdjust:s=0})=>d.jsxs("foreignObject",{x:-50,y:-100+s,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[d.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r,style:r?{pointerEvents:"all"}:{}}),e&&d.jsx(iw,{})]}),Ti=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:s=!1,yAdjust:n=0,onClick:i})=>d.jsx(Ha,{className:`${s?"[--scale:2.5]":"[--scale:1.5]"}
                ${Tn({character:t,action:r?"walking":"idle",facingXy8:_d(e)??"towards"})}`,scrollTo:r,yAdjust:n,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),GB=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return d.jsxs(d.Fragment,{children:[d.jsx(Ha,{className:`${r} texture-lift_static`}),d.jsx(Ha,{className:`${r} texture-lift_2`})]});const s=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return d.jsx(Ha,{className:`${r} ${s}`})},WB=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],YB=({x:t,y:e},{x:r,y:s})=>(t-r)**2+(e-s)**2,QB=(t,e)=>{const r=t%3,s=Math.floor(t/3),n=e%3,i=Math.floor(e/3);return Math.abs(r-n)<=1&&Math.abs(s-i)<=1&&t!==e},oy=t=>t.some((e,r)=>t.slice(r+1).some(s=>QB(e,s))),Li=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...s]=t;return[...Li(s,e),...Li(s,e-1).map(n=>[r,...n])]},ow=t=>t.length<=1?[t]:t.flatMap((e,r)=>ow([...t.slice(0,r),...t.slice(r+1)]).map(s=>[e,...s])),ay={1:Li([...Array(9).keys()],1),2:Li([...Array(9).keys()],2).filter(t=>!oy(t)),3:Li([...Array(9).keys()],3).filter(t=>!oy(t))},Wh=3,aw=({items:t,itemNormalisedPosition:e})=>{const r=wo(t),s=r.length;if(s===0)return fe;if(s>Wh)throw new Error(`roomItemPositions supports up to ${Wh} items, but got ${s}: ${Object.keys(t).join(", ")}`);const n=r.map(([a,l])=>({id:a,pos:e(l)}));let i=fe,o=1/0;if(ay[s]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${s}`);for(const a of ay[s]){const l=a.map(c=>WB[c]);for(const c of ow(l)){const u={};let h=0;for(let f=0;f<s;f++){const{id:p,pos:m}=n[f],A=c[f];u[p]=A,h+=YB(m,A)}h<o&&(o=h,i=u)}}return i},lw=({items:t,positions:e,ItemComponent:r})=>d.jsx("g",{"data-class":"items",children:wo(e).sort(([s,n],[i,o])=>o.y-n.y+(o.x-n.x)).map(([s,n])=>d.jsx("g",{"data-position":JSON.stringify(n),transform:`${Of(Ax(n,H*.5))} translate(0,-3)`,children:d.jsx(r,{item:t[s]})},s))}),KB=(t,e)=>{if(t==="*"){const r=nw(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},XB=({items:t,roomJson:e,subRoomId:r})=>{const s=v.useMemo(()=>aw({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??fe,...FB},a=Wr(i.position,Ut(o,.5)),l=KB(r,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return d.jsx(lw,{ItemComponent:GB,items:t,positions:s})},JB=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:s,onClick:n})=>{const i=v.useMemo(()=>({item:{type:l,state:{facing:c}}})=>d.jsx(Ti,{characterName:l,facing:c,isCurrent:s===l,onlyPlayableInRoom:!1,onClick:n}),[s,n]),o=v.useMemo(()=>({head:t,heels:e}),[t,e]),a=v.useMemo(()=>aw({items:o,itemNormalisedPosition:c=>{const u=ny(c),h=xx(ny(c),{x:1/G.x,y:1/G.y,z:1}),f=nw(r);if(f===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:iy(h.x,f.from.x,f.to.x),y:iy(u.y,f.from.y,f.to.y)}}}),[o,r]);return d.jsx(lw,{ItemComponent:i,items:o,positions:a})},ZB=(t,e,r)=>IB(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),e2=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const s=Object.groupBy(r,i=>i[1].type),n=Y_(e,U_(...jr(s)));return Object.fromEntries(n)},t2=(t,e,r)=>v.useMemo(()=>{let s=!1,n=!1;const i=Fe(wo(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(s)return!1;s=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(n)return!1;n=!0}return!0}).filter(o=>ZB(o[1],r,t));return e2(Ln(i),Wh)},[t,e,r]),cw=.15,Ca=Ie(Lt({x:.5,y:.5,z:0})),ly=Ie(Lt({x:cw,y:0,z:0})),cy=Ie(Lt({x:cw*1.66,y:0,z:0})),r2=({className:t})=>d.jsxs(d.Fragment,{children:[d.jsx("ellipse",{className:"fill-white",cx:Ca.x,cy:Ca.y,rx:Math.abs(cy.x),ry:Math.abs(cy.y)}),d.jsx("ellipse",{className:t,cx:Ca.x,cy:Ca.y,rx:Math.abs(ly.x),ry:Math.abs(ly.y)})]}),Bt=3,uy=yx(Ie({x:H,y:0})),Pa={wall:void 0,open:"0,999",doorway:`${On(uy*((1-mo)/2)-Bt/2)}, ${On(uy*mo+Bt)}, 999`},ju=`
M ${$({})}
L ${$({y:H})}
L ${$({x:H,y:H})}
L ${$({x:H})}
z`,Ea=(t,e=mo)=>{const r=H*((1-e)/2),s=H-r,n=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${$({x:r,y:r})}`;return a&&(l+=`L${$({x:0,y:r})} L${$({x:0,y:s})}`),l+=`L${$({x:r,y:s})}`,n&&(l+=`L${$({x:r,y:H})} L${$({x:s,y:H})}`),l+=`L${$({x:s,y:s})}`,o&&(l+=`L${$({x:H,y:s})} L${$({x:H,y:r})}`),l+=`L${$({x:s,y:r})}`,i&&(l+=`L${$({x:s,y:0})} L${$({x:r,y:0})}`),l+="z",l},Ou=4,s2=Fe(Ex(Ou)).map(t=>`
M${$({x:H*((t+.5)/Ou),y:0})}
L${$({x:H*((t+.5)/Ou),y:H})}`).toArray().join(""),hy=t=>{const e=`
M${$({x:0,y:H})}
L${$({x:0,y:H,z:kr})}
L${$({x:H,y:H,z:kr})}
L${$({x:H,y:H})}
z
`;return t?e+`
M${$({x:qt,y:H})}
L${$({x:qt,y:H,z:kr})}
L${$({x:Vt,y:H,z:kr})}
L${$({x:Vt,y:H})}
L${$({x:qt,y:H})}`:e},n2=`            
M${$({x:H,y:H,z:kr})}            
L${$({x:H,y:H})}            
M${$({x:H,y:0,z:kr})}            
L${$({x:H,y:0})}            
M${$({x:0,y:H,z:kr})}            
L${$({x:0,y:H})}            
`,i2=`            
M${$({x:0,y:0,z:kr})}            
L0, 0            
`,o2=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:s,roomVisited:n,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:f,color:p,items:m}=s,A=s.meta?.label,g=t2(s,r,e),y=Object.values(m).filter(b=>b.type==="floor"),V=y.every(b=>b.config.floorType==="none"),x=y.some(b=>b.config.floorType==="deadly");return d.jsxs("g",{"data-room-id":h,strokeWidth:Bt,className:OB(p),children:[V?d.jsxs(d.Fragment,{children:[d.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${ju} ${Ea(t)}`}),d.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${Ea(t)} ${Ea(t,mo*.7)}`})]}):d.jsxs(d.Fragment,{children:[d.jsx("path",{className:"fill-[var(--roomHintColor)]",d:ju}),d.jsx("path",{className:"fill-white",d:Ea(t)}),x&&d.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:s2})]}),s.id==="blacktooth11"?d.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${$({x:qt,y:qt})}
L${$({x:Vt,y:qt})}
L${$({x:Vt,y:qt-Bt*2})}
L${$({x:qt,y:qt-Bt*2})}
z
M${$({x:qt,y:Vt})}
L${$({x:Vt,y:Vt})}
L${$({x:Vt,y:Vt+Bt*2})}
L${$({x:qt,y:Vt+Bt*2})}
z
`}):s.id==="moonbase20"||s.id==="moonbase23"?d.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Bt*2,d:`
M${$({x:qt,y:H/2})}
L${$({x:Vt,y:H/2})}

M${$({x:H/2,y:qt})}
L${$({x:Vt,y:H/2})}

M${$({x:H/2,y:Vt})}
L${$({x:Vt,y:H/2})}
`}):s.id==="blacktooth77"||s.id==="safari26"?d.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${$({x:H/2-Bt,y:0})}
L${$({x:H/2+Bt,y:0})}
L${$({x:H/2+Bt,y:H})}
L${$({x:H/2-Bt,y:H})}
z
`}):null,f&&d.jsxs(d.Fragment,{children:[d.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:hy(t.away==="doorway")}),d.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:hy(t.left==="doorway")})]}),d.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[d.jsx("path",{d:`M${$({x:0,y:H})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:Pa[t.right]}),d.jsx("path",{d:`M${$({x:H,y:0})} L${$({x:H,y:H})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:Pa[t.left]}),d.jsx("path",{d:`M${$({x:H,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:Pa[t.towards]}),d.jsx("path",{d:`M${$({x:0,y:H})} L${$({x:H,y:H})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:Pa[t.away]})]}),n&&d.jsx(r2,{className:"fill-[var(--roomHintColor)]"}),f&&d.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:n2}),i&&o?d.jsx(JB,{roomJson:s,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?d.jsx(Ti,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?d.jsx(Ti,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?d.jsxs(d.Fragment,{children:[d.jsx(Ti,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),d.jsx(Ti,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):d.jsx(XB,{roomJson:s,subRoomId:e,items:g}),f&&d.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:i2}),A&&d.jsx("g",{transform:Of(Lt(Wr(A.gridOffset,{x:.5,y:.5}))),children:d.jsx("foreignObject",{width:A.text.length*16,height:HM.h*2,y:-8,x:A.align==="left"?0:A.text.length*-16,children:d.jsx(j,{noTint:!0,className:"[--scale:2] [--block:16px]",children:A.text})})}),u?d.jsx("path",{className:"fill-transparent cursor-pointer",d:ju,onClick:()=>{u(h)}}):null]})},Nu=(t,e,r,s)=>{const n=$h(e,t[e]?.items);return n&&r===t[e].roomJson.id&&s===jf(n.state.position,"fine",t[e].roomJson)?n:void 0},a2=t=>{const{campaign:e,pickupsCollected:r,gridPositions:s,currentCharacterName:n,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const f=o.r-o.l+2*go,p=o.b-o.t+2*vs,m=Object.values(s);return d.jsxs("svg",{className:"w-full",style:{minWidth:`${f}px`,height:`${p}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:d.jsx(DB,{...t,curRoomId:u,containerWidth:a}),d.jsx("g",{transform:`translate(${-o.l+go+(a-f)/2},${-o.t+ +vs})`,children:m.map(A=>{const{roomId:g,subRoomId:y,gridPosition:V}=A,x=`${g}/${y}`;return d.jsxs("g",{"data-id":x,transform:Of(Lt(V)),children:[d.jsx(o2,{roomGridPositionSpec:A,roomPickupsCollected:r[g]??fe,roomJson:e.rooms[g],headItemInRoom:Nu(i,"head",g,y),heelsItemInRoom:Nu(i,"heels",g,y),headOverHeelsItemInRoom:Nu(i,"headOverHeels",g,y),currentCharacterName:n,roomVisited:l[g]??!1,onPlayableClick:c,onRoomClick:h}),u===g?d.jsx(iw,{svg:!0,smooth:!0}):null]},x)})})]})},l2=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?($a(t),!0):e.currentActionPress("swop.head")==="tap"?($a(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?($a(t,"heels"),!0):!1},c2=()=>{const t=Dn(),[e,r]=v.useState(t.gameState.currentCharacterName);return v.useEffect(()=>{const s=()=>{r(t.gameState.currentCharacterName)};return dt.shared.add(s),()=>{dt.shared.remove(s)}},[t.gameState]),e},u2=()=>{const t=Dn();v.useEffect(()=>{const e=()=>{l2(t.gameState)};return dt.shared.add(e),()=>{dt.shared.remove(e)}},[t.gameState])},h2=t=>t.characterRooms[t.currentCharacterName],Yh=t=>JSON.parse(JSON.stringify(t)),d2=()=>Kt().get("cheats")==="1",f2=(t,e)=>{const r=new URL(e),s=r.hash.substring(1);if(s!==""&&t.rooms[s]!==void 0)return r.hash.substring(1)},p2=t=>Ie(t),m2=(t,e)=>Ie(U(t,{x:e.x,z:e.z})),g2=(t,e)=>Ie(U(t,{y:e.y,z:e.z})),dy=(t,e,r)=>{const s=m2(e,r),n=g2(e,r),i=p2(e),o=t;return o.xAxisProjectionMin=n.y-n.x/2,o.xAxisProjectionMax=i.y-i.x/2,o.yAxisProjectionMin=s.y+s.x/2,o.yAxisProjectionMax=i.y+i.x/2,o.zAxisProjectionMin=s.x,o.zAxisProjectionMax=n.x,o},fy=G.x*2,py=G.x*2,my=G.x*2,gy=G.x*2;class uw{#e=new Map;#t=new Map;#r=new Map;#s=new Map;#n=new Map;constructor(e){if(e)for(const r of e)this.addItem(r)}#i(e,r,s,n){const i=new Set;for(const o of r)n(o).add(e),i.add(o);s.set(e,i)}#o(e,r,s){const n=s.get(e);if(s.delete(e),!!n)for(const i of n){const o=r.get(i);o&&(o.delete(e),o.size===0&&r.delete(i))}}#l(e,r,s,n,i){const o=n.get(e);if(!o)throw new Error(`Item ${e.id} not in index`);const a=new Set(r);let l=!1,c=!1;for(const u of o)if(!a.has(u)){const h=s.get(u);h&&(l=!0,h.delete(e))}for(const u of a)o.has(u)||(i(u).add(e),c=!0);if(l)for(const u of o){const h=s.get(u);h&&h.size===0&&s.delete(u)}l||c?n.set(e,a):a.clear()}addItem(e){if(this.#r.has(e)){const r=this.#r.get(e);throw new Error(`Item ${e.id} is already in the spatial index at ${[...r].join(" ")}`)}this.#i(e,this.#u(e.state.position,e.aabb),this.#r,r=>this.#a(r)),this.#f(e),this.#i(e,this.#h(e),this.#s,r=>this.#d(r))}#c(e,r){return`${e},${r}`}#a(e){let r=this.#e.get(e);return r||(r=new Set,this.#e.set(e,r)),r}#d(e){let r=this.#t.get(e);return r||(r=new Set,this.#t.set(e,r)),r}*#u(e,r){const s=e,n=U(e,r),i=Math.floor(s.x/py),o=Math.floor(s.y/fy),a=Math.floor(n.x/py),l=Math.floor(n.y/fy);for(let c=i;c<=a;c++)for(let u=o;u<=l;u++)yield this.#c(c,u)}#f(e){const r=e.renderAabbOffset?U(e.state.position,e.renderAabbOffset):e.state.position,s=e.renderAabb||e.aabb,n=this.#n.get(e);if(n!==void 0)return dy(n,r,s),n;{const i=dy({},r,s);return this.#n.set(e,i),i}}*#h(e){const r=this.#n.get(e);if(r===void 0)throw new Error("projectionAxes not calculated for "+e.id);const{xAxisProjectionMin:s,xAxisProjectionMax:n,yAxisProjectionMin:i,yAxisProjectionMax:o}=r,a=Math.floor(s/gy),l=Math.floor(i/my),c=Math.floor(n/gy),u=Math.floor(o/my);for(let h=a;h<=c;h++)for(let f=l;f<=u;f++)yield this.#c(h,f)}removeItem(e){if(!this.#r.has(e))throw new Error(`Item ${e.id} is not in the spatial index`);this.#o(e,this.#e,this.#r),this.#o(e,this.#t,this.#s),this.#n.delete(e)}updateItemSpatialIndex(e){this.#l(e,this.#u(e.state.position,e.aabb),this.#e,this.#r,r=>this.#a(r))}updateItemProjectedIndex(e){this.#f(e),this.#l(e,this.#h(e),this.#t,this.#s,r=>this.#d(r))}getCuboidNeighbourhood(e,r,s){const n=new Set;for(const i of this.#u(e,r)){const o=this.#e.get(i);if(o)for(const a of o)a!==s&&n.add(a)}return n}getProjectedNeighbourhood(e,r){const s=new Set;for(const n of this.#h(e)){const i=this.#t.get(n);if(i)for(const o of i)o!==r&&s.add(o)}return s}getItemCuboidNeighbourhood(e){return this.getCuboidNeighbourhood(e.state.position,e.aabb,e)}getItemProjectedNeighbourhood(e){return this.getProjectedNeighbourhood(e,e)}getItemAxesProjections(e){return this.#n.get(e)}debugToString(){const r=Array.from(this.#e.keys()).sort().map(i=>{const o=this.#e.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`}),n=Array.from(this.#t.keys()).sort().map(i=>{const o=this.#t.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`});return`GridSpatialIndex (${this.#e.size} 2D cells, ${this.#t.size} projected cells, ${this.#r.size} items) {
  2D Cells:
${r.join(`,
`)}
  Projected Cells:
${n.join(`,
`)}
}`}}const hw=(t,e,r,s)=>!(t.x+e.x<=r.x||t.x>=r.x+s.x)&&!(t.y+e.y<=r.y||t.y>=r.y+s.y)&&!(t.z+e.z<=r.z||t.z>=r.z+s.z),Nf=({aabb:t,state:{position:e}},{aabb:r,state:{position:s}})=>hw(e,t,s,r),A2=t=>!0;function*_s(t,e,r=A2){const s=e.getItemCuboidNeighbourhood(t);for(const n of s)r(n)&&Nf(t,n)&&(yield n)}const Ay=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),yy={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,button:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},dw=(t,e)=>yy[t.type]-yy[e.type],y2=(t,e)=>e.toSorted((r,s)=>{const n=dw(r,s);if(n!==0)return n;const i=Za(t,Ay(t,r)),o=Za(t,Ay(t,s));return Math.abs(i-o)<1e-4?r.id<s.id?-1:1:i-o}),x2=(t,e,r,s)=>{const n=Math.max(0,Math.min(t.x+e.x,r.x+s.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+s.y)-Math.max(t.y,r.y));return n*i},xy=({state:{position:t},aabb:e},{state:{position:r},aabb:s})=>x2(t,e,r,s),hs={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},ds={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},b2=(t,e,r=.001)=>{if(!Qr(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:s}}}}=t;return s>0?!1:(hs.state.position.x=t.state.position.x,hs.state.position.y=t.state.position.y,hs.state.position.z=t.state.position.z-Gr,hs.aabb.x=t.aabb.x,hs.aabb.y=t.aabb.y,hs.aabb.z=r+Gr,ds.state.position.x=e.state.position.x,ds.state.position.y=e.state.position.y,ds.state.position.z=e.state.position.z+e.aabb.z,ds.aabb.x=e.aabb.x,ds.aabb.y=e.aabb.y,ds.aabb.z=0,Nf(hs,ds))},V2=(t,e)=>{const s=[...Fe(e).filter(i=>b2(t,i))];return s.length===0?void 0:s.reduce((i,o)=>{const a=dw(o,i);return a<0||a===0&&xy(t,o)>xy(t,i)?o:i})},Ta=G.z,q2=-G.z,w2=t=>{const e=Mt(t).filter(Xq).reduce((r,{config:{naturalFootprint:{position:{x:s,y:n},aabb:{x:i,y:o}}}})=>{const a=s+i,l=n+o;return{minX:Math.min(r.minX,s),maxX:Math.max(r.maxX,a),minY:Math.min(r.minY,n),maxY:Math.max(r.maxY,l)}},{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0});if(!(e.minX>e.maxY))return e};function*v2(t,e){const r=w2(e);if(r===void 0)return;const{minX:s,maxX:n,minY:i,maxY:o}=r;t.roomBelow!==void 0&&(yield{...it,type:"portal",id:"portal/toRoomBelow",fixedZIndex:Kr,config:{toRoom:t.roomBelow,relativePoint:{x:(s+n)/2,y:(i+o)/2,z:Ta+G.z},direction:he.down},aabb:{x:n-s,y:o-i,z:Ta},state:{...Ge(),position:{x:s,y:i,z:q2-Ta}},renders:!1}),t.roomAbove!==void 0&&(yield{...it,type:"portal",id:"portal/toRoomAbove",fixedZIndex:Kr,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?Re(t.ceilingRelativePoint):{x:(s+n)/2,y:(i+o)/2},z:-G.z},direction:he.up},aabb:{x:n-s,y:o-i,z:Ta},state:{...Ge(),position:U({x:s,y:i},{z:G.z*(t.height??vz)})}})}const _2={x:-9/12,y:-9/12},S2=Re({x:9/12,y:9/12,z:1}),by=(t,e)=>{const r=`${t.position.x},${t.position.y}`;let s=e.get(r);s===void 0&&(s=new Map,e.set(r,s)),s.set(t.config.direction,t)};function*k2(t){const e=new Map,r=new Map;for(const s of sw(t))switch(s.type){case"wall":by(s,e);break;case"door":by(s,r);break}for(const[s,n]of e.entries()){const i=n.get("right"),o=n.get("towards");if(!i||!o)continue;const a=U(i.position,Mn(i.config),{x:-1});if(r.get(`${a.x},${a.y}`)?.get("right")===void 0)continue;const l=U(o.position,Mn(o.config),{y:-1});if(r.get(`${l.x},${l.y}`)?.get("towards")===void 0)continue;const c=i.position;yield{id:`extraCornerShadow-${s}`,type:"blocker",state:{...Ge(),position:Re(U(c,_2))},shadowCastTexture:{textureId:"shadow.wallCorner",spritesheetVariant:"original"},castsShadowWhileStoodOn:!0,config:fe,aabb:S2,fixedZIndex:Kr}}}function*C2(t,e,r,s){const n=wo(t.items);for(const[i,o]of n)o.type==="player"&&!s||(yield*Rf(i,o,t,e,r))}const zu=t=>Fe(t).reduce((e,r)=>({...e,[r.id]:r}),{}),Qh=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:s=!1})=>{const n=zu(C2(t,e,r,s)),i={...zu(v2(t,n)),...n,...zu(k2(t))},o=new uw(Mt(i));for(const l of Mt(i)){const u=_s(l,o).find(h=>Qr(l)&&Qr(h)&&!(l.type==="wall"&&h.type==="wall"));u!==void 0&&console.error(`in room ${t.id} item ${l.id} @${JSON.stringify(l.state.position)} #${JSON.stringify(l.aabb)} is colliding with (solid item) ${u.id} @${JSON.stringify(u.state.position)} #${JSON.stringify(u.aabb)} on loading room ${t.id}`)}for(const l of Mt(i).filter(Cs)){const c=V2(l,Mt(i).filter(u=>u.id!==l.id));c!==void 0&&If({above:l,below:c})}return{...t,roomJson:t,items:i,roomTime:0,[Ft]:o}},Cr=(t,e,r)=>{const s=t[Ft];e.state.position=r,s.updateItemSpatialIndex(e)},P2=.5,E2=(t,e,r,s,n,i)=>{if(Fn(n)<1e-4)return Object.assign(i,X),i;const a=t_(n);if(!hw(t,e,r,s))return Object.assign(i,X),i;let l=-1/0,c=1/0;for(const u of i_){const h=a[u];if(Math.abs(h)<1e-4){const b=t[u],w=t[u]+e[u],_=r[u],q=r[u]+s[u];if(w<=_||b>=q)return Object.assign(i,X),i;continue}const f=r[u],p=r[u]+s[u],m=t[u],A=t[u]+e[u],g=(f-A)/h,y=(p-m)/h,V=Math.min(g,y),x=Math.max(g,y);l=Math.max(l,V),c=Math.min(c,x)}return l>c?(Object.assign(i,X),i):c>0&&(l>=0||c<-l)?Ap(i,a,c):l<0?Ap(i,a,l):(Object.assign(i,X),i)},T2=(t,e,r,s,n)=>E2(t,e,r,s,n,{}),M2=(t,e,r,s,n)=>{const i=r.x+s.x-t.x,o=r.y+s.y-t.y,a=r.z+s.z-t.z,l=t.x+e.x-r.x,c=t.y+e.y-r.y,u=t.z+e.z-r.z,h=Math.abs(i)<Math.abs(l)?i:-l,f=Math.abs(o)<Math.abs(c)?o:-c,p=Math.abs(a)<Math.abs(u)?a:-u,m=Math.abs(h),A=Math.abs(f),g=Math.abs(p)*P2;return m<A&&m<g?(n.x=h,n.y=0,n.z=0,n):A<g?(n.x=0,n.y=f,n.z=0,n):(n.x=0,n.y=0,n.z=p,n)},Kh=(t,e,r,s)=>M2(t,e,r,s,{}),Vy=(t,e,r)=>{const s=e.state.actedOnAt;s!==void 0&&(s.roomTime===r.roomTime?t&&(s.by[t.id]=!0):(s.by=t?{[t.id]:!0}:{},s.roomTime=r.roomTime))},R2=(t,e,r)=>{const s=(n,i)=>{const{collidedWith:o}=n.state;o.roomTime===r.roomTime?o.by[i.id]=!0:(o.by={[i.id]:!0},o.roomTime=r.roomTime)};s(t,e),Cs(e)&&s(e,t)},I2=(t,e,r,s)=>{const n=Pf(t,e,r),i=Kh(t.state.position,t.aabb,e.state.position,e.aabb);if(n&&i.z===0){const o=Tr(s,t.state.position),a=Z0(o),l=Za(i,o)/a;if(o.z=0,l>.44)return T2(t.state.position,t.aabb,e.state.position,e.aabb,o)}return i},Ui=.1,ar={id:"sensor",aabb:{x:0,y:0,z:0},state:{position:{x:0,y:0,z:0}}},nn={id:"sensor",aabb:{x:Ui,y:Ui,z:Ui},state:{position:{x:0,y:0,z:0}}},j2=5/12,O2=6/12,N2=1,z2=1/12,B2=0,D2=1,F2=2,L2=3,Bu=4,qy=.75,U2=(t,e,r,s,n,i)=>{if(i.length===0)return;const o=t.state.position,a=Xt(r.x,0),l=Xt(r.y,0);if(a===l)return;const c=Tr(o,e),u=e_(c)/s;if(!Xt(u,0))return;const h=t.state.standingOnItemId===null;ar.state.position.z=o.z,ar.aabb.z=h?Gr:t.aabb.z;const f=a?"y":"x",m=i.some(k=>k.type==="doorFrame")?z2:h?t.state.vels.gravity.z<0?O2:N2:j2;ar.state.position[f]=t.state.position[f]+(r[f]<0?-Ui:t.aabb[f]),ar.aabb[f]=Ui;const A=Tl(f),g=m*t.aabb[A];ar.aabb[A]=g,ar.state.position[A]=t.state.position[A];const y=(k,C)=>{const P=C===t||!Qr(C)?B2:C.type==="doorFrame"?D2:Pf(t,C)?F2:Uz(C)?Bu:L2;return Math.max(k,P)},V=_s(ar,n[Ft]).reduce(y,0);if(V===Bu)return;nn.state.position.z=t.state.position.z-1,nn.state.position[f]=ar.state.position[f],nn.state.position[A]=t.state.position[A];const x=_s(nn,n[Ft]).filter(k=>Qr(k)&&!(xl(t)&&XA(k))),b=h||!Wp(x);ar.state.position[A]=t.state.position[A]+t.aabb[A]-g;const w=_s(ar,n[Ft]).reduce(y,0);if(w===Bu)return;nn.state.position[A]=t.state.position[A]+t.aabb[A]-1;const _=_s(nn,n[Ft]).filter(k=>Qr(k)&&!(xl(t)&&XA(k))),q=h||!Wp(_);if(V===w)return;const S=V>w;if(S){if(!q)return}else if(!b)return;return{x:a?r.y*(S?1:-1)*(r.y>0?1:-1)*qy:0,y:l?r.x*(S?1:-1)*(r.x>0?1:-1)*qy:0,z:0}},wy=void 0,$2={x:-1,y:-1,z:-1},H2={x:-.6,y:-.6,z:-.4},G2={x:-1,y:-1,z:-.4},Xh=({subjectItem:t,posDelta:e,gameState:r,room:s,deltaMS:n,onTouch:i,visited:o=new Set,forceful:a=Kq(t)&&o.size===0,isHelpful:l})=>{if(vd(e,X))return!1;let c=!1;const{state:{position:u}}=t;Cr(s,t,U(u,e)),o.size===0&&Vy(void 0,t,s);const h=y2(e,_s(t,s[Ft]).toArray());for(const f of h){if(o.has(f.id)||!Nf(t,f))continue;if(Vy(t,f,s),i!==void 0&&wy&&console.group(`handling onTouch() callback for ${t.id} touching ${f.id}`),i?.({movingItem:t,touchedItem:f,movementVector:Tr(t.state.position,u),gameState:r,deltaMS:n,room:s}),i!==void 0&&wy&&console.groupEnd(),s.items[t.id]===void 0)return c;if(s.items[f.id]===void 0||!Qr(f,t)||!Qr(t))continue;const p=Pf(t,f,a),m=I2(t,f,a,u),A=Xt(Fn(Kh(u,t.aabb,f.state.position,f.aabb)),0);if(p){const g=a?$2:Oz(f)?G2:H2,y=xx(m,g);if(Cr(s,t,U(t.state.position,m,y)),o.size<Sz?(c||=Xh({subjectItem:f,posDelta:y,gameState:r,room:s,deltaMS:n,forceful:a,visited:o.add(t.id),onTouch:i}),o.delete(t.id)):console.warn("hit recursion depth limit",new Error),s.items[f.id]===void 0)continue;Cr(s,t,U(t.state.position,Kh(t.state.position,t.aabb,f.state.position,f.aabb)))}else Cr(s,t,U(t.state.position,m));Cs(t)&&m.z>0&&e.z<0&&(t.state.standingOnItemId===null||!h.includes(Zq(t.state.standingOnItemId,s)))&&(Gh(t,s),If({above:t,below:f})),Cs(t)&&!A&&R2(t,f,s)}if(Cs(t)&&!c&&!l){const f=U2(t,u,e,n,s,h);f&&(Xh({subjectItem:t,posDelta:f,gameState:r,room:s,deltaMS:n,forceful:!1,onTouch:i,isHelpful:!0,visited:o.add(t.id)}),o.delete(t.id),c=!0)}return c},Jh=({state:{position:t,facing:e,autoWalk:r,action:s,vels:n}})=>({position:t,facing:e,autoWalk:r,action:s,vels:{...n}}),W2=t=>{let e=2166136261;const r=t.length;for(let s=Math.max(0,r-9);s<r;s++)e^=t.charCodeAt(s),e=Math.imul(e,1540483477),e^=e>>>15;return(e>>>0)/4294967295},Y2=1e3/25,fw=t=>{const e=ut.animations[t],r=e.length,{animationSpeed:s}=e;return r*Y2/s};fw("bubbles.white");const Q2=fw("head.fadeOut"),K2=({touchedItem:t,room:e,gameState:r})=>{jn({room:e,item:t});const s=Kz(t),n=t.type==="pickup"?{type:"pickup",gives:t.config.gives}:t.type==="hushPuppy"?{type:"hushPuppy"}:{type:"disappearing"},i=Ut(Tf(t).aabb,.5);for(let o=0;o<s.x;o++)for(let a=0;a<s.y;a++)for(let l=0;l<s.z;l++){const c=`${t.id}/${o},${a},${l}`,u=SB({itemType:"bubbles",config:{style:"white",was:n},position:X,room:e,gameState:r,additionalIdPart:c}),h={x:o*G.x,y:a*G.y,z:l*G.z},f=U(t.state.position,h,i);Cr(e,u,Tr(f,Ut(u.aabb,.5)));const p=W2(c)*.5+.75;u.state.expires=e.roomTime+Q2*p}},X2=(t,e)=>{const r=Mt(t.items).filter($z);for(const s of r)K2({touchedItem:s,gameState:e,room:t})},J2=(t,e,{changeType:r,sourceItem:s})=>{switch(r){case"portal":return Mt(t.items).find(n=>Vs(n)&&n.config.toRoom===e.id&&(s.config.toDoor===void 0||n.jsonItemId===s.config.toDoor)&&vd(Ut(s.config.direction,-1),n.config.direction));case"level-select":return Mt(t.items).find(n=>Vs(n)&&n.config.toRoom===e.id&&n.config.direction.z===0)??Mt(t.items).find(n=>Vs(n)&&n.config.direction.z===0)??Mt(t.items).find(n=>Vs(n)&&n.config.direction.z>0)??Mt(t.items).find(Vs)}},Z2=(t,e,r,s)=>{const n=1*G.x;Cr(s,t,U(t.state.position,Ut(e,n)));for(let i=0;i<n;i++)Xh({subjectItem:t,posDelta:Ut(e,-1),gameState:r,room:s,deltaMS:16,forceful:!0,onTouch:void 0})},eD=t=>{const{playableItem:e,gameState:r,toRoomId:s,changeType:n,sourceItem:i}=t,o=r.characterRooms[e.id];if(o===void 0)throw new Error(`${e.id} is not in a room on the gameState`);if(s===o.id)throw new Error(`Can't move ${e.id} to the same room "${s}""`);let a;switch(n){case"portal":{const{config:{relativePoint:m},state:{position:A}}=i;a=Tr(e.state.position,U(A,m));break}case"teleport":{const{state:{position:m}}=i;a=Tr(e.state.position,m);break}case"level-select":a={x:0,y:0,z:0};break;default:throw new Error}const l=e.type==="headOverHeels"?void 0:r.characterRooms[xn(e.id)],u=TV(le.getState()).rooms[s];if(u===void 0)throw new Error(`room ${s} does not exist in campaign`);const h=l?.id===s?l:Qh({roomJson:u,roomPickupsCollected:r.pickupsCollected[s]??fe,scrollsRead:le.getState().gameMenus.gameInPlay.scrollsRead}),f=Hz(e);if(f!==void 0){const{carrying:m}=f;m!==null&&(In({room:o,item:m,atPosition:e.state.position}),f.carrying=null)}if(jn({room:o,item:e}),e.state.latentMovement=[],e.state.previousStandingOnItemId=null,e.state.standingOnUntilRoomTime=Ne,(e.type==="head"||e.type==="headOverHeels")&&X2(h,r),h.items[e.id]!==void 0&&jn({room:h,item:e}),In({room:h,item:e}),r.characterRooms[e.id]=h,t.changeType==="teleport"){const{state:{toPosition:m}}=t.sourceItem;Cr(h,e,U(Re(m),a))}else{const m=J2(h,o,t);if(m===void 0)if(t.changeType==="level-select")Cr(h,e,Re({x:1,y:1,z:8}));else throw new Error(`trying to move ${e.id} from ${o.id} --to-> ${s} but no destination portal found to locate with`);else{const A=U(m.state.position,m.config.relativePoint,a,n==="portal"&&i.config.direction.z>0?{z:G.z}:{});Cr(h,e,A);const{config:{direction:g}}=m;g.z===0&&(e.state.autoWalk=!0,e.state.facing=e.state.visualFacingVector=Ut(g,-1),e.state.action==="idle"&&(e.state.action="moving"),Z2(e,g,r,h))}}const p=Cx(_s(e,h[Ft],m=>!Vs(m)));p!==void 0&&console.warn("on entering room",s,"character",e.id,"at",e.state.position,"collides with (at least one; only first is shown) non-portal item:",p),r.entryState[e.id]=Jh(e),e.id==="headOverHeels"?(delete r.entryState.head,delete r.entryState.heels):(r.entryState[xn(e.id)]||(r.entryState[xn(e.id)]=r.entryState.headOverHeels),delete r.entryState.headOverHeels),le.dispatch(EM(s)),le.dispatch(IV({characterName:e.type,roomId:s}))},pw=t=>{const e={};for(const r of Object.values(t.rooms))for(const s of Object.values(r.items))if(s.type==="player"){const{which:n}=s.config;if(e[n]!==void 0)throw new Error(`Campaign has duplicate starting rooms for ${n}`);e[n]=r.id}return e},tD=t=>{const e=pw(t),r={...e};if(e.head===void 0&&e.heels===void 0)throw new Error("couldn't find either head or heels in campaign");let s=Kt().get("playAsHeels")==="1"?"heels":e.head!==void 0?"head":"heels";const n=d2()?f2(t,window.location.href):void 0;return n!==void 0&&(r[s]=n),r.head===void 0&&(s="heels"),{campaignStartingRoomIds:e,startingRoomIds:r,startAs:s,changedCharacterRoomFromCampaign:n!==void 0&&e[s]!==r[s]}},rD=t=>{for(const e of jr(t)){const r=e;r[Ft]===void 0&&(r[Ft]=new uw(Mt(e.items)))}return t},sD=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:s={}})=>{if(r){const m=r.gameState.characterRooms,A=Yh(m);return m.head!==void 0&&m.head.id===m.heels?.id&&(A.heels=A.head),Object.assign(s,{inputStateTracker:e,...Yh(r.gameState)}),s.characterRooms=rD(A),s}const{startAs:n,startingRoomIds:i,campaignStartingRoomIds:o,changedCharacterRoomFromCampaign:a}=tD(t),l={roomPickupsCollected:fe,scrollsRead:fe,isNewGame:!0},c=o.head&&Qh({roomJson:t.rooms[o.head],...l}),u=o.heels===o.head?c:o.heels&&Qh({roomJson:t.rooms[o.heels],...l}),h=c===void 0?void 0:$h("head",c?.items),f=u===void 0?void 0:$h("heels",u?.items),p=Object.assign(s,{inputStateTracker:e,currentCharacterName:n,entryState:{head:h===void 0?void 0:Jh(h),heels:f===void 0?void 0:Jh(f)},pickupsCollected:{},gameTime:0,freeCharacters:{},characterRooms:{head:c,heels:u,headOverHeels:void 0}});return a&&eD({changeType:"level-select",gameState:p,playableItem:n==="head"?h:f,toRoomId:i[n],sourceItem:void 0}),p},A$=t=>{try{return sD(t)}catch(e){throw new Error("failed to load game state",{cause:e})}},nD=Ie(Lt({x:1,y:1,z:1})).y,vy=Ie(Lt({x:0,y:1,z:0})).x,iD=t=>t.reduce((e,{gridPosition:r})=>{const s=Ie(Lt(r));return{t:Math.min(e.t,s.y+nD),b:Math.max(e.b,s.y),l:Math.min(e.l,s.x-vy),r:Math.max(e.r,s.x+vy)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),oD="$$final",Ma=(t,e,r,s)=>e.some(n=>n.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:n})=>n_(he[t],K0(n,s)))?"open":"wall";function*un(t){try{yield*aD(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*aD({roomId:t,subRoomId:e="*",campaign:r,visited:s={},vectorFromPrevious:n,previousRoomGridPosition:i=X}){if(t==="nowhere"||s[t]?.[e])return;s[t]===void 0&&(s[t]={}),s[t][e]=!0;const o=r.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...Fe(jr(o.items)).filter(p=>p.type==="door").filter(p=>jf(p.position,"block",o)===e)],l=U(i,n===void 0?bx:n),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:Ma("left",a,c,u),right:Ma("right",a,c,u),away:Ma("away",a,c,u),towards:Ma("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[p,{gridPosition:m}]of Fe(wo(c)))p!==e&&(yield*un({roomId:t,subRoomId:p,campaign:r,visited:s,vectorFromPrevious:Tr({...m,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:p,subRoomAbove:m}=o;yield*un({roomId:p,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:he.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:p,subRoomBelow:m}=o;yield*un({roomId:p,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:he.down,previousRoomGridPosition:l})}for(const p of a){const{toRoom:m}=p.config;if(m!==oD)try{yield*un({roomId:m,campaign:r,visited:s,subRoomId:p.config.meta?.toSubRoom,vectorFromPrevious:he[p.config.direction],previousRoomGridPosition:l})}catch(A){throw new Error(`error while traversing door ${JSON.stringify(p,null,2)} in room ${t} to room ${m}`,{cause:A})}}const f=o.meta?.nonContiguousRelationship;if(f!==void 0){const{with:{room:p},gridOffset:m}=f;yield*un({roomId:p,campaign:r,visited:s,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const lD=t=>{const r=[...t].sort(({gridPosition:s},{gridPosition:n})=>s.z!==n.z?s.z-n.z:n.x+n.y-(s.x+s.y)).map(s=>[`${s.roomId}/${s.subRoomId}`,s]);return Ln(r)},cD=()=>{const t=c2(),e=mM(),{gameState:r}=Dn(),s=MV();return v.useMemo(()=>{try{const n=h2(r),i=n?.roomJson.id??pw(s).head;let o;if(!r)o="*";else if(!n?.roomJson.meta?.subRooms)o="*";else{const u=n?.items[t];u?o=jf(u.state.position,"fine",n.roomJson):o="*"}const a=[...un({campaign:s,roomId:i,subRoomId:o})],l=lD(a);return{mapBounds:iD(a),curRoomId:n?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:r.pickupsCollected,characterRooms:r.characterRooms,campaign:s,roomsExplored:e,curRoomScenery:n?.planet}}catch(n){throw new Error("error getting map data",{cause:n})}},[s,t,r,e])},uD=()=>{const{ref:t,width:e}=xz(),r=tw(),s=Dn();u2();const n=cD(),i=rw(n.curRoomScenery);return d.jsx(ze,{children:d.jsx(Se,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:z(mt),dialogId:"map",children:d.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:r,children:d.jsx(a2,{onPlayableClick:o=>$a(s.gameState,o),containerWidth:e,...n})})})})},hD=`## Bag

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bags icon at the
bottom right of the screen. To pick up an object, stand on top of it and
press *carry*. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Section adapted from the original Head over Heels manual

`,dD=`## Planet Blacktooth

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Section adapted from the original Head over Heels manual`,fD=`## Planet Book World

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Section adapted from the original Head over Heels manual
`,pD=`## Conveyor Belts

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Section adapted from the original Head over Heels manual
`,mD=`## Credits

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
1987 Ocean Software Limited.

### 38 years later, a Remake

* code by Jim Higson
* Playtesting, ideas, map design, and general support by my brother, Tom Higson
* Playtesting, moral support, and constant comms by [Jon Albaugh](https://x.com/fextwolf?s=21&t=PEqxJblCn3JB_NH8AOR6Zg)
* Head over heels [font](https://fontstruct.com/fontstructions/show/996776/head_over_heels)
recreated by [Patrick H. Lauke](http://splintered.co.uk/)

This project is licensed under the GNU Affero General Public License v3.0 (only) - see the LICENSE file for details. All code is original except where indicated otherwise.

2025 Jim Higson`,gD=`## Crowns

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Section adapted from the original Head over Heels manual`,AD=`## Cuddly Stuffed White Rabbits

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
If you pick them up while head and heels are joined, they get *two each*

##  Iron Pills

![](texture-animated-shine?text-metallicBlue&float-left)To make you invulnerable

##  Jump higher bunny

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)Only works on Heels

##  Go faster bunny
![](texture-animated-head_idle_right?text-metallicBlue&float-left)Only works on slow-moving Head

> Section adapted from the original Head over Heels manual
`,yD=`## Doughnuts

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so dont waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Section adapted from the original Head over Heels manual
`,xD=`## Planet Egyptus

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Section adapted from the original Head over Heels manual
`,bD=`## Head 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Section adapted from the original Head over Heels manual
`,VD=`## Heels 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heelss evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump their own height and can also run very fast.

> Section adapted from the original Head over Heels manual`,qD=`## Hints and Tips

1. **1** Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_standing_towards&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** Make sure Head learns to climb ladders; this is an essential skill.
5. **5** ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelss bag and Heads hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the others back.
7. **7** Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** Learn the difference in distance and control between Heads jumps and Heelss jumps.
9. **9** This remake comes with a **map**. Use it!
10. **10** ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** If you cant understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Section adapted from the original Head over Heels manual`,wD=`## The Blacktooth Empire

![](texture-crown_blacktooth)Far, far away from our star Sol lies **The Blacktooth empire**, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_standing_right)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - **Head** saddled on **Heels**, and indeed these
*are* their names and both are highly trained spies.

> Section adapted from the original Head over Heels manual
`,vD=`## Hooter

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by **Head** and requires a tray of *doughnuts* to be of any use.

> Section adapted from the original Head over Heels manual
`,_D=`## Hush Puppies

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Heads race, they disappear and wont return until they are sure the coast is
clear.

> Section adapted from the original Head over Heels manual
`,SD=`
## Planet Penitentiary
### The empires prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Section adapted from the original Head over Heels manual
`,kD=`## Reincarnation Fish

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Section adapted from the original Head over Heels manual
`,CD=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* To the right of the address bar, click the **install icon: **. It might also look like a 'download' icon.
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock **
* **Head over heels** is now installed on your mac
* If you dont want to keep the game in the Dock, right-click the doc icon and uncheck **Options  keep in doc**. It is still available in Applications

---

## Firefox 

* Firefox doesn't support PWAs out of the box, but there is a [browser extension](https://addons.mozilla.org/en-US/firefox/addon/pwas-for-firefox/).
* Probably easier to play in the browser until Mozilla adds support`,PD=`## Supported platforms

Almost anything with an up-to-date browser can play

Heres some Ive tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,ED=`## Planet Safari

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Section adapted from the original Head over Heels manual`,TD=`## Springs

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Section adapted from the original Head over Heels manual
`,MD=`## Switches

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Section adapted from the original Head over Heels manual, revised for remake
`,RD=`## Swop Key

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Section adapted from the original Head over Heels manual`,ID=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minions back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyll never get this far!

*> Your humble minion*
`,jD=`## Teleports

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Section adapted from the original Head over Heels manual `,OD=`## The Emperors Guardian

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **VERY
DANGEROUS**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Section adapted from the original Head over Heels manual
`,ND=`## The Game

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain keep fit equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Section adapted from the original Head over Heels manual
`,qe=Object.assign({"./bag.md":hD,"./blacktooth.md":dD,"./bookWorld.md":fD,"./conveyorBelts.md":pD,"./credits.md":mD,"./crowns.md":gD,"./cuddlyStuffedWhiteRabbits.md":AD,"./doughnuts.md":yD,"./egyptus.md":xD,"./head.md":bD,"./heels.md":VD,"./hintsAndTips.md":qD,"./historyOfTheBlacktoothEmpire.md":wD,"./hooter.md":vD,"./hushPuppies.md":_D,"./penitentiary.md":SD,"./reincarnationFish.md":kD,"./remake/installGuide.md":CD,"./remake/supportedPlatforms.md":PD,"./safari.md":ED,"./springs.md":TD,"./switches.md":MD,"./swopKey.md":RD,"./teleportBack.md":ID,"./teleports.md":jD,"./theEmperorsGuardian.md":OD,"./theGame.md":ND}),$i={historyOfTheBlacktoothEmpire:qe["./historyOfTheBlacktoothEmpire.md"],theGame:qe["./theGame.md"],egyptus:qe["./egyptus.md"],penitentiary:qe["./penitentiary.md"],safari:qe["./safari.md"],bookWorld:qe["./bookWorld.md"],blacktooth:qe["./blacktooth.md"],head:qe["./head.md"],heels:qe["./heels.md"],reincarnationFish:qe["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:qe["./cuddlyStuffedWhiteRabbits.md"],hooter:qe["./hooter.md"],doughnuts:qe["./doughnuts.md"],bag:qe["./bag.md"],crowns:qe["./crowns.md"],teleports:qe["./teleports.md"],springs:qe["./springs.md"],switches:qe["./switches.md"],conveyorBelts:qe["./conveyorBelts.md"],hushPuppies:qe["./hushPuppies.md"],theEmperorsGuardian:qe["./theEmperorsGuardian.md"],swopKey:qe["./swopKey.md"],hintsAndTips:qe["./hintsAndTips.md"],credits:qe["./credits.md"],installGuide:qe["./remake/installGuide.md"]},zD={...$i,teleportBack:qe["./teleportBack.md"]},BD=/^##\s+(.*)$/m,Zh=t=>{const e=t.match(BD);if(e===null)return"no title found";const[,r]=e;return r},Du=t=>{const e=t.source==="manual"?zD[t.pageName]:t.markdown,r=tw(),s=Y(n=>{const{openMenus:i}=n.gameMenus;return i.some(o=>o.menuId==="readTheManual")});return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:z(mt)}),d.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed text-shadow zx:text-zxWhite !gap-y-0 py-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack ",dialogId:t.dialogId,children:[d.jsx(mr,{className:"pl-1 mobile:px-3 ",path:s?["Manual"]:[]}),d.jsx("div",{className:at("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 pt-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan mobile:px-3"),ref:r,onClick:z(mt),children:d.jsx(pe,{markdown:e})})]})]})},mw=t=>{t.reincarnateFrom(le.getState().gameMenus.gameInPlay.reincarnationPoint),le.dispatch(nf())},DD="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",FD=()=>{const t=Dn();return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-midRed zx:bg-zxYellow"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed px-1",dialogId:"offerReincarnation",children:[d.jsx(j,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),d.jsx(pe,{markdown:DD,className:"text-redShadow zx:text-zxWhite"}),d.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[d.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{mw(t)}}),d.jsx(L,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:z(sf,{offerReincarnation:!1})})]})]})]})},LD="Play at the original **1x** speed, **1.2x (default)** or faster **1.5x** or **2x** speeds",UD=`**Off**: Start with *8 lives*

Extra life rabbits spread thinly through the game`,$D=`**On**: *Live forever*

Extra life rabbits have no effect`,HD="*Select the keys* and other input settings",GD=`##Cheats

Magazines used to print memory locations to *poke* values into so that readers could modify their games; usually to cheat.
                  
A true hero leaves these **off**! Then again, do modern gamers even know what lives are?`,WD=()=>{const t=Y(CV);return d.jsx(ze,{children:d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"modernisationOptions",children:[d.jsx(mr,{path:["Options"],className:Jn}),d.jsx("div",{className:Xn,children:d.jsxs(Ee,{className:"gap-y-half",children:[d.jsx(L,{hintInline:!0,id:"controlOptions",label:"Controls",verticalAlignItemsCentre:!0,className:"sprites-double-height",onSelect:z(ot,"controlOptions"),opensSubMenu:!0,hint:d.jsx(pe,{className:ke,markdown:HD}),leader:d.jsx("span",{className:`${xe} sprite texture-joystick_whole sprites-normal-height zx:sprite-revert-to-white`})}),d.jsx(L,{hintInline:!0,id:"sound",label:"Sounds",className:"sprites-double-height",verticalAlignItemsCentre:!0,onSelect:z(ot,"sound"),opensSubMenu:!0,hint:d.jsx(pe,{className:ke,markdown:"Footsteps getting annoying?"})}),d.jsx(L,{hintInline:!0,id:"display",label:"Display",className:"sprites-double-height",verticalAlignItemsCentre:!0,onSelect:z(ot,"displayOptions"),opensSubMenu:!0,hint:d.jsx(pe,{className:ke,markdown:"Change how the game looks"})}),d.jsx(L,{hintInline:!0,id:"gameSpeed",label:"Game Speed",className:"sprites-double-height",valueElement:d.jsx(Sf,{className:"ml-auto",values:Eh,valueLabels:Eh.map(e=>`${e}`),value:Y(Xd)}),onSelect:z(MM,void 0),hint:d.jsx(pe,{className:ke,markdown:LD}),verticalAlignItemsCentre:!0}),d.jsx("div",{className:"col-span-3 pb-1",children:d.jsx(pe,{markdown:GD,className:ke})}),d.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"livesModel",verticalAlignItemsCentre:!0,label:" Lives Poke",leader:d.jsx("span",{className:`${xe} sprite texture-whiteRabbit sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(pe,{className:ke,markdown:t?$D:UD}),valueElement:d.jsx(Yr,{className:"ml-auto",value:t}),onSelect:z(Jt,{path:"infiniteLivesPoke"}),disabled:kn()}),d.jsx(L,{hintInline:!0,leader:d.jsx("span",{className:`${xe} sprite texture-doughnuts sprites-normal-height zx:sprite-revert-to-white`}),className:"sprites-double-height",verticalAlignItemsCentre:!0,id:"infiniteDoughnutsPoke",label:" Doughnuts Poke",valueElement:d.jsx(Yr,{className:"ml-auto",value:Y(PV)}),onSelect:z(Jt,{path:"infiniteDoughnutsPoke"}),disabled:kn()}),d.jsx(Kl,{})]})})]})})},_y="sprite texture-crown_blacktooth zx:texture-crown_uncolourised zx:sprite-tinted zx:text-zxYellow",YD=()=>d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-pureBlack zx:bg-zxBlack"}),d.jsx(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:z(mt),dialogId:"proclaimEmperor",children:d.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[d.jsxs("div",{className:"flex gap-7",children:[d.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[d.jsx("span",{className:_y}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),d.jsxs("div",{className:"flex flex-col items-center me-1",children:[d.jsx("span",{className:_y}),d.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-heels_idle_towards hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),d.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[d.jsx(j,{children:"The people salute your heroism"}),d.jsx(j,{children:"and proclaim you"})]}),d.jsx(j,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),d.jsx(Ee,{className:"hidden",children:d.jsx(Ro,{})})]})})]}),gw=({className:t})=>d.jsx("div",{className:at("contents",t),children:d.jsx(Ul.Placeholder,{})}),QD=()=>{const t=Y(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0),e=Dn();return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-midRed zx:bg-zxYellowDimmed"}),d.jsx(Se,{className:"bg-white zx:bg-zxRedDimmed px-1",dialogId:"quitGameConfirm",children:d.jsx(Ul.Provider,{children:d.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[d.jsx(j,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the Game?"}),d.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 resHandheld:!gap-y-1",children:[d.jsx(L,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",className:"selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",leader:d.jsx("span",{className:`${xe} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:z(mt),hint:"Back to the game",verticalAlignItemsCentre:!0}),t&&d.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",className:"selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxBlue",leader:d.jsx("span",{className:`${xe} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>mw(e),hint:d.jsx(pe,{className:"zx:[&_.strong]:text-zxYellow",markdown:"Go back and continue from the last **Reincarnation Fish** you ate"}),verticalAlignItemsCentre:!0}),d.jsx(L,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",className:"selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow",onSelect:z(sf,{offerReincarnation:!1}),leader:d.jsx("span",{className:`${xe} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(pe,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"}),verticalAlignItemsCentre:!0})]}),d.jsx(gw,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},KD=({pageName:t})=>{const e=$i[t],r=Zh(e),s=pt()==="desktop";return d.jsx(L,{id:`markdown/${t}`,label:r,onSelect:z(ot,`markdown/${t}`),doubleHeightWhenFocussed:s,opensSubMenu:!0})},XD=Object.keys($i).sort((t,e)=>Zh($i[t]).localeCompare(Zh($i[e]))),JD=()=>d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-midGrey zx:bg-zxCyan",onClick:z(mt)}),d.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-min text-redShadow zx:text-zxWhite !gap-y-0 py-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack ",dialogId:"readTheManual",children:[d.jsx(mr,{className:"pl-1 mobile:px-3 "}),d.jsxs("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed mobile:px-3 ",children:[d.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[d.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),d.jsx(j,{className:"sprites-double-height mx-1",children:"Read the manual"}),d.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),d.jsxs(Ee,{children:[[...XD.map(t=>d.jsx(KD,{pageName:t},t))],d.jsx(Kl,{})]})]})]})]}),ZD=()=>d.jsx(ze,{children:d.jsxs(Se,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:z(mt),dialogId:"reincarnatedRestart",children:[d.jsx(j,{className:`${ae} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You dont go towards the light"}),d.jsx(j,{className:`${ae} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),d.jsx(j,{className:`${ae} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),d.jsx(j,{className:`${ae} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),d.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),d.jsx(Ee,{className:"hidden",children:d.jsx(Ro,{})})]})}),bi=94e3,Sy=(t,e,r)=>t*160+e*1e4+r*1e4,eF=[{upToProportion:8e3/bi,label:"beginner"},{upToProportion:2e4/bi,label:"novice"},{upToProportion:3e4/bi,label:"spy"},{upToProportion:55e3/bi,label:"master-spy"},{upToProportion:84e3/bi,label:"hero"},{upToProportion:1,label:"liberator"},{upToProportion:1/0,label:"completionist"}],tF=(t,e)=>{const r=t/e;for(const{upToProportion:s,label:n}of eF)if(r<s)return n;return"completionist"},rF=_l(({gameMenus:{gameInPlay:{freeCharacters:t}}})=>t,t=>Object.keys(t)),sF=()=>{const t=MV(),e=Y(aM),r=Y(({gameMenus:{gameInPlay:{roomsExplored:l}}})=>Zu(Fe(jr(l)))),s=Y(rF),n=Sy(r,e,s.length),i=Zu(Px(t.rooms)),o=Sy(i,5,2),a=tF(n,o);return d.jsxs(d.Fragment,{children:[d.jsx(zq,{noSubtitle:!0,className:"resHandheld:hidden"}),d.jsx(j,{classnameCycle:ur,className:"mt-1 resHandheld:mt-3 block text-center mx-auto sprites-double-height sprites-uppercase",children:a}),d.jsxs("div",{className:`contents ${ae}`,children:[d.jsxs(j,{className:"mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",n.toLocaleString()]}),d.jsx("div",{className:"mt-1",children:s.map(l=>d.jsxs("span",{className:"block text-center mx-auto text-lightGrey zx:text-zxYellow",children:[l==="head"?d.jsx(j,{className:"text-metallicBlue zx:text-zxBlue",children:"Head"}):d.jsx(j,{className:"text-pink zx:text-zxWhite",children:"Heels"}),d.jsx(j,{children:" is"}),d.jsx(j,{classnameCycle:ur,children:" free"})]},l))}),d.jsxs(j,{className:"mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",i," rooms"," ",`(${(100*r/i).toFixed(1)}%)`]}),d.jsxs(j,{className:"mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),d.jsx(Ee,{className:"hidden",children:d.jsx(Ro,{})})]})]})},nF=()=>d.jsx(ze,{children:d.jsxs(v.Suspense,{fallback:d.jsxs(d.Fragment,{children:[d.jsx(gt,{className:"bg-metallicBlue zx:bg-zxCyan"}),d.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[d.jsx(gt,{className:"bg-metallicBlue zx:bg-zxCyan"}),d.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:z(mt),dialogId:"score",children:d.jsx(sF,{})})]})}),iF=()=>{const t=Y(hM),e=Y(dM);return d.jsxs(Se,{fullScreen:!0,className:Kn,dialogId:"sound",children:[d.jsx(mr,{path:["Options","Sounds"],className:Jn}),d.jsx("div",{className:Xn,children:d.jsxs(Ee,{children:[d.jsx(L,{className:"sprites-double-height",id:"mute",label:"Mute",valueElement:d.jsx(Yr,{value:t}),verticalAlignItemsCentre:!0,onSelect:z(Jt,{path:"soundSettings.mute"})}),d.jsx(L,{className:"sprites-double-height",id:"footsteps",label:"Footstep sounds",valueElement:d.jsx(Yr,{value:!t&&!e}),verticalAlignItemsCentre:!0,onSelect:z(Jt,{path:"soundSettings.noFootsteps"}),disabled:t}),d.jsx(Kl,{})]})})]})},oF=`##*HohEd * the Level Editor
I built an *editor* so I could make the **sequel levels**

![](texture-headlessBase?float-left)**Make puzzles**!

*Challenge* others to **solve them**!

**In beta**; expect *crashes* and *confusion*!`,aF=()=>{const t=v.useCallback(()=>{window.location.href="/editor/"},[]);return d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-pureBlack zx:bg-zxBlack",onClick:z(mt)}),d.jsx(Se,{className:"bg-shadowHalfbrite zx:bg-zxBlack px-1 py-0",dialogId:"sureWantEditor",children:d.jsx(Ul.Provider,{children:d.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[Na()&&d.jsx(JV,{className:"text-midGrey zx:text-zxWhite"}),d.jsx("div",{children:d.jsx(pe,{className:"text-midGrey zx:text-zxWhite",markdown:oF})}),d.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[d.jsx(L,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),Na()||d.jsx(Ro,{customLabel:"Im scared, go back"})]}),Na()||d.jsx(gw,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},lF="2924c962-99f1-4dd2-9b9c-fef832dc991b",cF=t=>d.jsxs(ze,{children:[d.jsx(gt,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:z(mt)}),d.jsxs(Se,{fullScreen:!0,className:"bg-metallicBlueHalfbrite zx:text-zxCyan text-highlightBeige selectedMenuItem:text-white zx:bg-zxRed gap-y-2 resHandheld:gap-y-1",dialogId:"whichGame",children:[d.jsx(mr,{path:["Select which game"],className:"mobile:px-4"}),d.jsx("div",{className:"flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-lightGrey scrollbar-track-metallicBlueHalfbrite zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3 ",children:d.jsxs(Ee,{className:"gap-y-1",children:[d.jsx(L,{className:"sprites-double-height",id:"originalGame",label:"Original Remastered",hintInline:!0,onSelect:z(oo,{campaignLocator:Mz}),leader:d.jsx("span",{className:`${xe} sprite texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(pe,{className:Fa,markdown:"*Remaster* of the **300-some** rooms from the original game, lightly updated for modern play"})}),d.jsx(L,{id:"remake",label:"38 Years Later",className:"sprites-double-height",hintInline:!0,onSelect:z(oo,{campaignLocator:{userId:lF,campaignName:"sequel",version:-1}}),leader:d.jsx("span",{className:`${xe} sprite texture-heels_standing_right selectedMenuItem:texture-animated-heels_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(pe,{className:Fa,markdown:"*Unofficial sequel* - the empire is back! All-new levels designed for the remake. **Work in progress!**"})}),d.jsx(L,{id:"community",label:"Community contributed",className:"sprites-double-height",hintInline:!0,onSelect:z(ot,"communityGames"),opensSubMenu:!0,leader:d.jsx("span",{className:`${xe} sprite texture-charles_right sprites-normal-height zx:sprite-revert-to-white`}),hint:d.jsx(pe,{className:Fa,markdown:"Check out what people have made in the editor"})})]})})]})]}),uF=t=>t.startsWith("markdown/"),hF=t=>{const e=Y(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(uF(e.menuId)){if(e.menuId==="markdown/inline")return d.jsx(Du,{source:"inline",markdown:e.menuParam.markdown,dialogId:"markdown/inline"});{const r=e.menuId.slice(9);return d.jsx(Du,{source:"manual",pageName:r,dialogId:e.menuId})}}switch(e.menuId){case"communityGames":return d.jsx($I,{});case"controlOptions":return d.jsx(kN,{});case"crowns":return d.jsx(TN,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return d.jsx(ON,{});case"errorCaught":return d.jsx(FN,{errors:e.menuParam});case"hold":return d.jsx(LN,{});case"inputPreset":return d.jsx($N,{});case"installGuide":return d.jsx(Du,{source:"manual",pageName:"installGuide",dialogId:"installGuide"});case"mainMenu":return d.jsx(ZN,{});case"map":return d.jsx(uD,{});case"modernisationOptions":return d.jsx(WD,{});case"offerReincarnation":return d.jsx(FD,{});case"proclaimEmperor":return d.jsx(YD,{});case"quitGameConfirm":return d.jsx(QD,{});case"readTheManual":return d.jsx(JD,{});case"reincarnatedRestart":return d.jsx(ZD,{});case"score":return d.jsx(nF,{});case"displayOptions":return d.jsx(IN,{});case"sound":return d.jsx(iF,{});case"sureWantEditor":return d.jsx(aF,{});case"whichGame":return d.jsx(cF,{});default:return e.menuId,d.jsx(Se,{children:d.jsx(j,{children:`unknown dialog ${e}`})})}},dF=zn(()=>sr(()=>import("./gameMain-Ah4XAijo.js"),__vite__mapDeps([11,10,12,5,6,9,3,4]))),fF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAARAAALSQBAQEBAQFZWVlZWVmNjY2NjY3FxcXFxcX5+fn5+fomJiYmJiZSUlJSUlJ6enp6enqmpqamptLS0tLS0v7+/v7+/ysrKysrK1NTU1NTU39/f39/f6urq6urq9fX19fX1//////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAZAQQABuAAAC0mIpRnOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABGwBW7QAACH6lCs/NvBI1AAbSkgF4ABRZcPlz4Pg+D4IROD74Pn+q3wQ/KOwQOQQBAMAAOJTDmiIJGRsnW4gAAAAGHBw0GGr6h1QsZCJmtI5hYgmsYoAR0Ag4JBUuUZAsPJMg6JJglclhHUckcsioTqgczgUZ3kIHEq4rEwqNkFsLgn2Y+C3J43WE3Xo9BYGhDDkPxFE+X4CQuplOyOZfBxw0udCrX3zOQVmZoMIXhedAAJChVEEU7wAEGTZdNwgH7mWw5DSFJLPdV2KNnLuOzSTEqBeEAdPlZlTEwHqxNqs1LMcxMM1a1djNU425jGjLFpvdlvuYsfO+n1l+gAR6tolOGFYmwQBCMWKqZ1qMDBIZELiWfE5pVNre897tRKIpRXrvmoG1vegftCy+Kzbj//LZEz9fMoQA2aXZklv4AAYkhwMhQNKHAIx0Fw6iMOQxEpgKZZPRYJ8qBGb7ZHoZqcMofVh2ktwoGiAkzC8VF9v2AAkLDsqNzd5lQAV49Xg4qgYi4La1Xx8Tg0zFyPZIkpbTT7GNSxffKqESjUh0B0DZvlpu/0wBWqpZVsm4AAVjWOro4yB/tqpNY8ZjQNFXPky40t8krDdfZpDHvm58XRUg0XCIpf4nF7nTcVfLwQBXeXdXlvCymVErYmUA1UDNKRHROOh7OHcKWss9aNWDMxPfS5VDJocqMY8plQWcUpemgAGiJhlSS8AABLZawwON1FlnaA2kBuSB6H4eRSYmC0sEFJ6AoX2k5armpKStllLC7mA2Ui/iAAsTEyzX/hw2PKNiagjPDYWlUyDk62rR+41nJr50i0hS0p5W1D/+1DE3YBJfKlV/ZQAKOYGqrWNMBWNB1CoYU2F1bm1AEiIiHeP/wAAGeu00cmu3GAFjOSBwqEpNHHeS+xC60FPuHFcS+ddde3vq92QACKzvDvtwGIfpxBPjpjH+mmJx5JgBEY8FLXit5bva+ElTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVEBiZgJkAAAAFhBRpzk2oF9X2Vys7kT6VmBXM0AAAqVgiMgd0ljw7xocqTEFNRTMuMTAwqqqqqqqqqqqq//sgxPgAR1RxXeywY2jRjir9lIldqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoQSXcAAAAAADsYgVwgUZnVIPsgaXAKRyFrIA7uFp1MQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7IMT3AEcIR1PsvMMoyQ5p/ZYMdVVVVVVVVVVVVVVVVVVVVVUiUAAABiblGtCRdQPwAdAVA2HQVHNLqkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqhPQAAAO8d7/+yDE+ABGtHNJ7LBlKLsNKX2GDHRUNQVKqAeAFALgMUhOTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIoAAABVRRqMgKxqApRNAYEQONA1MQU1FMy4xMDBVVVVV//sQxPwARZQhSewwZmiDgmj894QUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUwAAABgK0HQWBEQADnZgKHRLExBTUUzLjEwMKqqqqr/+xDE6wDDBBlNxj2AYEQCajjEsAWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIgAAACRH2BRkK4jAAqJ6MYhqTEFNRTMuMTAwqqqqqv/7EMTlAcJAEUnGMeAoLoJpuLYEFKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqjQAAABWHpJWVawACtQ6Yp1MQU1FMy4xMDBVVVVV//sQxOGBwWQNQoY9YCAsAihQxawEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWAAAAoBIFQJYcX1UxBTUUzLjEwMFVVVVX/+xDE4AHBgA1Ah72AKB8BaJDGLARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVXCAQAAAAAA4GyRY0NlTjf/5362Fc93KTEFNRTMuMTAwqqqqqv/7EMTgAcE0Cz6HvMAgKQGn0PYkBaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN8BwTQLOQesQCAhAaeQ9IgEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE3wHBRA04h6RAIB2BZxC2CASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTeAcEoCTEGPAAoGYFmIMeEBKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNuBwPAHKqYcACgMASVCkgAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE4YACzBk0mYAAAAAAP8OAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",pF="/assets/bonus-CvVo342Z.mp3",mF="/assets/bubblesLoop-B_LY362Z.mp3",gF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAHAAAH8ABjY2NjY2NjY2NjY2NjY5SUlJSUlJSUlJSUlJSUsbGxsbGxsbGxsbGxsbHKysrKysrKysrKysrKysre3t7e3t7e3t7e3t7e3u/v7+/v7+/v7+/v7+/v//////////////////8AAAAeTEFNRTMuMTAwBJwAAAAAAAAAABUgJANtQQABrgAAB/B6uTQrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABAgDT7QAACIImOq/MPAAEJBsURDiAAEUBBwIGMEwfNqOB/lKwffKBj+IMoCGJwQmJJWiaVAVBQwskybYBAAAY8mQzeGmHtSaXBy2yKgEkRsibBi3wOGaBGYZPx1okZ53oIk5dk6cA9RSxkJaXahNQ5C2F5WklAbHyfUx3rZ5LKsYXJdSNdDHVLu8B46uyn6pE8OmLHm2qGNUQocvvmmHVL0zvzqW0eHCeeUsxUlA7P39Cs1jJVY1EKWbbhgiQiX6wiPAWU1AApZk08REEoTmCh652bI4C8N40VsJMQ1DzqOd+1+bL/MjxkORqViL86shsxVl2KsI2ujQVC87XDhZD0E4qdOqU/1fRcPNsiseRoFbP2yumR2kY0djbG0v7Q3PLPIbWoFZl/IqHGSSmn8JgeQbVlzBjyNcfeK4s4RY2bV1W1Ib+Pv/w/TGqatTeX7fmABrK38xETIRACEm3QE0SFLFuVZRMgtCqisKyoZ3kin58iaOSqIculpxtPd/6cTf+ktz3OnvyLDKbeX/16pF6d8IUGHQEPNlVOYTkko66Jxhgqq/L1XpkDJTQxJSKToCx1QZCJDQqD0CFk5RtERSkojVt06ns8pWEc1O6g9RT2I5nKGUghNIgm+mzNBN0GBa20LmURYs3dopwomTPuxfMt73nElqpyrtc1Z1RRAaSkwHbB6wSLikGUSIqSnEStIhkahAz2KXOxV1nb8I+CapoNFnlRERljohLG2rOsfbiJYiAKxqBeMERZ8aVro6yTUsJWxUwu53Z5ljBNROQARCYAqDhVkGSgUHkJ5BMUisnaT7gquejBTI4OAAbJv/+3DE3QAURTlh/YeACUYZLrzzDcwliqC4mNiJQCfDS99qMbryA54qW+ii7ZkZlQyBkl9AZnNMB8NAOicSzNKZa+FGAdr+ovEOMbBe9dq3FX7cRbm1DRvLBeSLXdP//9RpjHQzxTdJfo//3QuAKGZzEJy7AAiURgPywUWFIjNsJzXIESDEAphNO0z2YiwwFl3XoCpyhR4RmnnWHzxG0Ywcm59YlMF82DSZw7EogqSAAWuISoVDyEuRLIxThCiircUsheFPYaYG86iSivs+K/XIoyviu+zGnf//zi5MQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqgJZq8BUKgi+IweMHBVwVsI1BWeBaJXdSxgdlXc7LUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVV//tAxPUACiEtdeSEWWEyjO38FIw0VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+zDE9oAHuE1p5JhqoP+GK/yGGJlVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+yDE+wAHdFNd4CRBwNEGKjwApAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOUDw7wXOQABIEAAAD/AAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+AAAAIAAAP8AAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",AF="/assets/conveyorLoop-CF-OA6qJ.mp3",yF="/assets/conveyorStart-CcCK4MGd.mp3",xF="/assets/conveyorStop-D5zeg8cv.mp3",bF="/assets/destroy-CZDN4Ktz.mp3",VF="/assets/detect-D_kRR5uD.mp3",qF="data:audio/mpeg;base64,SUQzAwAAAAABZlRZRVIAAAALAAAAMjAxOS0wNy0yMlREUkMAAAALAAAAMjAxOS0wNy0yMlRJVDIAAAARAAAASGl0IEdsYXNzIEJvdHRsZVRBTEIAAAAlAAAAR2xhc3MgRXNzZW50aWFscyBmb3IgU291bmQgRGVzaWduZXJzVFJDSwAAAAQAAAA3OTdDT01NAAAAKAAAAAAAAABIaXR0aW5nIEdsYXNzIEJvdHRsZSwgU2luZ2xlLCBDbGlua0NPTU0AAAAoAAAAWFhYAEhpdHRpbmcgR2xhc3MgQm90dGxlLCBTaW5nbGUsIENsaW5r//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAOAAAJ3QBLS0tLS0tLZWVlZWVlZXR0dHR0dHSBgYGBgYGBjo6Ojo6Ojpqampqampqnp6enp6entLS0tLS0tLTAwMDAwMDAzc3Nzc3Nzdra2tra2trm5ubm5ubm8/Pz8/Pz8/////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAXAQQABuAAACd1hx+LLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAAA5wBYfQAACIEmGp/N6ABmZYgAzErrwAAAfB8cQKLB83lwfD5c+X6w/BM/y8XQAAAAAAABkLQ3wlAAAAEQCwAwww0+WFa3dKgv4UAX3JSIKgDXzlh5HA2onSwloqV6WFcNjBcHO5I/A2nao/IO7QNDrL5DEV7sGilCECu5N2ZdD6x5VWsTCGjFa9mHHFiEu5P37Hf9oTWJXUhuJbi0f3jf/////Kx/6w1IqXWNbDPhkACAABbeAAglG0QILxOnB7jM6izYniEZDiombEIbu2UDNAsCoiDAR8RMrHzFdtSTKSlIhwndIvEFQJoni8dPVGKK060UeUVmT39aE/l8mXwVKPLZsuYARADU+sYvG5LsvtYZ1nAN6GjBlThtPbQ41qaNRKnLBREVTK3U1235+UqDZrLmni127D6GP7hQP7esoGjUNUiyqt5YQVQCibgADqFMeHg1YBC+v1Uf8WImfCX2fb7uOELxKpF7Zo0YMEJXiHq9QV1GuBcuGQ1oIy1R5Yyaq4EFYAiXvMoZmtw887IpW1j30JKl6XVIj/aMvP6BTW7aIDIRXh8oxbkyFCdKLvuxAmEf7gAACUdZaUJZc/MUygMRlgX4rXomhjhgAI61iUMeob/9VyliVmmGAHcGncdaLpwYClXWFmpAllZeRCMRufXVZ9fSZpuIF6SzMlVALqhB5WdwAAAKqjzk1H9osoBA0+eS2xDa9B7PvtMmf9YBVVYZdVwAMnzjOLOixgcJ+o4iHkTm4Ghzqw+dUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVQC6tguqngAAACpVR4j+BDEUApT/+1DE34BKpKlb/YkAIQkVa32VnlRNmgn05U6qyId3/pItAN3GDc4OCrmmUNA+BOcus1KXqDolTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAJiVCAgAAACCtZrSkAaFXbQN8xwByrKrBKAC3GVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUAWg0A//sgxPEAR1hjU+ZgpaC5CGo9l5WUPFJEWDoMAGAGAMAKSkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoEAAWFJYIvgAC3XiY3TEFNRTMuMTAwqqqqqv/7EMTzAMVIXVvg4QNgk4hpOBykZKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoAMAAAg8N5aA1MQU1FMy4xMDCqqqqq//sQxPSARBQ/T+BhIyBviCq8B6hsqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpRlYUFXUxBTUUzLjEwMFVVVVX/+xDE8IDEAEFT4D0jYFMGK7gEoG1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUF9aTEFNRTMuMTAwqqqqqv/7EMTkgMIYG0/ACYJgMQOo0AQsXaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN6AwTwdQIAFZGgaA6jgACQeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjEwMKqqqqr/+xDE3IHA5B82oAGA8BeDp1AAPByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTag8D4HTUAKeggBQNmQAAcJKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNiDwFAdKACB4SAJg6WAECQkqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE14PALBsuAIBBIAUAZoAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA/wAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNYDwAAB/gAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",wF="/assets/headFall-rxdxTCeK.mp3",vF="/assets/headJump-GCHlCfni.mp3",_F="/assets/headWalk-B5kQ4tvC.mp3",SF="/assets/heelsFall-IsGtipMw.mp3",kF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAANvQA8PDw8PDw8PFFRUVFRUVFRYGBgYGBgYGBtbW1tbW1tbW2Dg4ODg4ODg5SUlJSUlJSUpaWlpaWlpaWltra2tra2trbFxcXFxcXFxeTk5OTk5OTk5PX19fX19fX1//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAP3QQABuAAADb3ce6y6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBabQAACL+Jyq/M5AAAATd0rslm3BwuD4PvKAgCEMYIAmD4Pg+fiAEDivB//BB2CYP8EPlHQfB8PygIfUcwfD+CAYAAU4EERahmVG1qTLSTRQACHQxwMcMsQaNBDJykQAnheOVsEjpbtBSluhY8aLnhkR3SqInu5pvluoCGSNeIPEP7PIsMVAof8vqJIx+WjoAGziDvEiannoTqQJv+0KPDobqTKkIbRlSwicofK9BcD9jj2flFuRxqG4IZpVoIx+cf3jH3bymJbbxuRDmnwwrxLmpba+3O/ErHaWc5hR9j1FX+EfSxTtJf5Xw7U3zPLtX93P13n8q0H8rc1fcf/2L9C1KBFc4gxM3ZCYJmGinxCyQF6IUdQ+jRISyQlcGwEOLFUWAlRJGCxiiZGykUUUVOsZRsxqgbLdYXQljEukqSpKi1RH0CbCYiMlaKRuVF4rBUmhlRRMaI9x4osiymzPfWyRkizL17nqukpI37b1Ge+cSSMm1qSMlXb1mySRvqU6jZJX5hhAoPEGrCrl7RMBc4xmIkmS2dx0kvlSGcyItAQ7CyS/Im6bufIFqiY2tBakdJ/EMFq2Y8EqwmDkowf3YIWW1NR58qp/W7OkvEWr123iWK4i96wY5eleVa7basASy6Q4hZ3I4etRFgbWA2XHZiHG+y+QF2HYI4TiV1JEWkxrXwwxLraLURInnGvIxrj7qZAZf79rQT06eVSprKvhjzbStl/25YYBkc4lld1tgADlzyqygh+XOi5b8cqWXJOiCP7izoTNBbakKzalazLiaPx0MIQUFDj5qZnDbNvW2IU+d2jMC5bmOa8HfWbaEuoX7/ofcHaTKCaoIKVk2lFU+TQADpM9RDdyAlEXAlK6OnRKRHINRFtwMUFl3Ww9da+P2qv+f9wJyyJoxE4yTEFEzrrqIhw+nan+4Rr4+fSdsUW2CB/VrcgGS3iLl3+/+YAKdlIf/+2DE6IAQdVFb/PaAKUGVLDz0HfSlDIIgrA4H92yr5cAuKkFkhW7a1rZDWricNKm+oQmq25qlRr91S79meUexMW6rst5aLH/u71fzQAASKHmP0cFUb7VH5vUUppI9RQrVs0alF94d2ECivnfDHRKkw9EiSy+l0e9T0ZWd9/+VdAkigRcGdFAl0okAoEAYAGo0SOObDj4QAiD0ej4AgBlyt9sGDiq7XKjYyg9chwAXABM+F9A2wiAZ2BFwwv6A8DLkTGIKBDZQJ/qw48QoSwtg54XyHPC5AKQRD8+M2TQ4BKBASSJMTwOk2E8/zcn0jQuNEZFAQmFpEaFknP+ybn0GZOVxKBb/+0DE9oAKEM1b56BxoUaZ6j2HoHzIsM2LgLJoOP/+yC001MhOmyJkTpkiXjUC/9Px8VpHYGaDBR8uiAKF8r1kDRHDX4oVTRp+YZj9/B+amUqE46DOi2iMgeRvJRI0UbIol0GwSzzNFnNjzwVsLijM2QdMjvDbESjW1pamwzi0XV5/MiX/mmkX/6G5mv9B8w8lZyVnElvL/WTmDRAgheNxEAEpQIGsN80TuDtnMlnLCfqHrw9W6v/7MMT1gAmoqUvsMWkg9hKqfPYcfN6tr/F+M71h8j3JG2a6y9rzqELFmDWmPrNcwiQ3x9Yx5d7yYJeaTwdV93Lez9HjRkfpuBZ9+T4gf8k+Ofwyb/wZcF/jSPK0VRZQmIIVTzbNFgy35L0whBPTi0mVYsmen3JU+67Wsf3+vqmmtSMcfb6BjyXvzl3rN6V+dzRCgGviO9U/CAFSYf/7YMTzgAcggUW1gYAijidqvzUgQMuLnVQWVPiV9H5VjRT+l4F/loQ7f2y/1//HSPI0C6Arwaur2vcIA1LBQ1CmHEbm/92uTTvv7VilrsRcXsK1podo2HzUrH28/H2+s2xDoV7j4OrbvFiq45nCusWz8+uDvOmIzTwab00QnIdiifcX+1rm//wUyqAZ+Y55mmFp3cW+r60EQodkND92jYAHly9vYGehmTdM7jmwO2uF1uEPasNO/xbMbdfbC2q3jC4RpNQZtty5YosXMHWHuWZnGnLj3xjbbDzokInKmkiNVQwC2u+qOiCn+WaVJAHULvSc1/1e5YSQGimpk5emQAJmsIhLFf/7UMT9AAytA2H9hoAhkyVrfPOLzJ5Dq4L0DQ7J62Vxt8JluDcoVZzyxqZ/vK7D0v3Vy3vmW98ZlT8pHDMyplRSBo1RDRa19VLISV72ThYEndXbNx8RnOPmsqocxH+YuO3/+Q5K3pUdP/A++awgAFaY1HlRQE1pyZC4MNyGrFsX1Rk4g8uOQDy8migDCo2qNSQJkdzViTxUPc1as8PHZeyNmD329Pyw+W2dr28AAACXPUDhVn4l8Krv/KY7A1uJOFqxOElu6aP/XB4yPrLtiJn/+1DE9QALhSth56y6YZKdKr2HofzIIFy1rTeWqGGuSgIXr6P3ff/22dn/6/QqeAmgqWaTeECCoYEAIAAAAFx64msnKFFjiqafYSTbc7jgMvUbJcvn2WWYebpAZ1KBr1dlseUBqw4bKBhRfoGjmgWVgZAIGFBc/f8G5geoRACwMPQ//C6gWcHqE4JzEYf/44BZZsaDliC4yf//5qQMiYsggh4Zgihp///5EzhcK9Zd///B8PA+CAADH////0gRAAPWKgvFMiPaNosABEAHoAl0//tQxPIAC+TRTew9TeGBnWi9hJ8MSKp0muQGavaZwAYYcqcx4NWwzRUyBVtEChJaWRYSccwPwYGPXRGDgriBR0rsBHi4miGPAaDyCpmAyZmwBGiik74hC1I0kNEgq0+y0YFAQVFhpSX9SsFcooM3eyd5LciIoQXmEASMEoABlYV0/ADR1PU+P0cRUY/SZLkBAmw2bgB3uSmFZaoKeSPi/FXCCp1cESzkj+R2rWhqnz5q9Tf+qb/1yd39yD3Qy+MyyNy2rlF9Svf8nZnuvqXrH//7QMTvgAf0oUesNKzhBg3n9rCwBPq3U//3dpu3LwPSVTb6tbitOoA2ukN5JkSUlAYEHAkImfuZKXlcalg2WtxgSRyynjiOaVCSKxNdDDxfaS3FUFgWr/1qggwvnORt7jEkVEEK3/fkP/u2Vb/ouhP9cs7yMQ/PWeppkGmHU1dd1YgNOQoHEnhLKEyJ4q2cuajZ1ezv45cQpiPGANEEFppumtSaaA7BL2rOpvbQ4sUXetNNabGJ//uAxP8AEdUxU/maAEN8KSq/NbIAoaDkBwDWbz5s6epY8E1piGSZRghd6ytqAzpb/qd0zMna/6HX/6noGC9vzqDiKkYFYKYBUCQBUFBAGAwAAADvUU0NTsnI/zOjRFNNZI7/EV6cC3lMf9MQEvCS4LEcRMLC6P3JYepIl0TIdxfC6+XhxDGNZNJUT4yNvuXR7D2TOf/pGJqTVP//zpdJFJR1EW/56W2KTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1DE9AAKYOtn/YUAIamnrD6e0AWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sgxPKADKDVUfmWggAAADSDgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",CF="/assets/heelsWalk-Bmk6WOTI.mp3",PF="/assets/helicopter-BYGzJTF2.mp3",EF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAAMtwBBQUFBQUFBQVlZWVlZWVlZbGxsbGxsbGx+fn5+fn5+fn6Pj4+Pj4+Pj6KioqKioqKisrKysrKysrKyxcXFxcXFxcXV1dXV1dXV1ePj4+Pj4+Pj4/b29vb29vb2//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJASdQQABuAAADLeLlBWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBYbQAACJ3neu/MYIARAV1lrd0u4AfKAgGHA+8EAQB8Hwf4gBB2D4fygIO5cHHcH+UDH+oEAQdic/lAQBAHz+BAxoAQBSAwTDAgNkVT1nptAgAY0GGiYh7PCRB7DVx5YfkOOROSqQUSkYfHnOLhrEBoy3a5IOd+kTrUdfJXD4SqC23fdhrDn9VGu+Qt0nmCOG6FaA4Ae1uz4xaWQfGZLemJfSQmknrk/Sbv07+xC9L5HMUtuU1Z2IWbs/K5fqB5uzEpTRT0owszM/3m/13/pM963rffzrw+CDbv8oNBhIDE6rYGQNTY0KMcsuARgjTREBw4Ri4lBZ+m7rPl2FVO9Pq/kQ4BaQPIVXUKQENMSs4tYXKPuiQMhXx8Eia0h0D0uidKzaBOkTmQyhqtjMmzY+qs2ugouvY8esZuYoqRL5s6a2WgiyJcNs6bpJoGR5lMsxVTWpVajya1S+gtkEKa6k3pmakUy2aqnjiVBBJddqmzCMI+j4M53RLH3dr+TYQYGiM7BLic4Eo1vSFBQHNUD7gA7zX+eZpX/cgD8G5e0Aiykc7yJof/8qNc77txu/HHXJpxv1HGzQozYRplB3VRUOpE5BFOINWjpk9L0nTn/SMyKfmfY94QSU9P4JHMjMRbGE+VP+vc3EYseEuQRzpwWcUP1S6128evAlRtUZ2GCGlx9iSNLeJR73naPocpt+dCjFKam+tERuTgd3X1CJg1b+jOpjB+y8U3EeTz+F6hvN7e3v0IdXVj1S27Iys96P1br/29/T7f16yuznaZnRLUY52tV20UJIr14XBsyPEEAbe5M2jVjT0bJYkSst1YAV9QsBlIMsO420Vg3RFs0KkLW0T89yeZ+J6n9/Tze3t0P0Xq/QvX0/6U7ps3t0/vEzK2GAWU5xQGFIs71p31HkDDNVsDTRZJmyrDjWPDvT0PZ0eYWm5QFdneDMKSaLz5v82JA7nkUz/+2DE+QATXVdp/YmAKeew7jzzjuXvVgAmb8f43qGvqIdS+f29/+LdD9X4w5E1botnbanUfp//fSmWaLWXxRdb4Fg7oqyjEC5KUFvVVSNicwizxubAxpbaJEgc4fE0K6beiDOD+eQxEdoE7y3kTbh89FHuyUffVviXPW1On5d0/S6GpvEtT0sozsS7ez7f33VobykDRRNpAA7tweNRCwUpRA8TjHZszi8fHMMpd2wWVP8lndHsHk1AfbUT/Hvv5fRu93uk68hvhupsNwFWcpoZIyodR2duivvqW1DGKbJzwUhHSO8lCcm5RC1A69cnygdbFgWDl+KyHFStDWHLqwBAlUNItbj/+1DE5oAMBZt57LxH6WAlr/2GiTQMep4YoZGdlTlAcef7+WxXdBGt8PVDJN5d0jU+Q83vukqDKnO3SaN9tVs3iZlalUwZIEMiSJgFJ02unBmHeFs3iCULufW9bJig6ZlFPe/gKmS+kPtQEosYaOz4j6UDhepvTpbQf29eD9W4Z0jvUyrbXXtqXTjqPukiTPZURy3A72GCaqjPGzFI8E5tsJme5qpARahVmLv2NwroO9ktPvW6hfpUnoC2q4Ys7wHod8ls5vbq2gRV2Jx3fU3V//tQxOeACdTHf+essmFFje89h6i8LkZughomPzcg5KKXwPs693/8Kmt2K0btqo0bB0xEkpBIzcmxus0lWdT0kc/jYXLy3pPwtc97LrhYFTbzQEq1ig7CFXwhtGdG7mbQP+3VtxL0Tl9S8YLyzpCJP6KnsZRQaUUMKeOKyz1EXLc/WSlYq6+hyIolpBwBHU3ZRac/EQ8hsjZQLw39Gat+9BZgVjNTQXwzN4wUDlLWpdnlGAHNTK+XbkegidC9W4IX0V9m6jcEnt0bovL7+qf5W//7QMT1AAmscXfnoVIBU5HvvYWc9NNbaq7FKMIrPqI1L3KxbX+SqgYAJCViAAC/R5CDjKFMyod7VAJ3owRV6tUkYiFq1LMpdwYgF5UNM+DDSvAqXVTQs2o0U1YufUdbiU/X/ne3Kt0/5zccO/2+/+vufspHUwxTZc5BX7k/8hrVFAggckSAAAu8TzVmHJLlQu6Ro9dwE2f1VIAlvWSReDGSvEKzsoep7UMZJdZNPdN+N1Auo3iv//tQxPQACgzHdeesUKFQGS889QpMtqXp9fN09N5m5fXyFupO6M1TEWYpN6loJG307mHqigcARERIIUjOCbmQrBhghVs8Alr8FwKrW8mCl4uciKnnrwUL7rH9a3lJHW+Kr99wwwNYqoNej9RHQB6k6epOrdH6N0p//K+z9D8j5o3ZmePjKHdDWEAMqCGwQUnwpOQw8q5F1T9KtGfIUKixhTdWStnxrTQ/i4Z1A0/UBpPjZuJvAvP5upeYM3X05VbKnN6fGXp7dX/1+3X6mxINlv/7QMT/AAt4tXfsMLBhXSVuvPOKlDSXnp8LBm5prFKy8ASXKlJrkaq9yDqsE40hao+rGAJISmPYaBjasuyzLBdxYBKDOr5JU3fRuj8L5PL5NVZrba/ty+/QaoN0uUQt3W16KHwYBmlXSRJW8AEXpGg6hBRrB0mdOMovLTXRYw8rWsFkt+9wzCt17HdbQVB6rEQYTIvzPzdH8vl9PL4NtX6N0N0CG5+nxttGdvpqShcCOjZ2y7cA//tQxPYACz0ra+w85eFOpW09honkCvyYY3iQkUX0uU57GJb3KEkarUaAhhO03QDsJObmZfCfjZxxJayme5efo/fr9LWmXmIDcRPtkt8Q7bazoRABQCAQUH8uLYAAAADVy4BE4GkD9DAk+0dUxRax4cC0Njc941/ykiERi5N1kFqSAvTfcJhhS4f4hA61y9QEFSWOlMqpOHkkXAt2FiEUrLIp8Hi1LJ+UjMmViBO5x5HTBikJ5qFjG9Z/+frWv4B4Mgh/3mb//3k7V//99weuKf/7QMT8gAp1K2nnrFEhMaWsvYOJ5NMhHICZLKAAVQEg1BqA04KwNjJawIQlCUTicfLlgYCYGgaUDQNYNA0e8Gg5lgaBVygaBnxKCrsSgqpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//swxP0ACWDJa+w8R+ElHiy884qMqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPYACKyNYfT2gCH6F2o3MPAIqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTxg8csL028wYAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",TF="/assets/hushPuppyVanish-CZOUg83F.mp3",MF="data:audio/mpeg;base64,SUQzAwAAAAABJlRZRVIAAAALAAAAMjAxMC0wMy0xMlREUkMAAAALAAAAMjAxMC0wMy0xMlRJVDIAAAATAAAARGlzYXBwZWFyaW5nIGFjdCAxQ09NTQAAABUAAAAAAAAAd3d3LmJsYXp6bmV0LmNvbUNPTU0AAAAVAAAAWFhYAHd3dy5ibGF6em5ldC5jb21UQ09OAAAAFwAAAFNGWCBwcm9kdWN0aW9uIGVsZW1lbnT/+5BkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYaW5nAAAADwAAAAkAAAzXAEpKSkpKSkpKSkpKYWFhYWFhYWFhYWF5eXl5eXl5eXl5eZCQkJCQkJCQkJCQrKysrKysrKysrKzDw8PDw8PDw8PDw9/f39/f39/f39/f9vb29vb29vb29vb//////////////wAAAChMQU1FMy4xMDAEpQAAAAAAAAAANSAkBqtNAAG4AAAM17UwrB8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+9BkAAACtwDY7QQACj7AGq2ggAFNOH9J+aeAATUMKT8w8AEMl2x223XXYDXgACBOHh4eGCMAAADw8PDwwAAAAADw//0AAAAAB4eHh6QAd/h4eHh4YAAAAIDw8PD0gAACPDw8PDwwAAAAADw8PD0gAAAAgPDw8/AAABARKUssltuoAAp4eHgAAYAAYeHh4eACAAARh4eHjwAAAAADDx/+7wAAAw8P/YAAAAABh4eHjwAAAABGHh4fOAARoKg7m7q6w7fVgAAAAAAGVKJXHUQiRk6oIINAoes5bwJAnhHlxWSwCXhBQ4eYKkPgwBYAjh/EQSIvJdVKdKtimtsHgLcGcQpNLbPBbVFBjQTRQliNKZ1AxndK/MbMEYe///////////1mAojQbrDKzs7a0AAAAAAAB7QJFv27F509ww88gEd4/eNh1yFVTUcCJrEChbRFDkUKUUMJucGNVq023rZFZbsyxDy2QG1zkZoQKMR8sHoBBtNuO78AAAElR0jwLGOESSdqKEepFF9W1Oo451rAyxzhrsgmsz7mnMl0D8i1tkwUVjFzNVCPnf5YRjd4hoDKVyPf4AAASJEoONd/pWjpJ8pLpZp6aT8QEHzBGb0DFf7Q4wE4lEe6McUGC0yHgQTrtuh2bXAAIDG6r9xMwDkvQmgw2IUkUjltYRzNqJIYlSM76znywZCgohD3yXY2XqjBQ6wWPg0GDi4lv7SDBckyAxuy7cKELMpl0jVcWNjXdF684oREQm1IzzVBysxBAYZvB9u478ju+v+kb+t1ACZNdUu+4AEOkhKBm7axdX8Gmw9GBeGbK5SSamYgKsmjRLPttZMyFZ1U+4yxCD6yZEILmJqp7F5FT6JIpmAOSq34AAIebpRB0lUf5c5QGQHz8ioSLPpHVp5C5x+qR5CPRbQ//ERuuky8/jnf0BGEJUt78BQVZzncUifJYTRzMg5z8STzEJDzVlETIKRNS7NXeGx8pmLKI3TMjIGVOgRuxpZvU69awVWAkSjf8AASnYk4DvsrXiFkPJbUwQOdD2PF0tSYVTOpCdis1f6a3ZZ3ETuzFpyvI4lyRjKk0AFGNLv/AAFRFhLJmSoUNFAcIIlhArCocHTs//tgZOkBEewa0+88wAo3Q2p954wBRxBdU6exBWC4h6p09IzdOAPemIppHGks/UH26Xud1aZ9w0aovRKm0/lgzsFRytntsc/wPEARgAFl34AABUD1nUwG7orCEBICgIUGiChKs4wUS4Yxe2/f1gfV/CdaHlge/oz+92AZLa++U3B6DMDOM2CK6ZZzoo/IB/yqVffKmEiTsqSaKKXyM8GLEJEsKMMNOuAw8JRc/LmzyIYM72zERskwE4Sy09vyBSxKzA2w1En4fDTARJQlmi4Ioje5PJR3P3KlQSClMFAQoXnuhs/DOU5ELNIVIc5rvAAAgLu3AATAOolOC/CEl72SNCijGyYA//tgZOuBAd4XVWsMMbgwwnqdPMI9Rxh1VaeYbKDakuo1hIkcIFLhOTmJNFrC9faW29ON3mIP7ZQlkP5uXkU6wQ4o5miMQZp9fQyLSeRk62+lEmgdpgFEVZfgACLCcOcZ6V0+eU0o0guqtj2s0lNaTapUPbHIDcnKk1//e/0uftMYOS4Fn47N2AJQSijL/8ADfA0TkLINJaN8Xc4xkSjXBIlabPkTR5sksFELBPcisaGNdznE18177gRISF6tY7Zxn0pE1fv6te1oH/sMWtwsqb+gABtmKfhJZ1MHyWhRmoXE0w7QGC4IohhpEBl0UXuXY413LLQe6F0Qe7IKlVRvBtchTL+V//tgZO4BEfod1NMMQTowIVqNPSMzR6RfVUw8waDeEiq1hIzlYVIRRae++AAdZFieIeStBCTCu7NA90eEq09CBLmkkaKTjUTY3Xms3lu9/WztuTjBsz+3kPQKO/DQyA+o9bvmZ+mdh/2A+EWZxoubf4AA4C3eITqgthPRnJExAmEb4jgEPC1Q4bSnmEd6lJBw7Kkd5ioUITYeX7Jg1sgEQ5MzsGUE0GTCr/9wAp4VAXcXmsPDIPGtNt32gFzmTShwXkSokUmjaS1NdHH/772KE3LG8aqBYfWIyd4xRD9zuUIRrg5YH0Mb26XktEB5v7d/6AdzkDit34ABsdkgl2JwKUSkUpeS//twZOyAAjwuVNMMGnozJFqqPCODSGxRWaekaqjljys09g1NaWLaY7EfyhhU3aeWJfyt97VaQ6GO4KTZZJSm3OycuQgFEHJ1vSogyRS5t+AEKHoLwLeU6eHUa4blkSQXLANPQia6oxNbKoUtHItxEF57mT0/+f8OlD6acz3HR4hOmV/db5jOOTn/scnAK6SCCk3/ACoJEoQcx3YKI42Ukj5DUahEYwFIsauzFsNku/6+kY8zUFx2w6AFi944gDSQGWNoaOMAPTYRf1HALAKClvwAgkhctZTpqkPhKIghFcSARBseLlpnY8/1hy/WYIHlnmZsZGluCM3ROlwWhS5/5KR+WEEhND33hzbc9lIgkgAMUCU3fbxCpX1wTFQYhiTQJh0IIiXLaf1jqT2jVXGo7U9GZz10tOEfCP/7YGT7AAIvGtdp7DKKOeQK7T2DRUmgm2GsJG1o5pHr9PCOlMChiAIimDe8XfTYbSSCzxp3Ypz2UCdJGiCKUAAZPPgAYAgQryPVAywACUqiL4W5DkdvCec14MFi+HSFZWe5jILCuYxjFazTKWUrvsaispjP0KUpHlURBIGh6Ni3LO4rJAINwgAKeegBLCbCPClLon4DqOldGiwHVDTp+KJtagg4nJjCjBS1JtmhrD9UJua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",RF="/assets/jetpackLoop-0RyqqDBh.mp3",IF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",jF="data:audio/mpeg;base64,SUQzAwAAAAACQFRQRTEAAAAOAAAAU21hcnRTb3VuZCBGWFRDT04AAAAHAAAASW1wYWN0Q09NTQAAAFcAAAAAAAAASW1wYWN0IG9uIGEgbWV0YWwgb2JqZWN0LCBjbGFuZ2luZyBzb3VuZC4gSGl0LCBJbXBhY3QsIENsYW5nLCBSYXR0bGUsIFJpbmcsIE1ldGFsLkNPTU0AAABXAAAAWFhYAEltcGFjdCBvbiBhIG1ldGFsIG9iamVjdCwgY2xhbmdpbmcgc291bmQuIEhpdCwgSW1wYWN0LCBDbGFuZywgUmF0dGxlLCBSaW5nLCBNZXRhbC5USVQyAAAAIQAAAElNUEFDVCBNRVRBTCBDbGFuZyBNZWRpdW0gMDMud2F2VFlFUgAAAAsAAAAyMDE5LTA2LTEzVERSQwAAAAsAAAAyMDE5LTA2LTEz//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAALAAALmQBJSUlJSUlJSUloaGhoaGhoaGh6enp6enp6enqNjY2NjY2NjY2fn5+fn5+fn5+xsbGxsbGxsbHDw8PDw8PDw8PT09PT09PT09Pl5eXl5eXl5eX19fX19fX19fX///////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJARIQQABuAAAC5m46ML8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB3gBcfQAACNdsy4/NPAAl3qJ2XMAAC5OFAgGFg4cLvKVlz8HwfeUB9QIHCgIAgGIIAgCDso7+Jw/8oGP6wfB8P/+fUclwfB8H/B+ZaZhnZ1QlUiApNnQ2Dw/ssBgMUS/OXDzBIYWCSMzRsxIovmBgqNiagGjBYWEBEzx/goyZdThDkwYJPk8hAWCGkxMpmP4BjK2KpwLQ9cFcqhCLEHYY20YVFrd0bJ0KFFGS0502YTUVvfKatEy5rW4NECdEKaZrXZ4bisksivixZZWF24f/UaLiBRgmW4fhMEGTLOrJZ8Xis7yDnWV1BgX7x5RngUYPGeUS0VzbMQ9SvI00kBthYzvXtX4zrxXBAN7HHxSLSBqlJbbf7iQM4h23qLA////9IqqlmW1dnVYCUkZmwP1KhxCSn+4ksNY9lhKlsa4LYlHMaIh4WDCoLTcwYPuGHxyTXRx1KQw9imHe0Q1rFXzBOURdSQIVyOpLHUYP4mxZ0YgfE7VbuMtqPfMEoxtmafQfWqra9Lt916Hr2k+trS98vExN21LdznsscrwPtumUtJ2zvdQ6MyTRAe0QEZW7Nye5yY401/mTv06Tc5dnjKpOtRAIV0E9S/85zK0YGqO2xsafTMy8tWKmc+G3PRezL36p1/qvmuV1TIyzv32WYCC4dIkVgyoWHITzw3pdZV3Z5mFVjZbISnjk1J+hIZGa4UBG6QlgNl5NbQvW0zrFub02qHmz/+VJ9wt+MSFCp5MCJNdDpELPxTTvtXUPrAo20gVmWiw/zqP/0fX/oqGWGhWUSiiQjmgfCkMlDy2FewHwttKMGyi4ZRImur10U2ZN6mehHCx9wIsOUUVcGwEHlB1R448XMNPuUdZHiY1zHGnxOkmFQUgGdMAr3//0F/Tv+ru77bNEEghzjUAgaR9BlIliQHghLyiTokNMXj84BMDKOpyBL9CnxDSqNLU7PS/sqNVt0V9xHD/+3DE2QAPrXV5/PQAAXAkb/2BifgKGiN0B1WPt3YZCJ1C1g6Fk3qraXWl7f4Rjnr9Tw0vUw6EgmDLupxvkAIAICojjUqF4jGA5lRglrF/vawwSwMfHCfSTmd4YOhi+GTnzLJPL525eU//ar/nCyPPlOmhw9NN78PNXaF5rhUsrcK4c+4pDesrX0//69f/vrCAUAAvBLYOxiRaHgKJrYiiC8TzMc4TNVW8n8ElLmcvasOAyFsUFYafMlr3KZVLenGOeZ3vcgrWElJPPJfiIUoON5JPQyr/9LP93VCM7s6qgEFJF3wh5hyOIsEYRQdBqdjt7ZLM9L+Q0BozlPNULoYuEQ2art2/xC/vMu5blVT2bvfo4bKLGE0Lvf4Bc4Ue5RUCx9EK5JC3G2bPT3+l0v2/sQARJT4LiOAg//tAxP4ACbCBe+ewY8FSDC789I1YqCWQACDyMCgRLkQzEo7fI6txjQO1wfAbH9XLQw7Duad79D0nmKj9itp70qzmWyHs6q/XWJ61NvJOcxjxlyEKubdN/q/uuQrPTNEMiANNKUGIExOH9AQR1AwIGDktJktNL1a1uWqFq8tPUPX8mZar8xTbY9dabezppbC7qbmKIlCYa3NSyZIUu6cov/4TthD5aqpdhcimNDR1eIeJUhILTdr/+0DE/YAKTJ9zpgxPQWqkLrz2DDgN4pB1MJOjAOqIijGLjCVLtHJA5NHuSKncLrGx87CKeWMUymQHpQkoN1M0it6HW16EaC9WU59DnXM9nkr+VnzZBb31SRjiWUmC0u8qswoiDYi5sMhiIYYZ0Jg/5jmykmZPQlyhbMGeNmjwTmzBnxCnXGMSTTpXdGXewchcHkkFCdih4gOxa0/1yR2eaho7c+yIl2WZciATkmARhCqgzy6nUv/7QMT3gAnMrXOnsGVhSZXuvPYMNBy7OuAhO3sijMsLhPD2R2i72/bKbGOZWugJk0RmfbRHz3Ei3K11K11bLoeRKtefSb/m6LKNyYou+uSKWokEkmgDkUBQEhIHFsbjsOpOyNiYmOtV2hAsJqxaeKwSjdIxf31SXEMAhrOWh5WlIqsnaxu3VV8N3N9uy9f/6Kg5b0kjrUAViXhniWMglLdwAvVAPHcGhKOBNC6ACsJu6TEM/UQW//tAxPeACkzXcaYMUOFGJG58wItkxMQCpKaRU4R9EsLIm5ulAeQmEhK4Bx40ILVCY0Xa05WJdzVkTzxdArVtKvEQxw7AABil4AtjafKpVCFWJWXCMivtWJ0gkIDHthgt3tezV4lUgaKkPkzvz6g7GZ0yL/Dcj9X9bcGNJCjBR08IlN1sDTFuE2xJZ7WD1XapQ2kxIB2bYAT5jO1JEuZyVnSdLEifjCFWjMLY1AXd6yoXiBJ0tc//+0DE9gBKTRNx55hNIRqR7jjxicx4p5/8hJumdLTUsjCchlDpUKfwLaBs6tf0dByzqaOogArLwAYbQUpeixNzITAhOi3UppYdtstEGriUYpioeztQLHOVZi55yo5jN+qGOdW1EfTHdN85Bx3dH/+Zj3bSTEFNRTMuMTAwqqqqqpxgGAgGAOMBQGAAAAAAG0E6MWwG0AmfBbSD5iJb4HqYnvx3DtJU4kqrxhRxF8vL/84YqcyNv//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",OF="/assets/metalicScraping-BqmM5ys4.mp3",NF="/assets/mojo-D9S1pz9n.mp3",zF="/assets/mojoTurnSound-D3oZPBXv.mp3",BF="/assets/robotBeepingLoop-Cz0TGwJH.mp3",DF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAFAAAHBgCHh4eHh4eHh4eHh4eHh4eHh4eHpKSkpKSkpKSkpKSkpKSkpKSkpKTBwcHBwcHBwcHBwcHBwcHBwcHBwdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ//////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAM2QQABuAAABwbVZvomAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAACbQNZ7QwACnxFem3NvABAAAb/0m/2/DnECCBGAgAAHfHfAVjn/mAGf+YeHv9AI/9/mHh4AAAAABh4eHj3Sf6MPH////7zDw8PAAAAAAMPDw8PAAAAAFY4ef4AAAAAACAJLlcmslzaAAAAA2dhA8cuNgUzOZEQCemOB48SmLBSXoBIB4bRWLmodWkIyM3KQbxTk5MgkxYg5TEmKcVImoNot5fXBIMZ6wUILqZqPRipgksX3ycRsY3WhpPFfXD9wjP2WCzWi4Z9M1lU4rrEJyfbg4tf5nlSFyl9BDltdXPvf+ALefotw91Kg4XKLrKnrM7XFKkPlm0r62lQG0SkaIee1fdc3yedKObrKqLVO1Tt+09AQj4eK79+e/bVR/unc8uLTcn34t3eGbDHckkUd3K0+q+QaU3nU3EvM2q0GCgoYcv1QP5+7LldGULYTd9qYJKpfHTDNTWlWkCVxEXsA0NJe8kpbGX1Q1lrpG7f/wAFfElzwgk5nDf0u0JoQI2sRE3BsCSljdGmx70Q5Yg/U20rsJ0NItx4T1FXM2t7V2/dZ76daq/iuwEHOUVVLy7f8AGSoqMcpzEIGFVQPIdxGC1g8eyzUJPB/m+Vs40oU0Ln1rchVwreG7jwtkrzwk2XyO1OjltCtYM8yWuSW38AFFsUh7NgmT2ISQn6LxK5lZATETo/wgKuhIPbwWTCUA+ZF4ZAKFIVcWqQvTeka0Plby4pSVnEKmgzDXm45rtwAUOrrpafToPNcaq3bO4tWy+kVpIIrlC3c+YfE4bc9y8bUa2N0mmqfTltWw+ALkINOReTXarVeRKPhu81QCgSjCUVpZ2R/d7LQIAgAAESQ6DJhyCwQEJtFbpvkLRAB6vDAgDTBYBzU1CDEMllappkMZMWwCMNhdXkshDm11YEBBJYB5BLIsRiSvE0FyqJQbB1edgF+H3iZhEhOTOBh3ebtKNyZ/40/D/Qw//+zDE/gBJ6HVjvYWAKPOObHWGCVwKxYYhmDMqGV0sjpqeHI3F5XTO1EpE6NWHdd33HPcYpoxbkErn9b1lrtX/////+vlSZWM7FcLhJQUAvy5QGCQfCwlYIiJ07/dd0KUFAKVYWZ////50YkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+zDE+wAH+IllqLyhqPyJrL0nrByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+yDE/wAH8EtjrDxjoQyNbHawYASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPQAGFTpVfncAEAAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",FF="/assets/rollingBallLoop-BUA084C_.mp3",LF="/assets/servosLoop-Bn-haKck.mp3",UF="/assets/servosStart-BgsySGJF.mp3",$F="/assets/servosStop-BR1i0gi5.mp3",HF="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",GF="/assets/spring-CP3uOhml.mp3",WF="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",YF="/assets/teleportIn-DZAhHW9-.mp3",QF="/assets/teleportOut-Bra-ABlh.mp3",KF="/assets/teleportWarningSiren-Boo1HoAB.mp3",XF="/assets/toasterPopUp-CNfTxQPs.mp3",Fu=new window.AudioContext;let ql;const se=async t=>{try{return await Fu.decodeAudioData(await(await fetch(t)).arrayBuffer())}catch(e){if(navigator.webdriver===!0)return console.warn(`Audio decode failed for ${t} - running in automated browser`,e),Fu.createBuffer(2,1,Fu.sampleRate);throw e}},JF=zn(async()=>({bonus:await se(pF),bubbleRobotLoop:await se(mF),carry:await se(gF),conveyorEnd:await se(xF),conveyorLoop:await se(AF),conveyorStart:await se(yF),destroy:await se(bF),detect:await se(VF),drum:await se(fF),glassClink:await se(qF),headFall:await se(wF),headJump:await se(vF),headWalk:await se(_F),heelsFall:await se(SF),heelsJump:await se(kF),heelsWalk:await se(CF),helicopter:await se(PF),hooter:await se(EF),hushPuppyVanish:await se(TF),jetpackLoop:await se(RF),jetpackTurnaround:await se(MF),landing:await se(IF),metalHit:await se(jF),mojoLoop:await se(NF),mojoTurn:await se(zF),robotBeepingLoop:await se(BF),robotWhirLoop:await se(DF),rollingBallLoop:await se(FF),servoLoop:await se(LF),servoStart:await se(UF),servoStop:await se($F),softBump:await se(HF),springBoing:await se(GF),stepStoolScraping:await se(OF),switchClick:await se(WF),toasterPopUpSoundUrl:await se(XF),teleportIn:await se(YF),teleportOut:await se(QF),teleportWarningSiren:await se(KF)})),ZF=async()=>{ql===void 0&&(ql=await JF())},y$=()=>{if(ql===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return ql},eL=(t,e)=>{const r=Bd();v.useLayoutEffect(()=>{hl(le.dispatch,le.getState,t,e)},[t,e]),v.useLayoutEffect(()=>{const s=()=>hl(le.dispatch,le.getState,t,e);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[r,e,t])},tL=["characterRooms","currentCharacterName","entryState","gameTime","pickupsCollected","previousPlayable"],rL=(t,e,r)=>{const s=Yh({saveTime:Date.now(),gameState:to(t,...tL),store:{gameMenus:{gameInPlay:e.gameMenus.gameInPlay}}});if(r){const{characterPickingUp:n,pickupId:i}=r,o=s.gameState,a=o.characterRooms[n];if(a===void 0)throw new Error("how are we saving from a pickup if the character picking up is not in any room?");const l=a.id;for(const c of jr(o.characterRooms))c.id===l&&ew({room:c,item:c.items[i]})}return s},sL=()=>{const t=Bd(),e=hx();v.useEffect(()=>{if(e===void 0)return;const r=()=>{Cd()||(t(TM(rL(e.gameState,le.getState()))),WR.flush())},s=()=>{document.visibilityState==="hidden"&&(t(jV("hold")),r())};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",r)}},[t,e])},nL=()=>{const t=Y(r=>r.gameMenus.assigningInput!==void 0),e=Y(r=>r.gameMenus.openMenus.length>0);_e({action:"menu_openOrExit",handler:v.useCallback(()=>{Cd()&&window.close(),le.dispatch(Yg())},[]),disabled:t}),_e({action:"menu_exit",handler:z(Yg),disabled:!e}),_e({action:"toggleShowFps",handler:z(Jt,{path:"showFps"}),disabled:e}),_e({action:"hold",handler:z(jV,"toggle"),disabled:t}),_e({action:"map",handler:z(kM),disabled:t}),v.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),_e({action:"toggleColourisation",handler:z(Jt,{path:"displaySettings.uncolourised"}),disabled:t}),_e({action:"toggleCrtFilter",handler:z(Jt,{path:"displaySettings.crtFilter"}),disabled:t}),_e({action:"cycleResolution",handler:z(of,void 0),disabled:t})},iL=()=>(eL(),nL(),sL(),null),oL=t=>e=>(t(e),null),aL=()=>{const t=Y(Xd);v.useEffect(()=>{dt.shared.speed=t},[t])},lL=oL(aL);class cL extends v.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("Error caught in DispatchingErrorBoundary:",e),le.dispatch(rf(Fi(e)))}render(){return this.props.children}}const uL=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=Y(kR);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},ky=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,hL=()=>{const t=nM(),e=Y(SR);v.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",pt())},[]),v.useEffect(()=>{document.body.classList.remove(...Object.keys(Gn).map(ky)),document.body.classList.add(ky(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},dL=v.lazy(FM),Cy=zn(()=>Promise.all([dF(),gR(),ZF()])),fL=()=>{const[t,e]=v.useState(),r=kn(),s=Y(i=>i.gameMenus.gameInPlay.campaignLocator),n=lf();return v.useEffect(()=>{if(!r){e(void 0),window._e2e_gamePageGameAi=void 0,Cy();return}let i=!1,o;return(async()=>{let l=!1;try{if(s===void 0)throw new Error("game is marked as running, but we have no campaign locator, no way to know which campaign to load");l=!0,le.dispatch(LR());const[{default:c}]=await Cy();le.dispatch(nA()),i||(o=await c(s,n),e(o),window._e2e_gamePageGameAi=o)}catch(c){l&&le.dispatch(nA()),console.error(c),le.dispatch(rf(Fi(new Error("error in loading game assets or state",{cause:c}))))}})(),()=>{o?.stop(),i=!0}},[r,n,s]),t},pL=()=>{const[t,e]=v.useState(null),r=tM(),s=fL(),n=Y(_R),i=uL();return hL(),v.useEffect(()=>{t===null||s===void 0||(s.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[s,t]),v.useEffect(()=>{s?.resizeTo(n)},[n,s]),d.jsxs(d.Fragment,{children:[d.jsx("div",{tabIndex:0,className:"fixed top-0",style:i,ref:e}),d.jsxs(S0,{gameApi:s,children:[d.jsxs(cL,{children:[d.jsx(DM,{}),d.jsx(iL,{}),d.jsx(lL,{}),d.jsx(hF,{})]}),s&&r&&d.jsx(v.Suspense,{fallback:null,children:d.jsx(dL,{})})]})]})},mL=zn(()=>sr(()=>import("./LutPage-BU_FXVTI.js"),__vite__mapDeps([13,5,6,10,12]))),gL=2,Ra=10,AL=({textureId:t,spritesheetSize:e})=>{const{frame:r}=ut.frames[t];return d.jsx("div",{className:"absolute border hover:bg-white group",style:{left:`${r.x/e.x*100}%`,top:`${r.y/e.y*100}%`,width:`${r.w/e.x*100}%`,height:`${r.h/e.y*100}%`},children:d.jsx("span",{className:"group-hover:inline text-pureBlack hidden",children:t})})},yL=()=>{const[t,e]=v.useState(null),[r,s]=v.useState(null),n=v.useRef(null),i=v.useRef(null);v.useEffect(()=>{const c=()=>{n.current&&s({x:n.current.naturalWidth,y:n.current.naturalHeight})},u=n.current;if(u)if(u.complete)c();else return u.addEventListener("load",c),()=>u.removeEventListener("load",c)},[]);const o=c=>{if(!n.current||!r)return;const u=n.current.getBoundingClientRect(),h=r.x/u.width,f=r.y/u.height,p=Math.floor((c.clientX-u.left)*h),m=Math.floor((c.clientY-u.top)*f);p>=0&&p<r.x&&m>=0&&m<r.y&&e({x:p,y:m})},a=()=>{e(null)},l=Object.keys(ut.frames).sort();return d.jsxs("div",{ref:i,className:"relative w-full",onMouseMove:o,onMouseLeave:a,children:[d.jsx("img",{ref:n,src:$V,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),r&&l.map(c=>d.jsx(AL,{textureId:c,spritesheetSize:r},c)),t&&r&&n.current&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute pointer-events-none border bg-pink outline-2",style:{left:`${t.x/r.x*100}%`,top:`${t.y/r.y*100}%`,width:`${1/r.x*100}%`,height:`${1/r.y*100}%`}}),d.jsxs("div",{className:"absolute pointer-events-none bg-black text-white px-1 text-xs font-mono",style:{left:`${t.x/r.x*100}%`,top:`calc(${t.y/r.y*100}% + 40px)`,transform:"translate(8px, -100%)"},children:[t.x,",",t.y]})]})]})},xL=({scale:t})=>{const e=Object.keys(ut.frames).sort();return d.jsxs("div",{className:"e2e-snapshot-target",children:[d.jsx(yL,{}),d.jsx("title",{children:"Sprites"}),d.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:e.map(r=>{const{frame:s}=ut.frames[r],n=s;return d.jsxs("div",{className:"bg-shadow m-[4px] p-[8px] text-left flex flex-col w-8","data-texture-id":r,children:[d.jsx("div",{className:`
                  sprite bg-pureBlack hover:bg-moss border-shadow 
                  box-content w-min`,style:{"--x":`${ut.frames[r].frame.x}px`,"--y":`${ut.frames[r].frame.y}px`,"--h":`${ut.frames[r].frame.h}px`,"--w":`${ut.frames[r].frame.w}px`},children:n.pivot?d.jsx("div",{className:"bg-midRed relative",style:{width:`${Ra}px`,height:`${Ra}px`,left:`${n.pivot.x*t-Ra/2}px`,top:`${n.pivot.y*t-Ra/2}px`}}):null}),d.jsx("div",{className:"flex-grow"}),d.jsx("div",{className:"text-moss mt-1 flex-wrap flex-row flex",children:r.split(/(\.)/).map(i=>d.jsx("span",{children:i}))}),d.jsxs("div",{className:"text-lightGrey",children:[s.w,"x",s.h]}),n.pivot?d.jsxs("div",{className:"text-midRed",children:["pivot: (",n.pivot.x,",",n.pivot.y,")"]}):d.jsx("div",{className:"text-metallicBlue",children:"no pivot"}),d.jsxs("div",{className:"text-midGrey",children:["@(",s.x,",",s.y,")"]})]},r)})})]})},bL=()=>{const t=Kt().get("scale"),e=t?Number(t):gL;return d.jsx(An,{scaleFactor:e,children:d.jsx(xL,{scale:e})})},VL=()=>d.jsxs(ze,{children:[d.jsx(gt,{className:"loading-border"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[d.jsx("div",{className:"flex flex-col",children:qn.map(t=>d.jsx("span",{className:`sprite zx:sprite-revert-to-white ${Tn({action:"walking",character:"head",facingXy8:t})}`},t))}),d.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[d.jsx(j,{className:"sprites-double-height",children:"404 Not found"}),d.jsx(j,{className:`${ae} p-1 pt-2 text-metallicBlue zx:text-zxYellow`,children:"whatever youre looking for, it aint here"})]}),d.jsx("div",{className:"flex flex-col",children:qn.toReversed().map(t=>d.jsx("span",{className:`sprite zx:sprite-revert-to-white ${Tn({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),qL=()=>d.jsxs(ze,{children:[d.jsx(gt,{className:"loading-border"}),d.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[d.jsx("div",{className:"flex flex-col",children:qn.map(t=>d.jsx("span",{className:`sprite ${Tn({action:"idle",character:"head",facingXy8:t})}`},t))}),d.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[d.jsx(j,{className:"sprites-double-height mb-1",children:"This is not the editor"}),d.jsxs(Je,{className:`${ae} p-1 pt-2 text-metallicBlue`,children:[d.jsx("p",{children:"If youre seeing this, youre trying to access the level editor, but the web manifest is getting in the way and redirected you to the games client-side routing."}),d.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",d.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),d.jsx("div",{className:"flex flex-col",children:qn.toReversed().map(t=>d.jsx("span",{className:`sprite ${Tn({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),wL=v.lazy(mL),Aw=Kt(),Py=Aw.get("campaignName");Py!==null&&le.dispatch(oo({campaignLocator:{userId:Aw.get("campaignAuthorUserId")||"editorUser",campaignName:Py,version:-1},noShowCrowns:!0}));const vL=()=>{const t=Jd();return v.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),d.jsxs(cv,{children:[d.jsx(Zn,{path:"/",children:d.jsx(An,{children:d.jsx(yI,{children:d.jsx(pL,{})})})}),d.jsx(Zn,{path:"/sprites",children:d.jsx(bL,{})}),d.jsx(Zn,{path:"/lut",children:d.jsx(wL,{})}),d.jsx(Zn,{path:"/editor",children:d.jsx(An,{children:d.jsx(qL,{})})}),d.jsx(Zn,{children:d.jsx(An,{children:d.jsx(VL,{})})})]})},_L=()=>d.jsx(Nw,{store:le,children:d.jsx(vL,{})}),x$=Object.freeze(Object.defineProperty({__proto__:null,App:_L},Symbol.toStringTag,{value:"Module"}));export{Zx as $,Vb as A,wt as B,Ve as C,vo as D,ss as E,So as F,Ed as G,j1 as H,N1 as I,F1 as J,$1 as K,jl as L,de as M,lh as N,Tk as O,lt as P,yS as Q,We as R,Ek as S,Ae as T,tl as U,_o as V,Il as W,W1 as X,$t as Y,Gx as Z,er as _,ui as a,yB as a$,Am as a0,Ms as a1,Vk as a2,xm as a3,Rc as a4,bm as a5,JS as a6,Dx as a7,KS as a8,Qx as a9,JA as aA,G as aB,k0 as aC,WL as aD,c$ as aE,fU as aF,Fe as aG,Ex as aH,UL as aI,Cx as aJ,m$ as aK,Px as aL,oD as aM,l$ as aN,Mn as aO,Tl as aP,mx as aQ,Tr as aR,U as aS,jf as aT,PL as aU,un as aV,vd as aW,he as aX,vv as aY,jr as aZ,sw as a_,Nl as aa,A1 as ab,u1 as ac,O1 as ad,z1 as ae,U1 as af,H1 as ag,G1 as ah,_t as ai,m_ as aj,YC as ak,Y_ as al,_l as am,Bn as an,Sd as ao,Qh as ap,fe as aq,g$ as ar,X as as,jL as at,OL as au,qo as av,IL as aw,zL as ax,NL as ay,Fn as az,Si as b,yU as b$,Rx as b0,Ut as b1,xx as b2,vr as b3,jy as b4,Fl as b5,VR as b6,uf as b7,tO as b8,sO as b9,r$ as bA,h2 as bB,Ft as bC,xn as bD,$h as bE,eD as bF,EB as bG,Ir as bH,SB as bI,Y as bJ,MM as bK,GC as bL,st as bM,eb as bN,an as bO,AU as bP,oh as bQ,ut as bR,mn as bS,mR as bT,fR as bU,dR as bV,AR as bW,aR as bX,le as bY,Is as bZ,RU as b_,nO as ba,oO as bb,aO as bc,cO as bd,lO as be,iO as bf,Wj as bg,sN as bh,j as bi,An as bj,Bd as bk,tU as bl,nU as bm,cU as bn,HL as bo,Jd as bp,Dn as bq,Ad as br,IV as bs,qM as bt,Te as bu,Cs as bv,f2 as bw,rU as bx,Yr as by,uU as bz,ng as c,hn as c$,ho as c0,d$ as c1,$L as c2,W2 as c3,Pi as c4,Zu as c5,pU as c6,NV as c7,sM as c8,Hz as c9,KA as cA,TU as cB,f$ as cC,KU as cD,BU as cE,Lz as cF,xl as cG,CU as cH,kU as cI,Zq as cJ,Gr as cK,Ne as cL,FU as cM,SU as cN,VU as cO,XA as cP,b2 as cQ,Gh as cR,If as cS,K2 as cT,kB as cU,Y2 as cV,Ax as cW,Vy as cX,T2 as cY,e_ as cZ,Za as c_,jU as ca,o$ as cb,BL as cc,Ef as cd,qz as ce,eU as cf,Qr as cg,K0 as ch,CL as ci,yx as cj,o_ as ck,n_ as cl,bx as cm,DL as cn,t_ as co,Kh as cp,pn as cq,qn as cr,Q0 as cs,FL as ct,r_ as cu,nl as cv,UU as cw,Q2 as cx,MU as cy,bz as cz,Kk as d,lM as d$,X0 as d0,DU as d1,Mt as d2,Jt as d3,VM as d4,In as d5,rL as d6,aU as d7,lU as d8,s$ as d9,IU as dA,OU as dB,NU as dC,Ih as dD,mU as dE,Et as dF,pM as dG,t$ as dH,N as dI,Hb as dJ,GL as dK,to as dL,CR as dM,Iu as dN,XR as dO,tI as dP,aI as dQ,Pz as dR,n$ as dS,Fu as dT,y$ as dU,Wp as dV,io as dW,Ap as dX,vz as dY,YU as dZ,Cf as d_,ny as da,Ge as db,u$ as dc,it as dd,jn as de,iU as df,sf as dg,Gq as dh,Xh as di,_s as dj,LU as dk,V2 as dl,Uz as dm,Fz as dn,a$ as dp,gM as dq,gx as dr,Ie as ds,Wr as dt,sl as du,h$ as dv,ZU as dw,Kr as dx,_d as dy,tR as dz,wo as e,iM as e0,Xt as e1,i_ as e2,uw as e3,pt as e4,SM as e5,CB as e6,Jh as e7,Nf as e8,PB as e9,l2 as eA,rf as eB,Fi as eC,hU as eD,ZL as eE,sU as eF,tf as eG,wU as eH,qU as eI,gU as eJ,dU as eK,A$ as eL,oU as eM,EM as eN,p$ as eO,el as eP,Nb as eQ,jm as eR,Rm as eS,xS as eT,Db as eU,x$ as eV,TV as ea,X2 as eb,Yz as ec,TL as ed,Cr as ee,ML as ef,RL as eg,zU as eh,Rf as ei,Kq as ej,Vz as ek,vU as el,_U as em,XU as en,Yq as eo,EU as ep,EL as eq,PU as er,JU as es,QU as et,$U as eu,HU as ev,e$ as ew,WU as ex,GU as ey,i$ as ez,ve as f,Or as g,Ce as h,Hn as i,dt as j,n1 as k,Y1 as l,Im as m,nm as n,Tx as o,a1 as p,Zi as q,RS as r,Oa as s,kd as t,De as u,nt as v,Rt as w,Md as x,ab as y,Ht as z};
