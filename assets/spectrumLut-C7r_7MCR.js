const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WebGPURenderer-DT25YlGa.js","assets/App-BXuZWElz.js","assets/index-BWiMp7rh.js","assets/index-DVPFdodb.css","assets/localUniformBit-BOGrcT1E.js","assets/BufferResource-ZYZfyn58.js","assets/RenderTargetSystem-CJYtFgmF.js","assets/BatchableSprite-qOYjpB38.js","assets/CanvasPool-njU718b8.js","assets/spritesheetPalette-CzWQoMjj.js","assets/WebGLRenderer-BgNSN0Mh.js","assets/CanvasRenderer-D3QHMj1d.js","assets/canvasUtils-BA9Acge-.js"])))=>i.map(i=>d[i]);
import{l as x,d as T,E as de,u as fe,p as q,q as G,v as j,C as p,G as ge,D as M,U as me,o as F,x as pe,T as J}from"./App-BXuZWElz.js";import{_ as L}from"./index-BWiMp7rh.js";import{s as N}from"./spritesheetPalette-CzWQoMjj.js";const B=[];x.handleByNamedList(T.Environment,B);async function _e(s){if(!s)for(let e=0;e<B.length;e++){const r=B[e];if(r.value.test()){await r.value.load();return}}}let k;function be(){if(typeof k=="boolean")return k;try{k=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{k=!1}return k}var Q=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(Q||{});class ye{constructor(e){this.items=[],this._name=e}emit(e,r,t,n,i,a,o,l){const{name:d,items:h}=this;for(let f=0,_=h.length;f<_;f++)h[f][d](e,r,t,n,i,a,o,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&this.items.splice(r,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const ve=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Z=class ee extends de{constructor(e){super(),this.tick=0,this.uid=fe("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const r=[...ve,...this.config.runners??[]];this._addRunners(...r),this._unsafeEvalCheck()}async init(e={}){const r=e.skipExtensionImports===!0?!0:e.manageImports===!1;await _e(r),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const t in this._systemsHash)e={...this._systemsHash[t].constructor.defaultOptions,...e};e={...ee.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let t=0;t<this.runners.init.items.length;t++)await this.runners.init.items[t].init(e);this._initOptions=e}render(e,r){this.tick++;let t=e;if(t instanceof q&&(t={container:t},r&&(G(j,"passing a second argument is deprecated, please use render options instead"),t.target=r.renderTexture)),t.target||(t.target=this.view.renderTarget),t.target===this.view.renderTarget&&(this._lastObjectRendered=t.container,t.clearColor??(t.clearColor=this.background.colorRgba),t.clear??(t.clear=this.background.clearBeforeRender)),t.clearColor){const n=Array.isArray(t.clearColor)&&t.clearColor.length===4;t.clearColor=n?t.clearColor:p.shared.setValue(t.clearColor).toArray()}t.transform||(t.container.updateLocalTransform(),t.transform=t.container.localTransform),t.container.visible&&(t.container.enableRenderGroup(),this.runners.prerender.emit(t),this.runners.renderStart.emit(t),this.runners.render.emit(t),this.runners.renderEnd.emit(t),this.runners.postrender.emit(t))}resize(e,r,t){const n=this.view.resolution;this.view.resize(e,r,t),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),t!==void 0&&t!==n&&this.runners.resolutionChange.emit(t)}clear(e={}){const r=this;e.target||(e.target=r.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Q.ALL);const{clear:t,clearColor:n,target:i,mipLevel:a,layer:o}=e;p.shared.setValue(n??this.background.colorRgba),r.renderTarget.clear(i,t,p.shared.toArray(),a??0,o??0)}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(r=>{this.runners[r]=new ye(r)})}_addSystems(e){let r;for(r in e){const t=e[r];this._addSystem(t.value,t.name)}}_addSystem(e,r){const t=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=t,this._systemsHash[r]=t;for(const n in this.runners)this.runners[n].add(t);return this}_addPipes(e,r){const t=r.reduce((n,i)=>(n[i.name]=i.value,n),{});e.forEach(n=>{const i=n.value,a=n.name,o=t[a];this.renderPipes[a]=new i(this,o?new o:null),this.runners.destroy.add(this.renderPipes[a])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&ge.release(),Object.values(this.runners).forEach(r=>{r.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!be())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Z.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let te=Z,z;function we(s){return z!==void 0||(z=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:s??te.defaultOptions.failIfMajorPerformanceCaveat};try{if(!M.get().getWebGLRenderingContext())return!1;let t=M.get().createCanvas().getContext("webgl",e);const n=!!t?.getContextAttributes()?.stencil;if(t){const i=t.getExtension("WEBGL_lose_context");i&&i.loseContext()}return t=null,n}catch{return!1}})()),z}let A;async function Te(s={}){return A!==void 0||(A=await(async()=>{const e=M.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),A}const K=["webgl","webgpu","canvas"];async function Se(s){let e=[];s.preference?(e.push(s.preference),K.forEach(i=>{i!==s.preference&&e.push(i)})):e=K.slice();let r,t={};for(let i=0;i<e.length;i++){const a=e[i];if(a==="webgpu"&&await Te()){const{WebGPURenderer:o}=await L(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-DT25YlGa.js");return{WebGPURenderer:l}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]));r=o,t={...s,...s.webgpu};break}else if(a==="webgl"&&we(s.failIfMajorPerformanceCaveat??te.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await L(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-BgNSN0Mh.js");return{WebGLRenderer:l}},__vite__mapDeps([10,1,2,3,4,5,6,7,9]));r=o,t={...s,...s.webgl};break}else if(a==="canvas"){const{CanvasRenderer:o}=await L(async()=>{const{CanvasRenderer:l}=await import("./CanvasRenderer-D3QHMj1d.js");return{CanvasRenderer:l}},__vite__mapDeps([11,1,2,3,6,7,12,9]));r=o,t={...s,...s.canvasOptions};break}}if(delete t.webgpu,delete t.webgl,delete t.canvasOptions,!r)throw new Error("No available renderer for the current environment");const n=new r;return await n.init(t),n}const re="8.16.0";class se{static init(){globalThis.__PIXI_APP_INIT__?.(this,re)}static destroy(){}}se.extension=T.Application;class Re{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,re)}destroy(){this._renderer=null}}Re.extension={type:[T.WebGLSystem,T.WebGPUSystem],name:"initHook",priority:-10};class ne{static init(e){Object.defineProperty(this,"resizeTo",{configurable:!0,set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let r,t;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,t=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:i}=this._resizeTo;r=n,t=i}this.renderer.resize(r,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ne.extension=T.Application;class ie{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{configurable:!0,set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,me.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?F.shared:new F,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}ie.extension=T.Application;x.add(ne);x.add(ie);const ae=class H{constructor(...e){this.stage=new q,e[0]!==void 0&&G(j,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.stage||(this.stage=new q),this.renderer=await Se(e),H._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return G(j,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,r=!1){const t=H._plugins.slice(0);t.reverse(),t.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};ae._plugins=[];let Oe=ae;x.handleByList(T.Application,Oe._plugins);x.add(se);const oe=.4,ke=.5,xe=.7,Pe=[1,ke,oe,xe],je=(s,e=oe)=>{const[r,t,n]=s.toUint8RgbArray();return new p({r:r*e,g:t*e,b:n*e})},W=6;function*Ce(s,e,r,t=1){const n=2**W-1,i=Math.floor(s*n+.5),a=Math.floor(e*n+.5),o=Math.floor(r*n+.5);for(let l=-t;l<=t;l++)for(let d=-t;d<=t;d++)for(let h=-t;h<=t;h++){const f=i+l,_=a+d,w=o+h;if(f<0||f>n||_<0||_>n||w<0||w>n)continue;const P=Math.sqrt(l*l+d*d+h*h),V=w%8*64,c=Math.floor(w/8)*64,y=V+f,g=c+_;yield{x:y,y:g,distance:P}}}const v=(2**W)**(3/2),le=v*v,Ee=s=>{const e=new Uint8Array(le*4);for(const t of Pe)for(const[n,i]of pe(s)){const a=N[n];for(const{x:o,y:l,distance:d}of Ce(a.red*t,a.green*t,a.blue*t,2)){const h=l*v+o,f=e[h*4+3],_=Math.max(1,Math.floor(255-d/1.732*254));(f===0||_>f)&&(e[h*4+0]=Math.floor(i.red*t*255),e[h*4+1]=Math.floor(i.green*t*255),e[h*4+2]=Math.floor(i.blue*t*255),e[h*4+3]=_)}}for(let t=3;t<e.length;t+=4)e[t]>0&&(e[t]=255);return J.from({resource:e,width:v,height:v,scaleMode:"nearest",antialias:!1})},{floor:I,min:ze}=Math,Ae=s=>{if(s instanceof Map)return s;const e=new Map,r=Object.entries(s);for(const[t,n]of r){const i=N[t],a=typeof n=="string"?N[n]:n;e.set(i,a)}return e},$={red:0,blue:0,green:0},Ie=9;function Me(s){const e=Ae(s),r=new Uint8Array(le*4).fill(255),t=e.keys().toArray(),n=e.values().map(c=>({red:I(c.red*255),green:I(c.green*255),blue:I(c.blue*255)})).toArray(),i=t.length,a=2**W,o=1/(a-1),l=new Array(i),d=new Array(i),h=[];let f=0;for(let c=0;c<a;c++){const y=new Array(i);for(let g=0;g<i;g++){const u=f-t[g].green;y[g]=u*u}h[c]=y,f+=o}const _=[];let w=0;for(let c=0;c<a;c++){const y=new Array(i);for(let g=0;g<i;g++){const u=w-t[g].red;y[g]=u*u}_[c]=y,w+=o}let P=0;for(let c=0;c<a;c++){const y=c%8*64,g=I(c/8)*64;for(let u=0;u<i;u++){const C=P-t[u].blue;l[u]=C*C}for(let u=0;u<a;u++){const C=h[u];let E=(g+u)*v+y<<2;for(let b=0;b<i;b++)d[b]=l[b]+C[b];for(let b=0;b<a;){const ce=_[b];let S=$,U=9999;for(let m=0;m<i;m++){const R=d[m]+ce[m];R<U&&(S=n[m],U=R)}let D=1;const he=ze(b+Ie,a-1);for(let m=he;m>b;m--){let R=$,Y=9999;const ue=_[m];for(let O=0;O<i;O++){const X=d[O]+ue[O];X<Y&&(R=n[O],Y=X)}if(R===S){D=m-b+1;break}}for(let m=0;m<D;m++)r[E++]=S.red,r[E++]=S.green,r[E]=S.blue,E+=2;b+=D}}P+=o}return J.from({resource:r,width:v,height:v,scaleMode:"nearest",antialias:!1})}const Ne=Ee({moss:new p(65280),pink:new p(16711935),metallicBlue:new p(34952),pastelBlue:new p(65535),highlightBeige:new p(16776960),lightBeige:new p(8947712),midRed:new p(16711680),redShadow:new p(8912896),lightGrey:new p(16777215)});export{Oe as A,Q as C,Re as R,ye as S,re as V,te as a,Ee as b,je as h,Ne as s,be as u,Me as v};
