const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/campaign-B5YtlMSX.js","assets/index-DSlNDIZS.js","assets/index-BmHeLveM.css","assets/Cheats-DArOlNkg.js","assets/pixiContainerToString-CzPH4BYX.js","assets/browserAll-paNVug5E.js","assets/webworkerAll--9rGBH6Z.js","assets/Filter-qaT4kSa1.js","assets/colorToUniform-BXaCBwVl.js","assets/CanvasTextGenerator-BNu3Ktta.js","assets/gameMain-BZ82_oU9.js","assets/RenderTexture-CEKIJ5Zp.js","assets/spectrumLut-CawWU515.js","assets/LutPage-DTGVa7UD.js"])))=>i.map(i=>d[i]);
import{b as Ln,r as v,R as dd,j as p,g as Ke,i as Un,_ as is,a as $q,t as et,d as Ky,D as Se,L as Hq,c as Do}from"./index-DSlNDIZS.js";var lc={exports:{}},cc={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tp;function Wq(){if(tp)return cc;tp=1;var t=Ln();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var s=typeof Object.is=="function"?Object.is:e,r=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return cc.useSyncExternalStoreWithSelector=function(l,c,u,h,d){var f=n(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=o(function(){function g(q){if(!y){if(y=!0,w=q,q=h(q),d!==void 0&&m.hasValue){var _=m.value;if(d(_,q))return x=_}return x=q}if(_=x,s(w,q))return _;var V=h(q);return d!==void 0&&d(_,V)?(w=q,_):(w=q,x=V)}var y=!1,w,x,b=u===void 0?null:u;return[function(){return g(c())},b===null?void 0:function(){return g(b())}]},[c,u,h,d]);var A=r(l,f[0],f[1]);return i(function(){m.hasValue=!0,m.value=A},[A]),a(A),A},cc}var sp;function Gq(){return sp||(sp=1,lc.exports=Wq()),lc.exports}var Yq=Gq();function Qy(t){t()}function Kq(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Qy(()=>{let s=t;for(;s;)s.callback(),s=s.next})},get(){const s=[];let r=t;for(;r;)s.push(r),r=r.next;return s},subscribe(s){let r=!0;const n=e={callback:s,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!r||t===null||(r=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var rp={notify(){},get:()=>[]};function Qq(t,e){let s,r=rp,n=0,i=!1;function o(A){u();const g=r.subscribe(A);let y=!1;return()=>{y||(y=!0,g(),h())}}function a(){r.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){n++,s||(s=t.subscribe(l),r=Kq())}function h(){n--,s&&n===0&&(s(),s=void 0,r.clear(),r=rp)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>r};return m}var Xq=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Jq=Xq(),Zq=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ev=Zq(),tv=()=>Jq||ev?v.useLayoutEffect:v.useEffect,sv=tv();function np(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Ni(t,e){if(np(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;for(let n=0;n<s.length;n++)if(!Object.prototype.hasOwnProperty.call(e,s[n])||!np(t[s[n]],e[s[n]]))return!1;return!0}var rv=Symbol.for("react-redux-context"),nv=typeof globalThis<"u"?globalThis:{};function iv(){if(!v.createContext)return{};const t=nv[rv]??=new Map;let e=t.get(v.createContext);return e||(e=v.createContext(null),t.set(v.createContext,e)),e}var er=iv();function ov(t){const{children:e,context:s,serverState:r,store:n}=t,i=v.useMemo(()=>{const l=Qq(n);return{store:n,subscription:l,getServerState:r?()=>r:void 0}},[n,r]),o=v.useMemo(()=>n.getState(),[n]);sv(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=s||er;return v.createElement(a.Provider,{value:i},e)}var av=ov;function fd(t=er){return function(){return v.useContext(t)}}var Xy=fd();function Jy(t=er){const e=t===er?Xy:fd(t),s=()=>{const{store:r}=e();return r};return Object.assign(s,{withTypes:()=>s}),s}var pd=Jy();function lv(t=er){const e=t===er?pd:Jy(t),s=()=>e().dispatch;return Object.assign(s,{withTypes:()=>s}),s}var Zy=lv(),cv=(t,e)=>t===e;function uv(t=er){const e=t===er?Xy:fd(t),s=(r,n={})=>{const{equalityFn:i=cv}=typeof n=="function"?{equalityFn:n}:n,o=e(),{store:a,subscription:l,getServerState:c}=o;v.useRef(!0);const u=v.useCallback({[r.name](d){return r(d)}}[r.name],[r]),h=Yq.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return v.useDebugValue(h),h};return Object.assign(s,{withTypes:()=>s}),s}var ex=uv(),hv=Qy;function dv(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var s,r,n,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)s=n[0],s==="*"?(o.push(s),a+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):s===":"?(r=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~r?r:~i?i:n.length)),a+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+n.substring(i))):a+="/"+n;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var uc={exports:{}},hc={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ip;function fv(){if(ip)return hc;ip=1;var t=Ln();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var s=typeof Object.is=="function"?Object.is:e,r=t.useState,n=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,d){var f=d(),m=r({inst:{value:f,getSnapshot:d}}),A=m[0].inst,g=m[1];return i(function(){A.value=f,A.getSnapshot=d,l(A)&&g({inst:A})},[h,f,d]),n(function(){return l(A)&&g({inst:A}),h(function(){l(A)&&g({inst:A})})},[h]),o(f),f}function l(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!s(h,f)}catch{return!0}}function c(h,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return hc.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,hc}var op;function pv(){return op||(op=1,uc.exports=fv()),uc.exports}var mv=pv();const gv=dd.useInsertionEffect,Av=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yv=Av?v.useLayoutEffect:v.useEffect,xv=gv||yv,tx=t=>{const e=v.useRef([t,(...s)=>e[0](...s)]).current;return xv(()=>{e[0]=t}),e[1]},bv="popstate",md="pushState",gd="replaceState",wv="hashchange",ap=[bv,md,gd,wv],Vv=t=>{for(const e of ap)addEventListener(e,t);return()=>{for(const e of ap)removeEventListener(e,t)}},sx=(t,e)=>mv.useSyncExternalStore(Vv,t,e),qv=()=>location.search,vv=({ssrSearch:t=""}={})=>sx(qv,()=>t),lp=()=>location.pathname,_v=({ssrPath:t}={})=>sx(lp,t?()=>t:lp),Sv=(t,{replace:e=!1,state:s=null}={})=>history[e?gd:md](s,"",t),kv=(t={})=>[_v(t),Sv],cp=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[cp]>"u"){for(const t of[md,gd]){const e=history[t];history[t]=function(){const s=e.apply(this,arguments),r=new Event(t);return r.arguments=arguments,dispatchEvent(r),s}}Object.defineProperty(window,cp,{value:!0})}const Cv=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",rx=(t="")=>t==="/"?"":t,Pv=(t,e)=>t[0]==="~"?t.slice(1):rx(e)+t,Ev=(t="",e)=>Cv(up(rx(t)),up(e)),up=t=>{try{return decodeURI(t)}catch{return t}},nx={hook:kv,searchHook:vv,parser:dv,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},ix=v.createContext(nx),Ml=()=>v.useContext(ix),ox={},ax=v.createContext(ox),Tv=()=>v.useContext(ax),Ad=t=>{const[e,s]=t.hook(t);return[Ev(t.base,e),tx((r,n)=>s(Pv(r,t.base),n))]},lx=(t,e,s,r)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",r),o=n.exec(s)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,d)=>[h,l[d]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...r?[a]:[]]:[!1,null]},Mv=({children:t,...e})=>{const s=Ml(),r=e.hook?nx:s;let n=r;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=v.useRef({}),l=a.current,c=l;for(let u in r){const h=u==="base"?r[u]+(e[u]||""):e[u]||r[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,h!==r[u]&&(n=c)}return v.createElement(ix.Provider,{value:n,children:t})},hp=({children:t,component:e},s)=>e?v.createElement(e,{params:s}):typeof t=="function"?t(s):t,Rv=t=>{let e=v.useRef(ox);const s=e.current;return e.current=Object.keys(t).length!==Object.keys(s).length||Object.entries(t).some(([r,n])=>n!==s[r])?t:s},oi=({path:t,nest:e,match:s,...r})=>{const n=Ml(),[i]=Ad(n),[o,a,l]=s??lx(n.parser,t,i,e),c=Rv({...Tv(),...a});if(!o)return null;const u=l?v.createElement(Mv,{base:l},hp(r,c)):hp(r,c);return v.createElement(ax.Provider,{value:c,children:u})};v.forwardRef((t,e)=>{const s=Ml(),[r,n]=Ad(s),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:d,...f}=t,m=tx(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a?.(g),g.defaultPrevented||(g.preventDefault(),n(o,t)))}),A=s.hrefs(o[0]==="~"?o.slice(1):s.base+o,s);return l&&v.isValidElement(c)?v.cloneElement(c,{onClick:m,href:A}):v.createElement("a",{...f,onClick:m,href:A,className:u?.call?u(r===o):u,children:c,ref:e})});const cx=t=>Array.isArray(t)?t.flatMap(e=>cx(e&&e.type===v.Fragment?e.props.children:e)):[t],Iv=({children:t,location:e})=>{const s=Ml(),[r]=Ad(s);for(const n of cx(t)){let i=0;if(v.isValidElement(n)&&(i=lx(s.parser,n.props.path,e||r,n.props.nest))[0])return v.cloneElement(n,{match:i})}return null},ms=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t);function Xe(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var jv=typeof Symbol=="function"&&Symbol.observable||"@@observable",dp=jv,dc=()=>Math.random().toString(36).substring(7).split("").join("."),Ov={INIT:`@@redux/INIT${dc()}`,REPLACE:`@@redux/REPLACE${dc()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${dc()}`},Za=Ov;function Sn(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function yd(t,e,s){if(typeof t!="function")throw new Error(Xe(2));if(typeof e=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(Xe(0));if(typeof e=="function"&&typeof s>"u"&&(s=e,e=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(Xe(1));return s(yd)(t,e)}let r=t,n=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(l)throw new Error(Xe(3));return n}function h(g){if(typeof g!="function")throw new Error(Xe(4));if(l)throw new Error(Xe(5));let y=!0;c();const w=a++;return o.set(w,g),function(){if(y){if(l)throw new Error(Xe(6));y=!1,c(),o.delete(w),i=null}}}function d(g){if(!Sn(g))throw new Error(Xe(7));if(typeof g.type>"u")throw new Error(Xe(8));if(typeof g.type!="string")throw new Error(Xe(17));if(l)throw new Error(Xe(9));try{l=!0,n=r(n,g)}finally{l=!1}return(i=o).forEach(w=>{w()}),g}function f(g){if(typeof g!="function")throw new Error(Xe(10));r=g,d({type:Za.REPLACE})}function m(){const g=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Xe(11));function w(){const b=y;b.next&&b.next(u())}return w(),{unsubscribe:g(w)}},[dp](){return this}}}return d({type:Za.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[dp]:m}}function Bv(t){Object.keys(t).forEach(e=>{const s=t[e];if(typeof s(void 0,{type:Za.INIT})>"u")throw new Error(Xe(12));if(typeof s(void 0,{type:Za.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Xe(13))})}function xd(t){const e=Object.keys(t),s={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(s[o]=t[o])}const r=Object.keys(s);let n;try{Bv(s)}catch(i){n=i}return function(o={},a){if(n)throw n;let l=!1;const c={};for(let u=0;u<r.length;u++){const h=r[u],d=s[h],f=o[h],m=d(f,a);if(typeof m>"u")throw a&&a.type,new Error(Xe(14));c[h]=m,l=l||m!==f}return l=l||r.length!==Object.keys(o).length,l?c:o}}function el(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,s)=>(...r)=>e(s(...r)))}function Nv(...t){return e=>(s,r)=>{const n=e(s,r);let i=()=>{throw new Error(Xe(15))};const o={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=el(...a)(n.dispatch),{...n,dispatch:i}}}function bd(t){return Sn(t)&&"type"in t&&typeof t.type=="string"}var wd=Symbol.for("immer-nothing"),zi=Symbol.for("immer-draftable"),St=Symbol.for("immer-state");function Ze(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var jr=Object.getPrototypeOf;function As(t){return!!t&&!!t[St]}function ts(t){return t?ux(t)||Array.isArray(t)||!!t[zi]||!!t.constructor?.[zi]||_o(t)||So(t):!1}var zv=Object.prototype.constructor.toString();function ux(t){if(!t||typeof t!="object")return!1;const e=jr(t);if(e===null)return!0;const s=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return s===Object?!0:typeof s=="function"&&Function.toString.call(s)===zv}function Dv(t){return As(t)||Ze(15,t),t[St].base_}function eo(t,e){Or(t)===0?Reflect.ownKeys(t).forEach(s=>{e(s,t[s],t)}):t.forEach((s,r)=>e(r,s,t))}function Or(t){const e=t[St];return e?e.type_:Array.isArray(t)?1:_o(t)?2:So(t)?3:0}function to(t,e){return Or(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function fc(t,e){return Or(t)===2?t.get(e):t[e]}function hx(t,e,s){const r=Or(t);r===2?t.set(e,s):r===3?t.add(s):t[e]=s}function Fv(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function _o(t){return t instanceof Map}function So(t){return t instanceof Set}function gr(t){return t.copy_||t.base_}function Ju(t,e){if(_o(t))return new Map(t);if(So(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const s=ux(t);if(e===!0||e==="class_only"&&!s){const r=Object.getOwnPropertyDescriptors(t);delete r[St];let n=Reflect.ownKeys(r);for(let i=0;i<n.length;i++){const o=n[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(jr(t),r)}else{const r=jr(t);if(r!==null&&s)return{...t};const n=Object.create(r);return Object.assign(n,t)}}function Vd(t,e=!1){return Rl(t)||As(t)||!ts(t)||(Or(t)>1&&(t.set=t.add=t.clear=t.delete=Lv),Object.freeze(t),e&&Object.entries(t).forEach(([s,r])=>Vd(r,!0))),t}function Lv(){Ze(2)}function Rl(t){return Object.isFrozen(t)}var Zu={};function Br(t){const e=Zu[t];return e||Ze(0,t),e}function Uv(t,e){Zu[t]||(Zu[t]=e)}var so;function dx(){return so}function $v(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function fp(t,e){e&&(Br("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function eh(t){th(t),t.drafts_.forEach(Hv),t.drafts_=null}function th(t){t===so&&(so=t.parent_)}function pp(t){return so=$v(so,t)}function Hv(t){const e=t[St];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function mp(t,e){e.unfinalizedDrafts_=e.drafts_.length;const s=e.drafts_[0];return t!==void 0&&t!==s?(s[St].modified_&&(eh(e),Ze(4)),ts(t)&&(t=tl(e,t),e.parent_||sl(e,t)),e.patches_&&Br("Patches").generateReplacementPatches_(s[St].base_,t,e.patches_,e.inversePatches_)):t=tl(e,s,[]),eh(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==wd?t:void 0}function tl(t,e,s){if(Rl(e))return e;const r=e[St];if(!r)return eo(e,(n,i)=>gp(t,r,e,n,i,s)),e;if(r.scope_!==t)return e;if(!r.modified_)return sl(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const n=r.copy_;let i=n,o=!1;r.type_===3&&(i=new Set(n),n.clear(),o=!0),eo(i,(a,l)=>gp(t,r,n,a,l,s,o)),sl(t,n,!1),s&&t.patches_&&Br("Patches").generatePatches_(r,s,t.patches_,t.inversePatches_)}return r.copy_}function gp(t,e,s,r,n,i,o){if(As(n)){const a=i&&e&&e.type_!==3&&!to(e.assigned_,r)?i.concat(r):void 0,l=tl(t,n,a);if(hx(s,r,l),As(l))t.canAutoFreeze_=!1;else return}else o&&s.add(n);if(ts(n)&&!Rl(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;tl(t,n),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(s,r)&&sl(t,n)}}function sl(t,e,s=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Vd(e,s)}function Wv(t,e){const s=Array.isArray(t),r={type_:s?1:0,scope_:e?e.scope_:dx(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=r,i=qd;s&&(n=[r],i=ro);const{revoke:o,proxy:a}=Proxy.revocable(n,i);return r.draft_=a,r.revoke_=o,a}var qd={get(t,e){if(e===St)return t;const s=gr(t);if(!to(s,e))return Gv(t,s,e);const r=s[e];return t.finalized_||!ts(r)?r:r===pc(t.base_,e)?(mc(t),t.copy_[e]=rh(r,t)):r},has(t,e){return e in gr(t)},ownKeys(t){return Reflect.ownKeys(gr(t))},set(t,e,s){const r=fx(gr(t),e);if(r?.set)return r.set.call(t.draft_,s),!0;if(!t.modified_){const n=pc(gr(t),e),i=n?.[St];if(i&&i.base_===s)return t.copy_[e]=s,t.assigned_[e]=!1,!0;if(Fv(s,n)&&(s!==void 0||to(t.base_,e)))return!0;mc(t),sh(t)}return t.copy_[e]===s&&(s!==void 0||e in t.copy_)||Number.isNaN(s)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=s,t.assigned_[e]=!0),!0},deleteProperty(t,e){return pc(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,mc(t),sh(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const s=gr(t),r=Reflect.getOwnPropertyDescriptor(s,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:s[e]}},defineProperty(){Ze(11)},getPrototypeOf(t){return jr(t.base_)},setPrototypeOf(){Ze(12)}},ro={};eo(qd,(t,e)=>{ro[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ro.deleteProperty=function(t,e){return ro.set.call(this,t,e,void 0)};ro.set=function(t,e,s){return qd.set.call(this,t[0],e,s,t[0])};function pc(t,e){const s=t[St];return(s?gr(s):t)[e]}function Gv(t,e,s){const r=fx(e,s);return r?"value"in r?r.value:r.get?.call(t.draft_):void 0}function fx(t,e){if(!(e in t))return;let s=jr(t);for(;s;){const r=Object.getOwnPropertyDescriptor(s,e);if(r)return r;s=jr(s)}}function sh(t){t.modified_||(t.modified_=!0,t.parent_&&sh(t.parent_))}function mc(t){t.copy_||(t.copy_=Ju(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Yv=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,s,r)=>{if(typeof e=="function"&&typeof s!="function"){const i=s;s=e;const o=this;return function(l=i,...c){return o.produce(l,u=>s.call(this,u,...c))}}typeof s!="function"&&Ze(6),r!==void 0&&typeof r!="function"&&Ze(7);let n;if(ts(e)){const i=pp(this),o=rh(e,void 0);let a=!0;try{n=s(o),a=!1}finally{a?eh(i):th(i)}return fp(i,r),mp(n,i)}else if(!e||typeof e!="object"){if(n=s(e),n===void 0&&(n=e),n===wd&&(n=void 0),this.autoFreeze_&&Vd(n,!0),r){const i=[],o=[];Br("Patches").generateReplacementPatches_(e,n,i,o),r(i,o)}return n}else Ze(1,e)},this.produceWithPatches=(e,s)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,n;return[this.produce(e,s,(o,a)=>{r=o,n=a}),r,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){ts(t)||Ze(8),As(t)&&(t=Kv(t));const e=pp(this),s=rh(t,void 0);return s[St].isManual_=!0,th(e),s}finishDraft(t,e){const s=t&&t[St];(!s||!s.isManual_)&&Ze(9);const{scope_:r}=s;return fp(r,e),mp(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let s;for(s=e.length-1;s>=0;s--){const n=e[s];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}s>-1&&(e=e.slice(s+1));const r=Br("Patches").applyPatches_;return As(t)?r(t,e):this.produce(t,n=>r(n,e))}};function rh(t,e){const s=_o(t)?Br("MapSet").proxyMap_(t,e):So(t)?Br("MapSet").proxySet_(t,e):Wv(t,e);return(e?e.scope_:dx()).drafts_.push(s),s}function Kv(t){return As(t)||Ze(10,t),px(t)}function px(t){if(!ts(t)||Rl(t))return t;const e=t[St];let s;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,s=Ju(t,e.scope_.immer_.useStrictShallowCopy_)}else s=Ju(t,!0);return eo(s,(r,n)=>{hx(s,r,px(n))}),e&&(e.finalized_=!1),s}function Qv(){const e="replace",r="remove";function n(d,f,m,A){switch(d.type_){case 0:case 2:return o(d,f,m,A);case 1:return i(d,f,m,A);case 3:return a(d,f,m,A)}}function i(d,f,m,A){let{base_:g,assigned_:y}=d,w=d.copy_;w.length<g.length&&([g,w]=[w,g],[m,A]=[A,m]);for(let x=0;x<g.length;x++)if(y[x]&&w[x]!==g[x]){const b=f.concat([x]);m.push({op:e,path:b,value:h(w[x])}),A.push({op:e,path:b,value:h(g[x])})}for(let x=g.length;x<w.length;x++){const b=f.concat([x]);m.push({op:"add",path:b,value:h(w[x])})}for(let x=w.length-1;g.length<=x;--x){const b=f.concat([x]);A.push({op:r,path:b})}}function o(d,f,m,A){const{base_:g,copy_:y}=d;eo(d.assigned_,(w,x)=>{const b=fc(g,w),q=fc(y,w),_=x?to(g,w)?e:"add":r;if(b===q&&_===e)return;const V=f.concat(w);m.push(_===r?{op:_,path:V}:{op:_,path:V,value:q}),A.push(_==="add"?{op:r,path:V}:_===r?{op:"add",path:V,value:h(b)}:{op:e,path:V,value:h(b)})})}function a(d,f,m,A){let{base_:g,copy_:y}=d,w=0;g.forEach(x=>{if(!y.has(x)){const b=f.concat([w]);m.push({op:r,path:b,value:x}),A.unshift({op:"add",path:b,value:x})}w++}),w=0,y.forEach(x=>{if(!g.has(x)){const b=f.concat([w]);m.push({op:"add",path:b,value:x}),A.unshift({op:r,path:b,value:x})}w++})}function l(d,f,m,A){m.push({op:e,path:[],value:f===wd?void 0:f}),A.push({op:e,path:[],value:d})}function c(d,f){return f.forEach(m=>{const{path:A,op:g}=m;let y=d;for(let q=0;q<A.length-1;q++){const _=Or(y);let V=A[q];typeof V!="string"&&typeof V!="number"&&(V=""+V),(_===0||_===1)&&(V==="__proto__"||V==="constructor")&&Ze(19),typeof y=="function"&&V==="prototype"&&Ze(19),y=fc(y,V),typeof y!="object"&&Ze(18,A.join("/"))}const w=Or(y),x=u(m.value),b=A[A.length-1];switch(g){case e:switch(w){case 2:return y.set(b,x);case 3:Ze(16);default:return y[b]=x}case"add":switch(w){case 1:return b==="-"?y.push(x):y.splice(b,0,x);case 2:return y.set(b,x);case 3:return y.add(x);default:return y[b]=x}case r:switch(w){case 1:return y.splice(b,1);case 2:return y.delete(b);case 3:return y.delete(m.value);default:return delete y[b]}default:Ze(17,g)}}),d}function u(d){if(!ts(d))return d;if(Array.isArray(d))return d.map(u);if(_o(d))return new Map(Array.from(d.entries()).map(([m,A])=>[m,u(A)]));if(So(d))return new Set(Array.from(d).map(u));const f=Object.create(jr(d));for(const m in d)f[m]=u(d[m]);return to(d,zi)&&(f[zi]=d[zi]),f}function h(d){return As(d)?u(d):d}Uv("Patches",{applyPatches_:c,generatePatches_:n,generateReplacementPatches_:l})}var Nt=new Yv,$n=Nt.produce,mx=Nt.produceWithPatches.bind(Nt);Nt.setAutoFreeze.bind(Nt);Nt.setUseStrictShallowCopy.bind(Nt);var Ap=Nt.applyPatches.bind(Nt);Nt.createDraft.bind(Nt);Nt.finishDraft.bind(Nt);function Xv(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function Jv(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function Zv(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(s=>typeof s=="function")){const s=t.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${s}]`)}}var yp=t=>Array.isArray(t)?t:[t];function e0(t){const e=Array.isArray(t[0])?t[0]:t;return Zv(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function t0(t,e){const s=[],{length:r}=t;for(let n=0;n<r;n++)s.push(t[n].apply(null,e));return s}var s0=class{constructor(t){this.value=t}deref(){return this.value}},r0=typeof WeakRef<"u"?WeakRef:s0,n0=0,xp=1;function Fo(){return{s:n0,v:void 0,o:null,p:null}}function rl(t,e={}){let s=Fo();const{resultEqualityCheck:r}=e;let n,i=0;function o(){let a=s;const{length:l}=arguments;for(let h=0,d=l;h<d;h++){const f=arguments[h];if(typeof f=="function"||typeof f=="object"&&f!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const A=m.get(f);A===void 0?(a=Fo(),m.set(f,a)):a=A}else{let m=a.p;m===null&&(a.p=m=new Map);const A=m.get(f);A===void 0?(a=Fo(),m.set(f,a)):a=A}}const c=a;let u;if(a.s===xp)u=a.v;else if(u=t.apply(null,arguments),i++,r){const h=n?.deref?.()??n;h!=null&&r(h,u)&&(u=h,i!==0&&i--),n=typeof u=="object"&&u!==null||typeof u=="function"?new r0(u):u}return c.s=xp,c.v=u,u}return o.clearCache=()=>{s=Fo(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function i0(t,...e){const s=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,r=(...n)=>{let i=0,o=0,a,l={},c=n.pop();typeof c=="object"&&(l=c,c=n.pop()),Xv(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...s,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=rl,argsMemoizeOptions:m=[]}=u,A=yp(d),g=yp(m),y=e0(n),w=h(function(){return i++,c.apply(null,arguments)},...A),x=f(function(){o++;const q=t0(y,arguments);return a=w.apply(null,q),a},...g);return Object.assign(x,{resultFunc:c,memoizedResultFunc:w,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:f})};return Object.assign(r,{withTypes:()=>r}),r}var Il=i0(rl),o0=Object.assign((t,e=Il)=>{Jv(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const s=Object.keys(t),r=s.map(i=>t[i]);return e(r,(...i)=>i.reduce((o,a,l)=>(o[s[l]]=a,o),{}))},{withTypes:()=>o0});function gx(t){return({dispatch:s,getState:r})=>n=>i=>typeof i=="function"?i(s,r,t):n(i)}var a0=gx(),l0=gx,c0=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?el:el.apply(null,arguments)},u0=t=>t&&typeof t.match=="function";function pt(t,e){function s(...r){if(e){let n=e(...r);if(!n)throw new Error(Ge(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:r[0]}}return s.toString=()=>`${t}`,s.type=t,s.match=r=>bd(r)&&r.type===t,s}var Ax=class Si extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Si.prototype)}static get[Symbol.species](){return Si}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Si(...e[0].concat(this)):new Si(...e.concat(this))}};function bp(t){return ts(t)?$n(t,()=>{}):t}function nh(t,e,s){return t.has(e)?t.get(e):t.set(e,s(e)).get(e)}function h0(t){return typeof t=="boolean"}var d0=()=>function(e){const{thunk:s=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let o=new Ax;return s&&(h0(s)?o.push(a0):o.push(l0(s.extraArgument))),o},jl="RTK_autoBatch",ai=()=>t=>({payload:t,meta:{[jl]:!0}}),wp=t=>e=>{setTimeout(e,t)},f0=(t={type:"raf"})=>e=>(...s)=>{const r=e(...s);let n=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:wp(10):t.type==="callback"?t.queueNotification:wp(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},r,{subscribe(u){const h=()=>n&&u(),d=r.subscribe(h);return a.add(u),()=>{d(),a.delete(u)}},dispatch(u){try{return n=!u?.meta?.[jl],i=!n,i&&(o||(o=!0,l(c))),r.dispatch(u)}finally{n=!0}}})},p0=t=>function(s){const{autoBatch:r=!0}=s??{};let n=new Ax(t);return r&&n.push(f0(typeof r=="object"?r:void 0)),n};function m0(t){const e=d0(),{reducer:s=void 0,middleware:r,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof s=="function")a=s;else if(Sn(s))a=xd(s);else throw new Error(Ge(1));let l;typeof r=="function"?l=r(e):l=e();let c=el;n&&(c=c0({trace:!1,...typeof n=="object"&&n}));const u=Nv(...l),h=p0(u);let d=typeof o=="function"?o(h):h();const f=c(...d);return yd(a,i,f)}function yx(t){const e={},s=[];let r;const n={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(Ge(28));if(a in e)throw new Error(Ge(29));return e[a]=o,n},addMatcher(i,o){return s.push({matcher:i,reducer:o}),n},addDefaultCase(i){return r=i,n}};return t(n),[e,s,r]}function g0(t){return typeof t=="function"}function A0(t,e){let[s,r,n]=yx(e),i;if(g0(t))i=()=>bp(t());else{const a=bp(t);i=()=>a}function o(a=i(),l){let c=[s[l.type],...r.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(As(u)){const f=h(u,l);return f===void 0?u:f}else{if(ts(u))return $n(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return d}}return u},a)}return o.getInitialState=i,o}var xx=(t,e)=>u0(t)?t.match(e):t(e);function ys(...t){return e=>t.some(s=>xx(s,e))}function Di(...t){return e=>t.every(s=>xx(s,e))}function Ol(t,e){if(!t||!t.meta)return!1;const s=typeof t.meta.requestId=="string",r=e.indexOf(t.meta.requestStatus)>-1;return s&&r}function ko(t){return typeof t[0]=="function"&&"pending"in t[0]&&"fulfilled"in t[0]&&"rejected"in t[0]}function vd(...t){return t.length===0?e=>Ol(e,["pending"]):ko(t)?ys(...t.map(e=>e.pending)):vd()(t[0])}function kn(...t){return t.length===0?e=>Ol(e,["rejected"]):ko(t)?ys(...t.map(e=>e.rejected)):kn()(t[0])}function Bl(...t){const e=s=>s&&s.meta&&s.meta.rejectedWithValue;return t.length===0?Di(kn(...t),e):ko(t)?Di(kn(...t),e):Bl()(t[0])}function tr(...t){return t.length===0?e=>Ol(e,["fulfilled"]):ko(t)?ys(...t.map(e=>e.fulfilled)):tr()(t[0])}function ih(...t){return t.length===0?e=>Ol(e,["pending","fulfilled","rejected"]):ko(t)?ys(...t.flatMap(e=>[e.pending,e.rejected,e.fulfilled])):ih()(t[0])}var y0="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Co=(t=21)=>{let e="",s=t;for(;s--;)e+=y0[Math.random()*64|0];return e},x0=["name","message","stack","code"],gc=class{constructor(t,e){this.payload=t,this.meta=e}_type},Vp=class{constructor(t,e){this.payload=t,this.meta=e}_type},b0=t=>{if(typeof t=="object"&&t!==null){const e={};for(const s of x0)typeof t[s]=="string"&&(e[s]=t[s]);return e}return{message:String(t)}},qp="External signal was aborted",vp=(()=>{function t(e,s,r){const n=pt(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=pt(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=pt(e+"/rejected",(l,c,u,h,d)=>({payload:h,error:(r&&r.serializeError||b0)(l||"Rejected"),meta:{...d||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,d)=>{const f=r?.idGenerator?r.idGenerator(l):Co(),m=new AbortController;let A,g;function y(x){g=x,m.abort()}c&&(c.aborted?y(qp):c.addEventListener("abort",()=>y(qp),{once:!0}));const w=(async function(){let x;try{let q=r?.condition?.(l,{getState:h,extra:d});if(V0(q)&&(q=await q),q===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const _=new Promise((V,S)=>{A=()=>{S({name:"AbortError",message:g||"Aborted"})},m.signal.addEventListener("abort",A)});u(i(f,l,r?.getPendingMeta?.({requestId:f,arg:l},{getState:h,extra:d}))),x=await Promise.race([_,Promise.resolve(s(l,{dispatch:u,getState:h,extra:d,requestId:f,signal:m.signal,abort:y,rejectWithValue:(V,S)=>new gc(V,S),fulfillWithValue:(V,S)=>new Vp(V,S)})).then(V=>{if(V instanceof gc)throw V;return V instanceof Vp?n(V.payload,f,l,V.meta):n(V,f,l)})])}catch(q){x=q instanceof gc?o(null,f,l,q.payload,q.meta):o(q,f,l)}finally{A&&m.signal.removeEventListener("abort",A)}return r&&!r.dispatchConditionRejection&&o.match(x)&&x.meta.condition||u(x),x})();return Object.assign(w,{abort:y,requestId:f,arg:l,unwrap(){return w.then(w0)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:n,settled:ys(o,n),typePrefix:e})}return t.withTypes=()=>t,t})();function w0(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function V0(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var q0=Symbol.for("rtk-slice-createasyncthunk");function v0(t,e){return`${t}/${e}`}function _0({creators:t}={}){const e=t?.asyncThunk?.[q0];return function(r){const{name:n,reducerPath:i=n}=r;if(!n)throw new Error(Ge(11));const o=(typeof r.reducers=="function"?r.reducers(k0()):r.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(w,x){const b=typeof w=="string"?w:w.type;if(!b)throw new Error(Ge(12));if(b in l.sliceCaseReducersByType)throw new Error(Ge(13));return l.sliceCaseReducersByType[b]=x,c},addMatcher(w,x){return l.sliceMatchers.push({matcher:w,reducer:x}),c},exposeAction(w,x){return l.actionCreators[w]=x,c},exposeCaseReducer(w,x){return l.sliceCaseReducersByName[w]=x,c}};a.forEach(w=>{const x=o[w],b={reducerName:w,type:v0(n,w),createNotation:typeof r.reducers=="function"};P0(x)?T0(b,x,c,e):C0(b,x,c)});function u(){const[w={},x=[],b=void 0]=typeof r.extraReducers=="function"?yx(r.extraReducers):[r.extraReducers],q={...w,...l.sliceCaseReducersByType};return A0(r.initialState,_=>{for(let V in q)_.addCase(V,q[V]);for(let V of l.sliceMatchers)_.addMatcher(V.matcher,V.reducer);for(let V of x)_.addMatcher(V.matcher,V.reducer);b&&_.addDefaultCase(b)})}const h=w=>w,d=new Map;let f;function m(w,x){return f||(f=u()),f(w,x)}function A(){return f||(f=u()),f.getInitialState()}function g(w,x=!1){function b(_){let V=_[w];return typeof V>"u"&&x&&(V=A()),V}function q(_=h){const V=nh(d,x,()=>new WeakMap);return nh(V,_,()=>{const S={};for(const[k,C]of Object.entries(r.selectors??{}))S[k]=S0(C,_,A,x);return S})}return{reducerPath:w,getSelectors:q,get selectors(){return q(b)},selectSlice:b}}const y={name:n,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:A,...g(i),injectInto(w,{reducerPath:x,...b}={}){const q=x??i;return w.inject({reducerPath:q,reducer:m},b),{...y,...g(q,!0)}}};return y}}function S0(t,e,s,r){function n(i,...o){let a=e(i);return typeof a>"u"&&r&&(a=s()),t(a,...o)}return n.unwrapped=t,n}var Es=_0();function k0(){function t(e,s){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...s}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...s){return e(...s)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,s){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:s}},asyncThunk:t}}function C0({type:t,reducerName:e,createNotation:s},r,n){let i,o;if("reducer"in r){if(s&&!E0(r))throw new Error(Ge(17));i=r.reducer,o=r.prepare}else i=r;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?pt(t,o):pt(t))}function P0(t){return t._reducerDefinitionType==="asyncThunk"}function E0(t){return t._reducerDefinitionType==="reducerWithPrepare"}function T0({type:t,reducerName:e},s,r,n){if(!n)throw new Error(Ge(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=s,h=n(t,i,u);r.exposeAction(e,h),o&&r.addCase(h.fulfilled,o),a&&r.addCase(h.pending,a),l&&r.addCase(h.rejected,l),c&&r.addMatcher(h.settled,c),r.exposeCaseReducer(e,{fulfilled:o||Lo,pending:a||Lo,rejected:l||Lo,settled:c||Lo})}function Lo(){}var M0="task",bx="listener",wx="completed",_d="cancelled",R0=`task-${_d}`,I0=`task-${wx}`,oh=`${bx}-${_d}`,j0=`${bx}-${wx}`,Nl=class{constructor(t){this.code=t,this.message=`${M0} ${_d} (reason: ${t})`}name="TaskAbortError";message},Sd=(t,e)=>{if(typeof t!="function")throw new TypeError(Ge(32))},nl=()=>{},Vx=(t,e=nl)=>(t.catch(e),t),qx=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Tr=(t,e)=>{const s=t.signal;s.aborted||("reason"in s||Object.defineProperty(s,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Mr=t=>{if(t.aborted){const{reason:e}=t;throw new Nl(e)}};function vx(t,e){let s=nl;return new Promise((r,n)=>{const i=()=>n(new Nl(t.reason));if(t.aborted){i();return}s=qx(t,i),e.finally(()=>s()).then(r,n)}).finally(()=>{s=nl})}var O0=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(s){return{status:s instanceof Nl?"cancelled":"rejected",error:s}}finally{e?.()}},il=t=>e=>Vx(vx(t,e).then(s=>(Mr(t),s))),_x=t=>{const e=il(t);return s=>e(new Promise(r=>setTimeout(r,s)))},{assign:An}=Object,_p={},zl="listenerMiddleware",B0=(t,e)=>{const s=r=>qx(t,()=>Tr(r,t.reason));return(r,n)=>{Sd(r);const i=new AbortController;s(i);const o=O0(async()=>{Mr(t),Mr(i.signal);const a=await r({pause:il(i.signal),delay:_x(i.signal),signal:i.signal});return Mr(i.signal),a},()=>Tr(i,I0));return n?.autoJoin&&e.push(o.catch(nl)),{result:il(t)(o),cancel(){Tr(i,R0)}}}},N0=(t,e)=>{const s=async(r,n)=>{Mr(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:r,effect:(h,d)=>{d.unsubscribe(),l([h,d.getState(),d.getOriginalState()])}});i=()=>{u(),c()}})];n!=null&&a.push(new Promise(l=>setTimeout(l,n,null)));try{const l=await vx(e,Promise.race(a));return Mr(e),l}finally{i()}};return(r,n)=>Vx(s(r,n))},Sx=t=>{let{type:e,actionCreator:s,matcher:r,predicate:n,effect:i}=t;if(e)n=pt(e).match;else if(s)e=s.type,n=s.match;else if(r)n=r;else if(!n)throw new Error(Ge(21));return Sd(i),{predicate:n,type:e,effect:i}},kx=An(t=>{const{type:e,predicate:s,effect:r}=Sx(t);return{id:Co(),effect:r,type:e,predicate:s,pending:new Set,unsubscribe:()=>{throw new Error(Ge(22))}}},{withTypes:()=>kx}),Sp=(t,e)=>{const{type:s,effect:r,predicate:n}=Sx(e);return Array.from(t.values()).find(i=>(typeof s=="string"?i.type===s:i.predicate===n)&&i.effect===r)},ah=t=>{t.pending.forEach(e=>{Tr(e,oh)})},z0=t=>()=>{t.forEach(ah),t.clear()},kp=(t,e,s)=>{try{t(e,s)}catch(r){setTimeout(()=>{throw r},0)}},Cx=An(pt(`${zl}/add`),{withTypes:()=>Cx}),D0=pt(`${zl}/removeAll`),Px=An(pt(`${zl}/remove`),{withTypes:()=>Px}),F0=(...t)=>{console.error(`${zl}/error`,...t)},L0=(t={})=>{const e=new Map,{extra:s,onError:r=F0}=t;Sd(r);const n=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&ah(u)}),i=u=>{const h=Sp(e,u)??kx(u);return n(h)};An(i,{withTypes:()=>i});const o=u=>{const h=Sp(e,u);return h&&(h.unsubscribe(),u.cancelActive&&ah(h)),!!h};An(o,{withTypes:()=>o});const a=async(u,h,d,f)=>{const m=new AbortController,A=N0(i,m.signal),g=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,An({},d,{getOriginalState:f,condition:(y,w)=>A(y,w).then(Boolean),take:A,delay:_x(m.signal),pause:il(m.signal),extra:s,signal:m.signal,fork:B0(m.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,w,x)=>{y!==m&&(Tr(y,oh),x.delete(y))})},cancel:()=>{Tr(m,oh),u.pending.delete(m)},throwIfCancelled:()=>{Mr(m.signal)}})))}catch(y){y instanceof Nl||kp(r,y,{raisedBy:"effect"})}finally{await Promise.all(g),Tr(m,j0),u.pending.delete(m)}},l=z0(e);return{middleware:u=>h=>d=>{if(!bd(d))return h(d);if(Cx.match(d))return i(d.payload);if(D0.match(d)){l();return}if(Px.match(d))return o(d.payload);let f=u.getState();const m=()=>{if(f===_p)throw new Error(Ge(23));return f};let A;try{if(A=h(d),e.size>0){const g=u.getState(),y=Array.from(e.values());for(const w of y){let x=!1;try{x=w.predicate(d,g,f)}catch(b){x=!1,kp(r,b,{raisedBy:"predicate"})}x&&a(w,d,u,m)}}}finally{f=_p}return A},startListening:i,stopListening:o,clearListeners:l}},U0=t=>"reducerPath"in t&&typeof t.reducerPath=="string",$0=t=>t.flatMap(e=>U0(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),kd=Symbol.for("rtk-state-proxy-original"),H0=t=>!!t&&!!t[kd],W0=new WeakMap,G0=(t,e)=>nh(W0,t,()=>new Proxy(t,{get:(s,r,n)=>{if(r===kd)return s;const i=Reflect.get(s,r,n);if(typeof i>"u"){const o=e[r.toString()];if(o){const a=o(void 0,{type:Co()});if(typeof a>"u")throw new Error(Ge(24));return a}}return i}})),Y0=t=>{if(!H0(t))throw new Error(Ge(25));return t[kd]},K0=(t={})=>t;function Q0(...t){const e=Object.fromEntries($0(t)),s=()=>Object.keys(e).length?xd(e):K0;let r=s();function n(a,l){return r(a,l)}n.withLazyLoadedSlices=()=>n;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,r=s()),n},o=Object.assign(function(l,c){return function(h,...d){return l(G0(c?c(h,...d):h,e),...d)}},{original:Y0});return Object.assign(n,{inject:i,selector:o})}function Ge(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Cd=v.createContext(null),X0=({gameApi:t,children:e})=>p.jsx(Cd,{value:t,children:e}),Hn=()=>{const t=v.useContext(Cd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},Ex=()=>{const t=v.useContext(Cd);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},Tx=L0(),Pd=Tx.startListening.withTypes();function J0(t){var e="";return s(t),e;function s(n){if(n===null||typeof n!="object"||n.toJSON!=null)e+=JSON.stringify(n);else if(Array.isArray(n)){e+="[";var i=!1;n.forEach(function(a){i&&(e+=","),i=!0,a===void 0&&(a=null),s(a)}),e+="]"}else{e+="{";var o=Object.keys(n).filter(function(a){return n[a]!==void 0}).sort();o.forEach(function(a,l){return r(n,a,l)}),e+="}"}}function r(n,i,o){o>0&&(e+=","),e+=JSON.stringify(i),e+=":",s(n[i])}}var Ed="persist:",Td="persist/FLUSH",Po="persist/REHYDRATE",Md="persist/PAUSE",Rd="persist/PERSIST",Id="persist/PURGE",jd="persist/REGISTER",Mx=-1;function za(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?za=function(s){return typeof s}:za=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},za(t)}function Cp(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function Z0(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?Cp(s,!0).forEach(function(r){e_(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Cp(s).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function e_(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function t_(t,e,s,r){r.debug;var n=Z0({},s);return t&&za(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===s[i]&&(n[i]=t[i])}),n}function s_(t){var e=t.blacklist||null,s=t.whitelist||null,r=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:Ed).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(q){return q}:typeof t.serialize=="function"?a=t.serialize:a=r_;var l=t.writeFailHandler||null,c={},u={},h=[],d=null,f=null,m=function(q){Object.keys(q).forEach(function(_){y(_)&&c[_]!==q[_]&&h.indexOf(_)===-1&&h.push(_)}),Object.keys(c).forEach(function(_){q[_]===void 0&&y(_)&&h.indexOf(_)===-1&&c[_]!==void 0&&h.push(_)}),d===null&&(d=setInterval(A,n)),c=q};function A(){if(h.length===0){d&&clearInterval(d),d=null;return}var b=h.shift(),q=r.reduce(function(_,V){return V.in(_,b,c)},c[b]);if(q!==void 0)try{u[b]=a(q)}catch(_){console.error("redux-persist/createPersistoid: error serializing state",_)}else delete u[b];h.length===0&&g()}function g(){Object.keys(u).forEach(function(b){c[b]===void 0&&delete u[b]}),f=o.setItem(i,a(u)).catch(w)}function y(b){return!(s&&s.indexOf(b)===-1&&b!=="_persist"||e&&e.indexOf(b)!==-1)}function w(b){l&&l(b)}var x=function(){for(;h.length!==0;)A();return f||Promise.resolve()};return{update:m,flush:x}}function r_(t){return JSON.stringify(t)}function n_(t){var e=t.transforms||[],s="".concat(t.keyPrefix!==void 0?t.keyPrefix:Ed).concat(t.key),r=t.storage;t.debug;var n;return t.deserialize===!1?n=function(o){return o}:typeof t.deserialize=="function"?n=t.deserialize:n=i_,r.getItem(s).then(function(i){if(i)try{var o={},a=n(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},n(a[l]))}),o}catch(l){throw l}else return})}function i_(t){return JSON.parse(t)}function o_(t){var e=t.storage,s="".concat(t.keyPrefix!==void 0?t.keyPrefix:Ed).concat(t.key);return e.removeItem(s,a_)}function a_(t){}function Pp(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function _s(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?Pp(s,!0).forEach(function(r){l_(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Pp(s).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function l_(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function c_(t,e){if(t==null)return{};var s=u_(t,e),r,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function u_(t,e){if(t==null)return{};var s={},r=Object.keys(t),n,i;for(i=0;i<r.length;i++)n=r[i],!(e.indexOf(n)>=0)&&(s[n]=t[n]);return s}var h_=5e3;function d_(t,e){var s=t.version!==void 0?t.version:Mx;t.debug;var r=t.stateReconciler===void 0?t_:t.stateReconciler,n=t.getStoredState||n_,i=t.timeout!==void 0?t.timeout:h_,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var d=u||{},f=d._persist,m=c_(d,["_persist"]),A=m;if(h.type===Rd){var g=!1,y=function(S,k){g||(h.rehydrate(t.key,S,k),g=!0)};if(i&&setTimeout(function(){!g&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=s_(t)),f)return _s({},e(A,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(V){var S=t.migrate||function(k,C){return Promise.resolve(k)};S(V,s).then(function(k){y(k)},function(k){y(void 0,k)})},function(V){y(void 0,V)}),_s({},e(A,h),{_persist:{version:s,rehydrated:!1}})}else{if(h.type===Id)return a=!0,h.result(o_(t)),_s({},e(A,h),{_persist:f});if(h.type===Td)return h.result(o&&o.flush()),_s({},e(A,h),{_persist:f});if(h.type===Md)l=!0;else if(h.type===Po){if(a)return _s({},A,{_persist:_s({},f,{rehydrated:!0})});if(h.key===t.key){var w=e(A,h),x=h.payload,b=r!==!1&&x!==void 0?r(x,u,w,t):w,q=_s({},b,{_persist:_s({},f,{rehydrated:!0})});return c(q)}}}if(!f)return e(u,h);var _=e(A,h);return _===A?u:c(_s({},_,{_persist:f}))}}function Ep(t){return m_(t)||p_(t)||f_()}function f_(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p_(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function m_(t){if(Array.isArray(t)){for(var e=0,s=new Array(t.length);e<t.length;e++)s[e]=t[e];return s}}function Tp(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function lh(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?Tp(s,!0).forEach(function(r){g_(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Tp(s).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function g_(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var Rx={registry:[],bootstrapped:!1},A_=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rx,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case jd:return lh({},e,{registry:[].concat(Ep(e.registry),[s.key])});case Po:var r=e.registry.indexOf(s.key),n=Ep(e.registry);return n.splice(r,1),lh({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function y_(t,e,s){var r=yd(A_,Rx,void 0),n=function(l){r.dispatch({type:jd,key:l})},i=function(l,c,u){var h={type:Po,payload:c,err:u,key:l};t.dispatch(h),r.dispatch(h)},o=lh({},r,{purge:function(){var l=[];return t.dispatch({type:Id,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:Td,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:Md})},persist:function(){t.dispatch({type:Rd,register:n,rehydrate:i})}});return o.persist(),o}function x_(t,e){return function(s,r){if(!s)return Promise.resolve(void 0);var n=s._persist&&s._persist.version!==void 0?s._persist.version:Mx;if(n===r||n>r)return Promise.resolve(s);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return r>=a&&a>n}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},s);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const Qs=1e-4,Zt=(t,e)=>Math.abs(t-e)<Qs,VU=t=>t===0?Qs:Math.abs(t)<Qs?Qs*Math.sign(t):t,yn=["away","towards","left","right"],b_=["awayRight","towardsRight","towardsLeft","awayLeft"],Cn=[...yn,...b_],Ix=t=>t==="away"||t==="towards"?"y":"x",qU=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",jx=t=>Dl(Ix(t)),Dl=t=>t==="x"?"y":"x",Xs=(t,...e)=>{const s={x:t.x,y:t.y};for(const r of e)s.x+=r.x??0,s.y+=r.y??0;return s},w_=(t,...e)=>{const s={x:t.x,y:t.y};for(const r of e)s.x-=r.x??0,s.y-=r.y??0;return s},Ox=(t,e)=>({x:t.x*e,y:t.y*e}),vU=(t,e)=>(t.x*=e,t.y*=e,t),Gt=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),Mp=(t,e,s)=>{const r=t;return r.x=e.x*s,r.y=e.y*s,r.z=e.z*s,r},V_=(t,e)=>(t.x*=e,t.y*=e,t.z*=e,t),q_=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),Wn=({x:t,y:e,z:s})=>Math.hypot(t,e,s),Bx=({x:t,y:e})=>Math.hypot(t,e),v_=({x:t,y:e,z:s})=>t**2+e**2+s**2,__=({x:t,y:e})=>t**2+e**2,S_=t=>{const e=Wn(t);if(e===0)throw new Error("unitVector called with zero length vector");return Gt(t,1/e)},mn=t=>{const e=Wn(t);if(e===0)throw new Error("unitVectorInPlace called with zero length vector");return V_(t,1/e)},W=(...t)=>{if(t.length===0)return{x:0,y:0,z:0};const[e,...s]=t,r={x:e.x??0,y:e.y??0,z:e.z??0};for(const n of s)r.x+=n.x??0,r.y+=n.y??0,r.z+=n.z??0;return r},k_=(t,...e)=>{for(const s of e)t.x+=s.x??0,t.y+=s.y??0,t.z+=s.z??0;return t},Nx=(...t)=>t.reduce(({x:e,y:s,z:r},{x:n,y:i,z:o})=>({x:e*n,y:s*i,z:r*o}),Eo),Bs=(t,...e)=>{const s={x:t.x,y:t.y,z:t.z};for(const r of e)s.x-=r.x??0,s.y-=r.y??0,s.z-=r.z??0;return s},C_=(t,...e)=>{for(const s of e)t.x-=s.x??0,t.y-=s.y??0,t.z-=s.z??0;return t},Od=({x:t,y:e,z:s},{x:r,y:n,z:i})=>t===r&&e===n&&s===i,P_=({x:t,y:e},{x:s,y:r})=>t===s&&e===r,_U=t=>{const{x:e}=t,s=Math.round(e),r=!Number.isInteger(e)&&Zt(e,s),{y:n}=t,i=Math.round(n),o=!Number.isInteger(n)&&Zt(n,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&Zt(t.z,l);return r||o||c?{x:r?s:e,y:o?i:n,z:c?l:a}:t},SU=({x:t=0,y:e=0,z:s=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(s),kU=({x:t,y:e,z:s})=>({x:Math.round(t),y:Math.round(e),z:Math.round(s)}),zx=Object.freeze({x:0,y:0}),Q=Object.freeze({x:0,y:0,z:0}),Eo=Object.freeze({x:1,y:1,z:1}),CU=Object.freeze({x:1,y:1,z:0}),PU=Object.freeze({x:1,y:0,z:1}),EU=Object.freeze({x:0,y:1,z:1}),TU=Object.freeze({x:1,y:0,z:0}),MU=Object.freeze({x:0,y:1,z:0}),E_=["x","y","z"],ol=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,T_=({x:t,y:e})=>{if(!(Zt(t,0)&&Zt(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},M_=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],Bd=({x:t,y:e})=>{if(Zt(t,0)&&Zt(e,0))return;const s=Math.atan2(-e,-t),r=Math.round(8*s/(2*Math.PI))&7;return M_[r]},RU=({x:t,y:e},{x:s,y:r})=>Math.abs(s-t)**2+Math.abs(r-e)**2,IU=(t,e)=>{const s=t.x*e.x+t.y*e.y+t.z*e.z;if(s<=0)return!1;const r=t.x*t.x+t.y*t.y+t.z*t.z,n=e.x*e.x+e.y*e.y+e.z*e.z;return Math.abs(s*s-r*n)<Qs},jU=t=>{t.x=0,t.y=0,t.z=0},Dx=["lookUp","lookDown","lookLeft","lookRight"],Fx=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","toggleCrtFilter","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...yn,"lookShift",...Dx,"pageUp","pageDown","home","end"],Lx=[...Fx];var Pt={},Ac={},yc={},Rp;function Fl(){if(Rp)return yc;Rp=1;function t(e){return typeof e<"u"}return yc.notUndefined=t,yc}var Ip;function Ux(){if(Ip)return Ac;Ip=1;const{notUndefined:t}=Fl();function e(s){return s!=null&&t(s[Symbol.iterator])}return Ac.isIterable=e,Ac}var xc={},jp;function R_(){return jp||(jp=1,xc.isLoopable=Ux().isIterable),xc}var bc={},Op;function I_(){if(Op)return bc;Op=1;const{notUndefined:t}=Fl();function e(s){return s==null||t(s[Symbol.iterator])}return bc.isWrappable=e,bc}var Uo={},Bp;function j_(){if(Bp)return Uo;Bp=1;function*t(s){yield*s}Uo.wrap=t;function*e(s){s!=null&&(yield*s)}return Uo.nullableWrap=e,Uo}var $o={},Np;function O_(){if(Np)return $o;Np=1;function t(r,n=r.length,i=[]){return(...o)=>n<=o.length?r(...i,...o):t(r,n-o.length,[...i,...o])}$o.curry=t;function e(r,n){const{fn:i,validateArgs:o,variadic:a,reduces:l,growRight:c,minArgs:u,maxArgs:h,isIterable:d,iterableType:f,applyOnIterableArgs:m,IterableClass:A}=r;if(n.length>u){let g=!0;const y=a?n.findIndex((x,b)=>d(x)&&b>=u):Math.min(h,n.length-1),w=a?n.length:y+1;if(a)for(let x=y;x<n.length;x++)g=g&&d(n[x]);else g=d(n[y]);if(n.length>h&&(y===-1||!g)){const x=a?`...${f}s`:f,b=`${i.name} takes up to ${h} arguments, followed by ${x}. You already passed ${n.length} arguments`;throw a?new Error(`${b} and the following arguments were not all ${f}s`):new Error(`${b} and the last argument was not ${f}`)}if(y>=0&&g){for(let b=y;b<w;b++)n[b]=m(n[b]);const x=a?n.slice(y):n[y];return n.splice(y),c||n.reverse(),n.unshift(x),o(n),l?i(...n):new A(i,n)}}return s(r,n)}function s(r,n=[]){return(...i)=>{if(i.length===0)throw new Error("Cannot make a partial application with no arguments");return i.unshift(...n),e(r,i)}}return $o.variadicCurryWithValidation=s,$o}var li={},zp;function B_(){if(zp)return li;zp=1;const t=Symbol.for("_");li._=t;const e=Symbol("__iterate");li.__iterate=e;const s=Symbol("split");return li.split=s,li}var Dp;function kt(){if(Dp)return Pt;Dp=1;const{isIterable:t}=Ux(),{isLoopable:e}=R_(),{isWrappable:s}=I_(),{nullableWrap:r}=j_(),{variadicCurryWithValidation:n}=O_(),{_:i,__iterate:o}=B_();Pt.wrap=r,Pt.isIterable=t,Pt.isLoopable=e,Pt.isWrappable=s;function a(A){if(s(A))return t(A)?A:r(A);throw typeof A.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}Pt.ensureIterable=a;function l(A){"return"in A&&A.return()}Pt.callReturn=l;function c(A,g){this[i]={fn:A,args:g,staticIterator:null}}Pt.BaseIterableIterator=c,Object.assign(c.prototype,{constructor:c,[o](){const{fn:A,args:g}=this[i];return A(...g)},next(){const A=this[i];return A.staticIterator=A.staticIterator||this[o](),A.staticIterator.next()},return(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.return(A)},throw(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.throw(A)}});function u(...A){c.apply(this,A)}Pt.IterableIterator=u,u.prototype=Object.assign(Object.create(c.prototype),{constructor:u,[Symbol.iterator](){return this[o]()}});function h(A,g={}){const{validateArgs:y=S=>{},variadic:w=!1,reduces:x=!1,growRight:b=!1,minArgs:q=A.length-1,maxArgs:_=A.length-1,applyOnIterableArgs:V=a}=g;return{fn:A,validateArgs:y,variadic:w,reduces:x,growRight:b,minArgs:q,maxArgs:_,isIterable:s,iterableType:"iterable",applyOnIterableArgs:V,IterableClass:u}}function d(A){return[...A]}Pt.cache=d;function f(A,{validateArgs:g=y=>y}={}){return(...y)=>(g(y),new u(A,y))}Pt.wrapWithIterableIterator=f;const m=(A,g)=>n(h(A,g));return Pt.iterableCurry=m,Pt}var wc={},Fp;function N_(){if(Fp)return wc;Fp=1;class t{[Symbol.iterator](){return this}}return wc.IterableIterator=t,wc}var ci={},Lp;function $x(){if(Lp)return ci;Lp=1;function t(r,n=!1){return typeof r=="number"&&!isNaN(r)&&isFinite(r)&&!(n&&r===0)}ci.isInteger=t;function e(r,n=!1){return t(r)&&(n?r>0:r>=0)}ci.isPositiveInteger=e;function s(r,n=!1){return typeof r=="number"&&!isNaN(r)&&!(n&&r===0)}return ci.isIntegerOrInfinite=s,ci}var Ho={},Up;function z_(){if(Up)return Ho;Up=1;const{iterableCurry:t}=kt();function*e(r,n){let i=0;for(const o of r)yield n(o,i++)}Ho.__map=e;const s=t(e);return Ho.map=s,Ho}var Wo={},$p;function D_(){if($p)return Wo;$p=1;const{ensureIterable:t}=kt();function e(r){const n=[];for(const i of r)n.push(i);return n}Wo.__toArray=e;function s(r){return e(t(r))}return Wo.toArray=s,Wo}var Vc={},Hp;function Hx(){if(Hp)return Vc;Hp=1;function t(e){return typeof e=="object"&&e!==null}return Vc.isObject=t,Vc}var qc={},Wp;function F_(){if(Wp)return qc;Wp=1;function t(e,s){for(const r of e)s(r)}return qc.parallelEach=t,qc}var vc={},Gp;function L_(){if(Gp)return vc;Gp=1;const{ensureIterable:t,callReturn:e}=kt(),s=Symbol.for("_");class r{constructor(o){this.peekr=o}next(){const{peekr:o}=this,{current:a}=o;return o.advance(),a}return(){return this.peekr.return(),{value:void 0,done:!0}}[Symbol.iterator](){return this}}class n{static from(o,...a){const l=t(o)[Symbol.iterator](),c=l.next();return new this(l,c,...a)}constructor(o,a){this[s]={iterator:o,current:a,index:0}}get current(){return this[s].current}get value(){return this[s].current.value}get done(){return this[s].current.done}get index(){return this[s].index}advance(){const o=this[s];return o.current.done||(o.index++,o.current=o.iterator.next()),this}return(){const o=this[s];return this.done||e(o.iterator),o.current={value:void 0,done:!0},this}asIterator(){return new r(this)}}return vc.Peekerator=n,vc}var _c={},Yp;function U_(){if(Yp)return _c;Yp=1;const{isInteger:t}=$x(),{isObject:e}=Hx(),{notUndefined:s}=Fl(),r=n=>function(o){if(e(o[1])){const{start:a,step:l}=o[1];o[1]=a,o[2]=l}if(s(o[2])&&(o[2]=Number(o[2]),!t(o[2],!0)))throw new Error(`step argument to ${n} must be a non-zero integer`)};return _c.makeValidateArgs=r,_c}var ui={},Kp;function $_(){if(Kp)return ui;Kp=1;const{iterableCurry:t,callReturn:e}=kt(),{IterableIterator:s}=N_(),{parallelEach:r}=F_(),{Peekerator:n}=L_(),{__map:i}=z_(),{__toArray:o}=D_(),a=Symbol.for("_"),l=Symbol.for("__advance");class c extends n{constructor(g,y,w){super(g,y),this[a].inputSummary=w}advance(){this[a].inputSummary.advanceBuffer(this)}[l](){super.advance()}}class u{constructor(){this.buffers=[],this.notDoneBuffer=null,this.index=0}init(g){this.buffers=g,this.updateNotDone()}updateNotDone(){this.notDoneBuffer=this.buffers.find(g=>!g.done)}advanceBuffer(g){const y=g.done;g[l](),this.index++,!y&&g.done&&this.updateNotDone()}}class h{constructor(g){this[a]=g}advance(){throw new Error("advance() is not supported on an interleave summary")}get current(){return{value:this.value,done:this.done}}get value(){return this[a].notDoneBuffer}get done(){return this[a].notDoneBuffer===void 0}get index(){return this[a].index}}ui.InputSummary=h;class d extends s{constructor(g,y,w){super(),this.sources=g,this.strategy=y,this.options=w,this.initialized=!1,this.inputSummary=new u(g)}init(){this.initialized=!0;const{strategy:g,options:y,inputSummary:w}=this;this.buffers=o(i(this.sources,x=>c.from(x,w))),this.iterator=g(y,new h(w),...this.buffers),w.init(this.buffers)}returnBuffers(){r(this.buffers,g=>g.return())}next(){this.initialized||this.init();const g=this.iterator.next();return g.done&&this.returnBuffers(),g}return(){return e(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}function f(A,g,y={}){return new d(A,g,y)}ui.__interleave=f;const m=t(f,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return ui.interleave=m,ui}var Go={},Yo={},Qp;function Wx(){if(Qp)return Yo;Qp=1;const{iterableCurry:t,callReturn:e}=kt();function s(n,i){const o=n[Symbol.iterator](),{value:a,done:l}=o.next();return l?i:(e(o),a)}Yo.__firstOr=s;const r=t(s,{reduces:!0});return Yo.firstOr=r,Yo}var Xp;function H_(){if(Xp)return Go;Xp=1;const{iterableCurry:t}=kt(),{__firstOr:e}=Wx();function s(n){return e(n,void 0)}Go.__first=s;const r=t(s,{reduces:!0});return Go.first=r,Go}var Ko={},Jp;function W_(){if(Jp)return Ko;Jp=1;const{iterableCurry:t}=kt(),{__firstOr:e}=Wx(),s=Symbol("none");function r(i){return e(i,s)===s}Ko.__isEmpty=r;const n=t(r,{reduces:!0});return Ko.isEmpty=n,Ko}var Qo={},Zp;function G_(){if(Zp)return Qo;Zp=1;const{wrapWithIterableIterator:t}=kt(),{hasOwnProperty:e}=Object.prototype;function*s(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield[i,n[i]])}Qo.__objectEntries=s;const r=t(s,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return Qo.objectEntries=r,Qo}var Xo={},em;function Y_(){if(em)return Xo;em=1;const{wrapWithIterableIterator:t}=kt(),{hasOwnProperty:e}=Object.prototype;function*s(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield i)}Xo.__objectKeys=s;const r=t(s,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return Xo.objectKeys=r,Xo}var Jo={},tm;function K_(){if(tm)return Jo;tm=1;const{wrapWithIterableIterator:t}=kt(),{hasOwnProperty:e}=Object.prototype;function*s(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield n[i])}Jo.__objectValues=s;const r=t(s,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return Jo.objectValues=r,Jo}var Zo={},sm;function Q_(){if(sm)return Zo;sm=1;const{wrapWithIterableIterator:t}=kt(),{isInteger:e,isIntegerOrInfinite:s}=$x(),{isObject:r}=Hx(),{notUndefined:n}=Fl();function*i(a=0,l=1/0,c=1){for(let u=a;c>0?u<l:u>l;u+=c)yield u}Zo.__range=i;const o=t(i,{growRight:!0,validateArgs(a){let[l,c=1/0,u]=a,h;if(r(l)?{start:h,end:c,step:u}=l:a.length>1?h=l:c=l,n(h)&&!e(h))throw new TypeError("The specified start was not an integer");if(n(c)&&!s(c))throw new TypeError("The specified end was not an integer or infinite");if(n(u)&&!e(u,!0))throw new TypeError("The specified step was not a non-zero integer");a[0]=h,a[1]=c,a[2]=u}});return Zo.range=o,Zo}var ea={},rm;function X_(){if(rm)return ea;rm=1;const{iterableCurry:t}=kt(),{__interleave:e}=$_(),{makeValidateArgs:s}=U_();function*r({start:o,step:a},l,...c){o=o%c.length;for(let u=o;!l.done;u=(u+a)%c.length){const h=c[u];h.done||(yield h.value,h.advance())}}function n(o,a=1,l=0){return e(o,r,{start:l,step:a})}ea.__roundRobin=n;const i=t(n,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:s("roundRobin")});return ea.roundRobin=i,ea}var ta={},nm;function J_(){if(nm)return ta;nm=1;const{ensureIterable:t}=kt();function e(r){const n=t(r);let i=0;for(const o of n)i++;return i}ta.__size=e;const s=e;return ta.size=s,ta}var sa={},im;function Z_(){if(im)return sa;im=1;const{iterableCurry:t}=kt();function*e(r,n){if(n===0)return;let i=0;for(const o of r)if(yield o,++i===n)break}sa.__take=e;const s=t(e);return sa.take=s,sa}var Sc,om;function eS(){return om||(om=1,Sc=H_().first),Sc}var tS=eS();const Gx=Ke(tS);var kc,am;function sS(){return am||(am=1,kc=W_().isEmpty),kc}var rS=sS();const lm=Ke(rS);var Cc,cm;function nS(){return cm||(cm=1,Cc=G_().objectEntries),Cc}var iS=nS();const Nd=Ke(iS);var Pc,um;function oS(){return um||(um=1,Pc=Y_().objectKeys),Pc}var aS=oS();const Yx=Ke(aS);var Ec,hm;function lS(){return hm||(hm=1,Ec=K_().objectValues),Ec}var cS=lS();const Ls=Ke(cS);var Tc,dm;function uS(){return dm||(dm=1,Tc=Q_().range),Tc}var hS=uS();const Kx=Ke(hS);var Mc,fm;function dS(){return fm||(fm=1,Mc=X_().roundRobin),Mc}var fS=dS();const pS=Ke(fS);var Rc,pm;function mS(){return pm||(pm=1,Rc=J_().size),Rc}var gS=mS();const ch=Ke(gS);var Ic,mm;function AS(){return mm||(mm=1,Ic=Z_().take),Ic}var yS=AS();const xS=Ke(yS),Ye=t=>t[Symbol.iterator](),To=Object.entries,Qx=Nd,Xx=Object.keys,Jx=Yx,bS=Object.fromEntries,Gn=Object.fromEntries,zd=(t,e)=>{const r=Ye(Qx(t)).map(e);return bS(r)},Zx={presses:Gn(Lx.map(t=>[t,{keys:[],gamepadButtons:[]}])),axes:{x:[],y:[],xLook:[],yLook:[]},radialAxes:{xy:[]}},ra=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Lr(...t){const e=new Set,s=new Set,r=new Set,n=new Set;return t.reduceRight((i,o)=>{const a=new Set(e),l=new Set(s),c=new Set(r),u=new Set(n);for(const f of Lx){const m=o?.presses?.[f]?.keys??[],A=o?.presses?.[f]?.gamepadButtons??[],g=m.filter(w=>!a.has(w)),y=A.filter(w=>!l.has(w));i.presses[f]={keys:ra(i.presses[f]?.keys,g),gamepadButtons:ra(i.presses[f]?.gamepadButtons,y)};for(const w of m)e.add(w);for(const w of A)s.add(w)}for(const f of["x","y","xLook","yLook"]){const m=o.axes?.[f]??[],A=m.filter(g=>!c.has(g));i.axes[f]=ra(i.axes[f],A);for(const g of m)r.add(g)}const h=o.radialAxes?.xy??[],d=h.filter(f=>!u.has(f));i.radialAxes&&(i.radialAxes.xy=ra(i.radialAxes.xy,d));for(const f of h)n.add(f);return i},structuredClone(Zx))}const Yn={buttons:{dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,lPress:10,rPress:11},axes:{lStickX:0,lStickY:1,rStickX:2,rStickY:3},radialAxes:{}},wS={buttons:{a:0,b:1,x:3,y:4,lb:6,lt:8,rb:7,rt:9,select:10,start:11,l3:2,r3:5},axes:{lStickX:0,lStickY:1,rStickX:2,rStickY:5},radialAxes:{xy:9}},gm=zd(Yn.buttons,([t,e])=>[e,t]),VS={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},Wr={directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},zt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},Ur={presses:{right:{keys:["ArrowRight"]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},jump:{keys:[" ","`","Z","\\"]},carry:{keys:["Shift","`","Z","\\"]},fire:{keys:["D"]},swop:{keys:["Enter"]},"swop.head":{keys:["[","A"]},"swop.heels":{keys:["]","S"]},hold:{keys:["P"]},map:{keys:["M","Tab"]},menu_openOrExit:{keys:["Escape",""]},menu_select:{keys:["Enter"]},toggleCrtFilter:{keys:["F8","T"]},toggleShowFps:{keys:["F9"]},toggleColourisation:{keys:["F10"]},cycleResolution:{keys:["0"]},pageDown:{keys:["PageDown"]},pageUp:{keys:["PageUp"]},home:{keys:["Home"]},end:{keys:["End"]}}},Kn=({buttons:t,axes:e,radialAxes:s})=>{const r=n=>n!==void 0;return{presses:{right:{gamepadButtons:[t.dPadRight].filter(r)},towards:{gamepadButtons:[t.dPadDown].filter(r)},left:{gamepadButtons:[t.dPadLeft].filter(r)},away:{gamepadButtons:[t.dPadUp].filter(r)},jump:{gamepadButtons:[t.a,t.y].filter(r)},carry:{gamepadButtons:[t.x,t.y].filter(r)},fire:{gamepadButtons:[t.b].filter(r)},lookShift:{gamepadButtons:[t.rb].filter(r)},"swop.head":{gamepadButtons:[t.lt].filter(r)},"swop.heels":{gamepadButtons:[t.rt].filter(r)},hold:{gamepadButtons:[t.start].filter(r)},menu_select:{gamepadButtons:[t.a].filter(r)},menu_exit:{gamepadButtons:[t.b].filter(r)},menu_openOrExit:{gamepadButtons:[t.select].filter(r)},map:{gamepadButtons:[t.lb].filter(r)},toggleCrtFilter:{gamepadButtons:[t.l3].filter(r)},toggleShowFps:{gamepadButtons:[t.r3].filter(r)}},axes:{x:[e.lStickX].filter(r),y:[e.lStickY].filter(r),xLook:[e.rStickX].filter(r),yLook:[e.rStickY].filter(r)},radialAxes:{xy:[s.xy].filter(r)}}},qS={inputAssignment:Lr(Ur,Kn(Yn),{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"Closely matches the ZX Spectrum original game's keys"},vS={inputAssignment:Lr(Ur,Kn(Yn),{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"Closely matches Amiga version keys - heavy on the F-keys"},_S={inputAssignment:Lr(Ur,Kn(Yn),{presses:{lookUp:{keys:["I"]},lookDown:{keys:["K"]},lookLeft:{keys:["J"]},lookRight:{keys:["L"]},lookShift:{keys:["C"]}}}),description:"Combined key and joystick/gamepad assignment, should work on most setups"},SS={inputAssignment:Lr(Ur,Kn(Yn),{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},kS={inputAssignment:Lr(Ur,Kn(Yn),{presses:{right:{keys:[zt.dPadRight]},towards:{keys:[zt.dPadDown]},left:{keys:[zt.dPadLeft]},away:{keys:[zt.dPadUp]},jump:{keys:[zt.a,zt.y]},carry:{keys:[zt.b,zt.y]},fire:{keys:[zt.x]},swop:{keys:[zt.rb]},hold:{keys:[zt.start]},menu_openOrExit:{keys:[zt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that dont support controllers"},CS={inputAssignment:Lr(Ur,Kn(wS)),description:"8Bitdo Ultimate 2c Wired reports in a non-standard way on some systems - use this if you have this controller and it doesn't work as expected"},PS=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]},lookShift:{keys:[t.buttons[5]]}}}),ES={inputAssignment:Lr(Zx,Ur,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},PS(VS),{presses:{lookDown:{keys:[Wr.directions.down]},lookLeft:{keys:[Wr.directions.left]},lookRight:{keys:[Wr.directions.right]},lookUp:{keys:[Wr.directions.up]},"swop.head":{keys:[Wr.buttons[0]]},"swop.heels":{keys:[Wr.buttons[1]]}}}),description:"Arcade-style control panels"},Pn={Default:_S,"ZX Spec":qS,Amiga:vS,MAME:ES,WASD:SS," 8b kbd":kS," 8b U2c":CS},Dd=()=>ms().get("campaignName")?.startsWith("data:"),OU=["yellow","cyan","green","magenta","white"],Mo=25,BU=1e3/Mo,Qn={amigaHiResPal:{name:"Amiga Hi-Res PAL",size:{x:640,y:512}},classicMac:{name:"Classic Mac",size:{x:512,y:384}},amigaLowResPal:{name:"Amiga Lo-Res PAL",size:{x:320,y:256}},zxSpectrum:{name:"ZX Spectrum",size:{x:256,y:192}},handheld:{name:"Handheld",size:{x:256,y:135}}},TS=Object.keys(Qn),NU={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},Da=()=>mt()==="mobile"||mt()==="tablet",mt=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},MS=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,xn=[],eb=new Set,zU=new Map;eb.add=()=>{throw new Error("emptySet.add")};eb.clear=()=>{throw new Error("emptySet.clear")};const pe=Object.freeze({}),al=(t,e)=>e.split(".").reduce((s,r)=>s[r],t),RS=(t,e,s)=>{const r=e.split(".");let n=t;for(let i=0;i<r.length-1;i++){const o=r[i];n=n[o]}n[r[r.length-1]]=s},na=(t,e)=>{const s=t.indexOf(e);return t[(s+1)%t.length]},no=(t,...e)=>{const s={};for(const r of e)s[r]=t[r];return s},DU=(t,...e)=>{const s={...t};for(const r of e)delete s[r];return s},tb=["world","screen","mixed"];var jc,Am;function IS(){if(Am)return jc;Am=1;function t(r){if(Array.isArray(r))return!0;var n=r.length;return typeof n=="number"&&n>-1?n?0 in r&&n-1 in r:!0:!1}function e(r){var n=typeof r;return n==="object"?r===null?"null":t(r)?"array":r.constructor===Object?"pure-object":"object":n}function s(r,n){if(r===n||r!==r&&n!==n)return!0;var i=e(r),o=e(n);if(i!==o)return!1;if(i==="pure-object"){if(r===n)return!0;var a=Object.keys(r),l=Object.keys(n).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!n.hasOwnProperty(a[c]))return!1;var d=r[h],f=n[h];if(d===r||f===n||d===n||f===r)return d===f;if(!s(d,f))return!1}return!0}else if(i==="array"){if(r.length===n.length)for(var m=0;m<r.length;m++){var A=r[m],g=n[m];if(A===r||g===n||A===n||g===r)return A===g;if(!s(A,g))return!1}else return!1;return!0}else if(i==="object"){if(r.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return r.valueOf()===n.valueOf();if(r.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return r.toString()===n.toString()}return!1}return jc=s,jc}var jS=IS();const OS=Ke(jS),Fd=Zy.withTypes(),K=ex.withTypes();pd.withTypes();const sb=t=>()=>K(t);var rb=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(rb||{});function ym(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var xm=Sn;function nb(t,e){if(t===e||!(xm(t)&&xm(e)||Array.isArray(t)&&Array.isArray(e)))return e;const s=Object.keys(e),r=Object.keys(t);let n=s.length===r.length;const i=Array.isArray(e)?[]:{};for(const o of s)i[o]=nb(t[o],e[o]),n&&(n=t[o]===i[o]);return n?t:i}function bn(t){let e=0;for(const s in t)e++;return e}var bm=t=>[].concat(...t);function BS(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function ll(t){return t!=null}function NS(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}function zS(t,e,s){return t.has(e)?t.get(e):t.set(e,s).get(e)}var wm=class{constructor(t,e=void 0){this.value=t,this.meta=e}},Ld=pt("__rtkq/focused"),ib=pt("__rtkq/unfocused"),Ud=pt("__rtkq/online"),ob=pt("__rtkq/offline");function $d(t){return t.type==="query"}function DS(t){return t.type==="mutation"}function Hd(t){return t.type==="infinitequery"}function Wd(t,e,s,r,n,i){return FS(t)?t(e,s,r,n).filter(ll).map(uh).map(i):Array.isArray(t)?t.map(uh).map(i):[]}function FS(t){return typeof t=="function"}function uh(t){return typeof t=="string"?{type:t}:t}function LS(t,e){return t.catch(e)}var io=Symbol("forceQueryFn"),hh=t=>typeof t[io]=="function";function US({serializeQueryArgs:t,queryThunk:e,infiniteQueryThunk:s,mutationThunk:r,api:n,context:i}){const o=new Map,a=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:u}=n.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:y,buildInitiateMutation:w,getRunningQueryThunk:h,getRunningMutationThunk:d,getRunningQueriesThunk:f,getRunningMutationsThunk:m};function h(x,b){return q=>{const _=i.endpointDefinitions[x],V=t({queryArgs:b,endpointDefinition:_,endpointName:x});return o.get(q)?.[V]}}function d(x,b){return q=>a.get(q)?.[b]}function f(){return x=>Object.values(o.get(x)||{}).filter(ll)}function m(){return x=>Object.values(a.get(x)||{}).filter(ll)}function A(x,b){const q=(_,{subscribe:V=!0,forceRefetch:S,subscriptionOptions:k,[io]:C,...P}={})=>(T,M)=>{const I=t({queryArgs:_,endpointDefinition:b,endpointName:x});let z;const E={...P,type:"query",subscribe:V,forceRefetch:S,subscriptionOptions:k,endpointName:x,originalArgs:_,queryCacheKey:I,[io]:C};if($d(b))z=e(E);else{const{direction:he,initialPageParam:Fe}=P;z=s({...E,direction:he,initialPageParam:Fe})}const R=n.endpoints[x].select(_),D=T(z),F=R(M()),{requestId:Y,abort:ge}=D,oe=F.requestId!==Y,se=o.get(T)?.[I],Ae=()=>R(M()),ae=Object.assign(C?D.then(Ae):oe&&!se?Promise.resolve(F):Promise.all([se,D]).then(Ae),{arg:_,requestId:Y,subscriptionOptions:k,queryCacheKey:I,abort:ge,async unwrap(){const he=await ae;if(he.isError)throw he.error;return he.data},refetch:()=>T(q(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){V&&T(l({queryCacheKey:I,requestId:Y}))},updateSubscriptionOptions(he){ae.subscriptionOptions=he,T(u({endpointName:x,requestId:Y,queryCacheKey:I,options:he}))}});if(!se&&!oe&&!C){const he=zS(o,T,{});he[I]=ae,ae.then(()=>{delete he[I],bn(he)||o.delete(T)})}return ae};return q}function g(x,b){return A(x,b)}function y(x,b){return A(x,b)}function w(x){return(b,{track:q=!0,fixedCacheKey:_}={})=>(V,S)=>{const k=r({type:"mutation",endpointName:x,originalArgs:b,track:q,fixedCacheKey:_}),C=V(k),{requestId:P,abort:T,unwrap:M}=C,I=LS(C.unwrap().then(D=>({data:D})),D=>({error:D})),z=()=>{V(c({requestId:P,fixedCacheKey:_}))},E=Object.assign(I,{arg:C.arg,requestId:P,abort:T,unwrap:M,reset:z}),R=a.get(V)||{};return a.set(V,R),R[P]=E,E.then(()=>{delete R[P],bn(R)||a.delete(V)}),_&&(R[_]=E,E.then(()=>{R[_]===E&&(delete R[_],bn(R)||a.delete(V))})),E}}}function $S(t){return t}var ia=(t={})=>({...t,[jl]:!0});function HS({reducerPath:t,baseQuery:e,context:{endpointDefinitions:s},serializeQueryArgs:r,api:n,assertTagType:i,selectors:o}){const a=(S,k,C,P)=>(T,M)=>{const I=s[S],z=r({queryArgs:k,endpointDefinition:I,endpointName:S});if(T(n.internalActions.queryResultPatched({queryCacheKey:z,patches:C})),!P)return;const E=n.endpoints[S].select(k)(M()),R=Wd(I.providesTags,E.data,void 0,k,{},i);T(n.internalActions.updateProvidedBy({queryCacheKey:z,providedTags:R}))};function l(S,k,C=0){const P=[k,...S];return C&&P.length>C?P.slice(0,-1):P}function c(S,k,C=0){const P=[...S,k];return C&&P.length>C?P.slice(1):P}const u=(S,k,C,P=!0)=>(T,M)=>{const z=n.endpoints[S].select(k)(M()),E={patches:[],inversePatches:[],undo:()=>T(n.util.patchQueryData(S,k,E.inversePatches,P))};if(z.status==="uninitialized")return E;let R;if("data"in z)if(ts(z.data)){const[D,F,Y]=mx(z.data,C);E.patches.push(...F),E.inversePatches.push(...Y),R=D}else R=C(z.data),E.patches.push({op:"replace",path:[],value:R}),E.inversePatches.push({op:"replace",path:[],value:z.data});return E.patches.length===0||T(n.util.patchQueryData(S,k,E.patches,P)),E},h=(S,k,C)=>P=>P(n.endpoints[S].initiate(k,{subscribe:!1,forceRefetch:!0,[io]:()=>({data:C})})),d=(S,k)=>S.query&&S[k]?S[k]:$S,f=async(S,{signal:k,abort:C,rejectWithValue:P,fulfillWithValue:T,dispatch:M,getState:I,extra:z})=>{const E=s[S.endpointName];try{let R=d(E,"transformResponse");const D={signal:k,abort:C,dispatch:M,getState:I,extra:z,endpoint:S.endpointName,type:S.type,forced:S.type==="query"?m(S,I()):void 0,queryCacheKey:S.type==="query"?S.queryCacheKey:void 0},F=S.type==="query"?S[io]:void 0;let Y;const ge=async(se,Ae,ae,he)=>{if(Ae==null&&se.pages.length)return Promise.resolve({data:se});const Fe={queryArg:S.originalArgs,pageParam:Ae},ls=await oe(Fe),xt=he?l:c;return{data:{pages:xt(se.pages,ls.data,ae),pageParams:xt(se.pageParams,Ae,ae)}}};async function oe(se){let Ae;const{extraOptions:ae}=E;if(F?Ae=F():E.query?Ae=await e(E.query(se),D,ae):Ae=await E.queryFn(se,D,ae,Fe=>e(Fe,D,ae)),typeof process<"u",Ae.error)throw new wm(Ae.error,Ae.meta);const he=await R(Ae.data,Ae.meta,se);return{...Ae,data:he}}if(S.type==="query"&&"infiniteQueryOptions"in E){const{infiniteQueryOptions:se}=E,{maxPages:Ae=1/0}=se;let ae;const he={pages:[],pageParams:[]},Fe=o.selectQueryEntry(I(),S.queryCacheKey)?.data,xt=m(S,I())&&!S.direction||!Fe?he:Fe;if("direction"in S&&S.direction&&xt.pages.length){const Yt=S.direction==="backward",Ct=(Yt?ab:dh)(se,xt);ae=await ge(xt,Ct,Ae,Yt)}else{const{initialPageParam:Yt=se.initialPageParam}=S,qs=Fe?.pageParams??[],Ct=qs[0]??Yt,bt=qs.length;ae=await ge(xt,Ct,Ae),F&&(ae={data:ae.data.pages[0]});for(let cs=1;cs<bt;cs++){const vs=dh(se,ae.data);ae=await ge(ae.data,vs,Ae)}}Y=ae}else Y=await oe(S.originalArgs);return T(Y.data,ia({fulfilledTimeStamp:Date.now(),baseQueryMeta:Y.meta}))}catch(R){let D=R;if(D instanceof wm){let F=d(E,"transformErrorResponse");try{return P(await F(D.value,D.meta,S.originalArgs),ia({baseQueryMeta:D.meta}))}catch(Y){D=Y}}throw console.error(D),D}};function m(S,k){const C=o.selectQueryEntry(k,S.queryCacheKey),P=o.selectConfig(k).refetchOnMountOrArgChange,T=C?.fulfilledTimeStamp,M=S.forceRefetch??(S.subscribe&&P);return M?M===!0||(Number(new Date)-Number(T))/1e3>=M:!1}const A=()=>vp(`${t}/executeQuery`,f,{getPendingMeta({arg:k}){const C=s[k.endpointName];return ia({startedTimeStamp:Date.now(),...Hd(C)?{direction:k.direction}:{}})},condition(k,{getState:C}){const P=C(),T=o.selectQueryEntry(P,k.queryCacheKey),M=T?.fulfilledTimeStamp,I=k.originalArgs,z=T?.originalArgs,E=s[k.endpointName],R=k.direction;return hh(k)?!0:T?.status==="pending"?!1:m(k,P)||$d(E)&&E?.forceRefetch?.({currentArg:I,previousArg:z,endpointState:T,state:P})?!0:!(M&&!R)},dispatchConditionRejection:!0}),g=A(),y=A(),w=vp(`${t}/executeMutation`,f,{getPendingMeta(){return ia({startedTimeStamp:Date.now()})}}),x=S=>"force"in S,b=S=>"ifOlderThan"in S,q=(S,k,C)=>(P,T)=>{const M=x(C)&&C.force,I=b(C)&&C.ifOlderThan,z=(R=!0)=>{const D={forceRefetch:R,isPrefetch:!0};return n.endpoints[S].initiate(k,D)},E=n.endpoints[S].select(k)(T());if(M)P(z());else if(I){const R=E?.fulfilledTimeStamp;if(!R){P(z());return}(Number(new Date)-Number(new Date(R)))/1e3>=I&&P(z())}else P(z(!1))};function _(S){return k=>k?.meta?.arg?.endpointName===S}function V(S,k){return{matchPending:Di(vd(S),_(k)),matchFulfilled:Di(tr(S),_(k)),matchRejected:Di(kn(S),_(k))}}return{queryThunk:g,mutationThunk:w,infiniteQueryThunk:y,prefetch:q,updateQueryData:u,upsertQueryData:h,patchQueryData:a,buildMatchThunkActions:V}}function dh(t,{pages:e,pageParams:s}){const r=e.length-1;return t.getNextPageParam(e[r],e,s[r],s)}function ab(t,{pages:e,pageParams:s}){return t.getPreviousPageParam?.(e[0],e,s[0],s)}function lb(t,e,s,r){return Wd(s[t.meta.arg.endpointName][e],tr(t)?t.payload:void 0,Bl(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,r)}function oa(t,e,s){const r=t[e];r&&s(r)}function oo(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function Vm(t,e,s){const r=t[oo(e)];r&&s(r)}var hi={};function WS({reducerPath:t,queryThunk:e,mutationThunk:s,serializeQueryArgs:r,context:{endpointDefinitions:n,apiUid:i,extractRehydrationInfo:o,hasRehydrationInfo:a},assertTagType:l,config:c}){const u=pt(`${t}/resetApiState`);function h(V,S,k,C){V[S.queryCacheKey]??={status:"uninitialized",endpointName:S.endpointName},oa(V,S.queryCacheKey,P=>{P.status="pending",P.requestId=k&&P.requestId?P.requestId:C.requestId,S.originalArgs!==void 0&&(P.originalArgs=S.originalArgs),P.startedTimeStamp=C.startedTimeStamp;const T=n[C.arg.endpointName];Hd(T)&&"direction"in S&&(P.direction=S.direction)})}function d(V,S,k,C){oa(V,S.arg.queryCacheKey,P=>{if(P.requestId!==S.requestId&&!C)return;const{merge:T}=n[S.arg.endpointName];if(P.status="fulfilled",T)if(P.data!==void 0){const{fulfilledTimeStamp:M,arg:I,baseQueryMeta:z,requestId:E}=S;let R=$n(P.data,D=>T(D,k,{arg:I.originalArgs,baseQueryMeta:z,fulfilledTimeStamp:M,requestId:E}));P.data=R}else P.data=k;else P.data=n[S.arg.endpointName].structuralSharing??!0?nb(As(P.data)?Dv(P.data):P.data,k):k;delete P.error,P.fulfilledTimeStamp=S.fulfilledTimeStamp})}const f=Es({name:`${t}/queries`,initialState:hi,reducers:{removeQueryResult:{reducer(V,{payload:{queryCacheKey:S}}){delete V[S]},prepare:ai()},cacheEntriesUpserted:{reducer(V,S){for(const k of S.payload){const{queryDescription:C,value:P}=k;h(V,C,!0,{arg:C,requestId:S.meta.requestId,startedTimeStamp:S.meta.timestamp}),d(V,{arg:C,requestId:S.meta.requestId,fulfilledTimeStamp:S.meta.timestamp,baseQueryMeta:{}},P,!0)}},prepare:V=>({payload:V.map(C=>{const{endpointName:P,arg:T,value:M}=C,I=n[P];return{queryDescription:{type:"query",endpointName:P,originalArgs:C.arg,queryCacheKey:r({queryArgs:T,endpointDefinition:I,endpointName:P})},value:M}}),meta:{[jl]:!0,requestId:Co(),timestamp:Date.now()}})},queryResultPatched:{reducer(V,{payload:{queryCacheKey:S,patches:k}}){oa(V,S,C=>{C.data=Ap(C.data,k.concat())})},prepare:ai()}},extraReducers(V){V.addCase(e.pending,(S,{meta:k,meta:{arg:C}})=>{const P=hh(C);h(S,C,P,k)}).addCase(e.fulfilled,(S,{meta:k,payload:C})=>{const P=hh(k.arg);d(S,k,C,P)}).addCase(e.rejected,(S,{meta:{condition:k,arg:C,requestId:P},error:T,payload:M})=>{oa(S,C.queryCacheKey,I=>{if(!k){if(I.requestId!==P)return;I.status="rejected",I.error=M??T}})}).addMatcher(a,(S,k)=>{const{queries:C}=o(k);for(const[P,T]of Object.entries(C))(T?.status==="fulfilled"||T?.status==="rejected")&&(S[P]=T)})}}),m=Es({name:`${t}/mutations`,initialState:hi,reducers:{removeMutationResult:{reducer(V,{payload:S}){const k=oo(S);k in V&&delete V[k]},prepare:ai()}},extraReducers(V){V.addCase(s.pending,(S,{meta:k,meta:{requestId:C,arg:P,startedTimeStamp:T}})=>{P.track&&(S[oo(k)]={requestId:C,status:"pending",endpointName:P.endpointName,startedTimeStamp:T})}).addCase(s.fulfilled,(S,{payload:k,meta:C})=>{C.arg.track&&Vm(S,C,P=>{P.requestId===C.requestId&&(P.status="fulfilled",P.data=k,P.fulfilledTimeStamp=C.fulfilledTimeStamp)})}).addCase(s.rejected,(S,{payload:k,error:C,meta:P})=>{P.arg.track&&Vm(S,P,T=>{T.requestId===P.requestId&&(T.status="rejected",T.error=k??C)})}).addMatcher(a,(S,k)=>{const{mutations:C}=o(k);for(const[P,T]of Object.entries(C))(T?.status==="fulfilled"||T?.status==="rejected")&&P!==T?.requestId&&(S[P]=T)})}}),A=Es({name:`${t}/invalidation`,initialState:hi,reducers:{updateProvidedBy:{reducer(V,S){const{queryCacheKey:k,providedTags:C}=S.payload;for(const P of Object.values(V))for(const T of Object.values(P)){const M=T.indexOf(k);M!==-1&&T.splice(M,1)}for(const{type:P,id:T}of C){const M=(V[P]??={})[T||"__internal_without_id"]??=[];M.includes(k)||M.push(k)}},prepare:ai()}},extraReducers(V){V.addCase(f.actions.removeQueryResult,(S,{payload:{queryCacheKey:k}})=>{for(const C of Object.values(S))for(const P of Object.values(C)){const T=P.indexOf(k);T!==-1&&P.splice(T,1)}}).addMatcher(a,(S,k)=>{const{provided:C}=o(k);for(const[P,T]of Object.entries(C))for(const[M,I]of Object.entries(T)){const z=(S[P]??={})[M||"__internal_without_id"]??=[];for(const E of I)z.includes(E)||z.push(E)}}).addMatcher(ys(tr(e),Bl(e)),(S,k)=>{g(S,k)}).addMatcher(f.actions.cacheEntriesUpserted.match,(S,k)=>{for(const{queryDescription:C,value:P}of k.payload)g(S,{type:"UNKNOWN",payload:P,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:C}})})}});function g(V,S){const k=lb(S,"providesTags",n,l),{queryCacheKey:C}=S.meta.arg;A.caseReducers.updateProvidedBy(V,A.actions.updateProvidedBy({queryCacheKey:C,providedTags:k}))}const y=Es({name:`${t}/subscriptions`,initialState:hi,reducers:{updateSubscriptionOptions(V,S){},unsubscribeQueryResult(V,S){},internal_getRTKQSubscriptions(){}}}),w=Es({name:`${t}/internalSubscriptions`,initialState:hi,reducers:{subscriptionsUpdated:{reducer(V,S){return Ap(V,S.payload)},prepare:ai()}}}),x=Es({name:`${t}/config`,initialState:{online:NS(),focused:BS(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(V,{payload:S}){V.middlewareRegistered=V.middlewareRegistered==="conflict"||i!==S?"conflict":!0}},extraReducers:V=>{V.addCase(Ud,S=>{S.online=!0}).addCase(ob,S=>{S.online=!1}).addCase(Ld,S=>{S.focused=!0}).addCase(ib,S=>{S.focused=!1}).addMatcher(a,S=>({...S}))}}),b=xd({queries:f.reducer,mutations:m.reducer,provided:A.reducer,subscriptions:w.reducer,config:x.reducer}),q=(V,S)=>b(u.match(S)?void 0:V,S),_={...x.actions,...f.actions,...y.actions,...w.actions,...m.actions,...A.actions,resetApiState:u};return{reducer:q,actions:_}}var Ts=Symbol.for("RTKQ/skipToken"),cb={status:"uninitialized"},qm=$n(cb,()=>{}),vm=$n(cb,()=>{});function GS({serializeQueryArgs:t,reducerPath:e,createSelector:s}){const r=x=>qm,n=x=>vm;return{buildQuerySelector:d,buildInfiniteQuerySelector:f,buildMutationSelector:m,selectInvalidatedBy:A,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function i(x){return{...x,...ym(x.status)}}function o(x){return x[e]}function a(x){return o(x)?.queries}function l(x,b){return a(x)?.[b]}function c(x){return o(x)?.mutations}function u(x){return o(x)?.config}function h(x,b,q){return _=>{if(_===Ts)return s(r,q);const V=t({queryArgs:_,endpointDefinition:b,endpointName:x});return s(k=>l(k,V)??qm,q)}}function d(x,b){return h(x,b,i)}function f(x,b){const{infiniteQueryOptions:q}=b;function _(V){const S={...V,...ym(V.status)},{isLoading:k,isError:C,direction:P}=S,T=P==="forward",M=P==="backward";return{...S,hasNextPage:y(q,S.data),hasPreviousPage:w(q,S.data),isFetchingNextPage:k&&T,isFetchingPreviousPage:k&&M,isFetchNextPageError:C&&T,isFetchPreviousPageError:C&&M}}return h(x,b,_)}function m(){return x=>{let b;return typeof x=="object"?b=oo(x)??Ts:b=x,s(b===Ts?n:V=>o(V)?.mutations?.[b]??vm,i)}}function A(x,b){const q=x[e],_=new Set;for(const V of b.filter(ll).map(uh)){const S=q.provided[V.type];if(!S)continue;let k=(V.id!==void 0?S[V.id]:bm(Object.values(S)))??[];for(const C of k)_.add(C)}return bm(Array.from(_.values()).map(V=>{const S=q.queries[V];return S?[{queryCacheKey:V,endpointName:S.endpointName,originalArgs:S.originalArgs}]:[]}))}function g(x,b){return Object.values(a(x)).filter(q=>q?.endpointName===b&&q.status!=="uninitialized").map(q=>q.originalArgs)}function y(x,b){return b?dh(x,b)!=null:!1}function w(x,b){return!b||!x.getPreviousPageParam?!1:ab(x,b)!=null}}var _m=WeakMap?new WeakMap:void 0,fh=({endpointName:t,queryArgs:e})=>{let s="";const r=_m?.get(e);if(typeof r=="string")s=r;else{const n=JSON.stringify(e,(i,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=Sn(o)?Object.keys(o).sort().reduce((a,l)=>(a[l]=o[l],a),{}):o,o));Sn(e)&&_m?.set(e,n),s=n}return`${t}(${s})`};function ub(...t){return function(s){const r=rl(c=>s.extractRehydrationInfo?.(c,{reducerPath:s.reducerPath??"api"})),n={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...s,extractRehydrationInfo:r,serializeQueryArgs(c){let u=fh;if("serializeQueryArgs"in c.endpointDefinition){const h=c.endpointDefinition.serializeQueryArgs;u=d=>{const f=h(d);return typeof f=="string"?f:fh({...d,queryArgs:f})}}else s.serializeQueryArgs&&(u=s.serializeQueryArgs);return u(c)},tagTypes:[...s.tagTypes||[]]},i={endpointDefinitions:{},batch(c){c()},apiUid:Co(),extractRehydrationInfo:r,hasRehydrationInfo:rl(c=>r(c)!=null)},o={injectEndpoints:l,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const h of c)n.tagTypes.includes(h)||n.tagTypes.push(h);if(u)for(const[h,d]of Object.entries(u))typeof d=="function"?d(i.endpointDefinitions[h]):Object.assign(i.endpointDefinitions[h]||{},d);return o}},a=t.map(c=>c.init(o,n,i));function l(c){const u=c.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"}),infiniteQuery:h=>({...h,type:"infinitequery"})});for(const[h,d]of Object.entries(u)){if(c.overrideExisting!==!0&&h in i.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(Ge(39));continue}i.endpointDefinitions[h]=d;for(const f of a)f.injectEndpoint(h,d)}return o}return o.injectEndpoints({endpoints:s.endpoints})}}function YS(){return function(){throw new Error(Ge(33))}}function Ss(t,...e){return Object.assign(t,...e)}var KS=({api:t,queryThunk:e,internalState:s})=>{const r=`${t.reducerPath}/subscriptions`;let n=null,i=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=t.internalActions,l=(f,m)=>{if(o.match(m)){const{queryCacheKey:g,requestId:y,options:w}=m.payload;return f?.[g]?.[y]&&(f[g][y]=w),!0}if(a.match(m)){const{queryCacheKey:g,requestId:y}=m.payload;return f[g]&&delete f[g][y],!0}if(t.internalActions.removeQueryResult.match(m))return delete f[m.payload.queryCacheKey],!0;if(e.pending.match(m)){const{meta:{arg:g,requestId:y}}=m,w=f[g.queryCacheKey]??={};return w[`${y}_running`]={},g.subscribe&&(w[y]=g.subscriptionOptions??w[y]??{}),!0}let A=!1;if(e.fulfilled.match(m)||e.rejected.match(m)){const g=f[m.meta.arg.queryCacheKey]||{},y=`${m.meta.requestId}_running`;A||=!!g[y],delete g[y]}if(e.rejected.match(m)){const{meta:{condition:g,arg:y,requestId:w}}=m;if(g&&y.subscribe){const x=f[y.queryCacheKey]??={};x[w]=y.subscriptionOptions??x[w]??{},A=!0}}return A},c=()=>s.currentSubscriptions,d={getSubscriptions:c,getSubscriptionCount:f=>{const A=c()[f]??{};return bn(A)},isRequestSubscribed:(f,m)=>!!c()?.[f]?.[m]};return(f,m)=>{if(n||(n=JSON.parse(JSON.stringify(s.currentSubscriptions))),t.util.resetApiState.match(f))return n=s.currentSubscriptions={},i=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(f))return[!1,d];const A=l(s.currentSubscriptions,f);let g=!0;if(A){i||(i=setTimeout(()=>{const x=JSON.parse(JSON.stringify(s.currentSubscriptions)),[,b]=mx(n,()=>x);m.next(t.internalActions.subscriptionsUpdated(b)),n=x,i=null},500));const y=typeof f.type=="string"&&!!f.type.startsWith(r),w=e.rejected.match(f)&&f.meta.condition&&!!f.meta.arg.subscribe;g=!y&&!w}return[g,!1]}};function QS(t){for(const e in t)return!1;return!0}var XS=2147483647/1e3-1,JS=({reducerPath:t,api:e,queryThunk:s,context:r,internalState:n,selectors:{selectQueryEntry:i,selectConfig:o}})=>{const{removeQueryResult:a,unsubscribeQueryResult:l,cacheEntriesUpserted:c}=e.internalActions,u=ys(l.match,s.fulfilled,s.rejected,c.match);function h(g){const y=n.currentSubscriptions[g];return!!y&&!QS(y)}const d={},f=(g,y,w)=>{const x=y.getState(),b=o(x);if(u(g)){let q;if(c.match(g))q=g.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=l.match(g)?g.payload:g.meta.arg;q=[_]}m(q,y,b)}if(e.util.resetApiState.match(g))for(const[q,_]of Object.entries(d))_&&clearTimeout(_),delete d[q];if(r.hasRehydrationInfo(g)){const{queries:q}=r.extractRehydrationInfo(g);m(Object.keys(q),y,b)}};function m(g,y,w){const x=y.getState();for(const b of g){const q=i(x,b);A(b,q?.endpointName,y,w)}}function A(g,y,w,x){const q=r.endpointDefinitions[y]?.keepUnusedDataFor??x.keepUnusedDataFor;if(q===1/0)return;const _=Math.max(0,Math.min(q,XS));if(!h(g)){const V=d[g];V&&clearTimeout(V),d[g]=setTimeout(()=>{h(g)||w.dispatch(a({queryCacheKey:g})),delete d[g]},_*1e3)}}return f},Sm=new Error("Promise never resolved before cacheEntryRemoved."),ZS=({api:t,reducerPath:e,context:s,queryThunk:r,mutationThunk:n,internalState:i,selectors:{selectQueryEntry:o,selectApiState:a}})=>{const l=ih(r),c=ih(n),u=tr(r,n),h={};function d(y,w,x){const b=h[y];b?.valueResolved&&(b.valueResolved({data:w,meta:x}),delete b.valueResolved)}function f(y){const w=h[y];w&&(delete h[y],w.cacheEntryRemoved())}const m=(y,w,x)=>{const b=A(y);function q(_,V,S,k){const C=o(x,V),P=o(w.getState(),V);!C&&P&&g(_,k,V,w,S)}if(r.pending.match(y))q(y.meta.arg.endpointName,b,y.meta.requestId,y.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(y))for(const{queryDescription:_,value:V}of y.payload){const{endpointName:S,originalArgs:k,queryCacheKey:C}=_;q(S,C,y.meta.requestId,k),d(C,V,{})}else if(n.pending.match(y))w.getState()[e].mutations[b]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,b,w,y.meta.requestId);else if(u(y))d(b,y.payload,y.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(y)||t.internalActions.removeMutationResult.match(y))f(b);else if(t.util.resetApiState.match(y))for(const _ of Object.keys(h))f(_)};function A(y){return l(y)?y.meta.arg.queryCacheKey:c(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:t.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:t.internalActions.removeMutationResult.match(y)?oo(y.payload):""}function g(y,w,x,b,q){const _=s.endpointDefinitions[y],V=_?.onCacheEntryAdded;if(!V)return;const S={},k=new Promise(z=>{S.cacheEntryRemoved=z}),C=Promise.race([new Promise(z=>{S.valueResolved=z}),k.then(()=>{throw Sm})]);C.catch(()=>{}),h[x]=S;const P=t.endpoints[y].select(_.type==="query"?w:x),T=b.dispatch((z,E,R)=>R),M={...b,getCacheEntry:()=>P(b.getState()),requestId:q,extra:T,updateCachedData:_.type==="query"?z=>b.dispatch(t.util.updateQueryData(y,w,z)):void 0,cacheDataLoaded:C,cacheEntryRemoved:k},I=V(w,M);Promise.resolve(I).catch(z=>{if(z!==Sm)throw z})}return m},ek=({api:t,context:{apiUid:e},reducerPath:s})=>(r,n)=>{t.util.resetApiState.match(r)&&n.dispatch(t.internalActions.middlewareRegistered(e))},tk=({reducerPath:t,context:e,context:{endpointDefinitions:s},mutationThunk:r,queryThunk:n,api:i,assertTagType:o,refetchQuery:a,internalState:l})=>{const{removeQueryResult:c}=i.internalActions,u=ys(tr(r),Bl(r)),h=ys(tr(r,n),kn(r,n));let d=[];const f=(g,y)=>{u(g)?A(lb(g,"invalidatesTags",s,o),y):h(g)?A([],y):i.util.invalidateTags.match(g)&&A(Wd(g.payload,void 0,void 0,void 0,void 0,o),y)};function m(g){const{queries:y,mutations:w}=g;for(const x of[y,w])for(const b in x)if(x[b]?.status==="pending")return!0;return!1}function A(g,y){const w=y.getState(),x=w[t];if(d.push(...g),x.config.invalidationBehavior==="delayed"&&m(x))return;const b=d;if(d=[],b.length===0)return;const q=i.util.selectInvalidatedBy(w,b);e.batch(()=>{const _=Array.from(q.values());for(const{queryCacheKey:V}of _){const S=x.queries[V],k=l.currentSubscriptions[V]??{};S&&(bn(k)===0?y.dispatch(c({queryCacheKey:V})):S.status!=="uninitialized"&&y.dispatch(a(S)))}})}return f},sk=({reducerPath:t,queryThunk:e,api:s,refetchQuery:r,internalState:n})=>{const i={},o=(d,f)=>{(s.internalActions.updateSubscriptionOptions.match(d)||s.internalActions.unsubscribeQueryResult.match(d))&&l(d.payload,f),(e.pending.match(d)||e.rejected.match(d)&&d.meta.condition)&&l(d.meta.arg,f),(e.fulfilled.match(d)||e.rejected.match(d)&&!d.meta.condition)&&a(d.meta.arg,f),s.util.resetApiState.match(d)&&u()};function a({queryCacheKey:d},f){const m=f.getState()[t],A=m.queries[d],g=n.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y,skipPollingIfUnfocused:w}=h(g);if(!Number.isFinite(y))return;const x=i[d];x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);const b=Date.now()+y;i[d]={nextPollTimestamp:b,pollingInterval:y,timeout:setTimeout(()=>{(m.config.focused||!w)&&f.dispatch(r(A)),a({queryCacheKey:d},f)},y)}}function l({queryCacheKey:d},f){const A=f.getState()[t].queries[d],g=n.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y}=h(g);if(!Number.isFinite(y)){c(d);return}const w=i[d],x=Date.now()+y;(!w||x<w.nextPollTimestamp)&&a({queryCacheKey:d},f)}function c(d){const f=i[d];f?.timeout&&clearTimeout(f.timeout),delete i[d]}function u(){for(const d of Object.keys(i))c(d)}function h(d={}){let f=!1,m=Number.POSITIVE_INFINITY;for(let A in d)d[A].pollingInterval&&(m=Math.min(d[A].pollingInterval,m),f=d[A].skipPollingIfUnfocused||f);return{lowestPollingInterval:m,skipPollingIfUnfocused:f}}return o},rk=({api:t,context:e,queryThunk:s,mutationThunk:r})=>{const n=vd(s,r),i=kn(s,r),o=tr(s,r),a={};return(c,u)=>{if(n(c)){const{requestId:h,arg:{endpointName:d,originalArgs:f}}=c.meta,m=e.endpointDefinitions[d],A=m?.onQueryStarted;if(A){const g={},y=new Promise((q,_)=>{g.resolve=q,g.reject=_});y.catch(()=>{}),a[h]=g;const w=t.endpoints[d].select(m.type==="query"?f:h),x=u.dispatch((q,_,V)=>V),b={...u,getCacheEntry:()=>w(u.getState()),requestId:h,extra:x,updateCachedData:m.type==="query"?q=>u.dispatch(t.util.updateQueryData(d,f,q)):void 0,queryFulfilled:y};A(f,b)}}else if(o(c)){const{requestId:h,baseQueryMeta:d}=c.meta;a[h]?.resolve({data:c.payload,meta:d}),delete a[h]}else if(i(c)){const{requestId:h,rejectedWithValue:d,baseQueryMeta:f}=c.meta;a[h]?.reject({error:c.payload??c.error,isUnhandledError:!d,meta:f}),delete a[h]}}},nk=({reducerPath:t,context:e,api:s,refetchQuery:r,internalState:n})=>{const{removeQueryResult:i}=s.internalActions,o=(l,c)=>{Ld.match(l)&&a(c,"refetchOnFocus"),Ud.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){const u=l.getState()[t],h=u.queries,d=n.currentSubscriptions;e.batch(()=>{for(const f of Object.keys(d)){const m=h[f],A=d[f];if(!A||!m)continue;(Object.values(A).some(y=>y[c]===!0)||Object.values(A).every(y=>y[c]===void 0)&&u.config[c])&&(bn(A)===0?l.dispatch(i({queryCacheKey:f})):m.status!=="uninitialized"&&l.dispatch(r(m)))}})}return o};function ik(t){const{reducerPath:e,queryThunk:s,api:r,context:n}=t,{apiUid:i}=n,o={invalidateTags:pt(`${e}/invalidateTags`)},a=h=>h.type.startsWith(`${e}/`),l=[ek,JS,tk,sk,ZS,rk];return{middleware:h=>{let d=!1;const m={...t,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},A=l.map(w=>w(m)),g=KS(m),y=nk(m);return w=>x=>{if(!bd(x))return w(x);d||(d=!0,h.dispatch(r.internalActions.middlewareRegistered(i)));const b={...h,next:w},q=h.getState(),[_,V]=g(x,b,q);let S;if(_?S=w(x):S=V,h.getState()[e]&&(y(x,b,q),a(x)||n.hasRehydrationInfo(x)))for(const k of A)k(x,b,q);return S}},actions:o};function u(h){return t.api.endpoints[h.endpointName].initiate(h.originalArgs,{subscribe:!1,forceRefetch:!0})}}var km=Symbol(),hb=({createSelector:t=Il}={})=>({name:km,init(e,{baseQuery:s,tagTypes:r,reducerPath:n,serializeQueryArgs:i,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u},h){Qv();const d=oe=>oe;Object.assign(e,{reducerPath:n,endpoints:{},internalActions:{onOnline:Ud,onOffline:ob,onFocus:Ld,onFocusLost:ib},util:{}});const f=GS({serializeQueryArgs:i,reducerPath:n,createSelector:t}),{selectInvalidatedBy:m,selectCachedArgsForQuery:A,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:w}=f;Ss(e.util,{selectInvalidatedBy:m,selectCachedArgsForQuery:A});const{queryThunk:x,infiniteQueryThunk:b,mutationThunk:q,patchQueryData:_,updateQueryData:V,upsertQueryData:S,prefetch:k,buildMatchThunkActions:C}=HS({baseQuery:s,reducerPath:n,context:h,api:e,serializeQueryArgs:i,assertTagType:d,selectors:f}),{reducer:P,actions:T}=WS({context:h,queryThunk:x,mutationThunk:q,serializeQueryArgs:i,reducerPath:n,assertTagType:d,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:n,invalidationBehavior:u}});Ss(e.util,{patchQueryData:_,updateQueryData:V,upsertQueryData:S,prefetch:k,resetApiState:T.resetApiState,upsertQueryEntries:T.cacheEntriesUpserted}),Ss(e.internalActions,T);const{middleware:M,actions:I}=ik({reducerPath:n,context:h,queryThunk:x,mutationThunk:q,infiniteQueryThunk:b,api:e,assertTagType:d,selectors:f});Ss(e.util,I),Ss(e,{reducer:P,middleware:M});const{buildInitiateQuery:z,buildInitiateInfiniteQuery:E,buildInitiateMutation:R,getRunningMutationThunk:D,getRunningMutationsThunk:F,getRunningQueriesThunk:Y,getRunningQueryThunk:ge}=US({queryThunk:x,mutationThunk:q,infiniteQueryThunk:b,api:e,serializeQueryArgs:i,context:h});return Ss(e.util,{getRunningMutationThunk:D,getRunningMutationsThunk:F,getRunningQueryThunk:ge,getRunningQueriesThunk:Y}),{name:km,injectEndpoint(oe,se){const Ae=e,ae=Ae.endpoints[oe]??={};$d(se)&&Ss(ae,{name:oe,select:g(oe,se),initiate:z(oe,se)},C(x,oe)),DS(se)&&Ss(ae,{name:oe,select:w(),initiate:R(oe)},C(q,oe)),Hd(se)&&Ss(ae,{name:oe,select:y(oe,se),initiate:E(oe,se)},C(x,oe))}}}});hb();function aa(t){return t.replace(t[0],t[0].toUpperCase())}function ok(t){return t.type==="query"}function ak(t){return t.type==="mutation"}function db(t){return t.type==="infinitequery"}function di(t,...e){return Object.assign(t,...e)}var Oc=Symbol();function Cm(t,e,s,r){const n=v.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?e({queryArgs:t,endpointDefinition:s,endpointName:r}):t}),[t,e,s,r]),i=v.useRef(n);return v.useEffect(()=>{i.current.serialized!==n.serialized&&(i.current=n)},[n]),i.current.serialized===n.serialized?i.current.queryArgs:t}function la(t){const e=v.useRef(t);return v.useEffect(()=>{Ni(e.current,t)||(e.current=t)},[t]),Ni(e.current,t)?e.current:t}var lk=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ck=lk(),uk=()=>typeof navigator<"u"&&navigator.product==="ReactNative",hk=uk(),dk=()=>ck||hk?v.useLayoutEffect:v.useEffect,fk=dk(),Pm=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:rb.pending}:t;function Bc(t,...e){const s={};return e.forEach(r=>{s[r]=t[r]}),s}var Nc=["data","status","isLoading","isSuccess","isError","error"];function pk({api:t,moduleOptions:{batch:e,hooks:{useDispatch:s,useSelector:r,useStore:n},unstable__sideEffectsInRender:i,createSelector:o},serializeQueryArgs:a,context:l}){const c=i?b=>b():v.useEffect;return{buildQueryHooks:y,buildInfiniteQueryHooks:w,buildMutationHook:x,usePrefetch:d};function u(b,q,_){if(q?.endpointName&&b.isUninitialized){const{endpointName:T}=q,M=l.endpointDefinitions[T];_!==Ts&&a({queryArgs:q.originalArgs,endpointDefinition:M,endpointName:T})===a({queryArgs:_,endpointDefinition:M,endpointName:T})&&(q=void 0)}let V=b.isSuccess?b.data:q?.data;V===void 0&&(V=b.data);const S=V!==void 0,k=b.isLoading,C=(!q||q.isLoading||q.isUninitialized)&&!S&&k,P=b.isSuccess||S&&(k&&!q?.isError||b.isUninitialized);return{...b,data:V,currentData:b.data,isFetching:k,isLoading:C,isSuccess:P}}function h(b,q,_){if(q?.endpointName&&b.isUninitialized){const{endpointName:T}=q,M=l.endpointDefinitions[T];a({queryArgs:q.originalArgs,endpointDefinition:M,endpointName:T})===a({queryArgs:_,endpointDefinition:M,endpointName:T})&&(q=void 0)}let V=b.isSuccess?b.data:q?.data;V===void 0&&(V=b.data);const S=V!==void 0,k=b.isLoading,C=(!q||q.isLoading||q.isUninitialized)&&!S&&k,P=b.isSuccess||k&&S;return{...b,data:V,currentData:b.data,isFetching:k,isLoading:C,isSuccess:P}}function d(b,q){const _=s(),V=la(q);return v.useCallback((S,k)=>_(t.util.prefetch(b,S,{...V,...k})),[b,_,V])}function f(b,q,{refetchOnReconnect:_,refetchOnFocus:V,refetchOnMountOrArgChange:S,skip:k=!1,pollingInterval:C=0,skipPollingIfUnfocused:P=!1,...T}={}){const{initiate:M}=t.endpoints[b],I=s(),z=v.useRef(void 0);if(!z.current){const he=I(t.internalActions.internal_getRTKQSubscriptions());z.current=he}const E=Cm(k?Ts:q,fh,l.endpointDefinitions[b],b),R=la({refetchOnReconnect:_,refetchOnFocus:V,pollingInterval:C,skipPollingIfUnfocused:P}),D=v.useRef(!1),F=T.initialPageParam,Y=la(F),ge=v.useRef(void 0);let{queryCacheKey:oe,requestId:se}=ge.current||{},Ae=!1;oe&&se&&(Ae=z.current.isRequestSubscribed(oe,se));const ae=!Ae&&D.current;return c(()=>{D.current=Ae}),c(()=>{ae&&(ge.current=void 0)},[ae]),c(()=>{const he=ge.current;if(E===Ts){he?.unsubscribe(),ge.current=void 0;return}const Fe=ge.current?.subscriptionOptions;if(!he||he.arg!==E){he?.unsubscribe();const ls=I(M(E,{subscriptionOptions:R,forceRefetch:S,...db(l.endpointDefinitions[b])?{initialPageParam:Y}:{}}));ge.current=ls}else R!==Fe&&he.updateSubscriptionOptions(R)},[I,M,S,E,R,ae,Y,b]),[ge,I,M,R]}function m(b,q){return(V,{skip:S=!1,selectFromResult:k}={})=>{const{select:C}=t.endpoints[b],P=Cm(S?Ts:V,a,l.endpointDefinitions[b],b),T=v.useRef(void 0),M=v.useMemo(()=>o([C(P),(D,F)=>F,D=>P],q,{memoizeOptions:{resultEqualityCheck:Ni}}),[C,P]),I=v.useMemo(()=>k?o([M],k,{devModeChecks:{identityFunctionCheck:"never"}}):M,[M,k]),z=r(D=>I(D,T.current),Ni),E=n(),R=M(E.getState(),T.current);return fk(()=>{T.current=R},[R]),z}}function A(b){v.useEffect(()=>()=>{b.current?.unsubscribe?.(),b.current=void 0},[b])}function g(b){if(!b.current)throw new Error(Ge(38));return b.current.refetch()}function y(b){const q=(S,k={})=>{const[C]=f(b,S,k);return A(C),v.useMemo(()=>({refetch:()=>g(C)}),[C])},_=({refetchOnReconnect:S,refetchOnFocus:k,pollingInterval:C=0,skipPollingIfUnfocused:P=!1}={})=>{const{initiate:T}=t.endpoints[b],M=s(),[I,z]=v.useState(Oc),E=v.useRef(void 0),R=la({refetchOnReconnect:S,refetchOnFocus:k,pollingInterval:C,skipPollingIfUnfocused:P});c(()=>{const ge=E.current?.subscriptionOptions;R!==ge&&E.current?.updateSubscriptionOptions(R)},[R]);const D=v.useRef(R);c(()=>{D.current=R},[R]);const F=v.useCallback(function(ge,oe=!1){let se;return e(()=>{E.current?.unsubscribe(),E.current=se=M(T(ge,{subscriptionOptions:D.current,forceRefetch:!oe})),z(ge)}),se},[M,T]),Y=v.useCallback(()=>{E.current?.queryCacheKey&&M(t.internalActions.removeQueryResult({queryCacheKey:E.current?.queryCacheKey}))},[M]);return v.useEffect(()=>()=>{E?.current?.unsubscribe()},[]),v.useEffect(()=>{I!==Oc&&!E.current&&F(I,!0)},[I,F]),v.useMemo(()=>[F,I,{reset:Y}],[F,I,Y])},V=m(b,u);return{useQueryState:V,useQuerySubscription:q,useLazyQuerySubscription:_,useLazyQuery(S){const[k,C,{reset:P}]=_(S),T=V(C,{...S,skip:C===Oc}),M=v.useMemo(()=>({lastArg:C}),[C]);return v.useMemo(()=>[k,{...T,reset:P},M],[k,T,P,M])},useQuery(S,k){const C=q(S,k),P=V(S,{selectFromResult:S===Ts||k?.skip?void 0:Pm,...k}),T=Bc(P,...Nc);return v.useDebugValue(T),v.useMemo(()=>({...P,...C}),[P,C])}}}function w(b){const q=(V,S={})=>{const[k,C,P,T]=f(b,V,S),M=v.useRef(T);c(()=>{M.current=T},[T]);const I=v.useCallback(function(z,E){let R;return e(()=>{k.current?.unsubscribe(),k.current=R=C(P(z,{subscriptionOptions:M.current,direction:E}))}),R},[k,C,P]);return A(k),v.useMemo(()=>({trigger:I,refetch:()=>g(k),fetchNextPage:()=>I(V,"forward"),fetchPreviousPage:()=>I(V,"backward")}),[k,I,V])},_=m(b,h);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:q,useInfiniteQuery(V,S){const{refetch:k,fetchNextPage:C,fetchPreviousPage:P}=q(V,S),T=_(V,{selectFromResult:V===Ts||S?.skip?void 0:Pm,...S}),M=Bc(T,...Nc,"hasNextPage","hasPreviousPage");return v.useDebugValue(M),v.useMemo(()=>({...T,fetchNextPage:C,fetchPreviousPage:P,refetch:k}),[T,C,P,k])}}}function x(b){return({selectFromResult:q,fixedCacheKey:_}={})=>{const{select:V,initiate:S}=t.endpoints[b],k=s(),[C,P]=v.useState();v.useEffect(()=>()=>{C?.arg.fixedCacheKey||C?.reset()},[C]);const T=v.useCallback(function(ge){const oe=k(S(ge,{fixedCacheKey:_}));return P(oe),oe},[k,S,_]),{requestId:M}=C||{},I=v.useMemo(()=>V({fixedCacheKey:_,requestId:C?.requestId}),[_,C,V]),z=v.useMemo(()=>q?o([I],q):I,[q,I]),E=r(z,Ni),R=_==null?C?.arg.originalArgs:void 0,D=v.useCallback(()=>{e(()=>{C&&P(void 0),_&&k(t.internalActions.removeMutationResult({requestId:M,fixedCacheKey:_}))})},[k,_,C,M]),F=Bc(E,...Nc,"endpointName");v.useDebugValue(F);const Y=v.useMemo(()=>({...E,originalArgs:R,reset:D}),[E,R,D]);return v.useMemo(()=>[T,Y],[T,Y])}}}var mk=Symbol(),gk=({batch:t=hv,hooks:e={useDispatch:Zy,useSelector:ex,useStore:pd},createSelector:s=Il,unstable__sideEffectsInRender:r=!1,...n}={})=>({name:mk,init(i,{serializeQueryArgs:o},a){const l=i,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:h,usePrefetch:d}=pk({api:i,moduleOptions:{batch:t,hooks:e,unstable__sideEffectsInRender:r,createSelector:s},serializeQueryArgs:o,context:a});return di(l,{usePrefetch:d}),di(a,{batch:t}),{injectEndpoint(f,m){if(ok(m)){const{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:w,useQuerySubscription:x}=c(f);di(l.endpoints[f],{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:w,useQuerySubscription:x}),i[`use${aa(f)}Query`]=A,i[`useLazy${aa(f)}Query`]=g}if(ak(m)){const A=h(f);di(l.endpoints[f],{useMutation:A}),i[`use${aa(f)}Mutation`]=A}else if(db(m)){const{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}=u(f);di(l.endpoints[f],{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}),i[`use${aa(f)}InfiniteQuery`]=A}}}}}),Ak=ub(hb(),gk());const yk=Un(()=>is(()=>import("./campaign-B5YtlMSX.js"),__vite__mapDeps([0,1,2]))),Ll=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const xk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ki=Array.prototype.slice.call(xk),ca=(t=>{let e={};return t.forEach((s,r)=>e[s]=r),e})(ki),bk=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Fa=String.fromCharCode.bind(String),Em=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),wk=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),fb=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Vk=t=>{let e,s,r,n,i="";const o=t.length%3;for(let a=0;a<t.length;){if((s=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=s<<16|r<<8|n,i+=ki[e>>18&63]+ki[e>>12&63]+ki[e>>6&63]+ki[e&63]}return o?i.slice(0,o-3)+"===".substring(o):i},qk=typeof btoa=="function"?t=>btoa(t):Ll?t=>Buffer.from(t,"binary").toString("base64"):Vk,Tm=Ll?t=>Buffer.from(t).toString("base64"):t=>{let s=[];for(let r=0,n=t.length;r<n;r+=4096)s.push(Fa.apply(null,t.subarray(r,r+4096)));return qk(s.join(""))},vk=(t,e=!1)=>e?wk(Tm(t)):Tm(t),_k=t=>{if(t=t.replace(/\s+/g,""),!bk.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,s="",r,n;for(let i=0;i<t.length;)e=ca[t.charAt(i++)]<<18|ca[t.charAt(i++)]<<12|(r=ca[t.charAt(i++)])<<6|(n=ca[t.charAt(i++)]),s+=r===64?Fa(e>>16&255):n===64?Fa(e>>16&255,e>>8&255):Fa(e>>16&255,e>>8&255,e&255);return s},Sk=typeof atob=="function"?t=>atob(fb(t)):Ll?t=>Buffer.from(t,"base64").toString("binary"):_k,kk=Ll?t=>Em(Buffer.from(t,"base64")):t=>Em(Sk(t).split("").map(e=>e.charCodeAt(0))),Ck=t=>kk(Pk(t)),Pk=t=>fb(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Ek=!0,pb="gzip",Tk=async t=>{const e=JSON.stringify(t),r=new TextEncoder().encode(e),n=new Blob([r]),i=new CompressionStream(pb),o=n.stream().pipeThrough(i),a=await new Response(o).arrayBuffer(),l=new Uint8Array(a);return vk(l,Ek)},mb=async t=>{try{const e=Ck(t),s=new Blob([new Uint8Array(e)]),r=new DecompressionStream(pb),n=s.stream().pipeThrough(r),i=await new Response(n).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},Mk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>is(async()=>{const{default:r}=await Promise.resolve().then(()=>Xn);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)};class Gd extends Error{constructor(e,s="FunctionsError",r){super(e),this.name=s,this.context=r}}class Rk extends Gd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mm extends Gd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rm extends Gd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ph;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ph||(ph={}));var Ik=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class jk{constructor(e,{headers:s={},customFetch:r,region:n=ph.Any}={}){this.url=e,this.headers=s,this.region=n,this.fetch=Mk(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,s={}){var r;return Ik(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=s;let a={},{region:l}=s;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:u}).catch(A=>{throw new Rk(A)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Mm(h);if(!h.ok)throw new Rm(h);let f=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield h.json():f==="application/octet-stream"?m=yield h.blob():f==="text/event-stream"?m=h:f==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof Rm||n instanceof Mm?n.context:void 0}}})}}var Ue={},Gr={},Yr={},Kr={},Qr={},Xr={},Ok=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},En=Ok();const Bk=En.fetch,gb=En.fetch.bind(En),Ab=En.Headers,Nk=En.Request,zk=En.Response,Xn=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ab,Request:Nk,Response:zk,default:gb,fetch:Bk},Symbol.toStringTag,{value:"Module"})),Dk=$q(Xn);var ua={},Im;function yb(){if(Im)return ua;Im=1,Object.defineProperty(ua,"__esModule",{value:!0});class t extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return ua.default=t,ua}var jm;function xb(){if(jm)return Xr;jm=1;var t=Xr&&Xr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xr,"__esModule",{value:!0});const e=t(Dk),s=t(yb());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,m=null,A=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const q=await c.text();q===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=q:m=JSON.parse(q))}const x=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&b&&b.length>1&&(A=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,A=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await c.text();try{f=JSON.parse(x),Array.isArray(f)&&c.status===404&&(m=[],f=null,g=200,y="OK")}catch{c.status===404&&x===""?(g=204,y="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,y="OK"),f&&this.shouldThrowOnError)throw new s.default(f)}return{error:f,data:m,count:A,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Xr.default=r,Xr}var Om;function bb(){if(Om)return Qr;Om=1;var t=Qr&&Qr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Qr,"__esModule",{value:!0});const e=t(xb());class s extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Qr.default=s,Qr}var Bm;function Yd(){if(Bm)return Kr;Bm=1;var t=Kr&&Kr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Kr,"__esModule",{value:!0});const e=t(bb());class s extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return Kr.default=s,Kr}var Nm;function wb(){if(Nm)return Yr;Nm=1;var t=Yr&&Yr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Yr,"__esModule",{value:!0});const e=t(Yd());class s{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Yr.default=s,Yr}var fi={},pi={},zm;function Fk(){return zm||(zm=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.version=void 0,pi.version="0.0.0-automated"),pi}var Dm;function Lk(){if(Dm)return fi;Dm=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.DEFAULT_HEADERS=void 0;const t=Fk();return fi.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},fi}var Fm;function Uk(){if(Fm)return Gr;Fm=1;var t=Gr&&Gr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Gr,"__esModule",{value:!0});const e=t(wb()),s=t(Yd()),r=Lk();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([A,g])=>g!==void 0).map(([A,g])=>[A,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([A,g])=>{d.searchParams.append(A,g)})):(h="POST",f=a);const m=Object.assign({},this.headers);return u&&(m.Prefer=`count=${u}`),new s.default({method:h,url:d,headers:m,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Gr.default=n,Gr}var Lm;function $k(){if(Lm)return Ue;Lm=1;var t=Ue&&Ue.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.PostgrestError=Ue.PostgrestBuilder=Ue.PostgrestTransformBuilder=Ue.PostgrestFilterBuilder=Ue.PostgrestQueryBuilder=Ue.PostgrestClient=void 0;const e=t(Uk());Ue.PostgrestClient=e.default;const s=t(wb());Ue.PostgrestQueryBuilder=s.default;const r=t(Yd());Ue.PostgrestFilterBuilder=r.default;const n=t(bb());Ue.PostgrestTransformBuilder=n.default;const i=t(xb());Ue.PostgrestBuilder=i.default;const o=t(yb());return Ue.PostgrestError=o.default,Ue.default={PostgrestClient:e.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},Ue}var Hk=$k();const Wk=Ke(Hk),{PostgrestClient:Gk,PostgrestQueryBuilder:FU,PostgrestFilterBuilder:LU,PostgrestTransformBuilder:UU,PostgrestBuilder:$U,PostgrestError:HU}=Wk;function Yk(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Kk=Yk(),Qk="2.11.15",Xk=`realtime-js/${Qk}`,Jk="1.0.0",Vb=1e4,Zk=1e3;var Fi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Fi||(Fi={}));var rt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(rt||(rt={}));var Xt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Xt||(Xt={}));var mh;(function(t){t.websocket="websocket"})(mh||(mh={}));var qr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(qr||(qr={}));class e1{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,s,r)}_decodeBroadcast(e,s,r){const n=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+n));o=o+n;const l=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class qb{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var we;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(we||(we={}));const Um=(t,e,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=t1(o,t,e,n),i),{})},t1=(t,e,s,r)=>{const n=e.find(a=>a.name===t),i=n?.type,o=s[t];return i&&!r.includes(i)?vb(i,o):gh(o)},vb=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return i1(e,s)}switch(t){case we.bool:return s1(e);case we.float4:case we.float8:case we.int2:case we.int4:case we.int8:case we.numeric:case we.oid:return r1(e);case we.json:case we.jsonb:return n1(e);case we.timestamp:return o1(e);case we.abstime:case we.date:case we.daterange:case we.int4range:case we.int8range:case we.money:case we.reltime:case we.text:case we.time:case we.timestamptz:case we.timetz:case we.tsrange:case we.tstzrange:return gh(e);default:return gh(e)}},gh=t=>t,s1=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},r1=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},n1=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},i1=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,r=t[s];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>vb(e,a))}return t},o1=t=>typeof t=="string"?t.replace(" ","T"):t,_b=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class zc{constructor(e,s,r={},n=Vb){this.channel=e,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var r;return this._hasReceived(e)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $m;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})($m||($m={}));class Li{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Li.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Li.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Li.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,r,n){const i=this.cloneDeep(e),o=this.transformState(s),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),A=h.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),A.length>0&&(l[c]=A)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,n)}static syncDiff(e,s,r,n){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(r=>s(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,r)=>{const n=e[r];return"metas"in n?s[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=n,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hm;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Hm||(Hm={}));var Wm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Wm||(Wm={}));var Ps;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ps||(Ps={}));class Kd{constructor(e,s={config:{}},r){this.topic=e,this.params=s,this.socket=r,this.bindings={},this.state=rt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new zc(this,Xt.join,this.params,this.timeout),this.rejoinTimer=new qb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=rt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=rt.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Xt.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Li(this),this.broadcastEndpointURL=_b(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,s=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==rt.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(Ps.CHANNEL_ERROR,u)),this._onClose(()=>e?.(Ps.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(Ps.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,m=[];for(let A=0;A<f;A++){const g=d[A],{filter:{event:y,schema:w,table:x,filter:b}}=g,q=u&&u[A];if(q&&q.event===y&&q.schema===w&&q.table===x&&q.filter===b)m.push(Object.assign(Object.assign({},g),{id:q.id}));else{this.unsubscribe(),this.state=rt.errored,e?.(Ps.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Ps.SUBSCRIBED);return}}).receive("error",u=>{this.state=rt.errored,e?.(Ps.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(Ps.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,r){return this._on(e,s,r)}async send(e,s={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=rt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Xt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new zc(this,Xt.leave,{},e),r.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,s,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),o}_push(e,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new zc(this,e,s,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,s,r){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,r){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Xt;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,s,r);if(s&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var m,A,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(A=f.filter)===null||A===void 0?void 0:A.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var m,A,g,y,w,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const b=f.id,q=(m=f.filter)===null||m===void 0?void 0:m.event;return b&&((A=s.ids)===null||A===void 0?void 0:A.includes(b))&&(q==="*"||q?.toLocaleLowerCase()===((g=s.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(w=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((x=s?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:A,table:g,commit_timestamp:y,type:w,errors:x}=m;d=Object.assign(Object.assign({},{schema:A,table:g,commit_timestamp:y,eventType:w,new:{},old:{},errors:x}),this._getPayloadRecords(m))}f.callback(d,r)})}_isClosed(){return this.state===rt.closed}_isJoined(){return this.state===rt.joined}_isJoining(){return this.state===rt.joining}_isLeaving(){return this.state===rt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,r){const n=e.toLocaleLowerCase(),i={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,s){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Kd.isEqual(n.filter,s))}),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Xt.close,{},e)}_onError(e){this._on(Xt.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=rt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Um(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Um(e.columns,e.old_record)),s}}const Gm=()=>{},a1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class l1{constructor(e,s){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vb,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gm,this.ref=0,this.logger=Gm,this.conn=null,this.sendBuffer=[],this.serializer=new e1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>is(async()=>{const{default:l}=await Promise.resolve().then(()=>Xn);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${mh.websocket}`,this.httpEndpoint=_b(e),s?.transport?this.transport=s.transport:this.transport=null,s?.params&&(this.params=s.params),s?.timeout&&(this.timeout=s.timeout),s?.logger&&(this.logger=s.logger),(s?.logLevel||s?.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),s?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const n=(r=s?.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=s?.reconnectAfterMs?s.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=s?.encode?s.encode:(i,o)=>o(JSON.stringify(i)),this.decode=s?.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new qb(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s?.fetch),s?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=s?.worker||!1,this.workerUrl=s?.workerUrl}this.accessToken=s?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Kk),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Jk}))}disconnect(e,s){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,r){this.logger(e,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Fi.connecting:return qr.Connecting;case Fi.open:return qr.Open;case Fi.closing:return qr.Closing;default:return qr.Closed}}isConnected(){return this.connectionState()===qr.Open}channel(e,s={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===r);if(n)return n;{const i=new Kd(`realtime:${e}`,s,this);return this.channels.push(i),i}}push(e){const{topic:s,event:r,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${s} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let s=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{const n={access_token:s,version:Xk};s&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(Xt.access_token,{access_token:s})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Zk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,s=>{let{topic:r,event:n,payload:i,ref:o}=s;r==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(s.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(r)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(s))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Xt.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${e}${r}${n}`}_workerObjectUrl(e){let s;if(e)s=e;else{const r=new Blob([a1],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}}class Qd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function He(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class c1 extends Qd{constructor(e,s){super(e),this.name="StorageApiError",this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ah extends Qd{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}var u1=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const Sb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>is(async()=>{const{default:r}=await Promise.resolve().then(()=>Xn);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},h1=()=>u1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield is(()=>Promise.resolve().then(()=>Xn),void 0)).Response:Response}),yh=t=>{if(Array.isArray(t))return t.map(s=>yh(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=yh(r)}),e};var $r=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const Dc=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),d1=(t,e,s)=>$r(void 0,void 0,void 0,function*(){const r=yield h1();t instanceof r&&!s?.noResolveJson?t.json().then(n=>{e(new c1(Dc(n),t.status||500))}).catch(n=>{e(new Ah(Dc(n),n))}):e(new Ah(Dc(t),t))}),f1=(t,e,s,r)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),s))};function Ro(t,e,s,r,n,i){return $r(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(s,f1(e,r,n,i)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>d1(l,a,r))})})}function cl(t,e,s,r){return $r(this,void 0,void 0,function*(){return Ro(t,"GET",e,s,r)})}function Ws(t,e,s,r,n){return $r(this,void 0,void 0,function*(){return Ro(t,"POST",e,r,n,s)})}function p1(t,e,s,r,n){return $r(this,void 0,void 0,function*(){return Ro(t,"PUT",e,r,n,s)})}function m1(t,e,s,r){return $r(this,void 0,void 0,function*(){return Ro(t,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function kb(t,e,s,r,n){return $r(this,void 0,void 0,function*(){return Ro(t,"DELETE",e,r,n,s)})}var wt=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const g1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ym={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class A1{constructor(e,s={},r,n){this.url=e,this.headers=s,this.bucketId=r,this.fetch=Sb(n)}uploadOrUpdate(e,s,r,n){return wt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ym),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(s),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(He(i))return{data:null,error:i};throw i}})}upload(e,s,r){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,r)})}uploadToSignedUrl(e,s,r,n){return wt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",s);try{let l;const c=Object.assign({upsert:Ym.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(He(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,s){return wt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);s?.upsert&&(n["x-upsert"]="true");const i=yield Ws(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Qd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}})}update(e,s,r){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,r)})}move(e,s,r){return wt(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}})}copy(e,s,r){return wt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ws(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}})}createSignedUrl(e,s,r){return wt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Ws(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}})}createSignedUrls(e,s,r){return wt(this,void 0,void 0,function*(){try{const n=yield Ws(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}})}download(e,s){return wt(this,void 0,void 0,function*(){const n=typeof s?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(s?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield cl(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(He(a))return{data:null,error:a};throw a}})}info(e){return wt(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const r=yield cl(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:yh(r),error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}})}exists(e){return wt(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield m1(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(He(r)&&r instanceof Ah){const n=r.originalError;if([400,404].includes(n?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,s){const r=this._getFinalPath(e),n=[],i=s?.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&n.push(i);const a=typeof s?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(s?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return wt(this,void 0,void 0,function*(){try{return{data:yield kb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(He(s))return{data:null,error:s};throw s}})}list(e,s,r){return wt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},g1),s),{prefix:e||""});return{data:yield Ws(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const y1="2.7.1",x1={"X-Client-Info":`storage-js/${y1}`};var Jr=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class b1{constructor(e,s={},r){this.url=e,this.headers=Object.assign(Object.assign({},x1),s),this.fetch=Sb(r)}listBuckets(){return Jr(this,void 0,void 0,function*(){try{return{data:yield cl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(He(e))return{data:null,error:e};throw e}})}getBucket(e){return Jr(this,void 0,void 0,function*(){try{return{data:yield cl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(He(s))return{data:null,error:s};throw s}})}createBucket(e,s={public:!1}){return Jr(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}})}updateBucket(e,s){return Jr(this,void 0,void 0,function*(){try{return{data:yield p1(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Jr(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(He(s))return{data:null,error:s};throw s}})}deleteBucket(e){return Jr(this,void 0,void 0,function*(){try{return{data:yield kb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(He(s))return{data:null,error:s};throw s}})}}class w1 extends b1{constructor(e,s={},r){super(e,s,r)}from(e){return new A1(this.url,this.headers,e,this.fetch)}}const V1="2.51.0";let Ci="";typeof Deno<"u"?Ci="deno":typeof document<"u"?Ci="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ci="react-native":Ci="node";const q1={"X-Client-Info":`supabase-js-${Ci}/${V1}`},v1={headers:q1},_1={schema:"public"},S1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},k1={};var C1=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const P1=t=>{let e;return t?e=t:typeof fetch>"u"?e=gb:e=fetch,(...s)=>e(...s)},E1=()=>typeof Headers>"u"?Ab:Headers,T1=(t,e,s)=>{const r=P1(s),n=E1();return(i,o)=>C1(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new n(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};var M1=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};function R1(t){return t.endsWith("/")?t:t+"/"}function I1(t,e){var s,r;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(s=h?.headers)!==null&&s!==void 0?s:{}),(r=a?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>M1(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Cb="2.71.0",hn=30*1e3,xh=3,Fc=xh*hn,j1="http://localhost:9999",O1="supabase.auth.token",B1={"X-Client-Info":`gotrue-js/${Cb}`},bh="X-Supabase-Api-Version",Pb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},N1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,z1=600*1e3;class Xd extends Error{constructor(e,s,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function ee(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class D1 extends Xd{constructor(e,s,r){super(e,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function F1(t){return ee(t)&&t.name==="AuthApiError"}class Eb extends Xd{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class or extends Xd{constructor(e,s,r,n){super(e,r,n),this.name=s,this.status=r}}class Hs extends or{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function L1(t){return ee(t)&&t.name==="AuthSessionMissingError"}class ha extends or{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class da extends or{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class fa extends or{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function U1(t){return ee(t)&&t.name==="AuthImplicitGrantRedirectError"}class Km extends or{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wh extends or{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function Lc(t){return ee(t)&&t.name==="AuthRetryableFetchError"}class Qm extends or{constructor(e,s,r){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class Vh extends or{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ul="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xm=` 	
\r=`.split(""),$1=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Xm.length;e+=1)t[Xm[e].charCodeAt(0)]=-2;for(let e=0;e<ul.length;e+=1)t[ul[e].charCodeAt(0)]=e;return t})();function Jm(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(ul[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(ul[r]),e.queuedBits-=6}}function Tb(t,e,s){const r=$1[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Zm(t){const e=[],s=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{G1(o,r,s)};for(let o=0;o<t.length;o+=1)Tb(t.charCodeAt(o),n,i);return e.join("")}function H1(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function W1(t,e){for(let s=0;s<t.length;s+=1){let r=t.charCodeAt(s);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(t.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}H1(r,e)}}function G1(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function Y1(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Tb(t.charCodeAt(n),s,r);return new Uint8Array(e)}function K1(t){const e=[];return W1(t,s=>e.push(s)),new Uint8Array(e)}function Q1(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};return t.forEach(n=>Jm(n,s,r)),Jm(null,s,r),e.join("")}function X1(t){return Math.round(Date.now()/1e3)+t}function J1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Qt=()=>typeof window<"u"&&typeof document<"u",cr={tested:!1,writable:!1},Mb=()=>{if(!Qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cr.tested)return cr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),cr.tested=!0,cr.writable=!0}catch{cr.tested=!0,cr.writable=!1}return cr.writable};function Z1(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return s.searchParams.forEach((r,n)=>{e[n]=r}),e}const Rb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>is(async()=>{const{default:r}=await Promise.resolve().then(()=>Xn);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},eC=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",dn=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},ur=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Us=async(t,e)=>{await t.removeItem(e)};class Ul{constructor(){this.promise=new Ul.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}Ul.promiseConstructor=Promise;function Uc(t){const e=t.split(".");if(e.length!==3)throw new Vh("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!N1.test(e[r]))throw new Vh("JWT not in base64url format");return{header:JSON.parse(Zm(e[0])),payload:JSON.parse(Zm(e[1])),signature:Y1(e[2]),raw:{header:e[0],payload:e[1]}}}async function tC(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function sC(t,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function rC(t){return("0"+t.toString(16)).substr(-2)}function nC(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,rC).join("")}async function iC(t){const s=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function oC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await iC(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zr(t,e,s=!1){const r=nC();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await dn(t,`${e}-code-verifier`,n);const i=await oC(r);return[i,r===i?"plain":"s256"]}const aC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function lC(t){const e=t.headers.get(bh);if(!e||!e.match(aC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function cC(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function uC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const hC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function en(t){if(!hC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $c(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var dC=function(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(s[r[n]]=t[r[n]]);return s};const Ar=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),fC=[502,503,504];async function eg(t){var e;if(!eC(t))throw new wh(Ar(t),0);if(fC.includes(t.status))throw new wh(Ar(t),t.status);let s;try{s=await t.json()}catch(i){throw new Eb(Ar(i),i)}let r;const n=lC(t);if(n&&n.getTime()>=Pb["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new Qm(Ar(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Hs}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Qm(Ar(s),t.status,s.weak_password.reasons);throw new D1(Ar(s),t.status||500,r)}const pC=(t,e,s,r)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};async function ne(t,e,s,r){var n;const i=Object.assign({},r?.headers);i[bh]||(i[bh]=Pb["2024-01-01"].name),r?.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r?.query)!==null&&n!==void 0?n:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await mC(t,e,s+a,{headers:i,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}}async function mC(t,e,s,r,n,i){const o=pC(e,r,n,i);let a;try{a=await t(s,Object.assign({},o))}catch(l){throw console.error(l),new wh(Ar(l),0)}if(a.ok||await eg(a),r?.noResolveJson)return a;try{return await a.json()}catch(l){await eg(l)}}function Cs(t){var e;let s=null;xC(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=X1(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:r},error:null}}function tg(t){const e=Cs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Gs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function gC(t){return{data:t,error:null}}function AC(t){const{action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=t,o=dC(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function yC(t){return t}function xC(t){return t.access_token&&t.refresh_token&&t.expires_in}const Hc=["global","local","others"];var bC=function(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(s[r[n]]=t[r[n]]);return s};class wC{constructor({url:e="",headers:s={},fetch:r}){this.url=e,this.headers=s,this.fetch=Rb(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,s=Hc[0]){if(Hc.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hc.join(", ")}`);try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ee(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,s={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Gs})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:s}=e,r=bC(e,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r?.newEmail,delete n.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:AC,redirectTo:s?.redirectTo})}catch(s){if(ee(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Gs})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,r,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:yC});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const A=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=A}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(ee(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){en(e);try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Gs})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){en(e);try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:Gs})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,s=!1){en(e);try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:Gs})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){en(e.userId);try{const{data:s,error:r}=await ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(ee(s))return{data:null,error:s};throw s}}async _deleteFactor(e){en(e.userId),en(e.id);try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(ee(s))return{data:null,error:s};throw s}}}function sg(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}function VC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const tn={debug:!!(globalThis&&Mb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ib extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qC extends Ib{}async function vC(t,e,s){tn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),tn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){tn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await s()}finally{tn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw tn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new qC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(tn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}VC();const _C={url:j1,storageKey:O1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:B1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rg(t,e,s){return await s()}const sn={};class ao{constructor(e){var s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ao.nextInstanceID,ao.nextInstanceID+=1,this.instanceID>0&&Qt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},_C),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new wC({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Rb(n.fetch),this.lock=n.lock||rg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Qt()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=vC:this.lock=rg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Mb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sg(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=sg(this.memoryStorage)),Qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,s;return(s=(e=sn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){sn[this.storageKey]=Object.assign(Object.assign({},sn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=sn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){sn[this.storageKey]=Object.assign(Object.assign({},sn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Cb}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const s=Z1(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),Qt()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),U1(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return ee(s)?{error:s}:{error:new Eb("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,r,n;try{const i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=e?.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Cs}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var s,r,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Zr(this.storage,this.storageKey)),i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},xform:Cs})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Cs})}else throw new da("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let s;if("email"in e){const{email:i,password:o,options:a}=e;s=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:tg})}else if("phone"in e){const{phone:i,password:o,options:a}=e;s=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:tg})}else throw new da("You must provide either an email or phone number and a password");const{data:r,error:n}=s;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ha}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(e){var s,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;if(s==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(e){var s,r,n,i,o,a,l,c,u,h,d,f;let m,A;if("message"in e)m=e.message,A=e.signature;else{const{chain:g,wallet:y,statement:w,options:x}=e;let b;if(Qt())if(typeof y=="object")b=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))b=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const q=new URL((s=x?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in b&&b.signIn){const _=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),w?{statement:w}:null));let V;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")V=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)V=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in V&&"signature"in V&&(typeof V.signedMessage=="string"||V.signedMessage instanceof Uint8Array)&&V.signature instanceof Uint8Array)m=typeof V.signedMessage=="string"?V.signedMessage:new TextDecoder().decode(V.signedMessage),A=V.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${q.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(n=(r=x?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(V=>`- ${V}`)]:[]].join(`
`);const _=await b.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=_}}try{const{data:g,error:y}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Q1(A)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Cs});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new ha}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(ee(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const s=await ur(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s??"").split("/");try{const{data:i,error:o}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Cs});if(await Us(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ha}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(ee(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:s,provider:r,token:n,access_token:i,nonce:o}=e,a=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Cs}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ha}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(e){var s,r,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Zr(this.storage,this.storageKey));const{error:h}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(r=l?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new da("You must provide either an email or phone number.")}catch(a){if(ee(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var s,r;try{let n,i;"options"in e&&(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Cs});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(ee(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var s,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Zr(this.storage,this.storageKey)),await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:gC})}catch(i){if(ee(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;if(r)throw r;if(!s)throw new Hs;const{error:n}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(ee(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:o}=await ne(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:o,error:a}=await ne(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new da("You must provide either an email or phone number and a type")}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await ur(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Fc:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await ur(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=$c()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Gs}):await this._useSession(async s=>{var r,n,i;const{data:o,error:a}=s;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Hs}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Gs})})}catch(s){if(ee(s))return L1(s)&&(await this._removeSession(),await Us(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new Hs;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Zr(this.storage,this.storageKey));const{data:c,error:u}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Gs});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Hs;const s=Date.now()/1e3;let r=s,n=!0,i=null;const{payload:o}=Uc(e.access_token);if(o.exp&&(r=o.exp,n=r<=s),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(ee(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var r;if(!e){const{data:o,error:a}=s;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Hs;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(e,s){try{if(!Qt())throw new fa("No browser detected.");if(e.error||e.error_description||e.error_code)throw new fa(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Km("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fa("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Km("No code detected.");const{data:w,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new fa("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=hn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:A,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(ee(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await ur(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(F1(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Us(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const s=J1(),r={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async s=>{var r,n;try{const{data:{session:i},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,s={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await Zr(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(ee(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(s){if(ee(s))return{data:null,error:s};throw s}}async linkIdentity(e){var s;try{const{data:r,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Qt()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(ee(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)throw o;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(ee(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await sC(async n=>(n>0&&await tC(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Cs})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Lc(i)&&Date.now()+o-r<hn})}catch(r){if(this._debug(s,"error",r),ee(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",r),Qt()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await ur(this.storage,this.storageKey);if(n&&this.userStorage){let o=await ur(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await dn(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:$c()}else if(n&&!n.user&&!n.user){const o=await ur(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await Us(this.storage,this.storageKey+"-user"),await dn(this.storage,this.storageKey,n)):n.user=$c()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<Fc;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Fc}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Lc(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var s,r;if(!e)throw new Hs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ul;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Hs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),ee(i)){const o={session:null,error:i};return Lc(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,s,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,s)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&await dn(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const i=structuredClone(n);await dn(this.storage,this.storageKey,i)}else{const n=structuredClone(s);await dn(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Us(this.storage,this.storageKey),await Us(this.storage,this.storageKey+"-code-verifier"),await Us(this.storage,this.storageKey+"-user"),this.userStorage&&await Us(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),hn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/hn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${hn}ms, refresh threshold is ${xh} ticks`),n<=xh&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ib)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,r){const n=[`provider=${encodeURIComponent(s)}`];if(r?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Zr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(r?.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r?.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(ee(s))return{data:null,error:s};throw s}}async _enroll(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(s){if(ee(s))return{data:null,error:s};throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:a}=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(s){if(ee(s))return{data:null,error:s};throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n?.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(ee(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(e){const{data:s,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=e?.factors||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var s,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Uc(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(s=n.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,s={keys:[]}){let r=s.keys.find(a=>a.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+z1>n)return r;const{data:i,error:o}=await ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,s={}){try{let r=e;if(!r){const{data:f,error:m}=await this.getSession();if(m||!f.session)return{data:null,error:m};r=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=Uc(r);s?.allowExpired||cC(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!c){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const u=uC(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,K1(`${a}.${l}`)))throw new Vh("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(r){if(ee(r))return{data:null,error:r};throw r}}}ao.nextInstanceID=0;const SC=ao;class kC extends SC{constructor(e){super(e)}}var CC=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class PC{constructor(e,s,r){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=s,!e)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const a=R1(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:_1,realtime:k1,auth:Object.assign(Object.assign({},S1),{storageKey:c}),global:v1},h=I1(r??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=T1(s,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Gk(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new jk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new w1(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},r={}){return this.rest.rpc(e,s,r)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,s;return CC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kC({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new l1(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r?.access_token)})}_handleTokenChanged(e,s,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const EC=(t,e,s)=>new PC(t,e,s),Jd=EC("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),TC=async t=>{if(t.locator.campaignName===void 0)throw new Error("can not save a campaign without a name");const e=await Jd.rpc("save_campaign_version",{p_name:t.locator.campaignName,p_data:await Tk(t),p_published:t.meta?.published??!1});if(e.error)throw new Error(`error saving to db ${e.error.message} ${e.error.details}`,{cause:e.error});return e.data},MC=async t=>{const e=await Jd.rpc("get_latest_campaign",{p_campaign_name:t.campaignName,p_user_id:t.userId,p_version:t.version===-1?void 0:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const s=await mb(e.data.data);return Object.values(s.rooms).forEach(r=>{delete r.size}),s.locator===void 0&&(s.locator={userId:t.userId||"upgraded, unknown",campaignName:t.campaignName,version:e.data.version}),delete s.name,s},RC=async({publishedOnly:t})=>{const e=await Jd.rpc("get_all_users_latest_campaigns",{p_published_only:t});if(e.error)throw new Error("could not get user campaigns",{cause:e.error});return e.data},Ui=t=>{const e=[];for(let s=t;s!==void 0;s=s instanceof Error?s.cause:void 0)s instanceof Error&&e.push({message:s.message,stack:s.stack});return e},Nr=Ak({reducerPath:"campaignsApi",baseQuery:YS(),endpoints:t=>({getCampaign:t.query({async queryFn(e){try{return e.userId==="@@original"&&e.campaignName==="original"?{data:(await yk()).campaign}:e.campaignName.startsWith("data:")?{data:await mb(e.campaignName.substring(5))}:{data:await MC(e)}}catch(s){return{error:Ui(new Error(`getCampaign queryFn( ${JSON.stringify(e)} ) failed: ${s}`))}}}}),getAllUsersLatestCampaigns:t.query({async queryFn({publishedOnly:e}){try{return{data:await RC({publishedOnly:e})}}catch(s){return{error:Ui(new Error(`getAllUsersLatestCampaigns queryFn() failed: ${s}`))}}}}),saveCampaign:t.mutation({async queryFn(e){try{return{data:await TC(e)}}catch(s){return{error:Ui(new Error(`saveCampaign queryFn( ${JSON.stringify(e)} ) failed: ${s}`))}}}})})}),{useGetAllUsersLatestCampaignsQuery:IC}=Nr,jC=Nr.endpoints.getCampaign.select,OC=(t,e)=>jC(e)(t).data,lo={inputAssignment:Pn.Default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:mt()==="mobile"?"handheld":"zxSpectrum"},gameSpeed:1.2,showFps:!1,onScreenControls:mt()==="mobile"||mt()==="tablet",inputDirectionMode:"8-way",directionsRelativeTo:"mixed",soundSettings:{mute:!1,noFootsteps:!1}},yt=t=>e=>al(e.gameMenus.userSettings,t)??al(lo,t),hl=yt("inputAssignment"),WU=t=>t.gameMenus.openMenus.length>0,BC=()=>K(t=>t.gameMenus.cheatsOn),jb=t=>t.gameMenus.assigningInput!==void 0,Ob=()=>K(jb),NC=t=>{if(t.gameMenus.userSettings.inputAssignment===void 0)return"Default";for(const[e,s]of Ye(Qx(Pn)))if(OS(s.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},Tn=()=>K(t=>t.gameMenus.gameRunning),zC=yt("showFps"),$l=yt("displaySettings.emulatedResolution"),Zd=yt("gameSpeed"),DC=()=>K($l),FC=yt("displaySettings.uncolourised"),ef=()=>K(FC),LC=yt("displaySettings.crtFilter"),Bb=yt("infiniteLivesPoke"),Nb=yt("infiniteDoughnutsPoke"),GU=t=>t.gameMenus.gameInPlay.planetsLiberated.egyptus&&t.gameMenus.gameInPlay.planetsLiberated.bookworld&&t.gameMenus.gameInPlay.planetsLiberated.penitentiary&&t.gameMenus.gameInPlay.planetsLiberated.safari,tf=yt("directionsRelativeTo"),sf=()=>K(tf),rf=yt("inputDirectionMode"),zb=()=>K(rf),UC=t=>ch(Ye(Ls(t.gameMenus.gameInPlay.planetsLiberated)).filter(Boolean)),$C=yt("displaySettings.showBoundingBoxes"),YU=()=>K($C),HC=yt("displaySettings.showShadowMasks"),KU=()=>K(HC),WC=yt("onScreenControls"),GC=yt("soundSettings.mute"),YC=yt("soundSettings.noFootsteps"),QU=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??lo.onScreenControls)&&e.upscale.rotate90===!1,KC=()=>K(WC),QC=(t,e)=>!!(al(t.userSettings,e)??al(lo,e)??!1),XC=()=>K(t=>t.gameMenus.gameInPlay.roomsExplored),Db=t=>{const e=JC(t);if(!e)throw new Error(`No current campaign. Campaign locator is:
${JSON.stringify(t.gameMenus.gameInPlay.campaignLocator,null,2)}`);return e},Fb=sb(Db),JC=t=>{const e=t.gameMenus.gameInPlay.campaignLocator;return e===void 0?void 0:OC(t,e)},qh=[1,1.2,1.5,2],XU=["none","non-wall","all"],mi=t=>J0(no(t,"userId","campaignName")),Lb=["4-way","8-way","analogue"],ZC=mt()!=="server",eP=ZC?ms().has("cheats"):!1,tP={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},vh={planetsLiberated:tP,roomsExplored:{},scrollsRead:{},reincarnationPoint:void 0,freeCharacters:{}},_h={userSettings:{displaySettings:{},soundSettings:navigator.webdriver?{mute:!0}:{}},gameRunning:!1,gameInPlay:vh,openMenus:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:pe}],assigningInput:void 0,cheatsOn:eP,savedGames:{saves:{}}},Io=Es({name:"gameMenus",initialState:_h,reducers:{setEmulatedResolution(t,{payload:e}){let s;e===void 0?s=na(TS,$l({gameMenus:t})):s=e,t.userSettings.displaySettings.emulatedResolution=s},setGameSpeed(t,{payload:e}){let s;e===void 0?s=na(qh,Zd({gameMenus:t})):s=e,t.userSettings.gameSpeed=s},scrollRead(t,{payload:e}){e.source==="manual"?(t.gameInPlay.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:pe}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=na(Lb,rf({gameMenus:t}))},nextDirectionRelativeTo(t){t.userSettings.directionsRelativeTo=na(tb,tf({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const s=(o,a)=>{o.includes(a)||o.push(a)},{presses:r,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":s(r.keys,e.input);break;case"gamepadButtons":s(r.gamepadButtons,e.input);break;case"gamepadAxes":{yn.includes(i)&&s(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:s,axes:r}=t.assigningInput,n=s.keys.length+s.gamepadButtons.length+r.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(Pn.Default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=s,(e==="left"||e==="right")&&(i.axes.x=r),(e==="towards"||e==="away")&&(i.axes.y=r)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:pe}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},closeAllMenus(t){t.openMenus=[]},gameStarted(t,{payload:{campaignLocator:e,noShowCrowns:s}}){if(t.gameRunning)throw new Error("game is already running");t.openMenus=s?[]:[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.gameInPlay={...vh,campaignLocator:e}},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...s]=t.openMenus;t.openMenus=s,t.userSettings.inputAssignment=Pn[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:s}}){const[r]=t.openMenus;r.focussedItemId=e,r.scrollableSelection=s},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:pe}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:pe}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleUserSetting(t,{payload:{path:e,value:s}}){RS(t.userSettings,e,s??!QC(t,e))},crownCollected(t,{payload:e}){t.gameInPlay.planetsLiberated[e]=!0;const s=Object.values(t.gameInPlay.planetsLiberated).every(n=>n),r={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};s?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:pe},r]:t.openMenus=[r]},roomExplored(t,{payload:e}){t.gameInPlay.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){if(e&&t.gameInPlay.reincarnationPoint!==void 0)t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:pe},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:pe}];else{t.gameRunning=!1,delete t.gameInPlay.reincarnationPoint;const s=t.gameInPlay.campaignLocator,r=s&&mi(s);r&&(delete t.savedGames.saves[r],delete t.savedGames.lastSavedCampaignLocator),t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:pe},{menuId:"mainMenu",scrollableSelection:!0,menuParam:pe}]}},reincarnationFishEaten(t,{payload:e}){t.gameInPlay.reincarnationPoint=e},reincarnationAccepted(t){delete t.gameInPlay.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:pe}]},saveGame(t,{payload:e}){const s=t.gameInPlay.campaignLocator;if(s===void 0)throw new Error("trying to save a game, but seems like there's no campaign to save against");if(Dd())throw new Error("shouldn't be saving in playtest mode");t.savedGames.saves[mi(s)]=e,t.savedGames.lastSavedCampaignLocator=s},gameRestoreFromSave(t,{payload:e}){t.gameInPlay={freeCharacters:{},...e},e.freeCharacters===void 0&&(t.gameInPlay.freeCharacters={})},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,_h),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){},lostLife(t,e){},characterReachesFreedom(t,{payload:e}){t.gameInPlay.freeCharacters[e]=!0}},extraReducers(t){t.addCase(Po,(e,s)=>{if(ms().get("campaignName")?.startsWith("data:"))return;const r=[{menuId:"hold",scrollableSelection:!1,menuParam:pe}],n={userId:ms().get("campaignAuthorUserId")??void 0,campaignName:ms().get("campaignName")??void 0},i=s.payload?.savedGames;if((c=>c.userId!==void 0&&c.campaignName!==void 0)(n)){e.gameRunning=!0;const c=i?.saves[mi(n)];if(c){e.gameRunning=!0,e.gameInPlay={freeCharacters:{},...c.store.gameMenus.gameInPlay},e.openMenus=r;return}else{e.gameRunning=!0,e.gameInPlay={...vh,campaignLocator:n},e.openMenus=r;return}}const a=i?.lastSavedCampaignLocator,l=a&&i.saves[mi(a)];l&&(e.gameRunning=!0,e.gameInPlay={freeCharacters:{},...l.store.gameMenus.gameInPlay},e.openMenus=r)})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")},selectSaveForCampaign(t,e){return t.savedGames.saves[mi(e)]}}}),{assignInputStart:je,backToParentMenu:gt,characterReachesFreedom:JU,characterRoomChange:Ub,closeAllMenus:sP,crownCollected:rP,debugItemClicked:nP,doneAssigningInput:iP,errorCaught:nf,errorDismissed:ng,gameOver:of,gameRestoreFromSave:ZU,gameStarted:co,goToSubmenu:ot,holdPressed:$b,inputAddedDuringAssignment:oP,keyAssignmentPresetChosen:aP,lostLife:lP,mapPressed:cP,menuOpenOrExitPressed:ig,nextDirectionRelativeTo:uP,nextInputDirectionMode:hP,reincarnationAccepted:af,reincarnationFishEaten:e$,roomExplored:dP,saveGame:fP,scrollRead:t$,setEmulatedResolution:lf,setFocussedMenuItemId:cf,setGameSpeed:pP,setShowBoundingBoxes:s$,setShowShadowMasks:r$,toggleUserSetting:es}=Io.actions,{selectHasError:n$}=Io.selectors,i$=Io.selectors.selectSaveForCampaign,mP=()=>{const{hostname:t}=window.location;if(t==="localhost"||t.endsWith(".local")||t==="::1"||t==="[::1]")return!0;const e=t.startsWith("[")?t.slice(1,-1):t;if(e.toLowerCase().startsWith("fe80:")||e.toLowerCase().startsWith("fc00:")||e.toLowerCase().startsWith("fd00:")||t.startsWith("127.")||t.startsWith("192.168.")||t.startsWith("10."))return!0;if(t.startsWith("172.")){const s=Number.parseInt(t.split(".")[1]);if(s>=16&&s<=31)return!0}return!1},og="https://cloud.umami.is/script.js",gP="11813495-5844-44e6-acd4-f81e9c955951",AP=()=>{const e=ms().get("track");if(e!==null){const r=e==="1";return console.log(r?" tracking explicitly enabled via query param":" tracking explicitly disabled via query param"),r}const s=mP();return console.log(s?" not tracking because running on local network":" tracking enabled based on non-local network hostname"),!s},yP=ys(of,af,lP,nf,co,rP,Ub),xP=()=>{const t=Ex();v.useEffect(()=>Pd({matcher:yP,effect(s,{getState:r}){const n=t?.gameState,[,i]=s.type.split("/"),o=r(),a=n?Math.round(n.gameTime/1e3):void 0,l=s.payload===void 0?{}:s.type==="gameMenus/crownCollected"?{crownForPlanet:s.payload}:s.type==="gameMenus/gameStarted"?void 0:s.type==="gameMenus/lostLife"?{position:s.payload.characterLosingLifeItem.state.position}:s.payload,c={gameTimeSeconds:a,cheatsOn:o.gameMenus.cheatsOn,...l,currentCharacter:n?.currentCharacterName,inRoom:n?.characterRooms[n.currentCharacterName]};window.umami?(console.debug(" umami event:",i,c),window.umami.track(i,c)):console.debug(" no umami for event:",i,c)}}),[t])},bP=()=>{if(document.querySelector(`script[src="${og}"]`))return;const t=document.createElement("script");t.src=og,t.dataset.websiteId=gP,t.onload=()=>console.log(" umami script dynamically loaded"),document.head.appendChild(t)},wP=()=>(xP(),v.useEffect(bP,[]),null),VP=()=>{const t=v.useRef(null);return t.current===null&&(t.current=AP()),t.current?p.jsx(wP,{}):null},qP=Un(()=>is(()=>import("./Cheats-DArOlNkg.js"),__vite__mapDeps([3,1,2,4]))),rn=(t,e,s)=>{const r=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...Xs(s,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...Xs(s,{x:i+2,y:o}),w:a,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.whole`,{frame:{...r({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...r({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...r({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...r({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return Gn(n())},vP={frames:{...rn("generic","y",{x:580,y:415}),...rn("generic","x",{x:582,y:415}),...rn("moonbase","y",{x:752,y:232}),...rn("moonbase","x",{x:915,y:232}),...rn("moonbase.dark","y",{x:752,y:306}),...rn("moonbase.dark","x",{x:915,y:306})}},hr=(t,{x:e,y:s},r)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:s,...r}}],yield[`${t}.away`,{frame:{x:e+r.w+1,y:s,...r}}],yield[`${t}.towards`,{frame:{x:e,y:s+r.h+1,...r}}],yield[`${t}.right`,{frame:{x:e+r.w+1,y:s+r.h+1,...r}}]}return Object.fromEntries(n())},Ce=(t,e,{x:s,y:r},n,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:s+a%i*(n.w+1),y:r+Math.floor(a/i)*(n.h+1),...n}}]}return Object.fromEntries(o())},ag=(t,{x:e,y:s},r,n=t.length,i)=>{function*o(){for(let a=0;a<t.length;a++)yield[i?`${i}.${t[a]}`:t[a],{frame:{x:e+a%n*(r.w+1),y:s+Math.floor(a/n)*(r.h+1),...r}}]}return Object.fromEntries(o())},_P=(t,e,s,r)=>({...Ce(`${t}.left`,e,s,r),...Ce(`${t}.away`,e,Xs(s,{x:(r.w+1)*e}),r),...Ce(`${t}.towards`,e,Xs(s,{y:r.h+1}),r),...Ce(`${t}.right`,e,Xs(s,{x:(r.w+1)*e,y:r.h+1}),r)}),Pi=(t,e)=>[...Ye(Kx(1,e+1)).map(s=>`${t}.${String(s)}`)],SP={frames:{...ag(["share","save","open","pointer","eyedropper"],{x:640,y:10},{w:12,h:12},void 0,"editor.tool"),...ag(["single","corridor","double","triple.line","triple.^","quad.square","quad.s","quad.31","quad.t","5.x"],{x:640,y:0},{w:9,h:9},void 0,"editor.addRoom")}},Hb={" ":"space",",":"comma",";":"scolon",":":"colon",".":"dot","'":"sQuote","":"lQuote","":"rQuote","`":"backtick","<":"lt",">":"gt","?":"questMk","!":"exclMk","-":"hyph","/":"slash","\\":"bSlash"},Dt=t=>Hb[t].toUpperCase(),Wb=t=>Hb[t]??t,Sh={w:32,h:16},Mt={w:16,h:56},J={w:32,h:28},B={w:24,h:24},Ei={w:8,h:8},kP={h:10},O=t=>({x:t.x*(B.w+1)+1,y:t.y*(B.h+1)+2}),te=t=>({x:t.x*(J.w+1)+1,y:t.y*(J.h+1)+682}),Gb="",Yb="",CP="",PP="",EP="",TP="",MP=[{char:"a",width:8},{char:"b",width:8},{char:"c",width:7},{char:"d",width:8},{char:"e",width:8},{char:"f",width:6},{char:"g",width:8},{char:"h",width:8},{char:"i",width:4},{char:"j",width:5},{char:"k",width:8},{char:"l",width:5},{char:"m",width:9},{char:"n",width:8},{char:"o",width:8},{char:"p",width:8},{char:"q",width:8},{char:"r",width:5},{char:"s",width:6},{char:"t",width:6},{char:"u",width:8},{char:"v",width:8},{char:"w",width:9},{char:"x",width:8},{char:"y",width:8},{char:"z",width:6},{char:"?",width:6},{char:"!",width:4},{char:".",width:4},{char:",",width:4},{char:";",width:4},{char:":",width:3},{char:"/",width:7},{char:"\\",width:7},{char:"",width:4},{char:"",width:4},{char:"'",width:4},{char:"-",width:5}],RP=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","","","","",{char:"",width:16},{char:Gb,width:16},{char:Yb,width:16}],IP=[" ",Dt("?"),Dt("!"),Dt("."),Dt(","),Dt(";"),Dt(":"),Dt("/"),Dt("\\"),Dt(""),Dt(""),Dt("'"),"`",Dt("-"),"+","%","","","","","","","","","(",")","[","]","<",">","","","","EnterFullscreen","ExitFullscreen","Menu","*","@","",CP,PP,EP,TP,"","","^","","","",""],Wc=(t,e,s=Ei.h)=>{function*r(){let{x:n}=e;for(let i=0;i<t.length;i++){const o=t[i],a=typeof o=="string"?o:o.char,c=(typeof o=="string"?void 0:o.width)??Ei.w;yield[`hud.char.${Wb(a)}`,{frame:{x:n,y:e.y,...Ei,w:c,h:s}}],n+=Math.max(c,Ei.w)+1}}return Gn(r())},jP={frames:{...Wc(MP,{x:1,y:994},10),...Wc(RP,{x:1,y:1005}),...Wc(IP,{x:1,y:1014})}},ie=(t,e)=>Object.assign([...t],{animationSpeed:e}),OP={...Ce("dalek",2,O({x:0,y:0}),B),"shadowMask.dalek":{frame:{...O({x:2,y:0}),...B}},...Ce("bubbles.cold",2,O({x:3,y:0}),B),headlessBase:{frame:{...O({x:7,y:0}),...B}},...Ce("headlessBase",4,O({x:8,y:0}),B),"headlessBase.all":{frame:{...O({x:12,y:0}),...B}},..._P("turtle",2,O({x:0,y:3}),B),"shadowMask.turtle.away":{frame:{...O({x:4,y:3}),...B}},"shadowMask.turtle.right":{frame:{...O({x:4,y:4}),...B}},...hr("cyberman",O({x:6,y:3}),B),...hr("skiHead.greenAndPink",O({x:9,y:3}),{w:24,h:32}),...hr("skiHead.starsAndStripes",O({x:11,y:3}),{w:24,h:32}),"shadowMask.skiHead.away":{frame:{...O({x:13,y:3}),...B,h:32}},"shadowMask.skiHead.right":{frame:{...O({x:14,y:3}),...B,h:32}},...hr("monkey",O({x:0,y:7}),B),...hr("computerBot",O({x:3,y:7}),B),...hr("elephant",O({x:6,y:7}),B),...Ce("helicopterBug",4,O({x:9,y:7}),B),"barrier.x":{frame:{...O({x:17,y:0}),...B,pivot:{x:18,y:23}}},"barrier.y":{frame:{...O({x:18,y:0}),...B,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...O({x:19,y:0}),...B,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...O({x:20,y:0}),...B,pivot:{x:6,y:22}}},"joystick.stick":{frame:{...O({x:18,y:1}),...B}},"joystick.ball":{frame:{...O({x:19,y:1}),...B}},"joystick.whole":{frame:{...O({x:20,y:1}),...B}},"shadowMask.joystick":{frame:{...O({x:21,y:1}),...B}},ball:{frame:{...O({x:17,y:2}),...B}},"shadowMask.ball":{frame:{...O({x:18,y:2}),...B}},"spikyBall.1":{frame:{...O({x:20,y:2}),...B}},"spikyBall.2":{frame:{...O({x:21,y:2}),...B}},tower:{frame:{...O({x:15,y:3}),...B}},"shadowMask.tower":{frame:{...O({x:16,y:3}),...B}},sticks:{frame:{...O({x:18,y:3}),...B}},cube:{frame:{...O({x:19,y:3}),...B}},drum:{frame:{...O({x:21,y:3}),...B}},"shadowMask.drum":{frame:{...O({x:22,y:3}),...B}},puck:{frame:{...O({x:15,y:4}),...B}},"shadow.smallRound":{frame:{...O({x:16,y:4}),...B}},"shadowMask.smallRound":{frame:{...O({x:17,y:4}),...B}},"spring.compressed":{frame:{...O({x:19,y:4}),...B}},"spring.released":{frame:{...O({x:20,y:4}),...B}},"shadowMask.spring.compressed":{frame:{...O({x:21,y:4}),...B}},"shadowMask.spring.released":{frame:{...O({x:22,y:4}),...B}},...Ce("fish",2,O({x:15,y:6}),B),doughnuts:{frame:{...O({x:18,y:6}),...B}},"shadowMask.doughnuts":{frame:{...O({x:19,y:6}),...B}},hooter:{frame:{...O({x:21,y:6}),...B}},bag:{frame:{...O({x:22,y:6}),...B}},whiteRabbit:{frame:{...O({x:24,y:6}),...B}},"shadowMask.whiteRabbit":{frame:{...O({x:25,y:6}),...B}},"crown.blacktooth":{frame:{...O({x:15,y:7}),...B}},"crown.safari":{frame:{...O({x:16,y:7}),...B}},"crown.egyptus":{frame:{...O({x:17,y:7}),...B}},"crown.penitentiary":{frame:{...O({x:18,y:7}),...B}},"crown.bookworld":{frame:{...O({x:19,y:7}),...B}},scroll:{frame:{...O({x:15,y:8}),...B,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...O({x:16,y:8}),...B,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...O({x:17,y:8}),...B,pivot:{x:17,y:24}}},buttonInGame:{frame:{...O({x:15,y:9}),...B}},"buttonInGame.pressed":{frame:{...O({x:16,y:9}),...B}},"shadowMask.buttonInGame":{frame:{...O({x:17,y:9}),...B}},"switch.left":{frame:{...O({x:19,y:9}),...B}},"switch.right":{frame:{...O({x:20,y:9}),...B}},"shadowMask.switch":{frame:{...O({x:21,y:9}),...B}},"lift.static":{frame:{...O({x:15,y:10}),...B}},...Ce("lift",4,O({x:16,y:10}),B),...Ce("shadow.lift",4,O({x:16,y:11}),B),"shadow.smallBlock":{frame:{...O({x:20,y:10}),...B}},"shadowMask.smallBlock":{frame:{...O({x:21,y:10}),...B}},...hr("charles",O({x:15,y:12}),B),"shadowMask.charles.away":{frame:{...O({x:17,y:12}),...B}},"shadowMask.charles.right":{frame:{...O({x:17,y:13}),...B}},...Ce("bubbles.white",3,O({x:19,y:12}),B),...Ce("bubbles.taupe",3,O({x:19,y:13}),B),"editor.cursor.xz":{frame:{...te({x:7,y:-2}),...J}},"editor.cursor.floor":{frame:{...te({x:7,y:-1}),...J}},"block.organic":{frame:{...te({x:0,y:0}),...J}},"block.organic.disappearing":{frame:{...te({x:1,y:0}),...J}},"block.organic.dark":{frame:{...te({x:2,y:0}),...J}},"block.organic.dark.disappearing":{frame:{...te({x:3,y:0}),...J}},"shadowMask.organic":{frame:{...te({x:4,y:0}),...J}},"block.artificial":{frame:{...te({x:5,y:0}),...J}},"block.artificial.disappearing":{frame:{...te({x:6,y:0}),...J}},"shadowMask.artificial":{frame:{...te({x:7,y:0}),...J}},"book.x":{frame:{...te({x:8,y:0}),...J}},"book.y":{frame:{...te({x:9,y:0}),...J}},"shadowMask.book":{frame:{...te({x:10,y:0}),...J}},"shadowMask.fullBlock":{frame:{...te({x:10,y:0}),...J}},"shadow.fullBlock":{frame:{...te({x:11,y:0}),...J}},spikes:{frame:{...te({x:12,y:0}),...J}},"shadowMask.spikes":{frame:{...te({x:13,y:0}),...J}},stepStool:{frame:{...te({x:0,y:1}),...J}},"shadowMask.stepStool":{frame:{...te({x:1,y:1}),...J}},"volcano.1":{frame:{...te({x:2,y:1}),...J}},"volcano.2":{frame:{...te({x:3,y:1}),...J}},"shadowMask.volcano":{frame:{...te({x:4,y:1}),...J}},hushPuppy:{frame:{...te({x:5,y:1}),...J}},"shadowMask.hushPuppy":{frame:{...te({x:6,y:1}),...J}},"toaster.on":{frame:{...te({x:7,y:1}),...J}},"toaster.off":{frame:{...te({x:8,y:1}),...J}},"shadowMask.toaster":{frame:{...te({x:9,y:1}),...J}},sandwich:{frame:{...te({x:10,y:1}),...J}},"shadowMask.sandwich":{frame:{...te({x:11,y:1}),...J}},...Ce("conveyor.x",7,te({x:0,y:2}),J),"shadowMask.conveyor":{frame:{...te({x:7,y:2}),...J}},button:{frame:{...te({x:9,y:2}),...J}},"button.pressed":{frame:{...te({x:10,y:2}),...J}},"button.surfaceMask":{frame:{...te({x:11,y:2}),...J}},...Ce("conveyor.y",7,te({x:0,y:3}),J),teleporter:{frame:{...te({x:7,y:3}),...J}},...Ce("teleporter.flashing",2,te({x:8,y:3}),J),"shadowMask.teleporter":{frame:{...te({x:10,y:3}),...J}},"shadowMask.teleporter.flashing":{frame:{...te({x:11,y:3}),...J}},...Ce("particle",4,{x:100,y:798},{w:9,h:11})},Kb={frames:OP,animations:{"teleporter.flashing":ie(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:ie(["fish.1","fish.2"],.25),lift:ie(["lift.1","lift.2","lift.3","lift.4"],.5),"shadow.lift":ie(["shadow.lift.1","shadow.lift.2","shadow.lift.3","shadow.lift.4"],.5),dalek:ie(["dalek.1","dalek.2"],.5),"turtle.left":ie(["turtle.left.1","turtle.left.2"],.25),"turtle.away":ie(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":ie(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":ie(["turtle.right.1","turtle.right.2"],.25),helicopterBug:ie(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":ie(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":ie(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":ie(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":ie(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":ie(Pi("conveyor.x",7),.5),"conveyor.y":ie(Pi("conveyor.y",7),.5),volcano:ie(Pi("volcano",2),3/16),"spring.bounce":ie(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"shadowMask.spring.bounce":ie(["shadowMask.spring.released","shadowMask.spring.compressed","shadowMask.spring.released","shadowMask.spring.compressed","shadowMask.spring.released"],.5),"headlessBase.scan":ie(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":ie(["headlessBase.all","headlessBase"],.5),switch:ie(["switch.left","switch.right"],.02),"particle.fade":ie(Pi("particle",4),.5)}},BP=.5,Qb=5e3,NP=Qb*2,gi=(t,e)=>{const s=Math.round(Qb/(Mo*4)),r=`head.walking.${t}.${e}`,n=`head.blinking.${t}`,i=[...new Array(s-3).fill(r),n,r,n];return ie(i,.5)},Gc=(t,e=2)=>{const s=Math.round(NP/(Mo*4)),r=t==="towards"||t==="right"?`heels.standing.${t}`:`heels.walking.${t}.${e}`,n=`heels.blinking.${t}`,i=[...new Array(Math.floor(s*.8)).fill(r),...new Array(Math.ceil(s*.2)).fill(n)];return ie(i,.5)},lg=(t,e,s)=>{const r=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*n(){for(let i=0;i<Cn.length;i++){const o=r[i];s[o]?.noShadowMask||(yield[`shadowMask.${t}.${o}`,{frame:{...O({x:e.x,y:e.y+i}),...B}}]);for(let a=1;a<=3;a++)yield[`${t}.walking.${o}.${a}`,{frame:{...O({x:e.x+a,y:e.y+i}),...B}}];yield[`${t}.falling.${o}`,{frame:{...O({x:e.x+4,y:e.y+i}),...B}}],s[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...O({x:e.x+5,y:e.y+i}),...B}}]),s[o]?.noStanding||(yield[`${t}.standing.${o}`,{frame:{...O({x:e.x+6,y:e.y+i}),...B}}])}}return Object.fromEntries(n())};function cg(t){function*e(s,r){yield`${s}.walking.${r}.1`,yield`${s}.walking.${r}.2`,yield`${s}.walking.${r}.3`,yield`${s}.walking.${r}.2`}return Cn.reduce((s,r)=>({...s,[`${t}.walking.${r}`]:ie([...e(t,r)],BP)}),{})}const zP={...Ce("bubbles.head",6,O({x:0,y:10}),B),...lg("head",{x:0,y:11},{awayLeft:{noBlinking:!0,noStanding:!0},away:{noBlinking:!0,noStanding:!0},awayRight:{noStanding:!0},right:{noStanding:!0},towardsRight:{noStanding:!0},towards:{noShadowMask:!0,noStanding:!0},towardsLeft:{noShadowMask:!0,noStanding:!0},left:{noBlinking:!0,noShadowMask:!0,noStanding:!0}}),...Ce("bubbles.heels",6,O({x:7,y:10}),B),...lg("heels",{x:7,y:11},{awayLeft:{noBlinking:!0,noStanding:!0},away:{noBlinking:!0,noStanding:!0},awayRight:{noBlinking:!0,noStanding:!0},right:{},towardsRight:{noStanding:!0},towards:{noShadowMask:!0},towardsLeft:{noBlinking:!0,noShadowMask:!0,noStanding:!0},left:{noBlinking:!0,noShadowMask:!0,noStanding:!0}}),...Ce("shine",6,te({x:0,y:4}),J,3),blank:{frame:{...O({x:0,y:2}),...B}},"shadow.playable":{frame:{...O({x:6,y:10}),...B}}},Xb={frames:zP,animations:{...cg("head"),...cg("heels"),"heels.screenDirections":ie(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":ie(["heels.standing.towards","heels.walking.left.2","heels.walking.away.2","heels.standing.right"],1/16),"heels.mixedDirections":ie(["heels.walking.towardsRight.2","heels.standing.towards","heels.walking.towardsLeft.2","heels.walking.left.2","heels.walking.awayLeft.2","heels.walking.away.2","heels.walking.awayRight.2","heels.standing.right"],1/8),"head.idle.right":gi("right",3),"head.idle.towards":gi("towards",3),"head.idle.towardsRight":gi("towardsRight",2),"head.idle.towardsLeft":gi("towardsLeft",2),"head.idle.awayRight":gi("awayRight",2),"heels.idle.right":Gc("right"),"heels.idle.towards":Gc("towards"),"heels.idle.towardsRight":Gc("towardsRight",2),"head.fadeOut":ie(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":ie(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:ie(Pi("shine",6),.5),"shine.headInSymbio":ie(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":ie(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},DP={jail:["bars"],blacktooth:["plain","shield","armour"],bookworld:["book","cowboy"],egyptus:["hieroglyphics","sarcophagus"],market:["more-fruits","fruits","passage"],moonbase:["coil","window3","window2","window1","window-clear"],penitentiary:["skeleton","loop"],safari:["wall","shield","window"]},o$=["blacktooth","penitentiary","bookworld","egyptus","safari"],tt=(t,e,s,r)=>{function*n(i,o,a){const l=DP[i],{w:c,h:u}=Mt,h=c>>1;for(let d=0;d<l.length;d++)yield[`${i}${r}.wall.${l[d]}.left`,{frame:{x:o-c*(d+1),y:a+h*d,...Mt}}],yield[`${i}${r}.wall.${l[d]}.away`,{frame:{x:o+c*d,y:a+h*d,...Mt}}];yield[`${i}${r}.floor`,{frame:{x:o-c,y:a+u,...Sh}}]}return Object.fromEntries(n(t,e,s))},ug={w:16,h:13},hg={w:8,h:9},us=74;let st=53;const FP={...tt("egyptus",834,st,""),...tt("egyptus",834,st+=us,".dark"),...tt("moonbase",834,st+=us,""),...tt("moonbase",834,st+=us,".dark"),...tt("bookworld",834,st+=us,""),...tt("bookworld",834,st,".dark"),...tt("jail",834,st+=us,""),...tt("jail",834,st,".dark"),...tt("blacktooth",834,st+=us,""),...tt("blacktooth",834,st+=us,".dark"),...tt("penitentiary",834,st+=us,""),...tt("penitentiary",834,st,".dark"),...tt("market",834,st+=us,""),...tt("market",834,st,".dark"),...tt("safari",834,st+=us,""),...tt("safari",834,st,".dark"),"floorEdge.right":{frame:{x:418,y:466,...ug,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...ug,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...hg,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...hg,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Mt.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:785,y:462,...Sh}},"generic.dark.floor.deadly":{frame:{x:785,y:479,...Sh}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Mt.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Mt.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Mt.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Mt.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Mt.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Mt.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Mt.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...Ce("moonbase.wall.screen.window1.away",3,{x:883,y:217},{w:10,h:7}),...Ce("moonbase.wall.screen.window2.away",2,{x:867,y:209},{w:10,h:7}),...Ce("moonbase.wall.screen.window3.away",4,{x:851,y:201},{w:10,h:7})},Jb={frames:FP,animations:{"moonbase.wall.screen.window1.away":ie(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":ie(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":ie(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},LP={...Kb.frames,...Xb.frames,...Jb.frames,...jP.frames,...vP.frames,...SP.frames},Rt={frames:LP,animations:{...Xb.animations,...Kb.animations,...Jb.animations},meta:{scale:1}};function a$(t){if(!kh(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(Rt.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function kh(t){return Rt.frames[t]!==void 0}function l$(t){return Rt.animations[t]!==void 0}var G=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(G||{});const Ch=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},pa=(t,e)=>Ch(t).priority??e,_t={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Ch).forEach(e=>{e.type.forEach(s=>this._removeHandlers[s]?.(e))}),this},add(...t){return t.map(Ch).forEach(e=>{e.type.forEach(s=>{const r=this._addHandlers,n=this._queue;r[s]?r[s]?.(e):(n[s]=n[s]||[],n[s]?.push(e))})}),this},handle(t,e,s){const r=this._addHandlers,n=this._removeHandlers;if(r[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,n[t]=s;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,s=>{s.name&&(e[s.name]=s.ref)},s=>{s.name&&delete e[s.name]})},handleByNamedList(t,e,s=-1){return this.handle(t,r=>{e.findIndex(i=>i.name===r.name)>=0||(e.push({name:r.name,value:r.ref}),e.sort((i,o)=>pa(o.value,s)-pa(i.value,s)))},r=>{const n=e.findIndex(i=>i.name===r.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,s=-1){return this.handle(t,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((n,i)=>pa(i,s)-pa(n,s)))},r=>{const n=e.indexOf(r.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const s of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(s))}},UP={extension:{type:G.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await is(()=>import("./browserAll-paNVug5E.js"),__vite__mapDeps([5,6,7,8,9,1,2]))}},$P={extension:{type:G.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await is(()=>import("./webworkerAll--9rGBH6Z.js"),__vite__mapDeps([6,7,8,9,1,2]))}};class nt{constructor(e,s,r){this._x=s||0,this._y=r||0,this._observer=e}clone(e){return new nt(e??this._observer,this._x,this._y)}set(e=0,s=e){return(this._x!==e||this._y!==s)&&(this._x=e,this._y=s,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Yc={exports:{}},dg;function HP(){return dg||(dg=1,(function(t){var e=Object.prototype.hasOwnProperty,s="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(s=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,h||l,d),m=s?s+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(s?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=s?s+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,m=new Array(f);d<f;d++)m[d]=h[d].fn;return m},a.prototype.listenerCount=function(c){var u=s?s+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,m){var A=s?s+c:c;if(!this._events[A])return!1;var g=this._events[A],y=arguments.length,w,x;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,d),!0;case 5:return g.fn.call(g.context,u,h,d,f),!0;case 6:return g.fn.call(g.context,u,h,d,f,m),!0}for(x=1,w=new Array(y-1);x<y;x++)w[x-1]=arguments[x];g.fn.apply(g.context,w)}else{var b=g.length,q;for(x=0;x<b;x++)switch(g[x].once&&this.removeListener(c,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,u);break;case 3:g[x].fn.call(g[x].context,u,h);break;case 4:g[x].fn.call(g[x].context,u,h,d);break;default:if(!w)for(q=1,w=new Array(y-1);q<y;q++)w[q-1]=arguments[q];g[x].fn.apply(g[x].context,w)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=s?s+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var A=0,g=[],y=m.length;A<y;A++)(m[A].fn!==u||d&&!m[A].once||h&&m[A].context!==h)&&g.push(m[A]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=s?s+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,t.exports=a})(Yc)),Yc.exports}var WP=HP();const bs=Ke(WP),GP=Math.PI*2,YP=180/Math.PI,KP=Math.PI/180;class lt{constructor(e=0,s=0){this.x=0,this.y=0,this.x=e,this.y=s}clone(){return new lt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,s=e){return this.x=e,this.y=s,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Kc.x=0,Kc.y=0,Kc}}const Kc=new lt;class le{constructor(e=1,s=0,r=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=s,this.c=r,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,s,r,n,i,o){return this.a=e,this.b=s,this.c=r,this.d=n,this.tx=i,this.ty=o,this}toArray(e,s){this.array||(this.array=new Float32Array(9));const r=s||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,s){s=s||new lt;const r=e.x,n=e.y;return s.x=this.a*r+this.c*n+this.tx,s.y=this.b*r+this.d*n+this.ty,s}applyInverse(e,s){s=s||new lt;const r=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(r*o+i*-n),u=e.x,h=e.y;return s.x=o*c*u+-i*c*h+(l*i-a*o)*c,s.y=r*c*h+-n*c*u+(-l*r+a*n)*c,s}translate(e,s){return this.tx+=e,this.ty+=s,this}scale(e,s){return this.a*=e,this.d*=s,this.c*=e,this.b*=s,this.tx*=e,this.ty*=s,this}rotate(e){const s=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*s-this.b*r,this.b=n*r+this.b*s,this.c=i*s-this.d*r,this.d=i*r+this.d*s,this.tx=o*s-this.ty*r,this.ty=o*r+this.ty*s,this}append(e){const s=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*s+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*s+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*s+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this}appendFrom(e,s){const r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=s.a,u=s.b,h=s.c,d=s.d;return this.a=r*c+n*h,this.b=r*u+n*d,this.c=i*c+o*h,this.d=i*u+o*d,this.tx=a*c+l*h+s.tx,this.ty=a*u+l*d+s.ty,this}setTransform(e,s,r,n,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+n*this.c),this.ty=s-(r*this.b+n*this.d),this}prepend(e){const s=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=s*e.a+this.ty*e.c+e.tx,this.ty=s*e.b+this.ty*e.d+e.ty,this}decompose(e){const s=this.a,r=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),l=Math.atan2(r,s),c=Math.abs(a+l);return c<1e-5||Math.abs(GP-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(s*s+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*s+o.y*n),e.position.y=this.ty+(o.x*r+o.y*i),e}invert(){const e=this.a,s=this.b,r=this.c,n=this.d,i=this.tx,o=e*n-s*r;return this.a=n/o,this.b=-s/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(e*this.ty-s*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new le;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return XP.identity()}static get shared(){return QP.identity()}}const QP=new le,XP=new le,yr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],xr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],br=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],wr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ph=[],Zb=[],ma=Math.sign;function JP(){for(let t=0;t<16;t++){const e=[];Ph.push(e);for(let s=0;s<16;s++){const r=ma(yr[t]*yr[s]+br[t]*xr[s]),n=ma(xr[t]*yr[s]+wr[t]*xr[s]),i=ma(yr[t]*br[s]+br[t]*wr[s]),o=ma(xr[t]*br[s]+wr[t]*wr[s]);for(let a=0;a<16;a++)if(yr[a]===r&&xr[a]===n&&br[a]===i&&wr[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new le;e.set(yr[t],xr[t],br[t],wr[t],0,0),Zb.push(e)}}JP();const xe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>yr[t],uY:t=>xr[t],vX:t=>br[t],vY:t=>wr[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Ph[t][e],sub:(t,e)=>Ph[t][xe.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?xe.S:xe.N:Math.abs(e)*2<=Math.abs(t)?t>0?xe.E:xe.W:e>0?t>0?xe.SE:xe.SW:t>0?xe.NE:xe.NW,matrixAppendRotationInv:(t,e,s=0,r=0)=>{const n=Zb[xe.inv(e)];n.tx=s,n.ty=r,t.append(n)},transformRectCoords:(t,e,s,r)=>{const{x:n,y:i,width:o,height:a}=t,{x:l,y:c,width:u,height:h}=e;return s===xe.E?(r.set(n+l,i+c,o,a),r):s===xe.S?r.set(u-i-a+l,n+c,a,o):s===xe.W?r.set(u-n-o+l,h-i-a+c,o,a):s===xe.N?r.set(i+l,h-n-o+c,a,o):r.set(n+l,i+c,o,a)}},ga=[new lt,new lt,new lt,new lt];class Ne{constructor(e=0,s=0,r=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(s),this.width=Number(r),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Ne(0,0,0,0)}clone(){return new Ne(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,s){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height}strokeContains(e,s,r,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=r*(1-n),u=r-c,h=a-c,d=a+i+c,f=l-c,m=l+o+c,A=a+u,g=a+i-u,y=l+u,w=l+o-u;return e>=h&&e<=d&&s>=f&&s<=m&&!(e>A&&e<g&&s>y&&s<w)}intersects(e,s){if(!s){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}const r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;const a=ga[0].set(e.left,e.top),l=ga[1].set(e.left,e.bottom),c=ga[2].set(e.right,e.top),u=ga[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(s.a*s.d-s.b*s.c);if(h===0||(s.apply(a,a),s.apply(l,l),s.apply(c,c),s.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=r||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),m=d*r+f*i,A=d*n+f*i,g=d*r+f*o,y=d*n+f*o;if(Math.max(m,A,g,y)<=d*a.x+f*a.y||Math.min(m,A,g,y)>=d*u.x+f*u.y)return!1;const w=h*(a.y-c.y),x=h*(c.x-a.x),b=w*r+x*i,q=w*n+x*i,_=w*r+x*o,V=w*n+x*o;return!(Math.max(b,q,_,V)<=w*a.x+x*a.y||Math.min(b,q,_,V)>=w*u.x+x*u.y)}pad(e=0,s=e){return this.x-=e,this.y-=s,this.width+=e*2,this.height+=s*2,this}fit(e){const s=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=s,this.width=Math.max(r-s,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,s=.001){const r=Math.ceil((this.x+this.width-s)*e)/e,n=Math.ceil((this.y+this.height-s)*e)/e;return this.x=Math.floor((this.x+s)*e)/e,this.y=Math.floor((this.y+s)*e)/e,this.width=r-this.x,this.height=n-this.y,this}scale(e,s=e){return this.x*=e,this.y*=s,this.width*=e,this.height*=s,this}enlarge(e){const s=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=s,this.width=r-s,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new Ne),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const s=e.x,r=e.y,n=e.x+e.width,i=e.y+e.height;return s>=this.x&&s<this.x+this.width&&r>=this.y&&r<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(e,s,r,n){return this.x=e,this.y=s,this.width=r,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Qc={default:-1};function ze(t="default"){return Qc[t]===void 0&&(Qc[t]=-1),++Qc[t]}const fg=new Set,at="8.0.0",ZP="8.3.4",gn={quiet:!1,noColor:!1},ve=(t,e,s=3)=>{if(gn.quiet||fg.has(e))return;let r=new Error().stack;const n=`${e}
Deprecated since v${t}`,i=typeof console.groupCollapsed=="function"&&!gn.noColor;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",n):(r=r.split(`
`).splice(s).join(`
`),i?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",n),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",n),console.warn(r))),fg.add(e)};Object.defineProperties(ve,{quiet:{get:()=>gn.quiet,set:t=>{gn.quiet=t},enumerable:!0,configurable:!1},noColor:{get:()=>gn.noColor,set:t=>{gn.noColor=t},enumerable:!0,configurable:!1}});const ew=()=>{};function dl(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function pg(t){return!(t&t-1)&&!!t}function tw(t){const e={};for(const s in t)t[s]!==void 0&&(e[s]=t[s]);return e}const mg=Object.create(null);function eE(t){const e=mg[t];return e===void 0&&(mg[t]=ze("resource")),e}const sw=class rw extends bs{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...rw.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){ve(at,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=eE(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};sw.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let fl=sw;const nw=class iw extends bs{constructor(e={}){super(),this.options=e,this.uid=ze("textureSource"),this._resourceType="textureSource",this._resourceId=ze("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...iw.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new fl(tw(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=ze("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,s,r){r||(r=this._resolution),e||(e=this.width),s||(s=this.height);const n=Math.round(e*r),i=Math.round(s*r);return this.width=n/r,this.height=i/r,this._resolution=r,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=ze("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=pg(this.pixelWidth)&&pg(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};nw.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let os=nw;class uf extends os{constructor(e){const s=e.resource||new Float32Array(e.width*e.height*4);let r=e.format;r||(s instanceof Float32Array?r="rgba32float":s instanceof Int32Array||s instanceof Uint32Array?r="rgba32uint":s instanceof Int16Array||s instanceof Uint16Array?r="rgba16uint":(s instanceof Int8Array,r="bgra8unorm")),super({...e,resource:s,format:r}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}uf.extension=G.TextureSource;const gg=new le;class tE{constructor(e,s){this.mapCoord=new le,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof s>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=s,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,s){s===void 0&&(s=e);const r=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];s[n]=i*r.a+o*r.c+r.tx,s[n+1]=i*r.b+o*r.d+r.ty}return s}update(){const e=this._texture;this._updateID++;const s=e.uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,n=e.trim;n&&(gg.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(gg));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class ce extends bs{constructor({source:e,label:s,frame:r,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=ze("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Ne,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=s,this.source=e?.source??new os,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new tE(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:s}=this,{width:r,height:n}=this._source,i=s.x/r,o=s.y/n,a=s.width/r,l=s.height/n;let c=this.rotate;if(c){const u=a/2,h=l/2,d=i+u,f=o+h;c=xe.add(c,xe.NW),e.x0=d+u*xe.uX(c),e.y0=f+h*xe.uY(c),c=xe.add(c,2),e.x1=d+u*xe.uX(c),e.y1=f+h*xe.uY(c),c=xe.add(c,2),e.x2=d+u*xe.uX(c),e.y2=f+h*xe.uY(c),c=xe.add(c,2),e.x3=d+u*xe.uX(c),e.y3=f+h*xe.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ve(at,"Texture.baseTexture is now Texture.source"),this._source}}ce.EMPTY=new ce({label:"EMPTY",source:new os({label:"EMPTY"})});ce.EMPTY.destroy=ew;ce.WHITE=new ce({source:new uf({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});ce.WHITE.destroy=ew;function sE(t,e,s){const{width:r,height:n}=s.orig,i=s.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*r,t.maxX=t.minX+o,t.minY=i.y-e._y*n,t.maxY=t.minY+a}else t.minX=-e._x*r,t.maxX=t.minX+r,t.minY=-e._y*n,t.maxY=t.minY+n}const Ag=new le;class ss{constructor(e=1/0,s=1/0,r=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ag,this.minX=e,this.minY=s,this.maxX=r,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Ne);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ag,this}set(e,s,r,n){this.minX=e,this.minY=s,this.maxX=r,this.maxY=n}addFrame(e,s,r,n,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let d=this.minX,f=this.minY,m=this.maxX,A=this.maxY,g=o*e+l*s+u,y=a*e+c*s+h;g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*r+l*s+u,y=a*r+c*s+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*e+l*n+u,y=a*e+c*n+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*r+l*n+u,y=a*r+c*n+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),this.minX=d,this.minY=f,this.maxX=m,this.maxY=A}addRect(e,s){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,s)}addBounds(e,s){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,s)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const s=this.minX,r=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let d=o*s+l*r+u,f=a*s+c*r+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*n+l*r+u,f=a*n+c*r+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*s+l*i+u,f=a*s+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*n+l*i+u,f=a*n+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,s,r,n){return this.minX<e&&(this.minX=e),this.maxX>s&&(this.maxX=s),this.minY<r&&(this.minY=r),this.maxY>n&&(this.maxY=n),this}pad(e,s=e){return this.minX-=e,this.maxX+=e,this.minY-=s,this.maxY+=s,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new ss(this.minX,this.minY,this.maxX,this.maxY)}scale(e,s=e){return this.minX*=e,this.minY*=s,this.maxX*=e,this.maxY*=s,this}get x(){return this.minX}set x(e){const s=this.maxX-this.minX;this.minX=e,this.maxX=e+s}get y(){return this.minY}set y(e){const s=this.maxY-this.minY;this.minY=e,this.maxY=e+s}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,s,r,n){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,d=n.d,f=n.tx,m=n.ty;for(let A=s;A<r;A+=2){const g=e[A],y=e[A+1],w=c*g+h*y+f,x=u*g+d*y+m;i=w<i?w:i,o=x<o?x:o,a=w>a?w:a,l=x>l?x:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,s){return this.minX<=e&&this.minY<=s&&this.maxX>=e&&this.maxY>=s}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var rE={grad:.9,turn:360,rad:360/(2*Math.PI)},ks=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},We=function(t,e,s){return e===void 0&&(e=0),s===void 0&&(s=Math.pow(10,e)),Math.round(s*t)/s+0},Ut=function(t,e,s){return e===void 0&&(e=0),s===void 0&&(s=1),t>s?s:t>e?t:e},ow=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},yg=function(t){return{r:Ut(t.r,0,255),g:Ut(t.g,0,255),b:Ut(t.b,0,255),a:Ut(t.a)}},Xc=function(t){return{r:We(t.r),g:We(t.g),b:We(t.b),a:We(t.a,3)}},nE=/^#([0-9a-f]{3,8})$/i,Aa=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},aw=function(t){var e=t.r,s=t.g,r=t.b,n=t.a,i=Math.max(e,s,r),o=i-Math.min(e,s,r),a=o?i===e?(s-r)/o:i===s?2+(r-e)/o:4+(e-s)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},lw=function(t){var e=t.h,s=t.s,r=t.v,n=t.a;e=e/360*6,s/=100,r/=100;var i=Math.floor(e),o=r*(1-s),a=r*(1-(e-i)*s),l=r*(1-(1-e+i)*s),c=i%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c],a:n}},xg=function(t){return{h:ow(t.h),s:Ut(t.s,0,100),l:Ut(t.l,0,100),a:Ut(t.a)}},bg=function(t){return{h:We(t.h),s:We(t.s),l:We(t.l),a:We(t.a,3)}},wg=function(t){return lw((s=(e=t).s,{h:e.h,s:(s*=((r=e.l)<50?r:100-r)/100)>0?2*s/(r+s)*100:0,v:r+s,a:e.a}));var e,s,r},$i=function(t){return{h:(e=aw(t)).h,s:(n=(200-(s=e.s))*(r=e.v)/100)>0&&n<200?s*r/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,s,r,n},iE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,oE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,aE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Eh={string:[[function(t){var e=nE.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?We(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?We(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=aE.exec(t)||lE.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:yg({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=iE.exec(t)||oE.exec(t);if(!e)return null;var s,r,n=xg({h:(s=e[1],r=e[2],r===void 0&&(r="deg"),Number(s)*(rE[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return wg(n)},"hsl"]],object:[[function(t){var e=t.r,s=t.g,r=t.b,n=t.a,i=n===void 0?1:n;return ks(e)&&ks(s)&&ks(r)?yg({r:Number(e),g:Number(s),b:Number(r),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,s=t.s,r=t.l,n=t.a,i=n===void 0?1:n;if(!ks(e)||!ks(s)||!ks(r))return null;var o=xg({h:Number(e),s:Number(s),l:Number(r),a:Number(i)});return wg(o)},"hsl"],[function(t){var e=t.h,s=t.s,r=t.v,n=t.a,i=n===void 0?1:n;if(!ks(e)||!ks(s)||!ks(r))return null;var o=(function(a){return{h:ow(a.h),s:Ut(a.s,0,100),v:Ut(a.v,0,100),a:Ut(a.a)}})({h:Number(e),s:Number(s),v:Number(r),a:Number(i)});return lw(o)},"hsv"]]},Vg=function(t,e){for(var s=0;s<e.length;s++){var r=e[s][0](t);if(r)return[r,e[s][1]]}return[null,void 0]},cE=function(t){return typeof t=="string"?Vg(t.trim(),Eh.string):typeof t=="object"&&t!==null?Vg(t,Eh.object):[null,void 0]},Jc=function(t,e){var s=$i(t);return{h:s.h,s:Ut(s.s+100*e,0,100),l:s.l,a:s.a}},Zc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},qg=function(t,e){var s=$i(t);return{h:s.h,s:s.s,l:Ut(s.l+100*e,0,100),a:s.a}},Th=(function(){function t(e){this.parsed=cE(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return We(Zc(this.rgba),2)},t.prototype.isDark=function(){return Zc(this.rgba)<.5},t.prototype.isLight=function(){return Zc(this.rgba)>=.5},t.prototype.toHex=function(){return e=Xc(this.rgba),s=e.r,r=e.g,n=e.b,o=(i=e.a)<1?Aa(We(255*i)):"","#"+Aa(s)+Aa(r)+Aa(n)+o;var e,s,r,n,i,o},t.prototype.toRgb=function(){return Xc(this.rgba)},t.prototype.toRgbString=function(){return e=Xc(this.rgba),s=e.r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+s+", "+r+", "+n+", "+i+")":"rgb("+s+", "+r+", "+n+")";var e,s,r,n,i},t.prototype.toHsl=function(){return bg($i(this.rgba))},t.prototype.toHslString=function(){return e=bg($i(this.rgba)),s=e.h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+s+", "+r+"%, "+n+"%, "+i+")":"hsl("+s+", "+r+"%, "+n+"%)";var e,s,r,n,i},t.prototype.toHsv=function(){return e=aw(this.rgba),{h:We(e.h),s:We(e.s),v:We(e.v),a:We(e.a,3)};var e},t.prototype.invert=function(){return ds({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),ds(Jc(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),ds(Jc(this.rgba,-e))},t.prototype.grayscale=function(){return ds(Jc(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),ds(qg(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),ds(qg(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?ds({r:(s=this.rgba).r,g:s.g,b:s.b,a:e}):We(this.rgba.a,3);var s},t.prototype.hue=function(e){var s=$i(this.rgba);return typeof e=="number"?ds({h:e,s:s.s,l:s.l,a:s.a}):We(s.h)},t.prototype.isEqual=function(e){return this.toHex()===ds(e).toHex()},t})(),ds=function(t){return t instanceof Th?t:new Th(t)},vg=[],uE=function(t){t.forEach(function(e){vg.indexOf(e)<0&&(e(Th,Eh),vg.push(e))})};function hE(t,e){var s={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var n in s)r[s[n]]=n;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=r[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,d="black";if(!i.length)for(var f in s)i[f]=new t(s[f]).toRgb();for(var m in s){var A=(a=u,l=i[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<h&&(h=A,d=m)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":s[a];return l?new t(l).toRgb():null},"name"])}uE([hE]);const Mn=class Ti{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Ti)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,s){const r=typeof e;if(r!==typeof s)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===s;if(Array.isArray(e)&&Array.isArray(s)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(s))return e.length!==s.length?!1:e.every((i,o)=>i===s[o]);if(e!==null&&s!==null){const i=Object.keys(e),o=Object.keys(s);return i.length!==o.length?!1:i.every(a=>e[a]===s[a])}return e===s}toRgba(){const[e,s,r,n]=this._components;return{r:e,g:s,b:r,a:n}}toRgb(){const[e,s,r]=this._components;return{r:e,g:s,b:r}}toRgbaString(){const[e,s,r]=this.toUint8RgbArray();return`rgba(${e},${s},${r},${this.alpha})`}toUint8RgbArray(e){const[s,r,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(s*255),e[1]=Math.round(r*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[s,r,n,i]=this._components;return e[0]=s,e[1]=r,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[s,r,n]=this._components;return e[0]=s,e[1]=r,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,s,r]=this.toUint8RgbArray();return(r<<16)+(s<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[s,r,n,i]=Ti._temp.setValue(e)._components;return this._components[0]*=s,this._components[1]*=r,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,s=!0){return s&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,s=!0){if(e===1)return(255<<24)+this._int;if(e===0)return s?0:this._int;let r=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return s&&(r=r*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(r<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const s=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-s.length)+s}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let s,r,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;s=(o>>16&255)/255,r=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[s,r,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[s,r,n,i=255]=e,s/=255,r/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Ti.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=ds(e);o.isValid()&&({r:s,g:r,b:n,a:i}=o.rgba,s/=255,r/=255,n/=255)}if(s!==void 0)this._components[0]=s,this._components[1]=r,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,s,r]=this._components;this._int=(e*255<<16)+(s*255<<8)+(r*255|0)}_clamp(e,s=0,r=1){return typeof e=="number"?Math.min(Math.max(e,s),r):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,s),r)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Ti||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Mn.shared=new Mn;Mn._temp=new Mn;Mn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ct=Mn;const dE={cullArea:null,cullable:!1,cullableChildren:!0};let eu=0;const _g=500;function _e(...t){eu!==_g&&(eu++,eu===_g?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}const Hl={_registeredResources:new Set,register(t){this._registeredResources.add(t)},unregister(t){this._registeredResources.delete(t)},release(){this._registeredResources.forEach(t=>t.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(t){return this._registeredResources.has(t)},reset(){this._registeredResources.clear()}};class fE{constructor(e,s){this._pool=[],this._count=0,this._index=0,this._classType=e,s&&this.prepopulate(s)}prepopulate(e){for(let s=0;s<e;s++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let s;return this._index>0?s=this._pool[--this._index]:(s=new this._classType,this._count++),s.init?.(e),s}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class pE{constructor(){this._poolsByClass=new Map}prepopulate(e,s){this.getPool(e).prepopulate(s)}get(e,s){return this.getPool(e).get(s)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new fE(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(s=>{const r=e[s._classType.name]?s._classType.name+s._classType.ID:s._classType.name;e[r]={free:s.totalFree,used:s.totalUsed,size:s.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const Ht=new pE;Hl.register(Ht);const mE={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){ve("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function gE(t,e,s){const r=t.length;let n;if(e>=r||s===0)return;s=e+s>r?r-e:s;const i=r-s;for(n=e;n<i;++n)t[n]=t[n+s];t.length=i}const AE={allowChildren:!0,removeChildren(t=0,e){const s=e??this.children.length,r=s-t,n=[];if(r>0&&r<=s){for(let o=s-1;o>=t;o--){const a=this.children[o];a&&(n.push(a),a.parent=null)}gE(this.children,t,s);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let o=0;o<n.length;++o){const a=n[o];a.parentRenderLayer?.detach(a),this.emit("childRemoved",a,this,o),n[o].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(r===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||ve(at,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:s}=this;if(e<0||e>s.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${s.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===s.length?s.push(t):s.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const s=this.getChildIndex(t),r=this.getChildIndex(e);this.children[s]=e,this.children[r]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const s=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const r=this.worldTransform.clone();return r.invert(),s.prepend(r),t.setFromMatrix(s),t},replaceChild(t,e){t.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(t)),e.setFromMatrix(t.localTransform),e.updateLocalTransform(),this.removeChild(t)}},yE={collectRenderables(t,e,s){this.parentRenderLayer&&this.parentRenderLayer!==s||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,s):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,s))},collectRenderablesSimple(t,e,s){const r=this.children,n=r.length;for(let i=0;i<n;i++)r[i].collectRenderables(t,e,s)},collectRenderablesWithEffects(t,e,s){const{renderPipes:r}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];r[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,s);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];r[i.pipe].pop(i,this,t)}}};class Sg{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class xE{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let s=0;s<this._tests.length;s++){const r=this._tests[s];if(r.test(e))return Ht.get(r.maskClass,e)}return e}returnMaskEffect(e){Ht.return(e)}}const Mh=new xE;_t.handleByList(G.MaskEffect,Mh._effectClasses);const bE={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((s,r)=>s.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),Mh.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=Mh.getMaskEffect(t),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Sg);t=t;const s=t?.length>0,r=e.filters?.length>0,n=s!==r;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(s?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Sg),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},wE={label:null,get name(){return ve(at,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){ve(at,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const s=this.children;for(let r=0;r<s.length;r++){const n=s[r];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let r=0;r<s.length;r++){const i=s[r].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,s=[]){const r=this.children;for(let n=0;n<r.length;n++){const i=r[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&s.push(i)}if(e)for(let n=0;n<r.length;n++)r[n].getChildrenByLabel(t,!0,s);return s}},dt=Ht.getPool(le),js=Ht.getPool(ss),VE=new le,qE={getFastGlobalBounds(t,e){e||(e=new ss),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const s=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(s.worldTransform),e},_getGlobalBoundsRecursive(t,e,s){let r=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==s||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(r=js.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,r,s)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,r.applyMatrix(o.worldTransform)),this.effects[a].addBounds(r,!0));i&&r.applyMatrix(o.worldTransform.copyTo(VE).invert()),e.addBounds(r),js.return(r)}else this.renderGroup&&(e.addBounds(r,this.relativeGroupTransform),js.return(r))}};function cw(t,e,s){s.clear();let r,n;return t.parent?e?r=t.parent.worldTransform:(n=dt.get().identity(),r=hf(t,n)):r=le.IDENTITY,uw(t,s,r,e),n&&dt.return(n),s.isValid||s.set(0,0,0,0),s}function uw(t,e,s,r){if(!t.visible||!t.measurable)return;let n;r?n=t.worldTransform:(t.updateLocalTransform(),n=dt.get(),n.appendFrom(t.localTransform,s));const i=e,o=!!t.effects.length;if(o&&(e=js.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{const a=t.bounds;a&&!a.isEmpty()&&(e.matrix=n,e.addBounds(a));for(let l=0;l<t.children.length;l++)uw(t.children[l],e,n,r)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,le.IDENTITY),js.return(e)}r||dt.return(n)}function hf(t,e){const s=t.parent;return s&&(hf(s,e),s.updateLocalTransform(),e.append(s.localTransform)),e}function hw(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const s=t>>16&255,r=t>>8&255,n=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=s*i/255|0,c=r*o/255|0,u=n*a/255|0;return(l<<16)+(c<<8)+u}const kg=16777215;function Cg(t,e){return t===kg?e:e===kg?t:hw(t,e)}function La(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const vE={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,s=this.parent;for(;s;)e*=s.alpha,s=s.parent;return e},getGlobalTransform(t=new le,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const s=hf(this,dt.get().identity());return t.appendFrom(this.localTransform,s),dt.return(s),t},getGlobalTint(t){if(t)return this.renderGroup?La(this.renderGroup.worldColor):this.parentRenderGroup?La(Cg(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,s=this.parent;for(;s;)e=Cg(e,s.localColor),s=s.parent;return La(e)}};function dw(t,e,s){return e.clear(),s||(s=le.IDENTITY),fw(t,e,s,t,!0),e.isValid||e.set(0,0,0,0),e}function fw(t,e,s,r,n){let i;if(n)i=dt.get(),i=s.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=dt.get(),i.appendFrom(l,s)}const o=e,a=!!t.effects.length;if(a&&(e=js.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)fw(l[c],e,i,r,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,r);o.addBounds(e,le.IDENTITY),js.return(e)}dt.return(i)}function pw(t,e){const s=t.children;for(let r=0;r<s.length;r++){const n=s[r],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,n.children.length&&pw(n,e)}return e.didChange}const _E=new le,SE={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const s=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*s:this.scale.x=s},_setHeight(t,e){const s=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*s:this.scale.y=s},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new ss});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),pw(this,t),t.didChange&&dw(this,t.localBounds,_E),t.localBounds},getBounds(t,e){return cw(this,t,e||new ss)}},kE={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},CE={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(PE))}};function PE(t,e){return t._zIndex-e._zIndex}const EE={getGlobalPosition(t=new lt,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,s=!1){const r=this.getGlobalTransform(dt.get(),s);return e=r.apply(t,e),dt.return(r),e},toLocal(t,e,s,r){e&&(t=e.toGlobal(t,s,r));const n=this.getGlobalTransform(dt.get(),r);return s=n.applyInverse(t,s),dt.return(n),s}};class mw{constructor(){this.uid=ze("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let TE=0;class ME{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new fl(this.textureOptions)}createTexture(e,s,r){const n=new os({...this.textureOptions,width:e,height:s,resolution:1,antialias:r,autoGarbageCollect:!1});return new ce({source:n,label:`texturePool_${TE++}`})}getOptimalTexture(e,s,r=1,n){let i=Math.ceil(e*r-1e-6),o=Math.ceil(s*r-1e-6);i=dl(i),o=dl(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,n)),l.source._resolution=r,l.source.width=i/r,l.source.height=o/r,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=s,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,s=!1){const r=e.source;return this.getOptimalTexture(e.width,e.height,r._resolution,s)}returnTexture(e,s=!1){const r=this._poolKeyHash[e.uid];s&&(e.source.style=this.textureStyle),this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const s in this._texturePool){const r=this._texturePool[s];if(r)for(let n=0;n<r.length;n++)r[n].destroy(!0)}this._texturePool={}}}const gw=new ME;Hl.register(gw);class RE{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new le,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new mw,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const s=e.children;for(let r=0;r<s.length;r++){const n=s[r];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(gw.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const s=this.childrenToUpdate[e];s.list.fill(null),s.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const s=this.renderGroupChildren.indexOf(e);s>-1&&this.renderGroupChildren.splice(s,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const s=e.children;for(let r=0;r<s.length;r++)this.addChild(s[r])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const s=e.children;for(let r=0;r<s.length;r++)this.removeChild(s[r])}removeChildren(e){for(let s=0;s<e.length;s++)this.removeChild(e[s])}onChildUpdate(e){let s=this.childrenToUpdate[e.relativeRenderGroupDepth];s||(s=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),s.list[s.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let s=0;s<this._onRenderContainers.length;s++)this._onRenderContainers[s]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const s=this.root.children;for(let r=0;r<s.length;r++)this._getChildren(s[r],e);return e}_getChildren(e,s=[]){if(s.push(e),e.renderGroup)return s;const r=e.children;for(let n=0;n<r.length;n++)this._getChildren(r[n],s);return s}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new le),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new le),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new le),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function IE(t,e,s={}){for(const r in e)!s[r]&&e[r]!==void 0&&(t[r]=e[r])}const tu=new nt(null),ya=new nt(null),su=new nt(null,1,1),xa=new nt(null),Pg=1,jE=2,ru=4;class jo extends bs{constructor(e={}){super(),this.uid=ze("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new le,this.relativeGroupTransform=new le,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new nt(this,0,0),this._scale=su,this._pivot=ya,this._origin=xa,this._skew=tu,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],IE(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(s=>this.addChild(s)),e.parent?.addChild(this)}static mixin(e){ve("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),_t.mixin(jo,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||ve(at,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const s=e[0],r=this.renderGroup||this.parentRenderGroup;return s.parent===this?(this.children.splice(this.children.indexOf(s),1),this.children.push(s),r&&(r.structureDidChange=!0),s):(s.parent&&s.parent.removeChild(s),this.children.push(s),this.sortableChildren&&(this.sortDirty=!0),s.parent=this,s.didChange=!0,s._updateFlags=15,r&&r.addChild(s),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this),this._didViewChangeTick++,s._zIndex!==0&&s.depthOfChildModified(),s)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const s=e[0],r=this.children.indexOf(s);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(s):this.parentRenderGroup&&this.parentRenderGroup.removeChild(s),s.parentRenderLayer&&s.parentRenderLayer.detach(s),s.parent=null,this.emit("childRemoved",s,this,r),s.emit("removed",this)),s}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Ht.get(RE,this),this.groupTransform=le.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Ht.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new le),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*YP}set angle(e){this.rotation=e*KP}get pivot(){return this._pivot===ya&&(this._pivot=new nt(this,0,0)),this._pivot}set pivot(e){this._pivot===ya&&(this._pivot=new nt(this,0,0),this._origin!==xa&&_e("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===tu&&(this._skew=new nt(this,0,0)),this._skew}set skew(e){this._skew===tu&&(this._skew=new nt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===su&&(this._scale=new nt(this,1,1)),this._scale}set scale(e){this._scale===su&&(this._scale=new nt(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===xa&&(this._origin=new nt(this,0,0)),this._origin}set origin(e){this._origin===xa&&(this._origin=new nt(this,0,0),this._pivot!==ya&&_e("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const s=this.getLocalBounds().width;this._setWidth(e,s)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const s=this.getLocalBounds().height;this._setHeight(e,s)}getSize(e){e||(e={});const s=this.getLocalBounds();return e.width=Math.abs(this.scale.x*s.width),e.height=Math.abs(this.scale.y*s.height),e}setSize(e,s){const r=this.getLocalBounds();typeof e=="object"?(s=e.height??e.width,e=e.width):s??(s=e),e!==void 0&&this._setWidth(e,r.width),s!==void 0&&this._setHeight(s,r.height)}_updateSkew(){const e=this._rotation,s=this._skew;this._cx=Math.cos(e+s._y),this._sx=Math.sin(e+s._y),this._cy=-Math.sin(e-s._x),this._sy=Math.cos(e-s._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const s=this.localTransform,r=this._scale,n=this._pivot,i=this._origin,o=this._position,a=r._x,l=r._y,c=n._x,u=n._y,h=-i._x,d=-i._y;s.a=this._cx*a,s.b=this._sx*a,s.c=this._cy*l,s.d=this._sy*l,s.tx=o._x-(c*s.a+u*s.c)+(h*s.a+d*s.c)-h,s.ty=o._y-(c*s.b+u*s.d)+(h*s.b+d*s.d)-d}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Pg,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const r=ct.shared.setValue(e??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=Pg,this._onUpdate())}get tint(){return La(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=jE,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const s=e?2:0;(this.localDisplayStatus&2)!==s&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ru,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const s=e?0:4;(this.localDisplayStatus&4)!==s&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ru,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const s=e?1:0;(this.localDisplayStatus&1)!==s&&(this._updateFlags|=ru,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let s;if(this.children.length&&(s=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&s)for(let n=0;n<s.length;++n)s[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}_t.mixin(jo,AE,qE,EE,kE,SE,bE,wE,CE,dE,mE,vE,yE);class OE extends jo{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new ss(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const s=this.bounds,{x:r,y:n}=e;return r>=s.minX&&r<=s.maxX&&n>=s.minY&&n<=s.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null;for(const s in this._gpuData)this._gpuData[s].destroy?.();this._gpuData=null}collectRenderablesSimple(e,s,r){const{renderPipes:n}=s;n.blendMode.pushBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let l=0;l<a;l++)o[l].collectRenderables(e,s,r);n.blendMode.popBlendMode(e)}}class uo extends OE{constructor(e=ce.EMPTY){e instanceof ce&&(e={texture:e});const{texture:s=ce.EMPTY,anchor:r,roundPixels:n,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new nt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:s.defaultAnchor&&(this.anchor=s.defaultAnchor),this.texture=s,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,s=!1){return e instanceof ce?new uo(e):new uo(ce.from(e,s))}set texture(e){e||(e=ce.EMPTY);const s=this._texture;s!==e&&(s&&s.dynamic&&s.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return sE(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return ve("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,s=this._texture,r=this._bounds,{width:n,height:i}=s.orig;r.minX=-e._x*n,r.maxX=r.minX+n,r.minY=-e._y*i,r.maxY=r.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,s){typeof e=="object"?(s=e.height??e.width,e=e.width):s??(s=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),s!==void 0&&this._setHeight(s,this._texture.orig.height)}}const BE=new ss;function Aw(t,e,s){const r=BE;t.measurable=!0,cw(t,s,r),e.addBoundsMask(r),t.measurable=!1}function yw(t,e,s){const r=js.get();t.measurable=!0;const n=dt.get().identity(),i=xw(t,s,n);dw(t,r,i),t.measurable=!1,e.addBoundsMask(r),dt.return(n),js.return(r)}function xw(t,e,s){return t?(t!==e&&(xw(t.parent,e,s),t.updateLocalTransform(),s.append(t.localTransform)),s):(_e("Mask bounds, renderable is not inside the root container"),s)}class bw{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof uo),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,s){this.inverse||Aw(this.mask,e,s)}addLocalBounds(e,s){yw(this.mask,e,s)}containsPoint(e,s){const r=this.mask;return s(r,e)}destroy(){this.reset()}static test(e){return e instanceof uo}}bw.extension=G.MaskEffect;class ww{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}ww.extension=G.MaskEffect;class Vw{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,s){Aw(this.mask,e,s)}addLocalBounds(e,s){yw(this.mask,e,s)}containsPoint(e,s){const r=this.mask;return s(r,e)}destroy(){this.reset()}static test(e){return e instanceof jo}}Vw.extension=G.MaskEffect;const NE={createCanvas:(t,e)=>{const s=document.createElement("canvas");return s.width=t,s.height=e,s},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let Eg=NE;const Ie={get(){return Eg},set(t){Eg=t}};class qw extends os{constructor(e){e.resource||(e.resource=Ie.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,s=this.height,r=this._resolution){const n=super.resize(e,s,r);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}qw.extension=G.TextureSource;class zr extends os{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}zr.extension=G.TextureSource;var pl=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(pl||{});class nu{constructor(e,s=null,r=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=s,this.priority=r,this._once=n}match(e,s=null){return this._fn===e&&this._context===s}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const s=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),s}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=e?null:s,this.previous=null,s}}const vw=class Et{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new nu(null,null,1/0),this.deltaMS=1/Et.targetFPMS,this.elapsedMS=1/Et.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,s,r=pl.NORMAL){return this._addListener(new nu(e,s,r))}addOnce(e,s,r=pl.NORMAL){return this._addListener(new nu(e,s,r,!0))}_addListener(e){let s=this._head.next,r=this._head;if(!s)e.connect(r);else{for(;s;){if(e.priority>s.priority){e.connect(r);break}r=s,s=s.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,s){let r=this._head.next;for(;r;)r.match(e,s)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,s=this._head;for(;s=s.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let s;if(e>this.lastTime){if(s=this.elapsedMS=e-this.lastTime,s>this._maxElapsedMS&&(s=this._maxElapsedMS),s*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=s,this.deltaTime=this.deltaMS*Et.targetFPMS;const r=this._head;let n=r.next;for(;n;)n=n.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const s=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,s)/1e3,Et.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const s=Math.max(this.minFPS,e);this._minElapsedMS=1/(s/1e3)}}static get shared(){if(!Et._shared){const e=Et._shared=new Et;e.autoStart=!0,e._protected=!0}return Et._shared}static get system(){if(!Et._system){const e=Et._system=new Et;e.autoStart=!0,e._protected=!0}return Et._system}};vw.targetFPMS=.06;let ft=vw,iu;async function _w(){return iu??(iu=(async()=>{const e=Ie.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const s=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!s)return"premultiply-alpha-on-upload";const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),iu}const Wl=class Sw extends os{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Sw.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=ft.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,s=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(s.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await _w(),this._load=new Promise((r,n)=>{this.isValid?r(this):(this._resolve=r,this._reject=n,s.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${s.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(ft.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ft.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ft.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Wl.extension=G.TextureSource;Wl.defaultOptions={...os.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Wl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Hi=Wl;const Jt=(t,e,s=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"||s?e(r):r):t);class zE{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const s=this._cache.get(e);return s||_e(`[Assets] Asset id ${e} was not found in the Cache`),s}set(e,s){const r=Jt(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(s)){n=c.getCacheableAssets(r,s);break}}const i=new Map(Object.entries(n||{}));n||r.forEach(l=>{i.set(l,s)});const o=[...i.keys()],a={cacheKeys:o,keys:r};r.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=n?n[l]:s;this._cache.has(l)&&this._cache.get(l)!==c&&_e("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){_e(`[Assets] Asset id ${e} was not found in the Cache`);return}const s=this._cacheMap.get(e);s.cacheKeys.forEach(n=>{this._cache.delete(n)}),s.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const qe=new zE,Rh=[];_t.handleByList(G.TextureSource,Rh);function kw(t={}){const e=t&&t.resource,s=e?t.resource:t,r=e?t:{resource:t};for(let n=0;n<Rh.length;n++){const i=Rh[n];if(i.test(s))return new i(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function DE(t={},e=!1){const s=t&&t.resource,r=s?t.resource:t,n=s?t:{resource:t};if(!e&&qe.has(r))return qe.get(r);const i=new ce({source:kw(n)});return i.on("destroy",()=>{qe.has(r)&&qe.remove(r)}),e||qe.set(r,i),i}function FE(t,e=!1){return typeof t=="string"?qe.get(t):t instanceof os?new ce({source:t}):DE(t,e)}ce.from=FE;os.from=kw;_t.add(bw,ww,Vw,Hi,zr,qw,uf);var ar=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(ar||{});function Kt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Ai(t){return t.split("?")[0].split("#")[0]}function LE(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function UE(t,e,s){return t.replace(new RegExp(LE(e),"g"),s)}function $E(t,e){let s="",r=0,n=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){const l=s.lastIndexOf("/");if(l!==s.length-1){l===-1?(s="",r=0):(s=s.slice(0,l),r=s.length-1-s.lastIndexOf("/")),n=a,i=0;continue}}else if(s.length===2||s.length===1){s="",r=0,n=a,i=0;continue}}}else s.length>0?s+=`/${t.slice(n+1,a)}`:s=t.slice(n+1,a),r=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return s}const Ot={toPosix(t){return UE(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Kt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const s=/^[^/:]+:\/{0,2}/.exec(t);return s?s[0]:""},toAbsolute(t,e,s){if(Kt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=Ai(this.toPosix(e??Ie.get().getBaseUrl())),n=Ai(this.toPosix(s??this.rootname(r)));return t=this.toPosix(t),t.startsWith("/")?Ot.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(Kt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const s=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=$E(t),t.length>0&&r&&(t+="/"),s?`/${t}`:e+t},isAbsolute(t){return Kt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let s=0;s<t.length;++s){const r=t[s];if(Kt(r),r.length>0)if(e===void 0)e=r;else{const n=t[s-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Kt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const s=e===47;let r=-1,n=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){r=a;break}}else n=!1;return r===-1?s?"/":this.isUrl(o)?i+t:i:s&&r===1?"//":i+t.slice(0,r)},rootname(t){Kt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const s=t.indexOf("/",e.length);s!==-1?e=t.slice(0,s):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Kt(t),e&&Kt(e),t=Ai(this.toPosix(t));let s=0,r=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){s=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(r=i):(o=-1,r=a))}return s===r?r=a:r===-1&&(r=t.length),t.slice(s,r)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){s=i+1;break}}else r===-1&&(n=!1,r=i+1);return r===-1?"":t.slice(s,r)},extname(t){Kt(t),t=Ai(this.toPosix(t));let e=-1,s=0,r=-1,n=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!n){s=o+1;break}continue}r===-1&&(n=!1,r=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||r===-1||i===0||i===1&&e===r-1&&e===s+1?"":t.slice(e,r)},parse(t){Kt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Ai(this.toPosix(t));let s=t.charCodeAt(0);const r=this.isAbsolute(t);let n;e.root=this.rootname(t),r||this.hasProtocol(t)?n=1:n=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(s=t.charCodeAt(c),s===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),s===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&r?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&r?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Cw(t,e,s,r,n){const i=e[s];for(let o=0;o<i.length;o++){const a=i[o];s<e.length-1?Cw(t.replace(r[s],a),e,s+1,r,n):n.push(t.replace(r[s],a))}}function HE(t){const e=/\{(.*?)\}/g,s=t.match(e),r=[];if(s){const n=[];s.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),Cw(t,n,0,s,r)}else r.push(t);return r}const ml=t=>!Array.isArray(t);class Jn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,s)=>`${e}${this._bundleIdConnector}${s}`,extractAssetIdFromBundle:(e,s)=>s.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(s=>{this._preferredOrder.push(s),s.priority||(s.priority=Object.keys(s.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const s=e;this._defaultSearchParams=Object.keys(s).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(s[r])}`).join("&")}}getAlias(e){const{alias:s,src:r}=e;return Jt(s||r,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&_e("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(s=>{this.addBundle(s.name,s.assets)})}addBundle(e,s){const r=[];let n=s;Array.isArray(s)||(n=Object.entries(s).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);r.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));r.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=r}add(e){const s=[];Array.isArray(e)?s.push(...e):s.push(e);let r;r=i=>{this.hasKey(i)&&_e(`[Resolver] already has key: ${i} overwriting`)},Jt(s).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c,parser:u}=i;const h=Jt(o).map(A=>typeof A=="string"?HE(A):Array.isArray(A)?A:[A]),d=this.getAlias(i);Array.isArray(d)?d.forEach(r):r(d);const f=[],m=A=>({...this._parsers.find(y=>y.test(A))?.parse(A),src:A});h.forEach(A=>{A.forEach(g=>{let y={};if(typeof g!="object"?y=m(g):(a=g.data??a,l=g.format??l,(g.loadParser||g.parser)&&(c=g.loadParser??c,u=g.parser??u),y={...m(g.src),...g}),!d)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:d,data:a,format:l,loadParser:c,parser:u,progressSize:i.progressSize}),f.push(y)})}),d.forEach(A=>{this._assetMap[A]=f})})}resolveBundle(e){const s=ml(e);e=Jt(e);const r={};return e.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(n,l)]=c}r[n]=a}}),s?r[e[0]]:r}resolveUrl(e){const s=this.resolve(e);if(typeof e!="string"){const r={};for(const n in s)r[n]=s[n].src;return r}return s.src}resolve(e){const s=ml(e);e=Jt(e);const r={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});r[n]=this._resolverHash[n]}),s?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let s=0;s<e.length;s++){const r=e[s],n=this._preferredOrder.find(i=>i.params.format.includes(r.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const s=/\?/.test(e)?"&":"?";return`${e}${s}${this._defaultSearchParams}`}_buildResolvedAsset(e,s){const{aliases:r,data:n,loadParser:i,parser:o,format:a,progressSize:l}=s;return(this._basePath||this._rootPath)&&(e.src=Ot.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.parser=o??e.parser,e.format=a??e.format??WE(e.src),l!==void 0&&(e.progressSize=l),e}}Jn.RETINA_PREFIX=/@([0-9\.]+)x/;function WE(t){return t.split(".").pop().split("?").shift().split("#").shift()}const Ih=(t,e)=>{const s=e.split("?")[1];return s&&(t+=`?${s}`),t},Pw=class Mi{constructor(e,s){this.linkedSheets=[];let r=e;e?.source instanceof os&&(r={texture:e,data:s});const{texture:n,data:i,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=n instanceof ce?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Mi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let s=e;const r=Mi.BATCH_SIZE;for(;s-e<r&&s<this._frameKeys.length;){const n=this._frameKeys[s],i=this._frames[n],o=i.frame;if(o){let a=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Ne(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?a=new Ne(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Ne(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Ne(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new ce({source:this.textureSource,frame:a,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}s++}}_processAnimations(){const e=this.data.animations||{};for(const s in e){this.animations[s]=[];for(let r=0;r<e[s].length;r++){const n=e[s][r];this.animations[s].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Mi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Mi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Pw.BATCH_SIZE=1e3;let jh=Pw;const GE=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Ew(t,e,s){const r={};if(t.forEach(n=>{r[n]=e}),Object.keys(e.textures).forEach(n=>{r[`${e.cachePrefix}${n}`]=e.textures[n]}),!s){const n=Ot.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=Ew([`${n}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(r,a)})}return r}const YE={extension:G.Asset,cache:{test:t=>t instanceof jh,getCacheableAssets:(t,e)=>Ew(t,e,!1)},resolver:{extension:{type:G.ResolveParser,name:"resolveSpritesheet"},test:t=>{const s=t.split("?")[0].split("."),r=s.pop(),n=s.pop();return r==="json"&&GE.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Jn.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:G.LoadParser,priority:ar.Normal,name:"spritesheetLoader"},async testParse(t,e){return Ot.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,s){const{texture:r,imageFilename:n,textureOptions:i,cachePrefix:o}=e?.data??{};let a=Ot.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(r instanceof ce)l=r;else{const h=Ih(a+(n??t.meta.image),e.src);l=(await s.load([{src:h,data:i}]))[h]}const c=new jh({texture:l.source,data:t,cachePrefix:o});await c.parse();const u=t?.meta?.related_multi_packs;if(Array.isArray(u)){const h=[];for(const f of u){if(typeof f!="string")continue;let m=a+f;e.data?.ignoreMultiPack||(m=Ih(m,e.src),h.push(s.load({src:m,data:{textureOptions:i,ignoreMultiPack:!0}})))}const d=await Promise.all(h);c.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[c].concat(c.linkedSheets.filter(m=>m!==f))})}return c},async unload(t,e,s){await s.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};_t.add(YE);const ou=Object.create(null),Tg=Object.create(null);function df(t,e){let s=Tg[t];return s===void 0&&(ou[e]===void 0&&(ou[e]=1),Tg[t]=s=ou[e]++),s}let ba;function Tw(){return(!ba||ba?.isContextLost())&&(ba=Ie.get().createCanvas().getContext("webgl",{})),ba}let wa;function KE(){if(!wa){wa="mediump";const t=Tw();t&&t.getShaderPrecisionFormat&&(wa=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return wa}function QE(t,e,s){return e?t:s?(t=t.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function XE(t,e,s){const r=s?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=s?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&r!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(r!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function JE(t,e){return e?`#version 300 es
${t}`:t}const ZE={},eT={};function tT(t,{name:e="pixi-program"},s=!0){e=e.replace(/\s+/g,"-"),e+=s?"-fragment":"-vertex";const r=s?ZE:eT;return r[e]?(r[e]++,e+=`-${r[e]}`):r[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function sT(t,e){return e?t.replace("#version 300 es",""):t}const au={stripVersion:sT,ensurePrecision:XE,addProgramDefines:QE,setProgramName:tT,insertVersion:JE},yi=Object.create(null),Mw=class Oh{constructor(e){e={...Oh.defaultOptions,...e};const s=e.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:s,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:KE()},setProgramName:{name:e.name},addProgramDefines:s,insertVersion:s};let n=e.fragment,i=e.vertex;Object.keys(au).forEach(o=>{const a=r[o];n=au[o](n,a,!0),i=au[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=df(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,yi[this._cacheKey]=null}static from(e){const s=`${e.vertex}:${e.fragment}`;return yi[s]||(yi[s]=new Oh(e),yi[s]._cacheKey=s),yi[s]}};Mw.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Rw=Mw;const Mg={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function rT(t){return Mg[t]??Mg.float32}const nT={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function iT({source:t,entryPoint:e}){const s={},r=t.indexOf(`fn ${e}`);if(r!==-1){const n=t.indexOf("->",r);if(n!==-1){const i=t.substring(r,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=nT[a[3]]??"float32";s[a[2]]={location:parseInt(a[1],10),format:l,stride:rT(l).stride,offset:0,instance:!1,start:0}}}}return s}function lu(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,s=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(s)[1],10),binding:parseInt(h.match(r)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((m,A)=>{const[g,y]=A.split(":");return m[g.trim()]=y.trim(),m},{});return f?{name:d,members:f}:null}).filter(({name:h})=>c.some(d=>d.type===h))??[];return{groups:c,structs:u}}var Ri=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Ri||{});function oT({groups:t}){const e=[];for(let s=0;s<t.length;s++){const r=t[s];e[r.group]||(e[r.group]=[]),r.isUniform?e[r.group].push({binding:r.binding,visibility:Ri.VERTEX|Ri.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?e[r.group].push({binding:r.binding,visibility:Ri.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&e[r.group].push({binding:r.binding,visibility:Ri.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function aT({groups:t}){const e=[];for(let s=0;s<t.length;s++){const r=t[s];e[r.group]||(e[r.group]={}),e[r.group][r.name]=r.binding}return e}function lT(t,e){const s=new Set,r=new Set,n=[...t.structs,...e.structs].filter(o=>s.has(o.name)?!1:(s.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:n,groups:i}}const xi=Object.create(null);class Gl{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:s,vertex:r,layout:n,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=s,this.vertex=r,s.source===r.source){const a=lu(s.source);this.structsAndGroups=a}else{const a=lu(r.source),l=lu(s.source);this.structsAndGroups=lT(a,l)}this.layout=n??aT(this.structsAndGroups),this.gpuLayout=i??oT(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:s}=this,r=e.source+s.source+e.entryPoint+s.entryPoint;this._layoutKey=df(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=iT(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,xi[this._cacheKey]=null}static from(e){const s=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return xi[s]||(xi[s]=new Gl(e),xi[s]._cacheKey=s),xi[s]}}const Iw=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],cT=Iw.reduce((t,e)=>(t[e]=!0,t),{});function uT(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const jw=class Ow{constructor(e,s){this._touched=0,this.uid=ze("uniform"),this._resourceType="uniformGroup",this._resourceId=ze("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,s={...Ow.defaultOptions,...s},this.uniformStructures=e;const r={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!cT[i.type]){const o=i.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,l]=o;throw new Error(`Uniform type ${i.type} is not supported. Use type: '${a}', size: ${l} instead.`)}throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${Iw.join(", ")}`)}i.value??(i.value=uT(i.type,i.size)),r[n]=i.value}this.uniforms=r,this._dirtyId=1,this.ubo=s.ubo,this.isStatic=s.isStatic,this._signature=df(Object.keys(r).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};jw.defaultOptions={ubo:!1,isStatic:!1};let Bw=jw;class Ua{constructor(e){this.resources=Object.create(null),this._dirty=!0;let s=0;for(const r in e){const n=e[r];this.setResource(n,s++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let s=0;for(const r in this.resources)e[s++]=this.resources[r]._resourceId;this._key=e.join("|")}setResource(e,s){const r=this.resources[s];e!==r&&(r&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[s]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const s=this.resources;for(const r in s)s[r]._touched=e}destroy(){const e=this.resources;for(const s in e)e[s]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const s=this.resources;for(const r in s)s[r]===e&&(s[r]=null)}else this._updateKey()}}var Bh=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(Bh||{});class ff extends bs{constructor(e){super(),this.uid=ze("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:s,glProgram:r,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=s,this.glProgram=r,o===void 0&&(o=0,s&&(o|=Bh.WEBGPU),r&&(o|=Bh.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!s&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!s&&n&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(s&&n&&!a){const c=s.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},a={},s&&s.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new Ua,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let d=i[u];!d.source&&!d._resourceType&&(d=new Bw(d));const f=l[h];f&&(n[f.group]||(n[f.group]=new Ua,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(d,f.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,l)}addResource(e,s,r){var n,i;(n=this._uniformBindMap)[s]||(n[s]={}),(i=this._uniformBindMap[s])[r]||(i[r]=e),this.groups[s]||(this.groups[s]=new Ua,this._ownedBindGroups.push(this.groups[s]))}_buildResourceAccessor(e,s){const r={};for(const n in s){const i=s[n];Object.defineProperty(r,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return r}destroy(e=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(s=>{s.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:s,gl:r,...n}=e;let i,o;return s&&(i=Gl.from(s)),r&&(o=Rw.from(r)),new ff({gpuProgram:i,glProgram:o,...n})}}function Rg(t,e,s=2){const r=e&&e.length,n=r?e[0]*s:t.length;let i=Nw(t,0,n,s,!0);const o=[];if(!i||i.next===i.prev)return o;let a,l,c;if(r&&(i=mT(t,e,i,s)),t.length>80*s){a=t[0],l=t[1];let u=a,h=l;for(let d=s;d<n;d+=s){const f=t[d],m=t[d+1];f<a&&(a=f),m<l&&(l=m),f>u&&(u=f),m>h&&(h=m)}c=Math.max(u-a,h-l),c=c!==0?32767/c:0}return ho(i,o,s,a,l,c,0),o}function Nw(t,e,s,r,n){let i;if(n===ST(t,e,s,r)>0)for(let o=e;o<s;o+=r)i=Ig(o/r|0,t[o],t[o+1],i);else for(let o=s-r;o>=e;o-=r)i=Ig(o/r|0,t[o],t[o+1],i);return i&&Rn(i,i.next)&&(po(i),i=i.next),i}function Dr(t,e){if(!t)return t;e||(e=t);let s=t,r;do if(r=!1,!s.steiner&&(Rn(s,s.next)||Pe(s.prev,s,s.next)===0)){if(po(s),s=e=s.prev,s===s.next)break;r=!0}else s=s.next;while(r||s!==e);return e}function ho(t,e,s,r,n,i,o){if(!t)return;!o&&i&&bT(t,r,n,i);let a=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(i?dT(t,r,n,i):hT(t)){e.push(l.i,t.i,c.i),po(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=fT(Dr(t),e),ho(t,e,s,r,n,i,2)):o===2&&pT(t,e,s,r,n,i):ho(Dr(t),e,s,r,n,i,1);break}}}function hT(t){const e=t.prev,s=t,r=t.next;if(Pe(e,s,r)>=0)return!1;const n=e.x,i=s.x,o=r.x,a=e.y,l=s.y,c=r.y,u=Math.min(n,i,o),h=Math.min(a,l,c),d=Math.max(n,i,o),f=Math.max(a,l,c);let m=r.next;for(;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=h&&m.y<=f&&Ii(n,a,i,l,o,c,m.x,m.y)&&Pe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function dT(t,e,s,r){const n=t.prev,i=t,o=t.next;if(Pe(n,i,o)>=0)return!1;const a=n.x,l=i.x,c=o.x,u=n.y,h=i.y,d=o.y,f=Math.min(a,l,c),m=Math.min(u,h,d),A=Math.max(a,l,c),g=Math.max(u,h,d),y=Nh(f,m,e,s,r),w=Nh(A,g,e,s,r);let x=t.prevZ,b=t.nextZ;for(;x&&x.z>=y&&b&&b.z<=w;){if(x.x>=f&&x.x<=A&&x.y>=m&&x.y<=g&&x!==n&&x!==o&&Ii(a,u,l,h,c,d,x.x,x.y)&&Pe(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=A&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&Ii(a,u,l,h,c,d,b.x,b.y)&&Pe(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=y;){if(x.x>=f&&x.x<=A&&x.y>=m&&x.y<=g&&x!==n&&x!==o&&Ii(a,u,l,h,c,d,x.x,x.y)&&Pe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=w;){if(b.x>=f&&b.x<=A&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&Ii(a,u,l,h,c,d,b.x,b.y)&&Pe(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function fT(t,e){let s=t;do{const r=s.prev,n=s.next.next;!Rn(r,n)&&Dw(r,s,s.next,n)&&fo(r,n)&&fo(n,r)&&(e.push(r.i,s.i,n.i),po(s),po(s.next),s=t=n),s=s.next}while(s!==t);return Dr(s)}function pT(t,e,s,r,n,i){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&qT(o,a)){let l=Fw(o,a);o=Dr(o,o.next),l=Dr(l,l.next),ho(o,e,s,r,n,i,0),ho(l,e,s,r,n,i,0);return}a=a.next}o=o.next}while(o!==t)}function mT(t,e,s,r){const n=[];for(let i=0,o=e.length;i<o;i++){const a=e[i]*r,l=i<o-1?e[i+1]*r:t.length,c=Nw(t,a,l,r,!1);c===c.next&&(c.steiner=!0),n.push(VT(c))}n.sort(gT);for(let i=0;i<n.length;i++)s=AT(n[i],s);return s}function gT(t,e){let s=t.x-e.x;if(s===0&&(s=t.y-e.y,s===0)){const r=(t.next.y-t.y)/(t.next.x-t.x),n=(e.next.y-e.y)/(e.next.x-e.x);s=r-n}return s}function AT(t,e){const s=yT(t,e);if(!s)return e;const r=Fw(s,t);return Dr(r,r.next),Dr(s,s.next)}function yT(t,e){let s=e;const r=t.x,n=t.y;let i=-1/0,o;if(Rn(t,s))return s;do{if(Rn(t,s.next))return s.next;if(n<=s.y&&n>=s.next.y&&s.next.y!==s.y){const h=s.x+(n-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(h<=r&&h>i&&(i=h,o=s.x<s.next.x?s:s.next,h===r))return o}s=s.next}while(s!==e);if(!o)return null;const a=o,l=o.x,c=o.y;let u=1/0;s=o;do{if(r>=s.x&&s.x>=l&&r!==s.x&&zw(n<c?r:i,n,l,c,n<c?i:r,n,s.x,s.y)){const h=Math.abs(n-s.y)/(r-s.x);fo(s,t)&&(h<u||h===u&&(s.x>o.x||s.x===o.x&&xT(o,s)))&&(o=s,u=h)}s=s.next}while(s!==a);return o}function xT(t,e){return Pe(t.prev,t,e.prev)<0&&Pe(e.next,t,t.next)<0}function bT(t,e,s,r){let n=t;do n.z===0&&(n.z=Nh(n.x,n.y,e,s,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,wT(n)}function wT(t){let e,s=1;do{let r=t,n;t=null;let i=null;for(e=0;r;){e++;let o=r,a=0;for(let c=0;c<s&&(a++,o=o.nextZ,!!o);c++);let l=s;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||r.z<=o.z)?(n=r,r=r.nextZ,a--):(n=o,o=o.nextZ,l--),i?i.nextZ=n:t=n,n.prevZ=i,i=n;r=o}i.nextZ=null,s*=2}while(e>1);return t}function Nh(t,e,s,r,n){return t=(t-s)*n|0,e=(e-r)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function VT(t){let e=t,s=t;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==t);return s}function zw(t,e,s,r,n,i,o,a){return(n-o)*(e-a)>=(t-o)*(i-a)&&(t-o)*(r-a)>=(s-o)*(e-a)&&(s-o)*(i-a)>=(n-o)*(r-a)}function Ii(t,e,s,r,n,i,o,a){return!(t===o&&e===a)&&zw(t,e,s,r,n,i,o,a)}function qT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!vT(t,e)&&(fo(t,e)&&fo(e,t)&&_T(t,e)&&(Pe(t.prev,t,e.prev)||Pe(t,e.prev,e))||Rn(t,e)&&Pe(t.prev,t,t.next)>0&&Pe(e.prev,e,e.next)>0)}function Pe(t,e,s){return(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)}function Rn(t,e){return t.x===e.x&&t.y===e.y}function Dw(t,e,s,r){const n=qa(Pe(t,e,s)),i=qa(Pe(t,e,r)),o=qa(Pe(s,r,t)),a=qa(Pe(s,r,e));return!!(n!==i&&o!==a||n===0&&Va(t,s,e)||i===0&&Va(t,r,e)||o===0&&Va(s,t,r)||a===0&&Va(s,e,r))}function Va(t,e,s){return e.x<=Math.max(t.x,s.x)&&e.x>=Math.min(t.x,s.x)&&e.y<=Math.max(t.y,s.y)&&e.y>=Math.min(t.y,s.y)}function qa(t){return t>0?1:t<0?-1:0}function vT(t,e){let s=t;do{if(s.i!==t.i&&s.next.i!==t.i&&s.i!==e.i&&s.next.i!==e.i&&Dw(s,s.next,t,e))return!0;s=s.next}while(s!==t);return!1}function fo(t,e){return Pe(t.prev,t,t.next)<0?Pe(t,e,t.next)>=0&&Pe(t,t.prev,e)>=0:Pe(t,e,t.prev)<0||Pe(t,t.next,e)<0}function _T(t,e){let s=t,r=!1;const n=(t.x+e.x)/2,i=(t.y+e.y)/2;do s.y>i!=s.next.y>i&&s.next.y!==s.y&&n<(s.next.x-s.x)*(i-s.y)/(s.next.y-s.y)+s.x&&(r=!r),s=s.next;while(s!==t);return r}function Fw(t,e){const s=zh(t.i,t.x,t.y),r=zh(e.i,e.x,e.y),n=t.next,i=e.prev;return t.next=e,e.prev=t,s.next=n,n.prev=s,r.next=s,s.prev=r,i.next=r,r.prev=i,r}function Ig(t,e,s,r){const n=zh(t,e,s);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function po(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function zh(t,e,s){return{i:t,x:e,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ST(t,e,s,r){let n=0;for(let i=e,o=s-r;i<s;i+=r)n+=(t[o]-t[i])*(t[i+1]+t[o+1]),o=i;return n}const kT=Rg.default||Rg;class Lw extends bs{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return ve(at,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return ve(at,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return ve(at,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return ve(at,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return ve(at,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const s in this.chars)this.chars[s].texture?.destroy();this.chars=null,e&&(this.pages.forEach(s=>s.texture.destroy(!0)),this.pages=null)}}/**
 * tiny-lru
 *
 * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.4.5
 */class CT{constructor(e=0,s=0,r=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=r,this.size=0,this.ttl=s}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const s=this.items[e];delete this.items[e],this.size--,s.prev!==null&&(s.prev.next=s.next),s.next!==null&&(s.next.prev=s.prev),this.first===s&&(this.first=s.next),this.last===s&&(this.last=s.prev)}return this}entries(e=this.keys()){return e.map(s=>[s,this.get(s)])}evict(e=!1){if(e||this.size>0){const s=this.first;delete this.items[s.key],--this.size===0?(this.first=null,this.last=null):(this.first=s.next,this.first.prev=null)}return this}expiresAt(e){let s;return this.has(e)&&(s=this.items[e].expiry),s}get(e){const s=this.items[e];if(s!==void 0){if(this.ttl>0&&s.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(s),s.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let s=this.first;for(;s!==null;)e.push(s.key),s=s.next;return e}setWithEvicted(e,s,r=this.resetTtl){let n=null;if(this.has(e))this.set(e,s,!0,r);else{this.max>0&&this.size===this.max&&(n={...this.first},this.evict(!0));let i=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:s};++this.size===1?this.first=i:this.last.next=i,this.last=i}return n}set(e,s,r=!1,n=this.resetTtl){let i=this.items[e];return r||i!==void 0?(i.value=s,r===!1&&n&&(i.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(i)):(this.max>0&&this.size===this.max&&this.evict(!0),i=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:s},++this.size===1?this.first=i:this.last.next=i,this.last=i),this}values(e=this.keys()){return e.map(s=>this.get(s))}}function Uw(t=1e3,e=0,s=!1){if(isNaN(t)||t<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof s!="boolean")throw new TypeError("Invalid resetTtl value");return new CT(t,e,s)}const PT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Dh(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let s=t.fontFamily;Array.isArray(t.fontFamily)||(s=t.fontFamily.split(","));for(let r=s.length-1;r>=0;r--){let n=s[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!PT.includes(n)&&(n=`"${n}"`),s[r]=n}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${s.join(",")}`}const cu={willReadFrequently:!0},as=class U{static get experimentalLetterSpacingSupported(){let e=U._experimentalLetterSpacingSupported;if(e===void 0){const s=Ie.get().getCanvasRenderingContext2D().prototype;e=U._experimentalLetterSpacingSupported="letterSpacing"in s||"textLetterSpacing"in s}return e}constructor(e,s,r,n,i,o,a,l,c){this.text=e,this.style=s,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",s,r=U._canvas,n=s.wordWrap){const i=`${e}-${s.styleKey}-wordWrap-${n}`;if(U._measurementCache.has(i))return U._measurementCache.get(i);const o=Dh(s),a=U.measureFont(o);a.fontSize===0&&(a.fontSize=s.fontSize,a.ascent=s.fontSize);const l=U.__context;l.font=o;const u=(n?U._wordWrap(e,s,r):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let w=0;w<u.length;w++){const x=U._measureText(u[w],s.letterSpacing,l);h[w]=x,d=Math.max(d,x)}const f=s._stroke?.width||0;let m=d+f;s.dropShadow&&(m+=s.dropShadow.distance);const A=s.lineHeight||a.fontSize;let g=Math.max(A,a.fontSize+f)+(u.length-1)*(A+s.leading);s.dropShadow&&(g+=s.dropShadow.distance);const y=new U(e,s,m,g,u,h,A+s.leading,d,a);return U._measurementCache.set(i,y),y}static _measureText(e,s,r){let n=!1;U.experimentalLetterSpacingSupported&&(U.experimentalLetterSpacing?(r.letterSpacing=`${s}px`,r.textLetterSpacing=`${s}px`,n=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));const i=r.measureText(e);let o=i.width;const a=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-a;if(o>0)if(n)o-=s,c-=s;else{const u=(U.graphemeSegmenter(e).length-1)*s;o+=u,c+=u}return Math.max(o,c)}static _wordWrap(e,s,r=U._canvas){const n=r.getContext("2d",cu);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=s,h=U._collapseSpaces(u),d=U._collapseNewlines(u);let f=!h;const m=s.wordWrapWidth+c,A=U._tokenize(e);for(let g=0;g<A.length;g++){let y=A[g];if(U._isNewline(y)){if(!d){a+=U._addLine(o),f=!h,o="",i=0;continue}y=" "}if(h){const x=U.isBreakingSpace(y),b=U.isBreakingSpace(o[o.length-1]);if(x&&b)continue}const w=U._getFromCache(y,c,l,n);if(w>m)if(o!==""&&(a+=U._addLine(o),o="",i=0),U.canBreakWords(y,s.breakWords)){const x=U.wordWrapSplit(y);for(let b=0;b<x.length;b++){let q=x[b],_=q,V=1;for(;x[b+V];){const k=x[b+V];if(!U.canBreakChars(_,k,y,b,s.breakWords))q+=k;else break;_=k,V++}b+=V-1;const S=U._getFromCache(q,c,l,n);S+i>m&&(a+=U._addLine(o),f=!1,o="",i=0),o+=q,i+=S}}else{o.length>0&&(a+=U._addLine(o),o="",i=0);const x=g===A.length-1;a+=U._addLine(y,!x),f=!1,o="",i=0}else w+i>m&&(f=!1,a+=U._addLine(o),o="",i=0),(o.length>0||!U.isBreakingSpace(y)||f)&&(o+=y,i+=w)}return a+=U._addLine(o,!1),a}static _addLine(e,s=!0){return e=U._trimRight(e),e=s?`${e}
`:e,e}static _getFromCache(e,s,r,n){let i=r[e];return typeof i!="number"&&(i=U._measureText(e,s,n)+s,r[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let s=e.length-1;s>=0;s--){const r=e[s];if(!U.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:U._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,s){return typeof e!="string"?!1:U._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const s=[];let r="";if(typeof e!="string")return s;for(let n=0;n<e.length;n++){const i=e[n],o=e[n+1];if(U.isBreakingSpace(i,o)||U._isNewline(i)){r!==""&&(s.push(r),r=""),i==="\r"&&o===`
`?(s.push(`\r
`),n++):s.push(i);continue}r+=i}return r!==""&&s.push(r),s}static canBreakWords(e,s){return s}static canBreakChars(e,s,r,n,i){return!0}static wordWrapSplit(e){return U.graphemeSegmenter(e)}static measureFont(e){if(U._fonts[e])return U._fonts[e];const s=U._context;s.font=e;const r=s.measureText(U.METRICS_STRING+U.BASELINE_SYMBOL),n={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return U._fonts[e]=n,n}static clearMetrics(e=""){e?delete U._fonts[e]:U._fonts={}}static get _canvas(){if(!U.__canvas){let e;try{const s=new OffscreenCanvas(0,0);if(s.getContext("2d",cu)?.measureText)return U.__canvas=s,s;e=Ie.get().createCanvas()}catch{e=Ie.get().createCanvas()}e.width=e.height=10,U.__canvas=e}return U.__canvas}static get _context(){return U.__context||(U.__context=U._canvas.getContext("2d",cu)),U.__context}};as.METRICS_STRING="|q";as.BASELINE_SYMBOL="M";as.BASELINE_MULTIPLIER=1.4;as.HEIGHT_MULTIPLIER=2;as.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>{const s=t.segment(e),r=[];let n=0;for(const i of s)r[n++]=i.segment;return r}}return t=>[...t]})();as.experimentalLetterSpacing=!1;as._fonts={};as._newlines=[10,13];as._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];as._measurementCache=Uw(1e3);let $a=as;const jg=[{offset:0,color:"white"},{offset:1,color:"black"}],pf=class Fh{constructor(...e){this.uid=ze("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let s=ET(e);s={...s.type==="radial"?Fh.defaultRadialOptions:Fh.defaultLinearOptions,...tw(s)},this._textureSize=s.textureSize,this._wrapMode=s.wrapMode,s.type==="radial"?(this.center=s.center,this.outerCenter=s.outerCenter??this.center,this.innerRadius=s.innerRadius,this.outerRadius=s.outerRadius,this.scale=s.scale,this.rotation=s.rotation):(this.start=s.start,this.end=s.end),this.textureSpace=s.textureSpace,this.type=s.type,s.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,s){return this.colorStops.push({offset:e,color:ct.shared.setValue(s).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:s}=this.start,{x:r,y:n}=this.end,i=r-e,o=n-s;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const g=e;e=r,r=g,i*=-1}if(o<0){const g=s;s=n,n=g,o*=-1}}const l=this.colorStops.length?this.colorStops:jg,c=this._textureSize,{canvas:u,context:h}=Bg(c,1),d=a?h.createLinearGradient(this._textureSize,0,0,0):h.createLinearGradient(0,0,this._textureSize,0);Og(d,l),h.fillStyle=d,h.fillRect(0,0,c,1),this.texture=new ce({source:new zr({resource:u,addressMode:this._wrapMode})});const f=Math.sqrt(i*i+o*o),m=Math.atan2(o,i),A=new le;A.scale(f/c,1),A.rotate(m),A.translate(e,s),this.textureSpace==="local"&&A.scale(c,c),this.transform=A}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:jg,s=this._textureSize,{canvas:r,context:n}=Bg(s,s),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,d=l-u,f=s/(u*2),m=(i-h)*f,A=(o-d)*f,g=n.createRadialGradient(m,A,c*f,(a-h)*f,(l-d)*f,u*f);Og(g,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,s,s),n.fillStyle=g,n.translate(m,A),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-A),n.fillRect(0,0,s,s),this.texture=new ce({source:new zr({resource:r,addressMode:this._wrapMode})});const y=new le;y.scale(1/f,1/f),y.translate(h,d),this.textureSpace==="local"&&y.scale(s,s),this.transform=y}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};pf.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};pf.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Ns=pf;function Og(t,e){for(let s=0;s<e.length;s++){const r=e[s];t.addColorStop(r.offset,r.color)}}function Bg(t,e){const s=Ie.get().createCanvas(t,e),r=s.getContext("2d");return{canvas:s,context:r}}function ET(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(ve("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??Ns.defaultLinearOptions.textureSize}),e}const Ng={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Yl{constructor(e,s){this.uid=ze("fillPattern"),this._tick=0,this.transform=new le,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),s&&(e.source.style.addressModeU=Ng[s].addressModeU,e.source.style.addressModeV=Ng[s].addressModeV)}setTransform(e){const s=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/s.frame.width,1/s.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var uu,zg;function TT(){if(zg)return uu;zg=1,uu=s;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function s(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(r);return o?o.map(Number):[]}return uu}var MT=TT();const RT=Ke(MT);function IT(t,e){const s=RT(t),r=[];let n=null,i=0,o=0;for(let a=0;a<s.length;a++){const l=s[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),r.length>0&&(n=r.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:_e(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:o},r.push(n))}return e}class mf{constructor(e=0,s=0,r=0){this.type="circle",this.x=e,this.y=s,this.radius=r}clone(){return new mf(this.x,this.y,this.radius)}contains(e,s){if(this.radius<=0)return!1;const r=this.radius*this.radius;let n=this.x-e,i=this.y-s;return n*=n,i*=i,n+i<=r}strokeContains(e,s,r,n=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-s,a=this.radius,l=(1-n)*r,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(r-l)}getBounds(e){return e||(e=new Ne),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class gf{constructor(e=0,s=0,r=0,n=0){this.type="ellipse",this.x=e,this.y=s,this.halfWidth=r,this.halfHeight=n}clone(){return new gf(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,s){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(e-this.x)/this.halfWidth,n=(s-this.y)/this.halfHeight;return r*=r,n*=n,r+n<=1}strokeContains(e,s,r,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=r*(1-n),l=r-a,c=i-l,u=o-l,h=i+a,d=o+a,f=e-this.x,m=s-this.y,A=f*f/(c*c)+m*m/(u*u),g=f*f/(h*h)+m*m/(d*d);return A>1&&g<=1}getBounds(e){return e||(e=new Ne),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function jT(t,e,s,r,n,i){const o=t-s,a=e-r,l=n-s,c=i-r,u=o*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,m;d<0?(f=s,m=r):d>1?(f=n,m=i):(f=s+d*l,m=r+d*c);const A=t-f,g=e-m;return A*A+g*g}let OT,BT;class Wi{constructor(...e){this.type="polygon";let s=Array.isArray(e[0])?e[0]:e;if(typeof s[0]!="number"){const r=[];for(let n=0,i=s.length;n<i;n++)r.push(s[n].x,s[n].y);s=r}this.points=s,this.closePath=!0}isClockwise(){let e=0;const s=this.points,r=s.length;for(let n=0;n<r;n+=2){const i=s[n],o=s[n+1],a=s[(n+2)%r],l=s[(n+3)%r];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const s=this.getBounds(OT),r=e.getBounds(BT);if(!s.containsRect(r))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),s=new Wi(e);return s.closePath=this.closePath,s}contains(e,s){let r=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>s!=u>s&&e<(c-a)*((s-l)/(u-l))+a&&(r=!r)}return r}strokeContains(e,s,r,n=.5){const i=r*r,o=i*(1-n),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],d=l[u+1],f=l[(u+2)%l.length],m=l[(u+3)%l.length],A=jT(e,s,h,d,f,m),g=Math.sign((f-h)*(s-d)-(m-d)*(e-h));if(A<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new Ne);const s=this.points;let r=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,l=s.length;a<l;a+=2){const c=s[a],u=s[a+1];r=c<r?c:r,n=c>n?c:n,i=u<i?u:i,o=u>o?u:o}return e.x=r,e.width=n-r,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,s)=>`${e}, ${s}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return ve("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return ve("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const va=(t,e,s,r,n,i,o)=>{const a=t-s,l=e-r,c=Math.sqrt(a*a+l*l);return c>=n-i&&c<=n+o};class Af{constructor(e=0,s=0,r=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=s,this.width=r,this.height=n,this.radius=i}getBounds(e){return e||(e=new Ne),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Af(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,s){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+r&&s<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let n=e-(this.x+r),i=s-(this.y+r);const o=r*r;if(n*n+i*i<=o||(n=e-(this.x+this.width-r),n*n+i*i<=o)||(i=s-(this.y+this.height-r),n*n+i*i<=o)||(n=e-(this.x+r),n*n+i*i<=o))return!0}return!1}strokeContains(e,s,r,n=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=r*(1-n),h=r-u,d=i+c,f=o+c,m=a-c*2,A=l-c*2,g=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=g-h&&e<=g+u)&&s>=f&&s<=f+A||(s>=o-u&&s<=o+h||s>=y-h&&s<=y+u)&&e>=d&&e<=d+m?!0:e<d&&s<f&&va(e,s,d,f,c,h,u)||e>g-c&&s<f&&va(e,s,g-c,f,c,h,u)||e>g-c&&s>y-c&&va(e,s,g-c,y-c,c,h,u)||e<d&&s>y-c&&va(e,s,d,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const $w={};function NT(t,e,s){let r=2166136261;for(let n=0;n<e;n++)r^=t[n].uid,r=Math.imul(r,16777619),r>>>=0;return $w[r]||zT(t,e,r,s)}function zT(t,e,s,r){const n={};let i=0;for(let a=0;a<r;a++){const l=a<e?t[a]:ce.EMPTY.source;n[i++]=l.source,n[i++]=l.style}const o=new Ua(n);return $w[s]=o,o}class Dg{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Fg(t,e){const s=t.byteLength/8|0,r=new Float64Array(t,0,s);new Float64Array(e,0,s).set(r);const i=t.byteLength-s*8;if(i>0){const o=new Uint8Array(t,s*8,i);new Uint8Array(e,s*8,i).set(o)}}const DT={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var FT=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(FT||{});function Lg(t,e){return e.alphaMode==="no-premultiply-alpha"&&DT[t]||t}const LT=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function UT(t){let e="";for(let s=0;s<t;++s)s>0&&(e+=`
else `),s<t-1&&(e+=`if(test == ${s}.0){}`);return e}function $T(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const s=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const r=LT.replace(/%forloop%/gi,UT(t));if(e.shaderSource(s,r),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(s)}return t}let nn=null;function HT(){if(nn)return nn;const t=Tw();return nn=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),nn=$T(nn,t),t.getExtension("WEBGL_lose_context")?.loseContext(),nn}class WT{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const s=this.textures[e];this.textures[e]=null,this.ids[s.uid]=null}this.count=0}}class GT{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new WT,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Gi=[];let gl=0;Hl.register({clear:()=>{if(Gi.length>0)for(const t of Gi)t&&t.destroy();Gi.length=0,gl=0}});function Ug(){return gl>0?Gi[--gl]:new GT}function $g(t){Gi[gl++]=t}let bi=0;const Hw=class Ww{constructor(e){this.uid=ze("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...Ww.defaultOptions,...e},e.maxTextures||(ve("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=HT());const{maxTextures:s,attributesInitialSize:r,indicesInitialSize:n}=e;this.attributeBuffer=new Dg(r*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=s}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)$g(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,s){const r=e._batch.textures.ids[s._source.uid];return!r&&r!==0?!1:(e._textureId=r,e.texture=s,!0)}updateElement(e){this.dirty=!0;const s=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,s.float32View,s.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,s.float32View,s.uint32View,e._attributeStart,e._textureId)}break(e){const s=this._elements;if(!s[this.elementStart])return;let r=Ug(),n=r.textures;n.clear();const i=s[this.elementStart];let o=Lg(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const m=this.maxTextures;for(let A=this.elementStart;A<this.elementSize;++A){const g=s[A];s[A]=null;const w=g.texture._source,x=Lg(g.blendMode,w),b=o!==x||a!==g.topology;if(w._batchTick===bi&&!b){g._textureId=w._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=r;continue}w._batchTick=bi,(n.count>=m||b)&&(this._finishBatch(r,d,h-d,n,o,a,e,f),f="renderBatch",d=h,o=x,a=g.topology,r=Ug(),n=r.textures,n.clear(),++bi),g._textureId=w._textureBindLocation=n.count,n.ids[w.uid]=n.count,n.textures[n.count++]=w,g._batch=r,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(r,d,h-d,n,o,a,e,f),d=h,++bi),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=h}_finishBatch(e,s,r,n,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=o,e.start=s,e.size=r,++bi,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const s=Math.max(e,this.attributeBuffer.size*2),r=new Dg(s);Fg(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(e){const s=this.indexBuffer;let r=Math.max(e,s.length*1.5);r+=r%2;const n=r>65535?new Uint32Array(r):new Uint16Array(r);if(n.BYTES_PER_ELEMENT!==s.BYTES_PER_ELEMENT)for(let i=0;i<s.length;i++)n[i]=s[i];else Fg(s.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,s,r){e[s]=r+0,e[s+1]=r+1,e[s+2]=r+2,e[s+3]=r+0,e[s+4]=r+2,e[s+5]=r+3}packIndex(e,s,r,n){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)s[r++]=n+i[c+a]-l}destroy(e={}){if(this.batches!==null){for(let s=0;s<this.batches.length;s++)$g(this.batches[s]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&(this.shader?.destroy(),this.shader=null);for(let s=0;s<this._elements.length;s++)this._elements[s]&&(this._elements[s]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};Hw.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let YT=Hw;var vt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(vt||{});let mo=class extends bs{constructor(e){let{data:s,size:r}=e;const{usage:n,label:i,shrinkToFit:o}=e;super(),this.uid=ze("buffer"),this._resourceType="buffer",this._resourceId=ze("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,s instanceof Array&&(s=new Float32Array(s)),this._data=s,r??(r=s?.byteLength);const a=!!s;this.descriptor={size:r,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&vt.STATIC)}set static(e){e?this.descriptor.usage|=vt.STATIC:this.descriptor.usage&=~vt.STATIC}setDataWithSize(e,s,r){if(this._updateID++,this._updateSize=s*e.BYTES_PER_ELEMENT,this._data===e){r&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?r&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=ze("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Gw(t,e){if(!(t instanceof mo)){let s=e?vt.INDEX:vt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),s=vt.INDEX|vt.COPY_DST):(t=new Float32Array(t),s=vt.VERTEX|vt.COPY_DST)),t=new mo({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:s})}return t}function KT(t,e,s){const r=t.getAttribute(e);if(!r)return s.minX=0,s.minY=0,s.maxX=0,s.maxY=0,s;const n=r.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(r.offset||0)/c,h=(r.stride||8)/c;for(let d=u;d<n.length;d+=h){const f=n[d],m=n[d+1];f>a&&(a=f),m>l&&(l=m),f<i&&(i=f),m<o&&(o=m)}return s.minX=i,s.minY=o,s.maxX=a,s.maxY=l,s}function QT(t){return(t instanceof mo||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Gw(t.buffer,!1),t}class XT extends bs{constructor(e={}){super(),this.uid=ze("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new ss,this._boundsDirty=!0;const{attributes:s,indexBuffer:r,topology:n}=e;if(this.buffers=[],this.attributes={},s)for(const i in s)this.addAttribute(i,s[i]);this.instanceCount=e.instanceCount??1,r&&this.addIndex(r),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const s=this.attributes[e];return s.buffer.data.length/(s.stride/4||s.size)}return 0}addAttribute(e,s){const r=QT(s);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=r}addIndex(e){this.indexBuffer=Gw(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,KT(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(s=>s.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const JT=new Float32Array(1),ZT=new Uint32Array(1);class eM extends XT{constructor(){const s=new mo({data:JT,label:"attribute-batch-buffer",usage:vt.VERTEX|vt.COPY_DST,shrinkToFit:!1}),r=new mo({data:ZT,label:"index-batch-buffer",usage:vt.INDEX|vt.COPY_DST,shrinkToFit:!1}),n=24;super({attributes:{aPosition:{buffer:s,format:"float32x2",stride:n,offset:0},aUV:{buffer:s,format:"float32x2",stride:n,offset:8},aColor:{buffer:s,format:"unorm8x4",stride:n,offset:16},aTextureIdAndRound:{buffer:s,format:"uint16x2",stride:n,offset:20}},indexBuffer:r})}}function Hg(t,e,s){if(t)for(const r in t){const n=r.toLocaleLowerCase(),i=e[n];if(i){let o=t[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),s&&i.push(`//----${s}----//`),i.push(o)}else _e(`${r} placement hook does not exist in shader`)}}const tM=/\{\{(.*?)\}\}/g;function Wg(t){const e={};return(t.match(tM)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{e[r]=[]}),e}function Gg(t,e){let s;const r=/@in\s+([^;]+);/g;for(;(s=r.exec(t))!==null;)e.push(s[1])}function Yg(t,e,s=!1){const r=[];Gg(e,r),t.forEach(a=>{a.header&&Gg(a.header,r)});const n=r;s&&n.sort();const i=n.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Kg(t,e){let s;const r=/@out\s+([^;]+);/g;for(;(s=r.exec(t))!==null;)e.push(s[1])}function sM(t){const s=/\b(\w+)\s*:/g.exec(t);return s?s[1]:""}function rM(t){const e=/@.*?\s+/g;return t.replace(e,"")}function nM(t,e){const s=[];Kg(e,s),t.forEach(l=>{l.header&&Kg(l.header,s)});let r=0;const n=s.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${r++}) ${l}`).join(`,
`),i=s.sort().map(l=>`       var ${rM(l)};`).join(`
`),o=`return VSOutput(
            ${s.sort().map(l=>` ${sM(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Qg(t,e){let s=t;for(const r in e){const n=e[r];n.join(`
`).length?s=s.replace(`{{${r}}}`,`//-----${r} START-----//
${n.join(`
`)}
//----${r} FINISH----//`):s=s.replace(`{{${r}}}`,"")}return s}const Ks=Object.create(null),hu=new Map;let iM=0;function oM({template:t,bits:e}){const s=Yw(t,e);if(Ks[s])return Ks[s];const{vertex:r,fragment:n}=lM(t,e);return Ks[s]=Kw(r,n,e),Ks[s]}function aM({template:t,bits:e}){const s=Yw(t,e);return Ks[s]||(Ks[s]=Kw(t.vertex,t.fragment,e)),Ks[s]}function lM(t,e){const s=e.map(o=>o.vertex).filter(o=>!!o),r=e.map(o=>o.fragment).filter(o=>!!o);let n=Yg(s,t.vertex,!0);n=nM(s,n);const i=Yg(r,t.fragment,!0);return{vertex:n,fragment:i}}function Yw(t,e){return e.map(s=>(hu.has(s)||hu.set(s,iM++),hu.get(s))).sort((s,r)=>s-r).join("-")+t.vertex+t.fragment}function Kw(t,e,s){const r=Wg(t),n=Wg(e);return s.forEach(i=>{Hg(i.vertex,r,i.name),Hg(i.fragment,n,i.name)}),{vertex:Qg(t,r),fragment:Qg(e,n)}}const cM=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,uM=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,hM=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,dM=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,fM={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},pM={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function mM({bits:t,name:e}){const s=oM({template:{fragment:uM,vertex:cM},bits:[fM,...t]});return Gl.from({name:e,vertex:{source:s.vertex,entryPoint:"main"},fragment:{source:s.fragment,entryPoint:"main"}})}function gM({bits:t,name:e}){return new Rw({name:e,...aM({template:{vertex:hM,fragment:dM},bits:[pM,...t]})})}const AM={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},yM={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},du={};function xM(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let s=0;for(let r=0;r<t;r++)e.push(`@group(1) @binding(${s++}) var textureSource${r+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${s++}) var textureSampler${r+1}: sampler;`)}return e.join(`
`)}function bM(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let s=0;s<t;s++)s===t-1?e.push("  default:{"):e.push(`  case ${s}:{`),e.push(`      outColor = textureSampleGrad(textureSource${s+1}, textureSampler${s+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function wM(t){return du[t]||(du[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${xM(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${bM(t)}
            `}}),du[t]}const fu={};function VM(t){const e=[];for(let s=0;s<t;s++)s>0&&e.push("else"),s<t-1&&e.push(`if(vTextureId < ${s}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${s}], vUV);`),e.push("}");return e.join(`
`)}function qM(t){return fu[t]||(fu[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${VM(t)}
            `}}),fu[t]}const vM={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},_M={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Xg={};function SM(t){let e=Xg[t];if(e)return e;const s=new Int32Array(t);for(let r=0;r<t;r++)s[r]=r;return e=Xg[t]=new Bw({uTextures:{value:s,type:"i32",size:t}},{isStatic:!0}),e}class Jg extends ff{constructor(e){const s=gM({name:"batch",bits:[yM,qM(e),_M]}),r=mM({name:"batch",bits:[AM,wM(e),vM]});super({glProgram:s,gpuProgram:r,resources:{batchSamplers:SM(e)}}),this.maxTextures=e}}let wi=null;const Qw=class Xw extends YT{constructor(e){super(e),this.geometry=new eM,this.name=Xw.extension.name,this.vertexSize=6,wi??(wi=new Jg(e.maxTextures)),this.shader=wi}packAttributes(e,s,r,n,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,{positions:m,uvs:A}=e,g=e.color,y=e.attributeOffset,w=y+e.attributeSize;for(let x=y;x<w;x++){const b=x*2,q=m[b],_=m[b+1];s[n++]=l*q+u*_+d,s[n++]=h*_+c*q+f,s[n++]=A[b],s[n++]=A[b+1],r[n++]=g,r[n++]=o}}packQuadAttributes(e,s,r,n,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,m=e.bounds,A=m.maxX,g=m.minX,y=m.maxY,w=m.minY,x=o.uvs,b=e.color,q=i<<16|e.roundPixels&65535;s[n+0]=l*g+u*w+d,s[n+1]=h*w+c*g+f,s[n+2]=x.x0,s[n+3]=x.y0,r[n+4]=b,r[n+5]=q,s[n+6]=l*A+u*w+d,s[n+7]=h*w+c*A+f,s[n+8]=x.x1,s[n+9]=x.y1,r[n+10]=b,r[n+11]=q,s[n+12]=l*A+u*y+d,s[n+13]=h*y+c*A+f,s[n+14]=x.x2,s[n+15]=x.y2,r[n+16]=b,r[n+17]=q,s[n+18]=l*g+u*y+d,s[n+19]=h*y+c*g+f,s[n+20]=x.x3,s[n+21]=x.y3,r[n+22]=b,r[n+23]=q}_updateMaxTextures(e){this.shader.maxTextures!==e&&(wi=new Jg(e),this.shader=wi)}destroy(){this.shader=null,super.destroy()}};Qw.extension={type:[G.Batcher],name:"default"};let kM=Qw;function CM(t,e,s,r,n,i,o,a=null){let l=0;s*=e,n*=i;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,m=a.ty;for(;l<o;){const A=t[s],g=t[s+1];r[n]=c*A+h*g+f,r[n+1]=u*A+d*g+m,n+=i,s+=e,l++}}function PM(t,e,s,r){let n=0;for(e*=s;n<r;)t[e]=0,t[e+1]=0,e+=s,n++}function Jw(t,e,s,r,n){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;s||(s=0),r||(r=2),n||(n=t.length/r-s);let h=s*r;for(let d=0;d<n;d++){const f=t[h],m=t[h+1];t[h]=i*f+a*m+c,t[h+1]=o*f+l*m+u,h+=r}}const EM=new le;class Zw{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,s=e>>16|e&65280|(e&255)<<16,r=this.renderable;return r?hw(s,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):s+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||EM}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const go={extension:{type:G.ShapeBuilder,name:"circle"},build(t,e){let s,r,n,i,o,a;if(t.type==="circle"){const b=t;if(o=a=b.radius,o<=0)return!1;s=b.x,r=b.y,n=i=0}else if(t.type==="ellipse"){const b=t;if(o=b.halfWidth,a=b.halfHeight,o<=0||a<=0)return!1;s=b.x,r=b.y,n=i=0}else{const b=t,q=b.width/2,_=b.height/2;s=b.x+q,r=b.y+_,o=a=Math.max(0,Math.min(b.radius,Math.min(q,_))),n=q-o,i=_-a}if(n<0||i<0)return!1;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return!1;if(l===0)return e[0]=e[6]=s+n,e[1]=e[3]=r+i,e[2]=e[4]=s-n,e[5]=e[7]=r-i,!0;let u=0,h=l*4+(n?2:0)+2,d=h,f=c,m=n+o,A=i,g=s+m,y=s-m,w=r+A;if(e[u++]=g,e[u++]=w,e[--h]=w,e[--h]=y,i){const b=r-A;e[d++]=y,e[d++]=b,e[--f]=b,e[--f]=g}for(let b=1;b<l;b++){const q=Math.PI/2*(b/l),_=n+Math.cos(q)*o,V=i+Math.sin(q)*a,S=s+_,k=s-_,C=r+V,P=r-V;e[u++]=S,e[u++]=C,e[--h]=C,e[--h]=k,e[d++]=k,e[d++]=P,e[--f]=P,e[--f]=S}m=n,A=i+a,g=s+m,y=s-m,w=r+A;const x=r-A;return e[u++]=g,e[u++]=w,e[--f]=x,e[--f]=g,n&&(e[u++]=y,e[u++]=w,e[--f]=x,e[--f]=y),!0},triangulate(t,e,s,r,n,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=r;e[l*s]=o,e[l*s+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*s]=t[u],e[l*s+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},TM={...go,extension:{...go.extension,name:"ellipse"}},MM={...go,extension:{...go.extension,name:"roundedRectangle"}},eV=1e-4,Zg=1e-4;function RM(t){const e=t.length;if(e<6)return 1;let s=0;for(let r=0,n=t[e-2],i=t[e-1];r<e;r+=2){const o=t[r],a=t[r+1];s+=(o-n)*(a+i),n=o,i=a}return s<0?-1:1}function eA(t,e,s,r,n,i,o,a){const l=t-s*n,c=e-r*n,u=t+s*i,h=e+r*i;let d,f;o?(d=r,f=-s):(d=-r,f=s);const m=l+d,A=c+f,g=u+d,y=h+f;return a.push(m,A),a.push(g,y),2}function dr(t,e,s,r,n,i,o,a){const l=s-t,c=r-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,m=Math.abs(f),A=Math.sqrt(l*l+c*c),g=(15*m*Math.sqrt(A)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(t,e),o.push(s,r);for(let w=1,x=d;w<g;w++,x+=y)o.push(t,e),o.push(t+Math.sin(x)*A,e+Math.cos(x)*A);o.push(t,e),o.push(n,i)}else{o.push(s,r),o.push(t,e);for(let w=1,x=d;w<g;w++,x+=y)o.push(t+Math.sin(x)*A,e+Math.cos(x)*A),o.push(t,e);o.push(n,i),o.push(t,e)}return g*2}function IM(t,e,s,r,n,i){const o=eV;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let F=RM(t);l=(l-.5)*F+.5}const c=new lt(t[0],t[1]),u=new lt(t[t.length-2],t[t.length-1]),h=r,d=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),d&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const F=(c.x+u.x)*.5,Y=(u.y+c.y)*.5;t.unshift(F,Y),t.push(F,Y)}const f=n,m=t.length/2;let A=t.length;const g=f.length/2,y=a.width/2,w=y*y,x=a.miterLimit*a.miterLimit;let b=t[0],q=t[1],_=t[2],V=t[3],S=0,k=0,C=-(q-V),P=b-_,T=0,M=0,I=Math.sqrt(C*C+P*P);C/=I,P/=I,C*=y,P*=y;const z=l,E=(1-z)*2,R=z*2;h||(a.cap==="round"?A+=dr(b-C*(E-R)*.5,q-P*(E-R)*.5,b-C*E,q-P*E,b+C*R,q+P*R,f,!0)+2:a.cap==="square"&&(A+=eA(b,q,C,P,E,R,!0,f))),f.push(b-C*E,q-P*E),f.push(b+C*R,q+P*R);for(let F=1;F<m-1;++F){b=t[(F-1)*2],q=t[(F-1)*2+1],_=t[F*2],V=t[F*2+1],S=t[(F+1)*2],k=t[(F+1)*2+1],C=-(q-V),P=b-_,I=Math.sqrt(C*C+P*P),C/=I,P/=I,C*=y,P*=y,T=-(V-k),M=_-S,I=Math.sqrt(T*T+M*M),T/=I,M/=I,T*=y,M*=y;const Y=_-b,ge=q-V,oe=_-S,se=k-V,Ae=Y*oe+ge*se,ae=ge*oe-se*Y,he=ae<0;if(Math.abs(ae)<.001*Math.abs(Ae)){f.push(_-C*E,V-P*E),f.push(_+C*R,V+P*R),Ae>=0&&(a.join==="round"?A+=dr(_,V,_-C*E,V-P*E,_-T*E,V-M*E,f,!1)+4:A+=2,f.push(_-T*R,V-M*R),f.push(_+T*E,V+M*E));continue}const Fe=(-C+b)*(-P+V)-(-C+_)*(-P+q),ls=(-T+S)*(-M+V)-(-T+_)*(-M+k),xt=(Y*ls-oe*Fe)/ae,Yt=(se*Fe-ge*ls)/ae,qs=(xt-_)*(xt-_)+(Yt-V)*(Yt-V),Ct=_+(xt-_)*E,bt=V+(Yt-V)*E,cs=_-(xt-_)*R,vs=V-(Yt-V)*R,Lq=Math.min(Y*Y+ge*ge,oe*oe+se*se),ep=he?E:R,Uq=Lq+ep*ep*w;qs<=Uq?a.join==="bevel"||qs/w>x?(he?(f.push(Ct,bt),f.push(_+C*R,V+P*R),f.push(Ct,bt),f.push(_+T*R,V+M*R)):(f.push(_-C*E,V-P*E),f.push(cs,vs),f.push(_-T*E,V-M*E),f.push(cs,vs)),A+=2):a.join==="round"?he?(f.push(Ct,bt),f.push(_+C*R,V+P*R),A+=dr(_,V,_+C*R,V+P*R,_+T*R,V+M*R,f,!0)+4,f.push(Ct,bt),f.push(_+T*R,V+M*R)):(f.push(_-C*E,V-P*E),f.push(cs,vs),A+=dr(_,V,_-C*E,V-P*E,_-T*E,V-M*E,f,!1)+4,f.push(_-T*E,V-M*E),f.push(cs,vs)):(f.push(Ct,bt),f.push(cs,vs)):(f.push(_-C*E,V-P*E),f.push(_+C*R,V+P*R),a.join==="round"?he?A+=dr(_,V,_+C*R,V+P*R,_+T*R,V+M*R,f,!0)+2:A+=dr(_,V,_-C*E,V-P*E,_-T*E,V-M*E,f,!1)+2:a.join==="miter"&&qs/w<=x&&(he?(f.push(cs,vs),f.push(cs,vs)):(f.push(Ct,bt),f.push(Ct,bt)),A+=2),f.push(_-T*E,V-M*E),f.push(_+T*R,V+M*R),A+=2)}b=t[(m-2)*2],q=t[(m-2)*2+1],_=t[(m-1)*2],V=t[(m-1)*2+1],C=-(q-V),P=b-_,I=Math.sqrt(C*C+P*P),C/=I,P/=I,C*=y,P*=y,f.push(_-C*E,V-P*E),f.push(_+C*R,V+P*R),h||(a.cap==="round"?A+=dr(_-C*(E-R)*.5,V-P*(E-R)*.5,_-C*E,V-P*E,_+C*R,V+P*R,f,!1)+2:a.cap==="square"&&(A+=eA(_,V,C,P,E,R,!1,f)));const D=Zg*Zg;for(let F=g;F<A+g-2;++F)b=f[F*2],q=f[F*2+1],_=f[(F+1)*2],V=f[(F+1)*2+1],S=f[(F+2)*2],k=f[(F+2)*2+1],!(Math.abs(b*(V-k)+_*(k-q)+S*(q-V))<D)&&i.push(F,F+1,F+2)}function jM(t,e,s,r){const n=eV;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<n&&Math.abs(o-l)<n,u=s,h=t.length/2,d=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)r.push(d+f,d+f+1);c&&r.push(d+h-1,d)}function tV(t,e,s,r,n,i,o){const a=kT(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+n,i[o++]=a[c+1]+n,i[o++]=a[c+2]+n;let l=n*r;for(let c=0;c<t.length;c+=2)s[l]=t[c],s[l+1]=t[c+1],l+=r}const OM=[],BM={extension:{type:G.ShapeBuilder,name:"polygon"},build(t,e){for(let s=0;s<t.points.length;s++)e[s]=t.points[s];return!0},triangulate(t,e,s,r,n,i){tV(t,OM,e,s,r,n,i)}},NM={extension:{type:G.ShapeBuilder,name:"rectangle"},build(t,e){const s=t,r=s.x,n=s.y,i=s.width,o=s.height;return i>0&&o>0?(e[0]=r,e[1]=n,e[2]=r+i,e[3]=n,e[4]=r+i,e[5]=n+o,e[6]=r,e[7]=n+o,!0):!1},triangulate(t,e,s,r,n,i){let o=0;r*=s,e[r+o]=t[0],e[r+o+1]=t[1],o+=s,e[r+o]=t[2],e[r+o+1]=t[3],o+=s,e[r+o]=t[6],e[r+o+1]=t[7],o+=s,e[r+o]=t[4],e[r+o+1]=t[5],o+=s;const a=r/s;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},zM={extension:{type:G.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,!0},triangulate(t,e,s,r,n,i){let o=0;r*=s,e[r+o]=t[0],e[r+o+1]=t[1],o+=s,e[r+o]=t[2],e[r+o+1]=t[3],o+=s,e[r+o]=t[4],e[r+o+1]=t[5];const a=r/s;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},DM=new le,FM=new Ne;function LM(t,e,s,r){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const o=s.getBounds(FM);e.width&&o.pad(e.width);const{x:a,y:l}=o,c=1/o.width,u=1/o.height,h=-a*c,d=-l*u,f=n.a,m=n.b,A=n.c,g=n.d;n.a*=c,n.b*=c,n.c*=u,n.d*=u,n.tx=h*f+d*A+n.tx,n.ty=h*m+d*g+n.ty}else n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;return!(e.fill instanceof Ns)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),r&&n.append(DM.copyFrom(r).invert()),n}const Kl={};_t.handleByMap(G.ShapeBuilder,Kl);_t.add(NM,BM,zM,go,TM,MM);const UM=new Ne,$M=new le;function HM(t,e){const{geometryData:s,batches:r}=e;r.length=0,s.indices.length=0,s.vertices.length=0,s.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")WM(i.data,r,s);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&tA(c.shapePath,l,!0,r,s),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),tA(a,l,o,r,s)}}}function WM(t,e,s){const r=[],n=Kl.rectangle,i=UM;i.x=t.dx,i.y=t.dy,i.width=t.dw,i.height=t.dh;const o=t.transform;if(!n.build(i,r))return;const{vertices:a,uvs:l,indices:c}=s,u=c.length,h=a.length/2;o&&Jw(r,o),n.triangulate(r,a,2,h,c,u);const d=t.image,f=d.uvs;l.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const m=Ht.get(Zw);m.indexOffset=u,m.indexSize=c.length-u,m.attributeOffset=h,m.attributeSize=a.length/2-h,m.baseColor=t.style,m.alpha=t.alpha,m.texture=d,m.geometryData=s,e.push(m)}function tA(t,e,s,r,n){const{vertices:i,uvs:o,indices:a}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=[],d=Kl[l.type];if(!d.build(l,h))return;const f=a.length,m=i.length/2;let A="triangle-list";if(c&&Jw(h,c),s){const x=l.closePath??!0,b=e;b.pixelLine?(jM(h,x,i,a),A="line-list"):IM(h,b,!1,x,i,a)}else if(u){const x=[],b=h.slice();GM(u).forEach(_=>{x.push(b.length/2),b.push(..._)}),tV(b,x,i,2,m,a,f)}else d.triangulate(h,i,2,m,a,f);const g=o.length/2,y=e.texture;if(y!==ce.WHITE){const x=LM($M,e,l,c);CM(i,2,m,o,g,2,i.length/2-m,x)}else PM(o,g,2,i.length/2-m);const w=Ht.get(Zw);w.indexOffset=f,w.indexSize=a.length-f,w.attributeOffset=m,w.attributeSize=i.length/2-m,w.baseColor=e.color,w.alpha=e.alpha,w.texture=y,w.geometryData=n,w.topology=A,r.push(w)})}function GM(t){const e=[];for(let s=0;s<t.length;s++){const r=t[s].shape,n=[];Kl[r.type].build(r,n)&&e.push(n)}return e}class YM{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class KM{constructor(){this.instructions=new mw}init(e){const s=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(s):this.batcher=new kM({maxTextures:s}),this.instructions.reset()}get geometry(){return ve(ZP,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const yf=class Lh{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){Lh.defaultOptions.bezierSmoothness=e?.bezierSmoothness??Lh.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let s=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){s?this._cleanGraphicsContextData(e):s=this._initContext(e),HM(e,s);const r=e.batchMode;e.customShader||r==="no-batch"?s.isBatchable=!1:r==="auto"?s.isBatchable=s.geometryData.vertices.length<400:s.isBatchable=!0,e.dirty=!1}return s}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const s=Ht.get(KM,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:r,geometryData:n}=this._gpuContextHash[e.uid],i=n.vertices.length,o=n.indices.length;for(let u=0;u<r.length;u++)r[u].applyTransform=!1;const a=s.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let u=0;u<r.length;u++){const h=r[u];a.add(h)}a.finish(s.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=NT(h.textures.textures,h.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=s,s}_initContext(e){const s=new YM;return s.context=e,this._gpuContextHash[e.uid]=s,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const s=this._gpuContextHash[e.uid];s.isBatchable||this._graphicsDataContextHash[e.uid]&&(Ht.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),s.batches&&s.batches.forEach(r=>{Ht.return(r)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};yf.extension={type:[G.WebGLSystem,G.WebGPUSystem,G.CanvasSystem],name:"graphicsContext"};yf.defaultOptions={bezierSmoothness:.5};let sV=yf;const QM=8,_a=11920929e-14,XM=1;function rV(t,e,s,r,n,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??sV.defaultOptions.bezierSmoothness));let d=(XM-h)/1;return d*=d,JM(e,s,r,n,i,o,a,l,t,d),t}function JM(t,e,s,r,n,i,o,a,l,c){Uh(t,e,s,r,n,i,o,a,l,c,0),l.push(o,a)}function Uh(t,e,s,r,n,i,o,a,l,c,u){if(u>QM)return;const h=(t+s)/2,d=(e+r)/2,f=(s+n)/2,m=(r+i)/2,A=(n+o)/2,g=(i+a)/2,y=(h+f)/2,w=(d+m)/2,x=(f+A)/2,b=(m+g)/2,q=(y+x)/2,_=(w+b)/2;if(u>0){let V=o-t,S=a-e;const k=Math.abs((s-o)*S-(r-a)*V),C=Math.abs((n-o)*S-(i-a)*V);if(k>_a&&C>_a){if((k+C)*(k+C)<=c*(V*V+S*S)){l.push(q,_);return}}else if(k>_a){if(k*k<=c*(V*V+S*S)){l.push(q,_);return}}else if(C>_a){if(C*C<=c*(V*V+S*S)){l.push(q,_);return}}else if(V=q-(t+o)/2,S=_-(e+a)/2,V*V+S*S<=c){l.push(q,_);return}}Uh(t,e,h,d,y,w,q,_,l,c,u+1),Uh(q,_,x,b,A,g,o,a,l,c,u+1)}const ZM=8,eR=11920929e-14,tR=1;function sR(t,e,s,r,n,i,o,a){const c=Math.min(.99,Math.max(0,a??sV.defaultOptions.bezierSmoothness));let u=(tR-c)/1;return u*=u,rR(e,s,r,n,i,o,t,u),t}function rR(t,e,s,r,n,i,o,a){$h(o,t,e,s,r,n,i,a,0),o.push(n,i)}function $h(t,e,s,r,n,i,o,a,l){if(l>ZM)return;const c=(e+r)/2,u=(s+n)/2,h=(r+i)/2,d=(n+o)/2,f=(c+h)/2,m=(u+d)/2;let A=i-e,g=o-s;const y=Math.abs((r-i)*g-(n-o)*A);if(y>eR){if(y*y<=a*(A*A+g*g)){t.push(f,m);return}}else if(A=f-(e+i)/2,g=m-(s+o)/2,A*A+g*g<=a){t.push(f,m);return}$h(t,e,s,c,u,f,m,a,l+1),$h(t,f,m,h,d,i,o,a,l+1)}function nV(t,e,s,r,n,i,o,a){let l=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=n;c*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),m=e+d*r,A=s+f*r;t.push(m,A),u+=c}}function nR(t,e,s,r,n,i){const o=t[t.length-2],l=t[t.length-1]-s,c=o-e,u=n-s,h=r-e,d=Math.abs(l*h-c*u);if(d<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==s)&&t.push(e,s);return}const f=l*l+c*c,m=u*u+h*h,A=l*u+c*h,g=i*Math.sqrt(f)/d,y=i*Math.sqrt(m)/d,w=g*A/f,x=y*A/m,b=g*h+y*c,q=g*u+y*l,_=c*(y+w),V=l*(y+w),S=h*(g+x),k=u*(g+x),C=Math.atan2(V-q,_-b),P=Math.atan2(k-q,S-b);nV(t,b+e,q+s,i,C,P,c*u>h*l)}const Yi=Math.PI*2,pu={centerX:0,centerY:0,ang1:0,ang2:0},mu=({x:t,y:e},s,r,n,i,o,a,l)=>{t*=s,e*=r;const c=n*t-i*e,u=i*t+n*e;return l.x=c+o,l.y=u+a,l};function iR(t,e){const s=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=e===1.5707963267948966?.551915024494:s,n=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:n-i*r,y:i+n*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const sA=(t,e,s,r)=>{const n=t*r-e*s<0?-1:1;let i=t*s+e*r;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},oR=(t,e,s,r,n,i,o,a,l,c,u,h,d)=>{const f=Math.pow(n,2),m=Math.pow(i,2),A=Math.pow(u,2),g=Math.pow(h,2);let y=f*m-f*g-m*A;y<0&&(y=0),y/=f*g+m*A,y=Math.sqrt(y)*(o===a?-1:1);const w=y*n/i*h,x=y*-i/n*u,b=c*w-l*x+(t+s)/2,q=l*w+c*x+(e+r)/2,_=(u-w)/n,V=(h-x)/i,S=(-u-w)/n,k=(-h-x)/i,C=sA(1,0,_,V);let P=sA(_,V,S,k);a===0&&P>0&&(P-=Yi),a===1&&P<0&&(P+=Yi),d.centerX=b,d.centerY=q,d.ang1=C,d.ang2=P};function aR(t,e,s,r,n,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*Yi/360),h=Math.cos(a*Yi/360),d=h*(e-r)/2+u*(s-n)/2,f=-u*(e-r)/2+h*(s-n)/2;if(d===0&&f===0)return;i=Math.abs(i),o=Math.abs(o);const m=Math.pow(d,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(o,2);m>1&&(i*=Math.sqrt(m),o*=Math.sqrt(m)),oR(e,s,r,n,i,o,l,c,u,h,d,f,pu);let{ang1:A,ang2:g}=pu;const{centerX:y,centerY:w}=pu;let x=Math.abs(g)/(Yi/4);Math.abs(1-x)<1e-7&&(x=1);const b=Math.max(Math.ceil(x),1);g/=b;let q=t[t.length-2],_=t[t.length-1];const V={x:0,y:0};for(let S=0;S<b;S++){const k=iR(A,g),{x:C,y:P}=mu(k[0],i,o,h,u,y,w,V),{x:T,y:M}=mu(k[1],i,o,h,u,y,w,V),{x:I,y:z}=mu(k[2],i,o,h,u,y,w,V);rV(t,q,_,C,P,T,M,I,z),q=I,_=z,A+=g}}function lR(t,e,s){const r=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},n=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??s;if(l<=0){n(o,a),i=a;continue}const c=e[(o+1)%e.length],u=r(a,i),h=r(a,c);if(u.len<1e-4||h.len<1e-4){n(o,a),i=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,m=!0):d>0&&(f=-1,m=!0);const A=d/2;let g,y=Math.abs(Math.cos(A)*l/Math.sin(A));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),g=Math.abs(y*Math.sin(A)/Math.cos(A))):g=l;const w=a.x+h.nx*y+-h.ny*g*f,x=a.y+h.ny*y+h.nx*g*f,b=Math.atan2(u.ny,u.nx)+Math.PI/2*f,q=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&t.moveTo(w+Math.cos(b)*g,x+Math.sin(b)*g),t.arc(w,x,g,b,q,m),i=a}}function cR(t,e,s,r){const n=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??s;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],d=n(u,l);let f;if(d<1e-4)f=l;else{const g=Math.min(d/2,c);f=i(l,u,g/d)}const m=n(h,l);let A;if(m<1e-4)A=l;else{const g=Math.min(m/2,c);A=i(l,h,g/m)}a===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,A.x,A.y,r)}}const uR=new Ne;class hR{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new ss,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,s){return this.startPoly(e,s),this}lineTo(e,s){this._ensurePoly();const r=this._currentPoly.points,n=r[r.length-2],i=r[r.length-1];return(n!==e||i!==s)&&r.push(e,s),this}arc(e,s,r,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return nV(a,e,s,r,n,i,o),this}arcTo(e,s,r,n,i){this._ensurePoly();const o=this._currentPoly.points;return nR(o,e,s,r,n,i),this}arcToSvg(e,s,r,n,i,o,a){const l=this._currentPoly.points;return aR(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,s,r,n,i),this}bezierCurveTo(e,s,r,n,i,o,a){this._ensurePoly();const l=this._currentPoly;return rV(this._currentPoly.points,l.lastX,l.lastY,e,s,r,n,i,o,a),this}quadraticCurveTo(e,s,r,n,i){this._ensurePoly();const o=this._currentPoly;return sR(this._currentPoly.points,o.lastX,o.lastY,e,s,r,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,s){this.endPoly(),s&&!s.isIdentity()&&(e=e.clone(!0),e.transform(s));const r=this.shapePrimitives,n=r.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&r.length-n>1){let i=null;for(let o=n;o<r.length;o++){const a=r[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),r.copyWithin(o,o+1),r.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,s,r,n,i){return this.drawShape(new Ne(e,s,r,n),i),this}circle(e,s,r,n){return this.drawShape(new mf(e,s,r),n),this}poly(e,s,r){const n=new Wi(e);return n.closePath=s,this.drawShape(n,r),this}regularPoly(e,s,r,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=a-u*l;c.push(e+r*Math.cos(h),s+r*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,s,r,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,s,r,n,o);const l=r*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let d=0;d<n;d++){const f=d*u+c,m=e+r*Math.cos(f),A=s+r*Math.sin(f),g=f+Math.PI+h,y=f-Math.PI-h,w=m+i*Math.cos(g),x=A+i*Math.sin(g),b=m+i*Math.cos(y),q=A+i*Math.sin(y);d===0?this.moveTo(w,x):this.lineTo(w,x),this.quadraticCurveTo(m,A,b,q,a)}return this.closePath()}roundShape(e,s,r=!1,n){return e.length<3?this:(r?cR(this,e,s,n):lR(this,e,s),this.closePath())}filletRect(e,s,r,n,i){if(i===0)return this.rect(e,s,r,n);const o=Math.min(r,n)/2,a=Math.min(o,Math.max(-o,i)),l=e+r,c=s+n,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,s+h).arcTo(e+u,s+u,e+h,s,h).lineTo(l-h,s).arcTo(l-u,s+u,l,s+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+r-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,s,r,n,i,o){if(i<=0)return this.rect(e,s,r,n);const a=Math.min(i,Math.min(r,n)/2),l=e+r,c=s+n,u=[e+a,s,l-a,s,l,s+a,l,c-a,l-a,c,e+a,c,e,c-a,e,s+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,s,r,n,i){return this.drawShape(new gf(e,s,r,n),i),this}roundRect(e,s,r,n,i,o){return this.drawShape(new Af(e,s,r,n,i),o),this}drawShape(e,s){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:s}),this}startPoly(e,s){let r=this._currentPoly;return r&&this.endPoly(),r=new Wi,r.points.push(e,s),this._currentPoly=r,this}endPoly(e=!1){const s=this._currentPoly;return s&&s.points.length>2&&(s.closePath=e,this.shapePrimitives.push({shape:s})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Wi,e)){const s=this.shapePrimitives[this.shapePrimitives.length-1];if(s){let r=s.shape.x,n=s.shape.y;if(s.transform&&!s.transform.isIdentity()){const i=s.transform,o=r;r=i.a*r+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(r,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let s=0;s<e.instructions.length;s++){const r=e.instructions[s];this[r.action](...r.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const s=this.shapePrimitives;for(let r=0;r<s.length;r++){const n=s[r],i=n.shape.getBounds(uR);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class Os{constructor(e,s=!1){this.instructions=[],this.uid=ze("graphicsPath"),this._dirty=!0,this.checkForHoles=s,typeof e=="string"?IT(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new hR(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,s){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,s]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,s,r,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(lt.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,s,r,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,s,r){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(lt.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,s,r]}),this._dirty=!0,this}rect(e,s,r,n,i){return this.instructions.push({action:"rect",data:[e,s,r,n,i]}),this._dirty=!0,this}circle(e,s,r,n){return this.instructions.push({action:"circle",data:[e,s,r,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,s,r,n,i,o,a){i||(i=n/2);const l=-1*Math.PI/2+o,c=r*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?i:n,m=d*u+l;h.push(e+f*Math.cos(m),s+f*Math.sin(m))}return this.poly(h,!0,a),this}clone(e=!1){const s=new Os;if(s.checkForHoles=this.checkForHoles,!e)s.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const n=this.instructions[r];s.instructions.push({action:n.action,data:n.data.slice()})}return s}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const s=e.a,r=e.b,n=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,m=0,A=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],w=y.data;switch(y.action){case"moveTo":case"lineTo":l=w[0],c=w[1],w[0]=s*l+n*c+o,w[1]=r*l+i*c+a;break;case"bezierCurveTo":u=w[0],h=w[1],d=w[2],f=w[3],l=w[4],c=w[5],w[0]=s*u+n*h+o,w[1]=r*u+i*h+a,w[2]=s*d+n*f+o,w[3]=r*d+i*f+a,w[4]=s*l+n*c+o,w[5]=r*l+i*c+a;break;case"quadraticCurveTo":u=w[0],h=w[1],l=w[2],c=w[3],w[0]=s*u+n*h+o,w[1]=r*u+i*h+a,w[2]=s*l+n*c+o,w[3]=r*l+i*c+a;break;case"arcToSvg":l=w[5],c=w[6],m=w[0],A=w[1],w[0]=s*m+n*A,w[1]=r*m+i*A,w[5]=s*l+n*c+o,w[6]=r*l+i*c+a;break;case"circle":w[4]=Vi(w[3],e);break;case"rect":w[4]=Vi(w[4],e);break;case"ellipse":w[8]=Vi(w[8],e);break;case"roundRect":w[5]=Vi(w[5],e);break;case"addPath":w[0].transform(e);break;case"poly":w[2]=Vi(w[2],e);break;default:_e("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let s=this.instructions.length-1,r=this.instructions[s];if(!r)return e.x=0,e.y=0,e;for(;r.action==="closePath";){if(s--,s<0)return e.x=0,e.y=0,e;r=this.instructions[s]}switch(r.action){case"moveTo":case"lineTo":e.x=r.data[0],e.y=r.data[1];break;case"quadraticCurveTo":e.x=r.data[2],e.y=r.data[3];break;case"bezierCurveTo":e.x=r.data[4],e.y=r.data[5];break;case"arc":case"arcToSvg":e.x=r.data[5],e.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(e);break}return e}}function Vi(t,e){return t?t.prepend(e):e.clone()}function Me(t,e,s){const r=t.getAttribute(e);return r?Number(r):s}function dR(t,e){const s=t.querySelectorAll("defs");for(let r=0;r<s.length;r++){const n=s[r];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=fR(o);break;case"radialgradient":e.defs[o.id]=pR();break}}}}function fR(t){const e=Me(t,"x1",0),s=Me(t,"y1",0),r=Me(t,"x2",1),n=Me(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new Ns(e,s,r,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Me(l,"offset",0),u=ct.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function pR(t){return _e("[SVG Parser] Radial gradients are not yet supported"),new Ns(0,0,1,0)}function rA(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const nA={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function iV(t,e){const s=t.getAttribute("style"),r={},n={},i={strokeStyle:r,fillStyle:n,useFill:!1,useStroke:!1};for(const o in nA){const a=t.getAttribute(o);a&&iA(e,i,o,a.trim())}if(s){const o=s.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");nA[c]&&iA(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?r:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function iA(t,e,s,r){switch(s){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const n=rA(r);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=ct.shared.setValue(r).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const n=rA(r);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=ct.shared.setValue(r).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(r);break;case"stroke-opacity":e.strokeStyle.alpha=Number(r);break;case"opacity":e.fillStyle.alpha=Number(r),e.strokeStyle.alpha=Number(r);break}}function mR(t){if(t.length<=2)return!0;const e=t.map(a=>a.area).sort((a,l)=>l-a),[s,r]=e,n=e[e.length-1],i=s/r,o=r/n;return!(i>3&&o<2)}function gR(t){return t.split(/(?=[Mm])/).filter(r=>r.trim().length>0)}function AR(t){const e=t.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const s=e.map(Number),r=[],n=[];for(let u=0;u<s.length;u+=2)u+1<s.length&&(r.push(s[u]),n.push(s[u+1]));if(r.length===0||n.length===0)return 0;const i=Math.min(...r),o=Math.max(...r),a=Math.min(...n),l=Math.max(...n);return(o-i)*(l-a)}function oA(t,e){const s=new Os(t,!1);for(const r of s.instructions)e.instructions.push(r)}function yR(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const s={context:e,defs:{},path:new Os};dR(t,s);const r=t.children,{fillStyle:n,strokeStyle:i}=iV(t,s);for(let o=0;o<r.length;o++){const a=r[o];a.nodeName.toLowerCase()!=="defs"&&oV(a,s,n,i)}return e}function oV(t,e,s,r){const n=t.children,{fillStyle:i,strokeStyle:o}=iV(t,e);i&&s?s={...s,...i}:i&&(s=i),o&&r?r={...r,...o}:o&&(r=o);const a=!s&&!r;a&&(s={color:0});let l,c,u,h,d,f,m,A,g,y,w,x,b,q,_,V,S;switch(t.nodeName.toLowerCase()){case"path":{q=t.getAttribute("d");const k=t.getAttribute("fill-rule"),C=gR(q),P=k==="evenodd",T=C.length>1;if(P&&T){const I=C.map(E=>({path:E,area:AR(E)}));if(I.sort((E,R)=>R.area-E.area),C.length>3||!mR(I))for(let E=0;E<I.length;E++){const R=I[E],D=E===0;e.context.beginPath();const F=new Os(void 0,!0);oA(R.path,F),e.context.path(F),D?(s&&e.context.fill(s),r&&e.context.stroke(r)):e.context.cut()}else for(let E=0;E<I.length;E++){const R=I[E],D=E%2===1;e.context.beginPath();const F=new Os(void 0,!0);oA(R.path,F),e.context.path(F),D?e.context.cut():(s&&e.context.fill(s),r&&e.context.stroke(r))}}else{const I=k?k==="evenodd":!0;_=new Os(q,I),e.context.path(_),s&&e.context.fill(s),r&&e.context.stroke(r)}break}case"circle":m=Me(t,"cx",0),A=Me(t,"cy",0),g=Me(t,"r",0),e.context.ellipse(m,A,g,g),s&&e.context.fill(s),r&&e.context.stroke(r);break;case"rect":l=Me(t,"x",0),c=Me(t,"y",0),V=Me(t,"width",0),S=Me(t,"height",0),y=Me(t,"rx",0),w=Me(t,"ry",0),y||w?e.context.roundRect(l,c,V,S,y||w):e.context.rect(l,c,V,S),s&&e.context.fill(s),r&&e.context.stroke(r);break;case"ellipse":m=Me(t,"cx",0),A=Me(t,"cy",0),y=Me(t,"rx",0),w=Me(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,A,y,w),s&&e.context.fill(s),r&&e.context.stroke(r);break;case"line":u=Me(t,"x1",0),h=Me(t,"y1",0),d=Me(t,"x2",0),f=Me(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(d,f),r&&e.context.stroke(r);break;case"polygon":b=t.getAttribute("points"),x=b.match(/\d+/g).map(k=>parseInt(k,10)),e.context.poly(x,!0),s&&e.context.fill(s),r&&e.context.stroke(r);break;case"polyline":b=t.getAttribute("points"),x=b.match(/\d+/g).map(k=>parseInt(k,10)),e.context.poly(x,!1),r&&e.context.stroke(r);break;case"g":case"svg":break;default:{_e(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(s=null);for(let k=0;k<n.length;k++)oV(n[k],e,s,r)}function xR(t){return ct.isColorLike(t)}function aA(t){return t instanceof Yl}function lA(t){return t instanceof Ns}function bR(t){return t instanceof ce}function wR(t,e,s){const r=ct.shared.setValue(e??0);return t.color=r.toNumber(),t.alpha=r.alpha===1?s.alpha:r.alpha,t.texture=ce.WHITE,{...s,...t}}function VR(t,e,s){return t.texture=e,{...s,...t}}function cA(t,e,s){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...s,...t}}function uA(t,e,s){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...s,...t}}function qR(t,e){const s={...e,...t},r=ct.shared.setValue(s.color);return s.alpha*=r.alpha,s.color=r.toNumber(),s}function Cr(t,e){if(t==null)return null;const s={},r=t;return xR(t)?wR(s,t,e):bR(t)?VR(s,t,e):aA(t)?cA(s,t,e):lA(t)?uA(s,t,e):r.fill&&aA(r.fill)?cA(r,r.fill,e):r.fill&&lA(r.fill)?uA(r,r.fill,e):qR(r,e)}function Al(t,e){const{width:s,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...l}=e,c=Cr(t,l);return c?{width:s,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...c}:null}const vR=new lt,hA=new le,xf=class fs extends bs{constructor(){super(...arguments),this.uid=ze("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Os,this._transform=new le,this._fillStyle={...fs.defaultFillStyle},this._strokeStyle={...fs.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new ss,this._boundsDirty=!0}clone(){const e=new fs;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Cr(e,fs.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Al(e,fs.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Cr(e,fs.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Cr(e,fs.defaultStrokeStyle),this}texture(e,s,r,n,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:r||0,dy:n||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:s?ct.shared.setValue(s).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Os,this}fill(e,s){let r;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n?.action==="stroke"?r=n.data.path:r=this._activePath.clone(),r?(e!=null&&(s!==void 0&&typeof e=="number"&&(ve(at,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:s}),this._fillStyle=Cr(e,fs.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:s}=this._activePath.getLastPoint(lt.shared);this._activePath.clear(),this._activePath.moveTo(e,s)}stroke(e){let s;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="fill"?s=r.data.path:s=this._activePath.clone(),s?(e!=null&&(this._strokeStyle=Al(e,fs.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const s=this.instructions[this.instructions.length-1-e],r=this._activePath.clone();if(s&&(s.action==="stroke"||s.action==="fill"))if(s.data.hole)s.data.hole.addPath(r);else{s.data.hole=r;break}}return this._initNextPathLocation(),this}arc(e,s,r,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*s+a.tx,a.b*e+a.d*s+a.ty,r,n,i,o),this}arcTo(e,s,r,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*s+o.tx,o.b*e+o.d*s+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}arcToSvg(e,s,r,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,s,r,n,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,s,r,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*s+l.tx,l.b*e+l.d*s+l.ty,l.a*r+l.c*n+l.tx,l.b*r+l.d*n+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,s,r,n){return this._tick++,this._activePath.ellipse(e,s,r,n,this._transform.clone()),this}circle(e,s,r){return this._tick++,this._activePath.circle(e,s,r,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,s){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*e+r.c*s+r.tx,r.b*e+r.d*s+r.ty),this}moveTo(e,s){this._tick++;const r=this._transform,n=this._activePath.instructions,i=r.a*e+r.c*s+r.tx,o=r.b*e+r.d*s+r.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,s,r,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*s+o.tx,o.b*e+o.d*s+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}rect(e,s,r,n){return this._tick++,this._activePath.rect(e,s,r,n,this._transform.clone()),this}roundRect(e,s,r,n,i){return this._tick++,this._activePath.roundRect(e,s,r,n,i,this._transform.clone()),this}poly(e,s){return this._tick++,this._activePath.poly(e,s,this._transform.clone()),this}regularPoly(e,s,r,n,i=0,o){return this._tick++,this._activePath.regularPoly(e,s,r,n,i,o),this}roundPoly(e,s,r,n,i,o){return this._tick++,this._activePath.roundPoly(e,s,r,n,i,o),this}roundShape(e,s,r,n){return this._tick++,this._activePath.roundShape(e,s,r,n),this}filletRect(e,s,r,n,i){return this._tick++,this._activePath.filletRect(e,s,r,n,i),this}chamferRect(e,s,r,n,i,o){return this._tick++,this._activePath.chamferRect(e,s,r,n,i,o),this}star(e,s,r,n,i=0,o=0){return this._tick++,this._activePath.star(e,s,r,n,i,o,this._transform.clone()),this}svg(e){return this._tick++,yR(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,s=e){return this._transform.scale(e,s),this}setTransform(e,s,r,n,i,o){return e instanceof le?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,s,r,n,i,o),this)}transform(e,s,r,n,i,o){return e instanceof le?(this._transform.append(e),this):(hA.set(e,s,r,n,i,o),this._transform.append(hA),this)}translate(e,s=e){return this._transform.translate(e,s),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s],n=r.action;if(n==="fill"){const i=r.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=r.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=r.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const s=this.instructions;let r=!1;for(let n=0;n<s.length;n++){const i=s[n],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const d=c[u].transform,f=d?d.applyInverse(e,vR):e;if(i.action==="fill")r=h.contains(f.x,f.y);else{const A=l;r=h.strokeContains(f.x,f.y,A.width,A.alignment)}const m=o.hole;if(m){const A=m.shapePath?.shapePrimitives;if(A)for(let g=0;g<A.length;g++)A[g].shape.contains(f.x,f.y)&&(r=!1)}if(r)return!0}}return r}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(r)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(r))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};xf.defaultFillStyle={color:16777215,alpha:1,texture:ce.WHITE,matrix:null,fill:null,textureSpace:"local"};xf.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:ce.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Vr=xf;const bf=class fn extends bs{constructor(e={}){super(),this.uid=ze("textStyle"),this._tick=0,_R(e);const s={...fn.defaultTextStyle,...e};for(const r in s){const n=r;this[n]=s[r]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...fn.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...fn.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...Vr.defaultFillStyle,...e},()=>{this._fill=Cr({...this._originalFill},Vr.defaultFillStyle)})),this._fill=Cr(e===0?"black":e,Vr.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...Vr.defaultStrokeStyle,...e},()=>{this._stroke=Al({...this._originalStroke},Vr.defaultStrokeStyle)})),this._stroke=Al(e,Vr.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=fn.defaultTextStyle;for(const s in e)this[s]=e[s]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new fn({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let s=0;s<this._filters.length;s++)e+=this._filters[s].padding;return Math.max(this._padding,e)}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(r),this._originalFill?.texture&&this._originalFill.texture.destroy(r),this._stroke?.texture&&this._stroke.texture.destroy(r),this._originalStroke?.texture&&this._originalStroke.texture.destroy(r)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,s){return new Proxy(e,{set:(r,n,i)=>(r[n]===i||(r[n]=i,s?.(n,i),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(ct.isColorLike(e)||e instanceof Ns||e instanceof Yl)}};bf.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};bf.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let yl=bf;function _R(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const s=yl.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??s.alpha,angle:e.dropShadowAngle??s.angle,blur:e.dropShadowBlur??s.blur,color:e.dropShadowColor??s.color,distance:e.dropShadowDistance??s.distance}}if(e.strokeThickness!==void 0){ve(at,"strokeThickness is now a part of stroke");const s=e.stroke;let r={};if(ct.isColorLike(s))r.color=s;else if(s instanceof Ns||s instanceof Yl)r.fill=s;else if(Object.hasOwnProperty.call(s,"color")||Object.hasOwnProperty.call(s,"fill"))r=s;else throw new Error("Invalid stroke value.");t.stroke={...r,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(ve(at,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&_e("The number of fill colors must match the number of fill gradient stops.");const s=new Ns({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),r=e.fillGradientStops.slice(),n=e.fill.map(i=>ct.shared.setValue(i).toNumber());r.forEach((i,o)=>{s.addColorStop(i,n[o])}),t.fill={fill:s}}}class SR{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,s){const r=Ie.get().createCanvas();r.width=e,r.height=s;const n=r.getContext("2d");return{canvas:r,context:n}}getOptimalCanvasAndContext(e,s,r=1){e=Math.ceil(e*r-1e-6),s=Math.ceil(s*r-1e-6),e=dl(e),s=dl(s);const n=(e<<17)+(s<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,s)),i}returnCanvasAndContext(e){const s=e.canvas,{width:r,height:n}=s,i=(r<<17)+(n<<1);e.context.resetTransform(),e.context.clearRect(0,0,r,n),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const Hh=new SR;Hl.register(Hh);const dA=1e5;function fA(t,e,s,r=0){if(t.texture===ce.WHITE&&!t.fill)return ct.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof Yl){const n=t.fill,i=e.createPattern(n.texture.source.resource,"repeat"),o=n.transform.copyTo(le.shared);return o.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(o),i}else if(t.fill instanceof Ns){const n=t.fill,i=n.type==="linear",o=n.textureSpace==="local";let a=1,l=1;o&&s&&(a=s.width+r,l=s.height+r);let c,u=!1;if(i){const{start:h,end:d}=n;c=e.createLinearGradient(h.x*a,h.y*l,d.x*a,d.y*l),u=Math.abs(d.x-h.x)<Math.abs((d.y-h.y)*.1)}else{const{center:h,innerRadius:d,outerCenter:f,outerRadius:m}=n;c=e.createRadialGradient(h.x*a,h.y*l,d*a,f.x*a,f.y*l,m*a)}if(u&&o&&s){const h=s.lineHeight/l;for(let d=0;d<s.lines.length;d++){const f=(d*s.lineHeight+r/2)/l;n.colorStops.forEach(m=>{const A=f+m.offset*h;c.addColorStop(Math.floor(A*dA)/dA,ct.shared.setValue(m.color).toHex())})}}else n.colorStops.forEach(h=>{c.addColorStop(h.offset,ct.shared.setValue(h.color).toHex())});return c}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(le.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}return _e("FillStyle not recognised",t),"red"}const aV=class lV extends Lw{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const s={...lV.defaultOptions,...e};this._textureSize=s.textureSize,this._mipmap=s.mipmap;const r=s.style.clone();s.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=ce.WHITE,r._fill.fill=null),this.applyFillAsTint=s.overrideFill;const n=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const i=Dh(r);s.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/n):r.fontSize=this.baseRenderedFontSize=n,this._style=r,this._skipKerning=s.skipKerning??!1,this.resolution=s.resolution??1,this._padding=s.padding??4,s.textureStyle&&(this._textureStyle=s.textureStyle instanceof fl?s.textureStyle:new fl(s.textureStyle)),this.fontMetrics=$a.measureFont(i),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(e){const s=$a.graphemeSegmenter(e).filter(g=>!this._currentChars.includes(g)).filter((g,y,w)=>w.indexOf(g)===y);if(!s.length)return;this._currentChars=[...this._currentChars,...s];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:n,context:i}=r.canvasAndContext,o=r.texture.source;const a=this._style;let l=this._currentX,c=this._currentY,u=this._currentMaxCharHeight;const h=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*h;let f=!1;const m=n.width/this.resolution,A=n.height/this.resolution;for(let g=0;g<s.length;g++){const y=s[g],w=$a.measureText(y,a,n,!1);w.lineHeight=w.height;const x=w.width*h,b=Math.ceil((a.fontStyle==="italic"?2:1)*x),q=w.height*h,_=b+d*2,V=q+d*2;if(f=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(f=!0,u=Math.ceil(Math.max(V,u))),l+_>m&&(c+=u,u=V,l=0,c+u>A)){o.update();const k=this._nextPage();n=k.canvasAndContext.canvas,i=k.canvasAndContext.context,o=k.texture.source,l=0,c=0,u=0}const S=x/h-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:S,kerning:{}},f){this._drawGlyph(i,w,l+d,c+d,h,a);const k=o.width*h,C=o.height*h,P=new Ne(l/k*o.width,c/C*o.height,_/k*o.width,V/C*o.height);this.chars[y].texture=new ce({source:o,frame:P}),l+=Math.ceil(_)}}o.update(),this._currentX=l,this._currentY=c,this._currentMaxCharHeight=u,this._skipKerning&&this._applyKerning(s,i)}get pageTextures(){return ve(at,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,s){const r=this._measureCache;for(let n=0;n<e.length;n++){const i=e[n];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=r[i];l||(l=r[i]=s.measureText(i).width);let c=r[a];c||(c=r[a]=s.measureText(a).width);let u=s.measureText(i+a).width,h=u-(l+c);h&&(this.chars[i].kerning[a]=h),u=s.measureText(i+a).width,h=u-(l+c),h&&(this.chars[a].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,s=Hh.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(s.context,this._style,e);const r=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new ce({source:new zr({resource:s.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const i={canvasAndContext:s,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,s,r){s.fontSize=this.baseRenderedFontSize,e.scale(r,r),e.font=Dh(s),s.fontSize=this.baseMeasurementFontSize,e.textBaseline=s.textBaseline;const n=s._stroke,i=n?.width??0;if(n&&(e.lineWidth=i,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=fA(n,e)),s._fill&&(e.fillStyle=fA(s._fill,e)),s.dropShadow){const o=s.dropShadow,a=ct.shared.setValue(o.color).toArray(),l=o.blur*r,c=o.distance*r;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*c,e.shadowOffsetY=Math.sin(o.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,s,r,n,i,o){const a=s.text,l=s.fontProperties,u=(o._stroke?.width??0)*i,h=r+u/2,d=n-u/2,f=l.descent*i,m=s.lineHeight*i;let A=!1;o.stroke&&u&&(A=!0,e.strokeText(a,h,d+m-f));const{shadowBlur:g,shadowOffsetX:y,shadowOffsetY:w}=e;o._fill&&(A&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(a,h,d+m-f)),A&&(e.shadowBlur=g,e.shadowOffsetX=y,e.shadowOffsetY=w)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:s,texture:r}=this.pages[e];Hh.returnCanvasAndContext(s),r.destroy(!0)}this.pages=null}};aV.defaultOptions={textureSize:512,style:new yl,mipmap:!0};let pA=aV;function kR(t,e,s,r){const n={width:0,height:0,offsetY:0,scale:e.fontSize/s.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=s.baseLineOffset;let i=n.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=s.baseMeasurementFontSize/e.fontSize,u=e.letterSpacing*c,h=e.wordWrapWidth*c,d=e.lineHeight?e.lineHeight*c:s.lineHeight,f=e.wordWrap&&e.breakWords,m=y=>{const w=i.width;for(let x=0;x<l.index;x++){const b=y.positions[x];i.chars.push(y.chars[x]),i.charPositions.push(b+w)}i.width+=y.width,a=!1,l.width=0,l.index=0,l.chars.length=0},A=()=>{let y=i.chars.length-1;if(r){let w=i.chars[y];for(;w===" ";)i.width-=s.chars[w].xAdvance,w=i.chars[--y]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,n.lines.push(i),n.height+=d},g=y=>y-u>h;for(let y=0;y<t.length+1;y++){let w;const x=y===t.length;x||(w=t[y]);const b=s.chars[w]||s.chars[" "];if(/(?:\s)/.test(w)||w==="\r"||w===`
`||x){if(!a&&e.wordWrap&&g(i.width+l.width)?(A(),m(l),x||i.charPositions.push(0)):(l.start=i.width,m(l),x||i.charPositions.push(0)),w==="\r"||w===`
`)A();else if(!x){const S=b.xAdvance+(b.kerning[o]||0)+u;i.width+=S,i.spaceWidth=S,i.spacesIndex.push(i.charPositions.length),i.chars.push(w)}}else{const V=b.kerning[o]||0,S=b.xAdvance+V+u;f&&g(i.width+l.width+S)&&(m(l),A()),l.positions[l.index++]=l.width+V,l.chars.push(w),l.width+=S}o=w}return A(),e.align==="center"?CR(n):e.align==="right"?PR(n):e.align==="justify"&&ER(n),n}function CR(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],r=t.width/2-s.width/2;for(let n=0;n<s.charPositions.length;n++)s.charPositions[n]+=r}}function PR(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],r=t.width-s.width;for(let n=0;n<s.charPositions.length;n++)s.charPositions[n]+=r}}function ER(t){const e=t.width;for(let s=0;s<t.lines.length;s++){const r=t.lines[s];let n=0,i=r.spacesIndex[n++],o=0;const a=r.spacesIndex.length,c=(e-r.width)/a;for(let u=0;u<r.charPositions.length;u++)u===i&&(i=r.spacesIndex[n++],o+=c),r.charPositions[u]+=o}}function TR(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let s=0,r=t.length;s<r;s++){const n=t[s];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}let Sa=0;class MR{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=Uw(1e3)}getFont(e,s){let r=`${s.fontFamily}-bitmap`,n=!0;if(s._fill.fill&&!s._stroke?(r+=s._fill.fill.styleKey,n=!1):(s._stroke||s.dropShadow)&&(r=`${s.styleKey}-bitmap`,n=!1),!qe.has(r)){const o=Object.create(s);o.lineHeight=0;const a=new pA({style:o,overrideFill:n,overrideSize:!0,...this.defaultOptions});Sa++,Sa>50&&_e("BitmapText",`You have dynamically created ${Sa} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{Sa--,qe.remove(r)}),qe.set(r,a)}const i=qe.get(r);return i.ensureCharacters?.(e),i}getLayout(e,s,r=!0){const n=this.getFont(e,s),i=`${e}-${s.styleKey}-${r}`;if(this.measureCache.has(i))return this.measureCache.get(i);const o=$a.graphemeSegmenter(e),a=kR(o,s,n,r);return this.measureCache.set(i,a),a}measureText(e,s,r=!0){return this.getLayout(e,s,r)}install(...e){let s=e[0];typeof s=="string"&&(s={name:s,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},ve(at,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=s?.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");s={...this.defaultOptions,...s};const n=s.style,i=n instanceof yl?n:new yl(n),o=s.dynamicFill??this._canUseTintForStyle(i),a=new pA({style:i,overrideFill:o,skipKerning:s.skipKerning,padding:s.padding,resolution:s.resolution,overrideSize:!1,textureStyle:s.textureStyle}),l=TR(s.chars);return a.ensureCharacters(l.join("")),qe.set(`${r}-bitmap`,a),a.once("destroy",()=>qe.remove(`${r}-bitmap`)),a}uninstall(e){const s=`${e}-bitmap`,r=qe.get(s);r&&r.destroy()}_canUseTintForStyle(e){return!e._stroke&&(!e.dropShadow||e.dropShadow.color===0)&&!e._fill.fill&&e._fill.color===16777215}}const mA=new MR;class cV extends Lw{constructor(e,s){super();const{textures:r,data:n}=e;Object.keys(n.pages).forEach(i=>{const o=n.pages[parseInt(i,10)],a=r[o.id];this.pages.push({texture:a})}),Object.keys(n.chars).forEach(i=>{const o=n.chars[i],{frame:a,source:l,rotate:c}=r[o.page],u=xe.transformRectCoords(o,a,c,new Ne),h=new ce({frame:u,orig:new Ne(0,0,o.width,o.height),source:l,rotate:c});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:h}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=s}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:s}=this.pages[e];s.destroy(!0)}this.pages=null}static install(e){mA.install(e)}static uninstall(e){mA.uninstall(e)}}const gu={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const A in f){const g=f[A].split("="),y=g[0],w=g[1].replace(/"/gm,""),x=parseFloat(w),b=isNaN(x)?w:x;m[y]=b}s[d].push(m)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=s.info,[i]=s.common,[o]=s.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(n.size,10),r.fontFamily=n.face,r.lineHeight=parseInt(i.lineHeight,10);const a=s.page;for(let h=0;h<a.length;h++)r.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};r.baseLineOffset=r.lineHeight-parseInt(i.base,10);const c=s.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let m=d.letter??d.char??String.fromCharCode(f);m==="space"&&(m=" "),l[f]=m,r.chars[m]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=s.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),m=parseInt(u[h].amount,10);r.chars[l[f]].kerning[l[d]]=m}return r}},gA={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},s=t.getElementsByTagName("info")[0],r=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(s.getAttribute("size"),10),e.fontFamily=s.getAttribute("face"),e.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(r.getAttribute("base"),10);for(let c=0;c<o.length;c++){const u=o[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const u=parseInt(a[c].getAttribute("first"),10),h=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},AA={test(t){return typeof t=="string"&&t.match(/<font(\s|>)/)?gA.test(Ie.get().parseXML(t)):!1},parse(t){return gA.parse(Ie.get().parseXML(t))}},RR=[".xml",".fnt"],IR={extension:{type:G.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof cV,getCacheableAssets(t,e){const s={};return t.forEach(r=>{s[r]=e,s[`${r}-bitmap`]=e}),s[`${e.fontFamily}-bitmap`]=e,s}},jR={extension:{type:G.LoadParser,priority:ar.Normal},name:"loadBitmapFont",id:"bitmap-font",test(t){return RR.includes(Ot.extname(t).toLowerCase())},async testParse(t){return gu.test(t)||AA.test(t)},async parse(t,e,s){const r=gu.test(t)?gu.parse(t):AA.parse(t),{src:n}=e,{pages:i}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const d=i[h].file;let f=Ot.join(Ot.dirname(n),d);f=Ih(f,n),o.push({src:f,data:a})}const l=await s.load(o),c=o.map(h=>l[h.src]);return new cV({data:r,textures:c},n)},async load(t,e){return await(await Ie.get().fetch(t)).text()},async unload(t,e,s){await Promise.all(t.pages.map(r=>s.unload(r.texture.source._sourceOrigin))),t.destroy()}};class OR{constructor(e,s=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(e){e.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<s;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const BR={extension:{type:G.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof ce),getCacheableAssets:(t,e)=>{const s={};return t.forEach(r=>{e.forEach((n,i)=>{s[r+(i===0?"":i+1)]=n})}),s}};async function uV(t){if("Image"in globalThis)return new Promise(e=>{const s=new Image;s.onload=()=>{e(!0)},s.onerror=()=>{e(!1)},s.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const NR={extension:{type:G.DetectionParser,priority:1},test:async()=>uV("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},yA=["png","jpg","jpeg"],zR={extension:{type:G.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...yA],remove:async t=>t.filter(e=>!yA.includes(e))},DR="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ql(t){return DR?!1:document.createElement("video").canPlayType(t)!==""}const FR={extension:{type:G.DetectionParser,priority:0},test:async()=>Ql("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},LR={extension:{type:G.DetectionParser,priority:0},test:async()=>Ql("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},UR={extension:{type:G.DetectionParser,priority:0},test:async()=>Ql("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},$R={extension:{type:G.DetectionParser,priority:0},test:async()=>uV("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")},hV=class Ha{constructor(){this.loadOptions={...Ha.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,s,r)=>(this._parsersValidated=!1,e[s]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,s){const r={promise:null,parser:null};return r.promise=(async()=>{let n=null,i=null;if((s.parser||s.loadParser)&&(i=this._parserHash[s.parser||s.loadParser],s.loadParser&&_e(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),i||_e(`[Assets] specified load parser "${s.parser||s.loadParser}" not found while loading ${e}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,s,this)){i=a;break}}if(!i)return _e(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,s,this),r.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(n,s,this)&&(n=await a.parse(n,s,this)||n,r.parser=a)}return n})(),r}async load(e,s){this._parsersValidated||this._validateParsers();const r=typeof s=="function"?{...Ha.defaultOptions,...this.loadOptions,onProgress:s}:{...Ha.defaultOptions,...this.loadOptions,...s||{}},{onProgress:n,onError:i,strategy:o,retryCount:a,retryDelay:l}=r;let c=0;const u={},h=ml(e),d=Jt(e,A=>({alias:[A],src:A,data:{}})),f=d.reduce((A,g)=>A+(g.progressSize||1),0),m=d.map(async A=>{const g=Ot.toAbsolute(A.src);u[A.src]||(await this._loadAssetWithRetry(g,A,{onProgress:n,onError:i,strategy:o,retryCount:a,retryDelay:l},u),c+=A.progressSize||1,n&&n(c/f))});return await Promise.all(m),h?u[d[0].src]:u}async unload(e){const r=Jt(e,n=>({alias:[n],src:n})).map(async n=>{const i=Ot.toAbsolute(n.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,s)=>(!s.name&&!s.id?_e("[Assets] parser should have an id"):(e[s.name]||e[s.id])&&_e(`[Assets] parser id conflict "${s.id}"`),e[s.name]=s,s.id&&(e[s.id]=s),e),{})}async _loadAssetWithRetry(e,s,r,n){let i=0;const{onError:o,strategy:a,retryCount:l,retryDelay:c}=r,u=h=>new Promise(d=>setTimeout(d,h));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,s)),n[s.src]=await this.promiseCache[e].promise;return}catch(h){delete this.promiseCache[e],delete n[s.src],i++;const d=a!=="retry"||i>l;if(a==="retry"&&!d){o&&o(h,s),await u(c);continue}if(a==="skip"){o&&o(h,s);return}throw o&&o(h,s),new Error(`[Loader.load] Failed to load ${e}.
${h}`)}}};hV.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let HR=hV;function Zn(t,e){if(Array.isArray(e)){for(const s of e)if(t.startsWith(`data:${s}`))return!0;return!1}return t.startsWith(`data:${e}`)}function ei(t,e){const s=t.split("?")[0],r=Ot.extname(s).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const WR=".json",GR="application/json",YR={extension:{type:G.LoadParser,priority:ar.Low},name:"loadJson",id:"json",test(t){return Zn(t,GR)||ei(t,WR)},async load(t){return await(await Ie.get().fetch(t)).json()}},KR=".txt",QR="text/plain",XR={name:"loadTxt",id:"text",extension:{type:G.LoadParser,priority:ar.Low,name:"loadTxt"},test(t){return Zn(t,QR)||ei(t,KR)},async load(t){return await(await Ie.get().fetch(t)).text()}},JR=["normal","bold","100","200","300","400","500","600","700","800","900"],ZR=[".ttf",".otf",".woff",".woff2"],eI=["font/ttf","font/otf","font/woff","font/woff2"],tI=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function sI(t){const e=Ot.extname(t),n=Ot.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=n.length>0;for(const a of n)if(!a.match(tI)){i=!1;break}let o=n.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const rI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function nI(t){return rI.test(t)?t:encodeURI(t)}const iI={extension:{type:G.LoadParser,priority:ar.Low},name:"loadWebFont",id:"web-font",test(t){return Zn(t,eI)||ei(t,ZR)},async load(t,e){const s=Ie.get().getFontFaceSet();if(s){const r=[],n=e.data?.family??sI(t),i=e.data?.weights?.filter(a=>JR.includes(a))??["normal"],o=e.data??{};for(let a=0;a<i.length;a++){const l=i[a],c=new FontFace(n,`url(${nI(t)})`,{...o,weight:l});await c.load(),s.add(c),r.push(c)}return qe.has(`${n}-and-url`)?qe.get(`${n}-and-url`).entries.push({url:t,faces:r}):qe.set(`${n}-and-url`,{entries:[{url:t,faces:r}]}),r.length===1?r[0]:r}return _e("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){const e=Array.isArray(t)?t:[t],s=e[0].family,r=qe.get(`${s}-and-url`),n=r.entries.find(i=>i.faces.some(o=>e.indexOf(o)!==-1));n.faces=n.faces.filter(i=>e.indexOf(i)===-1),n.faces.length===0&&(r.entries=r.entries.filter(i=>i!==n)),e.forEach(i=>{Ie.get().getFontFaceSet().delete(i)}),r.entries.length===0&&qe.remove(`${s}-and-url`)}};function wf(t,e=1){const s=Jn.RETINA_PREFIX?.exec(t);return s?parseFloat(s[1]):e}function Vf(t,e,s){t.label=s,t._sourceOrigin=s;const r=new ce({source:t,label:s}),n=()=>{delete e.promiseCache[s],qe.has(s)&&qe.remove(s)};return r.source.once("destroy",()=>{e.promiseCache[s]&&(_e("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),r.once("destroy",()=>{t.destroyed||(_e("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),r}const oI=".svg",aI="image/svg+xml",lI={extension:{type:G.LoadParser,priority:ar.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return Zn(t,aI)||ei(t,oI)},async load(t,e,s){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?uI(t):cI(t,e,s,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function cI(t,e,s,r){const n=await Ie.get().fetch(t),i=Ie.get().createImage();i.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await n.text())}`,i.crossOrigin=r,await i.decode();const o=e.data?.width??i.width,a=e.data?.height??i.height,l=e.data?.resolution||wf(t),c=Math.ceil(o*l),u=Math.ceil(a*l),h=Ie.get().createCanvas(c,u),d=h.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(i,0,0,o*l,a*l);const{parseAsGraphicsContext:f,...m}=e.data??{},A=new zr({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:l,...m});return Vf(A,s,t)}async function uI(t){const s=await(await Ie.get().fetch(t)).text(),r=new Vr;return r.svg(s),r}const hI=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let wn=null,Wh=class{constructor(){wn||(wn=URL.createObjectURL(new Blob([hI],{type:"application/javascript"}))),this.worker=new Worker(wn)}};Wh.revokeObjectURL=function(){wn&&(URL.revokeObjectURL(wn),wn=null)};const dI=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Vn=null;class dV{constructor(){Vn||(Vn=URL.createObjectURL(new Blob([dI],{type:"application/javascript"}))),this.worker=new Worker(Vn)}}dV.revokeObjectURL=function(){Vn&&(URL.revokeObjectURL(Vn),Vn=null)};let xA=0,Au;class fI{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:s}=new Wh;s.addEventListener("message",r=>{s.terminate(),Wh.revokeObjectURL(),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,s){return this._run("loadImageBitmap",[e,s?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Au===void 0&&(Au=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Au&&(this._createdWorkers++,e=new dV().worker,e.addEventListener("message",s=>{this._complete(s.data),this._returnWorker(s.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),delete this._resolveHash[e.uuid])}async _run(e,s){await this._initWorkers();const r=new Promise((n,i)=>{this._queue.push({id:e,arguments:s,resolve:n,reject:i})});return this._next(),r}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const s=this._queue.pop(),r=s.id;this._resolveHash[xA]={resolve:s.resolve,reject:s.reject},e.postMessage({data:s.arguments,uuid:xA++,id:r})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const bA=new fI,pI=[".jpeg",".jpg",".png",".webp",".avif"],mI=["image/jpeg","image/png","image/webp","image/avif"];async function gI(t,e){const s=await Ie.get().fetch(t);if(!s.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${s.status} ${s.statusText}`);const r=await s.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const fV={name:"loadTextures",id:"texture",extension:{type:G.LoadParser,priority:ar.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Zn(t,mI)||ei(t,pI)},async load(t,e,s){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await bA.isImageBitmapSupported()?r=await bA.loadImageBitmap(t,e):r=await gI(t,e):r=await new Promise((i,o)=>{r=Ie.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=t,r.complete?i(r):(r.onload=()=>{i(r)},r.onerror=o)});const n=new zr({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||wf(t),...e.data});return Vf(n,s,t)},unload(t){t.destroy(!0)}},AI=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let yu,xu;function yI(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=bI(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}function xI(t){return new Promise((e,s)=>{t.addEventListener("canplaythrough",r),t.addEventListener("error",n),t.load();function r(){i(),e()}function n(o){i(),s(o)}function i(){t.removeEventListener("canplaythrough",r),t.removeEventListener("error",n)}})}function bI(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const s=new URL(t,document.baseURI);return s.hostname!==e.hostname||s.port!==e.port||s.protocol!==e.protocol?"anonymous":""}function wI(){const t=[],e=[];for(const s of AI){const r=Hi.MIME_TYPES[s.substring(1)]||`video/${s.substring(1)}`;Ql(r)&&(t.push(s),e.includes(r)||e.push(r))}return{validVideoExtensions:t,validVideoMime:e}}const VI={name:"loadVideo",id:"video",extension:{type:G.LoadParser,name:"loadVideo"},test(t){if(!yu||!xu){const{validVideoExtensions:r,validVideoMime:n}=wI();yu=r,xu=n}const e=Zn(t,xu),s=ei(t,yu);return e||s},async load(t,e,s){const r={...Hi.defaultOptions,resolution:e.data?.resolution||wf(t),alphaMode:e.data?.alphaMode||await _w(),...e.data},n=document.createElement("video"),i={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&n.setAttribute(l,c)}),r.muted===!0&&(n.muted=!0),yI(n,t,r.crossorigin);const o=document.createElement("source");let a;if(r.mime)a=r.mime;else if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=Hi.MIME_TYPES[l]||`video/${l}`}return o.src=t,a&&(o.type=a),new Promise(l=>{const c=async()=>{const u=new Hi({...r,resource:n});n.removeEventListener("canplay",c),e.data.preload&&await xI(n),l(Vf(u,s,t))};r.preload&&!r.autoPlay&&n.load(),n.addEventListener("canplay",c),n.appendChild(o)})},unload(t){t.destroy(!0)}},pV={extension:{type:G.ResolveParser,name:"resolveTexture"},test:fV.test,parse:t=>({resolution:parseFloat(Jn.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},qI={extension:{type:G.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Jn.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:pV.parse};class vI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Jn,this.loader=new HR,this.cache=qe,this._backgroundLoader=new OR(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){_e("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const s=e.texturePreference?.resolution??1,r=typeof s=="number"?[s]:s,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:r}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,s){this._initialized||await this.init();const r=ml(e),n=Jt(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,s);return r?o[n[0]]:o}addBundle(e,s){this.resolver.addBundle(e,s)}async loadBundle(e,s){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);let a=0;const l=[],c=()=>{s?.(l.reduce((h,d)=>h+d,0)/a)},u=o.map((h,d)=>{const f=n[h],m=Object.values(f),g=[...new Set(m.flat())].reduce((y,w)=>y+(w.progressSize||1),0);return l.push(0),a+=g,this._mapLoadToResolve(f,y=>{l[d]=y*g,c()}).then(y=>{i[h]=y})});return await Promise.all(u),r?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolveBundle(e);Object.values(s).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return qe.get(e);const s={};for(let r=0;r<e.length;r++)s[r]=qe.get(e[r]);return s}async _mapLoadToResolve(e,s){const r=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(r,s);this._backgroundLoader.active=!0;const i={};return r.forEach(o=>{const a=n[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(c=>{i[c]=a}),qe.set(l,a)}),i}async unload(e){this._initialized||await this.init();const s=Jt(e).map(n=>typeof n!="string"?n.src:n),r=this.resolver.resolve(s);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=Jt(e);const s=this.resolver.resolveBundle(e),r=Object.keys(s).map(n=>this._unloadFromResolved(s[n]));await Promise.all(r)}async _unloadFromResolved(e){const s=Object.values(e);s.forEach(r=>{qe.remove(r.src)}),await this.loader.unload(s)}async _detectFormats(e){let s=[];e.preferredFormats&&(s=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?s=await r.add(s):e.skipDetections||(s=await r.remove(s));return s=s.filter((r,n)=>s.indexOf(r)===n),s}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(r=>r in e).forEach(r=>{s.config[r]=e[r]})})}}const ji=new vI;_t.handleByList(G.LoadParser,ji.loader.parsers).handleByList(G.ResolveParser,ji.resolver.parsers).handleByList(G.CacheParser,ji.cache.parsers).handleByList(G.DetectionParser,ji.detections);_t.add(BR,zR,NR,$R,FR,LR,UR,YR,XR,iI,lI,fV,VI,jR,IR,pV,qI);const wA={loader:G.LoadParser,resolver:G.ResolveParser,cache:G.CacheParser,detection:G.DetectionParser};_t.handle(G.Asset,t=>{const e=t.ref;Object.entries(wA).filter(([s])=>!!e[s]).forEach(([s,r])=>_t.add(Object.assign(e[s],{extension:e[s].extension??r})))},t=>{const e=t.ref;Object.keys(wA).filter(s=>!!e[s]).forEach(s=>_t.remove(e[s]))});_t.add(UP,$P);const mV="/assets/sprites-BhC7gWu8.png";let Ki;const _I=async()=>{if(Ki!==void 0)return Ki;let t;try{t=await ji.load(mV)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=ce.EMPTY}const e=new jh(t,Rt);return await e.parse(),e.textureSource.scaleMode="nearest",Ki=e,e},SI=()=>{if(Ki===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Ki},kI=({className:t,children:e})=>t?p.jsx("div",{className:`contents ${t}`,children:e}):e,CI=t=>t.replaceAll(/(?<!\.)\./g,"_"),j=({children:t,className:e,noSlitWords:s,classnameCycle:r,onClick:n,noTint:i=!1,TagName:o="span",role:a})=>{const l=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(l.length===0)return null;const c=s?[l]:l.split(/\s+/);return p.jsxs(o,{className:e,onClick:n,children:[p.jsx("span",{className:"sr-only",children:l}),c.map((u,h)=>p.jsx("span",{className:et("text-nowrap inline-block [&>*]:align-top",h===c.length-1?"":"me-threeQuarters sprites-uppercase:me-1"),children:Array.from(u).map((d,f)=>{const m=`hud.char.${Wb(d)}`;return kh(m)||console.error("no texture for char",d,d.charCodeAt(0),m,"we have:",Object.keys(SI().textures)),p.jsx("span",{role:a,className:`sprite ${kh(m)?`texture-${CI(m)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${r===void 0?"":r[f%r.length]}`},f)})},h))]})},PI=t=>t.props.children!==void 0,ht=({children:t,className:e})=>p.jsx(kI,{className:e,children:Array.isArray(t)?t.map((s,r)=>p.jsx(ht,{children:s},r)):typeof t=="number"?p.jsx(j,{children:String(t)}):typeof t=="string"?p.jsx(j,{children:t}):v.isValidElement(t)?t.type===j||t.type===ht?t:PI(t)?v.cloneElement(t,void 0,typeof t.props.children=="string"?p.jsx(j,{children:`${t.props.children}`}):p.jsx(ht,{children:t.props.children})):t:t});var Xl=Ky();const EI=Ke(Xl),gV=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:s,deviceType:r=mt(),maximumCanvasUpscale:n})=>{const i=Qn[e],{renderAreaSize:o,rotate90:a}=r!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},l=Ox(o,s),c=Math.max(Math.floor(Math.min(l.x/i.size.x,l.y/i.size.y)),1),u=Math.min(n,c),h=c/u/s,d={x:Math.floor(l.x/c),y:Math.floor(l.y/c)},f={x:Math.ceil(o.x/h),y:Math.ceil(o.y/h)};return{gameEngineUpscale:u,cssUpscale:h,gameEngineScreenSize:d,canvasSize:f,rotate90:a}},TI=t=>mt()==="server"?Qn.zxSpectrum.size:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},AV=(t,e,s)=>{const r=mt();return{renderAreaSize:TI(s),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio,maximumCanvasUpscale:e.crtFilter?6:8}},MI={upscale:gV(AV(lo.displaySettings.emulatedResolution,lo.displaySettings))},xl=Es({name:"upscale",initialState:MI,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=gV(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:RI}=xl.actions,{selectCanvasSize:II,selectRot90:jI,selectUpscale:OI,selectGameEngineUpscale:h$,selectTotalUpscale:BI,selectGameEngineScreenSize:d$}=xl.selectors,Oo=()=>K(BI),qn=({children:t,scaleFactor:e})=>{const s=Oo();return p.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??s,"--block":`${(e??s)*8}px`},children:t})},De=({children:t})=>Xl.createPortal(p.jsx(qn,{children:t}),document.body),NI=({text:t})=>p.jsxs("div",{className:"flex flex-col h-full items-center justify-center gap-y-1",children:[p.jsx("span",{className:"sprite texture-animated-dalek"}),p.jsx(j,{children:t})]}),zI=()=>p.jsx("div",{className:"flex h-full items-center justify-center loading-border zx:zx-loading-border",role:"status","aria-label":"Loading",children:p.jsx("span",{className:"sprite texture-animated-head_walking_right","aria-hidden":!0})});var qi={},ka={},Ca={},VA;function DI(){if(VA)return Ca;VA=1,Ca.__esModule=!0,Ca.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var s={getItem:e,setItem:e,removeItem:e};function r(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function n(i){var o="".concat(i,"Storage");return r(o)?self[o]:s}return Ca}var qA;function FI(){if(qA)return ka;qA=1,ka.__esModule=!0,ka.default=s;var t=e(DI());function e(r){return r&&r.__esModule?r:{default:r}}function s(r){var n=(0,t.default)(r);return{getItem:function(o){return new Promise(function(a,l){a(n.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(n.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(n.removeItem(o))})}}}return ka}var vA;function LI(){if(vA)return qi;vA=1,qi.__esModule=!0,qi.default=void 0;var t=e(FI());function e(r){return r&&r.__esModule?r:{default:r}}var s=(0,t.default)("local");return qi.default=s,qi}var UI=LI();const $I=Ke(UI),Qe=t=>{const e=_h.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},HI=x_({1:Qe,2:Qe,3:Qe,4:Qe,5:Qe,6:Qe,7:Qe,8:Qe,9:Qe,10:Qe,11:Qe,12:Qe,13:Qe,14:Qe,15:Qe,16:Qe,17:Qe}),WI=["userSettings","savedGames"],GI=17,YI={key:"hohol/gameMenus/userSettings",version:GI,migrate:HI,storage:$I,whitelist:WI},KI=d_(YI,Io.reducer),QI={count:0},bl=Es({name:"manualLoading",initialState:QI,reducers:{manualLoadingStarted(t){t.count++},manualLoadingFinished(t){t.count=Math.max(0,t.count-1)}},selectors:{selectManualLoadingCount(t){return t.count}}}),{manualLoadingStarted:XI,manualLoadingFinished:_A}=bl.actions,{selectManualLoadingCount:JI}=bl.selectors,wl=(t,e,s,r)=>{t(RI(AV($l(e()),e().gameMenus.userSettings.displaySettings,r)))},ZI=()=>{mt()!=="server"&&Pd({actionCreator:lf,effect(t,{dispatch:e,getState:s}){wl(e,s)}})},ej=()=>{mt()!=="server"&&Pd({predicate(t,{gameMenus:{userSettings:{displaySettings:e}}},{gameMenus:{userSettings:{displaySettings:s}}}){return e!==s},effect(t,{dispatch:e,getState:s}){wl(e,s)}})},Gh=Q0({[Io.reducerPath]:KI,[xl.reducerPath]:xl.reducer,[Nr.reducerPath]:Nr.reducer,[bl.reducerPath]:bl.reducer}).withLazyLoadedSlices();Gh.inject;const tj=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?Gh(void 0,e):Gh(t,e),ue=m0({reducer:tj,middleware:t=>t({serializableCheck:{ignoredActions:[Td,Po,Md,Rd,Id,jd,nP.type]}}).prepend(Tx.middleware).concat(Nr.middleware)});typeof window<"u"&&(window._e2e_store=ue);ZI();ej();const sj=y_(ue),SA=t=>{let e=t.parentElement;for(;e!==null;){const{overflowY:s}=window.getComputedStyle(e);if(s==="scroll"||s==="auto")return e;e=e.parentElement}return null},rj=()=>({directionVector:Q,lookVector:{...Q},...Gn(Fx.map(t=>[t,!1]))}),bu={x:1,y:0,z:0},wu={x:-1,y:0,z:0},Vu={x:0,y:-1,z:0},qu={x:0,y:1,z:0},fe={away:qu,left:bu,right:wu,towards:Vu,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:mn(W(qu,wu)),towardsRight:mn(W(Vu,wu)),towardsLeft:mn(W(Vu,bu)),awayLeft:mn(W(qu,bu))},nj={left:{axis:"x",plane:"xy",direction:-1},right:{axis:"x",plane:"xy",direction:1},towards:{axis:"y",plane:"xy",direction:1},away:{axis:"y",plane:"xy",direction:-1},lookLeft:{axis:"xLook",plane:"look",direction:-1},lookRight:{axis:"xLook",plane:"look",direction:1},lookUp:{axis:"yLook",plane:"look",direction:1},lookDown:{axis:"yLook",plane:"look",direction:-1}},Yh=t=>nj[t],ij=Math.cos(13*(Math.PI/180)),Vl=-Math.PI/4,oj=t=>{const e=Math.cos(Vl),s=Math.sin(Vl);return{x:t.x*e-t.y*s,y:t.x*s+t.y*e,z:0}},aj=t=>{const e=Math.cos(Vl),s=Math.sin(Vl),r=t.x;return t.x=r*e-t.y*s,t.y=r*s+t.y*e,t};mn({x:1,y:2,z:0});mn({x:-1,y:2,z:0});const lj=t=>{const e=T_(t);return e===void 0?Q:fe[e]},cj=t=>{const e=Bd(t);return e===void 0?Q:fe[e]},uj=(t,e=ij)=>{const{x:s,y:r}=t,n=Math.sqrt(s*s+r*r);if(n===0)return Q;const i=s/n,o=r/n,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(s)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(r)*n,z:0};return t},hj={"4-way":lj,"8-way":cj,analogue:uj},dj=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(s=>({pressed:s.pressed})),axes:e.axes.map(s=>s)}),fj={lookLeft:fe.left,lookRight:fe.right,lookUp:fe.away,lookDown:fe.towards},pj=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}],mj=t=>{const e=Math.round((t+1)*3.5);return pj[e]??zx},gj=.2,Aj=45,yj=(t,e)=>!!t.keyboardState.has(e),yV=(t,e)=>{for(const s of t.gamepads)if(!(s===null||s.buttons.length<=e)&&s.buttons[e].pressed)return!0;return!1},ql=.5,xV=(t,e,s)=>{for(const r of t.gamepads)if(!(r===null||r.axes.length<=e)){if(s===void 0){if(Math.abs(r.axes[e])>ql)return!0}else if(r.axes[e]*s>ql)return!0}return!1},fr=(t,e,s=!0)=>{const r=hl(ue.getState()),n=r.presses[e];if(t.hudInputState[e])return!0;for(const o of n.keys)if(yj(t,o))return!0;for(const o of n.gamepadButtons)if(yV(t,o))return!0;const i=r.radialAxes?.xy??xn;for(const o of i){const a=Yh(e);if(a!==void 0&&a.plane==="xy")for(const l of t.gamepads){if(l===null||l.axes.length<=o)continue;const c=l.axes[o];if(mj(c)[a.axis]*a.direction>ql)return!0}}if(s){const o=Yh(e);if(o!==void 0){const a=r.axes[o.axis];for(const l of a)if(xV(t,l,o.direction))return!0}}return!1},kA=t=>{const e=Bx(t);return e>1?Gt(t,1/e):t},CA=(t,e)=>t?aj(e):e;class xj{constructor(e,s){this.keyboardStateMap=e,this.hudInputState=s}#e=[];#t=Q;#s=Q;#r=new Map;#n=()=>{const e=this.#e.at(0);if(e===void 0||fr(e,"lookShift",!1))return Q;let s,r,n,i;switch("tap"){case(s=this.currentActionPress("left")):return fe.left;case(r=this.currentActionPress("right")):return fe.right;case(n=this.currentActionPress("away")):return fe.away;case(i=this.currentActionPress("towards")):return fe.towards}const o=(s!=="released"?1:0)+(r!=="released"?1:0)+(n!=="released"?1:0)+(i!=="released"?1:0);if(o>1)return this.#t;if(o===1)switch("hold"){case s:return fe.left;case r:return fe.right;case n:return fe.away;case i:return fe.towards}return Q};*#i(e,s,r){for(const n of s)fr(e,n,!1)&&(yield r[n])}*#o(e,s,r,n,i){const o=hl(ue.getState()).axes,a=o[s],l=o[r];for(const c of e.gamepads){if(c===null)continue;let u=0,h=0;for(const f of a)c.axes.length<=f||(u+=c.axes[f]*n);for(const f of l)c.axes.length<=f||(h+=c.axes[f]*i);const d={x:u,y:h,z:0};Wn(d)>gj&&(yield d)}}#l(e){const s=this.#e.at(0);if(s===void 0||fr(s,"lookShift",!1))return Q;let r=[...this.#i(s,yn,fe)],n;if(r.length===1){const[c]=r,u=[...Ye(this.#e).drop(1).map(h=>[...this.#i(h,yn,fe)])];e:for(const h of u){if(h.length>2)break e;if(h.length===2&&h.some(d=>Od(d,c))){const d=h.find(f=>ol(f,c)<.001);if(d!==void 0){n=d;break e}}}if(!n)for(const h of u)h.length===0&&(r=xn)}const i=e==="screen",o=e==="screen"||e==="mixed",a=CA(i,W(...r)),l=CA(o,W(...this.#o(s,"x","y",-1,-1)));return W(n??Q,a,l)}#c(){const e=this.#e.at(0);if(e===void 0)return Q;const s=fr(e,"lookShift",!1);return kA(W(...this.#i(e,Dx,fj),...this.#o(e,"xLook","yLook",-1,-1),...s?this.#i(e,yn,fe):xn,...s?this.#o(e,"x","y",-1,-1):xn))}#a=({lastTime:e})=>{const s=rf(ue.getState()),r=hj[s];this.#t=kA(r(W(s==="4-way"?this.#n():this.#l(tf(ue.getState())),this.hudInputState.directionVector))),this.#s=this.#c();const n={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:dj(navigator.getGamepads()),atTime:e};this.#e.unshift(n);const i=e-Aj,o=this.#e.findIndex(a=>a.atTime<i);if(o!==-1&&this.#e.splice(o+1),this.#r.size>0){const a=performance.now();for(const[l,c]of this.#r)(!fr(n,l)||a>=c)&&this.#r.delete(l)}};currentActionPress(e){const s=this.#e.at(0);if(s===void 0||this.#r.has(e))return"released";if(fr(s,e)){const n=this.#e.at(1);return(n===void 0?!1:fr(n,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),s=this.#e.at(1);if(e!==void 0){for(const r of this.keyboardStateMap.keys())if(s===void 0||!s.keyboardState.has(r))return{type:"key",input:r};for(const r of e.gamepads)if(r!==null){for(const[n,i]of r.buttons.entries())if(i.pressed&&(s===void 0||!yV(s,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of r.axes.entries())if(Math.abs(i)>ql&&(s===void 0||!xV(s,n)))return{type:"gamepadAxes",input:n}}}}inputWasHandled(e,s=1/0){this.#r.set(e,performance.now()+s)}get directionVector(){return this.#t}get lookVector(){return this.#s}startTicking(){ft.shared.add(this.#a,void 0,pl.INTERACTION)}stopTicking(){ft.shared.remove(this.#a)}}const bj=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape",""],wj=t=>bj.includes(t);let Vj=1;const qj=()=>Vj++,vj=3,PA=({key:t,location:e,repeat:s})=>{if(s)return;const r=t.length===1?t.toUpperCase():t,n=e===vj&&!r.startsWith("Arrow")?`Numpad${r}`:r;if(wj(n))return n;console.warn("unrecognised key",t)},_j=()=>new Map,Sj=t=>{const e=n=>{const i=PA(n);i!==void 0&&t.set(i,qj())},s=n=>{const i=PA(n);i!==void 0&&t.delete(i)},r=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",s,!1),window.addEventListener("blur",r,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",s,!1),window.removeEventListener("blur",r,!1)}},bV=v.createContext(null),kj=({children:t})=>{const[e]=v.useState(_j),[s]=v.useState(()=>new xj(e,rj()));return v.useEffect(()=>{const r=Sj(e);return s.startTicking(),()=>{r(),s.stopTicking()}},[s,e]),p.jsx(bV,{value:s,children:t})},qf=()=>{const t=v.useContext(bV);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},Ve=({handler:t,action:e,disabled:s=!1})=>{const r=v.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=qf();v.useEffect(()=>{if(s)return;const i=()=>{for(const o of r)if(n.currentActionPress(o)==="tap"){if(!t(o))for(const c of r)n.inputWasHandled(c);break}};return ft.shared.add(i),()=>{ft.shared.remove(i)}},[r,s,n,t])},Cj=({handler:t,disabled:e=!1})=>{const s=qf();v.useEffect(()=>{if(e)return;const r=()=>{const n=s.inputTap();n!==void 0&&t(n,s)};return ft.shared.add(r),()=>{ft.shared.remove(r)}},[e,t,s])},In="data-menuitem_id",Wa="data-menuitem_hidden",Ga="data-menuitem_disabled",Pj="grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",wV=()=>{const t=document.body.querySelectorAll(`[${In}]`);return Array.from(t)},Ej=(t,e)=>{let s=t;for(;s!==null&&s!==e;){const{position:r}=window.getComputedStyle(s);if(r==="sticky")return s;s=s.parentElement}return null},EA=(t,e)=>{const s=t.firstChild,r=s.getBoundingClientRect().top,n=e??document.documentElement;return Ej(t,n)!==null?(e?.firstChild?.getBoundingClientRect().top??0)-s.getBoundingClientRect().height:r},on=(t,e)=>{const{gameMenus:{openMenus:[{focussedItemId:s}]}}=ue.getState();if(s===void 0)return!0;const r=wV();if(r.length<=1)return!0;const n=r.findIndex(c=>c.getAttribute(In)===s);if(n===-1)return!0;let i=n;const o=r[n],a=SA(o);switch(e){case"all":{for(i=t===-1?0:r.length-1;r[i].getAttribute(Wa)==="true"||r[i].getAttribute(Ga)==="true";)if(i+=t,i<0||i>=r.length)return!0;break}case"page":{const c=EA(o,a),u=a?.clientHeight??window.innerHeight,h=c+t*u;let d=n,f=1/0;for(let m=0;m<r.length;m++){if(m===n)continue;const A=r[m];if(A.getAttribute(Wa)==="true"||A.getAttribute(Ga)==="true")continue;const g=EA(A,a),y=Math.abs(g-h);(t===-1&&g<c||t===1&&g>c)&&y<f&&(f=y,d=m)}i=d;break}case"single":{do i=(i+t+r.length)%r.length;while(r[i].getAttribute(Wa)==="true"||r[i].getAttribute(Ga)==="true");break}}if(i===n)return!0;const l=r[i];return a!==SA(l)&&a?.scrollTo({top:0,behavior:"smooth"}),ue.dispatch(cf({focussedItemId:r[i].getAttribute(In),scrollableSelection:!0})),!1},Tj=t=>{const e=Ob();Ve({action:"away",handler:v.useCallback(()=>{if(t.current!==null)return on(-1,"single")},[t]),disabled:e}),Ve({action:"towards",handler:v.useCallback(()=>{if(t.current!==null)return on(1,"single")},[t]),disabled:e}),Ve({action:"pageUp",handler:v.useCallback(()=>{if(t.current!==null)return on(-1,"page")},[t]),disabled:e}),Ve({action:"pageDown",handler:v.useCallback(()=>{if(t.current!==null)return on(1,"page")},[t]),disabled:e}),Ve({action:"home",handler:v.useCallback(()=>{if(t.current!==null)return on(-1,"all")},[t]),disabled:e}),Ve({action:"end",handler:v.useCallback(()=>{if(t.current!==null)return on(1,"all")},[t]),disabled:e})},Ee=({className:t="",children:e,inline:s=!1})=>{const r=v.useRef(null);return v.useEffect(()=>{if(r.current===null||ue.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const n=wV(),i=n[0].getAttribute(In),o=i==="back"&&n.length>1?n[1].getAttribute(In):i;ue.dispatch(cf({focussedItemId:o,scrollableSelection:!0}))},[]),Tj(r),p.jsx("menu",{ref:r,className:et(s?"":Pj,t),children:e})};function N(t,e){const s=Fd();return v.useCallback(()=>{s(t(e))},[t,s,e])}const Mj=["menu_select","swop","jump"],Rj=()=>{},VV=({id:t,hidden:e=!1,disabled:s=!1,onSelect:r=Rj})=>{const n=v.useRef(!0),i=K(a=>a.gameMenus.openMenus.at(0)?.scrollableSelection??!1),o=K(a=>a.gameMenus.openMenus.at(0)?.focussedItemId===t);return Ve({action:Mj,handler:r,disabled:!o||e||s}),{menuItemProps:{[In]:t,[Wa]:e,[Ga]:s,onMouseMove:N(cf,{focussedItemId:t,scrollableSelection:!1}),onClick:s?void 0:r,tabIndex:0,role:"menuitem"},ref(a){o&&i&&a?.scrollIntoView({behavior:n.current?"instant":"smooth",block:"center"}),n.current=!1},focussed:o}},qV=({className:t})=>{const e=N(gt),{menuItemProps:s,ref:r,focussed:n}=VV({id:"back",onSelect:e});return p.jsxs("div",{...s,className:et("sprites-double-height flex flex-row gap-1 cursor-pointer "+(n?"selectedMenuItem":""),t),"data-to-parent-menu":!0,ref:r,children:[p.jsx(j,{className:"inline-block scale-x-[-1]",children:""}),p.jsx(j,{className:"inline-block",children:"Back"})]})},ws=({path:t=xn,className:e})=>{const s=t.at(-1);return p.jsxs("div",{className:et("flex flex-row sticky top-0 z-slightlyAbove py-oneScaledPix gap-2 pl-2",e),children:[p.jsx(Ee,{inline:!0,children:p.jsx(qV,{})}),p.jsxs("div",{className:"flex flex-row items-center",children:[t.slice(0,-1).map((r,n)=>p.jsxs("div",{className:"flex flex-row",children:[p.jsx(j,{className:"text-midGrey zx:text-pureBlack",children:r}),p.jsx(j,{className:"text-midRed zx:text-zxRedDimmed",children:""})]},n)),s&&p.jsx("div",{className:"flex flex-row sprites-double-height text-midRed zx:text-zxBlue",children:p.jsx(j,{TagName:"h1",children:s})})]})]})};var Ij=["second","minute","hour","day","week","month","year"];function jj(t,e){if(e===0)return["just now","right now"];var s=Ij[Math.floor(e/2)];return t>1&&(s+="s"),[t+" "+s+" ago","in "+t+" "+s]}var Oj=["","","","","","",""];function Bj(t,e){if(e===0)return["",""];var s=Oj[~~(e/2)];return[t+" "+s+"",t+" "+s+""]}var Kh={},vV=function(t,e){Kh[t]=e},Nj=function(t){return Kh[t]||Kh.en_US},vu=[60,60,24,7,365/7/12,12];function zj(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function Dj(t,e){var s=t<0?1:0;t=Math.abs(t);for(var r=t,n=0;t>=vu[n]&&n<vu.length;n++)t/=vu[n];return t=Math.floor(t),n*=2,t>(n===0?9:1)&&(n+=1),e(t,n,r)[s].replace("%s",t.toString())}function Fj(t,e){var s=new Date;return(+s-+zj(t))/1e3}var Lj=function(t,e,s){var r=Fj(t);return Dj(r,Nj(e))};vV("en_US",jj);vV("zh_CN",Bj);const Uj={"":v.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},TA=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),$j=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),_u=t=>t.replace(/^\s+|\s+$/g," "),$e=(t,e=[],s={})=>({t,c:Array.isArray(e)?e:[e],p:s}),Oi=(t,e=!1)=>{let s=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,r=0;const n=$e("");let i,o;e?(i=$e("p"),o=[n,i],n.c.push(i)):(i=n,o=[n]);let a;const l=(h,d=!0)=>(d&&o.push(h),i.c.push(h),d&&(i=h),h),c=h=>{const d=o.findIndex(f=>f.t===h);o=o.slice(0,d),i=o.at(-1)};for(;a=s.exec(t);){const h=t.substring(r,a.index);if(r=s.lastIndex,h!=="")if(i===n&&e){const d=$e("p",_u(h));n.c.push(d),o=[n,d],i=d}else i.c.push(_u(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const d=$e("pre",a[4]?TA(a[4]):$e("code",TA(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));n.c.push(d),o=[n],i=n}else if(a[6]){const d=a[6],f=d!==">",m=!!d.match(/\./),A=f?m?"ol":"ul":"blockquote",g=a[5].split(`
`).map(w=>w.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(w=>w.trim()!==""),y=$e(A,f?g.map(w=>$e("li",Oi(w).c)):Oi(g.join(`
`)).c);n.c.push(y),o=[n,y],i=n}else if(a[8]){const d=$e("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===n){const f=$e("p",d);n.c.push(f),i=f,o=[n,f]}else l(d,!1)}else if(a[10]){const d=o.find(f=>f.t==="a");d&&(d.p.href=a[11])}else if(a[9])l($e("a"));else if(a[14]){const d="h"+a[14].length;n.c.push($e(d,Oi(a[15]).c)),o=[n],i=n}else if(a[13])n.c.push($e("h1",Oi(a[12]).c)),o=[n],i=n;else if(a[16])l($e("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const m=n.c;let A;for(A=m.length-1;A>=0&&!$j(m[A]);A--);if(A!==n.c.length-1){const g=n.c.splice(A+1);n.c.push($e("p",g))}}const f=$e("p");n.c.push(f),o=[n,f],i=f}else if(a[1])n.c.push($e("hr")),o=[n],i=n;else if(a[17]){const d=a[17].length===2?"strong":"em";o.findIndex(m=>m.t===d)===-1?l($e(d)):c(d)}}}const u=_u(t.substring(r));if(u.length){const h=n.c.at(-1);let d;h?.t==="p"?d=h:e?(d=$e("p"),n.c.push(d)):d=n,d.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},Hj=(t,e={})=>{const s={...Uj,...e},r=(n,i=0)=>{const o=n.t===""?v.Fragment:s[n.t];return v.createElement(o,{...n.p,key:i},n.c.length===0?void 0:n.c.map((a,l)=>typeof a=="string"?a:r(a,l)))};return r(Oi(t,!0))},Wj=({markdown:t,customComponents:e})=>Hj(t,e),de="leading-none [--line-gap:1px] [&_[class*='texture-hud']]:mb-[calc(var(--scale)*var(--line-gap))]",Gj={h2:function({children:e}){return p.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${de}`,children:p.jsx(ht,{children:e})})},h3:function({children:e}){return p.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:p.jsx(ht,{children:e})})},blockquote:function({children:e}){return p.jsx("blockquote",{className:`${de} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:p.jsxs(ht,{children:["> ",e]})})},p:function({children:e}){return p.jsx("div",{className:`mb-1 last:mb-0 ${de}`,children:p.jsx(ht,{children:e})})},a:function({children:e,href:s}){return p.jsx("a",{className:"bitmap-text-link",href:s,target:"_blank",rel:"noopener noreferrer",children:p.jsx(ht,{children:e})})},li:function({children:e}){return p.jsx("div",{className:`mb-1 clear-both ${de}`,children:p.jsxs(ht,{children:[p.jsx(j,{className:"text-metallicBlue zx:text-zxYellow",children:""}),e]})})},strong:function({children:e}){return p.jsx(ht,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return p.jsx(ht,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const s=Oo();if(e===void 0)throw new Error("image without src");const r=e.split(/\?|&/);return p.jsx("span",{style:{"--scale":s*2},children:p.jsx("span",{className:et("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",r.join(" "))})})},hr:function(){return p.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},me=({markdown:t,className:e})=>p.jsx("div",{className:`contents ${e}`,children:p.jsx(Wj,{customComponents:Gj,markdown:t})});var Ft={},an={},ln={},MA;function Jl(){if(MA)return ln;MA=1;var t=ln&&ln.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ln,"__esModule",{value:!0});const s=t(Ln()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return ln.default=s,ln}var RA;function Yj(){if(RA)return an;RA=1;var t=an&&an.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(an,"__esModule",{value:!0});const e=t(Ln()),s=t(Ky()),r=t(Jl()),n=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(r.default),c=a[i],u=l[i];return c?u?s.default.createPortal(u(o),c,i):s.default.createPortal(o,c,i):null};return an.default=n,an}var cn={},IA;function Kj(){if(IA)return cn;IA=1;var t=cn&&cn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cn,"__esModule",{value:!0});const e=t(Ln()),s=t(Jl()),r=({id:n,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(s.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,o].filter(u=>!!u).join(" "),ref:c})};return cn.default=r,cn}var $s={},jA;function Qj(){if(jA)return $s;jA=1;var t=$s&&$s.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=$s&&$s.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($s,"__esModule",{value:!0});const s=e(Ln()),r=e(Jl()),n=({children:i})=>{const[o,a]=s.default.useState({}),[l,c]=s.default.useState({}),u=s.default.useCallback((f,m,A)=>{a(g=>Object.assign(Object.assign({},g),{[f]:m})),c(g=>Object.assign(Object.assign({},g),{[f]:A}))},[]),h=s.default.useCallback(f=>{a(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])}),c(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])})},[]),d=s.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return s.default.createElement(r.default.Provider,{value:d},i)};return $s.default=n,$s}var OA;function Xj(){if(OA)return Ft;OA=1;var t=Ft&&Ft.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Context=Ft.Placeholder=Ft.Provider=void 0;const e=t(Yj()),s=t(Kj()),r=t(Qj()),n=t(Jl());Ft.Provider=r.default,Ft.Placeholder=s.default,Ft.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=s.default,i.Provider=r.default,Ft.default=i,Ft}var Jj=Xj();const Zl=Ke(Jj),Zj=({flip:t=!1,focussed:e=!1,verticalAlignItemsCentre:s=!1})=>p.jsx(j,{className:"inline-block col-start-1 w-min ml-auto "+(t?"scale-x-[-1] relative bottom-oneScaledPix":"")+(s===!0?"flex items-center h-3":""),children:e?"":""}),eO=["menu_select","swop","jump"],tO=()=>{},L=({id:t,label:e,valueElement:s,flipLeader:r=!1,doubleHeight:n=!1,doubleHeightWhenFocussed:i,onSelect:o=tO,hidden:a=!1,disabled:l=!1,hintInline:c=!1,className:u,hint:h,leader:d,verticalAlignItemsCentre:f=!1,opensSubMenu:m=!1,toParentMenu:A=!1})=>{const{menuItemProps:g,ref:y,focussed:w}=VV({id:t,hidden:a,disabled:l,onSelect:o});Ve({action:eO,handler:o,disabled:!w||a||l});const x=p.jsxs("li",{...g,"data-opens-submenu":m,"data-to-parent-menu":A,className:et("contents cursor-pointer",a?"hidden":"",n||i&&w?"sprites-double-height":"",w?"selectedMenuItem":"",u),children:[d||p.jsx(Zj,{verticalAlignItemsCentre:f,flip:r,focussed:w}),p.jsx("div",{ref:y,className:et(s===void 0?"col-span-2":"",f===!0?"flex items-center":""),children:typeof e=="string"?p.jsx(p.Fragment,{children:p.jsx(j,{children:e})}):e}),s&&p.jsx("div",{className:`flex ${f===!0?"items-center":""}`,children:s}),!w||h===void 0||c?null:p.jsx(Zl,{children:typeof h=="string"?p.jsx(j,{className:de,children:h}):h})]});return c&&h?p.jsxs(p.Fragment,{children:[x,p.jsx("div",{className:"col-span-2 col-start-2 mb-1",children:h})]}):x},Ya="text-lightGrey zx:text-zxWhite sprites-normal-height",sO=({userId:t,campaignName:e,label:s,version:r,createdAt:n})=>p.jsx(L,{className:"sprites-double-height",id:`campaign-${t}-${e}`,label:s,doubleHeightWhenFocussed:!0,onSelect:N(co,{campaignLocator:{userId:t,campaignName:e,version:-1}}),hintInline:!0,hint:p.jsx(me,{className:Ya,markdown:` v.${r} updated ${Lj(n)}`})}),rO=({campaigns:t})=>p.jsx(p.Fragment,{children:p.jsx("div",{className:"zx:text-zxCyan  resHandheld:mt-half flex flex-col gap-2",children:Object.values(t).flatMap(e=>p.jsxs("div",{className:"flex flex-col gap-half",children:[p.jsxs(j,{className:"text-metallicBlue zx:text-zxYellow pl-4 sprites-double-height",children:["By ",e.user.username,":"]}),Object.values(e.campaigns).map(s=>p.jsx(p.Fragment,{children:p.jsx(Ee,{children:p.jsx(sO,{userId:e.user.id,campaignName:s.name,label:`'${s.name}'`,version:s.version,createdAt:s.created_at})})},s.name))]},e.user.id))})}),nO=t=>{const{data:e,error:s,isLoading:r,refetch:n}=IC({publishedOnly:!0});return v.useEffect(()=>{n()},[n]),p.jsx(De,{children:p.jsxs(Se,{fullScreen:!0,className:"bg-metallicBlueHalfbrite text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white zx:bg-zxRed gap-y-2 resHandheld:gap-y-1",dialogId:"communityGames",children:[p.jsx(ws,{path:["Play","Community contrib."],className:"mobile:px-4"}),p.jsxs("div",{className:"flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-lightGrey scrollbar-track-metallicBlueHalfbrite zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3 [--leader-col-width:theme(width.3)] ",children:[s!==void 0?p.jsx(NI,{text:"Failed to load campaigns"}):null,r?p.jsx(zI,{}):null,e!==void 0?p.jsx(rO,{campaigns:e}):null]})]})})},iO=t=>{const{queries:e}=t[Nr.reducerPath],{mutations:s}=t[Nr.reducerPath],r=Object.values(e??{}).some(o=>o?.status==="pending"),n=Object.values(s??{}).some(o=>o?.status==="pending"),i=JI(t)>0;return r||n||i},_V=sb(iO),At=({className:t,onClick:e})=>_V()?p.jsx(Hq,{}):p.jsx("div",{className:`fixed inset-0 z-border ${t??""}`,onClick:e});function SV(t){var e,s,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(s=SV(t[e]))&&(r&&(r+=" "),r+=s)}else for(s in t)t[s]&&(r&&(r+=" "),r+=s);return r}function vf(){for(var t,e,s=0,r="",n=arguments.length;s<n;s++)(t=arguments[s])&&(e=SV(t))&&(r&&(r+=" "),r+=e);return r}function _f(...t){return et(vf(t))}const oO=t=>t.replace(/ArrowLeft/g,"").replace(/ArrowRight/g,"").replace(/ArrowUp/g,"").replace(/ArrowDown/g,""),BA=t=>{const e=t.map(oO);return e.length===1?`

key: **${e[0]}**`:`

keys: ${e.map(s=>`**${s}**`).join(" or ")}`},Sf=(t,e)=>e?t?`${t}${BA(e)}`:BA(e):t;function Ms(t,e,{checkForDefaultPrevented:s=!0}={}){return function(n){if(t?.(n),s===!1||!n.defaultPrevented)return e?.(n)}}function NA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function kV(...t){return e=>{let s=!1;const r=t.map(n=>{const i=NA(n,e);return!s&&typeof i=="function"&&(s=!0),i});if(s)return()=>{for(let n=0;n<r.length;n++){const i=r[n];typeof i=="function"?i():NA(t[n],null)}}}}function Hr(...t){return v.useCallback(kV(...t),t)}function CV(t,e=[]){let s=[];function r(i,o){const a=v.createContext(o),l=s.length;s=[...s,o];const c=h=>{const{scope:d,children:f,...m}=h,A=d?.[t]?.[l]||a,g=v.useMemo(()=>m,Object.values(m));return p.jsx(A.Provider,{value:g,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,m=v.useContext(f);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const n=()=>{const i=s.map(o=>v.createContext(o));return function(a){const l=a?.[t]||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return n.scopeName=t,[r,aO(n,...e)]}function aO(...t){const e=t[0];if(t.length===1)return e;const s=()=>{const r=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return s.scopeName=e.scopeName,s}function lO(t){const e=cO(t),s=v.forwardRef((r,n)=>{const{children:i,...o}=r,a=v.Children.toArray(i),l=a.find(hO);if(l){const c=l.props.children,u=a.map(h=>h===l?v.Children.count(c)>1?v.Children.only(null):v.isValidElement(c)?c.props.children:null:h);return p.jsx(e,{...o,ref:n,children:v.isValidElement(c)?v.cloneElement(c,void 0,u):null})}return p.jsx(e,{...o,ref:n,children:i})});return s.displayName=`${t}.Slot`,s}function cO(t){const e=v.forwardRef((s,r)=>{const{children:n,...i}=s;if(v.isValidElement(n)){const o=fO(n),a=dO(i,n.props);return n.type!==v.Fragment&&(a.ref=r?kV(r,o):o),v.cloneElement(n,a)}return v.Children.count(n)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var PV=Symbol("radix.slottable");function uO(t){const e=({children:s})=>p.jsx(p.Fragment,{children:s});return e.displayName=`${t}.Slottable`,e.__radixId=PV,e}function hO(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===PV}function dO(t,e){const s={...e};for(const r in e){const n=t[r],i=e[r];/^on[A-Z]/.test(r)?n&&i?s[r]=(...a)=>{const l=i(...a);return n(...a),l}:n&&(s[r]=n):r==="style"?s[r]={...n,...i}:r==="className"&&(s[r]=[n,i].filter(Boolean).join(" "))}return{...t,...s}}function fO(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning;return s?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var pO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],lr=pO.reduce((t,e)=>{const s=lO(`Primitive.${e}`),r=v.forwardRef((n,i)=>{const{asChild:o,...a}=n,l=o?s:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function mO(t,e){t&&Xl.flushSync(()=>t.dispatchEvent(e))}function ec(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...s)=>e.current?.(...s),[])}function gO(t,e=globalThis?.document){const s=ec(t);v.useEffect(()=>{const r=n=>{n.key==="Escape"&&s(n)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[s,e])}var AO="DismissableLayer",Qh="dismissableLayer.update",yO="dismissableLayer.pointerDownOutside",xO="dismissableLayer.focusOutside",zA,EV=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),TV=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:r,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=v.useContext(EV),[u,h]=v.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=v.useState({}),m=Hr(e,V=>h(V)),A=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=A.indexOf(g),w=u?A.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,b=w>=y,q=VO(V=>{const S=V.target,k=[...c.branches].some(C=>C.contains(S));!b||k||(n?.(V),o?.(V),V.defaultPrevented||a?.())},d),_=qO(V=>{const S=V.target;[...c.branches].some(C=>C.contains(S))||(i?.(V),o?.(V),V.defaultPrevented||a?.())},d);return gO(V=>{w===c.layers.size-1&&(r?.(V),!V.defaultPrevented&&a&&(V.preventDefault(),a()))},d),v.useEffect(()=>{if(u)return s&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(zA=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),DA(),()=>{s&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=zA)}},[u,d,s,c]),v.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),DA())},[u,c]),v.useEffect(()=>{const V=()=>f({});return document.addEventListener(Qh,V),()=>document.removeEventListener(Qh,V)},[]),p.jsx(lr.div,{...l,ref:m,style:{pointerEvents:x?b?"auto":"none":void 0,...t.style},onFocusCapture:Ms(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Ms(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Ms(t.onPointerDownCapture,q.onPointerDownCapture)})});TV.displayName=AO;var bO="DismissableLayerBranch",wO=v.forwardRef((t,e)=>{const s=v.useContext(EV),r=v.useRef(null),n=Hr(e,r);return v.useEffect(()=>{const i=r.current;if(i)return s.branches.add(i),()=>{s.branches.delete(i)}},[s.branches]),p.jsx(lr.div,{...t,ref:n})});wO.displayName=bO;function VO(t,e=globalThis?.document){const s=ec(t),r=v.useRef(!1),n=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){MV(yO,s,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=l,e.addEventListener("click",n.current,{once:!0})):l()}else e.removeEventListener("click",n.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",n.current)}},[e,s]),{onPointerDownCapture:()=>r.current=!0}}function qO(t,e=globalThis?.document){const s=ec(t),r=v.useRef(!1);return v.useEffect(()=>{const n=i=>{i.target&&!r.current&&MV(xO,s,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,s]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function DA(){const t=new CustomEvent(Qh);document.dispatchEvent(t)}function MV(t,e,s,{discrete:r}){const n=s.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:s});e&&n.addEventListener(t,e,{once:!0}),r?mO(n,i):n.dispatchEvent(i)}var sr=globalThis?.document?v.useLayoutEffect:()=>{},vO=dd[" useId ".trim().toString()]||(()=>{}),_O=0;function SO(t){const[e,s]=v.useState(vO());return sr(()=>{s(r=>r??String(_O++))},[t]),e?`radix-${e}`:""}const kO=["top","right","bottom","left"],rr=Math.min,It=Math.max,vl=Math.round,Pa=Math.floor,gs=t=>({x:t,y:t}),CO={left:"right",right:"left",bottom:"top",top:"bottom"},PO={start:"end",end:"start"};function Xh(t,e,s){return It(t,rr(e,s))}function zs(t,e){return typeof t=="function"?t(e):t}function Ds(t){return t.split("-")[0]}function ti(t){return t.split("-")[1]}function kf(t){return t==="x"?"y":"x"}function Cf(t){return t==="y"?"height":"width"}function nr(t){return["top","bottom"].includes(Ds(t))?"y":"x"}function Pf(t){return kf(nr(t))}function EO(t,e,s){s===void 0&&(s=!1);const r=ti(t),n=Pf(t),i=Cf(n);let o=n==="x"?r===(s?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=_l(o)),[o,_l(o)]}function TO(t){const e=_l(t);return[Jh(t),e,Jh(e)]}function Jh(t){return t.replace(/start|end/g,e=>PO[e])}function MO(t,e,s){const r=["left","right"],n=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return s?e?n:r:e?r:n;case"left":case"right":return e?i:o;default:return[]}}function RO(t,e,s,r){const n=ti(t);let i=MO(Ds(t),s==="start",r);return n&&(i=i.map(o=>o+"-"+n),e&&(i=i.concat(i.map(Jh)))),i}function _l(t){return t.replace(/left|right|bottom|top/g,e=>CO[e])}function IO(t){return{top:0,right:0,bottom:0,left:0,...t}}function RV(t){return typeof t!="number"?IO(t):{top:t,right:t,bottom:t,left:t}}function Sl(t){const{x:e,y:s,width:r,height:n}=t;return{width:r,height:n,top:s,left:e,right:e+r,bottom:s+n,x:e,y:s}}function FA(t,e,s){let{reference:r,floating:n}=t;const i=nr(e),o=Pf(e),a=Cf(o),l=Ds(e),c=i==="y",u=r.x+r.width/2-n.width/2,h=r.y+r.height/2-n.height/2,d=r[a]/2-n[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-n.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:h};break;case"left":f={x:r.x-n.width,y:h};break;default:f={x:r.x,y:r.y}}switch(ti(e)){case"start":f[o]-=d*(s&&c?-1:1);break;case"end":f[o]+=d*(s&&c?-1:1);break}return f}const jO=async(t,e,s)=>{const{placement:r="bottom",strategy:n="absolute",middleware:i=[],platform:o}=s,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:h}=FA(c,r,l),d=r,f={},m=0;for(let A=0;A<a.length;A++){const{name:g,fn:y}=a[A],{x:w,y:x,data:b,reset:q}=await y({x:u,y:h,initialPlacement:r,placement:d,strategy:n,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=w??u,h=x??h,f={...f,[g]:{...f[g],...b}},q&&m<=50&&(m++,typeof q=="object"&&(q.placement&&(d=q.placement),q.rects&&(c=q.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:n}):q.rects),{x:u,y:h}=FA(c,d,l)),A=-1)}return{x:u,y:h,placement:d,strategy:n,middlewareData:f}};async function Ao(t,e){var s;e===void 0&&(e={});const{x:r,y:n,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=zs(e,t),m=RV(f),g=a[d?h==="floating"?"reference":"floating":h],y=Sl(await i.getClippingRect({element:(s=await(i.isElement==null?void 0:i.isElement(g)))==null||s?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=h==="floating"?{x:r,y:n,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},q=Sl(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:x,strategy:l}):w);return{top:(y.top-q.top+m.top)/b.y,bottom:(q.bottom-y.bottom+m.bottom)/b.y,left:(y.left-q.left+m.left)/b.x,right:(q.right-y.right+m.right)/b.x}}const OO=t=>({name:"arrow",options:t,async fn(e){const{x:s,y:r,placement:n,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=zs(t,e)||{};if(c==null)return{};const h=RV(u),d={x:s,y:r},f=Pf(n),m=Cf(f),A=await o.getDimensions(c),g=f==="y",y=g?"top":"left",w=g?"bottom":"right",x=g?"clientHeight":"clientWidth",b=i.reference[m]+i.reference[f]-d[f]-i.floating[m],q=d[f]-i.reference[f],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let V=_?_[x]:0;(!V||!await(o.isElement==null?void 0:o.isElement(_)))&&(V=a.floating[x]||i.floating[m]);const S=b/2-q/2,k=V/2-A[m]/2-1,C=rr(h[y],k),P=rr(h[w],k),T=C,M=V-A[m]-P,I=V/2-A[m]/2+S,z=Xh(T,I,M),E=!l.arrow&&ti(n)!=null&&I!==z&&i.reference[m]/2-(I<T?C:P)-A[m]/2<0,R=E?I<T?I-T:I-M:0;return{[f]:d[f]+R,data:{[f]:z,centerOffset:I-z-R,...E&&{alignmentOffset:R}},reset:E}}}),BO=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var s,r;const{placement:n,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:A=!0,...g}=zs(t,e);if((s=i.arrow)!=null&&s.alignmentOffset)return{};const y=Ds(n),w=nr(a),x=Ds(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),q=d||(x||!A?[_l(a)]:TO(a)),_=m!=="none";!d&&_&&q.push(...RO(a,A,m,b));const V=[a,...q],S=await Ao(e,g),k=[];let C=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&k.push(S[y]),h){const I=EO(n,o,b);k.push(S[I[0]],S[I[1]])}if(C=[...C,{placement:n,overflows:k}],!k.every(I=>I<=0)){var P,T;const I=(((P=i.flip)==null?void 0:P.index)||0)+1,z=V[I];if(z)return{data:{index:I,overflows:C},reset:{placement:z}};let E=(T=C.filter(R=>R.overflows[0]<=0).sort((R,D)=>R.overflows[1]-D.overflows[1])[0])==null?void 0:T.placement;if(!E)switch(f){case"bestFit":{var M;const R=(M=C.filter(D=>{if(_){const F=nr(D.placement);return F===w||F==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(F=>F>0).reduce((F,Y)=>F+Y,0)]).sort((D,F)=>D[1]-F[1])[0])==null?void 0:M[0];R&&(E=R);break}case"initialPlacement":E=a;break}if(n!==E)return{reset:{placement:E}}}return{}}}};function LA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function UA(t){return kO.some(e=>t[e]>=0)}const NO=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:s}=e,{strategy:r="referenceHidden",...n}=zs(t,e);switch(r){case"referenceHidden":{const i=await Ao(e,{...n,elementContext:"reference"}),o=LA(i,s.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:UA(o)}}}case"escaped":{const i=await Ao(e,{...n,altBoundary:!0}),o=LA(i,s.floating);return{data:{escapedOffsets:o,escaped:UA(o)}}}default:return{}}}}};async function zO(t,e){const{placement:s,platform:r,elements:n}=t,i=await(r.isRTL==null?void 0:r.isRTL(n.floating)),o=Ds(s),a=ti(s),l=nr(s)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=zs(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const DO=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var s,r;const{x:n,y:i,placement:o,middlewareData:a}=e,l=await zO(e,t);return o===((s=a.offset)==null?void 0:s.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},FO=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:s,y:r,placement:n}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:w}=g;return{x:y,y:w}}},...l}=zs(t,e),c={x:s,y:r},u=await Ao(e,l),h=nr(Ds(n)),d=kf(h);let f=c[d],m=c[h];if(i){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=f+u[g],x=f-u[y];f=Xh(w,f,x)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=m+u[g],x=m-u[y];m=Xh(w,m,x)}const A=a.fn({...e,[d]:f,[h]:m});return{...A,data:{x:A.x-s,y:A.y-r,enabled:{[d]:i,[h]:o}}}}}},LO=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:s,y:r,placement:n,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=zs(t,e),u={x:s,y:r},h=nr(n),d=kf(h);let f=u[d],m=u[h];const A=zs(a,e),g=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=d==="y"?"height":"width",b=i.reference[d]-i.floating[x]+g.mainAxis,q=i.reference[d]+i.reference[x]-g.mainAxis;f<b?f=b:f>q&&(f=q)}if(c){var y,w;const x=d==="y"?"width":"height",b=["top","left"].includes(Ds(n)),q=i.reference[h]-i.floating[x]+(b&&((y=o.offset)==null?void 0:y[h])||0)+(b?0:g.crossAxis),_=i.reference[h]+i.reference[x]+(b?0:((w=o.offset)==null?void 0:w[h])||0)-(b?g.crossAxis:0);m<q?m=q:m>_&&(m=_)}return{[d]:f,[h]:m}}}},UO=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var s,r;const{placement:n,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=zs(t,e),u=await Ao(e,c),h=Ds(n),d=ti(n),f=nr(n)==="y",{width:m,height:A}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=d==="end"?"top":"bottom");const w=A-u.top-u.bottom,x=m-u.left-u.right,b=rr(A-u[g],w),q=rr(m-u[y],x),_=!e.middlewareData.shift;let V=b,S=q;if((s=e.middlewareData.shift)!=null&&s.enabled.x&&(S=x),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(V=w),_&&!d){const C=It(u.left,0),P=It(u.right,0),T=It(u.top,0),M=It(u.bottom,0);f?S=m-2*(C!==0||P!==0?C+P:It(u.left,u.right)):V=A-2*(T!==0||M!==0?T+M:It(u.top,u.bottom))}await l({...e,availableWidth:S,availableHeight:V});const k=await o.getDimensions(a.floating);return m!==k.width||A!==k.height?{reset:{rects:!0}}:{}}}};function tc(){return typeof window<"u"}function si(t){return IV(t)?(t.nodeName||"").toLowerCase():"#document"}function Bt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Vs(t){var e;return(e=(IV(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function IV(t){return tc()?t instanceof Node||t instanceof Bt(t).Node:!1}function rs(t){return tc()?t instanceof Element||t instanceof Bt(t).Element:!1}function xs(t){return tc()?t instanceof HTMLElement||t instanceof Bt(t).HTMLElement:!1}function $A(t){return!tc()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Bt(t).ShadowRoot}function Bo(t){const{overflow:e,overflowX:s,overflowY:r,display:n}=ns(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+s)&&!["inline","contents"].includes(n)}function $O(t){return["table","td","th"].includes(si(t))}function sc(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Ef(t){const e=Tf(),s=rs(t)?ns(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>s[r]?s[r]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!e&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!e&&(s.filter?s.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(s.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(s.contain||"").includes(r))}function HO(t){let e=ir(t);for(;xs(e)&&!jn(e);){if(Ef(e))return e;if(sc(e))return null;e=ir(e)}return null}function Tf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jn(t){return["html","body","#document"].includes(si(t))}function ns(t){return Bt(t).getComputedStyle(t)}function rc(t){return rs(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ir(t){if(si(t)==="html")return t;const e=t.assignedSlot||t.parentNode||$A(t)&&t.host||Vs(t);return $A(e)?e.host:e}function jV(t){const e=ir(t);return jn(e)?t.ownerDocument?t.ownerDocument.body:t.body:xs(e)&&Bo(e)?e:jV(e)}function yo(t,e,s){var r;e===void 0&&(e=[]),s===void 0&&(s=!0);const n=jV(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),o=Bt(n);if(i){const a=Zh(o);return e.concat(o,o.visualViewport||[],Bo(n)?n:[],a&&s?yo(a):[])}return e.concat(n,yo(n,[],s))}function Zh(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function OV(t){const e=ns(t);let s=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const n=xs(t),i=n?t.offsetWidth:s,o=n?t.offsetHeight:r,a=vl(s)!==i||vl(r)!==o;return a&&(s=i,r=o),{width:s,height:r,$:a}}function Mf(t){return rs(t)?t:t.contextElement}function vn(t){const e=Mf(t);if(!xs(e))return gs(1);const s=e.getBoundingClientRect(),{width:r,height:n,$:i}=OV(e);let o=(i?vl(s.width):s.width)/r,a=(i?vl(s.height):s.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const WO=gs(0);function BV(t){const e=Bt(t);return!Tf()||!e.visualViewport?WO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function GO(t,e,s){return e===void 0&&(e=!1),!s||e&&s!==Bt(t)?!1:e}function Fr(t,e,s,r){e===void 0&&(e=!1),s===void 0&&(s=!1);const n=t.getBoundingClientRect(),i=Mf(t);let o=gs(1);e&&(r?rs(r)&&(o=vn(r)):o=vn(t));const a=GO(i,s,r)?BV(i):gs(0);let l=(n.left+a.x)/o.x,c=(n.top+a.y)/o.y,u=n.width/o.x,h=n.height/o.y;if(i){const d=Bt(i),f=r&&rs(r)?Bt(r):r;let m=d,A=Zh(m);for(;A&&r&&f!==m;){const g=vn(A),y=A.getBoundingClientRect(),w=ns(A),x=y.left+(A.clientLeft+parseFloat(w.paddingLeft))*g.x,b=y.top+(A.clientTop+parseFloat(w.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=x,c+=b,m=Bt(A),A=Zh(m)}}return Sl({width:u,height:h,x:l,y:c})}function Rf(t,e){const s=rc(t).scrollLeft;return e?e.left+s:Fr(Vs(t)).left+s}function NV(t,e,s){s===void 0&&(s=!1);const r=t.getBoundingClientRect(),n=r.left+e.scrollLeft-(s?0:Rf(t,r)),i=r.top+e.scrollTop;return{x:n,y:i}}function YO(t){let{elements:e,rect:s,offsetParent:r,strategy:n}=t;const i=n==="fixed",o=Vs(r),a=e?sc(e.floating):!1;if(r===o||a&&i)return s;let l={scrollLeft:0,scrollTop:0},c=gs(1);const u=gs(0),h=xs(r);if((h||!h&&!i)&&((si(r)!=="body"||Bo(o))&&(l=rc(r)),xs(r))){const f=Fr(r);c=vn(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}const d=o&&!h&&!i?NV(o,l,!0):gs(0);return{width:s.width*c.x,height:s.height*c.y,x:s.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:s.y*c.y-l.scrollTop*c.y+u.y+d.y}}function KO(t){return Array.from(t.getClientRects())}function QO(t){const e=Vs(t),s=rc(t),r=t.ownerDocument.body,n=It(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=It(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-s.scrollLeft+Rf(t);const a=-s.scrollTop;return ns(r).direction==="rtl"&&(o+=It(e.clientWidth,r.clientWidth)-n),{width:n,height:i,x:o,y:a}}function XO(t,e){const s=Bt(t),r=Vs(t),n=s.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(n){i=n.width,o=n.height;const c=Tf();(!c||c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:a,y:l}}function JO(t,e){const s=Fr(t,!0,e==="fixed"),r=s.top+t.clientTop,n=s.left+t.clientLeft,i=xs(t)?vn(t):gs(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=n*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function HA(t,e,s){let r;if(e==="viewport")r=XO(t,s);else if(e==="document")r=QO(Vs(t));else if(rs(e))r=JO(e,s);else{const n=BV(t);r={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Sl(r)}function zV(t,e){const s=ir(t);return s===e||!rs(s)||jn(s)?!1:ns(s).position==="fixed"||zV(s,e)}function ZO(t,e){const s=e.get(t);if(s)return s;let r=yo(t,[],!1).filter(a=>rs(a)&&si(a)!=="body"),n=null;const i=ns(t).position==="fixed";let o=i?ir(t):t;for(;rs(o)&&!jn(o);){const a=ns(o),l=Ef(o);!l&&a.position==="fixed"&&(n=null),(i?!l&&!n:!l&&a.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||Bo(o)&&!l&&zV(t,o))?r=r.filter(u=>u!==o):n=a,o=ir(o)}return e.set(t,r),r}function eB(t){let{element:e,boundary:s,rootBoundary:r,strategy:n}=t;const o=[...s==="clippingAncestors"?sc(e)?[]:ZO(e,this._c):[].concat(s),r],a=o[0],l=o.reduce((c,u)=>{const h=HA(e,u,n);return c.top=It(h.top,c.top),c.right=rr(h.right,c.right),c.bottom=rr(h.bottom,c.bottom),c.left=It(h.left,c.left),c},HA(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function tB(t){const{width:e,height:s}=OV(t);return{width:e,height:s}}function sB(t,e,s){const r=xs(e),n=Vs(e),i=s==="fixed",o=Fr(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=gs(0);if(r||!r&&!i)if((si(e)!=="body"||Bo(n))&&(a=rc(e)),r){const d=Fr(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else n&&(l.x=Rf(n));const c=n&&!r&&!i?NV(n,a):gs(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function Su(t){return ns(t).position==="static"}function WA(t,e){if(!xs(t)||ns(t).position==="fixed")return null;if(e)return e(t);let s=t.offsetParent;return Vs(t)===s&&(s=s.ownerDocument.body),s}function DV(t,e){const s=Bt(t);if(sc(t))return s;if(!xs(t)){let n=ir(t);for(;n&&!jn(n);){if(rs(n)&&!Su(n))return n;n=ir(n)}return s}let r=WA(t,e);for(;r&&$O(r)&&Su(r);)r=WA(r,e);return r&&jn(r)&&Su(r)&&!Ef(r)?s:r||HO(t)||s}const rB=async function(t){const e=this.getOffsetParent||DV,s=this.getDimensions,r=await s(t.floating);return{reference:sB(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function nB(t){return ns(t).direction==="rtl"}const iB={convertOffsetParentRelativeRectToViewportRelativeRect:YO,getDocumentElement:Vs,getClippingRect:eB,getOffsetParent:DV,getElementRects:rB,getClientRects:KO,getDimensions:tB,getScale:vn,isElement:rs,isRTL:nB};function FV(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function oB(t,e){let s=null,r;const n=Vs(t);function i(){var a;clearTimeout(r),(a=s)==null||a.disconnect(),s=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const m=Pa(h),A=Pa(n.clientWidth-(u+d)),g=Pa(n.clientHeight-(h+f)),y=Pa(u),x={rootMargin:-m+"px "+-A+"px "+-g+"px "+-y+"px",threshold:It(0,rr(1,l))||1};let b=!0;function q(_){const V=_[0].intersectionRatio;if(V!==l){if(!b)return o();V?o(!1,V):r=setTimeout(()=>{o(!1,1e-7)},1e3)}V===1&&!FV(c,t.getBoundingClientRect())&&o(),b=!1}try{s=new IntersectionObserver(q,{...x,root:n.ownerDocument})}catch{s=new IntersectionObserver(q,x)}s.observe(t)}return o(!0),i}function aB(t,e,s,r){r===void 0&&(r={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Mf(t),u=n||i?[...c?yo(c):[],...yo(e)]:[];u.forEach(y=>{n&&y.addEventListener("scroll",s,{passive:!0}),i&&y.addEventListener("resize",s)});const h=c&&a?oB(c,s):null;let d=-1,f=null;o&&(f=new ResizeObserver(y=>{let[w]=y;w&&w.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(e)})),s()}),c&&!l&&f.observe(c),f.observe(e));let m,A=l?Fr(t):null;l&&g();function g(){const y=Fr(t);A&&!FV(A,y)&&s(),A=y,m=requestAnimationFrame(g)}return s(),()=>{var y;u.forEach(w=>{n&&w.removeEventListener("scroll",s),i&&w.removeEventListener("resize",s)}),h?.(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const lB=DO,cB=FO,uB=BO,hB=UO,dB=NO,GA=OO,fB=LO,pB=(t,e,s)=>{const r=new Map,n={platform:iB,...s},i={...n.platform,_c:r};return jO(t,e,{...n,platform:i})};var Ka=typeof document<"u"?v.useLayoutEffect:v.useEffect;function kl(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let s,r,n;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(s=t.length,s!==e.length)return!1;for(r=s;r--!==0;)if(!kl(t[r],e[r]))return!1;return!0}if(n=Object.keys(t),s=n.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!{}.hasOwnProperty.call(e,n[r]))return!1;for(r=s;r--!==0;){const i=n[r];if(!(i==="_owner"&&t.$$typeof)&&!kl(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function LV(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function YA(t,e){const s=LV(t);return Math.round(e*s)/s}function ku(t){const e=v.useRef(t);return Ka(()=>{e.current=t}),e}function mB(t){t===void 0&&(t={});const{placement:e="bottom",strategy:s="absolute",middleware:r=[],platform:n,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=v.useState({x:0,y:0,strategy:s,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=v.useState(r);kl(d,r)||f(r);const[m,A]=v.useState(null),[g,y]=v.useState(null),w=v.useCallback(D=>{D!==_.current&&(_.current=D,A(D))},[]),x=v.useCallback(D=>{D!==V.current&&(V.current=D,y(D))},[]),b=i||m,q=o||g,_=v.useRef(null),V=v.useRef(null),S=v.useRef(u),k=l!=null,C=ku(l),P=ku(n),T=ku(c),M=v.useCallback(()=>{if(!_.current||!V.current)return;const D={placement:e,strategy:s,middleware:d};P.current&&(D.platform=P.current),pB(_.current,V.current,D).then(F=>{const Y={...F,isPositioned:T.current!==!1};I.current&&!kl(S.current,Y)&&(S.current=Y,Xl.flushSync(()=>{h(Y)}))})},[d,e,s,P,T]);Ka(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,h(D=>({...D,isPositioned:!1})))},[c]);const I=v.useRef(!1);Ka(()=>(I.current=!0,()=>{I.current=!1}),[]),Ka(()=>{if(b&&(_.current=b),q&&(V.current=q),b&&q){if(C.current)return C.current(b,q,M);M()}},[b,q,M,C,k]);const z=v.useMemo(()=>({reference:_,floating:V,setReference:w,setFloating:x}),[w,x]),E=v.useMemo(()=>({reference:b,floating:q}),[b,q]),R=v.useMemo(()=>{const D={position:s,left:0,top:0};if(!E.floating)return D;const F=YA(E.floating,u.x),Y=YA(E.floating,u.y);return a?{...D,transform:"translate("+F+"px, "+Y+"px)",...LV(E.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:F,top:Y}},[s,a,E.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:M,refs:z,elements:E,floatingStyles:R}),[u,M,z,E,R])}const gB=t=>{function e(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:t,fn(s){const{element:r,padding:n}=typeof t=="function"?t(s):t;return r&&e(r)?r.current!=null?GA({element:r.current,padding:n}).fn(s):{}:r?GA({element:r,padding:n}).fn(s):{}}}},AB=(t,e)=>({...lB(t),options:[t,e]}),yB=(t,e)=>({...cB(t),options:[t,e]}),xB=(t,e)=>({...fB(t),options:[t,e]}),bB=(t,e)=>({...uB(t),options:[t,e]}),wB=(t,e)=>({...hB(t),options:[t,e]}),VB=(t,e)=>({...dB(t),options:[t,e]}),qB=(t,e)=>({...gB(t),options:[t,e]});var vB="Arrow",UV=v.forwardRef((t,e)=>{const{children:s,width:r=10,height:n=5,...i}=t;return p.jsx(lr.svg,{...i,ref:e,width:r,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?s:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});UV.displayName=vB;var _B=UV;function SB(t){const[e,s]=v.useState(void 0);return sr(()=>{if(t){s({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const i=n[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;s({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else s(void 0)},[t]),e}var If="Popper",[$V,HV]=CV(If),[kB,WV]=$V(If),GV=t=>{const{__scopePopper:e,children:s}=t,[r,n]=v.useState(null);return p.jsx(kB,{scope:e,anchor:r,onAnchorChange:n,children:s})};GV.displayName=If;var YV="PopperAnchor",KV=v.forwardRef((t,e)=>{const{__scopePopper:s,virtualRef:r,...n}=t,i=WV(YV,s),o=v.useRef(null),a=Hr(e,o);return v.useEffect(()=>{i.onAnchorChange(r?.current||o.current)}),r?null:p.jsx(lr.div,{...n,ref:a})});KV.displayName=YV;var jf="PopperContent",[CB,PB]=$V(jf),QV=v.forwardRef((t,e)=>{const{__scopePopper:s,side:r="bottom",sideOffset:n=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:m,...A}=t,g=WV(jf,s),[y,w]=v.useState(null),x=Hr(e,Fe=>w(Fe)),[b,q]=v.useState(null),_=SB(b),V=_?.width??0,S=_?.height??0,k=r+(i!=="center"?"-"+i:""),C=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(c)?c:[c],T=P.length>0,M={padding:C,boundary:P.filter(TB),altBoundary:T},{refs:I,floatingStyles:z,placement:E,isPositioned:R,middlewareData:D}=mB({strategy:"fixed",placement:k,whileElementsMounted:(...Fe)=>aB(...Fe,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[AB({mainAxis:n+S,alignmentAxis:o}),l&&yB({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?xB():void 0,...M}),l&&bB({...M}),wB({...M,apply:({elements:Fe,rects:ls,availableWidth:xt,availableHeight:Yt})=>{const{width:qs,height:Ct}=ls.reference,bt=Fe.floating.style;bt.setProperty("--radix-popper-available-width",`${xt}px`),bt.setProperty("--radix-popper-available-height",`${Yt}px`),bt.setProperty("--radix-popper-anchor-width",`${qs}px`),bt.setProperty("--radix-popper-anchor-height",`${Ct}px`)}}),b&&qB({element:b,padding:a}),MB({arrowWidth:V,arrowHeight:S}),d&&VB({strategy:"referenceHidden",...M})]}),[F,Y]=ZV(E),ge=ec(m);sr(()=>{R&&ge?.()},[R,ge]);const oe=D.arrow?.x,se=D.arrow?.y,Ae=D.arrow?.centerOffset!==0,[ae,he]=v.useState();return sr(()=>{y&&he(window.getComputedStyle(y).zIndex)},[y]),p.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:R?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ae,"--radix-popper-transform-origin":[D.transformOrigin?.x,D.transformOrigin?.y].join(" "),...D.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(CB,{scope:s,placedSide:F,onArrowChange:q,arrowX:oe,arrowY:se,shouldHideArrow:Ae,children:p.jsx(lr.div,{"data-side":F,"data-align":Y,...A,ref:x,style:{...A.style,animation:R?void 0:"none"}})})})});QV.displayName=jf;var XV="PopperArrow",EB={top:"bottom",right:"left",bottom:"top",left:"right"},JV=v.forwardRef(function(e,s){const{__scopePopper:r,...n}=e,i=PB(XV,r),o=EB[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(_B,{...n,ref:s,style:{...n.style,display:"block"}})})});JV.displayName=XV;function TB(t){return t!==null}var MB=t=>({name:"transformOrigin",options:t,fn(e){const{placement:s,rects:r,middlewareData:n}=e,o=n.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=ZV(s),h={start:"0%",center:"50%",end:"100%"}[u],d=(n.arrow?.x??0)+a/2,f=(n.arrow?.y??0)+l/2;let m="",A="";return c==="bottom"?(m=o?h:`${d}px`,A=`${-l}px`):c==="top"?(m=o?h:`${d}px`,A=`${r.floating.height+l}px`):c==="right"?(m=`${-l}px`,A=o?h:`${f}px`):c==="left"&&(m=`${r.floating.width+l}px`,A=o?h:`${f}px`),{data:{x:m,y:A}}}});function ZV(t){const[e,s="center"]=t.split("-");return[e,s]}var RB=GV,IB=KV,jB=QV,OB=JV,BB="Portal",eq=v.forwardRef((t,e)=>{const{container:s,...r}=t,[n,i]=v.useState(!1);sr(()=>i(!0),[]);const o=s||n&&globalThis?.document?.body;return o?EI.createPortal(p.jsx(lr.div,{...r,ref:e}),o):null});eq.displayName=BB;function NB(t,e){return v.useReducer((s,r)=>e[s][r]??s,t)}var Of=t=>{const{present:e,children:s}=t,r=zB(e),n=typeof s=="function"?s({present:r.isPresent}):v.Children.only(s),i=Hr(r.ref,DB(n));return typeof s=="function"||r.isPresent?v.cloneElement(n,{ref:i}):null};Of.displayName="Presence";function zB(t){const[e,s]=v.useState(),r=v.useRef(null),n=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=NB(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const c=Ea(r.current);i.current=a==="mounted"?c:"none"},[a]),sr(()=>{const c=r.current,u=n.current;if(u!==t){const d=i.current,f=Ea(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,l]),sr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const A=Ea(r.current).includes(f.animationName);if(f.target===e&&A&&(l("ANIMATION_END"),!n.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},d=f=>{f.target===e&&(i.current=Ea(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(c=>{r.current=c?getComputedStyle(c):null,s(c)},[])}}function Ea(t){return t?.animationName||"none"}function DB(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning;return s?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var FB=dd[" useInsertionEffect ".trim().toString()]||sr;function LB({prop:t,defaultProp:e,onChange:s=()=>{},caller:r}){const[n,i,o]=UB({defaultProp:e,onChange:s}),a=t!==void 0,l=a?t:n;{const u=v.useRef(t!==void 0);v.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=v.useCallback(u=>{if(a){const h=$B(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function UB({defaultProp:t,onChange:e}){const[s,r]=v.useState(t),n=v.useRef(s),i=v.useRef(e);return FB(()=>{i.current=e},[e]),v.useEffect(()=>{n.current!==s&&(i.current?.(s),n.current=s)},[s,n]),[s,r,i]}function $B(t){return typeof t=="function"}var HB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),WB="VisuallyHidden",tq=v.forwardRef((t,e)=>p.jsx(lr.span,{...t,ref:e,style:{...HB,...t.style}}));tq.displayName=WB;var GB=tq,[nc,f$]=CV("Tooltip",[HV]),ic=HV(),YB="TooltipProvider",ed="tooltip.open",[p$,Bf]=nc(YB),xo="Tooltip",[KB,No]=nc(xo),sq=t=>{const{__scopeTooltip:e,children:s,open:r,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=Bf(xo,t.__scopeTooltip),c=ic(e),[u,h]=v.useState(null),d=SO(),f=v.useRef(0),m=o??l.disableHoverableContent,A=a??l.delayDuration,g=v.useRef(!1),[y,w]=LB({prop:r,defaultProp:n??!1,onChange:V=>{V?(l.onOpen(),document.dispatchEvent(new CustomEvent(ed))):l.onClose(),i?.(V)},caller:xo}),x=v.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),b=v.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g.current=!1,w(!0)},[w]),q=v.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w(!1)},[w]),_=v.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{g.current=!0,w(!0),f.current=0},A)},[A,w]);return v.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),p.jsx(RB,{...c,children:p.jsx(KB,{scope:e,contentId:d,open:y,stateAttribute:x,trigger:u,onTriggerChange:h,onTriggerEnter:v.useCallback(()=>{l.isOpenDelayedRef.current?_():b()},[l.isOpenDelayedRef,_,b]),onTriggerLeave:v.useCallback(()=>{m?q():(window.clearTimeout(f.current),f.current=0)},[q,m]),onOpen:b,onClose:q,disableHoverableContent:m,children:s})})};sq.displayName=xo;var td="TooltipTrigger",rq=v.forwardRef((t,e)=>{const{__scopeTooltip:s,...r}=t,n=No(td,s),i=Bf(td,s),o=ic(s),a=v.useRef(null),l=Hr(e,a,n.onTriggerChange),c=v.useRef(!1),u=v.useRef(!1),h=v.useCallback(()=>c.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),p.jsx(IB,{asChild:!0,...o,children:p.jsx(lr.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...r,ref:l,onPointerMove:Ms(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:Ms(t.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:Ms(t.onPointerDown,()=>{n.open&&n.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Ms(t.onFocus,()=>{c.current||n.onOpen()}),onBlur:Ms(t.onBlur,n.onClose),onClick:Ms(t.onClick,n.onClose)})})});rq.displayName=td;var Nf="TooltipPortal",[QB,XB]=nc(Nf,{forceMount:void 0}),nq=t=>{const{__scopeTooltip:e,forceMount:s,children:r,container:n}=t,i=No(Nf,e);return p.jsx(QB,{scope:e,forceMount:s,children:p.jsx(Of,{present:s||i.open,children:p.jsx(eq,{asChild:!0,container:n,children:r})})})};nq.displayName=Nf;var On="TooltipContent",iq=v.forwardRef((t,e)=>{const s=XB(On,t.__scopeTooltip),{forceMount:r=s.forceMount,side:n="top",...i}=t,o=No(On,t.__scopeTooltip);return p.jsx(Of,{present:r||o.open,children:o.disableHoverableContent?p.jsx(oq,{side:n,...i,ref:e}):p.jsx(JB,{side:n,...i,ref:e})})}),JB=v.forwardRef((t,e)=>{const s=No(On,t.__scopeTooltip),r=Bf(On,t.__scopeTooltip),n=v.useRef(null),i=Hr(e,n),[o,a]=v.useState(null),{trigger:l,onClose:c}=s,u=n.current,{onPointerInTransitChange:h}=r,d=v.useCallback(()=>{a(null),h(!1)},[h]),f=v.useCallback((m,A)=>{const g=m.currentTarget,y={x:m.clientX,y:m.clientY},w=rN(y,g.getBoundingClientRect()),x=nN(y,w),b=iN(A.getBoundingClientRect()),q=aN([...x,...b]);a(q),h(!0)},[h]);return v.useEffect(()=>()=>d(),[d]),v.useEffect(()=>{if(l&&u){const m=g=>f(g,u),A=g=>f(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",A)}}},[l,u,f,d]),v.useEffect(()=>{if(o){const m=A=>{const g=A.target,y={x:A.clientX,y:A.clientY},w=l?.contains(g)||u?.contains(g),x=!oN(y,o);w?d():x&&(d(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,d]),p.jsx(oq,{...t,ref:i})}),[ZB,eN]=nc(xo,{isInside:!1}),tN=uO("TooltipContent"),oq=v.forwardRef((t,e)=>{const{__scopeTooltip:s,children:r,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=No(On,s),c=ic(s),{onClose:u}=l;return v.useEffect(()=>(document.addEventListener(ed,u),()=>document.removeEventListener(ed,u)),[u]),v.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),p.jsx(TV,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:p.jsxs(jB,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(tN,{children:r}),p.jsx(ZB,{scope:s,isInside:!0,children:p.jsx(GB,{id:l.contentId,role:"tooltip",children:n||r})})]})})});iq.displayName=On;var aq="TooltipArrow",sN=v.forwardRef((t,e)=>{const{__scopeTooltip:s,...r}=t,n=ic(s);return eN(aq,s).isInside?null:p.jsx(OB,{...n,...r,ref:e})});sN.displayName=aq;function rN(t,e){const s=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(s,r,n,i)){case i:return"left";case n:return"right";case s:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function nN(t,e,s=5){const r=[];switch(e){case"top":r.push({x:t.x-s,y:t.y+s},{x:t.x+s,y:t.y+s});break;case"bottom":r.push({x:t.x-s,y:t.y-s},{x:t.x+s,y:t.y-s});break;case"left":r.push({x:t.x+s,y:t.y-s},{x:t.x+s,y:t.y+s});break;case"right":r.push({x:t.x-s,y:t.y-s},{x:t.x-s,y:t.y+s});break}return r}function iN(t){const{top:e,right:s,bottom:r,left:n}=t;return[{x:n,y:e},{x:s,y:e},{x:s,y:r},{x:n,y:r}]}function oN(t,e){const{x:s,y:r}=t;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>r!=d>r&&s<(h-c)*(r-u)/(d-u)+c&&(n=!n)}return n}function aN(t){const e=t.slice();return e.sort((s,r)=>s.x<r.x?-1:s.x>r.x?1:s.y<r.y?-1:s.y>r.y?1:0),lN(e)}function lN(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const n=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const s=[];for(let r=t.length-1;r>=0;r--){const n=t[r];for(;s.length>=2;){const i=s[s.length-1],o=s[s.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))s.pop();else break}s.push(n)}return s.pop(),e.length===1&&s.length===1&&e[0].x===s[0].x&&e[0].y===s[0].y?e:e.concat(s)}var cN=sq;const zf=({triggerContent:t,tooltipContent:e})=>e?p.jsxs(cN,{children:[p.jsx(rq,{asChild:!0,children:t}),p.jsx(nq,{children:p.jsx(qn,{scaleFactor:2,children:p.jsx(iq,{side:"bottom",align:"end",className:"bg-highlightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?p.jsx("div",{className:"max-w-16",children:p.jsx(me,{markdown:e})}):e})})})]}):t,uN=/^(?<modifiers>[^]*)(?<key>.+)$/,hN=t=>{const e=new Set;for(const s of t){if(e.has(s))return!0;e.add(s)}return!1},Df=(t,e,s,r=void 0)=>{const n=t?.join(" ");v.useEffect(()=>{if(!t||t.length===0||r===null)return;const i=r??window,o=a=>{let c=a.target;for(;c&&c!==i;){if(c.classList.contains("no-keyboard-shortcuts"))return;c=c.parentElement}for(const u of t){const h=u.match(uN);if(!h||!h.groups)continue;const{modifiers:d,key:f}=h.groups;if(hN(d)){console.warn(`Invalid shortcut "${u}": duplicate modifiers`);continue}const m=d.includes("^"),A=d.includes(""),g=d.includes(""),y=d.includes(""),w=m||A||g||y,x=m===a.ctrlKey&&A===a.metaKey&&g===a.shiftKey&&y===a.altKey&&(w||!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey);if((y&&a.altKey?a.code.replace(/^Key/,"").toLowerCase():a.key.toLowerCase())===f.toLowerCase()&&x){e||s?.(),a.preventDefault();break}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[e,s,n,r])},dN=({className:t,selected:e,disabled:s=!1,onClick:r,ref:n,tooltipContent:i,shortcutKeys:o,children:a,...l})=>{Df(o,s,r);const c=p.jsx("button",{disabled:s,onClick:r,"data-selected":e,className:_f(`inline-flex items-center justify-center whitespace-nowrap 
          bg-metallicBlue zx:bg-zxBlue border-none border-shadow
          gap-2
           disabled:bg-midGrey disabled:text-lightGrey 
           data-[selected=true]:bg-lightBeige
           [&:not(:disabled):hover:not([data-selected=true])]:bg-pastelBlue 
           `,t),ref:n,...l,children:a}),u=Sf(typeof i=="string"?i:void 0,o)??i;return p.jsx(zf,{triggerContent:c,tooltipContent:u})},ri="bg-white zx:bg-zxWhite py-0 gap-y-0 text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen [--leader-col-width:theme(width.3)] ",ni="flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3",ii="bg-lightGrey zx:bg-zxWhiteDimmed mobile:px-4",Z=t=>t,fN=t=>{const e=t.length;if(e===1)return[t[0]];let s=0;for(let n=0;n<e-1;n++)s=Math.max(s,t[n].length+n);const r=t[e-1].length+(e-1);return s=Math.max(s,r),t.map((n,i)=>{if(i===e-1){const a=s-n.length;return" ".repeat(a)+n}else{const a=i,l=s-n.length-a;return" ".repeat(a)+n+" ".repeat(l)}})},lq=({label:t})=>p.jsx(j,{className:"inline-block mr-1 text-lightGrey py-half",noSlitWords:!0,children:t}),Js=({className:t,value:e,onChange:s,trueLabel:r="ON",falseLabel:n="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(r.length,n.length)+1,c=r.padStart(l," "),u=n.padEnd(l," ");Df(o,!1,()=>{s?.(!e,void 0)});const h=p.jsxs("span",{onClick:f=>s?.(!e,f),className:_f("inline-flex justify-between leading-none",t),children:[i&&p.jsx(lq,{label:i}),p.jsx(j,{role:"switch",className:vf("inline-block w-min h-min py-half px-half sprites-uppercase",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),d=Sf(typeof a=="string"?a:void 0,o)??a;return p.jsx(zf,{triggerContent:h,tooltipContent:d})},KA=Z(["bg-redShadowHalfbrite text-highlightBeige zx:bg-zxBlack zx:text-zxGreen","bg-metallicBlueHalfbrite text-pastelBlue zx:bg-zxBlack zx:text-zxBlue","bg-pinkHalfbrite text-pink zx:bg-zxBlack zx:text-zxYellow","bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"]),Ff=({className:t,value:e,onChange:s,values:r,valueLabels:n=r.map(l=>`${l}`),label:i,shortcutKeys:o,tooltipContent:a})=>{const l=r.indexOf(e),c=r.length,u=v.useCallback(()=>{const A=(l+1)%c;s?.(r[A],void 0)},[s,l,r,c]);Df(o,!1,()=>{u()});const h=fN(n),d=c>4?l%4:l,f=p.jsxs("span",{onClick:u,className:_f("inline-flex justify-between leading-none",t),children:[i&&p.jsx(lq,{label:i}),p.jsx(j,{role:"switch",className:vf("inline-block w-min h-min py-half px-half sprites-uppercase",KA[d]??KA[0]),noSlitWords:!0,children:h[l]})]}),m=Sf(typeof a=="string"?a:void 0,o)??a;return p.jsx(zf,{triggerContent:f,tooltipContent:m})},ke=Z("[&_.em]:text-moss zx:[&_.em]:text-zxCyan [&_h2]:text-midRed zx:[&_h2]:text-zxBlue text-lightGrey zx:text-zxBlack sprites-normal-height"),ye="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow sprites-normal-height",pN="**4-way**: True to the 1987 original - move in x directions only",mN="**8-way**: The original with *4-way* movement, plus *diagonals*",gN="**Analogue**: Move in *any* direction with analogue stick",AN=()=>{const t=zb();return p.jsx(L,{id:"analogueControl",label:"Directions",leader:p.jsx("span",{className:`${ye} texture-joystick_whole sprites-normal-height`}),valueElement:p.jsx(Ff,{className:"ml-auto",values:Lb,valueLabels:["4-way","8-way","anlg"],value:t}),onSelect:N(hP),verticalAlignItemsCentre:!0,className:"sprites-double-height",hintInline:!0,hint:p.jsx(me,{className:ke,markdown:t==="analogue"?gN:t==="8-way"?mN:pN})})},yN=()=>p.jsx(L,{className:"sprites-double-height",id:"onScreenControls",label:p.jsx(j,{className:`${de} mobile:w-max`,children:"Touch controls"}),valueElement:p.jsx(Js,{className:"ml-auto",value:KC()}),onSelect:N(es,{path:"onScreenControls"}),verticalAlignItemsCentre:!0,hintInline:!0,hint:p.jsx(me,{className:ke,markdown:`Enables on-screen controls: for mobile, tablet, or any device with a touch-screen.

You can turn this off for phones paired with joypads/keyboards`})}),xN="This blockstack.ing remake comes with modern default mappings for keyboard and controller. You can also select presets matching the original game or different systems.",bN=({className:t})=>{const e=K(NC);return p.jsx(j,{className:et("text-nowrap","ml-auto","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},wN=()=>p.jsx(L,{id:"preset",doubleHeight:!0,label:p.jsx(j,{className:`${de}`,children:"Key/button preset"}),valueElement:p.jsx(bN,{}),onSelect:N(ot,"inputPreset"),opensSubMenu:!0,hint:p.jsx(me,{className:ke,markdown:xN}),hintInline:!0}),VN={screen:`**Screen**: Control is relative to the *screen*.
More intuitive if you find directions confusing in isometric games, but means hitting diagonals a lot`,world:"**World**: Control is relative to directions in the *isometric world* - like the original",mixed:"**Mixed (default)**: *Analogue sticks* move relative to the *screen*, digital inputs like *keys* and *d-pad* move relative to the *world*"},qN={screen:Z("texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections"),world:Z("texture-heels_standing_right selectedMenuItem:texture-animated-heels_worldDirections sprites-normal-height"),mixed:Z("texture-heels_standing_right selectedMenuItem:texture-animated-heels_mixedDirections sprites-normal-height")},vN=()=>{const t=sf();return p.jsx(Ff,{className:"ml-auto",values:tb,value:t})},_N=()=>{const t=sf();return p.jsx(L,{id:"screenRelativeControl",label:"Input axes",leader:p.jsx("span",{className:`${ye} ${qN[t]}`}),valueElement:p.jsx(vN,{}),onSelect:N(uP),hintInline:!0,verticalAlignItemsCentre:!0,className:"sprites-double-height",hint:p.jsx(me,{className:ke,markdown:VN[t]})})},vr="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",SN=t=>{const e=s=>s.startsWith("Arrow")?1:s.startsWith("Numpad")?2:0;return t.toSorted((s,r)=>{const n=e(s)-e(r);if(n!==0)return n;const i=s===" "?"Space":s,o=r===" "?"Space":r,a=i.length-o.length;return a!==0?a:i.localeCompare(o)})},kN=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:vr,children:e[1]}),e[2]]});switch(t){case" ":return"Space";case"ArrowDown":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:vr,children:"Cursor"}),""]});case"ArrowUp":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:vr,children:"Cursor"}),""]});case"ArrowLeft":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:vr,children:"Cursor"}),""]});case"ArrowRight":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:vr,children:"Cursor"}),""]});default:return t}},CN=["","","R","R"],PN=t=>CN[t]??`axis${t}`,EN=t=>{switch(gm[t]){case"dPadDown":return"D-pad";case"dPadUp":return"D-pad";case"dPadLeft":return"D-pad";case"dPadRight":return"D-pad";case"a":return p.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"A"});case"b":return p.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"B"});case"x":return p.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"X"});case"y":return p.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"Y"});case"start":return"Start";case"select":return"Select"}return gm[t]?.toUpperCase()??t},Lf=({action:t,keyClassName:e,className:s,flashingCursor:r=!1,inline:n=!1})=>{const i=K(c=>c.gameMenus.assigningInput?.action===t?c.gameMenus.assigningInput?.presses:hl(c).presses[t]),o=K(c=>{const u=Yh(t);return u===void 0?xn:c.gameMenus.assigningInput?.action===t?c.gameMenus.assigningInput.axes:hl(c).axes[u.axis]}),a=p.jsxs(p.Fragment,{children:[SN(i.keys).map(c=>p.jsx("span",{className:et("text-nowrap h-[calc(10px*var(--scale))]",e),children:p.jsx(ht,{children:kN(c)})},`key:${c}`)),r&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]}),l=p.jsxs(p.Fragment,{children:[o.map(c=>p.jsx("span",{className:et("text-nowrap h-[calc(10px*var(--scale))]",e),children:p.jsxs(ht,{children:[p.jsx("span",{className:vr,children:""}),PN(c)]})},`gamePadAxis:${c}`)),i.gamepadButtons.map(c=>p.jsx("span",{className:et("text-nowrap h-[calc(10px*var(--scale))]",e),children:p.jsxs(ht,{children:[p.jsx("span",{className:vr,children:""}),EN(c)]})},`gamePadButton:${c}`)),r&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]});return p.jsxs("div",{className:et(s,n?"inline":"w-full pl-2"),children:[n?a:p.jsx("div",{className:"flex flex-col w-[50%] gap-y-oneScaledPix",children:a}),n?l:p.jsx("div",{className:"flex flex-col",children:l})]})},QA="text-pink zx:text-zxCyan",TN=()=>{const t=K(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:p.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${de} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[p.jsx(j,{children:"Press: "}),p.jsx(Lf,{inline:!0,className:`${QA}`,action:"menu_openOrExit",keyClassName:"me-1"}),p.jsx(j,{children:"when done selecting keys for "}),p.jsx(j,{className:QA,children:t})]})},MN="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",Oe=({className:t,action:e})=>{const s=K(r=>r.gameMenus.assigningInput?.action===e);return p.jsx(Lf,{className:et("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:MN,flashingCursor:s})},RN=()=>{const t=sf()==="screen";return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"col-span-3",children:p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1  sprites-double-height`,children:"Movement"})}),p.jsx(L,{id:"left",label:`Left ${t?"":""}`,leader:p.jsx("span",{className:`${ye} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:p.jsx(Oe,{action:"left"}),onSelect:N(je,"left")}),p.jsx(L,{id:"right",label:`Right ${t?"":""}`,leader:p.jsx("span",{className:`${ye} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:p.jsx(Oe,{action:"right"}),onSelect:N(je,"right")}),p.jsx(L,{id:"up",label:`Up ${t?"":""}`,leader:p.jsx("span",{className:`${ye} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:p.jsx(Oe,{action:"away"}),onSelect:N(je,"away")}),p.jsx(L,{id:"down",label:`Down ${t?"":""}`,leader:p.jsx("span",{className:`${ye} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:p.jsx(Oe,{action:"towards"}),onSelect:N(je,"towards")}),p.jsx(L,{id:"jump",label:"Jump",leader:p.jsx("span",{className:`${ye} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:p.jsx(Oe,{action:"jump"}),onSelect:N(je,"jump")}),p.jsx("div",{className:"col-span-3",children:p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1  sprites-double-height`,children:"Character-specific Abilities"})}),p.jsx("div",{className:`${de} col-span-3`,children:p.jsx(me,{markdown:`**NOTE:** Some puzzles require Heels to jump and pick up/down simultaneously - assign a key to *both jump and carry*
          `,className:ke})}),p.jsx(L,{id:"carry",label:"Carry",leader:p.jsx("span",{className:`${ye} texture-bag`}),valueElement:p.jsx(Oe,{action:"carry"}),onSelect:N(je,"carry"),hint:p.jsx(me,{className:ke,markdown:"Carrying is **Heels only** and requires the bag"}),hintInline:!0}),p.jsx(L,{id:"fire",label:p.jsx(j,{className:`inline-block w-6 ${de}`,children:"Fire dough- nuts"}),leader:p.jsx("span",{className:`${ye} texture-doughnuts`}),hint:p.jsx(me,{className:ke,markdown:"Firing doughnuts is **Head only** and requires the hooter"}),hintInline:!0,valueElement:p.jsx(Oe,{action:"fire"}),onSelect:N(je,"fire")}),p.jsx("div",{className:"col-span-3",children:p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1  sprites-double-height`,children:"Character Swopping"})}),p.jsx(L,{id:"swop",label:"Swop",valueElement:p.jsx(Oe,{action:"swop"}),onSelect:N(je,"swop"),hint:p.jsx(me,{className:ke,markdown:"Works like the original game. *Cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:p.jsxs("span",{className:`${ye} texture-blank relative overflow-hidden`,children:[p.jsx("span",{className:`${ye} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),p.jsx("span",{className:`${ye} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),p.jsx(L,{id:"swopHead",label:p.jsx(j,{className:`inline-block w-6 ${de}`,children:"Swop to head"}),valueElement:p.jsx(Oe,{action:"swop.head"}),onSelect:N(je,"swop.head"),hint:p.jsx(me,{className:ke,markdown:"Go *directly* to *Head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${ye} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),p.jsx(L,{id:"swopHeels",label:p.jsxs("div",{className:`w-6 ${de}`,children:[p.jsx(j,{className:"me-1",children:"Swop to"}),p.jsx(j,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:p.jsx(Oe,{action:"swop.heels"}),onSelect:N(je,"swop.heels"),hint:p.jsx(me,{className:ke,markdown:"Go *directly* to *Heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${ye} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),p.jsx("div",{className:"col-span-3",children:p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1  sprites-double-height`,children:"Stopping the Game"})}),p.jsx(L,{id:"map",label:"Map",valueElement:p.jsx(Oe,{action:"map"}),onSelect:N(je,"map"),leader:p.jsx("span",{className:`${ye} texture-scroll`})}),p.jsx(L,{id:"hold",label:"Pause",valueElement:p.jsx(Oe,{action:"hold"}),onSelect:N(je,"hold"),leader:p.jsx("span",{className:`${ye} texture-drum`})}),p.jsx(L,{id:"menu",label:"Menu",valueElement:p.jsx(Oe,{action:"menu_openOrExit"}),onSelect:N(je,"menu_openOrExit")}),p.jsxs("div",{className:"col-span-3",children:[p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1 sprites-double-height pb-1`,children:"Look controls"}),p.jsx(me,{markdown:"Look controls are useful for seeing more of larger rooms that dont fit on the screen.",className:ke})]}),p.jsx(L,{id:"lookShift",label:"Look",valueElement:p.jsx(Oe,{action:"lookShift"}),onSelect:N(je,"lookShift"),hint:p.jsx(me,{className:ke,markdown:"Hold the look key and press a direction to look around the room"}),hintInline:!0}),p.jsx(L,{id:"lookLeft",label:"Look ",valueElement:p.jsx(Oe,{action:"lookLeft"}),onSelect:N(je,"lookLeft")}),p.jsx(L,{id:"lookRight",label:"Look ",valueElement:p.jsx(Oe,{action:"lookRight"}),onSelect:N(je,"lookRight")}),p.jsx(L,{id:"lookUp",label:"Look ",valueElement:p.jsx(Oe,{action:"lookUp"}),onSelect:N(je,"lookUp")}),p.jsx(L,{id:"lookDown",label:"Look ",valueElement:p.jsx(Oe,{action:"lookDown"}),onSelect:N(je,"lookDown")}),p.jsx("div",{className:"col-span-3",children:p.jsx(j,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${de} pt-1  sprites-double-height`,children:"Remake Option Toggles"})}),p.jsx(L,{id:"toggleColourisation",label:p.jsx(j,{className:`inline-block w-6 ${de}`,children:"Toggle colour- isation"}),valueElement:p.jsx(Oe,{action:"toggleColourisation"}),onSelect:N(je,"toggleColourisation"),leader:p.jsx("span",{className:`${ye} texture-switch_left sprites-normal-height`})}),p.jsx(L,{id:"cycleRes",label:p.jsx(j,{className:`inline-block w-6 ${de}`,children:"Cycle res- olution"}),valueElement:p.jsx(Oe,{action:"cycleResolution"}),onSelect:N(je,"cycleResolution"),leader:p.jsx("span",{className:`${ye} texture-switch_left sprites-normal-height`})}),p.jsx(L,{id:"toggleCrt",label:p.jsx(j,{className:`inline-block w-6 ${de}`,children:"Toggle CRT effect"}),valueElement:p.jsx(Oe,{action:"toggleCrtFilter"}),onSelect:N(je,"toggleCrtFilter"),leader:p.jsx("span",{className:`${ye} texture-switch_left sprites-normal-height`})})]})},IN=()=>{const t=!Ob();Ve({action:"menu_openOrExit",handler:v.useCallback(()=>{ue.dispatch(iP())},[]),disabled:t}),Cj({handler:v.useCallback((e,s)=>{s.currentActionPress("menu_openOrExit")==="released"&&jb(ue.getState())&&ue.dispatch(oP(e))},[]),disabled:t})},jN=({showAll:t})=>p.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[p.jsx(j,{className:`block mb-1 ${de}`,children:"Detected that you are on a phone or tablet"}),p.jsx(j,{className:`block mb-1 ${de}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),p.jsx(dN,{className:`block w-full mb-2 text-white p-1 bg-midRed zx:text-zxRed ${de}`,onClick:t,children:p.jsx(j,{children:"Tap here to show all settings"})})]}),XA=" !gap-y-1 ",ON=()=>{IN();const[t,e]=v.useState(!Da()),s=zb();return p.jsxs(De,{children:[p.jsx(At,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:N(gt)}),p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"controlOptions",children:[p.jsx(ws,{path:["Options","Controls"],className:ii}),p.jsxs("div",{className:ni,children:[p.jsxs(Ee,{className:`${XA} w-full`,children:[p.jsx(AN,{}),s!=="4-way"&&t&&p.jsx(_N,{}),p.jsx(yN,{}),t&&p.jsxs(p.Fragment,{children:[p.jsx(wN,{}),p.jsx(j,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3 text-center sprites-uppercase",children:"Select the Keys"})]})]}),t?p.jsx(p.Fragment,{children:p.jsx(Ee,{className:`${XA} !sprites-normal-height`,children:p.jsx(RN,{})})}):p.jsx(p.Fragment,{children:p.jsx(jN,{showAll:()=>e(!0)})})]}),p.jsx(TN,{})]})]})},BN="/assets/rock-C4e7VvX5.mp3",zo=({customLabel:t})=>p.jsx(L,{id:"back",label:t||"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:N(gt),toParentMenu:!0}),JA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},NN={egyptus:Z("texture-crown_egyptus"),blacktooth:Z("texture-crown_blacktooth"),bookworld:Z("texture-crown_bookworld"),penitentiary:Z("texture-crown_penitentiary"),safari:Z("texture-crown_safari")},vi=({planet:t,className:e,label:s=t})=>{const r=K(i=>i.gameMenus.gameInPlay.planetsLiberated[t]),n=!ef();return p.jsxs("div",{className:`flex flex-col ${e}`,children:[p.jsx("span",{className:`sprite block ${NN[t]} ${r?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),p.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${r?"":"colourised:brightness-halfBrite"} ${JA[t][0]}`}),p.jsx(j,{classnameCycle:n?JA[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${r?"":"colourised:brightness-halfBrite"}`,children:s})]})},zN=()=>p.jsxs(p.Fragment,{children:[p.jsx(j,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The Blacktooth Empire"}),p.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[p.jsx(vi,{planet:"egyptus",label:"Egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(vi,{planet:"penitentiary",label:"Penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(vi,{planet:"safari",label:"Safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(vi,{planet:"bookworld",label:"Book World",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(vi,{planet:"blacktooth",label:"Blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),DN=({playMusic:t=!1})=>{const e=_V(),s=N(gt);return p.jsxs(De,{children:[p.jsx(At,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsxs(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:s,dialogId:"crowns",children:[t&&p.jsx("audio",{src:BN,autoPlay:!0,loop:!0}),p.jsx(zN,{}),p.jsx(Ee,{className:"hidden",children:!e&&p.jsx(zo,{})})]})]})},oc=t=>p.jsx("div",{className:`col-span-3 h-1 ${t}`}),FN=`![](texture-animated-head_walking_towards?float-right&mt-1)**Off**: Original *two-tone* spectrum graphics

**On**: *16-colour* palette with colourised sprites`,LN=`Here for the nostalgia?

Make your fancy new screen look like its 1987 again.`,UN=()=>p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"displayOptions",children:[p.jsx(ws,{path:["Options","Display"],className:ii}),p.jsx("div",{className:ni,children:p.jsxs(Ee,{children:[p.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"colourise",label:"Colourise",valueElement:p.jsx(Js,{className:"ml-auto",value:!ef()}),onSelect:N(es,{path:"displaySettings.uncolourised"}),hint:p.jsx(me,{className:ke,markdown:FN}),verticalAlignItemsCentre:!0}),p.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"crtFilter",verticalAlignItemsCentre:!0,label:p.jsxs("span",{className:"align-top",children:[p.jsxs("span",{className:"bg-shadow zx:bg-pureBlack inline-block",children:[p.jsx(j,{className:"text-midRed zx:text-zxRed",children:"C"}),p.jsx(j,{className:"text-moss zx:text-zxGreen",children:"R"}),p.jsx(j,{className:"text-pastelBlue zx:text-zxBlue",children:"T"})]}),p.jsx(j,{children:" TV Effect"})]}),valueElement:p.jsx(Js,{className:"ml-auto",value:K(LC)}),onSelect:N(es,{path:"displaySettings.crtFilter"}),hint:p.jsx(me,{className:ke,markdown:LN})}),p.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"emulatedResolution",label:"Emulated Resolution",onSelect:N(ot,"emulatedResolution"),opensSubMenu:!0,verticalAlignItemsCentre:!0,hint:p.jsx(me,{className:ke,markdown:"See more of the room by choosing a higher resolution to emulate."})}),p.jsx(L,{hintInline:!0,className:"sprites-double-height",verticalAlignItemsCentre:!0,id:"showFps",label:"Show FPS",valueElement:p.jsx(Js,{className:"ml-auto",value:K(zC)}),onSelect:N(es,{path:"showFps"}),hint:p.jsx(me,{className:ke,markdown:"Frames per second shown during gameplay."})}),p.jsx(oc,{})]})})]}),$N=({resolutionName:t})=>{const e=K($l),s=Qn[t];return p.jsx(L,{id:t,label:`${e===t?"* ":""}${s.name}`,doubleHeightWhenFocussed:!0,hintInline:!0,hint:p.jsxs(j,{className:ke,children:[s.size.x," x ",s.size.y]}),onSelect:N(lf,t)},t)},HN=()=>p.jsx(De,{children:p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"emulatedResolution",children:[p.jsx(ws,{path:["Options","Display","Res."],className:ii}),p.jsx("div",{className:ni,children:p.jsx(Ee,{children:Xx(Qn).map(t=>p.jsx($N,{resolutionName:t},t))})})]})}),WN="/Users/jim/dev/hohjs",GN=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,s=t.split(e),r=[...t.matchAll(e)],n=[];return s.forEach((i,o)=>{n.push(i);const a=r[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){n.push(l);return}const u=`${WN}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),d=h?`:${h[1]}:${h[2]}`:"",f=`vscode://file${u}${d}`;n.push(p.jsx("a",{href:f,target:"_blank",children:c.pathname},o))}catch{n.push(a[0])}}),p.jsx(v.Fragment,{children:n})},YN=t=>{const{message:e,stack:s}=t;if(!s)return{message:e,sanitizedStack:""};const r=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,n=r.test(s);let i=s;n&&(i=i.replace(r,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},KN=`##The game crashed!
You could:

* Open an [issue on Github](https://github.com/jimhigson/head-over-heels-online/issues)
* Email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* Rant on the [Discord server](https://discord.gg/XmV9QNWY)
* Play [the MSX remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,QN=({errors:t})=>{const e=K(o=>o.gameMenus.gameInPlay.reincarnationPoint!==void 0),[s,r]=v.useState(!1),n=N(af),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=YN(o);return`
${a}

${l}
  `}).join(`
    

 ERROR        CAUGHT, WRAPPED, & RETHROWN 


`);return p.jsxs(De,{children:[p.jsx(At,{className:"loading-border"}),p.jsx(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,dialogId:"errorCaught",children:p.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[p.jsx(me,{markdown:KN}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsxs(Ee,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${de}`,children:[p.jsx(L,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:N(ng,"ignore")}),e&&p.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:n}),p.jsx(L,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:N(ng,"clearAllData")}),s?p.jsx(j,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):p.jsx(L,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>r(!0))})]}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsx(j,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),p.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max min-w-full",children:p.jsx(GN,{children:i})})]})})]})},XN=({className:t,keyClassName:e="text-pink zx:text-zxRed"})=>p.jsx("div",{className:`${t} bg-zxBlack py-oneScaledPix`,children:mt()==="desktop"?p.jsxs(p.Fragment,{children:[p.jsx(j,{children:"Press to continue:"}),p.jsx("div",{className:"flex flex-row gap-1 w-min mx-auto",children:p.jsx(Lf,{className:"flex flex-row gap-1",keyClassName:e,action:"hold"})})]}):p.jsxs(p.Fragment,{children:[p.jsx(j,{className:et("me-1",e),children:"Tap"}),p.jsx(j,{children:"to continue"})]})}),JN=()=>p.jsx(De,{children:p.jsxs(Se,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:N(gt),dialogId:"hold",children:[p.jsx(j,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix sprites-uppercase",children:"PAUSED"}),p.jsx("span",{className:"zx",children:p.jsx(XN,{className:`${de} px-1`})})]})}),ZN=({presetName:t})=>{const{description:e}=Pn[t];return p.jsx(L,{hintInline:!0,id:t,label:t,doubleHeightWhenFocussed:!0,hint:e&&p.jsx(j,{className:ke,children:e}),onSelect:N(aP,t)},t)},ez=()=>p.jsx(De,{children:p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"inputPreset",children:[p.jsx(ws,{path:["Options","Controls","Presets"],className:ii}),p.jsx("div",{className:ni,children:p.jsx(Ee,{children:Xx(Pn).map(t=>p.jsx(ZN,{presetName:t},t))})})]})}),tz="1.13.0",ZA="https://github.com/jimhigson/head-over-heels-online/",sz=()=>p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"flex absolute top-oneScaledPix right-1 z-dialog",children:p.jsxs("a",{href:ZA,className:"bitmap-text-link bg-transparent zx:bg-zxBlack",children:[p.jsx(j,{className:"text-highlightBeige zx:text-zxYellow",children:""}),p.jsxs("span",{className:"text-lightGrey zx:text-whiteHalfbrite",children:[p.jsx(j,{className:"resHandheld:hidden",children:" on"}),p.jsx(j,{children:Yb}),p.jsx(j,{className:"resHandheld:hidden",children:"Github"})]})]})}),p.jsx("footer",{className:"flex absolute bottom-0 right-0 z-dialog","data-screenshot-mask":!0,children:p.jsx("a",{href:`${ZA}releases`,target:"_blank",className:"bitmap-text-link bg-pastelBlueHalfbrite text-metallicBlueHalfbrite zx:bg-zxBlack",children:p.jsx(j,{children:`v${tz} `})})})]}),ps=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],rz=({className:t})=>p.jsxs("footer",{className:`flex justify-center gap-2 resHandheld:gap-1 leading-none ${t??""}`,children:[p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(j,{className:"text-pastelBlue zx:text-zxBlack relative left-oneScaledPix",children:"1987 Original"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("address",{className:"flex flex-col items-center relative bottom-oneScaledPix",children:[p.jsx(j,{className:"relative left-[calc(6.5px*var(--scale))]",classnameCycle:ps,children:"Jon"}),p.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ps,children:"Ritman"})]}),p.jsxs("address",{className:"flex flex-col items-center relative bottom-oneScaledPix",children:[p.jsx(j,{classnameCycle:ps,children:"Bernie"}),p.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ps,children:"Drummand"})]})]})]}),p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(j,{className:"text-pink zx:text-zxBlack",children:"2025 Remake"}),p.jsx("address",{className:"flex relative left-[calc(0.5px*var(--scale))] bottom-oneScaledPix",children:p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(j,{className:"relative left-[calc(1.5px*var(--scale))]",classnameCycle:ps,children:"Jim"}),p.jsx(j,{className:"relative bottom-[calc(3px*var(--scale))]",classnameCycle:ps,children:"Higson"})]})})]})]}),Bn=({facingXy8:t,character:e,action:s})=>{switch(e){case"head":{switch(s){case"walking":switch(t){case"away":return Z("texture-animated-head_walking_away");case"towards":return Z("texture-animated-head_walking_towards");case"left":return Z("texture-animated-head_walking_left");case"right":return Z("texture-animated-head_walking_right");case"awayRight":return Z("texture-animated-head_walking_awayRight");case"towardsRight":return Z("texture-animated-head_walking_towardsRight");case"towardsLeft":return Z("texture-animated-head_walking_towardsLeft");case"awayLeft":return Z("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return Z("texture-animated-head_idle_towards");case"right":return Z("texture-animated-head_idle_right");case"awayRight":return Z("texture-animated-head_idle_awayRight");case"towardsRight":return Z("texture-animated-head_idle_towardsRight");case"towardsLeft":return Z("texture-animated-head_idle_towardsLeft");case"away":return Z("texture-head_walking_away_2");case"left":return Z("texture-head_walking_left_2");case"awayLeft":return Z("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(s){case"walking":switch(t){case"away":return Z("texture-animated-heels_walking_away");case"towards":return Z("texture-animated-heels_walking_towards");case"left":return Z("texture-animated-heels_walking_left");case"right":return Z("texture-animated-heels_walking_right");case"awayRight":return Z("texture-animated-heels_walking_awayRight");case"towardsRight":return Z("texture-animated-heels_walking_towardsRight");case"towardsLeft":return Z("texture-animated-heels_walking_towardsLeft");case"awayLeft":return Z("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return Z("texture-animated-heels_idle_towards");case"right":return Z("texture-animated-heels_idle_right");case"awayRight":return Z("texture-heels_walking_awayRight_2");case"towardsRight":return Z("texture-animated-heels_idle_towardsRight");case"towardsLeft":return Z("texture-heels_walking_towardsLeft_2");case"away":return Z("texture-heels_walking_away_2");case"left":return Z("texture-heels_walking_left_2");case"awayLeft":return Z("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},nz=(t,e,s)=>{const r=t.getBoundingClientRect(),n=r.left+r.width/2,i=r.top+r.height/2,o=n-e,a=i-s,c=oj({x:o,y:a});return Bd(c)},ey=({character:t,defaultFacing:e,className:s=""})=>{const[r,n]=v.useState(e),[i,o]=v.useState(!1),a=v.useRef(null);v.useEffect(()=>{const d=m=>{a.current&&n(nz(a.current,m.clientX,m.clientY)||"right")},f=()=>{n(e),o(!1)};return window.addEventListener("mousemove",d),document.addEventListener("mouseleave",f),()=>{window.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",f)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=Bn({character:t,facingXy8:r,action:i?"walking":"idle"});return p.jsxs("div",{ref:a,className:`relative ${s}`,onMouseEnter:l,onMouseLeave:c,children:[p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),p.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound sprite-shadow absolute left-0 top-[calc(var(--scale)*2px)] opacity-halfBrite"})]})},cq=({noSubtitle:t,className:e})=>p.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[p.jsxs("h1",{className:"flex",children:[p.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1 sprites-uppercase",children:[p.jsx(j,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),p.jsx(ey,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),p.jsx(j,{classnameCycle:ps,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),p.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center sprites-uppercase",children:[p.jsx(j,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),p.jsx(ey,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||p.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[p.jsx(j,{className:"text-midRed zx:text-zxCyan",children:"block"}),p.jsx(j,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),p.jsx(j,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),p.jsx(j,{className:"text-moss zx:text-zxWhite",children:"ing"}),p.jsx(j,{classnameCycle:ps,children:" remake"})]})]}),iz=()=>{const t=Tn(),e=N(sP),s=N(ot,"whichGame");return t?p.jsx(L,{id:"playGame",label:p.jsx(j,{children:"Resume the game"}),doubleHeightWhenFocussed:!0,onSelect:e}):p.jsx(L,{id:"playGame",label:p.jsx(j,{children:"Play the game"}),doubleHeightWhenFocussed:!0,onSelect:s,opensSubMenu:!0})},oz=()=>p.jsx(L,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:N(ot,"markdown/installGuide"),opensSubMenu:!0}),az=()=>p.jsx(L,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:N(ot,"sureWantEditor"),opensSubMenu:!0}),lz=()=>{const t=Tn(),e=K(s=>s.gameMenus.gameInPlay.reincarnationPoint!==void 0);return p.jsx(L,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:N(ot,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t,opensSubMenu:!0})},ty="https://discord.gg/Se5Jznc2jm",cz=t=>{const e=Tn(),s=N(ot,"crowns"),r=N(ot,"score"),n=v.useCallback(()=>{s(),r()},[s,r]),i=MS();return p.jsxs(De,{children:[p.jsx(At,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),p.jsxs(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",dialogId:"mainMenu",children:[p.jsx(cq,{noSubtitle:e,className:e?"resHandheld:hidden":""}),p.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1 sprites-uppercase",children:[p.jsxs(Ee,{className:"w-24 mx-auto",children:[p.jsx(iz,{}),!e&&mt()==="desktop"&&p.jsx(az,{}),p.jsx(L,{id:"map",label:"use the Map",onSelect:N(ot,"map"),doubleHeightWhenFocussed:!0,hidden:!e,opensSubMenu:!0}),p.jsx(L,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e,opensSubMenu:!0})]}),p.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[p.jsxs(Ee,{children:[p.jsx(L,{id:"options",label:"Options",doubleHeightWhenFocussed:!0,onSelect:N(ot,"modernisationOptions"),opensSubMenu:!0}),p.jsx(L,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:N(ot,"readTheManual"),opensSubMenu:!0})]}),p.jsxs(Ee,{children:[i?null:p.jsx(oz,{}),p.jsx(L,{id:"discord",leader:p.jsx(j,{children:Gb}),label:p.jsx("a",{href:ty,target:"_blank",children:p.jsx(j,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:v.useCallback(()=>{window.open(ty,"_blank")},[])}),i?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"})]}):null]})]}),e&&p.jsx(Ee,{className:"w-24 mx-auto",children:p.jsx(lz,{})})]}),!e&&p.jsx(rz,{className:"resHandheld:mt-1"})]}),p.jsx(sz,{})]})};var Cu,sy;function Uf(){if(sy)return Cu;sy=1;function t(e){var s=typeof e;return e!=null&&(s=="object"||s=="function")}return Cu=t,Cu}var Pu,ry;function uz(){if(ry)return Pu;ry=1;var t=typeof Do=="object"&&Do&&Do.Object===Object&&Do;return Pu=t,Pu}var Eu,ny;function uq(){if(ny)return Eu;ny=1;var t=uz(),e=typeof self=="object"&&self&&self.Object===Object&&self,s=t||e||Function("return this")();return Eu=s,Eu}var Tu,iy;function hz(){if(iy)return Tu;iy=1;var t=uq(),e=function(){return t.Date.now()};return Tu=e,Tu}var Mu,oy;function dz(){if(oy)return Mu;oy=1;var t=/\s/;function e(s){for(var r=s.length;r--&&t.test(s.charAt(r)););return r}return Mu=e,Mu}var Ru,ay;function fz(){if(ay)return Ru;ay=1;var t=dz(),e=/^\s+/;function s(r){return r&&r.slice(0,t(r)+1).replace(e,"")}return Ru=s,Ru}var Iu,ly;function hq(){if(ly)return Iu;ly=1;var t=uq(),e=t.Symbol;return Iu=e,Iu}var ju,cy;function pz(){if(cy)return ju;cy=1;var t=hq(),e=Object.prototype,s=e.hasOwnProperty,r=e.toString,n=t?t.toStringTag:void 0;function i(o){var a=s.call(o,n),l=o[n];try{o[n]=void 0;var c=!0}catch{}var u=r.call(o);return c&&(a?o[n]=l:delete o[n]),u}return ju=i,ju}var Ou,uy;function mz(){if(uy)return Ou;uy=1;var t=Object.prototype,e=t.toString;function s(r){return e.call(r)}return Ou=s,Ou}var Bu,hy;function gz(){if(hy)return Bu;hy=1;var t=hq(),e=pz(),s=mz(),r="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?n:r:i&&i in Object(a)?e(a):s(a)}return Bu=o,Bu}var Nu,dy;function Az(){if(dy)return Nu;dy=1;function t(e){return e!=null&&typeof e=="object"}return Nu=t,Nu}var zu,fy;function yz(){if(fy)return zu;fy=1;var t=gz(),e=Az(),s="[object Symbol]";function r(n){return typeof n=="symbol"||e(n)&&t(n)==s}return zu=r,zu}var Du,py;function xz(){if(py)return Du;py=1;var t=fz(),e=Uf(),s=yz(),r=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(s(c))return r;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):n.test(c)?r:+c}return Du=l,Du}var Fu,my;function dq(){if(my)return Fu;my=1;var t=Uf(),e=hz(),s=xz(),r="Expected a function",n=Math.max,i=Math.min;function o(a,l,c){var u,h,d,f,m,A,g=0,y=!1,w=!1,x=!0;if(typeof a!="function")throw new TypeError(r);l=s(l)||0,t(c)&&(y=!!c.leading,w="maxWait"in c,d=w?n(s(c.maxWait)||0,l):d,x="trailing"in c?!!c.trailing:x);function b(M){var I=u,z=h;return u=h=void 0,g=M,f=a.apply(z,I),f}function q(M){return g=M,m=setTimeout(S,l),y?b(M):f}function _(M){var I=M-A,z=M-g,E=l-I;return w?i(E,d-z):E}function V(M){var I=M-A,z=M-g;return A===void 0||I>=l||I<0||w&&z>=d}function S(){var M=e();if(V(M))return k(M);m=setTimeout(S,_(M))}function k(M){return m=void 0,x&&u?b(M):(u=h=void 0,f)}function C(){m!==void 0&&clearTimeout(m),g=0,u=A=h=m=void 0}function P(){return m===void 0?f:k(e())}function T(){var M=e(),I=V(M);if(u=arguments,h=this,A=M,I){if(m===void 0)return q(A);if(w)return clearTimeout(m),m=setTimeout(S,l),b(A)}return m===void 0&&(m=setTimeout(S,l)),f}return T.cancel=C,T.flush=P,T}return Fu=o,Fu}var bz=dq();const wz=Ke(bz);var Lu,gy;function Vz(){if(gy)return Lu;gy=1;var t=dq(),e=Uf(),s="Expected a function";function r(n,i,o){var a=!0,l=!0;if(typeof n!="function")throw new TypeError(s);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(n,i,{leading:a,maxWait:i,trailing:l})}return Lu=r,Lu}var qz=Vz();const vz=Ke(qz),_z=(t,e,s,r)=>{switch(e){case"debounce":return wz(t,s,r);case"throttle":return vz(t,s,r);default:return t}},Sz=t=>{const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>((...s)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...s)}),[])},kz=t=>{const[e,s]=v.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&s(t.current)},0),{refProxy:v.useMemo(()=>new Proxy(n=>{n!==e&&s(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,o){return i==="current"?s(o):n[i]=o,!0}}),[e]),refElement:e,setRefElement:s}},Cz=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function Pz({skipOnMount:t=!1,refreshMode:e,refreshRate:s=1e3,refreshOptions:r,handleWidth:n=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=v.useRef(t),u=Sz(l),[h,d]=v.useState({width:void 0,height:void 0}),{refProxy:f,refElement:m}=kz(o),{box:A}=a||{},g=v.useCallback(w=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const x=(b,q)=>n&&b.width!==q.width||i&&b.height!==q.height;w.forEach(b=>{const q=Cz(b,A);d(_=>x(_,q)?(u?.({width:q.width,height:q.height,entry:b}),q):_)})},[n,i,c,A]),y=v.useCallback(_z(g,e,s,r),[g,e,s,r]);return v.useEffect(()=>{let w;return m?(w=new window.ResizeObserver(y),w.observe(m,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),d({width:void 0,height:void 0})),()=>{var x,b,q;(x=w?.disconnect)===null||x===void 0||x.call(w),(q=(b=y).cancel)===null||q===void 0||q.call(b)}},[y,m]),Object.assign({ref:f},h)}const X={w:16,d:16,h:12},Qi={x:16,y:16,z:12},Ez=["head","heels"],Tz=[...Ez,"headOverHeels"],_n=t=>t==="head"?"heels":"head",fq="@@original",Mz="original",Rz={userId:fq,campaignName:Mz,version:-1},Te=(...t)=>{if(t.length===1){const[e]=t;return s=>s.type===e}return e=>t.includes(e.type)},Iz=Te("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),jz=(t,e)=>Iz(t)||_r(t)&&(e!==void 0&&Cl(e)||t.config.direction.z!==0)||xq(t)&&t.config.floorType==="none",Zs=(t,e)=>!jz(t,e),Oz=t=>t.type==="movingPlatform"||t.type==="pushableBlock",$f=(t,e,s=!1)=>Rr(e)&&!(!s&&Cl(e)&&e.state.autoWalk)&&!(yq(t)&&Oz(e))&&!(Hf(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),pq=["ball","slidingBlock","slidingDeadly"],Bz=Te(...pq),Nz=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],zz=["dalek","turtle","elephantHead","homingBot","helicopterBug"],m$=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?zz.includes(t.config.which):Nz.includes(t.type),Cl=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function Rr(t){return mq.includes(t.type)}const mq=[...Tz,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],Dz=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],Fz=Te(...Dz),Ay=t=>Hf(t)&&!t.state.activated?!1:Fz(t)||t.type==="floor"&&t.config.floorType==="deadly",Lz=t=>t.config.times!==void 0,_r=Te("portal"),g$=Te("teleporter"),gq=Te("heels"),Aq=Te("head"),Pl=Te("headOverHeels"),A$=Te("heels","headOverHeels"),y$=Te("head","headOverHeels"),yq=Te("lift"),x$=Te("button"),b$=Te("emitter"),Hf=Te("monster"),xq=Te("floor"),Uz=Te("pickup"),w$=t=>t.type==="button"||t.type==="switch"&&t.config.type==="in-room",V$=t=>Uz(t)&&t.config.gives==="crown",q$=Te("spring"),$z=Te("joystick"),v$=Te("conveyor"),Hz=Te("hushPuppy"),_$=Te("firedDoughnut"),S$=Te("wall","doorFrame"),k$=Te("monster","movingPlatform"),C$=t=>Hf(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,Fs=(t,e)=>t.characterRooms[e]?.items[e],P$=t=>Fs(t,t.currentCharacterName),E$=t=>{if(Aq(t))return t.state;if(Pl(t))return t.state.head},Wz=t=>{if(gq(t))return t.state;if(Pl(t))return t.state.heels},Gz=(t,e)=>{const s=Fs(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(s!==void 0){if(e==="head"&&Aq(s)||e==="heels"&&gq(s))return s.state;if(e==="head"&&Pl(s))return s.state.head;if(e==="heels"&&Pl(s))return s.state.heels}},T$=Gz,Yz=t=>{const e=Fs(t,"head"),s=Fs(t,"heels");return e!==void 0&&s!==void 0&&e.state.action==="idle"&&s.state.action==="idle"&&e.state.standingOnItemId==="heels"},sd=(t,e)=>e?.[t],Kz=t=>Ls(t),jt=t=>Ye(Kz(t)),M$=t=>Ye(Nd(t)),R$=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),$t=Symbol("roomSpatialIndexKey"),ut={x:12,y:12,z:X.h},Qz={x:14,y:14,z:X.h},Sr={x:16,y:16,z:X.h},Qa={...ut,z:X.h*2},Wf=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:ut};case"slidingBlock":return t.config.style==="book"?{aabb:Sr}:{aabb:ut};case"lift":return{aabb:{...ut,z:ut.z}};case"switch":return{aabb:{...ut,z:ut.z}};case"button":return{aabb:{x:15,y:15,z:2}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:ut};case"charles":return{aabb:Qa};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:Sr};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:Sr};case"tower":return{aabb:{x:11,y:11,z:X.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...ut,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:Qa};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:ut};case"turtle":return{aabb:ut};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:Sr};case"bubbles":return{aabb:ut};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:Sr};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:X.h}:{x:15,y:3,z:X.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:Qa}:{aabb:ut};case"emitter":return{aabb:Q};default:return{aabb:Qz}}},it={aabb:ut,castsShadowWhileStoodOn:!1},ac=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),I$=t=>t.type==="wall"?ac(t.config):Lz(t)?t.config.times:void 0,bo=(t=Eo)=>({x:t.x??1,y:t.y??1,z:t.z??1}),j$=t=>({x:t.x??1,y:t.y??1}),yy=t=>{const e=s=>s.config.times!==void 0;return t.type==="wall"?bo(ac(t.config)):e(t)?bo(t.config.times):Eo},Xz=t=>{const e=s=>s.config.times!==void 0;return t.type==="wall"?bo(ac(t.config)):e(t)?bo(t.config.times):Eo},O$=t=>{const e={};let s=!1;return t.x!==1&&(e.x=t.x,s=!0),t.y!==1&&(e.y=t.y,s=!0),t.z!==1&&(e.z=t.z,s=!0),s?e:void 0},wo=(t,e={})=>{const s=bo(e),r=Bs(Qi,t);return C_(q_(s,Qi),r)},B$=1e3,Ir=-2,Be=Number.MIN_SAFE_INTEGER,bq=Mo/1e3,N$={head:15e-5,heels:15e-5},z$=1e3/110,D$=240,Jz=2e-4,Zz={head:X.h*2/1e3,others:X.h*6/1e3},F$=Jz*.13,L$=Zz.others*.85,U$=.8,$$=.001,wq={head:1,heels:2,charles:1,dalek:Math.SQRT2,bubbleRobot:(Math.SQRT2+1)/2,cyberman:1,skiHead:1,helicopterBug:1,homingBot:2,monkey:1,elephant:1,elephantHead:0,emperor:1,emperorsGuardian:Math.SQRT2,computerBot:1,turtle:1,ball:2.625,firedDoughnut:2,movingPlatform:1,floatingText:1},H$=zd(wq,([t,e])=>[t,e*bq]),e2=zd(wq,([t,e])=>[t,(e*.8+.4)*bq]),W$=1.5,t2=(t=1)=>t*Mo/1e3,G$=t2(),Y$=2,xy=1.1,K$={head:X.h*2.6+xy,heels:X.h+1+xy},s2=10,Q$=6e4,r2=8,X$=750,J$=1500,Z$=200,eH=.25,tH=150,n2=8,i2=Mt.h-Mt.w/2,Vq=i2+2,Gf=9999,sH=1e3/12,o2=1e3/12,rH=100,nH=({x:t=0,y:e=0})=>e-t,Re=({x:t=0,y:e=0,z:s=0})=>({x:e-t,y:-(t+e)/2-s}),Le=({x:t=0,y:e=0,z:s=0})=>({x:t*X.w,y:e*X.d,z:s*X.h}),iH=t=>Re(Le(t)),rd=t=>{const e=Le(t.position),{aabb:s}=Wf(t);if(s===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:W(e,{x:X.w-s.x>>1,y:X.d-s.y>>1})},Je=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Be,stoodOnUntilRoomTime:Be,actedOnAt:{roomTime:Be,by:pe}}),qq=()=>({gravity:Q,movingFloor:Q}),Nn=()=>({vels:qq(),latentMovement:[],collidedWith:{roomTime:Be,by:pe},controlledWithJoystickAtRoomTime:Be,standingOnItemId:null,standingOnUntilRoomTime:Be,previousStandingOnItemId:null}),a2=t=>{const e=mq.includes(t.type);return{...Je(),position:rd(t),...e?{...Nn(),vels:{...qq(),...pq.includes(t.type)?{sliding:Q}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:Q}:{}}}:{},...t.type==="joystick"||t.type==="emitter"||t.type==="lift"||t.type==="conveyor"||t.type==="teleporter"?{...structuredClone(t.config)}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:fe[t.config.startDirection]}:{facing:fe.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:fe[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,lastToggledAtRoomTime:Be}:{},...t.type==="button"?{pressed:!1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:Q}}:{},...t.type==="charles"?{facing:fe.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Be,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?Gt(fe[t.config.direction],e2.firedDoughnut):Q}}:{}}},l2=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,Uu=X.h*2,c2=4,Ta=X.h*c2,u2=2,h2=.5,by=2;function*d2(t,e){const{config:{direction:s},position:r}=t,n=jx(s),i=Dl(n),o=l2(t),a={...Q,[i]:o?-.5:0},l=1,c={[i]:o?-l:0},u=l*X.w,h={...Q,[i]:u},d=9,f=8,m=8;{const A={[n]:f,[i]:m,z:Ta};yield{...t,...it,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...Je(),position:Le(W(r,{[n]:1.5},a,c)),stoodOnBy:pe},aabb:W(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:d,[i]:m,z:Ta};yield{...t,...it,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...Je(),position:Le(W(r,a,c)),stoodOnBy:pe},aabb:W(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:2*X.w-d-f,[i]:m,z:Ta-Uu};yield{...t,...it,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...Je(),position:W(Le(W(r,a,c)),{[n]:d,z:Uu}),stoodOnBy:pe},aabb:W(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}yield{...t,...it,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...Je(),position:W(Le(W(r,a,c)),{z:Ta}),stoodOnBy:pe},aabb:W(Le({[n]:2,[i]:l}),{[i]:m,z:Gf}),renderAabb:Q,fixedZIndex:Ir},yield{...t,...it,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...no(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:Le({...Q,[i]:o?l+.25:-.25}),direction:fe[s]},fixedZIndex:Ir,state:{...Je(),position:W(Le(W(r,{[i]:o?-.5-l:.5})),{[n]:d}),stoodOnBy:pe},aabb:{[n]:u2*X.w-d-f,[i]:u,z:Uu}},r.z!==0&&(yield{...t,...it,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:r.z},renders:!0,shadowCastTexture:o?{textureId:"shadow.door.floatingThreshold.double.y",flipX:n==="x"}:void 0,castsShadowWhileStoodOn:o,state:{...Je(),position:{...Le(W(r,a,c)),z:0}},aabb:W(Le({[n]:2,[i]:.5,z:r.z}),h),renderAabb:o?W(Le({[n]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?W({[n]:0,[i]:0,z:(r.z-.5)*X.h},{[i]:h[i]}):void 0,shadowOffset:{z:r.z*X.h,[i]:o?h[i]:void 0}}),yield{...it,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:Le({[n]:2,[i]:by,z:2}),config:{},fixedZIndex:Ir,state:{...Je(),position:Le(Bs(r,Gt(fe[s],h2),o?Q:{[i]:by})),stoodOnBy:pe}}}const wy=3,Vy=10,qy=.52,Ma=.5,f2=(t,e,s)=>{const{config:{times:r},position:n}=e,i=W(n,{z:-wy}),o={...r,z:wy};let a=i,l=o;const c=Ye(Ls(s.items)).filter(d=>d.type==="door");if(n.z===0){const d={};for(const f of c){const{position:m,config:{direction:A}}=f;switch(A){case"towards":!d.towards&&m.y===i.y&&m.x>=i.x&&m.x<=i.x+r.x-2&&(l=W(l,{y:Ma}),a=W(a,{y:-Ma}),d.towards=!0);break;case"away":!d.away&&m.y===i.y+r.y&&m.x>=i.x&&m.x<=i.x+r.x-2&&(l=W(l,{y:qy}),d.away=!0);break;case"right":!d.right&&m.x===i.x&&m.y>=i.y&&m.y<=i.y+r.y-2&&(l=W(l,{x:Ma}),a=W(a,{x:-Ma}),d.right=!0);break;case"left":!d.left&&m.x===i.x+r.x&&m.y>=i.y&&m.y<=i.y+r.y-2&&(l=W(l,{x:qy}),d.left=!0);break}}}const u=Le(a),h=wo(Sr,l);return{...it,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:wo(Sr,o),position:Le(i)}},aabb:h,renderAabb:{...h,z:Vy},renderAabbOffset:{...Q,z:h.z-Vy},shadowCastTexture:"shadow.fullBlock",state:{...Je(),position:u}}},El={config:pe,shadowCastTexture:"shadow.playable",castsShadowWhileStoodOn:!0,aabb:ut},Vo=()=>{const t=Bb(ue.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:fe.towards,walkStartFacing:fe.towards,walkDistance:0,vels:{walking:Q,gravity:Q,movingFloor:Q},switchedToAt:Be,lastDiedAt:Be,gameTime:0,jumpStartTime:Be,lives:t?"infinite":r2,jumpStartZ:0}},p2=(t,e)=>{const s=Nb(ue.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...it,...El,state:{...Je(),...Nn(),...Vo(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Be,shieldCollectedAt:Be,doughnuts:s?"infinite":0,position:rd(t),stoodOnUntilRoomTime:Be}}:{id:e,jsonItemId:e,type:"heels",...it,...El,state:{...Je(),...Nn(),...Vo(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Be,position:rd(t),stoodOnUntilRoomTime:Be}}},m2=t=>t==="towards"||t==="right",Yf=1,g2={x:X.w,y:X.d*Yf,z:Gf},A2={x:X.w,y:0,z:Vq},y2={x:X.w*Yf,y:X.d,z:Gf},x2={x:0,y:X.d,z:Vq},b2=(t,e)=>{const{config:{direction:s},position:r}=e,n=ac(e.config),i=jx(s),o=Dl(i),a=m2(s),l={...Q,[o]:a?-Yf:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:wo(i==="y"?y2:g2,n),renderAabb:a?Q:wo(i==="y"?x2:A2,n),fixedZIndex:a?Ir:void 0,state:{...Je(),position:Le(W(r,l)),stoodOnBy:pe},shadowCastTexture:i==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0},castsShadowWhileStoodOn:a}};function*Kf(t,e,s,r=pe,n={},i=""){if(!r[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&n[e.config.page]))switch(!0){case e.type==="door":return yield*d2(e,t);case e.type==="player":{yield p2(e,t);return}case e.type==="wall":{yield b2(t,e);return}case e.type==="floor":{yield f2(t,e,s);return}case(e.type==="block"&&e.config.disappearing!==void 0&&Wn(yy(e))>=2):{const o=yy(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=$n(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=Eo});yield*Kf(t,u,s,r,n,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!ue.getState().gameMenus.gameInPlay.planetsLiberated[e.config.planet]):return;default:{const o=Wf(e),a=e.config.times!==void 0?{aabb:wo(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=a2(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...it,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Ir:void 0,shadowCastTexture:w2(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="cyberman"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const w2=t=>{switch(t.type){case"lift":return{animationId:"shadow.lift"};case"switch":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Ix(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}},V2=({gameState:t,room:e,itemType:s,config:r,position:n,additionalIdPart:i})=>{const o={type:s,config:r,position:Q},a=`${s}/${i}`,l=Gx(Kf(a,o,e.roomJson,t.pickupsCollected[e.id]??pe));if(l===void 0)throw console.error("failed to generate any items for json",a,o),new Error("failed to generate any items");return zn({room:e,item:l,atPosition:n}),l},zn=({room:t,item:e,atPosition:s})=>(t.items[e.id]=e,s!==void 0&&(e.state.position=s),t[$t].addItem(e),e),q2=(t,e)=>Ye(Jx(t)).map(s=>{const r=e.items[s];if(r===void 0)throw new Error(`item ${s} in stoodOnBy is not in the room`);return r});function vq(t,e){return t===null?null:e.items[t]}const oH=(t,{standingOnItemId:e,standingOnUntilRoomTime:s,previousStandingOnItemId:r,jumped:n})=>e!==null?e:!n&&s+o2>t.roomTime&&t.items[r]?r:null,nd=(t,e)=>{if(t.state.standingOnItemId!==null){const s=vq(t.state.standingOnItemId,e);delete s.state.stoodOnBy[t.id],t.state.previousStandingOnItemId=t.state.standingOnItemId,t.state.standingOnItemId=null,s.state.stoodOnUntilRoomTime=e.roomTime,t.state.standingOnUntilRoomTime=e.roomTime}},Dn=({room:t,item:e})=>{const s=_q({room:t,item:e});t[$t].removeItem(s)},_q=({room:t,item:e})=>{const s=typeof e=="string"?t.items[e]:e;Rr(s)&&nd(s,t);for(const r of q2(s.state.stoodOnBy,t))nd(r,t);return typeof e=="string"?delete t.items[e]:delete t.items[s.id],s},Qf=({above:t,below:e})=>{const s=e.state.stoodOnBy;if(!Object.isExtensible(s))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.previousStandingOnItemId=t.state.standingOnItemId,t.state.standingOnItemId=e.id,s[t.id]=!0},v2=t=>{const e={id:"head",type:"head",...it,...El,state:{...Je(),...Nn(),...Vo(),...t.state.head,facing:t.state.facing,position:W(t.state.position,{z:X.h}),switchedToAt:Be,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},s={id:"heels",type:"heels",...it,...El,state:{...Je(),...Nn(),...Vo(),...t.state.heels,facing:t.state.facing,position:W(t.state.position),switchedToAt:Be,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:s}},_2=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...it,shadowCastTexture:e.shadowCastTexture,castsShadowWhileStoodOn:e.castsShadowWhileStoodOn,config:pe,aabb:Qa,state:{...Je(),...Nn(),...Vo(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...no(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Be},heels:{...no(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Be}}}),S2=t=>{const e=t.characterRooms.head,s=Fs(t,"head"),r=Fs(t,"heels"),n=_2({head:s,heels:r});Dn({room:e,item:"head"}),Dn({room:e,item:"heels"}),zn({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},k2=(t,e)=>{const s=t.characterRooms.headOverHeels,r=Fs(t,"headOverHeels"),n=e??_n(t.previousPlayable),{head:i,heels:o}=v2(r);Dn({room:s,item:"headOverHeels"}),zn({room:s,item:i}),zn({room:s,item:o}),Qf({above:i,below:o}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:s,heels:s,headOverHeels:void 0}},C2=t=>{const e=Fs(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},Xa=(t,e)=>{Yz(t)&&(!e||e===t.currentCharacterName)?S2(t):t.currentCharacterName==="headOverHeels"?k2(t,e):(!e||e!==t.currentCharacterName)&&Fs(t,_n(t.currentCharacterName))!==void 0&&(t.currentCharacterName=_n(t.currentCharacterName)),C2(t)},$u=4,Hu=Ei.h,Sq=()=>{const t=Oo(),e=v.useRef(null),s=v.useCallback((r,n="lines")=>{if(e.current===null)return;const{scrollTop:i,scrollLeft:o}=e.current,a=fe[r],l=n==="all"?a.y<0?9999:0:n==="lines"?i+t*$u*-a.y*Hu:i+-a.y*(e.current?.getBoundingClientRect().height-t*Hu*$u),c=o+t*$u*a.x*Hu;e.current.scrollTo({left:c,top:l,behavior:"smooth"})},[t]);return Ve({handler:v.useCallback(()=>{s("towards")},[s]),action:"towards"}),Ve({handler:v.useCallback(()=>{s("away")},[s]),action:"away"}),Ve({handler:v.useCallback(()=>{s("towards","pages")},[s]),action:"pageDown"}),Ve({handler:v.useCallback(()=>{s("away","pages")},[s]),action:"pageUp"}),Ve({handler:v.useCallback(()=>{s("towards","all")},[s]),action:"end"}),Ve({handler:v.useCallback(()=>{s("away","all")},[s]),action:"home"}),Ve({handler:v.useCallback(()=>{s("left")},[s]),action:"left"}),Ve({handler:v.useCallback(()=>{s("right")},[s]),action:"right"}),e},P2=(t,e,s)=>{if(e==="*")return!0;const r=s.meta.subRooms[e];return t.x>=r.physicalPosition.from.x&&t.y>=r.physicalPosition.from.y&&t.x<=r.physicalPosition.to.x&&t.y<=r.physicalPosition.to.y},E2=({position:t},e,s)=>P2(t,e,s),T2=(t,e,s)=>{if(e==="*")return 0;const r=s.meta.subRooms[e],{from:n,to:i}=r.physicalPosition;if(t.x>=n.x&&t.y>=n.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<n.x?o=n.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<n.y?a=n.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},Xf=(t,e,s)=>{const r=s.meta?.subRooms;if(r===void 0)return"*";let n,i=1/0;const o=e==="fine"?{x:t.x/X.w,y:t.y/X.d}:t;for(const a of Jx(r)){const l=T2(o,a,s);if(l===0)return a;l<i&&(i=l,n=a)}if(n===void 0)throw new Error(`item not found in any subroom of ${s.id}
      item at  ${JSON.stringify(o)}
      subrooms ${JSON.stringify(s.meta?.subRooms,null,2)}`);return n},H=48,Rs=36,qo=.55,qt=H*((1-qo)/2),Vt=H-qt,vo=8,Pr=128,kr=({mapTitle:t,y:e=0,className:s,textOnly:r=!1})=>{const n=Oo();return p.jsxs("g",{className:s,children:[r||p.jsx("rect",{y:e,width:1e4,height:1e4}),p.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:vo,y:e+16,children:p.jsx(j,{className:`left-2 relative sprites-double-height ${de}`,children:t})})]})},Ys={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},M2=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.highlightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},kq=t=>(t&&Ys[t])??{bgClassName:"fill-shadow",containerClassName:""},Wt=t=>({x:(t.x??0)*H,y:(t.y??0)*H,z:(t.z??0)*Rs}),Fn=t=>Math.round(t*10)/10,Jf=t=>{const e=Re(t);return`translate(${Fn(e.x)},${Fn(e.y)})`},$=t=>{const e=Re(t);return Tt(e)},Tt=t=>`${Fn(t.x)},${Fn(t.y)}`,R2=({originalCampaignPositions:t,mapBounds:e,containerWidth:s})=>{const r=Oo(),n=e.r-e.l+2*vo,i={x:-e.l+vo+(s-n)/2,y:-e.t+Pr},o=(x,b=Q)=>Xs(i,Re(Wt(W(t[x].gridPosition,b)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),d=o("blacktooth53market/*",{x:0,y:1,z:0}),f=o("blacktooth53market/*",{x:1,y:1,z:0}),m=o("blacktooth52market/*",{x:1,y:.5,z:0}),A=r*8*2,g="Market",y=(g.length+3)*r*8,w=r*8*2+32;return p.jsxs(p.Fragment,{children:[p.jsx("path",{className:`${Ys.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Tt({x:A,y:m.y+w})}
L ${Tt({x:y,y:m.y+w})}
L ${Tt({x:y,y:a.y})}
L ${Tt(a)}
L ${Tt(l)}
L ${Tt(c)}
L ${Tt(u)}
L ${Tt(h)}
L ${Tt(d)}
L ${Tt(f)}
L ${Tt(m)}
L ${Tt({...m,x:A})}
z`}),p.jsx(kr,{y:m.y,mapTitle:g,className:Ys.market.bgClassName,textOnly:!0})]})},I2=({gridPositions:t,mapBounds:e,containerWidth:s})=>{const r=t,n=Re(Wt({x:1,y:1,z:0})).y,i=(o,a)=>{if(r[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(r[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=Re(Wt(r[o].gridPosition)).y,c=Re(Wt(r[a].gridPosition)).y+n;return(l+c)/2};return p.jsxs(p.Fragment,{children:[p.jsx(kr,{y:0,mapTitle:"Freedom",className:Ys.freedom.bgClassName}),p.jsx(kr,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+Pr,mapTitle:"Castle Blacktooth",className:Ys.blacktooth.bgClassName}),p.jsx(kr,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+Pr,mapTitle:"Moonbase",className:Ys.moonbase.bgClassName}),p.jsx(kr,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+Pr,mapTitle:"Blacktooth escape",className:Ys.blacktooth.bgClassName}),p.jsx(R2,{mapBounds:e,originalCampaignPositions:r,containerWidth:s}),p.jsx(kr,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+Pr,mapTitle:"Jail",className:Ys.jail.bgClassName})]})},j2={blacktooth:"Blacktooth",bookworld:"Bookworld",jail:"Blacktooth",egyptus:"Egyptus",moonbase:"Moonbase",market:"Market",penitentiary:"Penitentiary",safari:"Safari"},O2=t=>{const{campaign:e,curRoomId:s}=t,r=e.locator.userId===fq&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[s].planet),n=kq(t.curRoomScenery);return r?p.jsx(I2,{...t}):p.jsx(kr,{mapTitle:j2[e.rooms[s].planet],className:n.bgClassName})},vy=t=>k_(Gt(t.aabb,.5),t.state.position),B2={x:1,y:1,z:1},_y=(t,e,s)=>e===s?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(s-e),aH=t=>t,N2=t=>Ls(t.items),z2=t=>Nd(t),D2=t=>Ye(N2(t)),lH=(t,...e)=>{const s=Ye(z2(t));return e.length===0?s:s.filter(([,r])=>e.includes(r.type))},F2={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},cH=t=>jt(t.items).reduce((e,s)=>{if(s.type==="floor"){const{config:{naturalFootprint:r},state:{position:n},renderAabb:i,renderAabbOffset:o,aabb:a}=s,l=Re(W(r.position,{x:r.aabb.x,z:r.aabb.z})).x,c=Re(W(r.position,{y:r.aabb.y,z:r.aabb.z})).x,u=Re(W(r.position,r.aabb)).y,h=Re(W(n,o??Q,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const r=Re(W(s.state.position,s.renderAabb??s.aabb??Q,s.renderAabbOffset??Q)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,r)},floors:e.floors}}},F2),L2={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},Cq=t=>{const e=D2(t).filter(s=>s.type==="floor").reduce((s,r)=>{const{position:n,config:{times:i}}=r;return{from:{x:Math.min(s.from.x,n.x),y:Math.min(s.from.y,n.y),z:Math.min(s.from.z,n.z)},to:{x:Math.max(s.to.x,n.x+i.x),y:Math.max(s.to.y,n.y+i.y),z:Math.max(s.to.z,n.z)}}},L2);if(isFinite(e.from.x))return e},Pq=({svg:t=!1,smooth:e=!1})=>{const s=v.useRef(null);return v.useLayoutEffect(()=>{s.current?.scrollIntoView({behavior:e?"smooth":"instant",block:"center"})}),t?p.jsx("g",{ref:s}):p.jsx("div",{ref:s})},Ja=({className:t,scrollTo:e=!1,onClick:s,yAdjust:r=0})=>p.jsxs("foreignObject",{x:-50,y:-100+r,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[p.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:s,style:s?{pointerEvents:"all"}:{}}),e&&p.jsx(Pq,{})]}),Bi=({characterName:t,facing:e,isCurrent:s=!1,onlyPlayableInRoom:r=!1,yAdjust:n=0,onClick:i})=>p.jsx(Ja,{className:`${r?"[--scale:2.5]":"[--scale:1.5]"}
                ${Bn({character:t,action:s?"walking":"idle",facingXy8:Bd(e)??"towards"})}`,scrollTo:s,yAdjust:n,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),U2=({item:t})=>{const s=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{className:`${s} texture-lift_static`}),p.jsx(Ja,{className:`${s} texture-lift_2`})]});const r=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return p.jsx(Ja,{className:`${s} ${r}`})},$2=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],H2=({x:t,y:e},{x:s,y:r})=>(t-s)**2+(e-r)**2,W2=(t,e)=>{const s=t%3,r=Math.floor(t/3),n=e%3,i=Math.floor(e/3);return Math.abs(s-n)<=1&&Math.abs(r-i)<=1&&t!==e},Sy=t=>t.some((e,s)=>t.slice(s+1).some(r=>W2(e,r))),Xi=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[s,...r]=t;return[...Xi(r,e),...Xi(r,e-1).map(n=>[s,...n])]},Eq=t=>t.length<=1?[t]:t.flatMap((e,s)=>Eq([...t.slice(0,s),...t.slice(s+1)]).map(r=>[e,...r])),ky={1:Xi([...Array(9).keys()],1),2:Xi([...Array(9).keys()],2).filter(t=>!Sy(t)),3:Xi([...Array(9).keys()],3).filter(t=>!Sy(t))},id=3,Tq=({items:t,itemNormalisedPosition:e})=>{const s=To(t),r=s.length;if(r===0)return pe;if(r>id)throw new Error(`roomItemPositions supports up to ${id} items, but got ${r}: ${Object.keys(t).join(", ")}`);const n=s.map(([a,l])=>({id:a,pos:e(l)}));let i=pe,o=1/0;if(ky[r]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${r}`);for(const a of ky[r]){const l=a.map(c=>$2[c]);for(const c of Eq(l)){const u={};let h=0;for(let d=0;d<r;d++){const{id:f,pos:m}=n[d],A=c[d];u[f]=A,h+=H2(m,A)}h<o&&(o=h,i=u)}}return i},Mq=({items:t,positions:e,ItemComponent:s})=>p.jsx("g",{"data-class":"items",children:To(e).sort(([r,n],[i,o])=>o.y-n.y+(o.x-n.x)).map(([r,n])=>p.jsx("g",{"data-position":JSON.stringify(n),transform:`${Jf(Ox(n,H*.5))} translate(0,-3)`,children:p.jsx(s,{item:t[r]})},r))}),G2=(t,e)=>{if(t==="*"){const s=Cq(e);if(s===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return s}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},Y2=({items:t,roomJson:e,subRoomId:s})=>{const r=v.useMemo(()=>Tq({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??pe,...B2},a=Xs(i.position,Gt(o,.5)),l=G2(s,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,s]);return p.jsx(Mq,{ItemComponent:U2,items:t,positions:r})},K2=({headItemInRoom:t,heelsItemInRoom:e,roomJson:s,currentCharacterName:r,onClick:n})=>{const i=v.useMemo(()=>({item:{type:l,state:{facing:c}}})=>p.jsx(Bi,{characterName:l,facing:c,isCurrent:r===l,onlyPlayableInRoom:!1,onClick:n}),[r,n]),o=v.useMemo(()=>({head:t,heels:e}),[t,e]),a=v.useMemo(()=>Tq({items:o,itemNormalisedPosition:c=>{const u=vy(c),h=Nx(vy(c),{x:1/X.w,y:1/X.d,z:1}),d=Cq(s);if(d===void 0)throw new Error(`no floors in room ${s.id} when trying to get item position`);return{x:_y(h.x,d.from.x,d.to.x),y:_y(u.y,d.from.y,d.to.y)}}}),[o,s]);return p.jsx(Mq,{ItemComponent:i,items:o,positions:a})},Q2=(t,e,s)=>E2(t,e,s)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),X2=(t,e)=>{const s=Object.entries(t);if(s.length<=e)return t;const r=Object.groupBy(s,i=>i[1].type),n=xS(e,pS(...Ls(r)));return Object.fromEntries(n)},J2=(t,e,s)=>v.useMemo(()=>{let r=!1,n=!1;const i=Ye(To(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(r)return!1;r=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(n)return!1;n=!0}return!0}).filter(o=>Q2(o[1],s,t));return X2(Gn(i),id)},[t,e,s]),Rq=.15,Ra=Re(Wt({x:.5,y:.5,z:0})),Cy=Re(Wt({x:Rq,y:0,z:0})),Py=Re(Wt({x:Rq*1.66,y:0,z:0})),Z2=({className:t})=>p.jsxs(p.Fragment,{children:[p.jsx("ellipse",{className:"fill-white",cx:Ra.x,cy:Ra.y,rx:Math.abs(Py.x),ry:Math.abs(Py.y)}),p.jsx("ellipse",{className:t,cx:Ra.x,cy:Ra.y,rx:Math.abs(Cy.x),ry:Math.abs(Cy.y)})]}),Lt=3,Ey=Bx(Re({x:H,y:0})),Ia={wall:void 0,open:"0,999",doorway:`${Fn(Ey*((1-qo)/2)-Lt/2)}, ${Fn(Ey*qo+Lt)}, 999`},Wu=`
M ${$({})}
L ${$({y:H})}
L ${$({x:H,y:H})}
L ${$({x:H})}
z`,ja=(t,e=qo)=>{const s=H*((1-e)/2),r=H-s,n=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${$({x:s,y:s})}`;return a&&(l+=`L${$({x:0,y:s})} L${$({x:0,y:r})}`),l+=`L${$({x:s,y:r})}`,n&&(l+=`L${$({x:s,y:H})} L${$({x:r,y:H})}`),l+=`L${$({x:r,y:r})}`,o&&(l+=`L${$({x:H,y:r})} L${$({x:H,y:s})}`),l+=`L${$({x:r,y:s})}`,i&&(l+=`L${$({x:r,y:0})} L${$({x:s,y:0})}`),l+="z",l},Gu=4,eD=Ye(Kx(Gu)).map(t=>`
M${$({x:H*((t+.5)/Gu),y:0})}
L${$({x:H*((t+.5)/Gu),y:H})}`).toArray().join(""),Ty=t=>{const e=`
M${$({x:0,y:H})}
L${$({x:0,y:H,z:Rs})}
L${$({x:H,y:H,z:Rs})}
L${$({x:H,y:H})}
z
`;return t?e+`
M${$({x:qt,y:H})}
L${$({x:qt,y:H,z:Rs})}
L${$({x:Vt,y:H,z:Rs})}
L${$({x:Vt,y:H})}
L${$({x:qt,y:H})}`:e},tD=`            
M${$({x:H,y:H,z:Rs})}            
L${$({x:H,y:H})}            
M${$({x:H,y:0,z:Rs})}            
L${$({x:H,y:0})}            
M${$({x:0,y:H,z:Rs})}            
L${$({x:0,y:H})}            
`,sD=`            
M${$({x:0,y:0,z:Rs})}            
L0, 0            
`,rD=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:s,roomJson:r,roomVisited:n,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:d,color:f,items:m}=r,A=r.meta?.label,g=J2(r,s,e),y=Object.values(m).filter(b=>b.type==="floor"),w=y.every(b=>b.config.floorType==="none"),x=y.some(b=>b.config.floorType==="deadly");return p.jsxs("g",{"data-room-id":h,strokeWidth:Lt,className:M2(f),children:[w?p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${Wu} ${ja(t)}`}),p.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${ja(t)} ${ja(t,qo*.7)}`})]}):p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:Wu}),p.jsx("path",{className:"fill-white",d:ja(t)}),x&&p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:eD})]}),r.id==="blacktooth11"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${$({x:qt,y:qt})}
L${$({x:Vt,y:qt})}
L${$({x:Vt,y:qt-Lt*2})}
L${$({x:qt,y:qt-Lt*2})}
z
M${$({x:qt,y:Vt})}
L${$({x:Vt,y:Vt})}
L${$({x:Vt,y:Vt+Lt*2})}
L${$({x:qt,y:Vt+Lt*2})}
z
`}):r.id==="moonbase20"||r.id==="moonbase23"?p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Lt*2,d:`
M${$({x:qt,y:H/2})}
L${$({x:Vt,y:H/2})}

M${$({x:H/2,y:qt})}
L${$({x:Vt,y:H/2})}

M${$({x:H/2,y:Vt})}
L${$({x:Vt,y:H/2})}
`}):r.id==="blacktooth77"||r.id==="safari26"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${$({x:H/2-Lt,y:0})}
L${$({x:H/2+Lt,y:0})}
L${$({x:H/2+Lt,y:H})}
L${$({x:H/2-Lt,y:H})}
z
`}):null,d&&p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:Ty(t.away==="doorway")}),p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:Ty(t.left==="doorway")})]}),p.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[p.jsx("path",{d:`M${$({x:0,y:H})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:Ia[t.right]}),p.jsx("path",{d:`M${$({x:H,y:0})} L${$({x:H,y:H})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:Ia[t.left]}),p.jsx("path",{d:`M${$({x:H,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:Ia[t.towards]}),p.jsx("path",{d:`M${$({x:0,y:H})} L${$({x:H,y:H})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:Ia[t.away]})]}),n&&p.jsx(Z2,{className:"fill-[var(--roomHintColor)]"}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:tD}),i&&o?p.jsx(K2,{roomJson:r,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?p.jsx(Bi,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?p.jsx(Bi,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?p.jsxs(p.Fragment,{children:[p.jsx(Bi,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),p.jsx(Bi,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):p.jsx(Y2,{roomJson:r,subRoomId:e,items:g}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:sD}),A&&p.jsx("g",{transform:Jf(Wt(Xs(A.gridOffset,{x:.5,y:.5}))),children:p.jsx("foreignObject",{width:A.text.length*16,height:kP.h*2,y:-8,x:A.align==="left"?0:A.text.length*-16,children:p.jsx(j,{noTint:!0,className:"[--scale:2] [--block:16px]",children:A.text})})}),u?p.jsx("path",{className:"fill-transparent cursor-pointer",d:Wu,onClick:()=>{u(h)}}):null]})},Yu=(t,e,s,r)=>{const n=sd(e,t[e]?.items);return n&&s===t[e].roomJson.id&&r===Xf(n.state.position,"fine",t[e].roomJson)?n:void 0},nD=t=>{const{campaign:e,pickupsCollected:s,gridPositions:r,currentCharacterName:n,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const d=o.r-o.l+2*vo,f=o.b-o.t+2*Pr,m=Object.values(r);return p.jsxs("svg",{className:"w-full",style:{minWidth:`${d}px`,height:`${f}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:p.jsx(O2,{...t,curRoomId:u,containerWidth:a}),p.jsx("g",{transform:`translate(${-o.l+vo+(a-d)/2},${-o.t+ +Pr})`,children:m.map(A=>{const{roomId:g,subRoomId:y,gridPosition:w}=A,x=`${g}/${y}`;return p.jsxs("g",{"data-id":x,transform:Jf(Wt(w)),children:[p.jsx(rD,{roomGridPositionSpec:A,roomPickupsCollected:s[g]??pe,roomJson:e.rooms[g],headItemInRoom:Yu(i,"head",g,y),heelsItemInRoom:Yu(i,"heels",g,y),headOverHeelsItemInRoom:Yu(i,"headOverHeels",g,y),currentCharacterName:n,roomVisited:l[g]??!1,onPlayableClick:c,onRoomClick:h}),u===g?p.jsx(Pq,{svg:!0,smooth:!0}):null]},x)})})]})},iD=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(Xa(t),!0):e.currentActionPress("swop.head")==="tap"?(Xa(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(Xa(t,"heels"),!0):!1},oD=()=>{const t=Hn(),[e,s]=v.useState(t.gameState.currentCharacterName);return v.useEffect(()=>{const r=()=>{s(t.gameState.currentCharacterName)};return ft.shared.add(r),()=>{ft.shared.remove(r)}},[t.gameState]),e},aD=()=>{const t=Hn();v.useEffect(()=>{const e=()=>{iD(t.gameState)};return ft.shared.add(e),()=>{ft.shared.remove(e)}},[t.gameState])},lD=t=>t.characterRooms[t.currentCharacterName],od=t=>JSON.parse(JSON.stringify(t)),cD=()=>ms().get("cheats")==="1",uD=(t,e)=>{const s=new URL(e),r=s.hash.substring(1);if(r!==""&&t.rooms[r]!==void 0)return s.hash.substring(1)},hD=t=>Re(t),dD=(t,e)=>Re(W(t,{x:e.x,z:e.z})),fD=(t,e)=>Re(W(t,{y:e.y,z:e.z})),My=(t,e,s)=>{const r=dD(e,s),n=fD(e,s),i=hD(e),o=t;return o.xAxisProjectionMin=n.y-n.x/2,o.xAxisProjectionMax=i.y-i.x/2,o.yAxisProjectionMin=r.y+r.x/2,o.yAxisProjectionMax=i.y+i.x/2,o.zAxisProjectionMin=r.x,o.zAxisProjectionMax=n.x,o},Ry=X.w*2,Iy=X.w*2,jy=X.w*2,Oy=X.w*2;class Iq{#e=new Map;#t=new Map;#s=new Map;#r=new Map;#n=new Map;constructor(e){if(e)for(const s of e)this.addItem(s)}#i(e,s,r,n){const i=new Set;for(const o of s)n(o).add(e),i.add(o);r.set(e,i)}#o(e,s,r){const n=r.get(e);if(r.delete(e),!!n)for(const i of n){const o=s.get(i);o&&(o.delete(e),o.size===0&&s.delete(i))}}#l(e,s,r,n,i){const o=n.get(e);if(!o)throw new Error(`Item ${e.id} not in index`);const a=new Set(s);let l=!1,c=!1;for(const u of o)if(!a.has(u)){const h=r.get(u);h&&(l=!0,h.delete(e))}for(const u of a)o.has(u)||(i(u).add(e),c=!0);if(l)for(const u of o){const h=r.get(u);h&&h.size===0&&r.delete(u)}l||c?n.set(e,a):a.clear()}addItem(e){if(this.#s.has(e)){const s=this.#s.get(e);throw new Error(`Item ${e.id} is already in the spatial index at ${[...s].join(" ")}`)}this.#i(e,this.#u(e.state.position,e.aabb),this.#s,s=>this.#a(s)),this.#f(e),this.#i(e,this.#h(e),this.#r,s=>this.#d(s))}#c(e,s){return`${e},${s}`}#a(e){let s=this.#e.get(e);return s||(s=new Set,this.#e.set(e,s)),s}#d(e){let s=this.#t.get(e);return s||(s=new Set,this.#t.set(e,s)),s}*#u(e,s){const r=e,n=W(e,s),i=Math.floor(r.x/Iy),o=Math.floor(r.y/Ry),a=Math.floor(n.x/Iy),l=Math.floor(n.y/Ry);for(let c=i;c<=a;c++)for(let u=o;u<=l;u++)yield this.#c(c,u)}#f(e){const s=e.renderAabbOffset?W(e.state.position,e.renderAabbOffset):e.state.position,r=e.renderAabb||e.aabb,n=this.#n.get(e);if(n!==void 0)return My(n,s,r),n;{const i=My({},s,r);return this.#n.set(e,i),i}}*#h(e){const s=this.#n.get(e);if(s===void 0)throw new Error("projectionAxes not calculated for "+e.id);const{xAxisProjectionMin:r,xAxisProjectionMax:n,yAxisProjectionMin:i,yAxisProjectionMax:o}=s,a=Math.floor(r/Oy),l=Math.floor(i/jy),c=Math.floor(n/Oy),u=Math.floor(o/jy);for(let h=a;h<=c;h++)for(let d=l;d<=u;d++)yield this.#c(h,d)}removeItem(e){if(!this.#s.has(e))throw new Error(`Item ${e.id} is not in the spatial index`);this.#o(e,this.#e,this.#s),this.#o(e,this.#t,this.#r),this.#n.delete(e)}updateItemSpatialIndex(e){this.#l(e,this.#u(e.state.position,e.aabb),this.#e,this.#s,s=>this.#a(s))}updateItemProjectedIndex(e){this.#f(e),this.#l(e,this.#h(e),this.#t,this.#r,s=>this.#d(s))}getCuboidNeighbourhood(e,s,r){const n=new Set;for(const i of this.#u(e,s)){const o=this.#e.get(i);if(o)for(const a of o)a!==r&&n.add(a)}return n}getProjectedNeighbourhood(e,s){const r=new Set;for(const n of this.#h(e)){const i=this.#t.get(n);if(i)for(const o of i)o!==s&&r.add(o)}return r}getItemCuboidNeighbourhood(e){return this.getCuboidNeighbourhood(e.state.position,e.aabb,e)}getItemProjectedNeighbourhood(e){return this.getProjectedNeighbourhood(e,e)}getItemAxesProjections(e){return this.#n.get(e)}debugToString(){const s=Array.from(this.#e.keys()).sort().map(i=>{const o=this.#e.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`}),n=Array.from(this.#t.keys()).sort().map(i=>{const o=this.#t.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`});return`GridSpatialIndex (${this.#e.size} 2D cells, ${this.#t.size} projected cells, ${this.#s.size} items) {
  2D Cells:
${s.join(`,
`)}
  Projected Cells:
${n.join(`,
`)}
}`}}const jq=(t,e,s,r)=>!(t.x+e.x<=s.x||t.x>=s.x+r.x)&&!(t.y+e.y<=s.y||t.y>=s.y+r.y)&&!(t.z+e.z<=s.z||t.z>=s.z+r.z),Zf=({aabb:t,state:{position:e}},{aabb:s,state:{position:r}})=>jq(e,t,r,s),pD=t=>!0;function*Er(t,e,s=pD){const r=e.getItemCuboidNeighbourhood(t);for(const n of r)s(n)&&Zf(t,n)&&(yield n)}const By=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),Ny={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,button:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},Oq=(t,e)=>Ny[t.type]-Ny[e.type],mD=(t,e)=>e.toSorted((s,r)=>{const n=Oq(s,r);if(n!==0)return n;const i=ol(t,By(t,s)),o=ol(t,By(t,r));return Math.abs(i-o)<1e-4?s.id<r.id?-1:1:i-o}),gD=(t,e,s,r)=>{const n=Math.max(0,Math.min(t.x+e.x,s.x+r.x)-Math.max(t.x,s.x)),i=Math.max(0,Math.min(t.y+e.y,s.y+r.y)-Math.max(t.y,s.y));return n*i},zy=({state:{position:t},aabb:e},{state:{position:s},aabb:r})=>gD(t,e,s,r),pr={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},mr={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},AD=(t,e,s=.001)=>{if(!Zs(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:r}}}}=t;return r>0?!1:(pr.state.position.x=t.state.position.x,pr.state.position.y=t.state.position.y,pr.state.position.z=t.state.position.z-Qs,pr.aabb.x=t.aabb.x,pr.aabb.y=t.aabb.y,pr.aabb.z=s+Qs,mr.state.position.x=e.state.position.x,mr.state.position.y=e.state.position.y,mr.state.position.z=e.state.position.z+e.aabb.z,mr.aabb.x=e.aabb.x,mr.aabb.y=e.aabb.y,mr.aabb.z=0,Zf(pr,mr))},yD=(t,e)=>{const r=[...Ye(e).filter(i=>AD(t,i))];return r.length===0?void 0:r.reduce((i,o)=>{const a=Oq(o,i);return a<0||a===0&&zy(t,o)>zy(t,i)?o:i})},Oa=X.h,xD=-12,bD=t=>{const e=jt(t).filter(xq).reduce((s,{config:{naturalFootprint:{position:{x:r,y:n},aabb:{x:i,y:o}}}})=>{const a=r+i,l=n+o;return{minX:Math.min(s.minX,r),maxX:Math.max(s.maxX,a),minY:Math.min(s.minY,n),maxY:Math.max(s.maxY,l)}},{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0});if(!(e.minX>e.maxY))return e};function*wD(t,e){const s=bD(e);if(s===void 0)return;const{minX:r,maxX:n,minY:i,maxY:o}=s;t.roomBelow!==void 0&&(yield{...it,type:"portal",id:"portal/toRoomBelow",fixedZIndex:Ir,config:{toRoom:t.roomBelow,relativePoint:{x:(r+n)/2,y:(i+o)/2,z:Oa+X.h},direction:fe.down},aabb:{x:n-r,y:o-i,z:Oa},state:{...Je(),position:{x:r,y:i,z:xD-Oa}},renders:!1}),t.roomAbove!==void 0&&(yield{...it,type:"portal",id:"portal/toRoomAbove",fixedZIndex:Ir,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?Le(t.ceilingRelativePoint):{x:(r+n)/2,y:(i+o)/2},z:-12},direction:fe.up},aabb:{x:n-r,y:o-i,z:Oa},state:{...Je(),position:W({x:r,y:i},{z:X.h*(t.height??s2)})}})}function*VD(t,e,s,r){const n=To(t.items);for(const[i,o]of n)o.type==="player"&&!r||(yield*Kf(i,o,t,e,s))}const Dy=t=>Ye(t).reduce((e,s)=>({...e,[s.id]:s}),{}),ad=({roomJson:t,roomPickupsCollected:e,scrollsRead:s,isNewGame:r=!1})=>{const n=Dy(VD(t,e,s,r)),i={...Dy(wD(t,n)),...n},o=new Iq(jt(i));for(const l of jt(i)){const u=Er(l,o).find(h=>Zs(l)&&Zs(h)&&!(l.type==="wall"&&h.type==="wall"));u!==void 0&&console.error(`in room ${t.id} item ${l.id} @${JSON.stringify(l.state.position)} #${JSON.stringify(l.aabb)} is colliding with (solid item) ${u.id} @${JSON.stringify(u.state.position)} #${JSON.stringify(u.aabb)} on loading room ${t.id}`)}for(const l of jt(i).filter(Rr)){const c=yD(l,jt(i).filter(u=>u.id!==l.id));c!==void 0&&Qf({above:l,below:c})}return{...t,roomJson:t,items:i,roomTime:0,[$t]:o}},Is=(t,e,s)=>{const r=t[$t];e.state.position=s,r.updateItemSpatialIndex(e)},qD=.5,vD=(t,e,s,r,n,i)=>{if(Wn(n)<1e-4)return Object.assign(i,Q),i;const a=S_(n);if(!jq(t,e,s,r))return Object.assign(i,Q),i;let l=-1/0,c=1/0;for(const u of E_){const h=a[u];if(Math.abs(h)<1e-4){const b=t[u],q=t[u]+e[u],_=s[u],V=s[u]+r[u];if(q<=_||b>=V)return Object.assign(i,Q),i;continue}const d=s[u],f=s[u]+r[u],m=t[u],A=t[u]+e[u],g=(d-A)/h,y=(f-m)/h,w=Math.min(g,y),x=Math.max(g,y);l=Math.max(l,w),c=Math.min(c,x)}return l>c?(Object.assign(i,Q),i):c>0&&(l>=0||c<-l)?Mp(i,a,c):l<0?Mp(i,a,l):(Object.assign(i,Q),i)},_D=(t,e,s,r,n)=>vD(t,e,s,r,n,{}),SD=(t,e,s,r,n)=>{const i=s.x+r.x-t.x,o=s.y+r.y-t.y,a=s.z+r.z-t.z,l=t.x+e.x-s.x,c=t.y+e.y-s.y,u=t.z+e.z-s.z,h=Math.abs(i)<Math.abs(l)?i:-l,d=Math.abs(o)<Math.abs(c)?o:-c,f=Math.abs(a)<Math.abs(u)?a:-u,m=Math.abs(h),A=Math.abs(d),g=Math.abs(f)*qD;return m<A&&m<g?(n.x=h,n.y=0,n.z=0,n):A<g?(n.x=0,n.y=d,n.z=0,n):(n.x=0,n.y=0,n.z=f,n)},ld=(t,e,s,r)=>SD(t,e,s,r,{}),Fy=(t,e,s)=>{const r=e.state.actedOnAt;r!==void 0&&(r.roomTime===s.roomTime?t&&(r.by[t.id]=!0):(r.by=t?{[t.id]:!0}:{},r.roomTime=s.roomTime))},kD=(t,e,s)=>{const r=(n,i)=>{const{collidedWith:o}=n.state;o.roomTime===s.roomTime?o.by[i.id]=!0:(o.by={[i.id]:!0},o.roomTime=s.roomTime)};r(t,e),Rr(e)&&r(e,t)},CD=(t,e,s,r)=>{const n=$f(t,e,s),i=ld(t.state.position,t.aabb,e.state.position,e.aabb);if(n&&i.z===0){const o=Bs(r,t.state.position),a=v_(o),l=ol(i,o)/a;if(o.z=0,l>.44)return _D(t.state.position,t.aabb,e.state.position,e.aabb,o)}return i},Ji=.1,hs={id:"sensor",aabb:{x:0,y:0,z:0},state:{position:{x:0,y:0,z:0}}},un={id:"sensor",aabb:{x:Ji,y:Ji,z:Ji},state:{position:{x:0,y:0,z:0}}},PD=5/12,ED=6/12,TD=1,MD=1/12,RD=0,ID=1,jD=2,OD=3,Ku=4,Ly=.75,BD=(t,e,s,r,n,i)=>{if(i.length===0)return;const o=t.state.position,a=Zt(s.x,0),l=Zt(s.y,0);if(a===l)return;const c=Bs(o,e),u=__(c)/r;if(!Zt(u,0))return;const h=t.state.standingOnItemId===null;hs.state.position.z=o.z,hs.aabb.z=h?Qs:t.aabb.z;const d=a?"y":"x",m=i.some(k=>k.type==="doorFrame")?MD:h?t.state.vels.gravity.z<0?ED:TD:PD;hs.state.position[d]=t.state.position[d]+(s[d]<0?-Ji:t.aabb[d]),hs.aabb[d]=Ji;const A=Dl(d),g=m*t.aabb[A];hs.aabb[A]=g,hs.state.position[A]=t.state.position[A];const y=(k,C)=>{const P=C===t||!Zs(C)?RD:C.type==="doorFrame"?ID:$f(t,C)?jD:$z(C)?Ku:OD;return Math.max(k,P)},w=Er(hs,n[$t]).reduce(y,0);if(w===Ku)return;un.state.position.z=t.state.position.z-1,un.state.position[d]=hs.state.position[d],un.state.position[A]=t.state.position[A];const x=Er(un,n[$t]).filter(k=>Zs(k)&&!(Cl(t)&&Ay(k))),b=h||!lm(x);hs.state.position[A]=t.state.position[A]+t.aabb[A]-g;const q=Er(hs,n[$t]).reduce(y,0);if(q===Ku)return;un.state.position[A]=t.state.position[A]+t.aabb[A]-1;const _=Er(un,n[$t]).filter(k=>Zs(k)&&!(Cl(t)&&Ay(k))),V=h||!lm(_);if(w===q)return;const S=w>q;if(S){if(!V)return}else if(!b)return;return{x:a?s.y*(S?1:-1)*(s.y>0?1:-1)*Ly:0,y:l?s.x*(S?1:-1)*(s.x>0?1:-1)*Ly:0,z:0}},Uy=void 0,ND={x:-1,y:-1,z:-1},zD={x:-.6,y:-.6,z:-.4},DD={x:-1,y:-1,z:-.4},cd=({subjectItem:t,posDelta:e,gameState:s,room:r,deltaMS:n,onTouch:i,visited:o=new Set,forceful:a=yq(t)&&o.size===0,isHelpful:l})=>{if(Od(e,Q))return!1;let c=!1;const{state:{position:u}}=t;Is(r,t,W(u,e)),o.size===0&&Fy(void 0,t,r);const h=mD(e,Er(t,r[$t]).toArray());for(const d of h){if(o.has(d.id)||!Zf(t,d))continue;if(Fy(t,d,r),i!==void 0&&Uy&&console.group(`handling onTouch() callback for ${t.id} touching ${d.id}`),i?.({movingItem:t,touchedItem:d,movementVector:Bs(t.state.position,u),gameState:s,deltaMS:n,room:r}),i!==void 0&&Uy&&console.groupEnd(),r.items[t.id]===void 0)return c;if(r.items[d.id]===void 0||!Zs(d,t)||!Zs(t))continue;const f=$f(t,d,a),m=CD(t,d,a,u),A=Zt(Wn(ld(u,t.aabb,d.state.position,d.aabb)),0);if(f){const g=a?ND:Bz(d)?DD:zD,y=Nx(m,g);if(Is(r,t,W(t.state.position,m,y)),o.size<n2?(c||=cd({subjectItem:d,posDelta:y,gameState:s,room:r,deltaMS:n,forceful:a,visited:o.add(t.id),onTouch:i}),o.delete(t.id)):console.warn("hit recursion depth limit",new Error),r.items[d.id]===void 0)continue;Is(r,t,W(t.state.position,ld(t.state.position,t.aabb,d.state.position,d.aabb)))}else Is(r,t,W(t.state.position,m));Rr(t)&&m.z>0&&e.z<0&&(t.state.standingOnItemId===null||!h.includes(vq(t.state.standingOnItemId,r)))&&(nd(t,r),Qf({above:t,below:d})),Rr(t)&&!A&&kD(t,d,r)}if(Rr(t)&&!c&&!l){const d=BD(t,u,e,n,r,h);d&&(cd({subjectItem:t,posDelta:d,gameState:s,room:r,deltaMS:n,forceful:!1,onTouch:i,isHelpful:!0,visited:o.add(t.id)}),o.delete(t.id),c=!0)}return c},ud=({state:{position:t,facing:e,autoWalk:s,action:r,vels:n}})=>({position:t,facing:e,autoWalk:s,action:r,vels:{...n}}),FD=t=>{let e=2166136261;const s=t.length;for(let r=Math.max(0,s-9);r<s;r++)e^=t.charCodeAt(r),e=Math.imul(e,1540483477),e^=e>>>15;return(e>>>0)/4294967295},LD=1e3/25,Bq=t=>{const e=Rt.animations[t],s=e.length,{animationSpeed:r}=e;return s*LD/r};Bq("bubbles.white");const UD=Bq("head.fadeOut"),$D=({touchedItem:t,room:e,gameState:s})=>{Dn({room:e,item:t});const r=Xz(t),n=t.type==="pickup"?{type:"pickup",gives:t.config.gives}:t.type==="hushPuppy"?{type:"hushPuppy"}:{type:"disappearing"},i=Gt(Wf(t).aabb,.5);for(let o=0;o<r.x;o++)for(let a=0;a<r.y;a++)for(let l=0;l<r.z;l++){const c=`${t.id}/${o},${a},${l}`,u=V2({itemType:"bubbles",config:{style:"white",was:n},position:Q,room:e,gameState:s,additionalIdPart:c}),h={x:o*Qi.x,y:a*Qi.y,z:l*Qi.z},d=W(t.state.position,h,i);Is(e,u,Bs(d,Gt(u.aabb,.5)));const f=FD(c)*.5+.75;u.state.expires=e.roomTime+UD*f}},HD=(t,e)=>{const s=jt(t.items).filter(Hz);for(const r of s)$D({touchedItem:r,gameState:e,room:t})},WD=(t,e,{changeType:s,sourceItem:r})=>{switch(s){case"portal":return jt(t.items).find(n=>_r(n)&&n.config.toRoom===e.id&&(r.config.toDoor===void 0||n.jsonItemId===r.config.toDoor)&&Od(Gt(r.config.direction,-1),n.config.direction));case"level-select":return jt(t.items).find(n=>_r(n)&&n.config.toRoom===e.id&&n.config.direction.z===0)??jt(t.items).find(n=>_r(n)&&n.config.direction.z===0)??jt(t.items).find(n=>_r(n)&&n.config.direction.z>0)??jt(t.items).find(_r)}},GD=(t,e,s,r)=>{const n=1*X.w;Is(r,t,W(t.state.position,Gt(e,n)));for(let i=0;i<n;i++)cd({subjectItem:t,posDelta:Gt(e,-1),gameState:s,room:r,deltaMS:16,forceful:!0,onTouch:void 0})},YD=t=>{const{playableItem:e,gameState:s,toRoomId:r,changeType:n,sourceItem:i}=t,o=s.characterRooms[e.id];if(o===void 0)throw new Error(`${e.id} is not in a room on the gameState`);if(r===o.id)throw new Error(`Can't move ${e.id} to the same room "${r}""`);let a;switch(n){case"portal":{const{config:{relativePoint:m},state:{position:A}}=i;a=Bs(e.state.position,W(A,m));break}case"teleport":{const{state:{position:m}}=i;a=Bs(e.state.position,m);break}case"level-select":a={x:0,y:0,z:0};break;default:throw new Error}const l=e.type==="headOverHeels"?void 0:s.characterRooms[_n(e.id)],u=Db(ue.getState()).rooms[r];if(u===void 0)throw new Error(`room ${r} does not exist in campaign`);const h=l?.id===r?l:ad({roomJson:u,roomPickupsCollected:s.pickupsCollected[r]??pe,scrollsRead:ue.getState().gameMenus.gameInPlay.scrollsRead}),d=Wz(e);if(d!==void 0){const{carrying:m}=d;m!==null&&(zn({room:o,item:m,atPosition:e.state.position}),d.carrying=null)}if(Dn({room:o,item:e}),e.state.latentMovement=[],e.state.previousStandingOnItemId=null,e.state.standingOnUntilRoomTime=Be,(e.type==="head"||e.type==="headOverHeels")&&HD(h,s),h.items[e.id]!==void 0&&Dn({room:h,item:e}),zn({room:h,item:e}),s.characterRooms[e.id]=h,t.changeType==="teleport"){const{state:{toPosition:m}}=t.sourceItem;Is(h,e,W(Le(m),a))}else{const m=WD(h,o,t);if(m===void 0)if(t.changeType==="level-select")Is(h,e,Le({x:1,y:1,z:8}));else throw new Error(`trying to move ${e.id} from ${o.id} --to-> ${r} but no destination portal found to locate with`);else{const A=W(m.state.position,m.config.relativePoint,a,n==="portal"&&i.config.direction.z>0?{z:X.h}:{});Is(h,e,A);const{config:{direction:g}}=m;g.z===0&&(e.state.autoWalk=!0,e.state.facing=Gt(g,-1),e.state.action==="idle"&&(e.state.action="moving"),GD(e,g,s,h))}}const f=Gx(Er(e,h[$t],m=>!_r(m)));f!==void 0&&console.warn("on entering room",r,"character",e.id,"at",e.state.position,"collides with (at least one; only first is shown) non-portal item:",f),s.entryState[e.id]=ud(e),e.id==="headOverHeels"?(delete s.entryState.head,delete s.entryState.heels):(s.entryState[_n(e.id)]||(s.entryState[_n(e.id)]=s.entryState.headOverHeels),delete s.entryState.headOverHeels),ue.dispatch(dP(r)),ue.dispatch(Ub({characterName:e.type,roomId:r}))},Nq=t=>{const e={};for(const s of Object.values(t.rooms))for(const r of Object.values(s.items))if(r.type==="player"){const{which:n}=r.config;if(e[n]!==void 0)throw new Error(`Campaign has duplicate starting rooms for ${n}`);e[n]=s.id}return e},KD=t=>{const e=Nq(t),s={...e};if(e.head===void 0&&e.heels===void 0)throw new Error("couldn't find either head or heels in campaign");let r=ms().get("playAsHeels")==="1"?"heels":e.head!==void 0?"head":"heels";const n=cD()?uD(t,window.location.href):void 0;return n!==void 0&&(s[r]=n),s.head===void 0&&(r="heels"),{campaignStartingRoomIds:e,startingRoomIds:s,startAs:r,changedCharacterRoomFromCampaign:n!==void 0&&e[r]!==s[r]}},QD=t=>{for(const e of Ls(t)){const s=e;s[$t]===void 0&&(s[$t]=new Iq(jt(e.items)))}return t},XD=({campaign:t,inputStateTracker:e,savedGame:s,writeInto:r={}})=>{if(s){const m=s.gameState.characterRooms,A=od(m);return m.head!==void 0&&m.head.id===m.heels?.id&&(A.heels=A.head),Object.assign(r,{inputStateTracker:e,...od(s.gameState)}),r.characterRooms=QD(A),r}const{startAs:n,startingRoomIds:i,campaignStartingRoomIds:o,changedCharacterRoomFromCampaign:a}=KD(t),l={roomPickupsCollected:pe,scrollsRead:pe,isNewGame:!0},c=o.head&&ad({roomJson:t.rooms[o.head],...l}),u=o.heels===o.head?c:o.heels&&ad({roomJson:t.rooms[o.heels],...l}),h=c===void 0?void 0:sd("head",c?.items),d=u===void 0?void 0:sd("heels",u?.items),f=Object.assign(r,{inputStateTracker:e,currentCharacterName:n,entryState:{head:h===void 0?void 0:ud(h),heels:d===void 0?void 0:ud(d)},pickupsCollected:{},gameTime:0,freeCharacters:{},characterRooms:{head:c,heels:u,headOverHeels:void 0}});return a&&YD({changeType:"level-select",gameState:f,playableItem:n==="head"?h:d,toRoomId:i[n],sourceItem:void 0}),f},uH=t=>{try{return XD(t)}catch(e){throw new Error("failed to load game state",{cause:e})}},JD=Re(Wt({x:1,y:1,z:1})).y,$y=Re(Wt({x:0,y:1,z:0})).x,ZD=t=>t.reduce((e,{gridPosition:s})=>{const r=Re(Wt(s));return{t:Math.min(e.t,r.y+JD),b:Math.max(e.b,r.y),l:Math.min(e.l,r.x-$y),r:Math.max(e.r,r.x+$y)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),eF="$$final",Ba=(t,e,s,r)=>e.some(n=>n.config.direction===t)?"doorway":s===void 0?"wall":Object.values(s).some(({gridPosition:n})=>P_(fe[t],w_(n,r)))?"open":"wall";function*pn(t){try{yield*tF(t)}catch(e){const s=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:s})}}function*tF({roomId:t,subRoomId:e="*",campaign:s,visited:r={},vectorFromPrevious:n,previousRoomGridPosition:i=Q}){if(t==="nowhere"||r[t]?.[e])return;r[t]===void 0&&(r[t]={}),r[t][e]=!0;const o=s.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...Ye(Ls(o.items)).filter(f=>f.type==="door").filter(f=>Xf(f.position,"block",o)===e)],l=W(i,n===void 0?zx:n),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:Ba("left",a,c,u),right:Ba("right",a,c,u),away:Ba("away",a,c,u),towards:Ba("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:m}]of Ye(To(c)))f!==e&&(yield*pn({roomId:t,subRoomId:f,campaign:s,visited:r,vectorFromPrevious:Bs({...m,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:m}=o;yield*pn({roomId:f,subRoomId:m,campaign:s,visited:r,vectorFromPrevious:fe.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:m}=o;yield*pn({roomId:f,subRoomId:m,campaign:s,visited:r,vectorFromPrevious:fe.down,previousRoomGridPosition:l})}for(const f of a){const{toRoom:m}=f.config;if(m!==eF)try{yield*pn({roomId:m,campaign:s,visited:r,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:fe[f.config.direction],previousRoomGridPosition:l})}catch(A){throw new Error(`error while traversing door ${JSON.stringify(f,null,2)} in room ${t} to room ${m}`,{cause:A})}}const d=o.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:f},gridOffset:m}=d;yield*pn({roomId:f,campaign:s,visited:r,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const sF=t=>{const s=[...t].sort(({gridPosition:r},{gridPosition:n})=>r.z!==n.z?r.z-n.z:n.x+n.y-(r.x+r.y)).map(r=>[`${r.roomId}/${r.subRoomId}`,r]);return Gn(s)},rF=()=>{const t=oD(),e=XC(),{gameState:s}=Hn(),r=Fb();return v.useMemo(()=>{try{const n=lD(s),i=n?.roomJson.id??Nq(r).head;let o;if(!s)o="*";else if(!n?.roomJson.meta?.subRooms)o="*";else{const u=n?.items[t];u?o=Xf(u.state.position,"fine",n.roomJson):o="*"}const a=[...pn({campaign:r,roomId:i,subRoomId:o})],l=sF(a);return{mapBounds:ZD(a),curRoomId:n?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:s.pickupsCollected,characterRooms:s.characterRooms,campaign:r,roomsExplored:e,curRoomScenery:n?.planet}}catch(n){throw new Error("error getting map data",{cause:n})}},[r,t,s,e])},nF=()=>{const{ref:t,width:e}=Pz(),s=Sq(),r=Hn();aD();const n=rF(),i=kq(n.curRoomScenery);return p.jsx(De,{children:p.jsx(Se,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:N(gt),dialogId:"map",children:p.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:s,children:p.jsx(nD,{onPlayableClick:o=>Xa(r.gameState,o),containerWidth:e,...n})})})})},iF=`## Bag

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bags icon at the
bottom right of the screen. To pick up an object, stand on top of it and
press *carry*. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Section adapted from the original Head over Heels manual

`,oF=`## Planet Blacktooth

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Section adapted from the original Head over Heels manual`,aF=`## Planet Book World

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Section adapted from the original Head over Heels manual
`,lF=`## Conveyor Belts

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Section adapted from the original Head over Heels manual
`,cF=`## Credits

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
1987 Ocean Software Limited.

### 38 years later, a Remake

* code by Jim Higson
* Playtesting, ideas, map design, and general support by my brother, Tom Higson
* Playtesting, moral support, and constant comms by [Jon Albaugh](https://x.com/fextwolf?s=21&t=PEqxJblCn3JB_NH8AOR6Zg)
* Head over heels [font](https://fontstruct.com/fontstructions/show/996776/head_over_heels)
recreated by [Patrick H. Lauke](http://splintered.co.uk/)

This project is licensed under the GNU Affero General Public License v3.0 (only) - see the LICENSE file for details. All code is original except where indicated otherwise.

2025 Jim Higson`,uF=`## Crowns

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Section adapted from the original Head over Heels manual`,hF=`## Cuddly Stuffed White Rabbits

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
If you pick them up while head and heels are joined, they get *two each*

##  Iron Pills

![](texture-animated-shine?text-metallicBlue&float-left)To make you invulnerable

##  Jump higher bunny

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)Only works on Heels

##  Go faster bunny
![](texture-animated-head_idle_right?text-metallicBlue&float-left)Only works on slow-moving Head

> Section adapted from the original Head over Heels manual
`,dF=`## Doughnuts

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so dont waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Section adapted from the original Head over Heels manual
`,fF=`## Planet Egyptus

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Section adapted from the original Head over Heels manual
`,pF=`## Head 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Section adapted from the original Head over Heels manual
`,mF=`## Heels 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heelss evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump their own height and can also run very fast.

> Section adapted from the original Head over Heels manual`,gF=`## Hints and Tips

1. **1** Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_standing_towards&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** Make sure Head learns to climb ladders; this is an essential skill.
5. **5** ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelss bag and Heads hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the others back.
7. **7** Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** Learn the difference in distance and control between Heads jumps and Heelss jumps.
9. **9** This remake comes with a **map**. Use it!
10. **10** ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** If you cant understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Section adapted from the original Head over Heels manual`,AF=`## The Blacktooth Empire

![](texture-crown_blacktooth)Far, far away from our star Sol lies **The Blacktooth empire**, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_standing_right)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - **Head** saddled on **Heels**, and indeed these
*are* their names and both are highly trained spies.

> Section adapted from the original Head over Heels manual
`,yF=`## Hooter

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by **Head** and requires a tray of *doughnuts* to be of any use.

> Section adapted from the original Head over Heels manual
`,xF=`## Hush Puppies

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Heads race, they disappear and wont return until they are sure the coast is
clear.

> Section adapted from the original Head over Heels manual
`,bF=`
## Planet Penitentiary
### The empires prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Section adapted from the original Head over Heels manual
`,wF=`## Reincarnation Fish

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Section adapted from the original Head over Heels manual
`,VF=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* To the right of the address bar, click the **install icon: **. It might also look like a 'download' icon.
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock **
* **Head over heels** is now installed on your mac
* If you dont want to keep the game in the Dock, right-click the doc icon and uncheck **Options  keep in doc**. It is still available in Applications

---

## Firefox 

* Firefox doesn't support PWAs out of the box, but there is a [browser extension](https://addons.mozilla.org/en-US/firefox/addon/pwas-for-firefox/).
* Probably easier to play in the browser until Mozilla adds support`,qF=`## Supported platforms

Almost anything with an up-to-date browser can play

Heres some Ive tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,vF=`## Planet Safari

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Section adapted from the original Head over Heels manual`,_F=`## Springs

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Section adapted from the original Head over Heels manual
`,SF=`## Switches

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Section adapted from the original Head over Heels manual, revised for remake
`,kF=`## Swop Key

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Section adapted from the original Head over Heels manual`,CF=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minions back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyll never get this far!

*> Your humble minion*
`,PF=`## Teleports

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Section adapted from the original Head over Heels manual `,EF=`## The Emperors Guardian

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **VERY
DANGEROUS**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Section adapted from the original Head over Heels manual
`,TF=`## The Game

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain keep fit equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Section adapted from the original Head over Heels manual
`,be=Object.assign({"./bag.md":iF,"./blacktooth.md":oF,"./bookWorld.md":aF,"./conveyorBelts.md":lF,"./credits.md":cF,"./crowns.md":uF,"./cuddlyStuffedWhiteRabbits.md":hF,"./doughnuts.md":dF,"./egyptus.md":fF,"./head.md":pF,"./heels.md":mF,"./hintsAndTips.md":gF,"./historyOfTheBlacktoothEmpire.md":AF,"./hooter.md":yF,"./hushPuppies.md":xF,"./penitentiary.md":bF,"./reincarnationFish.md":wF,"./remake/installGuide.md":VF,"./remake/supportedPlatforms.md":qF,"./safari.md":vF,"./springs.md":_F,"./switches.md":SF,"./swopKey.md":kF,"./teleportBack.md":CF,"./teleports.md":PF,"./theEmperorsGuardian.md":EF,"./theGame.md":TF}),Zi={historyOfTheBlacktoothEmpire:be["./historyOfTheBlacktoothEmpire.md"],theGame:be["./theGame.md"],egyptus:be["./egyptus.md"],penitentiary:be["./penitentiary.md"],safari:be["./safari.md"],bookWorld:be["./bookWorld.md"],blacktooth:be["./blacktooth.md"],head:be["./head.md"],heels:be["./heels.md"],reincarnationFish:be["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:be["./cuddlyStuffedWhiteRabbits.md"],hooter:be["./hooter.md"],doughnuts:be["./doughnuts.md"],bag:be["./bag.md"],crowns:be["./crowns.md"],teleports:be["./teleports.md"],springs:be["./springs.md"],switches:be["./switches.md"],conveyorBelts:be["./conveyorBelts.md"],hushPuppies:be["./hushPuppies.md"],theEmperorsGuardian:be["./theEmperorsGuardian.md"],swopKey:be["./swopKey.md"],hintsAndTips:be["./hintsAndTips.md"],credits:be["./credits.md"],installGuide:be["./remake/installGuide.md"]},MF={...Zi,teleportBack:be["./teleportBack.md"]},RF=/^##\s+(.*)$/m,hd=t=>{const e=t.match(RF);if(e===null)return"no title found";const[,s]=e;return s},Qu=t=>{const e=t.source==="manual"?MF[t.pageName]:t.markdown,s=Sq(),r=K(n=>{const{openMenus:i}=n.gameMenus;return i.some(o=>o.menuId==="readTheManual")});return p.jsxs(De,{children:[p.jsx(At,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:N(gt)}),p.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed text-shadow zx:text-zxWhite !gap-y-0 py-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack ",dialogId:t.dialogId,children:[p.jsx(ws,{className:"pl-1 mobile:px-3 ",path:r?["Manual"]:[]}),p.jsx("div",{className:et("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 pt-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan mobile:px-3"),ref:s,onClick:N(gt),children:p.jsx(me,{markdown:e})})]})]})},zq=t=>{t.reincarnateFrom(ue.getState().gameMenus.gameInPlay.reincarnationPoint),ue.dispatch(af())},IF="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",jF=()=>{const t=Hn();return p.jsxs(De,{children:[p.jsx(At,{className:"bg-midRed zx:bg-zxYellow"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed px-1",dialogId:"offerReincarnation",children:[p.jsx(j,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),p.jsx(me,{markdown:IF,className:"text-redShadow zx:text-zxWhite"}),p.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{zq(t)}}),p.jsx(L,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:N(of,{offerReincarnation:!1})})]})]})]})},OF="Play at the original **1x** speed, **1.2x (default)** or faster **1.5x** or **2x** speeds",BF=`**Off**: Start with *8 lives*

Extra life rabbits spread thinly through the game`,NF=`**On**: *Live forever*

Extra life rabbits have no effect`,zF="*Select the keys* and other input settings",DF=`##Cheats

Magazines used to print memory locations to *poke* values into so that readers could modify their games; usually to cheat.
                  
A true hero leaves these **off**! Then again, do modern gamers even know what lives are?`,FF=()=>{const t=K(Bb);return p.jsx(De,{children:p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"modernisationOptions",children:[p.jsx(ws,{path:["Options"],className:ii}),p.jsx("div",{className:ni,children:p.jsxs(Ee,{className:"gap-y-half",children:[p.jsx(L,{hintInline:!0,id:"controlOptions",label:"Controls",verticalAlignItemsCentre:!0,className:"sprites-double-height",onSelect:N(ot,"controlOptions"),opensSubMenu:!0,hint:p.jsx(me,{className:ke,markdown:zF}),leader:p.jsx("span",{className:`${ye} sprite texture-joystick_whole sprites-normal-height zx:sprite-revert-to-white`})}),p.jsx(L,{hintInline:!0,id:"sound",label:"Sounds",className:"sprites-double-height",verticalAlignItemsCentre:!0,onSelect:N(ot,"sound"),opensSubMenu:!0,hint:p.jsx(me,{className:ke,markdown:"Footsteps getting annoying?"})}),p.jsx(L,{hintInline:!0,id:"display",label:"Display",className:"sprites-double-height",verticalAlignItemsCentre:!0,onSelect:N(ot,"displayOptions"),opensSubMenu:!0,hint:p.jsx(me,{className:ke,markdown:"Change how the game looks"})}),p.jsx(L,{hintInline:!0,id:"gameSpeed",label:"Game Speed",className:"sprites-double-height",valueElement:p.jsx(Ff,{className:"ml-auto",values:qh,valueLabels:qh.map(e=>`${e}`),value:K(Zd)}),onSelect:N(pP,void 0),hint:p.jsx(me,{className:ke,markdown:OF}),verticalAlignItemsCentre:!0}),p.jsx("div",{className:"col-span-3 pb-1",children:p.jsx(me,{markdown:DF,className:ke})}),p.jsx(L,{hintInline:!0,className:"sprites-double-height",id:"livesModel",verticalAlignItemsCentre:!0,label:" Lives Poke",leader:p.jsx("span",{className:`${ye} sprite texture-whiteRabbit sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(me,{className:ke,markdown:t?NF:BF}),valueElement:p.jsx(Js,{className:"ml-auto",value:t}),onSelect:N(es,{path:"infiniteLivesPoke"}),disabled:Tn()}),p.jsx(L,{hintInline:!0,leader:p.jsx("span",{className:`${ye} sprite texture-doughnuts sprites-normal-height zx:sprite-revert-to-white`}),className:"sprites-double-height",verticalAlignItemsCentre:!0,id:"infiniteDoughnutsPoke",label:" Doughnuts Poke",valueElement:p.jsx(Js,{className:"ml-auto",value:K(Nb)}),onSelect:N(es,{path:"infiniteDoughnutsPoke"}),disabled:Tn()}),p.jsx(oc,{})]})})]})})},LF=()=>p.jsxs(De,{children:[p.jsx(At,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsx(Se,{className:"bg-pureBlack w-zx h-full block p-0",onClick:N(gt),dialogId:"proclaimEmperor",children:p.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[p.jsxs("div",{className:"flex gap-7",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),p.jsxs("div",{className:"flex flex-col items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_standing_towards hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),p.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[p.jsx(j,{children:"The people salute your heroism"}),p.jsx(j,{children:"and proclaim you"})]}),p.jsx(j,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),p.jsx(Ee,{className:"hidden",children:p.jsx(zo,{})})]})})]}),Dq=({className:t})=>p.jsx("div",{className:et("contents",t),children:p.jsx(Zl.Placeholder,{})}),UF=()=>{const t=K(s=>s.gameMenus.gameInPlay.reincarnationPoint!==void 0),e=Hn();return p.jsxs(De,{children:[p.jsx(At,{className:"bg-midRed zx:bg-zxYellow"}),p.jsx(Se,{className:"bg-white zx:bg-zxRed px-1",dialogId:"quitGameConfirm",children:p.jsx(Zl.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[p.jsx(j,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the Game?"}),p.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(L,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:p.jsx("span",{className:`${ye} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:N(gt),hint:"Back to the game",verticalAlignItemsCentre:!0}),t&&p.jsx(L,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:p.jsx("span",{className:`${ye} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>zq(e),hint:"Go back and continue from the last reincarnation fish you ate",verticalAlignItemsCentre:!0}),p.jsx(L,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:N(of,{offerReincarnation:!1}),leader:p.jsx("span",{className:`${ye} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(me,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"}),verticalAlignItemsCentre:!0})]}),p.jsx(Dq,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},$F=({pageName:t})=>{const e=Zi[t],s=hd(e),r=mt()==="desktop";return p.jsx(L,{id:`markdown/${t}`,label:s,onSelect:N(ot,`markdown/${t}`),doubleHeightWhenFocussed:r,opensSubMenu:!0})},HF=Object.keys(Zi).sort((t,e)=>hd(Zi[t]).localeCompare(hd(Zi[e]))),WF=()=>p.jsxs(De,{children:[p.jsx(At,{className:"bg-midGrey zx:bg-zxCyan",onClick:N(gt)}),p.jsxs(Se,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-min text-redShadow zx:text-zxWhite !gap-y-0 py-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack ",dialogId:"readTheManual",children:[p.jsx(ws,{className:"pl-1 mobile:px-3 "}),p.jsxs("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed mobile:px-3 ",children:[p.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[p.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),p.jsx(j,{className:"sprites-double-height mx-1",children:"Read the manual"}),p.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),p.jsxs(Ee,{children:[[...HF.map(t=>p.jsx($F,{pageName:t},t))],p.jsx(oc,{})]})]})]})]}),GF=()=>p.jsx(De,{children:p.jsxs(Se,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:N(gt),dialogId:"reincarnatedRestart",children:[p.jsx(j,{className:`${de} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You dont go towards the light"}),p.jsx(j,{className:`${de} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),p.jsx(j,{className:`${de} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),p.jsx(j,{className:`${de} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),p.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),p.jsx(Ee,{className:"hidden",children:p.jsx(zo,{})})]})}),_i=94e3,Hy=(t,e,s)=>t*160+e*1e4+s*1e4,YF=[{upToProportion:8e3/_i,label:"beginner"},{upToProportion:2e4/_i,label:"novice"},{upToProportion:3e4/_i,label:"spy"},{upToProportion:55e3/_i,label:"master-spy"},{upToProportion:84e3/_i,label:"hero"},{upToProportion:1,label:"liberator"},{upToProportion:1/0,label:"completionist"}],KF=(t,e)=>{const s=t/e;for(const{upToProportion:r,label:n}of YF)if(s<r)return n;return"completionist"},QF=Il(({gameMenus:{gameInPlay:{freeCharacters:t}}})=>t,t=>Object.keys(t)),XF=()=>{const t=Fb(),e=K(UC),s=K(({gameMenus:{gameInPlay:{roomsExplored:l}}})=>ch(Ye(Ls(l)))),r=K(QF),n=Hy(s,e,r.length),i=ch(Yx(t.rooms)),o=Hy(i,5,2),a=KF(n,o);return p.jsxs(p.Fragment,{children:[p.jsx(cq,{noSubtitle:!0,className:"resHandheld:hidden"}),p.jsx(j,{classnameCycle:ps,className:"mt-1 resHandheld:mt-3 block text-center mx-auto sprites-double-height sprites-uppercase",children:a}),p.jsxs("div",{className:`contents ${de}`,children:[p.jsxs(j,{className:"mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",n.toLocaleString()]}),p.jsx("div",{className:"mt-1",children:r.map(l=>p.jsxs("span",{className:"block text-center mx-auto text-lightGrey zx:text-zxYellow",children:[l==="head"?p.jsx(j,{className:"text-metallicBlue zx:text-zxBlue",children:"Head"}):p.jsx(j,{className:"text-pink zx:text-zxWhite",children:"Heels"}),p.jsx(j,{children:" is"}),p.jsx(j,{classnameCycle:ps,children:" free"})]},l))}),p.jsxs(j,{className:"mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",s," / ",i," rooms"," ",`(${(100*s/i).toFixed(1)}%)`]}),p.jsxs(j,{className:"mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),p.jsx(Ee,{className:"hidden",children:p.jsx(zo,{})})]})]})},JF=()=>p.jsx(De,{children:p.jsxs(v.Suspense,{fallback:p.jsxs(p.Fragment,{children:[p.jsx(At,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[p.jsx(At,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(Se,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:N(gt),dialogId:"score",children:p.jsx(XF,{})})]})}),ZF=()=>{const t=K(GC),e=K(YC);return p.jsxs(Se,{fullScreen:!0,className:ri,dialogId:"sound",children:[p.jsx(ws,{path:["Options","Sounds"],className:ii}),p.jsx("div",{className:ni,children:p.jsxs(Ee,{children:[p.jsx(L,{className:"sprites-double-height",id:"mute",label:"Mute",valueElement:p.jsx(Js,{value:t}),verticalAlignItemsCentre:!0,onSelect:N(es,{path:"soundSettings.mute"})}),p.jsx(L,{className:"sprites-double-height",id:"footsteps",label:"Footstep sounds",valueElement:p.jsx(Js,{value:!t&&!e}),verticalAlignItemsCentre:!0,onSelect:N(es,{path:"soundSettings.noFootsteps"}),disabled:t}),p.jsx(oc,{})]})})]})},eL=`##*HohEd * the Level Editor
I built an *editor* so I could make the **sequel levels**

![](texture-headlessBase?float-left)**Make puzzles**!

*Challenge* others to **solve them**!

**In beta**; expect *crashes* and *confusion*!`,tL=()=>{const t=v.useCallback(()=>{window.location.href="/editor/"},[]);return p.jsxs(De,{children:[p.jsx(At,{className:"bg-pureBlack zx:bg-zxBlack",onClick:N(gt)}),p.jsx(Se,{className:"bg-shadowHalfbrite zx:bg-zxBlack px-1 py-0",dialogId:"sureWantEditor",children:p.jsx(Zl.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[Da()&&p.jsx(qV,{className:"text-midGrey zx:text-zxWhite"}),p.jsx("div",{children:p.jsx(me,{className:"text-midGrey zx:text-zxWhite",markdown:eL})}),p.jsxs(Ee,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[p.jsx(L,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),Da()||p.jsx(zo,{customLabel:"Im scared, go back"})]}),Da()||p.jsx(Dq,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},sL="2924c962-99f1-4dd2-9b9c-fef832dc991b",rL=t=>p.jsxs(De,{children:[p.jsx(At,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:N(gt)}),p.jsxs(Se,{fullScreen:!0,className:"bg-metallicBlueHalfbrite zx:text-zxCyan text-highlightBeige selectedMenuItem:text-white zx:bg-zxRed gap-y-2 resHandheld:gap-y-1",dialogId:"whichGame",children:[p.jsx(ws,{path:["Select which game"],className:"mobile:px-4"}),p.jsx("div",{className:"flex flex-col gap-1 p-1 overflow-y-scroll scrollbar scrollbar-w-1 scrollbar-thumb-lightGrey scrollbar-track-metallicBlueHalfbrite zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite mobile:px-3 ",children:p.jsxs(Ee,{className:"gap-y-1",children:[p.jsx(L,{className:"sprites-double-height",id:"originalGame",label:"Original Remastered",hintInline:!0,onSelect:N(co,{campaignLocator:Rz}),leader:p.jsx("span",{className:`${ye} sprite texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(me,{className:Ya,markdown:"*Remaster* of the **300-some** rooms from the original game, lightly updated for modern play"})}),p.jsx(L,{id:"remake",label:"38 Years Later",className:"sprites-double-height",hintInline:!0,onSelect:N(co,{campaignLocator:{userId:sL,campaignName:"sequel",version:-1}}),leader:p.jsx("span",{className:`${ye} sprite texture-heels_standing_right selectedMenuItem:texture-animated-heels_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(me,{className:Ya,markdown:"*Unofficial sequel* - the empire is back! All-new levels designed for the remake. **Work in progress!**"})}),p.jsx(L,{id:"community",label:"Community contributed",className:"sprites-double-height",hintInline:!0,onSelect:N(ot,"communityGames"),opensSubMenu:!0,leader:p.jsx("span",{className:`${ye} sprite texture-charles_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(me,{className:Ya,markdown:"Check out what people have made in the editor"})})]})})]})]}),nL=t=>t.startsWith("markdown/"),iL=t=>{const e=K(s=>s.gameMenus.openMenus.at(0));if(e===void 0)return null;if(nL(e.menuId)){if(e.menuId==="markdown/inline")return p.jsx(Qu,{source:"inline",markdown:e.menuParam.markdown,dialogId:"markdown/inline"});{const s=e.menuId.slice(9);return p.jsx(Qu,{source:"manual",pageName:s,dialogId:e.menuId})}}switch(e.menuId){case"communityGames":return p.jsx(nO,{});case"controlOptions":return p.jsx(ON,{});case"crowns":return p.jsx(DN,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return p.jsx(HN,{});case"errorCaught":return p.jsx(QN,{errors:e.menuParam});case"hold":return p.jsx(JN,{});case"inputPreset":return p.jsx(ez,{});case"installGuide":return p.jsx(Qu,{source:"manual",pageName:"installGuide",dialogId:"installGuide"});case"mainMenu":return p.jsx(cz,{});case"map":return p.jsx(nF,{});case"modernisationOptions":return p.jsx(FF,{});case"offerReincarnation":return p.jsx(jF,{});case"proclaimEmperor":return p.jsx(LF,{});case"quitGameConfirm":return p.jsx(UF,{});case"readTheManual":return p.jsx(WF,{});case"reincarnatedRestart":return p.jsx(GF,{});case"score":return p.jsx(JF,{});case"displayOptions":return p.jsx(UN,{});case"sound":return p.jsx(ZF,{});case"sureWantEditor":return p.jsx(tL,{});case"whichGame":return p.jsx(rL,{});default:return e.menuId,p.jsx(Se,{children:p.jsx(j,{children:`unknown dialog ${e}`})})}},oL=Un(()=>is(()=>import("./gameMain-BZ82_oU9.js"),__vite__mapDeps([10,7,11,12,1,2,9,4]))),aL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAARAAALSQBAQEBAQFZWVlZWVmNjY2NjY3FxcXFxcX5+fn5+fomJiYmJiZSUlJSUlJ6enp6enqmpqamptLS0tLS0v7+/v7+/ysrKysrK1NTU1NTU39/f39/f6urq6urq9fX19fX1//////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAZAQQABuAAAC0mIpRnOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABGwBW7QAACH6lCs/NvBI1AAbSkgF4ABRZcPlz4Pg+D4IROD74Pn+q3wQ/KOwQOQQBAMAAOJTDmiIJGRsnW4gAAAAGHBw0GGr6h1QsZCJmtI5hYgmsYoAR0Ag4JBUuUZAsPJMg6JJglclhHUckcsioTqgczgUZ3kIHEq4rEwqNkFsLgn2Y+C3J43WE3Xo9BYGhDDkPxFE+X4CQuplOyOZfBxw0udCrX3zOQVmZoMIXhedAAJChVEEU7wAEGTZdNwgH7mWw5DSFJLPdV2KNnLuOzSTEqBeEAdPlZlTEwHqxNqs1LMcxMM1a1djNU425jGjLFpvdlvuYsfO+n1l+gAR6tolOGFYmwQBCMWKqZ1qMDBIZELiWfE5pVNre897tRKIpRXrvmoG1vegftCy+Kzbj//LZEz9fMoQA2aXZklv4AAYkhwMhQNKHAIx0Fw6iMOQxEpgKZZPRYJ8qBGb7ZHoZqcMofVh2ktwoGiAkzC8VF9v2AAkLDsqNzd5lQAV49Xg4qgYi4La1Xx8Tg0zFyPZIkpbTT7GNSxffKqESjUh0B0DZvlpu/0wBWqpZVsm4AAVjWOro4yB/tqpNY8ZjQNFXPky40t8krDdfZpDHvm58XRUg0XCIpf4nF7nTcVfLwQBXeXdXlvCymVErYmUA1UDNKRHROOh7OHcKWss9aNWDMxPfS5VDJocqMY8plQWcUpemgAGiJhlSS8AABLZawwON1FlnaA2kBuSB6H4eRSYmC0sEFJ6AoX2k5armpKStllLC7mA2Ui/iAAsTEyzX/hw2PKNiagjPDYWlUyDk62rR+41nJr50i0hS0p5W1D/+1DE3YBJfKlV/ZQAKOYGqrWNMBWNB1CoYU2F1bm1AEiIiHeP/wAAGeu00cmu3GAFjOSBwqEpNHHeS+xC60FPuHFcS+ddde3vq92QACKzvDvtwGIfpxBPjpjH+mmJx5JgBEY8FLXit5bva+ElTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVEBiZgJkAAAAFhBRpzk2oF9X2Vys7kT6VmBXM0AAAqVgiMgd0ljw7xocqTEFNRTMuMTAwqqqqqqqqqqqq//sgxPgAR1RxXeywY2jRjir9lIldqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoQSXcAAAAAADsYgVwgUZnVIPsgaXAKRyFrIA7uFp1MQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7IMT3AEcIR1PsvMMoyQ5p/ZYMdVVVVVVVVVVVVVVVVVVVVVUiUAAABiblGtCRdQPwAdAVA2HQVHNLqkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqhPQAAAO8d7/+yDE+ABGtHNJ7LBlKLsNKX2GDHRUNQVKqAeAFALgMUhOTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIoAAABVRRqMgKxqApRNAYEQONA1MQU1FMy4xMDBVVVVV//sQxPwARZQhSewwZmiDgmj894QUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUwAAABgK0HQWBEQADnZgKHRLExBTUUzLjEwMKqqqqr/+xDE6wDDBBlNxj2AYEQCajjEsAWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqIgAAACRH2BRkK4jAAqJ6MYhqTEFNRTMuMTAwqqqqqv/7EMTlAcJAEUnGMeAoLoJpuLYEFKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqjQAAABWHpJWVawACtQ6Yp1MQU1FMy4xMDBVVVVV//sQxOGBwWQNQoY9YCAsAihQxawEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWAAAAoBIFQJYcX1UxBTUUzLjEwMFVVVVX/+xDE4AHBgA1Ah72AKB8BaJDGLARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVXCAQAAAAAA4GyRY0NlTjf/5362Fc93KTEFNRTMuMTAwqqqqqv/7EMTgAcE0Cz6HvMAgKQGn0PYkBaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN8BwTQLOQesQCAhAaeQ9IgEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE3wHBRA04h6RAIB2BZxC2CASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTeAcEoCTEGPAAoGYFmIMeEBKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNuBwPAHKqYcACgMASVCkgAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE4YACzBk0mYAAAAAAP8OAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",lL="/assets/bonus-CvVo342Z.mp3",cL="/assets/bubblesLoop-B_LY362Z.mp3",uL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAHAAAH8ABjY2NjY2NjY2NjY2NjY5SUlJSUlJSUlJSUlJSUsbGxsbGxsbGxsbGxsbHKysrKysrKysrKysrKysre3t7e3t7e3t7e3t7e3u/v7+/v7+/v7+/v7+/v//////////////////8AAAAeTEFNRTMuMTAwBJwAAAAAAAAAABUgJANtQQABrgAAB/B6uTQrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAABAgDT7QAACIImOq/MPAAEJBsURDiAAEUBBwIGMEwfNqOB/lKwffKBj+IMoCGJwQmJJWiaVAVBQwskybYBAAAY8mQzeGmHtSaXBy2yKgEkRsibBi3wOGaBGYZPx1okZ53oIk5dk6cA9RSxkJaXahNQ5C2F5WklAbHyfUx3rZ5LKsYXJdSNdDHVLu8B46uyn6pE8OmLHm2qGNUQocvvmmHVL0zvzqW0eHCeeUsxUlA7P39Cs1jJVY1EKWbbhgiQiX6wiPAWU1AApZk08REEoTmCh652bI4C8N40VsJMQ1DzqOd+1+bL/MjxkORqViL86shsxVl2KsI2ujQVC87XDhZD0E4qdOqU/1fRcPNsiseRoFbP2yumR2kY0djbG0v7Q3PLPIbWoFZl/IqHGSSmn8JgeQbVlzBjyNcfeK4s4RY2bV1W1Ib+Pv/w/TGqatTeX7fmABrK38xETIRACEm3QE0SFLFuVZRMgtCqisKyoZ3kin58iaOSqIculpxtPd/6cTf+ktz3OnvyLDKbeX/16pF6d8IUGHQEPNlVOYTkko66Jxhgqq/L1XpkDJTQxJSKToCx1QZCJDQqD0CFk5RtERSkojVt06ns8pWEc1O6g9RT2I5nKGUghNIgm+mzNBN0GBa20LmURYs3dopwomTPuxfMt73nElqpyrtc1Z1RRAaSkwHbB6wSLikGUSIqSnEStIhkahAz2KXOxV1nb8I+CapoNFnlRERljohLG2rOsfbiJYiAKxqBeMERZ8aVro6yTUsJWxUwu53Z5ljBNROQARCYAqDhVkGSgUHkJ5BMUisnaT7gquejBTI4OAAbJv/+3DE3QAURTlh/YeACUYZLrzzDcwliqC4mNiJQCfDS99qMbryA54qW+ii7ZkZlQyBkl9AZnNMB8NAOicSzNKZa+FGAdr+ovEOMbBe9dq3FX7cRbm1DRvLBeSLXdP//9RpjHQzxTdJfo//3QuAKGZzEJy7AAiURgPywUWFIjNsJzXIESDEAphNO0z2YiwwFl3XoCpyhR4RmnnWHzxG0Ywcm59YlMF82DSZw7EogqSAAWuISoVDyEuRLIxThCiircUsheFPYaYG86iSivs+K/XIoyviu+zGnf//zi5MQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqgJZq8BUKgi+IweMHBVwVsI1BWeBaJXdSxgdlXc7LUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVV//tAxPUACiEtdeSEWWEyjO38FIw0VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+zDE9oAHuE1p5JhqoP+GK/yGGJlVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+yDE+wAHdFNd4CRBwNEGKjwApAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOUDw7wXOQABIEAAAD/AAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+AAAAIAAAP8AAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",hL="/assets/conveyorLoop-CF-OA6qJ.mp3",dL="/assets/conveyorStart-CcCK4MGd.mp3",fL="/assets/conveyorStop-D5zeg8cv.mp3",pL="/assets/destroy-CZDN4Ktz.mp3",mL="/assets/detect-D_kRR5uD.mp3",gL="data:audio/mpeg;base64,SUQzAwAAAAABZlRZRVIAAAALAAAAMjAxOS0wNy0yMlREUkMAAAALAAAAMjAxOS0wNy0yMlRJVDIAAAARAAAASGl0IEdsYXNzIEJvdHRsZVRBTEIAAAAlAAAAR2xhc3MgRXNzZW50aWFscyBmb3IgU291bmQgRGVzaWduZXJzVFJDSwAAAAQAAAA3OTdDT01NAAAAKAAAAAAAAABIaXR0aW5nIEdsYXNzIEJvdHRsZSwgU2luZ2xlLCBDbGlua0NPTU0AAAAoAAAAWFhYAEhpdHRpbmcgR2xhc3MgQm90dGxlLCBTaW5nbGUsIENsaW5r//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAOAAAJ3QBLS0tLS0tLZWVlZWVlZXR0dHR0dHSBgYGBgYGBjo6Ojo6Ojpqampqampqnp6enp6entLS0tLS0tLTAwMDAwMDAzc3Nzc3Nzdra2tra2trm5ubm5ubm8/Pz8/Pz8/////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAXAQQABuAAACd1hx+LLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAAA5wBYfQAACIEmGp/N6ABmZYgAzErrwAAAfB8cQKLB83lwfD5c+X6w/BM/y8XQAAAAAAABkLQ3wlAAAAEQCwAwww0+WFa3dKgv4UAX3JSIKgDXzlh5HA2onSwloqV6WFcNjBcHO5I/A2nao/IO7QNDrL5DEV7sGilCECu5N2ZdD6x5VWsTCGjFa9mHHFiEu5P37Hf9oTWJXUhuJbi0f3jf/////Kx/6w1IqXWNbDPhkACAABbeAAglG0QILxOnB7jM6izYniEZDiombEIbu2UDNAsCoiDAR8RMrHzFdtSTKSlIhwndIvEFQJoni8dPVGKK060UeUVmT39aE/l8mXwVKPLZsuYARADU+sYvG5LsvtYZ1nAN6GjBlThtPbQ41qaNRKnLBREVTK3U1235+UqDZrLmni127D6GP7hQP7esoGjUNUiyqt5YQVQCibgADqFMeHg1YBC+v1Uf8WImfCX2fb7uOELxKpF7Zo0YMEJXiHq9QV1GuBcuGQ1oIy1R5Yyaq4EFYAiXvMoZmtw887IpW1j30JKl6XVIj/aMvP6BTW7aIDIRXh8oxbkyFCdKLvuxAmEf7gAACUdZaUJZc/MUygMRlgX4rXomhjhgAI61iUMeob/9VyliVmmGAHcGncdaLpwYClXWFmpAllZeRCMRufXVZ9fSZpuIF6SzMlVALqhB5WdwAAAKqjzk1H9osoBA0+eS2xDa9B7PvtMmf9YBVVYZdVwAMnzjOLOixgcJ+o4iHkTm4Ghzqw+dUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVQC6tguqngAAACpVR4j+BDEUApT/+1DE34BKpKlb/YkAIQkVa32VnlRNmgn05U6qyId3/pItAN3GDc4OCrmmUNA+BOcus1KXqDolTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAJiVCAgAAACCtZrSkAaFXbQN8xwByrKrBKAC3GVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUAWg0A//sgxPEAR1hjU+ZgpaC5CGo9l5WUPFJEWDoMAGAGAMAKSkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoEAAWFJYIvgAC3XiY3TEFNRTMuMTAwqqqqqv/7EMTzAMVIXVvg4QNgk4hpOBykZKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoAMAAAg8N5aA1MQU1FMy4xMDCqqqqq//sQxPSARBQ/T+BhIyBviCq8B6hsqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpRlYUFXUxBTUUzLjEwMFVVVVX/+xDE8IDEAEFT4D0jYFMGK7gEoG1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUF9aTEFNRTMuMTAwqqqqqv/7EMTkgMIYG0/ACYJgMQOo0AQsXaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN6AwTwdQIAFZGgaA6jgACQeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjEwMKqqqqr/+xDE3IHA5B82oAGA8BeDp1AAPByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTag8D4HTUAKeggBQNmQAAcJKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNiDwFAdKACB4SAJg6WAECQkqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE14PALBsuAIBBIAUAZoAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA/wAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNYDwAAB/gAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",AL="/assets/headFall-rxdxTCeK.mp3",yL="/assets/headJump-GCHlCfni.mp3",xL="/assets/headWalk-B5kQ4tvC.mp3",bL="/assets/heelsFall-IsGtipMw.mp3",wL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAANvQA8PDw8PDw8PFFRUVFRUVFRYGBgYGBgYGBtbW1tbW1tbW2Dg4ODg4ODg5SUlJSUlJSUpaWlpaWlpaWltra2tra2trbFxcXFxcXFxeTk5OTk5OTk5PX19fX19fX1//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAP3QQABuAAADb3ce6y6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBabQAACL+Jyq/M5AAAATd0rslm3BwuD4PvKAgCEMYIAmD4Pg+fiAEDivB//BB2CYP8EPlHQfB8PygIfUcwfD+CAYAAU4EERahmVG1qTLSTRQACHQxwMcMsQaNBDJykQAnheOVsEjpbtBSluhY8aLnhkR3SqInu5pvluoCGSNeIPEP7PIsMVAof8vqJIx+WjoAGziDvEiannoTqQJv+0KPDobqTKkIbRlSwicofK9BcD9jj2flFuRxqG4IZpVoIx+cf3jH3bymJbbxuRDmnwwrxLmpba+3O/ErHaWc5hR9j1FX+EfSxTtJf5Xw7U3zPLtX93P13n8q0H8rc1fcf/2L9C1KBFc4gxM3ZCYJmGinxCyQF6IUdQ+jRISyQlcGwEOLFUWAlRJGCxiiZGykUUUVOsZRsxqgbLdYXQljEukqSpKi1RH0CbCYiMlaKRuVF4rBUmhlRRMaI9x4osiymzPfWyRkizL17nqukpI37b1Ge+cSSMm1qSMlXb1mySRvqU6jZJX5hhAoPEGrCrl7RMBc4xmIkmS2dx0kvlSGcyItAQ7CyS/Im6bufIFqiY2tBakdJ/EMFq2Y8EqwmDkowf3YIWW1NR58qp/W7OkvEWr123iWK4i96wY5eleVa7basASy6Q4hZ3I4etRFgbWA2XHZiHG+y+QF2HYI4TiV1JEWkxrXwwxLraLURInnGvIxrj7qZAZf79rQT06eVSprKvhjzbStl/25YYBkc4lld1tgADlzyqygh+XOi5b8cqWXJOiCP7izoTNBbakKzalazLiaPx0MIQUFDj5qZnDbNvW2IU+d2jMC5bmOa8HfWbaEuoX7/ofcHaTKCaoIKVk2lFU+TQADpM9RDdyAlEXAlK6OnRKRHINRFtwMUFl3Ww9da+P2qv+f9wJyyJoxE4yTEFEzrrqIhw+nan+4Rr4+fSdsUW2CB/VrcgGS3iLl3+/+YAKdlIf/+2DE6IAQdVFb/PaAKUGVLDz0HfSlDIIgrA4H92yr5cAuKkFkhW7a1rZDWricNKm+oQmq25qlRr91S79meUexMW6rst5aLH/u71fzQAASKHmP0cFUb7VH5vUUppI9RQrVs0alF94d2ECivnfDHRKkw9EiSy+l0e9T0ZWd9/+VdAkigRcGdFAl0okAoEAYAGo0SOObDj4QAiD0ej4AgBlyt9sGDiq7XKjYyg9chwAXABM+F9A2wiAZ2BFwwv6A8DLkTGIKBDZQJ/qw48QoSwtg54XyHPC5AKQRD8+M2TQ4BKBASSJMTwOk2E8/zcn0jQuNEZFAQmFpEaFknP+ybn0GZOVxKBb/+0DE9oAKEM1b56BxoUaZ6j2HoHzIsM2LgLJoOP/+yC001MhOmyJkTpkiXjUC/9Px8VpHYGaDBR8uiAKF8r1kDRHDX4oVTRp+YZj9/B+amUqE46DOi2iMgeRvJRI0UbIol0GwSzzNFnNjzwVsLijM2QdMjvDbESjW1pamwzi0XV5/MiX/mmkX/6G5mv9B8w8lZyVnElvL/WTmDRAgheNxEAEpQIGsN80TuDtnMlnLCfqHrw9W6v/7MMT1gAmoqUvsMWkg9hKqfPYcfN6tr/F+M71h8j3JG2a6y9rzqELFmDWmPrNcwiQ3x9Yx5d7yYJeaTwdV93Lez9HjRkfpuBZ9+T4gf8k+Ofwyb/wZcF/jSPK0VRZQmIIVTzbNFgy35L0whBPTi0mVYsmen3JU+67Wsf3+vqmmtSMcfb6BjyXvzl3rN6V+dzRCgGviO9U/CAFSYf/7YMTzgAcggUW1gYAijidqvzUgQMuLnVQWVPiV9H5VjRT+l4F/loQ7f2y/1//HSPI0C6Arwaur2vcIA1LBQ1CmHEbm/92uTTvv7VilrsRcXsK1podo2HzUrH28/H2+s2xDoV7j4OrbvFiq45nCusWz8+uDvOmIzTwab00QnIdiifcX+1rm//wUyqAZ+Y55mmFp3cW+r60EQodkND92jYAHly9vYGehmTdM7jmwO2uF1uEPasNO/xbMbdfbC2q3jC4RpNQZtty5YosXMHWHuWZnGnLj3xjbbDzokInKmkiNVQwC2u+qOiCn+WaVJAHULvSc1/1e5YSQGimpk5emQAJmsIhLFf/7UMT9AAytA2H9hoAhkyVrfPOLzJ5Dq4L0DQ7J62Vxt8JluDcoVZzyxqZ/vK7D0v3Vy3vmW98ZlT8pHDMyplRSBo1RDRa19VLISV72ThYEndXbNx8RnOPmsqocxH+YuO3/+Q5K3pUdP/A++awgAFaY1HlRQE1pyZC4MNyGrFsX1Rk4g8uOQDy8migDCo2qNSQJkdzViTxUPc1as8PHZeyNmD329Pyw+W2dr28AAACXPUDhVn4l8Krv/KY7A1uJOFqxOElu6aP/XB4yPrLtiJn/+1DE9QALhSth56y6YZKdKr2HofzIIFy1rTeWqGGuSgIXr6P3ff/22dn/6/QqeAmgqWaTeECCoYEAIAAAAFx64msnKFFjiqafYSTbc7jgMvUbJcvn2WWYebpAZ1KBr1dlseUBqw4bKBhRfoGjmgWVgZAIGFBc/f8G5geoRACwMPQ//C6gWcHqE4JzEYf/44BZZsaDliC4yf//5qQMiYsggh4Zgihp///5EzhcK9Zd///B8PA+CAADH////0gRAAPWKgvFMiPaNosABEAHoAl0//tQxPIAC+TRTew9TeGBnWi9hJ8MSKp0muQGavaZwAYYcqcx4NWwzRUyBVtEChJaWRYSccwPwYGPXRGDgriBR0rsBHi4miGPAaDyCpmAyZmwBGiik74hC1I0kNEgq0+y0YFAQVFhpSX9SsFcooM3eyd5LciIoQXmEASMEoABlYV0/ADR1PU+P0cRUY/SZLkBAmw2bgB3uSmFZaoKeSPi/FXCCp1cESzkj+R2rWhqnz5q9Tf+qb/1yd39yD3Qy+MyyNy2rlF9Svf8nZnuvqXrH//7QMTvgAf0oUesNKzhBg3n9rCwBPq3U//3dpu3LwPSVTb6tbitOoA2ukN5JkSUlAYEHAkImfuZKXlcalg2WtxgSRyynjiOaVCSKxNdDDxfaS3FUFgWr/1qggwvnORt7jEkVEEK3/fkP/u2Vb/ouhP9cs7yMQ/PWeppkGmHU1dd1YgNOQoHEnhLKEyJ4q2cuajZ1ezv45cQpiPGANEEFppumtSaaA7BL2rOpvbQ4sUXetNNabGJ//uAxP8AEdUxU/maAEN8KSq/NbIAoaDkBwDWbz5s6epY8E1piGSZRghd6ytqAzpb/qd0zMna/6HX/6noGC9vzqDiKkYFYKYBUCQBUFBAGAwAAADvUU0NTsnI/zOjRFNNZI7/EV6cC3lMf9MQEvCS4LEcRMLC6P3JYepIl0TIdxfC6+XhxDGNZNJUT4yNvuXR7D2TOf/pGJqTVP//zpdJFJR1EW/56W2KTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1DE9AAKYOtn/YUAIamnrD6e0AWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sgxPKADKDVUfmWggAAADSDgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",VL="/assets/heelsWalk-Bmk6WOTI.mp3",qL="/assets/helicopter-BYGzJTF2.mp3",vL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAMAAAMtwBBQUFBQUFBQVlZWVlZWVlZbGxsbGxsbGx+fn5+fn5+fn6Pj4+Pj4+Pj6KioqKioqKisrKysrKysrKyxcXFxcXFxcXV1dXV1dXV1ePj4+Pj4+Pj4/b29vb29vb2//////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJASdQQABuAAADLeLlBWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAABqgBYbQAACJ3neu/MYIARAV1lrd0u4AfKAgGHA+8EAQB8Hwf4gBB2D4fygIO5cHHcH+UDH+oEAQdic/lAQBAHz+BAxoAQBSAwTDAgNkVT1nptAgAY0GGiYh7PCRB7DVx5YfkOOROSqQUSkYfHnOLhrEBoy3a5IOd+kTrUdfJXD4SqC23fdhrDn9VGu+Qt0nmCOG6FaA4Ae1uz4xaWQfGZLemJfSQmknrk/Sbv07+xC9L5HMUtuU1Z2IWbs/K5fqB5uzEpTRT0owszM/3m/13/pM963rffzrw+CDbv8oNBhIDE6rYGQNTY0KMcsuARgjTREBw4Ri4lBZ+m7rPl2FVO9Pq/kQ4BaQPIVXUKQENMSs4tYXKPuiQMhXx8Eia0h0D0uidKzaBOkTmQyhqtjMmzY+qs2ugouvY8esZuYoqRL5s6a2WgiyJcNs6bpJoGR5lMsxVTWpVajya1S+gtkEKa6k3pmakUy2aqnjiVBBJddqmzCMI+j4M53RLH3dr+TYQYGiM7BLic4Eo1vSFBQHNUD7gA7zX+eZpX/cgD8G5e0Aiykc7yJof/8qNc77txu/HHXJpxv1HGzQozYRplB3VRUOpE5BFOINWjpk9L0nTn/SMyKfmfY94QSU9P4JHMjMRbGE+VP+vc3EYseEuQRzpwWcUP1S6128evAlRtUZ2GCGlx9iSNLeJR73naPocpt+dCjFKam+tERuTgd3X1CJg1b+jOpjB+y8U3EeTz+F6hvN7e3v0IdXVj1S27Iys96P1br/29/T7f16yuznaZnRLUY52tV20UJIr14XBsyPEEAbe5M2jVjT0bJYkSst1YAV9QsBlIMsO420Vg3RFs0KkLW0T89yeZ+J6n9/Tze3t0P0Xq/QvX0/6U7ps3t0/vEzK2GAWU5xQGFIs71p31HkDDNVsDTRZJmyrDjWPDvT0PZ0eYWm5QFdneDMKSaLz5v82JA7nkUz/+2DE+QATXVdp/YmAKeew7jzzjuXvVgAmb8f43qGvqIdS+f29/+LdD9X4w5E1botnbanUfp//fSmWaLWXxRdb4Fg7oqyjEC5KUFvVVSNicwizxubAxpbaJEgc4fE0K6beiDOD+eQxEdoE7y3kTbh89FHuyUffVviXPW1On5d0/S6GpvEtT0sozsS7ez7f33VobykDRRNpAA7tweNRCwUpRA8TjHZszi8fHMMpd2wWVP8lndHsHk1AfbUT/Hvv5fRu93uk68hvhupsNwFWcpoZIyodR2duivvqW1DGKbJzwUhHSO8lCcm5RC1A69cnygdbFgWDl+KyHFStDWHLqwBAlUNItbj/+1DE5oAMBZt57LxH6WAlr/2GiTQMep4YoZGdlTlAcef7+WxXdBGt8PVDJN5d0jU+Q83vukqDKnO3SaN9tVs3iZlalUwZIEMiSJgFJ02unBmHeFs3iCULufW9bJig6ZlFPe/gKmS+kPtQEosYaOz4j6UDhepvTpbQf29eD9W4Z0jvUyrbXXtqXTjqPukiTPZURy3A72GCaqjPGzFI8E5tsJme5qpARahVmLv2NwroO9ktPvW6hfpUnoC2q4Ys7wHod8ls5vbq2gRV2Jx3fU3V//tQxOeACdTHf+essmFFje89h6i8LkZughomPzcg5KKXwPs693/8Kmt2K0btqo0bB0xEkpBIzcmxus0lWdT0kc/jYXLy3pPwtc97LrhYFTbzQEq1ig7CFXwhtGdG7mbQP+3VtxL0Tl9S8YLyzpCJP6KnsZRQaUUMKeOKyz1EXLc/WSlYq6+hyIolpBwBHU3ZRac/EQ8hsjZQLw39Gat+9BZgVjNTQXwzN4wUDlLWpdnlGAHNTK+XbkegidC9W4IX0V9m6jcEnt0bovL7+qf5W//7QMT1AAmscXfnoVIBU5HvvYWc9NNbaq7FKMIrPqI1L3KxbX+SqgYAJCViAAC/R5CDjKFMyod7VAJ3owRV6tUkYiFq1LMpdwYgF5UNM+DDSvAqXVTQs2o0U1YufUdbiU/X/ne3Kt0/5zccO/2+/+vufspHUwxTZc5BX7k/8hrVFAggckSAAAu8TzVmHJLlQu6Ro9dwE2f1VIAlvWSReDGSvEKzsoep7UMZJdZNPdN+N1Auo3iv//tQxPQACgzHdeesUKFQGS889QpMtqXp9fN09N5m5fXyFupO6M1TEWYpN6loJG307mHqigcARERIIUjOCbmQrBhghVs8Alr8FwKrW8mCl4uciKnnrwUL7rH9a3lJHW+Kr99wwwNYqoNej9RHQB6k6epOrdH6N0p//K+z9D8j5o3ZmePjKHdDWEAMqCGwQUnwpOQw8q5F1T9KtGfIUKixhTdWStnxrTQ/i4Z1A0/UBpPjZuJvAvP5upeYM3X05VbKnN6fGXp7dX/1+3X6mxINlv/7QMT/AAt4tXfsMLBhXSVuvPOKlDSXnp8LBm5prFKy8ASXKlJrkaq9yDqsE40hao+rGAJISmPYaBjasuyzLBdxYBKDOr5JU3fRuj8L5PL5NVZrba/ty+/QaoN0uUQt3W16KHwYBmlXSRJW8AEXpGg6hBRrB0mdOMovLTXRYw8rWsFkt+9wzCt17HdbQVB6rEQYTIvzPzdH8vl9PL4NtX6N0N0CG5+nxttGdvpqShcCOjZ2y7cA//tQxPYACz0ra+w85eFOpW09honkCvyYY3iQkUX0uU57GJb3KEkarUaAhhO03QDsJObmZfCfjZxxJayme5efo/fr9LWmXmIDcRPtkt8Q7bazoRABQCAQUH8uLYAAAADVy4BE4GkD9DAk+0dUxRax4cC0Njc941/ykiERi5N1kFqSAvTfcJhhS4f4hA61y9QEFSWOlMqpOHkkXAt2FiEUrLIp8Hi1LJ+UjMmViBO5x5HTBikJ5qFjG9Z/+frWv4B4Mgh/3mb//3k7V//99weuKf/7QMT8gAp1K2nnrFEhMaWsvYOJ5NMhHICZLKAAVQEg1BqA04KwNjJawIQlCUTicfLlgYCYGgaUDQNYNA0e8Gg5lgaBVygaBnxKCrsSgqpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//swxP0ACWDJa+w8R+ElHiy884qMqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPYACKyNYfT2gCH6F2o3MPAIqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTxg8csL028wYAgAAA0gAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",_L="/assets/hushPuppyVanish-CZOUg83F.mp3",SL="data:audio/mpeg;base64,SUQzAwAAAAABJlRZRVIAAAALAAAAMjAxMC0wMy0xMlREUkMAAAALAAAAMjAxMC0wMy0xMlRJVDIAAAATAAAARGlzYXBwZWFyaW5nIGFjdCAxQ09NTQAAABUAAAAAAAAAd3d3LmJsYXp6bmV0LmNvbUNPTU0AAAAVAAAAWFhYAHd3dy5ibGF6em5ldC5jb21UQ09OAAAAFwAAAFNGWCBwcm9kdWN0aW9uIGVsZW1lbnT/+5BkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYaW5nAAAADwAAAAkAAAzXAEpKSkpKSkpKSkpKYWFhYWFhYWFhYWF5eXl5eXl5eXl5eZCQkJCQkJCQkJCQrKysrKysrKysrKzDw8PDw8PDw8PDw9/f39/f39/f39/f9vb29vb29vb29vb//////////////wAAAChMQU1FMy4xMDAEpQAAAAAAAAAANSAkBqtNAAG4AAAM17UwrB8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+9BkAAACtwDY7QQACj7AGq2ggAFNOH9J+aeAATUMKT8w8AEMl2x223XXYDXgACBOHh4eGCMAAADw8PDwwAAAAADw//0AAAAAB4eHh6QAd/h4eHh4YAAAAIDw8PD0gAACPDw8PDwwAAAAADw8PD0gAAAAgPDw8/AAABARKUssltuoAAp4eHgAAYAAYeHh4eACAAARh4eHjwAAAAADDx/+7wAAAw8P/YAAAAABh4eHjwAAAABGHh4fOAARoKg7m7q6w7fVgAAAAAAGVKJXHUQiRk6oIINAoes5bwJAnhHlxWSwCXhBQ4eYKkPgwBYAjh/EQSIvJdVKdKtimtsHgLcGcQpNLbPBbVFBjQTRQliNKZ1AxndK/MbMEYe///////////1mAojQbrDKzs7a0AAAAAAAB7QJFv27F509ww88gEd4/eNh1yFVTUcCJrEChbRFDkUKUUMJucGNVq023rZFZbsyxDy2QG1zkZoQKMR8sHoBBtNuO78AAAElR0jwLGOESSdqKEepFF9W1Oo451rAyxzhrsgmsz7mnMl0D8i1tkwUVjFzNVCPnf5YRjd4hoDKVyPf4AAASJEoONd/pWjpJ8pLpZp6aT8QEHzBGb0DFf7Q4wE4lEe6McUGC0yHgQTrtuh2bXAAIDG6r9xMwDkvQmgw2IUkUjltYRzNqJIYlSM76znywZCgohD3yXY2XqjBQ6wWPg0GDi4lv7SDBckyAxuy7cKELMpl0jVcWNjXdF684oREQm1IzzVBysxBAYZvB9u478ju+v+kb+t1ACZNdUu+4AEOkhKBm7axdX8Gmw9GBeGbK5SSamYgKsmjRLPttZMyFZ1U+4yxCD6yZEILmJqp7F5FT6JIpmAOSq34AAIebpRB0lUf5c5QGQHz8ioSLPpHVp5C5x+qR5CPRbQ//ERuuky8/jnf0BGEJUt78BQVZzncUifJYTRzMg5z8STzEJDzVlETIKRNS7NXeGx8pmLKI3TMjIGVOgRuxpZvU69awVWAkSjf8AASnYk4DvsrXiFkPJbUwQOdD2PF0tSYVTOpCdis1f6a3ZZ3ETuzFpyvI4lyRjKk0AFGNLv/AAFRFhLJmSoUNFAcIIlhArCocHTs//tgZOkBEewa0+88wAo3Q2p954wBRxBdU6exBWC4h6p09IzdOAPemIppHGks/UH26Xud1aZ9w0aovRKm0/lgzsFRytntsc/wPEARgAFl34AABUD1nUwG7orCEBICgIUGiChKs4wUS4Yxe2/f1gfV/CdaHlge/oz+92AZLa++U3B6DMDOM2CK6ZZzoo/IB/yqVffKmEiTsqSaKKXyM8GLEJEsKMMNOuAw8JRc/LmzyIYM72zERskwE4Sy09vyBSxKzA2w1En4fDTARJQlmi4Ioje5PJR3P3KlQSClMFAQoXnuhs/DOU5ELNIVIc5rvAAAgLu3AATAOolOC/CEl72SNCijGyYA//tgZOuBAd4XVWsMMbgwwnqdPMI9Rxh1VaeYbKDakuo1hIkcIFLhOTmJNFrC9faW29ON3mIP7ZQlkP5uXkU6wQ4o5miMQZp9fQyLSeRk62+lEmgdpgFEVZfgACLCcOcZ6V0+eU0o0guqtj2s0lNaTapUPbHIDcnKk1//e/0uftMYOS4Fn47N2AJQSijL/8ADfA0TkLINJaN8Xc4xkSjXBIlabPkTR5sksFELBPcisaGNdznE18177gRISF6tY7Zxn0pE1fv6te1oH/sMWtwsqb+gABtmKfhJZ1MHyWhRmoXE0w7QGC4IohhpEBl0UXuXY413LLQe6F0Qe7IKlVRvBtchTL+V//tgZO4BEfod1NMMQTowIVqNPSMzR6RfVUw8waDeEiq1hIzlYVIRRae++AAdZFieIeStBCTCu7NA90eEq09CBLmkkaKTjUTY3Xms3lu9/WztuTjBsz+3kPQKO/DQyA+o9bvmZ+mdh/2A+EWZxoubf4AA4C3eITqgthPRnJExAmEb4jgEPC1Q4bSnmEd6lJBw7Kkd5ioUITYeX7Jg1sgEQ5MzsGUE0GTCr/9wAp4VAXcXmsPDIPGtNt32gFzmTShwXkSokUmjaS1NdHH/772KE3LG8aqBYfWIyd4xRD9zuUIRrg5YH0Mb26XktEB5v7d/6AdzkDit34ABsdkgl2JwKUSkUpeS//twZOyAAjwuVNMMGnozJFqqPCODSGxRWaekaqjljys09g1NaWLaY7EfyhhU3aeWJfyt97VaQ6GO4KTZZJSm3OycuQgFEHJ1vSogyRS5t+AEKHoLwLeU6eHUa4blkSQXLANPQia6oxNbKoUtHItxEF57mT0/+f8OlD6acz3HR4hOmV/db5jOOTn/scnAK6SCCk3/ACoJEoQcx3YKI42Ukj5DUahEYwFIsauzFsNku/6+kY8zUFx2w6AFi944gDSQGWNoaOMAPTYRf1HALAKClvwAgkhctZTpqkPhKIghFcSARBseLlpnY8/1hy/WYIHlnmZsZGluCM3ROlwWhS5/5KR+WEEhND33hzbc9lIgkgAMUCU3fbxCpX1wTFQYhiTQJh0IIiXLaf1jqT2jVXGo7U9GZz10tOEfCP/7YGT7AAIvGtdp7DKKOeQK7T2DRUmgm2GsJG1o5pHr9PCOlMChiAIimDe8XfTYbSSCzxp3Ypz2UCdJGiCKUAAZPPgAYAgQryPVAywACUqiL4W5DkdvCec14MFi+HSFZWe5jILCuYxjFazTKWUrvsaispjP0KUpHlURBIGh6Ni3LO4rJAINwgAKeegBLCbCPClLon4DqOldGiwHVDTp+KJtagg4nJjCjBS1JtmhrD9UJua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",kL="/assets/jetpackLoop-0RyqqDBh.mp3",CL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",PL="data:audio/mpeg;base64,SUQzAwAAAAACQFRQRTEAAAAOAAAAU21hcnRTb3VuZCBGWFRDT04AAAAHAAAASW1wYWN0Q09NTQAAAFcAAAAAAAAASW1wYWN0IG9uIGEgbWV0YWwgb2JqZWN0LCBjbGFuZ2luZyBzb3VuZC4gSGl0LCBJbXBhY3QsIENsYW5nLCBSYXR0bGUsIFJpbmcsIE1ldGFsLkNPTU0AAABXAAAAWFhYAEltcGFjdCBvbiBhIG1ldGFsIG9iamVjdCwgY2xhbmdpbmcgc291bmQuIEhpdCwgSW1wYWN0LCBDbGFuZywgUmF0dGxlLCBSaW5nLCBNZXRhbC5USVQyAAAAIQAAAElNUEFDVCBNRVRBTCBDbGFuZyBNZWRpdW0gMDMud2F2VFlFUgAAAAsAAAAyMDE5LTA2LTEzVERSQwAAAAsAAAAyMDE5LTA2LTEz//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAALAAALmQBJSUlJSUlJSUloaGhoaGhoaGh6enp6enp6enqNjY2NjY2NjY2fn5+fn5+fn5+xsbGxsbGxsbHDw8PDw8PDw8PT09PT09PT09Pl5eXl5eXl5eX19fX19fX19fX///////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJARIQQABuAAAC5m46ML8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB3gBcfQAACNdsy4/NPAAl3qJ2XMAAC5OFAgGFg4cLvKVlz8HwfeUB9QIHCgIAgGIIAgCDso7+Jw/8oGP6wfB8P/+fUclwfB8H/B+ZaZhnZ1QlUiApNnQ2Dw/ssBgMUS/OXDzBIYWCSMzRsxIovmBgqNiagGjBYWEBEzx/goyZdThDkwYJPk8hAWCGkxMpmP4BjK2KpwLQ9cFcqhCLEHYY20YVFrd0bJ0KFFGS0502YTUVvfKatEy5rW4NECdEKaZrXZ4bisksivixZZWF24f/UaLiBRgmW4fhMEGTLOrJZ8Xis7yDnWV1BgX7x5RngUYPGeUS0VzbMQ9SvI00kBthYzvXtX4zrxXBAN7HHxSLSBqlJbbf7iQM4h23qLA////9IqqlmW1dnVYCUkZmwP1KhxCSn+4ksNY9lhKlsa4LYlHMaIh4WDCoLTcwYPuGHxyTXRx1KQw9imHe0Q1rFXzBOURdSQIVyOpLHUYP4mxZ0YgfE7VbuMtqPfMEoxtmafQfWqra9Lt916Hr2k+trS98vExN21LdznsscrwPtumUtJ2zvdQ6MyTRAe0QEZW7Nye5yY401/mTv06Tc5dnjKpOtRAIV0E9S/85zK0YGqO2xsafTMy8tWKmc+G3PRezL36p1/qvmuV1TIyzv32WYCC4dIkVgyoWHITzw3pdZV3Z5mFVjZbISnjk1J+hIZGa4UBG6QlgNl5NbQvW0zrFub02qHmz/+VJ9wt+MSFCp5MCJNdDpELPxTTvtXUPrAo20gVmWiw/zqP/0fX/oqGWGhWUSiiQjmgfCkMlDy2FewHwttKMGyi4ZRImur10U2ZN6mehHCx9wIsOUUVcGwEHlB1R448XMNPuUdZHiY1zHGnxOkmFQUgGdMAr3//0F/Tv+ru77bNEEghzjUAgaR9BlIliQHghLyiTokNMXj84BMDKOpyBL9CnxDSqNLU7PS/sqNVt0V9xHD/+3DE2QAPrXV5/PQAAXAkb/2BifgKGiN0B1WPt3YZCJ1C1g6Fk3qraXWl7f4Rjnr9Tw0vUw6EgmDLupxvkAIAICojjUqF4jGA5lRglrF/vawwSwMfHCfSTmd4YOhi+GTnzLJPL525eU//ar/nCyPPlOmhw9NN78PNXaF5rhUsrcK4c+4pDesrX0//69f/vrCAUAAvBLYOxiRaHgKJrYiiC8TzMc4TNVW8n8ElLmcvasOAyFsUFYafMlr3KZVLenGOeZ3vcgrWElJPPJfiIUoON5JPQyr/9LP93VCM7s6qgEFJF3wh5hyOIsEYRQdBqdjt7ZLM9L+Q0BozlPNULoYuEQ2art2/xC/vMu5blVT2bvfo4bKLGE0Lvf4Bc4Ue5RUCx9EK5JC3G2bPT3+l0v2/sQARJT4LiOAg//tAxP4ACbCBe+ewY8FSDC789I1YqCWQACDyMCgRLkQzEo7fI6txjQO1wfAbH9XLQw7Duad79D0nmKj9itp70qzmWyHs6q/XWJ61NvJOcxjxlyEKubdN/q/uuQrPTNEMiANNKUGIExOH9AQR1AwIGDktJktNL1a1uWqFq8tPUPX8mZar8xTbY9dabezppbC7qbmKIlCYa3NSyZIUu6cov/4TthD5aqpdhcimNDR1eIeJUhILTdr/+0DE/YAKTJ9zpgxPQWqkLrz2DDgN4pB1MJOjAOqIijGLjCVLtHJA5NHuSKncLrGx87CKeWMUymQHpQkoN1M0it6HW16EaC9WU59DnXM9nkr+VnzZBb31SRjiWUmC0u8qswoiDYi5sMhiIYYZ0Jg/5jmykmZPQlyhbMGeNmjwTmzBnxCnXGMSTTpXdGXewchcHkkFCdih4gOxa0/1yR2eaho7c+yIl2WZciATkmARhCqgzy6nUv/7QMT3gAnMrXOnsGVhSZXuvPYMNBy7OuAhO3sijMsLhPD2R2i72/bKbGOZWugJk0RmfbRHz3Ei3K11K11bLoeRKtefSb/m6LKNyYou+uSKWokEkmgDkUBQEhIHFsbjsOpOyNiYmOtV2hAsJqxaeKwSjdIxf31SXEMAhrOWh5WlIqsnaxu3VV8N3N9uy9f/6Kg5b0kjrUAViXhniWMglLdwAvVAPHcGhKOBNC6ACsJu6TEM/UQW//tAxPeACkzXcaYMUOFGJG58wItkxMQCpKaRU4R9EsLIm5ulAeQmEhK4Bx40ILVCY0Xa05WJdzVkTzxdArVtKvEQxw7AABil4AtjafKpVCFWJWXCMivtWJ0gkIDHthgt3tezV4lUgaKkPkzvz6g7GZ0yL/Dcj9X9bcGNJCjBR08IlN1sDTFuE2xJZ7WD1XapQ2kxIB2bYAT5jO1JEuZyVnSdLEifjCFWjMLY1AXd6yoXiBJ0tc//+0DE9gBKTRNx55hNIRqR7jjxicx4p5/8hJumdLTUsjCchlDpUKfwLaBs6tf0dByzqaOogArLwAYbQUpeixNzITAhOi3UppYdtstEGriUYpioeztQLHOVZi55yo5jN+qGOdW1EfTHdN85Bx3dH/+Zj3bSTEFNRTMuMTAwqqqqqpxgGAgGAOMBQGAAAAAAG0E6MWwG0AmfBbSD5iJb4HqYnvx3DtJU4kqrxhRxF8vL/84YqcyNv//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",EL="/assets/metalicScraping-BqmM5ys4.mp3",TL="/assets/mojo-D9S1pz9n.mp3",ML="/assets/mojoTurnSound-D3oZPBXv.mp3",RL="/assets/robotBeepingLoop-Cz0TGwJH.mp3",IL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAFAAAHBgCHh4eHh4eHh4eHh4eHh4eHh4eHpKSkpKSkpKSkpKSkpKSkpKSkpKTBwcHBwcHBwcHBwcHBwcHBwcHBwdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ//////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAM2QQABuAAABwbVZvomAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAACbQNZ7QwACnxFem3NvABAAAb/0m/2/DnECCBGAgAAHfHfAVjn/mAGf+YeHv9AI/9/mHh4AAAAABh4eHj3Sf6MPH////7zDw8PAAAAAAMPDw8PAAAAAFY4ef4AAAAAACAJLlcmslzaAAAAA2dhA8cuNgUzOZEQCemOB48SmLBSXoBIB4bRWLmodWkIyM3KQbxTk5MgkxYg5TEmKcVImoNot5fXBIMZ6wUILqZqPRipgksX3ycRsY3WhpPFfXD9wjP2WCzWi4Z9M1lU4rrEJyfbg4tf5nlSFyl9BDltdXPvf+ALefotw91Kg4XKLrKnrM7XFKkPlm0r62lQG0SkaIee1fdc3yedKObrKqLVO1Tt+09AQj4eK79+e/bVR/unc8uLTcn34t3eGbDHckkUd3K0+q+QaU3nU3EvM2q0GCgoYcv1QP5+7LldGULYTd9qYJKpfHTDNTWlWkCVxEXsA0NJe8kpbGX1Q1lrpG7f/wAFfElzwgk5nDf0u0JoQI2sRE3BsCSljdGmx70Q5Yg/U20rsJ0NItx4T1FXM2t7V2/dZ76daq/iuwEHOUVVLy7f8AGSoqMcpzEIGFVQPIdxGC1g8eyzUJPB/m+Vs40oU0Ln1rchVwreG7jwtkrzwk2XyO1OjltCtYM8yWuSW38AFFsUh7NgmT2ISQn6LxK5lZATETo/wgKuhIPbwWTCUA+ZF4ZAKFIVcWqQvTeka0Plby4pSVnEKmgzDXm45rtwAUOrrpafToPNcaq3bO4tWy+kVpIIrlC3c+YfE4bc9y8bUa2N0mmqfTltWw+ALkINOReTXarVeRKPhu81QCgSjCUVpZ2R/d7LQIAgAAESQ6DJhyCwQEJtFbpvkLRAB6vDAgDTBYBzU1CDEMllappkMZMWwCMNhdXkshDm11YEBBJYB5BLIsRiSvE0FyqJQbB1edgF+H3iZhEhOTOBh3ebtKNyZ/40/D/Qw//+zDE/gBJ6HVjvYWAKPOObHWGCVwKxYYhmDMqGV0sjpqeHI3F5XTO1EpE6NWHdd33HPcYpoxbkErn9b1lrtX/////+vlSZWM7FcLhJQUAvy5QGCQfCwlYIiJ07/dd0KUFAKVYWZ////50YkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+zDE+wAH+IllqLyhqPyJrL0nrByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+yDE/wAH8EtjrDxjoQyNbHawYASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPQAGFTpVfncAEAAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",jL="/assets/rollingBallLoop-BUA084C_.mp3",OL="/assets/servosLoop-Bn-haKck.mp3",BL="/assets/servosStart-BgsySGJF.mp3",NL="/assets/servosStop-BR1i0gi5.mp3",zL="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",DL="/assets/spring-CP3uOhml.mp3",FL="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",LL="/assets/teleportIn-DZAhHW9-.mp3",UL="/assets/teleportOut-Bra-ABlh.mp3",$L="/assets/teleportWarningSiren-Boo1HoAB.mp3",HL="/assets/toasterPopUp-CNfTxQPs.mp3",Xu=new window.AudioContext;let Tl;const re=async t=>{try{return await Xu.decodeAudioData(await(await fetch(t)).arrayBuffer())}catch(e){if(navigator.webdriver===!0)return console.warn(`Audio decode failed for ${t} - running in automated browser`,e),Xu.createBuffer(2,1,Xu.sampleRate);throw e}},WL=Un(async()=>({bonus:await re(lL),bubbleRobotLoop:await re(cL),carry:await re(uL),conveyorEnd:await re(fL),conveyorLoop:await re(hL),conveyorStart:await re(dL),destroy:await re(pL),detect:await re(mL),drum:await re(aL),glassClink:await re(gL),headFall:await re(AL),headJump:await re(yL),headWalk:await re(xL),heelsFall:await re(bL),heelsJump:await re(wL),heelsWalk:await re(VL),helicopter:await re(qL),hooter:await re(vL),hushPuppyVanish:await re(_L),jetpackLoop:await re(kL),jetpackTurnaround:await re(SL),landing:await re(CL),metalHit:await re(PL),mojoLoop:await re(TL),mojoTurn:await re(ML),robotBeepingLoop:await re(RL),robotWhirLoop:await re(IL),rollingBallLoop:await re(jL),servoLoop:await re(OL),servoStart:await re(BL),servoStop:await re(NL),softBump:await re(zL),springBoing:await re(DL),stepStoolScraping:await re(EL),switchClick:await re(FL),toasterPopUpSoundUrl:await re(HL),teleportIn:await re(LL),teleportOut:await re(UL),teleportWarningSiren:await re($L)})),GL=async()=>{Tl===void 0&&(Tl=await WL())},hH=()=>{if(Tl===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Tl},YL=(t,e)=>{const s=Fd();v.useLayoutEffect(()=>{wl(ue.dispatch,ue.getState,t,e)},[t,e]),v.useLayoutEffect(()=>{const r=()=>wl(ue.dispatch,ue.getState,t,e);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[s,e,t])},KL=["characterRooms","currentCharacterName","entryState","gameTime","pickupsCollected","previousPlayable"],QL=(t,e,s)=>{const r=od({saveTime:Date.now(),gameState:no(t,...KL),store:{gameMenus:{gameInPlay:e.gameMenus.gameInPlay}}});if(s){const{characterPickingUp:n,pickupId:i}=s,o=r.gameState,a=o.characterRooms[n];if(a===void 0)throw new Error("how are we saving from a pickup if the character picking up is not in any room?");const l=a.id;for(const c of Ls(o.characterRooms))c.id===l&&_q({room:c,item:c.items[i]})}return r},XL=()=>{const t=Fd(),e=Ex();v.useEffect(()=>{if(e===void 0)return;const s=()=>{Dd()||(t(fP(QL(e.gameState,ue.getState()))),sj.flush())},r=()=>{document.visibilityState==="hidden"&&(t($b("hold")),s())};return document.addEventListener("visibilitychange",r),window.addEventListener("beforeunload",s),()=>{document.removeEventListener("visibilitychange",r),window.removeEventListener("beforeunload",s)}},[t,e])},JL=()=>{const t=K(s=>s.gameMenus.assigningInput!==void 0),e=K(s=>s.gameMenus.openMenus.length>0);Ve({action:"menu_openOrExit",handler:v.useCallback(()=>{Dd()&&window.close(),ue.dispatch(ig())},[]),disabled:t}),Ve({action:"menu_exit",handler:N(ig),disabled:!e}),Ve({action:"toggleShowFps",handler:N(es,{path:"showFps"}),disabled:e}),Ve({action:"hold",handler:N($b,"toggle"),disabled:t}),Ve({action:"map",handler:N(cP),disabled:t}),v.useEffect(()=>{const s=()=>{};return window.addEventListener("blur",s,!1),()=>{window.removeEventListener("blur",s,!1)}}),Ve({action:"toggleColourisation",handler:N(es,{path:"displaySettings.uncolourised"}),disabled:t}),Ve({action:"toggleCrtFilter",handler:N(es,{path:"displaySettings.crtFilter"}),disabled:t}),Ve({action:"cycleResolution",handler:N(lf,void 0),disabled:t})},ZL=()=>(YL(),JL(),XL(),null),eU=t=>e=>(t(e),null),tU=()=>{const t=K(Zd);v.useEffect(()=>{ft.shared.speed=t},[t])},sU=eU(tU);class rU extends v.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,s){console.error("Error caught in DispatchingErrorBoundary:",e),ue.dispatch(nf(Ui(e)))}render(){return this.props.children}}const nU=()=>{const{cssUpscale:t,canvasSize:e,rotate90:s}=K(OI);return{transform:s?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},Wy=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,iU=()=>{const t=DC(),e=K(jI);v.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",mt())},[]),v.useEffect(()=>{document.body.classList.remove(...Object.keys(Qn).map(Wy)),document.body.classList.add(Wy(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},oU=v.lazy(qP),Gy=Un(()=>Promise.all([oL(),_I(),GL()])),aU=()=>{const[t,e]=v.useState(),s=Tn(),r=K(i=>i.gameMenus.gameInPlay.campaignLocator),n=qf();return v.useEffect(()=>{if(!s){e(void 0),window._e2e_gamePageGameAi=void 0,Gy();return}let i=!1,o;return(async()=>{let l=!1;try{if(r===void 0)throw new Error("game is marked as running, but we have no campaign locator, no way to know which campaign to load");l=!0,ue.dispatch(XI());const[{default:c}]=await Gy();ue.dispatch(_A()),i||(o=await c(r,n),e(o),window._e2e_gamePageGameAi=o)}catch(c){l&&ue.dispatch(_A()),console.error(c),ue.dispatch(nf(Ui(new Error("error in loading game assets or state",{cause:c}))))}})(),()=>{o?.stop(),i=!0}},[s,n,r]),t},lU=()=>{const[t,e]=v.useState(null),s=BC(),r=aU(),n=K(II),i=nU();return iU(),v.useEffect(()=>{t===null||r===void 0||(r.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[r,t]),v.useEffect(()=>{r?.resizeTo(n)},[n,r]),p.jsxs(p.Fragment,{children:[p.jsx("div",{tabIndex:0,className:"fixed top-0",style:i,ref:e}),p.jsxs(X0,{gameApi:r,children:[p.jsxs(rU,{children:[p.jsx(VP,{}),p.jsx(ZL,{}),p.jsx(sU,{}),p.jsx(iL,{})]}),r&&s&&p.jsx(v.Suspense,{fallback:null,children:p.jsx(oU,{})})]})]})},cU=Un(()=>is(()=>import("./LutPage-DTGVa7UD.js"),__vite__mapDeps([13,1,2,12]))),uU=2,Na=20,hU=({textureId:t,spritesheetSize:e})=>{const{frame:s}=Rt.frames[t];return p.jsx("div",{className:"absolute border hover:bg-white",style:{left:`${s.x/e.x*100}%`,top:`${s.y/e.y*100}%`,width:`${s.w/e.x*100}%`,height:`${s.h/e.y*100}%`}})},dU=()=>{const[t,e]=v.useState(null),[s,r]=v.useState(null),n=v.useRef(null),i=v.useRef(null);v.useEffect(()=>{const c=()=>{n.current&&r({x:n.current.naturalWidth,y:n.current.naturalHeight})},u=n.current;if(u)if(u.complete)c();else return u.addEventListener("load",c),()=>u.removeEventListener("load",c)},[]);const o=c=>{if(!n.current||!s)return;const u=n.current.getBoundingClientRect(),h=s.x/u.width,d=s.y/u.height,f=Math.floor((c.clientX-u.left)*h),m=Math.floor((c.clientY-u.top)*d);f>=0&&f<s.x&&m>=0&&m<s.y&&e({x:f,y:m})},a=()=>{e(null)},l=Object.keys(Rt.frames).sort();return p.jsxs("div",{ref:i,className:"relative w-full",onMouseMove:o,onMouseLeave:a,children:[p.jsx("img",{ref:n,src:mV,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),s&&l.map(c=>p.jsx(hU,{textureId:c,spritesheetSize:s},c)),t&&s&&n.current&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"absolute pointer-events-none border bg-pink outline-2",style:{left:`${t.x/s.x*100}%`,top:`${t.y/s.y*100}%`,width:`${1/s.x*100}%`,height:`${1/s.y*100}%`}}),p.jsxs("div",{className:"absolute pointer-events-none bg-black text-white px-1 text-xs font-mono",style:{left:`${t.x/s.x*100}%`,top:`calc(${t.y/s.y*100}% + 40px)`,transform:"translate(8px, -100%)"},children:[t.x,",",t.y]})]})]})},fU=({scale:t})=>{const e=Object.keys(Rt.frames).sort();return p.jsxs("div",{className:"e2e-snapshot-target",children:[p.jsx(dU,{}),p.jsx("title",{children:"Sprites"}),p.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:e.map(s=>{const{frame:r}=Rt.frames[s],n=r;return p.jsxs("div",{className:"bg-shadow m-[4px] p-[8px] text-left flex flex-col w-8","data-texture-id":s,children:[p.jsx("div",{className:`
                  sprite bg-pureBlack hover:bg-moss border-shadow 
                  box-content w-min`,style:{"--x":`${Rt.frames[s].frame.x}px`,"--y":`${Rt.frames[s].frame.y}px`,"--h":`${Rt.frames[s].frame.h}px`,"--w":`${Rt.frames[s].frame.w}px`},children:n.pivot?p.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${Na}px`,height:`${Na}px`,left:`${n.pivot.x*t-Na/2}px`,top:`${n.pivot.y*t-Na/2}px`}}):null}),p.jsx("div",{className:"flex-grow"}),p.jsx("div",{className:"text-moss mt-1 flex-wrap flex-row flex",children:s.split(/(\.)/).map(i=>p.jsx("span",{children:i}))}),p.jsxs("div",{className:"text-lightGrey",children:[r.w,"x",r.h]}),p.jsx("div",{className:"text-midRed",children:n.pivot?p.jsxs(p.Fragment,{children:["pivot: (",n.pivot.x,",",n.pivot.y,")"]}):"no pivot"}),p.jsxs("div",{className:"text-midGrey",children:["@(",r.x,",",r.y,")"]})]},s)})})]})},pU=()=>{const t=ms().get("scale"),e=t?Number(t):uU;return p.jsx(qn,{scaleFactor:e,children:p.jsx(fU,{scale:e})})},mU=()=>p.jsxs(De,{children:[p.jsx(At,{className:"loading-border"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:Cn.map(t=>p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${Bn({action:"walking",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(j,{className:"sprites-double-height",children:"404 Not found"}),p.jsx(j,{className:`${de} p-1 pt-2 text-metallicBlue zx:text-zxYellow`,children:"whatever youre looking for, it aint here"})]}),p.jsx("div",{className:"flex flex-col",children:Cn.toReversed().map(t=>p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${Bn({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),gU=()=>p.jsxs(De,{children:[p.jsx(At,{className:"loading-border"}),p.jsxs(Se,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:Cn.map(t=>p.jsx("span",{className:`sprite ${Bn({action:"idle",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(j,{className:"sprites-double-height mb-1",children:"This is not the editor"}),p.jsxs(ht,{className:`${de} p-1 pt-2 text-metallicBlue`,children:[p.jsx("p",{children:"If youre seeing this, youre trying to access the level editor, but the web manifest is getting in the way and redirected you to the games client-side routing."}),p.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",p.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),p.jsx("div",{className:"flex flex-col",children:Cn.toReversed().map(t=>p.jsx("span",{className:`sprite ${Bn({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),AU=v.lazy(cU),Fq=ms(),Yy=Fq.get("campaignName");Yy!==null&&ue.dispatch(co({campaignLocator:{userId:Fq.get("campaignAuthorUserId")||"editorUser",campaignName:Yy,version:-1},noShowCrowns:!0}));const yU=()=>{const t=ef();return v.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),p.jsxs(Iv,{children:[p.jsx(oi,{path:"/",children:p.jsx(qn,{children:p.jsx(kj,{children:p.jsx(lU,{})})})}),p.jsx(oi,{path:"/sprites",children:p.jsx(pU,{})}),p.jsx(oi,{path:"/lut",children:p.jsx(AU,{})}),p.jsx(oi,{path:"/editor",children:p.jsx(qn,{children:p.jsx(gU,{})})}),p.jsx(oi,{children:p.jsx(qn,{children:p.jsx(mU,{})})})]})},xU=()=>p.jsx(av,{store:ue,children:p.jsx(yU,{})}),dH=Object.freeze(Object.defineProperty({__proto__:null,App:xU},Symbol.toStringTag,{value:"Module"}));export{rT as $,df as A,vt as B,$a as C,Ie as D,G as E,qw as F,Gl as G,Bw as H,mM as I,AM as J,wM as K,vM as L,le as M,Bh as N,tE as O,lt as P,kM as Q,Ne as R,uo as S,ce as T,pl as U,OE as V,Ht as W,cw as X,ss as Y,gw as Z,Sg as _,os as a,ue as a$,Cg as a0,ru as a1,Pg as a2,jE as a3,fl as a4,RE as a5,dw as a6,XT as a7,$T as a8,gM as a9,Pd as aA,Ub as aB,nP as aC,Te as aD,eF as aE,Rr as aF,uD as aG,KU as aH,Js as aI,r$ as aJ,P$ as aK,lD as aL,$t as aM,_n as aN,sd as aO,YD as aP,S2 as aQ,Fs as aR,V2 as aS,X as aT,K as aU,pP as aV,kt as aW,D_ as aX,nt as aY,qe as aZ,yl as a_,yM as aa,qM as ab,_M as ac,SM as ad,Xl as ae,EI as af,mv as ag,_f as ah,mB as ai,AB as aj,yB as ak,bB as al,wB as am,qB as an,VB as ao,xB as ap,aB as aq,pe as ar,dN as as,j as at,qn as au,Fd as av,YU as aw,XU as ax,s$ as ay,Hn as az,ff as b,U$ as b$,Nr as b0,Q$ as b1,NU as b2,xn as b3,DU as b4,zd as b5,Nd as b6,zC as b7,h$ as b8,bo as b9,IU as bA,Dl as bB,S_ as bC,Ls as bD,Od as bE,ld as bF,yn as bG,Cn as bH,b_ as bI,jU as bJ,k_ as bK,al as bL,g$ as bM,UD as bN,oH as bO,q$ as bP,sH as bQ,Uz as bR,Cl as bS,Jz as bT,xy as bU,Y$ as bV,K$ as bW,H$ as bX,Bs as bY,$$ as bZ,vq as b_,Wn as ba,iH as bb,SI as bc,BU as bd,Rt as be,FD as bf,ch as bg,a$ as bh,Wb as bi,Ei as bj,J$ as bk,R$ as bl,RU as bm,Hf as bn,e2 as bo,GU as bp,Zs as bq,Q as br,w_ as bs,Gt as bt,VU as bu,Bx as bv,fe as bw,T_ as bx,P_ as by,zx as bz,Rw as c,C$ as c$,N$ as c0,Ay as c1,AD as c2,nd as c3,Qf as c4,$D as c5,q2 as c6,LD as c7,Ox as c8,Fy as c9,cd as cA,Er as cB,m$ as cC,yD as cD,Ye as cE,Jx as cF,$z as cG,Ix as cH,Lz as cI,I$ as cJ,JC as cK,Re as cL,jx as cM,Xs as cN,ac as cO,nH as cP,S$ as cQ,Ir as cR,Bd as cS,BP as cT,X$ as cU,Z$ as cV,eH as cW,kh as cX,l$ as cY,Mt as cZ,QC as c_,_D as ca,__ as cb,Qs as cc,ol as cd,mn as ce,V_ as cf,Be as cg,rH as ch,jt as ci,es as cj,rP as ck,zn as cl,QL as cm,e$ as cn,t$ as co,Wz as cp,E$ as cq,vy as cr,W as cs,Je as ct,B$ as cu,it as cv,Dn as cw,JU as cx,of as cy,pq as cz,Vr as d,Kz as d$,B as d0,eb as d1,zU as d2,BI as d3,oj as d4,uj as d5,gj as d6,no as d7,Ez as d8,T$ as d9,lH as dA,Yx as dB,j$ as dC,Xf as dD,qU as dE,pn as dF,Kv as dG,D2 as dH,m2 as dI,Nx as dJ,Es as dK,ex as dL,w$ as dM,Gf as dN,$C as dO,FC as dP,Zt as dQ,E_ as dR,Iq as dS,mt as dT,lP as dU,v2 as dV,ud as dW,Zf as dX,_2 as dY,Db as dZ,HD as d_,Xu as da,hH as db,lm as dc,lo as dd,cH as de,Mp as df,s2 as dg,xS as dh,Il as di,$n as dj,ad as dk,PU as dl,EU as dm,Eo as dn,CU as dp,MU as dq,TU as dr,yy as ds,Qi as dt,J0 as du,O$ as dv,o$ as dw,Kx as dx,OU as dy,Gx as dz,To as e,_U as e0,Is as e1,SU as e2,kU as e3,tH as e4,Kf as e5,yq as e6,Zz as e7,F$ as e8,L$ as e9,aH as eA,Zw as eB,Lg as eC,Dg as eD,mA as eE,kR as eF,sE as eG,sV as eH,dH as eI,v$ as ea,gq as eb,G$ as ec,vU as ed,W$ as ee,_$ as ef,V$ as eg,A$ as eh,y$ as ei,k$ as ej,b$ as ek,x$ as el,M$ as em,iD as en,nf as eo,Ui as ep,n$ as eq,WU as er,QU as es,rf as et,z$ as eu,D$ as ev,i$ as ew,uH as ex,ZU as ey,dP as ez,ve as f,Hh as g,Dh as h,ct as i,fA as j,ft as k,bs as l,_t as m,dl as n,jo as o,Hl as p,Qx as q,gE as r,NT as s,Fg as t,ze as u,at as v,_e as w,FT as x,mo as y,Ua as z};
