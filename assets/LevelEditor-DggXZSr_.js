import{j as o,r as n}from"./index-CvQMMo6S.js";import{U as i,a2 as d,a3 as m,T as p,_ as h,a4 as g,a5 as f}from"./App-CB8J7ILr.js";import{B as x}from"./button-j7IYxE-1.js";import{R as y,A as k,s as v}from"./roomRenderer-BAc6_N_o.js";import"./Graphics-eqf3DrwF.js";import"./changeCharacterRoom-D_cioizY.js";const w=e=>e,b=w({ball:"sprite texture-ball",charles:"sprite texture-charles.towards [button:hover_&]:texture-charles.right",switch:"sprite texture-switch.left [button:hover_&]:texture-switch.right","monster[which=turtle]":"sprite texture-turtle.towards.1 [button:hover_&]:texture-animated-turtle.right","monster[which=dalek]":"sprite texture-dalek.1 [button:hover_&]:texture-animated-dalek","monster[which=elephantHead]":"sprite texture-elephant.towards [button:hover_&]:texture-elephant.right","monster[which=skiHead]":"sprite texture-skiHead.greenAndPink.towards [button:hover_&]:texture-skiHead.greenAndPink.right","block[style=organic]":"sprite texture-block.organic","block[style=artificial]":"sprite texture-block.artificial","block[style=book]":"sprite texture-book.x"}),s=e=>{const t=b[e.type==="monster"?`monster[which=${e.config.which}]`:e.type==="block"?`block[style=${e.config.style}]`:e.type];return o.jsx(x,{className:"flex-1 h-min p-quarter grow-0",children:o.jsx("span",{className:`${t} relative [button:active_&]:top-quarter`})})},j=()=>o.jsxs("div",{className:"fixed flex top-1 right-1 bg-metallicBlueHalfbrite p-half gap-half w-24 flex-wrap justify-start",children:[o.jsx(s,{type:"monster",config:{which:"dalek",movement:"patrol-randomly-diagonal",activated:"on"}}),o.jsx(s,{type:"monster",config:{which:"turtle",activated:"on",movement:"clockwise",startDirection:"towards"}}),o.jsx(s,{type:"monster",config:{which:"elephantHead",activated:"on",movement:"unmoving",startDirection:"towards"}}),o.jsx(s,{type:"monster",config:{which:"skiHead",style:"greenAndPink",activated:"on",movement:"back-forth",startDirection:"towards"}}),o.jsx(s,{type:"block",config:{style:"artificial"}}),o.jsx(s,{type:"block",config:{style:"organic"}}),o.jsx(s,{type:"block",config:{style:"book"}}),o.jsx(s,{type:"charles",config:i}),o.jsx(s,{type:"switch",config:{initialSetting:"left",type:"in-room",modifies:d}}),o.jsx(s,{type:"ball",config:i})]}),R=e=>()=>m(e),S=e=>e.levelEditor.campaignInProgress.rooms[e.levelEditor.currentlyEditingRoom],E=R(S),A=e=>({displaySettings:{emulatedResolution:"amigaLowResPal"},soundSettings:{},pixiRenderer:e,gameState:void 0,paused:!1,colourised:!0,upscale:h.getState().gameMenus.upscale}),c=(e,t)=>{const r=p({roomJson:e,roomPickupsCollected:i,isNewGame:!0});return new y({room:r,general:A(t)})},C=(e,t)=>{const[r,a]=n.useState(()=>c(e,t));return n.useEffect(()=>{r.renderContext.room.roomJson!==e&&(r.destroy(),a(c(e,t)))},[e,r,t]),n.useEffect(()=>{}),r},H=()=>{const[e]=n.useState(()=>{const t=new k;return t.init({background:v.redShadow,sharedTicker:!1}),t});return e},P=()=>{const e=E(),t=H(),r=C(e,t.renderer),[a,l]=n.useState(null);return n.useEffect(()=>(t.stage.addChild(r.output.graphics),console.log("room renderer added to stage"),r.tick({deltaMS:f,movedItems:g,progression:0}),()=>{t.stage.removeChild(r.output.graphics),r.output.graphics.x=400,r.output.graphics.y=500,console.log("room renderer removed from stage")}),[r,t]),n.useEffect(()=>{a&&a.appendChild(t.canvas)},[a,t]),o.jsx("div",{ref:u=>l(u)})},D=()=>o.jsxs("div",{children:[o.jsx(P,{}),o.jsx(j,{})]});export{D as default};
