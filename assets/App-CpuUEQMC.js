const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/campaign-CI4F7JcI.js","assets/index-IVmx2Cb5.js","assets/index-D1Z-XQQA.css","assets/Cheats-hMgSfktQ.js","assets/pixiContainerToString-By1SKh3T.js","assets/browserAll-4WYFAcFT.js","assets/webworkerAll-CJOkTTaQ.js","assets/Graphics-CZfaAhrk.js","assets/colorToUniform-KTpA7KSL.js","assets/gameMain-BhKMnCrr.js"])))=>i.map(i=>d[i]);
import{b as jn,r as S,R as qh,j as p,g as rt,i as so,_ as gr,a as Yq,t as gt,L as Qq,d as uy,D as ke,c as bo}from"./index-IVmx2Cb5.js";var ql={exports:{}},vl={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xf;function Kq(){if(xf)return vl;xf=1;var t=jn();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,o=t.useMemo,a=t.useDebugValue;return vl.useSyncExternalStoreWithSelector=function(l,c,u,h,d){var f=n(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=o(function(){function g(V){if(!y){if(y=!0,w=V,V=h(V),d!==void 0&&m.hasValue){var _=m.value;if(d(_,V))return x=_}return x=V}if(_=x,r(w,V))return _;var v=h(V);return d!==void 0&&d(_,v)?(w=V,_):(w=V,x=v)}var y=!1,w,x,b=u===void 0?null:u;return[function(){return g(c())},b===null?void 0:function(){return g(b())}]},[c,u,h,d]);var A=s(l,f[0],f[1]);return i(function(){m.hasValue=!0,m.value=A},[A]),a(A),A},vl}var bf;function Xq(){return bf||(bf=1,ql.exports=Kq()),ql.exports}var Jq=Xq();function hy(t){t()}function Zq(){let t=null,e=null;return{clear(){t=null,e=null},notify(){hy(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var wf={notify(){},get:()=>[]};function ev(t,e){let r,s=wf,n=0,i=!1;function o(A){u();const g=s.subscribe(A);let y=!1;return()=>{y||(y=!0,g(),h())}}function a(){s.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){n++,r||(r=t.subscribe(l),s=Zq())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=wf)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>s};return m}var tv=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rv=tv(),sv=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nv=sv(),iv=()=>rv||nv?S.useLayoutEffect:S.useEffect,ov=iv();function qf(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function wi(t,e){if(qf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(e,r[n])||!qf(t[r[n]],e[r[n]]))return!1;return!0}var av=Symbol.for("react-redux-context"),lv=typeof globalThis<"u"?globalThis:{};function cv(){if(!S.createContext)return{};const t=lv[av]??=new Map;let e=t.get(S.createContext);return e||(e=S.createContext(null),t.set(S.createContext,e)),e}var Yr=cv();function uv(t){const{children:e,context:r,serverState:s,store:n}=t,i=S.useMemo(()=>{const l=ev(n);return{store:n,subscription:l,getServerState:s?()=>s:void 0}},[n,s]),o=S.useMemo(()=>n.getState(),[n]);ov(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=r||Yr;return S.createElement(a.Provider,{value:i},e)}var hv=uv;function vh(t=Yr){return function(){return S.useContext(t)}}var dy=vh();function fy(t=Yr){const e=t===Yr?dy:vh(t),r=()=>{const{store:s}=e();return s};return Object.assign(r,{withTypes:()=>r}),r}var Vh=fy();function dv(t=Yr){const e=t===Yr?Vh:fy(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var py=dv(),fv=(t,e)=>t===e;function pv(t=Yr){const e=t===Yr?dy:vh(t),r=(s,n={})=>{const{equalityFn:i=fv}=typeof n=="function"?{equalityFn:n}:n,o=e(),{store:a,subscription:l,getServerState:c}=o;S.useRef(!0);const u=S.useCallback({[s.name](d){return s(d)}}[s.name],[s]),h=Jq.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return S.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var my=pv(),mv=hy;function gv(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(o.push(r),a+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~s?s:~i?i:n.length)),a+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~s?"?":"")+"\\"+n.substring(i))):a+="/"+n;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var Vl={exports:{}},_l={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vf;function Av(){if(vf)return _l;vf=1;var t=jn();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,s=t.useState,n=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,d){var f=d(),m=s({inst:{value:f,getSnapshot:d}}),A=m[0].inst,g=m[1];return i(function(){A.value=f,A.getSnapshot=d,l(A)&&g({inst:A})},[h,f,d]),n(function(){return l(A)&&g({inst:A}),h(function(){l(A)&&g({inst:A})})},[h]),o(f),f}function l(h){var d=h.getSnapshot;h=h.value;try{var f=d();return!r(h,f)}catch{return!0}}function c(h,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return _l.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,_l}var Vf;function yv(){return Vf||(Vf=1,Vl.exports=Av()),Vl.exports}var xv=yv();const bv=qh.useInsertionEffect,wv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qv=wv?S.useLayoutEffect:S.useEffect,vv=bv||qv,gy=t=>{const e=S.useRef([t,(...r)=>e[0](...r)]).current;return vv(()=>{e[0]=t}),e[1]},Vv="popstate",_h="pushState",Sh="replaceState",_v="hashchange",_f=[Vv,_h,Sh,_v],Sv=t=>{for(const e of _f)addEventListener(e,t);return()=>{for(const e of _f)removeEventListener(e,t)}},Ay=(t,e)=>xv.useSyncExternalStore(Sv,t,e),kv=()=>location.search,Cv=({ssrSearch:t=""}={})=>Ay(kv,()=>t),Sf=()=>location.pathname,Pv=({ssrPath:t}={})=>Ay(Sf,t?()=>t:Sf),Ev=(t,{replace:e=!1,state:r=null}={})=>history[e?Sh:_h](r,"",t),Tv=(t={})=>[Pv(t),Ev],kf=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[kf]>"u"){for(const t of[_h,Sh]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,kf,{value:!0})}const Rv=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",yy=(t="")=>t==="/"?"":t,Mv=(t,e)=>t[0]==="~"?t.slice(1):yy(e)+t,Iv=(t="",e)=>Rv(Cf(yy(t)),Cf(e)),Cf=t=>{try{return decodeURI(t)}catch{return t}},xy={hook:Tv,searchHook:Cv,parser:gv,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},by=S.createContext(xy),Ja=()=>S.useContext(by),wy={},qy=S.createContext(wy),jv=()=>S.useContext(qy),kh=t=>{const[e,r]=t.hook(t);return[Iv(t.base,e),gy((s,n)=>r(Mv(s,t.base),n))]},vy=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),o=n.exec(r)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((h,d)=>[h,l[d]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[a]:[]]:[!1,null]},Bv=({children:t,...e})=>{const r=Ja(),s=e.hook?xy:r;let n=s;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=S.useRef({}),l=a.current,c=l;for(let u in s){const h=u==="base"?s[u]+(e[u]||""):e[u]||s[u];l===c&&h!==c[u]&&(a.current=c={...c}),c[u]=h,h!==s[u]&&(n=c)}return S.createElement(by.Provider,{value:n,children:t})},Pf=({children:t,component:e},r)=>e?S.createElement(e,{params:r}):typeof t=="function"?t(r):t,Ov=t=>{let e=S.useRef(wy);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},wo=({path:t,nest:e,match:r,...s})=>{const n=Ja(),[i]=kh(n),[o,a,l]=r??vy(n.parser,t,i,e),c=Ov({...jv(),...a});if(!o)return null;const u=l?S.createElement(Bv,{base:l},Pf(s,c)):Pf(s,c);return S.createElement(qy.Provider,{value:c,children:u})};S.forwardRef((t,e)=>{const r=Ja(),[s,n]=kh(r),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:h,state:d,...f}=t,m=gy(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a?.(g),g.defaultPrevented||(g.preventDefault(),n(o,t)))}),A=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return l&&S.isValidElement(c)?S.cloneElement(c,{onClick:m,href:A}):S.createElement("a",{...f,onClick:m,href:A,className:u?.call?u(s===o):u,children:c,ref:e})});const Vy=t=>Array.isArray(t)?t.flatMap(e=>Vy(e&&e.type===S.Fragment?e.props.children:e)):[t],zv=({children:t,location:e})=>{const r=Ja(),[s]=kh(r);for(const n of Vy(t)){let i=0;if(S.isValidElement(n)&&(i=vy(r.parser,n.props.path,e||s,n.props.nest))[0])return S.cloneElement(n,{match:i})}return null},$r=(t=typeof globalThis.window>"u"?"":window.location.search)=>new URLSearchParams(t);function it(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Nv=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ef=Nv,Sl=()=>Math.random().toString(36).substring(7).split("").join("."),Dv={INIT:`@@redux/INIT${Sl()}`,REPLACE:`@@redux/REPLACE${Sl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Sl()}`},Sa=Dv;function bn(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Ch(t,e,r){if(typeof t!="function")throw new Error(it(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(it(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(it(1));return r(Ch)(t,e)}let s=t,n=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((g,y)=>{o.set(y,g)}))}function u(){if(l)throw new Error(it(3));return n}function h(g){if(typeof g!="function")throw new Error(it(4));if(l)throw new Error(it(5));let y=!0;c();const w=a++;return o.set(w,g),function(){if(y){if(l)throw new Error(it(6));y=!1,c(),o.delete(w),i=null}}}function d(g){if(!bn(g))throw new Error(it(7));if(typeof g.type>"u")throw new Error(it(8));if(typeof g.type!="string")throw new Error(it(17));if(l)throw new Error(it(9));try{l=!0,n=s(n,g)}finally{l=!1}return(i=o).forEach(w=>{w()}),g}function f(g){if(typeof g!="function")throw new Error(it(10));s=g,d({type:Sa.REPLACE})}function m(){const g=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(it(11));function w(){const b=y;b.next&&b.next(u())}return w(),{unsubscribe:g(w)}},[Ef](){return this}}}return d({type:Sa.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[Ef]:m}}function Fv(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Sa.INIT})>"u")throw new Error(it(12));if(typeof r(void 0,{type:Sa.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(it(13))})}function Ph(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const s=Object.keys(r);let n;try{Fv(r)}catch(i){n=i}return function(o={},a){if(n)throw n;let l=!1;const c={};for(let u=0;u<s.length;u++){const h=s[u],d=r[h],f=o[h],m=d(f,a);if(typeof m>"u")throw a&&a.type,new Error(it(14));c[h]=m,l=l||m!==f}return l=l||s.length!==Object.keys(o).length,l?c:o}}function ka(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function Lv(...t){return e=>(r,s)=>{const n=e(r,s);let i=()=>{throw new Error(it(15))};const o={getState:n.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=ka(...a)(n.dispatch),{...n,dispatch:i}}}function Eh(t){return bn(t)&&"type"in t&&typeof t.type=="string"}var Th=Symbol.for("immer-nothing"),qi=Symbol.for("immer-draftable"),Tt=Symbol.for("immer-state");function at(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ms=Object.getPrototypeOf;function fr(t){return!!t&&!!t[Tt]}function tr(t){return t?_y(t)||Array.isArray(t)||!!t[qi]||!!t.constructor?.[qi]||no(t)||io(t):!1}var Uv=Object.prototype.constructor.toString();function _y(t){if(!t||typeof t!="object")return!1;const e=Ms(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Uv}function Hv(t){return fr(t)||at(15,t),t[Tt].base_}function Mi(t,e){Is(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,s)=>e(s,r,t))}function Is(t){const e=t[Tt];return e?e.type_:Array.isArray(t)?1:no(t)?2:io(t)?3:0}function Ii(t,e){return Is(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function kl(t,e){return Is(t)===2?t.get(e):t[e]}function Sy(t,e,r){const s=Is(t);s===2?t.set(e,r):s===3?t.add(r):t[e]=r}function $v(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function no(t){return t instanceof Map}function io(t){return t instanceof Set}function ps(t){return t.copy_||t.base_}function uu(t,e){if(no(t))return new Map(t);if(io(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=_y(t);if(e===!0||e==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[Tt];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const o=n[i],a=s[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(s[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Ms(t),s)}else{const s=Ms(t);if(s!==null&&r)return{...t};const n=Object.create(s);return Object.assign(n,t)}}function Rh(t,e=!1){return Za(t)||fr(t)||!tr(t)||(Is(t)>1&&(t.set=t.add=t.clear=t.delete=Gv),Object.freeze(t),e&&Object.entries(t).forEach(([r,s])=>Rh(s,!0))),t}function Gv(){at(2)}function Za(t){return Object.isFrozen(t)}var hu={};function js(t){const e=hu[t];return e||at(0,t),e}function Wv(t,e){hu[t]||(hu[t]=e)}var ji;function ky(){return ji}function Yv(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Tf(t,e){e&&(js("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function du(t){fu(t),t.drafts_.forEach(Qv),t.drafts_=null}function fu(t){t===ji&&(ji=t.parent_)}function Rf(t){return ji=Yv(ji,t)}function Qv(t){const e=t[Tt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Mf(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Tt].modified_&&(du(e),at(4)),tr(t)&&(t=Ca(e,t),e.parent_||Pa(e,t)),e.patches_&&js("Patches").generateReplacementPatches_(r[Tt].base_,t,e.patches_,e.inversePatches_)):t=Ca(e,r,[]),du(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Th?t:void 0}function Ca(t,e,r){if(Za(e))return e;const s=e[Tt];if(!s)return Mi(e,(n,i)=>If(t,s,e,n,i,r)),e;if(s.scope_!==t)return e;if(!s.modified_)return Pa(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,o=!1;s.type_===3&&(i=new Set(n),n.clear(),o=!0),Mi(i,(a,l)=>If(t,s,n,a,l,r,o)),Pa(t,n,!1),r&&t.patches_&&js("Patches").generatePatches_(s,r,t.patches_,t.inversePatches_)}return s.copy_}function If(t,e,r,s,n,i,o){if(fr(n)){const a=i&&e&&e.type_!==3&&!Ii(e.assigned_,s)?i.concat(s):void 0,l=Ca(t,n,a);if(Sy(r,s,l),fr(l))t.canAutoFreeze_=!1;else return}else o&&r.add(n);if(tr(n)&&!Za(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Ca(t,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,s)&&Pa(t,n)}}function Pa(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Rh(e,r)}function Kv(t,e){const r=Array.isArray(t),s={type_:r?1:0,scope_:e?e.scope_:ky(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=Mh;r&&(n=[s],i=Bi);const{revoke:o,proxy:a}=Proxy.revocable(n,i);return s.draft_=a,s.revoke_=o,a}var Mh={get(t,e){if(e===Tt)return t;const r=ps(t);if(!Ii(r,e))return Xv(t,r,e);const s=r[e];return t.finalized_||!tr(s)?s:s===Cl(t.base_,e)?(Pl(t),t.copy_[e]=mu(s,t)):s},has(t,e){return e in ps(t)},ownKeys(t){return Reflect.ownKeys(ps(t))},set(t,e,r){const s=Cy(ps(t),e);if(s?.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const n=Cl(ps(t),e),i=n?.[Tt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if($v(r,n)&&(r!==void 0||Ii(t.base_,e)))return!0;Pl(t),pu(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Cl(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Pl(t),pu(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=ps(t),s=Reflect.getOwnPropertyDescriptor(r,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:r[e]}},defineProperty(){at(11)},getPrototypeOf(t){return Ms(t.base_)},setPrototypeOf(){at(12)}},Bi={};Mi(Mh,(t,e)=>{Bi[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Bi.deleteProperty=function(t,e){return Bi.set.call(this,t,e,void 0)};Bi.set=function(t,e,r){return Mh.set.call(this,t[0],e,r,t[0])};function Cl(t,e){const r=t[Tt];return(r?ps(r):t)[e]}function Xv(t,e,r){const s=Cy(e,r);return s?"value"in s?s.value:s.get?.call(t.draft_):void 0}function Cy(t,e){if(!(e in t))return;let r=Ms(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,e);if(s)return s;r=Ms(r)}}function pu(t){t.modified_||(t.modified_=!0,t.parent_&&pu(t.parent_))}function Pl(t){t.copy_||(t.copy_=uu(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Jv=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,s)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(l=i,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&at(6),s!==void 0&&typeof s!="function"&&at(7);let n;if(tr(e)){const i=Rf(this),o=mu(e,void 0);let a=!0;try{n=r(o),a=!1}finally{a?du(i):fu(i)}return Tf(i,s),Mf(n,i)}else if(!e||typeof e!="object"){if(n=r(e),n===void 0&&(n=e),n===Th&&(n=void 0),this.autoFreeze_&&Rh(n,!0),s){const i=[],o=[];js("Patches").generateReplacementPatches_(e,n,i,o),s(i,o)}return n}else at(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let s,n;return[this.produce(e,r,(o,a)=>{s=o,n=a}),s,n]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){tr(t)||at(8),fr(t)&&(t=gu(t));const e=Rf(this),r=mu(t,void 0);return r[Tt].isManual_=!0,fu(e),r}finishDraft(t,e){const r=t&&t[Tt];(!r||!r.isManual_)&&at(9);const{scope_:s}=r;return Tf(s,e),Mf(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(e=e.slice(r+1));const s=js("Patches").applyPatches_;return fr(t)?s(t,e):this.produce(t,n=>s(n,e))}};function mu(t,e){const r=no(t)?js("MapSet").proxyMap_(t,e):io(t)?js("MapSet").proxySet_(t,e):Kv(t,e);return(e?e.scope_:ky()).drafts_.push(r),r}function gu(t){return fr(t)||at(10,t),Py(t)}function Py(t){if(!tr(t)||Za(t))return t;const e=t[Tt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=uu(t,e.scope_.immer_.useStrictShallowCopy_)}else r=uu(t,!0);return Mi(r,(s,n)=>{Sy(r,s,Py(n))}),e&&(e.finalized_=!1),r}function Zv(){const e="replace",s="remove";function n(d,f,m,A){switch(d.type_){case 0:case 2:return o(d,f,m,A);case 1:return i(d,f,m,A);case 3:return a(d,f,m,A)}}function i(d,f,m,A){let{base_:g,assigned_:y}=d,w=d.copy_;w.length<g.length&&([g,w]=[w,g],[m,A]=[A,m]);for(let x=0;x<g.length;x++)if(y[x]&&w[x]!==g[x]){const b=f.concat([x]);m.push({op:e,path:b,value:h(w[x])}),A.push({op:e,path:b,value:h(g[x])})}for(let x=g.length;x<w.length;x++){const b=f.concat([x]);m.push({op:"add",path:b,value:h(w[x])})}for(let x=w.length-1;g.length<=x;--x){const b=f.concat([x]);A.push({op:s,path:b})}}function o(d,f,m,A){const{base_:g,copy_:y}=d;Mi(d.assigned_,(w,x)=>{const b=kl(g,w),V=kl(y,w),_=x?Ii(g,w)?e:"add":s;if(b===V&&_===e)return;const v=f.concat(w);m.push(_===s?{op:_,path:v}:{op:_,path:v,value:V}),A.push(_==="add"?{op:s,path:v}:_===s?{op:"add",path:v,value:h(b)}:{op:e,path:v,value:h(b)})})}function a(d,f,m,A){let{base_:g,copy_:y}=d,w=0;g.forEach(x=>{if(!y.has(x)){const b=f.concat([w]);m.push({op:s,path:b,value:x}),A.unshift({op:"add",path:b,value:x})}w++}),w=0,y.forEach(x=>{if(!g.has(x)){const b=f.concat([w]);m.push({op:"add",path:b,value:x}),A.unshift({op:s,path:b,value:x})}w++})}function l(d,f,m,A){m.push({op:e,path:[],value:f===Th?void 0:f}),A.push({op:e,path:[],value:d})}function c(d,f){return f.forEach(m=>{const{path:A,op:g}=m;let y=d;for(let V=0;V<A.length-1;V++){const _=Is(y);let v=A[V];typeof v!="string"&&typeof v!="number"&&(v=""+v),(_===0||_===1)&&(v==="__proto__"||v==="constructor")&&at(19),typeof y=="function"&&v==="prototype"&&at(19),y=kl(y,v),typeof y!="object"&&at(18,A.join("/"))}const w=Is(y),x=u(m.value),b=A[A.length-1];switch(g){case e:switch(w){case 2:return y.set(b,x);case 3:at(16);default:return y[b]=x}case"add":switch(w){case 1:return b==="-"?y.push(x):y.splice(b,0,x);case 2:return y.set(b,x);case 3:return y.add(x);default:return y[b]=x}case s:switch(w){case 1:return y.splice(b,1);case 2:return y.delete(b);case 3:return y.delete(m.value);default:return delete y[b]}default:at(17,g)}}),d}function u(d){if(!tr(d))return d;if(Array.isArray(d))return d.map(u);if(no(d))return new Map(Array.from(d.entries()).map(([m,A])=>[m,u(A)]));if(io(d))return new Set(Array.from(d).map(u));const f=Object.create(Ms(d));for(const m in d)f[m]=u(d[m]);return Ii(d,qi)&&(f[qi]=d[qi]),f}function h(d){return fr(d)?u(d):d}Wv("Patches",{applyPatches_:c,generatePatches_:n,generateReplacementPatches_:l})}var Ht=new Jv,Bn=Ht.produce,Ey=Ht.produceWithPatches.bind(Ht);Ht.setAutoFreeze.bind(Ht);Ht.setUseStrictShallowCopy.bind(Ht);var jf=Ht.applyPatches.bind(Ht);Ht.createDraft.bind(Ht);Ht.finishDraft.bind(Ht);function eV(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function tV(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function rV(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${e}[${r}]`)}}var Bf=t=>Array.isArray(t)?t:[t];function sV(t){const e=Array.isArray(t[0])?t[0]:t;return rV(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function nV(t,e){const r=[],{length:s}=t;for(let n=0;n<s;n++)r.push(t[n].apply(null,e));return r}var iV=class{constructor(t){this.value=t}deref(){return this.value}},oV=typeof WeakRef<"u"?WeakRef:iV,aV=0,Of=1;function qo(){return{s:aV,v:void 0,o:null,p:null}}function Ea(t,e={}){let r=qo();const{resultEqualityCheck:s}=e;let n,i=0;function o(){let a=r;const{length:l}=arguments;for(let h=0,d=l;h<d;h++){const f=arguments[h];if(typeof f=="function"||typeof f=="object"&&f!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const A=m.get(f);A===void 0?(a=qo(),m.set(f,a)):a=A}else{let m=a.p;m===null&&(a.p=m=new Map);const A=m.get(f);A===void 0?(a=qo(),m.set(f,a)):a=A}}const c=a;let u;if(a.s===Of)u=a.v;else if(u=t.apply(null,arguments),i++,s){const h=n?.deref?.()??n;h!=null&&s(h,u)&&(u=h,i!==0&&i--),n=typeof u=="object"&&u!==null||typeof u=="function"?new oV(u):u}return c.s=Of,c.v=u,u}return o.clearCache=()=>{r=qo(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function lV(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,s=(...n)=>{let i=0,o=0,a,l={},c=n.pop();typeof c=="object"&&(l=c,c=n.pop()),eV(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=Ea,argsMemoizeOptions:m=[]}=u,A=Bf(d),g=Bf(m),y=sV(n),w=h(function(){return i++,c.apply(null,arguments)},...A),x=f(function(){o++;const V=nV(y,arguments);return a=w.apply(null,V),a},...g);return Object.assign(x,{resultFunc:c,memoizedResultFunc:w,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:f})};return Object.assign(s,{withTypes:()=>s}),s}var Ih=lV(Ea),cV=Object.assign((t,e=Ih)=>{tV(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),s=r.map(i=>t[i]);return e(s,(...i)=>i.reduce((o,a,l)=>(o[r[l]]=a,o),{}))},{withTypes:()=>cV});function Ty(t){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,t):n(i)}var uV=Ty(),hV=Ty,dV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ka:ka.apply(null,arguments)},fV=t=>t&&typeof t.match=="function";function qt(t,e){function r(...s){if(e){let n=e(...s);if(!n)throw new Error(tt(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>Eh(s)&&s.type===t,r}var Ry=class hi extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,hi.prototype)}static get[Symbol.species](){return hi}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new hi(...e[0].concat(this)):new hi(...e.concat(this))}};function zf(t){return tr(t)?Bn(t,()=>{}):t}function Au(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function pV(t){return typeof t=="boolean"}var mV=()=>function(e){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{};let o=new Ry;return r&&(pV(r)?o.push(uV):o.push(hV(r.extraArgument))),o},el="RTK_autoBatch",Qn=()=>t=>({payload:t,meta:{[el]:!0}}),Nf=t=>e=>{setTimeout(e,t)},gV=(t={type:"raf"})=>e=>(...r)=>{const s=e(...r);let n=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Nf(10):t.type==="callback"?t.queueNotification:Nf(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const h=()=>n&&u(),d=s.subscribe(h);return a.add(u),()=>{d(),a.delete(u)}},dispatch(u){try{return n=!u?.meta?.[el],i=!n,i&&(o||(o=!0,l(c))),s.dispatch(u)}finally{n=!0}}})},AV=t=>function(r){const{autoBatch:s=!0}=r??{};let n=new Ry(t);return s&&n.push(gV(typeof s=="object"?s:void 0)),n};function yV(t){const e=mV(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(bn(r))a=Ph(r);else throw new Error(tt(1));let l;typeof s=="function"?l=s(e):l=e();let c=ka;n&&(c=dV({trace:!1,...typeof n=="object"&&n}));const u=Lv(...l),h=AV(u);let d=typeof o=="function"?o(h):h();const f=c(...d);return Ch(a,i,f)}function My(t){const e={},r=[];let s;const n={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(tt(28));if(a in e)throw new Error(tt(29));return e[a]=o,n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return s=i,n}};return t(n),[e,r,s]}function xV(t){return typeof t=="function"}function bV(t,e){let[r,s,n]=My(e),i;if(xV(t))i=()=>zf(t());else{const a=zf(t);i=()=>a}function o(a=i(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,h)=>{if(h)if(fr(u)){const f=h(u,l);return f===void 0?u:f}else{if(tr(u))return Bn(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return d}}return u},a)}return o.getInitialState=i,o}var Iy=(t,e)=>fV(t)?t.match(e):t(e);function pr(...t){return e=>t.some(r=>Iy(r,e))}function vi(...t){return e=>t.every(r=>Iy(r,e))}function tl(t,e){if(!t||!t.meta)return!1;const r=typeof t.meta.requestId=="string",s=e.indexOf(t.meta.requestStatus)>-1;return r&&s}function oo(t){return typeof t[0]=="function"&&"pending"in t[0]&&"fulfilled"in t[0]&&"rejected"in t[0]}function jh(...t){return t.length===0?e=>tl(e,["pending"]):oo(t)?pr(...t.map(e=>e.pending)):jh()(t[0])}function wn(...t){return t.length===0?e=>tl(e,["rejected"]):oo(t)?pr(...t.map(e=>e.rejected)):wn()(t[0])}function rl(...t){const e=r=>r&&r.meta&&r.meta.rejectedWithValue;return t.length===0?vi(wn(...t),e):oo(t)?vi(wn(...t),e):rl()(t[0])}function Qr(...t){return t.length===0?e=>tl(e,["fulfilled"]):oo(t)?pr(...t.map(e=>e.fulfilled)):Qr()(t[0])}function yu(...t){return t.length===0?e=>tl(e,["pending","fulfilled","rejected"]):oo(t)?pr(...t.flatMap(e=>[e.pending,e.rejected,e.fulfilled])):yu()(t[0])}var wV="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ao=(t=21)=>{let e="",r=t;for(;r--;)e+=wV[Math.random()*64|0];return e},qV=["name","message","stack","code"],El=class{constructor(t,e){this.payload=t,this.meta=e}_type},Df=class{constructor(t,e){this.payload=t,this.meta=e}_type},vV=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of qV)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},Ff="External signal was aborted",Lf=(()=>{function t(e,r,s){const n=qt(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=qt(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=qt(e+"/rejected",(l,c,u,h,d)=>({payload:h,error:(s&&s.serializeError||vV)(l||"Rejected"),meta:{...d||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,d)=>{const f=s?.idGenerator?s.idGenerator(l):ao(),m=new AbortController;let A,g;function y(x){g=x,m.abort()}c&&(c.aborted?y(Ff):c.addEventListener("abort",()=>y(Ff),{once:!0}));const w=(async function(){let x;try{let V=s?.condition?.(l,{getState:h,extra:d});if(_V(V)&&(V=await V),V===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const _=new Promise((v,k)=>{A=()=>{k({name:"AbortError",message:g||"Aborted"})},m.signal.addEventListener("abort",A)});u(i(f,l,s?.getPendingMeta?.({requestId:f,arg:l},{getState:h,extra:d}))),x=await Promise.race([_,Promise.resolve(r(l,{dispatch:u,getState:h,extra:d,requestId:f,signal:m.signal,abort:y,rejectWithValue:(v,k)=>new El(v,k),fulfillWithValue:(v,k)=>new Df(v,k)})).then(v=>{if(v instanceof El)throw v;return v instanceof Df?n(v.payload,f,l,v.meta):n(v,f,l)})])}catch(V){x=V instanceof El?o(null,f,l,V.payload,V.meta):o(V,f,l)}finally{A&&m.signal.removeEventListener("abort",A)}return s&&!s.dispatchConditionRejection&&o.match(x)&&x.meta.condition||u(x),x})();return Object.assign(w,{abort:y,requestId:f,arg:l,unwrap(){return w.then(VV)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:n,settled:pr(o,n),typePrefix:e})}return t.withTypes=()=>t,t})();function VV(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function _V(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var SV=Symbol.for("rtk-slice-createasyncthunk");function kV(t,e){return`${t}/${e}`}function CV({creators:t}={}){const e=t?.asyncThunk?.[SV];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(tt(11));const o=(typeof s.reducers=="function"?s.reducers(EV()):s.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(w,x){const b=typeof w=="string"?w:w.type;if(!b)throw new Error(tt(12));if(b in l.sliceCaseReducersByType)throw new Error(tt(13));return l.sliceCaseReducersByType[b]=x,c},addMatcher(w,x){return l.sliceMatchers.push({matcher:w,reducer:x}),c},exposeAction(w,x){return l.actionCreators[w]=x,c},exposeCaseReducer(w,x){return l.sliceCaseReducersByName[w]=x,c}};a.forEach(w=>{const x=o[w],b={reducerName:w,type:kV(n,w),createNotation:typeof s.reducers=="function"};RV(x)?IV(b,x,c,e):TV(b,x,c)});function u(){const[w={},x=[],b=void 0]=typeof s.extraReducers=="function"?My(s.extraReducers):[s.extraReducers],V={...w,...l.sliceCaseReducersByType};return bV(s.initialState,_=>{for(let v in V)_.addCase(v,V[v]);for(let v of l.sliceMatchers)_.addMatcher(v.matcher,v.reducer);for(let v of x)_.addMatcher(v.matcher,v.reducer);b&&_.addDefaultCase(b)})}const h=w=>w,d=new Map;let f;function m(w,x){return f||(f=u()),f(w,x)}function A(){return f||(f=u()),f.getInitialState()}function g(w,x=!1){function b(_){let v=_[w];return typeof v>"u"&&x&&(v=A()),v}function V(_=h){const v=Au(d,x,()=>new WeakMap);return Au(v,_,()=>{const k={};for(const[E,T]of Object.entries(s.selectors??{}))k[E]=PV(T,_,A,x);return k})}return{reducerPath:w,getSelectors:V,get selectors(){return V(b)},selectSlice:b}}const y={name:n,reducer:m,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:A,...g(i),injectInto(w,{reducerPath:x,...b}={}){const V=x??i;return w.inject({reducerPath:V,reducer:m},b),{...y,...g(V,!0)}}};return y}}function PV(t,e,r,s){function n(i,...o){let a=e(i);return typeof a>"u"&&s&&(a=r()),t(a,...o)}return n.unwrapped=t,n}var Sr=CV();function EV(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function TV({type:t,reducerName:e,createNotation:r},s,n){let i,o;if("reducer"in s){if(r&&!MV(s))throw new Error(tt(17));i=s.reducer,o=s.prepare}else i=s;n.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?qt(t,o):qt(t))}function RV(t){return t._reducerDefinitionType==="asyncThunk"}function MV(t){return t._reducerDefinitionType==="reducerWithPrepare"}function IV({type:t,reducerName:e},r,s,n){if(!n)throw new Error(tt(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=n(t,i,u);s.exposeAction(e,h),o&&s.addCase(h.fulfilled,o),a&&s.addCase(h.pending,a),l&&s.addCase(h.rejected,l),c&&s.addMatcher(h.settled,c),s.exposeCaseReducer(e,{fulfilled:o||vo,pending:a||vo,rejected:l||vo,settled:c||vo})}function vo(){}var jV="task",jy="listener",By="completed",Bh="cancelled",BV=`task-${Bh}`,OV=`task-${By}`,xu=`${jy}-${Bh}`,zV=`${jy}-${By}`,sl=class{constructor(t){this.code=t,this.message=`${jV} ${Bh} (reason: ${t})`}name="TaskAbortError";message},Oh=(t,e)=>{if(typeof t!="function")throw new TypeError(tt(32))},Ta=()=>{},Oy=(t,e=Ta)=>(t.catch(e),t),zy=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Ps=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Es=t=>{if(t.aborted){const{reason:e}=t;throw new sl(e)}};function Ny(t,e){let r=Ta;return new Promise((s,n)=>{const i=()=>n(new sl(t.reason));if(t.aborted){i();return}r=zy(t,i),e.finally(()=>r()).then(s,n)}).finally(()=>{r=Ta})}var NV=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof sl?"cancelled":"rejected",error:r}}finally{e?.()}},Ra=t=>e=>Oy(Ny(t,e).then(r=>(Es(t),r))),Dy=t=>{const e=Ra(t);return r=>e(new Promise(s=>setTimeout(s,r)))},{assign:dn}=Object,Uf={},nl="listenerMiddleware",DV=(t,e)=>{const r=s=>zy(t,()=>Ps(s,t.reason));return(s,n)=>{Oh(s);const i=new AbortController;r(i);const o=NV(async()=>{Es(t),Es(i.signal);const a=await s({pause:Ra(i.signal),delay:Dy(i.signal),signal:i.signal});return Es(i.signal),a},()=>Ps(i,OV));return n?.autoJoin&&e.push(o.catch(Ta)),{result:Ra(t)(o),cancel(){Ps(i,BV)}}}},FV=(t,e)=>{const r=async(s,n)=>{Es(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:s,effect:(h,d)=>{d.unsubscribe(),l([h,d.getState(),d.getOriginalState()])}});i=()=>{u(),c()}})];n!=null&&a.push(new Promise(l=>setTimeout(l,n,null)));try{const l=await Ny(e,Promise.race(a));return Es(e),l}finally{i()}};return(s,n)=>Oy(r(s,n))},Fy=t=>{let{type:e,actionCreator:r,matcher:s,predicate:n,effect:i}=t;if(e)n=qt(e).match;else if(r)e=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(tt(21));return Oh(i),{predicate:n,type:e,effect:i}},Ly=dn(t=>{const{type:e,predicate:r,effect:s}=Fy(t);return{id:ao(),effect:s,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(tt(22))}}},{withTypes:()=>Ly}),Hf=(t,e)=>{const{type:r,effect:s,predicate:n}=Fy(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},bu=t=>{t.pending.forEach(e=>{Ps(e,xu)})},LV=t=>()=>{t.forEach(bu),t.clear()},$f=(t,e,r)=>{try{t(e,r)}catch(s){setTimeout(()=>{throw s},0)}},Uy=dn(qt(`${nl}/add`),{withTypes:()=>Uy}),UV=qt(`${nl}/removeAll`),Hy=dn(qt(`${nl}/remove`),{withTypes:()=>Hy}),HV=(...t)=>{console.error(`${nl}/error`,...t)},$V=(t={})=>{const e=new Map,{extra:r,onError:s=HV}=t;Oh(s);const n=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&bu(u)}),i=u=>{const h=Hf(e,u)??Ly(u);return n(h)};dn(i,{withTypes:()=>i});const o=u=>{const h=Hf(e,u);return h&&(h.unsubscribe(),u.cancelActive&&bu(h)),!!h};dn(o,{withTypes:()=>o});const a=async(u,h,d,f)=>{const m=new AbortController,A=FV(i,m.signal),g=[];try{u.pending.add(m),await Promise.resolve(u.effect(h,dn({},d,{getOriginalState:f,condition:(y,w)=>A(y,w).then(Boolean),take:A,delay:Dy(m.signal),pause:Ra(m.signal),extra:r,signal:m.signal,fork:DV(m.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((y,w,x)=>{y!==m&&(Ps(y,xu),x.delete(y))})},cancel:()=>{Ps(m,xu),u.pending.delete(m)},throwIfCancelled:()=>{Es(m.signal)}})))}catch(y){y instanceof sl||$f(s,y,{raisedBy:"effect"})}finally{await Promise.all(g),Ps(m,zV),u.pending.delete(m)}},l=LV(e);return{middleware:u=>h=>d=>{if(!Eh(d))return h(d);if(Uy.match(d))return i(d.payload);if(UV.match(d)){l();return}if(Hy.match(d))return o(d.payload);let f=u.getState();const m=()=>{if(f===Uf)throw new Error(tt(23));return f};let A;try{if(A=h(d),e.size>0){const g=u.getState(),y=Array.from(e.values());for(const w of y){let x=!1;try{x=w.predicate(d,g,f)}catch(b){x=!1,$f(s,b,{raisedBy:"predicate"})}x&&a(w,d,u,m)}}}finally{f=Uf}return A},startListening:i,stopListening:o,clearListeners:l}},GV=t=>"reducerPath"in t&&typeof t.reducerPath=="string",WV=t=>t.flatMap(e=>GV(e)?[[e.reducerPath,e.reducer]]:Object.entries(e)),zh=Symbol.for("rtk-state-proxy-original"),YV=t=>!!t&&!!t[zh],QV=new WeakMap,KV=(t,e)=>Au(QV,t,()=>new Proxy(t,{get:(r,s,n)=>{if(s===zh)return r;const i=Reflect.get(r,s,n);if(typeof i>"u"){const o=e[s.toString()];if(o){const a=o(void 0,{type:ao()});if(typeof a>"u")throw new Error(tt(24));return a}}return i}})),XV=t=>{if(!YV(t))throw new Error(tt(25));return t[zh]},JV=(t={})=>t;function ZV(...t){const e=Object.fromEntries(WV(t)),r=()=>Object.keys(e).length?Ph(e):JV;let s=r();function n(a,l){return s(a,l)}n.withLazyLoadedSlices=()=>n;const i=(a,l={})=>{const{reducerPath:c,reducer:u}=a,h=e[c];return!l.overrideExisting&&h&&h!==u||(e[c]=u,s=r()),n},o=Object.assign(function(l,c){return function(h,...d){return l(KV(c?c(h,...d):h,e),...d)}},{original:XV});return Object.assign(n,{inject:i,selector:o})}function tt(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Nh=S.createContext(null),e0=({gameApi:t,children:e})=>p.jsx(Nh,{value:t,children:e}),On=()=>{const t=S.useContext(Nh);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");if(t===void 0)throw new Error("useGameApi must be called once we have a GameApi");return t},Dh=()=>{const t=S.useContext(Nh);if(t===null)throw new Error("useGameApi must be used within a GameApiProvider");return t},$y=$V(),Gy=$y.startListening.withTypes();function t0(t){var e="";return r(t),e;function r(n){if(n===null||typeof n!="object"||n.toJSON!=null)e+=JSON.stringify(n);else if(Array.isArray(n)){e+="[";var i=!1;n.forEach(function(a){i&&(e+=","),i=!0,a===void 0&&(a=null),r(a)}),e+="]"}else{e+="{";var o=Object.keys(n).filter(function(a){return n[a]!==void 0}).sort();o.forEach(function(a,l){return s(n,a,l)}),e+="}"}}function s(n,i,o){o>0&&(e+=","),e+=JSON.stringify(i),e+=":",r(n[i])}}var Fh="persist:",Lh="persist/FLUSH",lo="persist/REHYDRATE",Uh="persist/PAUSE",Hh="persist/PERSIST",$h="persist/PURGE",Gh="persist/REGISTER",Wy=-1;function pa(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pa=function(r){return typeof r}:pa=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},pa(t)}function Gf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function r0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gf(r,!0).forEach(function(s){s0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gf(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function s0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n0(t,e,r,s){s.debug;var n=r0({},r);return t&&pa(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(n[i]=t[i])}),n}function i0(t){var e=t.blacklist||null,r=t.whitelist||null,s=t.transforms||[],n=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:Fh).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(V){return V}:typeof t.serialize=="function"?a=t.serialize:a=o0;var l=t.writeFailHandler||null,c={},u={},h=[],d=null,f=null,m=function(V){Object.keys(V).forEach(function(_){y(_)&&c[_]!==V[_]&&h.indexOf(_)===-1&&h.push(_)}),Object.keys(c).forEach(function(_){V[_]===void 0&&y(_)&&h.indexOf(_)===-1&&c[_]!==void 0&&h.push(_)}),d===null&&(d=setInterval(A,n)),c=V};function A(){if(h.length===0){d&&clearInterval(d),d=null;return}var b=h.shift(),V=s.reduce(function(_,v){return v.in(_,b,c)},c[b]);if(V!==void 0)try{u[b]=a(V)}catch(_){console.error("redux-persist/createPersistoid: error serializing state",_)}else delete u[b];h.length===0&&g()}function g(){Object.keys(u).forEach(function(b){c[b]===void 0&&delete u[b]}),f=o.setItem(i,a(u)).catch(w)}function y(b){return!(r&&r.indexOf(b)===-1&&b!=="_persist"||e&&e.indexOf(b)!==-1)}function w(b){l&&l(b)}var x=function(){for(;h.length!==0;)A();return f||Promise.resolve()};return{update:m,flush:x}}function o0(t){return JSON.stringify(t)}function a0(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Fh).concat(t.key),s=t.storage;t.debug;var n;return t.deserialize===!1?n=function(o){return o}:typeof t.deserialize=="function"?n=t.deserialize:n=l0,s.getItem(r).then(function(i){if(i)try{var o={},a=n(i);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},n(a[l]))}),o}catch(l){throw l}else return})}function l0(t){return JSON.parse(t)}function c0(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:Fh).concat(t.key);return e.removeItem(r,u0)}function u0(t){}function Wf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function wr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wf(r,!0).forEach(function(s){h0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wf(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function h0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d0(t,e){if(t==null)return{};var r=f0(t,e),s,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function f0(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}var p0=5e3;function m0(t,e){var r=t.version!==void 0?t.version:Wy;t.debug;var s=t.stateReconciler===void 0?n0:t.stateReconciler,n=t.getStoredState||a0,i=t.timeout!==void 0?t.timeout:p0,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var d=u||{},f=d._persist,m=d0(d,["_persist"]),A=m;if(h.type===Hh){var g=!1,y=function(k,E){g||(h.rehydrate(t.key,k,E),g=!0)};if(i&&setTimeout(function(){!g&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),l=!1,o||(o=i0(t)),f)return wr({},e(A,h),{_persist:f});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),n(t).then(function(v){var k=t.migrate||function(E,T){return Promise.resolve(E)};k(v,r).then(function(E){y(E)},function(E){y(void 0,E)})},function(v){y(void 0,v)}),wr({},e(A,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===$h)return a=!0,h.result(c0(t)),wr({},e(A,h),{_persist:f});if(h.type===Lh)return h.result(o&&o.flush()),wr({},e(A,h),{_persist:f});if(h.type===Uh)l=!0;else if(h.type===lo){if(a)return wr({},A,{_persist:wr({},f,{rehydrated:!0})});if(h.key===t.key){var w=e(A,h),x=h.payload,b=s!==!1&&x!==void 0?s(x,u,w,t):w,V=wr({},b,{_persist:wr({},f,{rehydrated:!0})});return c(V)}}}if(!f)return e(u,h);var _=e(A,h);return _===A?u:c(wr({},_,{_persist:f}))}}function Yf(t){return y0(t)||A0(t)||g0()}function g0(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function A0(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function y0(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function Qf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function wu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qf(r,!0).forEach(function(s){x0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qf(r).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function x0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Yy={registry:[],bootstrapped:!1},b0=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yy,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Gh:return wu({},e,{registry:[].concat(Yf(e.registry),[r.key])});case lo:var s=e.registry.indexOf(r.key),n=Yf(e.registry);return n.splice(s,1),wu({},e,{registry:n,bootstrapped:n.length===0});default:return e}};function w0(t,e,r){var s=Ch(b0,Yy,void 0),n=function(l){s.dispatch({type:Gh,key:l})},i=function(l,c,u){var h={type:lo,payload:c,err:u,key:l};t.dispatch(h),s.dispatch(h)},o=wu({},s,{purge:function(){var l=[];return t.dispatch({type:$h,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:Lh,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:Uh})},persist:function(){t.dispatch({type:Hh,register:n,rehydrate:i})}});return o.persist(),o}function q0(t,e){return function(r,s){if(!r)return Promise.resolve(void 0);var n=r._persist&&r._persist.version!==void 0?r._persist.version:Wy;if(n===s||n>s)return Promise.resolve(r);var i=Object.keys(t).map(function(a){return parseInt(a)}).filter(function(a){return s>=a&&a>n}).sort(function(a,l){return a-l});try{var o=i.reduce(function(a,l){return t[l](a)},r);return Promise.resolve(o)}catch(a){return Promise.reject(a)}}}const Ts=1e-4,Gr=(t,e)=>Math.abs(t-e)<Ts,qF=t=>t===0?Ts:Math.abs(t)<Ts?Ts*Math.sign(t):t,fn=["away","towards","left","right"],v0=["awayRight","towardsRight","towardsLeft","awayLeft"],qn=[...fn,...v0],Qy=t=>t==="away"||t==="towards"?"y":"x",vF=t=>t==="away"?"towards":t==="towards"?"away":t==="left"?"right":"left",Ky=t=>Wh(Qy(t)),Wh=t=>t==="x"?"y":"x",Wr=(t,...e)=>{const r={x:t.x,y:t.y};for(const s of e)r.x+=s.x??0,r.y+=s.y??0;return r},V0=(t,...e)=>{const r={x:t.x,y:t.y};for(const s of e)r.x-=s.x??0,r.y-=s.y??0;return r},Xy=(t,e)=>({x:t.x*e,y:t.y*e}),vt=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e}),VF=(t,e,r)=>{const s=t;return s.x=e.x*r,s.y=e.y*r,s.z=e.z*r,s},_0=(t,e)=>(t.x*=e,t.y*=e,t.z*=e,t),S0=(t,e)=>({x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}),zn=({x:t,y:e,z:r})=>Math.hypot(t,e,r),Jy=({x:t,y:e})=>Math.hypot(t,e),k0=({x:t,y:e,z:r})=>t**2+e**2+r**2,_F=({x:t,y:e})=>t**2+e**2,C0=t=>{const e=zn(t);if(e===0)throw new Error("unitVector called with zero length vector");return vt(t,1/e)},hn=t=>{const e=zn(t);if(e===0)throw new Error("unitVectorInPlace called with zero length vector");return _0(t,1/e)},Z=(...t)=>{if(t.length===0)return{x:0,y:0,z:0};const[e,...r]=t,s={x:e.x??0,y:e.y??0,z:e.z??0};for(const n of r)s.x+=n.x??0,s.y+=n.y??0,s.z+=n.z??0;return s},P0=(t,...e)=>{for(const r of e)t.x+=r.x??0,t.y+=r.y??0,t.z+=r.z??0;return t},E0=(...t)=>t.reduce(({x:e,y:r,z:s},{x:n,y:i,z:o})=>({x:e*n,y:r*i,z:s*o}),co),Kr=(t,...e)=>{const r={x:t.x,y:t.y,z:t.z};for(const s of e)r.x-=s.x??0,r.y-=s.y??0,r.z-=s.z??0;return r},T0=(t,...e)=>{for(const r of e)t.x-=r.x??0,t.y-=r.y??0,t.z-=r.z??0;return t},Yh=({x:t,y:e,z:r},{x:s,y:n,z:i})=>t===s&&e===n&&r===i,R0=({x:t,y:e},{x:r,y:s})=>t===r&&e===s,SF=t=>{const{x:e}=t,r=Math.round(e),s=!Number.isInteger(e)&&Gr(e,r),{y:n}=t,i=Math.round(n),o=!Number.isInteger(n)&&Gr(n,i),{z:a}=t,l=Math.round(a),c=!Number.isInteger(a)&&Gr(t.z,l);return s||o||c?{x:s?r:e,y:o?i:n,z:c?l:a}:t},kF=({x:t=0,y:e=0,z:r=0})=>Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(r),CF=({x:t,y:e,z:r})=>({x:Math.round(t),y:Math.round(e),z:Math.round(r)}),M0=Object.freeze({x:0,y:0}),ae=Object.freeze({x:0,y:0,z:0}),co=Object.freeze({x:1,y:1,z:1}),I0=["x","y","z"],Ma=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,j0=({x:t,y:e})=>{if(!(Gr(t,0)&&Gr(e,0)))return e>t?e>-t?"away":"right":e>-t?"left":"towards"},B0=["right","towardsRight","towards","towardsLeft","left","awayLeft","away","awayRight"],Qh=({x:t,y:e})=>{if(Gr(t,0)&&Gr(e,0))return;const r=Math.atan2(-e,-t),s=Math.round(8*r/(2*Math.PI))&7;return B0[s]},PF=({x:t,y:e},{x:r,y:s})=>Math.abs(r-t)**2+Math.abs(s-e)**2,EF=(t,e)=>{const r=t.x*e.x+t.y*e.y+t.z*e.z;if(r<=0)return!1;const s=t.x*t.x+t.y*t.y+t.z*t.z,n=e.x*e.x+e.y*e.y+e.z*e.z;return Math.abs(r*r-s*n)<Ts},TF=t=>{t.x=0,t.y=0,t.z=0},Zy=["lookUp","lookDown","lookLeft","lookRight"],ex=["jump","fire","carry","swop","swop.head","swop.heels","hold","toggleColourisation","cycleResolution","toggleShowFps","menu_select","menu_openOrExit","menu_exit","map",...fn,"lookShift",...Zy],tx=[...ex];var It={},Tl={},Rl={},Kf;function il(){if(Kf)return Rl;Kf=1;function t(e){return typeof e<"u"}return Rl.notUndefined=t,Rl}var Xf;function rx(){if(Xf)return Tl;Xf=1;const{notUndefined:t}=il();function e(r){return r!=null&&t(r[Symbol.iterator])}return Tl.isIterable=e,Tl}var Ml={},Jf;function O0(){return Jf||(Jf=1,Ml.isLoopable=rx().isIterable),Ml}var Il={},Zf;function z0(){if(Zf)return Il;Zf=1;const{notUndefined:t}=il();function e(r){return r==null||t(r[Symbol.iterator])}return Il.isWrappable=e,Il}var Vo={},ep;function N0(){if(ep)return Vo;ep=1;function*t(r){yield*r}Vo.wrap=t;function*e(r){r!=null&&(yield*r)}return Vo.nullableWrap=e,Vo}var _o={},tp;function D0(){if(tp)return _o;tp=1;function t(s,n=s.length,i=[]){return(...o)=>n<=o.length?s(...i,...o):t(s,n-o.length,[...i,...o])}_o.curry=t;function e(s,n){const{fn:i,validateArgs:o,variadic:a,reduces:l,growRight:c,minArgs:u,maxArgs:h,isIterable:d,iterableType:f,applyOnIterableArgs:m,IterableClass:A}=s;if(n.length>u){let g=!0;const y=a?n.findIndex((x,b)=>d(x)&&b>=u):Math.min(h,n.length-1),w=a?n.length:y+1;if(a)for(let x=y;x<n.length;x++)g=g&&d(n[x]);else g=d(n[y]);if(n.length>h&&(y===-1||!g)){const x=a?`...${f}s`:f,b=`${i.name} takes up to ${h} arguments, followed by ${x}. You already passed ${n.length} arguments`;throw a?new Error(`${b} and the following arguments were not all ${f}s`):new Error(`${b} and the last argument was not ${f}`)}if(y>=0&&g){for(let b=y;b<w;b++)n[b]=m(n[b]);const x=a?n.slice(y):n[y];return n.splice(y),c||n.reverse(),n.unshift(x),o(n),l?i(...n):new A(i,n)}}return r(s,n)}function r(s,n=[]){return(...i)=>{if(i.length===0)throw new Error("Cannot make a partial application with no arguments");return i.unshift(...n),e(s,i)}}return _o.variadicCurryWithValidation=r,_o}var Kn={},rp;function F0(){if(rp)return Kn;rp=1;const t=Symbol.for("_");Kn._=t;const e=Symbol("__iterate");Kn.__iterate=e;const r=Symbol("split");return Kn.split=r,Kn}var sp;function $t(){if(sp)return It;sp=1;const{isIterable:t}=rx(),{isLoopable:e}=O0(),{isWrappable:r}=z0(),{nullableWrap:s}=N0(),{variadicCurryWithValidation:n}=D0(),{_:i,__iterate:o}=F0();It.wrap=s,It.isIterable=t,It.isLoopable=e,It.isWrappable=r;function a(A){if(r(A))return t(A)?A:s(A);throw typeof A.next=="function"?new TypeError("iter-tools received a value that looked like an iterator but was not iterable. Get help fixing this: https://github.com/iter-tools/iter-tools/wiki/Making-iterators-iterable"):new TypeError("Expected an iterable, null, or undefined")}It.ensureIterable=a;function l(A){"return"in A&&A.return()}It.callReturn=l;function c(A,g){this[i]={fn:A,args:g,staticIterator:null}}It.BaseIterableIterator=c,Object.assign(c.prototype,{constructor:c,[o](){const{fn:A,args:g}=this[i];return A(...g)},next(){const A=this[i];return A.staticIterator=A.staticIterator||this[o](),A.staticIterator.next()},return(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.return(A)},throw(A){const g=this[i];return g.staticIterator=g.staticIterator||this[o](),g.staticIterator.throw(A)}});function u(...A){c.apply(this,A)}It.IterableIterator=u,u.prototype=Object.assign(Object.create(c.prototype),{constructor:u,[Symbol.iterator](){return this[o]()}});function h(A,g={}){const{validateArgs:y=k=>{},variadic:w=!1,reduces:x=!1,growRight:b=!1,minArgs:V=A.length-1,maxArgs:_=A.length-1,applyOnIterableArgs:v=a}=g;return{fn:A,validateArgs:y,variadic:w,reduces:x,growRight:b,minArgs:V,maxArgs:_,isIterable:r,iterableType:"iterable",applyOnIterableArgs:v,IterableClass:u}}function d(A){return[...A]}It.cache=d;function f(A,{validateArgs:g=y=>y}={}){return(...y)=>(g(y),new u(A,y))}It.wrapWithIterableIterator=f;const m=(A,g)=>n(h(A,g));return It.iterableCurry=m,It}var jl={},np;function L0(){if(np)return jl;np=1;class t{[Symbol.iterator](){return this}}return jl.IterableIterator=t,jl}var Xn={},ip;function sx(){if(ip)return Xn;ip=1;function t(s,n=!1){return typeof s=="number"&&!isNaN(s)&&isFinite(s)&&!(n&&s===0)}Xn.isInteger=t;function e(s,n=!1){return t(s)&&(n?s>0:s>=0)}Xn.isPositiveInteger=e;function r(s,n=!1){return typeof s=="number"&&!isNaN(s)&&!(n&&s===0)}return Xn.isIntegerOrInfinite=r,Xn}var So={},op;function U0(){if(op)return So;op=1;const{iterableCurry:t}=$t();function*e(s,n){let i=0;for(const o of s)yield n(o,i++)}So.__map=e;const r=t(e);return So.map=r,So}var ko={},ap;function H0(){if(ap)return ko;ap=1;const{ensureIterable:t}=$t();function e(s){const n=[];for(const i of s)n.push(i);return n}ko.__toArray=e;function r(s){return e(t(s))}return ko.toArray=r,ko}var Bl={},lp;function nx(){if(lp)return Bl;lp=1;function t(e){return typeof e=="object"&&e!==null}return Bl.isObject=t,Bl}var Ol={},cp;function $0(){if(cp)return Ol;cp=1;function t(e,r){for(const s of e)r(s)}return Ol.parallelEach=t,Ol}var zl={},up;function G0(){if(up)return zl;up=1;const{ensureIterable:t,callReturn:e}=$t(),r=Symbol.for("_");class s{constructor(o){this.peekr=o}next(){const{peekr:o}=this,{current:a}=o;return o.advance(),a}return(){return this.peekr.return(),{value:void 0,done:!0}}[Symbol.iterator](){return this}}class n{static from(o,...a){const l=t(o)[Symbol.iterator](),c=l.next();return new this(l,c,...a)}constructor(o,a){this[r]={iterator:o,current:a,index:0}}get current(){return this[r].current}get value(){return this[r].current.value}get done(){return this[r].current.done}get index(){return this[r].index}advance(){const o=this[r];return o.current.done||(o.index++,o.current=o.iterator.next()),this}return(){const o=this[r];return this.done||e(o.iterator),o.current={value:void 0,done:!0},this}asIterator(){return new s(this)}}return zl.Peekerator=n,zl}var Nl={},hp;function W0(){if(hp)return Nl;hp=1;const{isInteger:t}=sx(),{isObject:e}=nx(),{notUndefined:r}=il(),s=n=>function(o){if(e(o[1])){const{start:a,step:l}=o[1];o[1]=a,o[2]=l}if(r(o[2])&&(o[2]=Number(o[2]),!t(o[2],!0)))throw new Error(`step argument to ${n} must be a non-zero integer`)};return Nl.makeValidateArgs=s,Nl}var Jn={},dp;function Y0(){if(dp)return Jn;dp=1;const{iterableCurry:t,callReturn:e}=$t(),{IterableIterator:r}=L0(),{parallelEach:s}=$0(),{Peekerator:n}=G0(),{__map:i}=U0(),{__toArray:o}=H0(),a=Symbol.for("_"),l=Symbol.for("__advance");class c extends n{constructor(g,y,w){super(g,y),this[a].inputSummary=w}advance(){this[a].inputSummary.advanceBuffer(this)}[l](){super.advance()}}class u{constructor(){this.buffers=[],this.notDoneBuffer=null,this.index=0}init(g){this.buffers=g,this.updateNotDone()}updateNotDone(){this.notDoneBuffer=this.buffers.find(g=>!g.done)}advanceBuffer(g){const y=g.done;g[l](),this.index++,!y&&g.done&&this.updateNotDone()}}class h{constructor(g){this[a]=g}advance(){throw new Error("advance() is not supported on an interleave summary")}get current(){return{value:this.value,done:this.done}}get value(){return this[a].notDoneBuffer}get done(){return this[a].notDoneBuffer===void 0}get index(){return this[a].index}}Jn.InputSummary=h;class d extends r{constructor(g,y,w){super(),this.sources=g,this.strategy=y,this.options=w,this.initialized=!1,this.inputSummary=new u(g)}init(){this.initialized=!0;const{strategy:g,options:y,inputSummary:w}=this;this.buffers=o(i(this.sources,x=>c.from(x,w))),this.iterator=g(y,new h(w),...this.buffers),w.init(this.buffers)}returnBuffers(){s(this.buffers,g=>g.return())}next(){this.initialized||this.init();const g=this.iterator.next();return g.done&&this.returnBuffers(),g}return(){return e(this.iterator),this.returnBuffers(),{value:void 0,done:!0}}}function f(A,g,y={}){return new d(A,g,y)}Jn.__interleave=f;const m=t(f,{variadic:!0,growRight:!0,minArgs:1,maxArgs:2});return Jn.interleave=m,Jn}var Co={},Po={},fp;function Q0(){if(fp)return Po;fp=1;const{iterableCurry:t,callReturn:e}=$t();function r(n,i){const o=n[Symbol.iterator](),{value:a,done:l}=o.next();return l?i:(e(o),a)}Po.__firstOr=r;const s=t(r,{reduces:!0});return Po.firstOr=s,Po}var pp;function K0(){if(pp)return Co;pp=1;const{iterableCurry:t}=$t(),{__firstOr:e}=Q0();function r(n){return e(n,void 0)}Co.__first=r;const s=t(r,{reduces:!0});return Co.first=s,Co}var Eo={},mp;function X0(){if(mp)return Eo;mp=1;const{wrapWithIterableIterator:t}=$t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield[i,n[i]])}Eo.__objectEntries=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectEntries must be an object, null, or undefined")}});return Eo.objectEntries=s,Eo}var To={},gp;function J0(){if(gp)return To;gp=1;const{wrapWithIterableIterator:t}=$t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield i)}To.__objectKeys=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectKeys must be an object, null, or undefined")}});return To.objectKeys=s,To}var Ro={},Ap;function Z0(){if(Ap)return Ro;Ap=1;const{wrapWithIterableIterator:t}=$t(),{hasOwnProperty:e}=Object.prototype;function*r(n){if(n!=null)for(const i in n)e.call(n,i)&&(yield n[i])}Ro.__objectValues=r;const s=t(r,{validateArgs(n){if(!(n[0]==null||typeof n[0]=="object"))throw new Error("obj argument to objectValues must be an object, null, or undefined")}});return Ro.objectValues=s,Ro}var Mo={},yp;function e_(){if(yp)return Mo;yp=1;const{wrapWithIterableIterator:t}=$t(),{isInteger:e,isIntegerOrInfinite:r}=sx(),{isObject:s}=nx(),{notUndefined:n}=il();function*i(a=0,l=1/0,c=1){for(let u=a;c>0?u<l:u>l;u+=c)yield u}Mo.__range=i;const o=t(i,{growRight:!0,validateArgs(a){let[l,c=1/0,u]=a,h;if(s(l)?{start:h,end:c,step:u}=l:a.length>1?h=l:c=l,n(h)&&!e(h))throw new TypeError("The specified start was not an integer");if(n(c)&&!r(c))throw new TypeError("The specified end was not an integer or infinite");if(n(u)&&!e(u,!0))throw new TypeError("The specified step was not a non-zero integer");a[0]=h,a[1]=c,a[2]=u}});return Mo.range=o,Mo}var Io={},xp;function t_(){if(xp)return Io;xp=1;const{iterableCurry:t}=$t(),{__interleave:e}=Y0(),{makeValidateArgs:r}=W0();function*s({start:o,step:a},l,...c){o=o%c.length;for(let u=o;!l.done;u=(u+a)%c.length){const h=c[u];h.done||(yield h.value,h.advance())}}function n(o,a=1,l=0){return e(o,s,{start:l,step:a})}Io.__roundRobin=n;const i=t(n,{variadic:!0,minArgs:0,maxArgs:2,validateArgs:r("roundRobin")});return Io.roundRobin=i,Io}var jo={},bp;function r_(){if(bp)return jo;bp=1;const{ensureIterable:t}=$t();function e(s){const n=t(s);let i=0;for(const o of n)i++;return i}jo.__size=e;const r=e;return jo.size=r,jo}var Bo={},wp;function s_(){if(wp)return Bo;wp=1;const{iterableCurry:t}=$t();function*e(s,n){if(n===0)return;let i=0;for(const o of s)if(yield o,++i===n)break}Bo.__take=e;const r=t(e);return Bo.take=r,Bo}var Dl,qp;function n_(){return qp||(qp=1,Dl=K0().first),Dl}var i_=n_();const ix=rt(i_);var Fl,vp;function o_(){return vp||(vp=1,Fl=X0().objectEntries),Fl}var a_=o_();const Kh=rt(a_);var Ll,Vp;function l_(){return Vp||(Vp=1,Ll=J0().objectKeys),Ll}var c_=l_();const ox=rt(c_);var Ul,_p;function u_(){return _p||(_p=1,Ul=Z0().objectValues),Ul}var h_=u_();const Or=rt(h_);var Hl,Sp;function d_(){return Sp||(Sp=1,Hl=e_().range),Hl}var f_=d_();const ax=rt(f_);var $l,kp;function p_(){return kp||(kp=1,$l=t_().roundRobin),$l}var m_=p_();const g_=rt(m_);var Gl,Cp;function A_(){return Cp||(Cp=1,Gl=r_().size),Gl}var y_=A_();const qu=rt(y_);var Wl,Pp;function x_(){return Pp||(Pp=1,Wl=s_().take),Wl}var b_=x_();const w_=rt(b_),Ke=t=>t[Symbol.iterator](),uo=Object.entries,lx=Kh,cx=Object.keys,Xh=ox,q_=Object.fromEntries,Nn=Object.fromEntries,v_=(t,e)=>{const s=Ke(lx(t)).map(e);return q_(s)},on={presses:Nn(tx.map(t=>[t,{keys:[],gamepadAxes:[],gamepadButtons:[]}])),axes:{x:[],y:[],xLook:[],yLook:[]}},Ep=(t,e)=>Array.from(new Set([...t??[],...e??[]]));function Ns(...t){return{presses:t.reduce((e,r)=>{for(const s of tx)e[s]={keys:Ep(e[s]?.keys,r?.presses?.[s]?.keys),gamepadButtons:Ep(e[s]?.gamepadButtons,r?.presses?.[s]?.gamepadButtons)};return e},structuredClone(on.presses)),axes:{x:Array.from(new Set([...on.axes.x,...t.map(e=>e.axes?.x??[]).flat()])),y:Array.from(new Set([...on.axes.y,...t.map(e=>e.axes?.y??[]).flat()])),xLook:Array.from(new Set([...on.axes.xLook,...t.map(e=>e.axes?.xLook??[]).flat()])),yLook:Array.from(new Set([...on.axes.yLook,...t.map(e=>e.axes?.yLook??[]).flat()]))}}}const ze={dPadDown:13,dPadUp:12,dPadLeft:14,dPadRight:15,a:0,b:1,x:2,y:3,lb:4,lt:6,rb:5,rt:7,select:8,start:9,l3:10,r3:11},Tp=v_(ze,([t,e])=>[e,t]),V_={start:"1",coin:"5",directions:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},buttons:["Control","Alt"," ","Shift","Z","X"]},__={start:"2",coin:"6",directions:{up:"R",down:"F",left:"D",right:"G"},buttons:["A","S","Q","W","I","K"]},Gt={dPadUp:"C",dPadDown:"D",dPadLeft:"E",dPadRight:"F",a:"J",b:"G",y:"H",x:"I",rb:"M",start:"O",select:"N"},Ds={presses:{right:{keys:["ArrowRight"],gamepadButtons:[]},towards:{keys:["ArrowDown"]},left:{keys:["ArrowLeft"]},away:{keys:["ArrowUp"]},menu_openOrExit:{keys:["Escape",""]},menu_exit:{gamepadButtons:[ze.b]},menu_select:{keys:["Enter"],gamepadButtons:[ze.a]},toggleColourisation:{keys:["F10"]},toggleShowFps:{keys:["F9"]},cycleResolution:{keys:["0"]}}},Dn={inputAssignment:Ns(Ds,{presses:{right:{gamepadButtons:[ze.dPadRight]},towards:{gamepadButtons:[ze.dPadDown]},left:{gamepadButtons:[ze.dPadLeft]},away:{gamepadButtons:[ze.dPadUp]},jump:{gamepadButtons:[ze.a,ze.y]},carry:{gamepadButtons:[ze.x,ze.y]},fire:{gamepadButtons:[ze.b]},swop:{gamepadButtons:[ze.rb]},lookShift:{gamepadButtons:[ze.rt]},"swop.head":{gamepadButtons:[ze.l3]},"swop.heels":{gamepadButtons:[ze.r3]},hold:{gamepadButtons:[ze.start]},menu_openOrExit:{gamepadButtons:[ze.select]},map:{gamepadButtons:[ze.lb]},toggleColourisation:{gamepadButtons:[ze.lt]}},axes:{x:[0],y:[1],xLook:[2],yLook:[3]}}),description:"Joysticks/gamepads with at least 4 buttons, but preferably 6 or more. Inc Playstation, xbox etc"},S_={inputAssignment:Ns(Ds,Dn.inputAssignment,{presses:{right:{keys:["P","7"]},towards:{keys:["A","8"]},left:{keys:["O","6"]},away:{keys:["Q","9"]},jump:{keys:[" ","M","N","B","Alt"]},carry:{keys:[" ","Enter","L","K","J"]},fire:{keys:["Shift","Z","X","C","V"]},swop:{keys:["S","D","F","G"]},hold:{keys:["H"]}}}),description:"closely matches zx spectrum keys"},k_={inputAssignment:Ns(Ds,Dn.inputAssignment,{presses:{carry:{keys:["F3","F5"]},fire:{keys:[" "]},jump:{keys:["F5"]},swop:{keys:["F1"]},hold:{keys:["H"]}}}),description:"closely matches Amiga version keys - heavy on the F-keys"},C_={inputAssignment:Ns(Ds,Dn.inputAssignment,{presses:{right:{keys:["P","Numpad6"]},towards:{keys:["A","Numpad5"]},left:{keys:["O","Numpad8"]},away:{keys:["Q","Numpad9"]},jump:{keys:[" ","`","Z","\\","Numpad0","Numpad-"]},carry:{keys:["Shift","`","Z","\\","Numpad1","Numpad-"]},fire:{keys:["D","NumpadEnter"]},swop:{keys:["Enter","S","Numpad+"]},"swop.head":{keys:["["]},"swop.heels":{keys:["]"]},hold:{keys:["F8","H","Numpad."]},map:{keys:["M","Tab"]},lookUp:{keys:["I"]},lookDown:{keys:["K"]},lookLeft:{keys:["J"]},lookRight:{keys:["L"]},lookShift:{keys:["C"]}}}),description:"Default combined key and joystick/gamepad assignment, should work on most setups"},P_={inputAssignment:Ns(Ds,Dn.inputAssignment,{presses:{right:{keys:["D"]},towards:{keys:["S"]},left:{keys:["A"]},away:{keys:["W"]},jump:{keys:[" ","F","P"]},carry:{keys:["Shift","F","I","P"]},fire:{keys:["E","O","Control"]},swop:{keys:["Q"]},hold:{keys:["H"]}}}),description:"Modern, minimalist WASD key layout"},E_={inputAssignment:Ns(Ds,Dn.inputAssignment,{presses:{right:{keys:[Gt.dPadRight]},towards:{keys:[Gt.dPadDown]},left:{keys:[Gt.dPadLeft]},away:{keys:[Gt.dPadUp]},jump:{keys:[Gt.a,Gt.y]},carry:{keys:[Gt.b,Gt.y]},fire:{keys:[Gt.x]},swop:{keys:[Gt.rb]},hold:{keys:[Gt.start]},menu_openOrExit:{keys:[Gt.select]}}}),description:"8bitdo controllers in keyboard mode (identifies to OS as a keyboard). They work as controllers even on phones that dont support controllers"},Rp=t=>({presses:{right:{keys:[t.directions.right]},towards:{keys:[t.directions.down]},left:{keys:[t.directions.left]},away:{keys:[t.directions.up]},jump:{keys:[t.buttons[0],t.buttons[3]]},carry:{keys:[t.buttons[1],t.buttons[3]]},fire:{keys:[t.buttons[2]]},swop:{keys:[t.start]},hold:{keys:[t.coin]},menu_openOrExit:{keys:[t.buttons[4]]}}}),T_={inputAssignment:Ns(on,Ds,{presses:{menu_openOrExit:{keys:["`","Tab"]}}},Rp(V_),Rp(__)),description:"MAME key mappings. For arcade-style control panels"},vn={default:C_,"zx spectrum":S_,amiga:k_,mame:T_,wasd:P_," 8bitdo keyboard mode":E_," joystick":Dn},Jh=()=>$r().get("campaignName")?.startsWith("data:"),RF=["yellow","cyan","green","magenta","white"],ho=25,MF=1e3/ho,Fn={amigaHiResPal:{x:640,y:512},classicMac:{x:512,y:384},amigaLowResPal:{x:320,y:256},zxSpectrum:{x:256,y:192},handheld:{x:256,y:135}},R_=Object.keys(Fn),IF={zxRed:"#f00",zxGreen:"#0f0",zxBlue:"#00f",zxCyan:"#0ff",zxMagenta:"#f0f",zxYellow:"#ff0",zxWhite:"#fff"},hr=()=>Pt()==="mobile"||Pt()==="tablet",Pt=()=>{if(typeof globalThis.window>"u")return"server";const t=new URLSearchParams(window.location.search).get("device");if(t!==null)return t;const e=navigator.userAgent;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1||/iPad|Tablet|Android(?!.*Mobi)/i.test(e)?"tablet":/Mobi|Android|iPhone|iPod/i.test(e)?"mobile":"desktop"},M_=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,ma=[],ux=new Set,jF=new Map;ux.add=()=>{throw new Error("emptySet.add")};ux.clear=()=>{throw new Error("emptySet.clear")};const Ae=Object.freeze({}),Ia=(t,e)=>e.split(".").reduce((r,s)=>r[s],t),I_=(t,e,r)=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){const o=s[i];n=n[o]}n[s[s.length-1]]=r},Yl=(t,e)=>{const r=t.indexOf(e);return t[(r+1)%t.length]},Oi=(t,...e)=>{const r={};for(const s of e)r[s]=t[s];return r},BF=(t,...e)=>{const r={...t};for(const s of e)delete r[s];return r};var Ql,Mp;function j_(){if(Mp)return Ql;Mp=1;function t(s){if(Array.isArray(s))return!0;var n=s.length;return typeof n=="number"&&n>-1?n?0 in s&&n-1 in s:!0:!1}function e(s){var n=typeof s;return n==="object"?s===null?"null":t(s)?"array":s.constructor===Object?"pure-object":"object":n}function r(s,n){if(s===n||s!==s&&n!==n)return!0;var i=e(s),o=e(n);if(i!==o)return!1;if(i==="pure-object"){if(s===n)return!0;var a=Object.keys(s),l=Object.keys(n).length;if(a.length!==l)return!1;for(var c=0,u=a.length;c<u;c++){var h=a[c];if(!n.hasOwnProperty(a[c]))return!1;var d=s[h],f=n[h];if(d===s||f===n||d===n||f===s)return d===f;if(!r(d,f))return!1}return!0}else if(i==="array"){if(s.length===n.length)for(var m=0;m<s.length;m++){var A=s[m],g=n[m];if(A===s||g===n||A===n||g===s)return A===g;if(!r(A,g))return!1}else return!1;return!0}else if(i==="object"){if(s.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return s.valueOf()===n.valueOf();if(s.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return s.toString()===n.toString()}return!1}return Ql=r,Ql}var B_=j_();const O_=rt(B_),Zh=py.withTypes(),ie=my.withTypes();Vh.withTypes();const hx=t=>()=>ie(t),ed={inputAssignment:vn.default.inputAssignment,infiniteLivesPoke:!1,infiniteDoughnutsPoke:!1,displaySettings:{showBoundingBoxes:"none",showShadowMasks:!1,crtFilter:!1,uncolourised:!1,emulatedResolution:Pt()==="mobile"?"handheld":"zxSpectrum"},gameSpeed:1.2,showFps:!1,onScreenControls:Pt()==="mobile"||Pt()==="tablet",inputDirectionMode:"8-way",screenRelativeControl:!1,soundSettings:{mute:!1,noFootsteps:!1}};var dx=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(dx||{});function Ip(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var jp=bn;function fx(t,e){if(t===e||!(jp(t)&&jp(e)||Array.isArray(t)&&Array.isArray(e)))return e;const r=Object.keys(e),s=Object.keys(t);let n=r.length===s.length;const i=Array.isArray(e)?[]:{};for(const o of r)i[o]=fx(t[o],e[o]),n&&(n=t[o]===i[o]);return n?t:i}function pn(t){let e=0;for(const r in t)e++;return e}var Bp=t=>[].concat(...t);function z_(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function ja(t){return t!=null}function N_(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}function D_(t,e,r){return t.has(e)?t.get(e):t.set(e,r).get(e)}var Op=class{constructor(t,e=void 0){this.value=t,this.meta=e}},td=qt("__rtkq/focused"),px=qt("__rtkq/unfocused"),rd=qt("__rtkq/online"),mx=qt("__rtkq/offline");function sd(t){return t.type==="query"}function F_(t){return t.type==="mutation"}function nd(t){return t.type==="infinitequery"}function id(t,e,r,s,n,i){return L_(t)?t(e,r,s,n).filter(ja).map(vu).map(i):Array.isArray(t)?t.map(vu).map(i):[]}function L_(t){return typeof t=="function"}function vu(t){return typeof t=="string"?{type:t}:t}function U_(t,e){return t.catch(e)}var zi=Symbol("forceQueryFn"),Vu=t=>typeof t[zi]=="function";function H_({serializeQueryArgs:t,queryThunk:e,infiniteQueryThunk:r,mutationThunk:s,api:n,context:i}){const o=new Map,a=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:u}=n.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:y,buildInitiateMutation:w,getRunningQueryThunk:h,getRunningMutationThunk:d,getRunningQueriesThunk:f,getRunningMutationsThunk:m};function h(x,b){return V=>{const _=i.endpointDefinitions[x],v=t({queryArgs:b,endpointDefinition:_,endpointName:x});return o.get(V)?.[v]}}function d(x,b){return V=>a.get(V)?.[b]}function f(){return x=>Object.values(o.get(x)||{}).filter(ja)}function m(){return x=>Object.values(a.get(x)||{}).filter(ja)}function A(x,b){const V=(_,{subscribe:v=!0,forceRefetch:k,subscriptionOptions:E,[zi]:T,...R}={})=>(j,B)=>{const N=t({queryArgs:_,endpointDefinition:b,endpointName:x});let U;const q={...R,type:"query",subscribe:v,forceRefetch:k,subscriptionOptions:E,endpointName:x,originalArgs:_,queryCacheKey:N,[zi]:T};if(sd(b))U=e(q);else{const{direction:Q,initialPageParam:te}=R;U=r({...q,direction:Q,initialPageParam:te})}const C=n.endpoints[x].select(_),P=j(U),M=C(B()),{requestId:I,abort:z}=P,O=M.requestId!==I,D=o.get(j)?.[N],$=()=>C(B()),L=Object.assign(T?P.then($):O&&!D?Promise.resolve(M):Promise.all([D,P]).then($),{arg:_,requestId:I,subscriptionOptions:E,queryCacheKey:N,abort:z,async unwrap(){const Q=await L;if(Q.isError)throw Q.error;return Q.data},refetch:()=>j(V(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){v&&j(l({queryCacheKey:N,requestId:I}))},updateSubscriptionOptions(Q){L.subscriptionOptions=Q,j(u({endpointName:x,requestId:I,queryCacheKey:N,options:Q}))}});if(!D&&!O&&!T){const Q=D_(o,j,{});Q[N]=L,L.then(()=>{delete Q[N],pn(Q)||o.delete(j)})}return L};return V}function g(x,b){return A(x,b)}function y(x,b){return A(x,b)}function w(x){return(b,{track:V=!0,fixedCacheKey:_}={})=>(v,k)=>{const E=s({type:"mutation",endpointName:x,originalArgs:b,track:V,fixedCacheKey:_}),T=v(E),{requestId:R,abort:j,unwrap:B}=T,N=U_(T.unwrap().then(P=>({data:P})),P=>({error:P})),U=()=>{v(c({requestId:R,fixedCacheKey:_}))},q=Object.assign(N,{arg:T.arg,requestId:R,abort:j,unwrap:B,reset:U}),C=a.get(v)||{};return a.set(v,C),C[R]=q,q.then(()=>{delete C[R],pn(C)||a.delete(v)}),_&&(C[_]=q,q.then(()=>{C[_]===q&&(delete C[_],pn(C)||a.delete(v))})),q}}}function $_(t){return t}var Oo=(t={})=>({...t,[el]:!0});function G_({reducerPath:t,baseQuery:e,context:{endpointDefinitions:r},serializeQueryArgs:s,api:n,assertTagType:i,selectors:o}){const a=(k,E,T,R)=>(j,B)=>{const N=r[k],U=s({queryArgs:E,endpointDefinition:N,endpointName:k});if(j(n.internalActions.queryResultPatched({queryCacheKey:U,patches:T})),!R)return;const q=n.endpoints[k].select(E)(B()),C=id(N.providesTags,q.data,void 0,E,{},i);j(n.internalActions.updateProvidedBy({queryCacheKey:U,providedTags:C}))};function l(k,E,T=0){const R=[E,...k];return T&&R.length>T?R.slice(0,-1):R}function c(k,E,T=0){const R=[...k,E];return T&&R.length>T?R.slice(1):R}const u=(k,E,T,R=!0)=>(j,B)=>{const U=n.endpoints[k].select(E)(B()),q={patches:[],inversePatches:[],undo:()=>j(n.util.patchQueryData(k,E,q.inversePatches,R))};if(U.status==="uninitialized")return q;let C;if("data"in U)if(tr(U.data)){const[P,M,I]=Ey(U.data,T);q.patches.push(...M),q.inversePatches.push(...I),C=P}else C=T(U.data),q.patches.push({op:"replace",path:[],value:C}),q.inversePatches.push({op:"replace",path:[],value:U.data});return q.patches.length===0||j(n.util.patchQueryData(k,E,q.patches,R)),q},h=(k,E,T)=>R=>R(n.endpoints[k].initiate(E,{subscribe:!1,forceRefetch:!0,[zi]:()=>({data:T})})),d=(k,E)=>k.query&&k[E]?k[E]:$_,f=async(k,{signal:E,abort:T,rejectWithValue:R,fulfillWithValue:j,dispatch:B,getState:N,extra:U})=>{const q=r[k.endpointName];try{let C=d(q,"transformResponse");const P={signal:E,abort:T,dispatch:B,getState:N,extra:U,endpoint:k.endpointName,type:k.type,forced:k.type==="query"?m(k,N()):void 0,queryCacheKey:k.type==="query"?k.queryCacheKey:void 0},M=k.type==="query"?k[zi]:void 0;let I;const z=async(D,$,L,Q)=>{if($==null&&D.pages.length)return Promise.resolve({data:D});const te={queryArg:k.originalArgs,pageParam:$},ne=await O(te),we=Q?l:c;return{data:{pages:we(D.pages,ne.data,L),pageParams:we(D.pageParams,$,L)}}};async function O(D){let $;const{extraOptions:L}=q;if(M?$=M():q.query?$=await e(q.query(D),P,L):$=await q.queryFn(D,P,L,te=>e(te,P,L)),typeof process<"u",$.error)throw new Op($.error,$.meta);const Q=await C($.data,$.meta,D);return{...$,data:Q}}if(k.type==="query"&&"infiniteQueryOptions"in q){const{infiniteQueryOptions:D}=q,{maxPages:$=1/0}=D;let L;const Q={pages:[],pageParams:[]},te=o.selectQueryEntry(N(),k.queryCacheKey)?.data,we=m(k,N())&&!k.direction||!te?Q:te;if("direction"in k&&k.direction&&we.pages.length){const ue=k.direction==="backward",He=(ue?gx:_u)(D,we);L=await z(we,He,$,ue)}else{const{initialPageParam:ue=D.initialPageParam}=k,At=te?.pageParams??[],He=At[0]??ue,st=At.length;L=await z(we,He,$),M&&(L={data:L.data.pages[0]});for(let Mt=1;Mt<st;Mt++){const oe=_u(D,L.data);L=await z(L.data,oe,$)}}I=L}else I=await O(k.originalArgs);return j(I.data,Oo({fulfilledTimeStamp:Date.now(),baseQueryMeta:I.meta}))}catch(C){let P=C;if(P instanceof Op){let M=d(q,"transformErrorResponse");try{return R(await M(P.value,P.meta,k.originalArgs),Oo({baseQueryMeta:P.meta}))}catch(I){P=I}}throw console.error(P),P}};function m(k,E){const T=o.selectQueryEntry(E,k.queryCacheKey),R=o.selectConfig(E).refetchOnMountOrArgChange,j=T?.fulfilledTimeStamp,B=k.forceRefetch??(k.subscribe&&R);return B?B===!0||(Number(new Date)-Number(j))/1e3>=B:!1}const A=()=>Lf(`${t}/executeQuery`,f,{getPendingMeta({arg:E}){const T=r[E.endpointName];return Oo({startedTimeStamp:Date.now(),...nd(T)?{direction:E.direction}:{}})},condition(E,{getState:T}){const R=T(),j=o.selectQueryEntry(R,E.queryCacheKey),B=j?.fulfilledTimeStamp,N=E.originalArgs,U=j?.originalArgs,q=r[E.endpointName],C=E.direction;return Vu(E)?!0:j?.status==="pending"?!1:m(E,R)||sd(q)&&q?.forceRefetch?.({currentArg:N,previousArg:U,endpointState:j,state:R})?!0:!(B&&!C)},dispatchConditionRejection:!0}),g=A(),y=A(),w=Lf(`${t}/executeMutation`,f,{getPendingMeta(){return Oo({startedTimeStamp:Date.now()})}}),x=k=>"force"in k,b=k=>"ifOlderThan"in k,V=(k,E,T)=>(R,j)=>{const B=x(T)&&T.force,N=b(T)&&T.ifOlderThan,U=(C=!0)=>{const P={forceRefetch:C,isPrefetch:!0};return n.endpoints[k].initiate(E,P)},q=n.endpoints[k].select(E)(j());if(B)R(U());else if(N){const C=q?.fulfilledTimeStamp;if(!C){R(U());return}(Number(new Date)-Number(new Date(C)))/1e3>=N&&R(U())}else R(U(!1))};function _(k){return E=>E?.meta?.arg?.endpointName===k}function v(k,E){return{matchPending:vi(jh(k),_(E)),matchFulfilled:vi(Qr(k),_(E)),matchRejected:vi(wn(k),_(E))}}return{queryThunk:g,mutationThunk:w,infiniteQueryThunk:y,prefetch:V,updateQueryData:u,upsertQueryData:h,patchQueryData:a,buildMatchThunkActions:v}}function _u(t,{pages:e,pageParams:r}){const s=e.length-1;return t.getNextPageParam(e[s],e,r[s],r)}function gx(t,{pages:e,pageParams:r}){return t.getPreviousPageParam?.(e[0],e,r[0],r)}function Ax(t,e,r,s){return id(r[t.meta.arg.endpointName][e],Qr(t)?t.payload:void 0,rl(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,s)}function zo(t,e,r){const s=t[e];s&&r(s)}function Ni(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function zp(t,e,r){const s=t[Ni(e)];s&&r(s)}var Zn={};function W_({reducerPath:t,queryThunk:e,mutationThunk:r,serializeQueryArgs:s,context:{endpointDefinitions:n,apiUid:i,extractRehydrationInfo:o,hasRehydrationInfo:a},assertTagType:l,config:c}){const u=qt(`${t}/resetApiState`);function h(v,k,E,T){v[k.queryCacheKey]??={status:"uninitialized",endpointName:k.endpointName},zo(v,k.queryCacheKey,R=>{R.status="pending",R.requestId=E&&R.requestId?R.requestId:T.requestId,k.originalArgs!==void 0&&(R.originalArgs=k.originalArgs),R.startedTimeStamp=T.startedTimeStamp;const j=n[T.arg.endpointName];nd(j)&&"direction"in k&&(R.direction=k.direction)})}function d(v,k,E,T){zo(v,k.arg.queryCacheKey,R=>{if(R.requestId!==k.requestId&&!T)return;const{merge:j}=n[k.arg.endpointName];if(R.status="fulfilled",j)if(R.data!==void 0){const{fulfilledTimeStamp:B,arg:N,baseQueryMeta:U,requestId:q}=k;let C=Bn(R.data,P=>j(P,E,{arg:N.originalArgs,baseQueryMeta:U,fulfilledTimeStamp:B,requestId:q}));R.data=C}else R.data=E;else R.data=n[k.arg.endpointName].structuralSharing??!0?fx(fr(R.data)?Hv(R.data):R.data,E):E;delete R.error,R.fulfilledTimeStamp=k.fulfilledTimeStamp})}const f=Sr({name:`${t}/queries`,initialState:Zn,reducers:{removeQueryResult:{reducer(v,{payload:{queryCacheKey:k}}){delete v[k]},prepare:Qn()},cacheEntriesUpserted:{reducer(v,k){for(const E of k.payload){const{queryDescription:T,value:R}=E;h(v,T,!0,{arg:T,requestId:k.meta.requestId,startedTimeStamp:k.meta.timestamp}),d(v,{arg:T,requestId:k.meta.requestId,fulfilledTimeStamp:k.meta.timestamp,baseQueryMeta:{}},R,!0)}},prepare:v=>({payload:v.map(T=>{const{endpointName:R,arg:j,value:B}=T,N=n[R];return{queryDescription:{type:"query",endpointName:R,originalArgs:T.arg,queryCacheKey:s({queryArgs:j,endpointDefinition:N,endpointName:R})},value:B}}),meta:{[el]:!0,requestId:ao(),timestamp:Date.now()}})},queryResultPatched:{reducer(v,{payload:{queryCacheKey:k,patches:E}}){zo(v,k,T=>{T.data=jf(T.data,E.concat())})},prepare:Qn()}},extraReducers(v){v.addCase(e.pending,(k,{meta:E,meta:{arg:T}})=>{const R=Vu(T);h(k,T,R,E)}).addCase(e.fulfilled,(k,{meta:E,payload:T})=>{const R=Vu(E.arg);d(k,E,T,R)}).addCase(e.rejected,(k,{meta:{condition:E,arg:T,requestId:R},error:j,payload:B})=>{zo(k,T.queryCacheKey,N=>{if(!E){if(N.requestId!==R)return;N.status="rejected",N.error=B??j}})}).addMatcher(a,(k,E)=>{const{queries:T}=o(E);for(const[R,j]of Object.entries(T))(j?.status==="fulfilled"||j?.status==="rejected")&&(k[R]=j)})}}),m=Sr({name:`${t}/mutations`,initialState:Zn,reducers:{removeMutationResult:{reducer(v,{payload:k}){const E=Ni(k);E in v&&delete v[E]},prepare:Qn()}},extraReducers(v){v.addCase(r.pending,(k,{meta:E,meta:{requestId:T,arg:R,startedTimeStamp:j}})=>{R.track&&(k[Ni(E)]={requestId:T,status:"pending",endpointName:R.endpointName,startedTimeStamp:j})}).addCase(r.fulfilled,(k,{payload:E,meta:T})=>{T.arg.track&&zp(k,T,R=>{R.requestId===T.requestId&&(R.status="fulfilled",R.data=E,R.fulfilledTimeStamp=T.fulfilledTimeStamp)})}).addCase(r.rejected,(k,{payload:E,error:T,meta:R})=>{R.arg.track&&zp(k,R,j=>{j.requestId===R.requestId&&(j.status="rejected",j.error=E??T)})}).addMatcher(a,(k,E)=>{const{mutations:T}=o(E);for(const[R,j]of Object.entries(T))(j?.status==="fulfilled"||j?.status==="rejected")&&R!==j?.requestId&&(k[R]=j)})}}),A=Sr({name:`${t}/invalidation`,initialState:Zn,reducers:{updateProvidedBy:{reducer(v,k){const{queryCacheKey:E,providedTags:T}=k.payload;for(const R of Object.values(v))for(const j of Object.values(R)){const B=j.indexOf(E);B!==-1&&j.splice(B,1)}for(const{type:R,id:j}of T){const B=(v[R]??={})[j||"__internal_without_id"]??=[];B.includes(E)||B.push(E)}},prepare:Qn()}},extraReducers(v){v.addCase(f.actions.removeQueryResult,(k,{payload:{queryCacheKey:E}})=>{for(const T of Object.values(k))for(const R of Object.values(T)){const j=R.indexOf(E);j!==-1&&R.splice(j,1)}}).addMatcher(a,(k,E)=>{const{provided:T}=o(E);for(const[R,j]of Object.entries(T))for(const[B,N]of Object.entries(j)){const U=(k[R]??={})[B||"__internal_without_id"]??=[];for(const q of N)U.includes(q)||U.push(q)}}).addMatcher(pr(Qr(e),rl(e)),(k,E)=>{g(k,E)}).addMatcher(f.actions.cacheEntriesUpserted.match,(k,E)=>{for(const{queryDescription:T,value:R}of E.payload)g(k,{type:"UNKNOWN",payload:R,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:T}})})}});function g(v,k){const E=Ax(k,"providesTags",n,l),{queryCacheKey:T}=k.meta.arg;A.caseReducers.updateProvidedBy(v,A.actions.updateProvidedBy({queryCacheKey:T,providedTags:E}))}const y=Sr({name:`${t}/subscriptions`,initialState:Zn,reducers:{updateSubscriptionOptions(v,k){},unsubscribeQueryResult(v,k){},internal_getRTKQSubscriptions(){}}}),w=Sr({name:`${t}/internalSubscriptions`,initialState:Zn,reducers:{subscriptionsUpdated:{reducer(v,k){return jf(v,k.payload)},prepare:Qn()}}}),x=Sr({name:`${t}/config`,initialState:{online:N_(),focused:z_(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(v,{payload:k}){v.middlewareRegistered=v.middlewareRegistered==="conflict"||i!==k?"conflict":!0}},extraReducers:v=>{v.addCase(rd,k=>{k.online=!0}).addCase(mx,k=>{k.online=!1}).addCase(td,k=>{k.focused=!0}).addCase(px,k=>{k.focused=!1}).addMatcher(a,k=>({...k}))}}),b=Ph({queries:f.reducer,mutations:m.reducer,provided:A.reducer,subscriptions:w.reducer,config:x.reducer}),V=(v,k)=>b(u.match(k)?void 0:v,k),_={...x.actions,...f.actions,...y.actions,...w.actions,...m.actions,...A.actions,resetApiState:u};return{reducer:V,actions:_}}var kr=Symbol.for("RTKQ/skipToken"),yx={status:"uninitialized"},Np=Bn(yx,()=>{}),Dp=Bn(yx,()=>{});function Y_({serializeQueryArgs:t,reducerPath:e,createSelector:r}){const s=x=>Np,n=x=>Dp;return{buildQuerySelector:d,buildInfiniteQuerySelector:f,buildMutationSelector:m,selectInvalidatedBy:A,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function i(x){return{...x,...Ip(x.status)}}function o(x){return x[e]}function a(x){return o(x)?.queries}function l(x,b){return a(x)?.[b]}function c(x){return o(x)?.mutations}function u(x){return o(x)?.config}function h(x,b,V){return _=>{if(_===kr)return r(s,V);const v=t({queryArgs:_,endpointDefinition:b,endpointName:x});return r(E=>l(E,v)??Np,V)}}function d(x,b){return h(x,b,i)}function f(x,b){const{infiniteQueryOptions:V}=b;function _(v){const k={...v,...Ip(v.status)},{isLoading:E,isError:T,direction:R}=k,j=R==="forward",B=R==="backward";return{...k,hasNextPage:y(V,k.data),hasPreviousPage:w(V,k.data),isFetchingNextPage:E&&j,isFetchingPreviousPage:E&&B,isFetchNextPageError:T&&j,isFetchPreviousPageError:T&&B}}return h(x,b,_)}function m(){return x=>{let b;return typeof x=="object"?b=Ni(x)??kr:b=x,r(b===kr?n:v=>o(v)?.mutations?.[b]??Dp,i)}}function A(x,b){const V=x[e],_=new Set;for(const v of b.filter(ja).map(vu)){const k=V.provided[v.type];if(!k)continue;let E=(v.id!==void 0?k[v.id]:Bp(Object.values(k)))??[];for(const T of E)_.add(T)}return Bp(Array.from(_.values()).map(v=>{const k=V.queries[v];return k?[{queryCacheKey:v,endpointName:k.endpointName,originalArgs:k.originalArgs}]:[]}))}function g(x,b){return Object.values(a(x)).filter(V=>V?.endpointName===b&&V.status!=="uninitialized").map(V=>V.originalArgs)}function y(x,b){return b?_u(x,b)!=null:!1}function w(x,b){return!b||!x.getPreviousPageParam?!1:gx(x,b)!=null}}var Fp=WeakMap?new WeakMap:void 0,Su=({endpointName:t,queryArgs:e})=>{let r="";const s=Fp?.get(e);if(typeof s=="string")r=s;else{const n=JSON.stringify(e,(i,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=bn(o)?Object.keys(o).sort().reduce((a,l)=>(a[l]=o[l],a),{}):o,o));bn(e)&&Fp?.set(e,n),r=n}return`${t}(${r})`};function xx(...t){return function(r){const s=Ea(c=>r.extractRehydrationInfo?.(c,{reducerPath:r.reducerPath??"api"})),n={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:s,serializeQueryArgs(c){let u=Su;if("serializeQueryArgs"in c.endpointDefinition){const h=c.endpointDefinition.serializeQueryArgs;u=d=>{const f=h(d);return typeof f=="string"?f:Su({...d,queryArgs:f})}}else r.serializeQueryArgs&&(u=r.serializeQueryArgs);return u(c)},tagTypes:[...r.tagTypes||[]]},i={endpointDefinitions:{},batch(c){c()},apiUid:ao(),extractRehydrationInfo:s,hasRehydrationInfo:Ea(c=>s(c)!=null)},o={injectEndpoints:l,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const h of c)n.tagTypes.includes(h)||n.tagTypes.push(h);if(u)for(const[h,d]of Object.entries(u))typeof d=="function"?d(i.endpointDefinitions[h]):Object.assign(i.endpointDefinitions[h]||{},d);return o}},a=t.map(c=>c.init(o,n,i));function l(c){const u=c.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"}),infiniteQuery:h=>({...h,type:"infinitequery"})});for(const[h,d]of Object.entries(u)){if(c.overrideExisting!==!0&&h in i.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(tt(39));continue}i.endpointDefinitions[h]=d;for(const f of a)f.injectEndpoint(h,d)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function Q_(){return function(){throw new Error(tt(33))}}function qr(t,...e){return Object.assign(t,...e)}var K_=({api:t,queryThunk:e,internalState:r})=>{const s=`${t.reducerPath}/subscriptions`;let n=null,i=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=t.internalActions,l=(f,m)=>{if(o.match(m)){const{queryCacheKey:g,requestId:y,options:w}=m.payload;return f?.[g]?.[y]&&(f[g][y]=w),!0}if(a.match(m)){const{queryCacheKey:g,requestId:y}=m.payload;return f[g]&&delete f[g][y],!0}if(t.internalActions.removeQueryResult.match(m))return delete f[m.payload.queryCacheKey],!0;if(e.pending.match(m)){const{meta:{arg:g,requestId:y}}=m,w=f[g.queryCacheKey]??={};return w[`${y}_running`]={},g.subscribe&&(w[y]=g.subscriptionOptions??w[y]??{}),!0}let A=!1;if(e.fulfilled.match(m)||e.rejected.match(m)){const g=f[m.meta.arg.queryCacheKey]||{},y=`${m.meta.requestId}_running`;A||=!!g[y],delete g[y]}if(e.rejected.match(m)){const{meta:{condition:g,arg:y,requestId:w}}=m;if(g&&y.subscribe){const x=f[y.queryCacheKey]??={};x[w]=y.subscriptionOptions??x[w]??{},A=!0}}return A},c=()=>r.currentSubscriptions,d={getSubscriptions:c,getSubscriptionCount:f=>{const A=c()[f]??{};return pn(A)},isRequestSubscribed:(f,m)=>!!c()?.[f]?.[m]};return(f,m)=>{if(n||(n=JSON.parse(JSON.stringify(r.currentSubscriptions))),t.util.resetApiState.match(f))return n=r.currentSubscriptions={},i=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(f))return[!1,d];const A=l(r.currentSubscriptions,f);let g=!0;if(A){i||(i=setTimeout(()=>{const x=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,b]=Ey(n,()=>x);m.next(t.internalActions.subscriptionsUpdated(b)),n=x,i=null},500));const y=typeof f.type=="string"&&!!f.type.startsWith(s),w=e.rejected.match(f)&&f.meta.condition&&!!f.meta.arg.subscribe;g=!y&&!w}return[g,!1]}};function X_(t){for(const e in t)return!1;return!0}var J_=2147483647/1e3-1,Z_=({reducerPath:t,api:e,queryThunk:r,context:s,internalState:n,selectors:{selectQueryEntry:i,selectConfig:o}})=>{const{removeQueryResult:a,unsubscribeQueryResult:l,cacheEntriesUpserted:c}=e.internalActions,u=pr(l.match,r.fulfilled,r.rejected,c.match);function h(g){const y=n.currentSubscriptions[g];return!!y&&!X_(y)}const d={},f=(g,y,w)=>{const x=y.getState(),b=o(x);if(u(g)){let V;if(c.match(g))V=g.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=l.match(g)?g.payload:g.meta.arg;V=[_]}m(V,y,b)}if(e.util.resetApiState.match(g))for(const[V,_]of Object.entries(d))_&&clearTimeout(_),delete d[V];if(s.hasRehydrationInfo(g)){const{queries:V}=s.extractRehydrationInfo(g);m(Object.keys(V),y,b)}};function m(g,y,w){const x=y.getState();for(const b of g){const V=i(x,b);A(b,V?.endpointName,y,w)}}function A(g,y,w,x){const V=s.endpointDefinitions[y]?.keepUnusedDataFor??x.keepUnusedDataFor;if(V===1/0)return;const _=Math.max(0,Math.min(V,J_));if(!h(g)){const v=d[g];v&&clearTimeout(v),d[g]=setTimeout(()=>{h(g)||w.dispatch(a({queryCacheKey:g})),delete d[g]},_*1e3)}}return f},Lp=new Error("Promise never resolved before cacheEntryRemoved."),eS=({api:t,reducerPath:e,context:r,queryThunk:s,mutationThunk:n,internalState:i,selectors:{selectQueryEntry:o,selectApiState:a}})=>{const l=yu(s),c=yu(n),u=Qr(s,n),h={};function d(y,w,x){const b=h[y];b?.valueResolved&&(b.valueResolved({data:w,meta:x}),delete b.valueResolved)}function f(y){const w=h[y];w&&(delete h[y],w.cacheEntryRemoved())}const m=(y,w,x)=>{const b=A(y);function V(_,v,k,E){const T=o(x,v),R=o(w.getState(),v);!T&&R&&g(_,E,v,w,k)}if(s.pending.match(y))V(y.meta.arg.endpointName,b,y.meta.requestId,y.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(y))for(const{queryDescription:_,value:v}of y.payload){const{endpointName:k,originalArgs:E,queryCacheKey:T}=_;V(k,T,y.meta.requestId,E),d(T,v,{})}else if(n.pending.match(y))w.getState()[e].mutations[b]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,b,w,y.meta.requestId);else if(u(y))d(b,y.payload,y.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(y)||t.internalActions.removeMutationResult.match(y))f(b);else if(t.util.resetApiState.match(y))for(const _ of Object.keys(h))f(_)};function A(y){return l(y)?y.meta.arg.queryCacheKey:c(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:t.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:t.internalActions.removeMutationResult.match(y)?Ni(y.payload):""}function g(y,w,x,b,V){const _=r.endpointDefinitions[y],v=_?.onCacheEntryAdded;if(!v)return;const k={},E=new Promise(U=>{k.cacheEntryRemoved=U}),T=Promise.race([new Promise(U=>{k.valueResolved=U}),E.then(()=>{throw Lp})]);T.catch(()=>{}),h[x]=k;const R=t.endpoints[y].select(_.type==="query"?w:x),j=b.dispatch((U,q,C)=>C),B={...b,getCacheEntry:()=>R(b.getState()),requestId:V,extra:j,updateCachedData:_.type==="query"?U=>b.dispatch(t.util.updateQueryData(y,w,U)):void 0,cacheDataLoaded:T,cacheEntryRemoved:E},N=v(w,B);Promise.resolve(N).catch(U=>{if(U!==Lp)throw U})}return m},tS=({api:t,context:{apiUid:e},reducerPath:r})=>(s,n)=>{t.util.resetApiState.match(s)&&n.dispatch(t.internalActions.middlewareRegistered(e))},rS=({reducerPath:t,context:e,context:{endpointDefinitions:r},mutationThunk:s,queryThunk:n,api:i,assertTagType:o,refetchQuery:a,internalState:l})=>{const{removeQueryResult:c}=i.internalActions,u=pr(Qr(s),rl(s)),h=pr(Qr(s,n),wn(s,n));let d=[];const f=(g,y)=>{u(g)?A(Ax(g,"invalidatesTags",r,o),y):h(g)?A([],y):i.util.invalidateTags.match(g)&&A(id(g.payload,void 0,void 0,void 0,void 0,o),y)};function m(g){const{queries:y,mutations:w}=g;for(const x of[y,w])for(const b in x)if(x[b]?.status==="pending")return!0;return!1}function A(g,y){const w=y.getState(),x=w[t];if(d.push(...g),x.config.invalidationBehavior==="delayed"&&m(x))return;const b=d;if(d=[],b.length===0)return;const V=i.util.selectInvalidatedBy(w,b);e.batch(()=>{const _=Array.from(V.values());for(const{queryCacheKey:v}of _){const k=x.queries[v],E=l.currentSubscriptions[v]??{};k&&(pn(E)===0?y.dispatch(c({queryCacheKey:v})):k.status!=="uninitialized"&&y.dispatch(a(k)))}})}return f},sS=({reducerPath:t,queryThunk:e,api:r,refetchQuery:s,internalState:n})=>{const i={},o=(d,f)=>{(r.internalActions.updateSubscriptionOptions.match(d)||r.internalActions.unsubscribeQueryResult.match(d))&&l(d.payload,f),(e.pending.match(d)||e.rejected.match(d)&&d.meta.condition)&&l(d.meta.arg,f),(e.fulfilled.match(d)||e.rejected.match(d)&&!d.meta.condition)&&a(d.meta.arg,f),r.util.resetApiState.match(d)&&u()};function a({queryCacheKey:d},f){const m=f.getState()[t],A=m.queries[d],g=n.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y,skipPollingIfUnfocused:w}=h(g);if(!Number.isFinite(y))return;const x=i[d];x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);const b=Date.now()+y;i[d]={nextPollTimestamp:b,pollingInterval:y,timeout:setTimeout(()=>{(m.config.focused||!w)&&f.dispatch(s(A)),a({queryCacheKey:d},f)},y)}}function l({queryCacheKey:d},f){const A=f.getState()[t].queries[d],g=n.currentSubscriptions[d];if(!A||A.status==="uninitialized")return;const{lowestPollingInterval:y}=h(g);if(!Number.isFinite(y)){c(d);return}const w=i[d],x=Date.now()+y;(!w||x<w.nextPollTimestamp)&&a({queryCacheKey:d},f)}function c(d){const f=i[d];f?.timeout&&clearTimeout(f.timeout),delete i[d]}function u(){for(const d of Object.keys(i))c(d)}function h(d={}){let f=!1,m=Number.POSITIVE_INFINITY;for(let A in d)d[A].pollingInterval&&(m=Math.min(d[A].pollingInterval,m),f=d[A].skipPollingIfUnfocused||f);return{lowestPollingInterval:m,skipPollingIfUnfocused:f}}return o},nS=({api:t,context:e,queryThunk:r,mutationThunk:s})=>{const n=jh(r,s),i=wn(r,s),o=Qr(r,s),a={};return(c,u)=>{if(n(c)){const{requestId:h,arg:{endpointName:d,originalArgs:f}}=c.meta,m=e.endpointDefinitions[d],A=m?.onQueryStarted;if(A){const g={},y=new Promise((V,_)=>{g.resolve=V,g.reject=_});y.catch(()=>{}),a[h]=g;const w=t.endpoints[d].select(m.type==="query"?f:h),x=u.dispatch((V,_,v)=>v),b={...u,getCacheEntry:()=>w(u.getState()),requestId:h,extra:x,updateCachedData:m.type==="query"?V=>u.dispatch(t.util.updateQueryData(d,f,V)):void 0,queryFulfilled:y};A(f,b)}}else if(o(c)){const{requestId:h,baseQueryMeta:d}=c.meta;a[h]?.resolve({data:c.payload,meta:d}),delete a[h]}else if(i(c)){const{requestId:h,rejectedWithValue:d,baseQueryMeta:f}=c.meta;a[h]?.reject({error:c.payload??c.error,isUnhandledError:!d,meta:f}),delete a[h]}}},iS=({reducerPath:t,context:e,api:r,refetchQuery:s,internalState:n})=>{const{removeQueryResult:i}=r.internalActions,o=(l,c)=>{td.match(l)&&a(c,"refetchOnFocus"),rd.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){const u=l.getState()[t],h=u.queries,d=n.currentSubscriptions;e.batch(()=>{for(const f of Object.keys(d)){const m=h[f],A=d[f];if(!A||!m)continue;(Object.values(A).some(y=>y[c]===!0)||Object.values(A).every(y=>y[c]===void 0)&&u.config[c])&&(pn(A)===0?l.dispatch(i({queryCacheKey:f})):m.status!=="uninitialized"&&l.dispatch(s(m)))}})}return o};function oS(t){const{reducerPath:e,queryThunk:r,api:s,context:n}=t,{apiUid:i}=n,o={invalidateTags:qt(`${e}/invalidateTags`)},a=h=>h.type.startsWith(`${e}/`),l=[tS,Z_,rS,sS,eS,nS];return{middleware:h=>{let d=!1;const m={...t,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},A=l.map(w=>w(m)),g=K_(m),y=iS(m);return w=>x=>{if(!Eh(x))return w(x);d||(d=!0,h.dispatch(s.internalActions.middlewareRegistered(i)));const b={...h,next:w},V=h.getState(),[_,v]=g(x,b,V);let k;if(_?k=w(x):k=v,h.getState()[e]&&(y(x,b,V),a(x)||n.hasRehydrationInfo(x)))for(const E of A)E(x,b,V);return k}},actions:o};function u(h){return t.api.endpoints[h.endpointName].initiate(h.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Up=Symbol(),bx=({createSelector:t=Ih}={})=>({name:Up,init(e,{baseQuery:r,tagTypes:s,reducerPath:n,serializeQueryArgs:i,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u},h){Zv();const d=O=>O;Object.assign(e,{reducerPath:n,endpoints:{},internalActions:{onOnline:rd,onOffline:mx,onFocus:td,onFocusLost:px},util:{}});const f=Y_({serializeQueryArgs:i,reducerPath:n,createSelector:t}),{selectInvalidatedBy:m,selectCachedArgsForQuery:A,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:w}=f;qr(e.util,{selectInvalidatedBy:m,selectCachedArgsForQuery:A});const{queryThunk:x,infiniteQueryThunk:b,mutationThunk:V,patchQueryData:_,updateQueryData:v,upsertQueryData:k,prefetch:E,buildMatchThunkActions:T}=G_({baseQuery:r,reducerPath:n,context:h,api:e,serializeQueryArgs:i,assertTagType:d,selectors:f}),{reducer:R,actions:j}=W_({context:h,queryThunk:x,mutationThunk:V,serializeQueryArgs:i,reducerPath:n,assertTagType:d,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:n,invalidationBehavior:u}});qr(e.util,{patchQueryData:_,updateQueryData:v,upsertQueryData:k,prefetch:E,resetApiState:j.resetApiState,upsertQueryEntries:j.cacheEntriesUpserted}),qr(e.internalActions,j);const{middleware:B,actions:N}=oS({reducerPath:n,context:h,queryThunk:x,mutationThunk:V,infiniteQueryThunk:b,api:e,assertTagType:d,selectors:f});qr(e.util,N),qr(e,{reducer:R,middleware:B});const{buildInitiateQuery:U,buildInitiateInfiniteQuery:q,buildInitiateMutation:C,getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueriesThunk:I,getRunningQueryThunk:z}=H_({queryThunk:x,mutationThunk:V,infiniteQueryThunk:b,api:e,serializeQueryArgs:i,context:h});return qr(e.util,{getRunningMutationThunk:P,getRunningMutationsThunk:M,getRunningQueryThunk:z,getRunningQueriesThunk:I}),{name:Up,injectEndpoint(O,D){const $=e,L=$.endpoints[O]??={};sd(D)&&qr(L,{name:O,select:g(O,D),initiate:U(O,D)},T(x,O)),F_(D)&&qr(L,{name:O,select:w(),initiate:C(O)},T(V,O)),nd(D)&&qr(L,{name:O,select:y(O,D),initiate:q(O,D)},T(x,O))}}}});bx();function No(t){return t.replace(t[0],t[0].toUpperCase())}function aS(t){return t.type==="query"}function lS(t){return t.type==="mutation"}function wx(t){return t.type==="infinitequery"}function ei(t,...e){return Object.assign(t,...e)}var Kl=Symbol();function Hp(t,e,r,s){const n=S.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?e({queryArgs:t,endpointDefinition:r,endpointName:s}):t}),[t,e,r,s]),i=S.useRef(n);return S.useEffect(()=>{i.current.serialized!==n.serialized&&(i.current=n)},[n]),i.current.serialized===n.serialized?i.current.queryArgs:t}function Do(t){const e=S.useRef(t);return S.useEffect(()=>{wi(e.current,t)||(e.current=t)},[t]),wi(e.current,t)?e.current:t}var cS=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uS=cS(),hS=()=>typeof navigator<"u"&&navigator.product==="ReactNative",dS=hS(),fS=()=>uS||dS?S.useLayoutEffect:S.useEffect,pS=fS(),$p=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:dx.pending}:t;function Xl(t,...e){const r={};return e.forEach(s=>{r[s]=t[s]}),r}var Jl=["data","status","isLoading","isSuccess","isError","error"];function mS({api:t,moduleOptions:{batch:e,hooks:{useDispatch:r,useSelector:s,useStore:n},unstable__sideEffectsInRender:i,createSelector:o},serializeQueryArgs:a,context:l}){const c=i?b=>b():S.useEffect;return{buildQueryHooks:y,buildInfiniteQueryHooks:w,buildMutationHook:x,usePrefetch:d};function u(b,V,_){if(V?.endpointName&&b.isUninitialized){const{endpointName:j}=V,B=l.endpointDefinitions[j];_!==kr&&a({queryArgs:V.originalArgs,endpointDefinition:B,endpointName:j})===a({queryArgs:_,endpointDefinition:B,endpointName:j})&&(V=void 0)}let v=b.isSuccess?b.data:V?.data;v===void 0&&(v=b.data);const k=v!==void 0,E=b.isLoading,T=(!V||V.isLoading||V.isUninitialized)&&!k&&E,R=b.isSuccess||k&&(E&&!V?.isError||b.isUninitialized);return{...b,data:v,currentData:b.data,isFetching:E,isLoading:T,isSuccess:R}}function h(b,V,_){if(V?.endpointName&&b.isUninitialized){const{endpointName:j}=V,B=l.endpointDefinitions[j];a({queryArgs:V.originalArgs,endpointDefinition:B,endpointName:j})===a({queryArgs:_,endpointDefinition:B,endpointName:j})&&(V=void 0)}let v=b.isSuccess?b.data:V?.data;v===void 0&&(v=b.data);const k=v!==void 0,E=b.isLoading,T=(!V||V.isLoading||V.isUninitialized)&&!k&&E,R=b.isSuccess||E&&k;return{...b,data:v,currentData:b.data,isFetching:E,isLoading:T,isSuccess:R}}function d(b,V){const _=r(),v=Do(V);return S.useCallback((k,E)=>_(t.util.prefetch(b,k,{...v,...E})),[b,_,v])}function f(b,V,{refetchOnReconnect:_,refetchOnFocus:v,refetchOnMountOrArgChange:k,skip:E=!1,pollingInterval:T=0,skipPollingIfUnfocused:R=!1,...j}={}){const{initiate:B}=t.endpoints[b],N=r(),U=S.useRef(void 0);if(!U.current){const Q=N(t.internalActions.internal_getRTKQSubscriptions());U.current=Q}const q=Hp(E?kr:V,Su,l.endpointDefinitions[b],b),C=Do({refetchOnReconnect:_,refetchOnFocus:v,pollingInterval:T,skipPollingIfUnfocused:R}),P=S.useRef(!1),M=j.initialPageParam,I=Do(M),z=S.useRef(void 0);let{queryCacheKey:O,requestId:D}=z.current||{},$=!1;O&&D&&($=U.current.isRequestSubscribed(O,D));const L=!$&&P.current;return c(()=>{P.current=$}),c(()=>{L&&(z.current=void 0)},[L]),c(()=>{const Q=z.current;if(q===kr){Q?.unsubscribe(),z.current=void 0;return}const te=z.current?.subscriptionOptions;if(!Q||Q.arg!==q){Q?.unsubscribe();const ne=N(B(q,{subscriptionOptions:C,forceRefetch:k,...wx(l.endpointDefinitions[b])?{initialPageParam:I}:{}}));z.current=ne}else C!==te&&Q.updateSubscriptionOptions(C)},[N,B,k,q,C,L,I,b]),[z,N,B,C]}function m(b,V){return(v,{skip:k=!1,selectFromResult:E}={})=>{const{select:T}=t.endpoints[b],R=Hp(k?kr:v,a,l.endpointDefinitions[b],b),j=S.useRef(void 0),B=S.useMemo(()=>o([T(R),(P,M)=>M,P=>R],V,{memoizeOptions:{resultEqualityCheck:wi}}),[T,R]),N=S.useMemo(()=>E?o([B],E,{devModeChecks:{identityFunctionCheck:"never"}}):B,[B,E]),U=s(P=>N(P,j.current),wi),q=n(),C=B(q.getState(),j.current);return pS(()=>{j.current=C},[C]),U}}function A(b){S.useEffect(()=>()=>{b.current?.unsubscribe?.(),b.current=void 0},[b])}function g(b){if(!b.current)throw new Error(tt(38));return b.current.refetch()}function y(b){const V=(k,E={})=>{const[T]=f(b,k,E);return A(T),S.useMemo(()=>({refetch:()=>g(T)}),[T])},_=({refetchOnReconnect:k,refetchOnFocus:E,pollingInterval:T=0,skipPollingIfUnfocused:R=!1}={})=>{const{initiate:j}=t.endpoints[b],B=r(),[N,U]=S.useState(Kl),q=S.useRef(void 0),C=Do({refetchOnReconnect:k,refetchOnFocus:E,pollingInterval:T,skipPollingIfUnfocused:R});c(()=>{const z=q.current?.subscriptionOptions;C!==z&&q.current?.updateSubscriptionOptions(C)},[C]);const P=S.useRef(C);c(()=>{P.current=C},[C]);const M=S.useCallback(function(z,O=!1){let D;return e(()=>{q.current?.unsubscribe(),q.current=D=B(j(z,{subscriptionOptions:P.current,forceRefetch:!O})),U(z)}),D},[B,j]),I=S.useCallback(()=>{q.current?.queryCacheKey&&B(t.internalActions.removeQueryResult({queryCacheKey:q.current?.queryCacheKey}))},[B]);return S.useEffect(()=>()=>{q?.current?.unsubscribe()},[]),S.useEffect(()=>{N!==Kl&&!q.current&&M(N,!0)},[N,M]),S.useMemo(()=>[M,N,{reset:I}],[M,N,I])},v=m(b,u);return{useQueryState:v,useQuerySubscription:V,useLazyQuerySubscription:_,useLazyQuery(k){const[E,T,{reset:R}]=_(k),j=v(T,{...k,skip:T===Kl}),B=S.useMemo(()=>({lastArg:T}),[T]);return S.useMemo(()=>[E,{...j,reset:R},B],[E,j,R,B])},useQuery(k,E){const T=V(k,E),R=v(k,{selectFromResult:k===kr||E?.skip?void 0:$p,...E}),j=Xl(R,...Jl);return S.useDebugValue(j),S.useMemo(()=>({...R,...T}),[R,T])}}}function w(b){const V=(v,k={})=>{const[E,T,R,j]=f(b,v,k),B=S.useRef(j);c(()=>{B.current=j},[j]);const N=S.useCallback(function(U,q){let C;return e(()=>{E.current?.unsubscribe(),E.current=C=T(R(U,{subscriptionOptions:B.current,direction:q}))}),C},[E,T,R]);return A(E),S.useMemo(()=>({trigger:N,refetch:()=>g(E),fetchNextPage:()=>N(v,"forward"),fetchPreviousPage:()=>N(v,"backward")}),[E,N,v])},_=m(b,h);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:V,useInfiniteQuery(v,k){const{refetch:E,fetchNextPage:T,fetchPreviousPage:R}=V(v,k),j=_(v,{selectFromResult:v===kr||k?.skip?void 0:$p,...k}),B=Xl(j,...Jl,"hasNextPage","hasPreviousPage");return S.useDebugValue(B),S.useMemo(()=>({...j,fetchNextPage:T,fetchPreviousPage:R,refetch:E}),[j,T,R,E])}}}function x(b){return({selectFromResult:V,fixedCacheKey:_}={})=>{const{select:v,initiate:k}=t.endpoints[b],E=r(),[T,R]=S.useState();S.useEffect(()=>()=>{T?.arg.fixedCacheKey||T?.reset()},[T]);const j=S.useCallback(function(z){const O=E(k(z,{fixedCacheKey:_}));return R(O),O},[E,k,_]),{requestId:B}=T||{},N=S.useMemo(()=>v({fixedCacheKey:_,requestId:T?.requestId}),[_,T,v]),U=S.useMemo(()=>V?o([N],V):N,[V,N]),q=s(U,wi),C=_==null?T?.arg.originalArgs:void 0,P=S.useCallback(()=>{e(()=>{T&&R(void 0),_&&E(t.internalActions.removeMutationResult({requestId:B,fixedCacheKey:_}))})},[E,_,T,B]),M=Xl(q,...Jl,"endpointName");S.useDebugValue(M);const I=S.useMemo(()=>({...q,originalArgs:C,reset:P}),[q,C,P]);return S.useMemo(()=>[j,I],[j,I])}}}var gS=Symbol(),AS=({batch:t=mv,hooks:e={useDispatch:py,useSelector:my,useStore:Vh},createSelector:r=Ih,unstable__sideEffectsInRender:s=!1,...n}={})=>({name:gS,init(i,{serializeQueryArgs:o},a){const l=i,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:h,usePrefetch:d}=mS({api:i,moduleOptions:{batch:t,hooks:e,unstable__sideEffectsInRender:s,createSelector:r},serializeQueryArgs:o,context:a});return ei(l,{usePrefetch:d}),ei(a,{batch:t}),{injectEndpoint(f,m){if(aS(m)){const{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:w,useQuerySubscription:x}=c(f);ei(l.endpoints[f],{useQuery:A,useLazyQuery:g,useLazyQuerySubscription:y,useQueryState:w,useQuerySubscription:x}),i[`use${No(f)}Query`]=A,i[`useLazy${No(f)}Query`]=g}if(lS(m)){const A=h(f);ei(l.endpoints[f],{useMutation:A}),i[`use${No(f)}Mutation`]=A}else if(wx(m)){const{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}=u(f);ei(l.endpoints[f],{useInfiniteQuery:A,useInfiniteQuerySubscription:g,useInfiniteQueryState:y}),i[`use${No(f)}InfiniteQuery`]=A}}}}}),yS=xx(bx(),AS());const xS=so(()=>gr(()=>import("./campaign-CI4F7JcI.js"),__vite__mapDeps([0,1,2]))),ol=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const bS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",di=Array.prototype.slice.call(bS),Fo=(t=>{let e={};return t.forEach((r,s)=>e[r]=s),e})(di),wS=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,ga=String.fromCharCode.bind(String),Gp=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),qS=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),qx=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),vS=t=>{let e,r,s,n,i="";const o=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|s<<8|n,i+=di[e>>18&63]+di[e>>12&63]+di[e>>6&63]+di[e&63]}return o?i.slice(0,o-3)+"===".substring(o):i},VS=typeof btoa=="function"?t=>btoa(t):ol?t=>Buffer.from(t,"binary").toString("base64"):vS,Wp=ol?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let s=0,n=t.length;s<n;s+=4096)r.push(ga.apply(null,t.subarray(s,s+4096)));return VS(r.join(""))},_S=(t,e=!1)=>e?qS(Wp(t)):Wp(t),SS=t=>{if(t=t.replace(/\s+/g,""),!wS.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",s,n;for(let i=0;i<t.length;)e=Fo[t.charAt(i++)]<<18|Fo[t.charAt(i++)]<<12|(s=Fo[t.charAt(i++)])<<6|(n=Fo[t.charAt(i++)]),r+=s===64?ga(e>>16&255):n===64?ga(e>>16&255,e>>8&255):ga(e>>16&255,e>>8&255,e&255);return r},kS=typeof atob=="function"?t=>atob(qx(t)):ol?t=>Buffer.from(t,"base64").toString("binary"):SS,CS=ol?t=>Gp(Buffer.from(t,"base64")):t=>Gp(kS(t).split("").map(e=>e.charCodeAt(0))),PS=t=>CS(ES(t)),ES=t=>qx(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),TS=!0,vx="gzip",RS=async t=>{const e=JSON.stringify(t),s=new TextEncoder().encode(e),n=new Blob([s]),i=new CompressionStream(vx),o=n.stream().pipeThrough(i),a=await new Response(o).arrayBuffer(),l=new Uint8Array(a);return _S(l,TS)},Vx=async t=>{try{const e=PS(t),r=new Blob([new Uint8Array(e)]),s=new DecompressionStream(vx),n=r.stream().pipeThrough(s),i=await new Response(n).text();return JSON.parse(i)}catch(e){throw new Error("error decompressing object",{cause:e})}},MS=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:s}=await Promise.resolve().then(()=>Ln);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class od extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class IS extends od{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yp extends od{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qp extends od{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ku;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ku||(ku={}));var jS=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class BS{constructor(e,{headers:r={},customFetch:s,region:n=ku.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=MS(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return jS(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:u}).catch(A=>{throw new IS(A)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Yp(h);if(!h.ok)throw new Qp(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield h.json():f==="application/octet-stream"?m=yield h.blob():f==="text/event-stream"?m=h:f==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof Qp||n instanceof Yp?n.context:void 0}}})}}var Xe={},Hs={},$s={},Gs={},Ws={},Ys={},OS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Vn=OS();const zS=Vn.fetch,_x=Vn.fetch.bind(Vn),Sx=Vn.Headers,NS=Vn.Request,DS=Vn.Response,Ln=Object.freeze(Object.defineProperty({__proto__:null,Headers:Sx,Request:NS,Response:DS,default:_x,fetch:zS},Symbol.toStringTag,{value:"Module"})),FS=Yq(Ln);var Lo={},Kp;function kx(){if(Kp)return Lo;Kp=1,Object.defineProperty(Lo,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Lo.default=t,Lo}var Xp;function Cx(){if(Xp)return Ys;Xp=1;var t=Ys&&Ys.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ys,"__esModule",{value:!0});const e=t(FS),r=t(kx());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,m=null,A=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const V=await c.text();V===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=V:m=JSON.parse(V))}const x=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&b&&b.length>1&&(A=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,A=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await c.text();try{f=JSON.parse(x),Array.isArray(f)&&c.status===404&&(m=[],f=null,g=200,y="OK")}catch{c.status===404&&x===""?(g=204,y="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,y="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:m,count:A,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Ys.default=s,Ys}var Jp;function Px(){if(Jp)return Ws;Jp=1;var t=Ws&&Ws.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ws,"__esModule",{value:!0});const e=t(Cx());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ws.default=r,Ws}var Zp;function ad(){if(Zp)return Gs;Zp=1;var t=Gs&&Gs.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Gs,"__esModule",{value:!0});const e=t(Px());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return Gs.default=r,Gs}var em;function Ex(){if(em)return $s;em=1;var t=$s&&$s.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($s,"__esModule",{value:!0});const e=t(ad());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return $s.default=r,$s}var ti={},ri={},tm;function LS(){return tm||(tm=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.version=void 0,ri.version="0.0.0-automated"),ri}var rm;function US(){if(rm)return ti;rm=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.DEFAULT_HEADERS=void 0;const t=LS();return ti.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},ti}var sm;function HS(){if(sm)return Hs;sm=1;var t=Hs&&Hs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Hs,"__esModule",{value:!0});const e=t(Ex()),r=t(ad()),s=US();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([A,g])=>g!==void 0).map(([A,g])=>[A,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([A,g])=>{d.searchParams.append(A,g)})):(h="POST",f=a);const m=Object.assign({},this.headers);return u&&(m.Prefer=`count=${u}`),new r.default({method:h,url:d,headers:m,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Hs.default=n,Hs}var nm;function $S(){if(nm)return Xe;nm=1;var t=Xe&&Xe.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.PostgrestError=Xe.PostgrestBuilder=Xe.PostgrestTransformBuilder=Xe.PostgrestFilterBuilder=Xe.PostgrestQueryBuilder=Xe.PostgrestClient=void 0;const e=t(HS());Xe.PostgrestClient=e.default;const r=t(Ex());Xe.PostgrestQueryBuilder=r.default;const s=t(ad());Xe.PostgrestFilterBuilder=s.default;const n=t(Px());Xe.PostgrestTransformBuilder=n.default;const i=t(Cx());Xe.PostgrestBuilder=i.default;const o=t(kx());return Xe.PostgrestError=o.default,Xe.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},Xe}var GS=$S();const WS=rt(GS),{PostgrestClient:YS,PostgrestQueryBuilder:OF,PostgrestFilterBuilder:zF,PostgrestTransformBuilder:NF,PostgrestBuilder:DF,PostgrestError:FF}=WS;function QS(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const KS=QS(),XS="2.11.15",JS=`realtime-js/${XS}`,ZS="1.0.0",Tx=1e4,ek=1e3;var Vi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Vi||(Vi={}));var ht;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ht||(ht={}));var Zt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Zt||(Zt={}));var Cu;(function(t){t.websocket="websocket"})(Cu||(Cu={}));var ws;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ws||(ws={}));class tk{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const l=s.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class Rx{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ve;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ve||(Ve={}));const im=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=rk(o,t,e,n),i),{})},rk=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?Mx(i,o):Pu(o)},Mx=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return ok(e,r)}switch(t){case Ve.bool:return sk(e);case Ve.float4:case Ve.float8:case Ve.int2:case Ve.int4:case Ve.int8:case Ve.numeric:case Ve.oid:return nk(e);case Ve.json:case Ve.jsonb:return ik(e);case Ve.timestamp:return ak(e);case Ve.abstime:case Ve.date:case Ve.daterange:case Ve.int4range:case Ve.int8range:case Ve.money:case Ve.reltime:case Ve.text:case Ve.time:case Ve.timestamptz:case Ve.timetz:case Ve.tsrange:case Ve.tstzrange:return Pu(e);default:return Pu(e)}},Pu=t=>t,sk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},nk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ik=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ok=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Mx(e,a))}return t},ak=t=>typeof t=="string"?t.replace(" ","T"):t,Ix=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Zl{constructor(e,r,s={},n=Tx){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var om;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(om||(om={}));class _i{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=_i.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=_i.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=_i.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),A=h.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),A.length>0&&(l[c]=A)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var am;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(am||(am={}));var lm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(lm||(lm={}));var _r;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(_r||(_r={}));class ld{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Zl(this,Zt.join,this.params,this.timeout),this.rejoinTimer=new Rx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ht.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zt.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new _i(this),this.broadcastEndpointURL=Ix(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ht.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e?.(_r.CHANNEL_ERROR,u)),this._onClose(()=>e?.(_r.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e?.(_r.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,m=[];for(let A=0;A<f;A++){const g=d[A],{filter:{event:y,schema:w,table:x,filter:b}}=g,V=u&&u[A];if(V&&V.event===y&&V.schema===w&&V.table===x&&V.filter===b)m.push(Object.assign(Object.assign({},g),{id:V.id}));else{this.unsubscribe(),this.state=ht.errored,e?.(_r.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(_r.SUBSCRIBED);return}}).receive("error",u=>{this.state=ht.errored,e?.(_r.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(_r.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ht.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Zl(this,Zt.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Zl(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Zt;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var m,A,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(A=f.filter)===null||A===void 0?void 0:A.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var m,A,g,y,w,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const b=f.id,V=(m=f.filter)===null||m===void 0?void 0:m.event;return b&&((A=r.ids)===null||A===void 0?void 0:A.includes(b))&&(V==="*"||V?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(w=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((x=r?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:A,table:g,commit_timestamp:y,type:w,errors:x}=m;d=Object.assign(Object.assign({},{schema:A,table:g,commit_timestamp:y,eventType:w,new:{},old:{},errors:x}),this._getPayloadRecords(m))}f.callback(d,s)})}_isClosed(){return this.state===ht.closed}_isJoined(){return this.state===ht.joined}_isJoining(){return this.state===ht.joining}_isLeaving(){return this.state===ht.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ld.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Zt.close,{},e)}_onError(e){this._on(Zt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ht.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=im(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=im(e.columns,e.old_record)),r}}const cm=()=>{},lk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ck{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Tx,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cm,this.ref=0,this.logger=cm,this.conn=null,this.sendBuffer=[],this.serializer=new tk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>gr(async()=>{const{default:l}=await Promise.resolve().then(()=>Ln);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Cu.websocket}`,this.httpEndpoint=Ix(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Rx(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=KS),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ZS}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Vi.connecting:return ws.Connecting;case Vi.open:return ws.Open;case Vi.closing:return ws.Closing;default:return ws.Closed}}isConnected(){return this.connectionState()===ws.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new ld(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:JS};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Zt.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(ek,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Zt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([lk],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class cd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ze(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class uk extends cd{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Eu extends cd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var hk=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const jx=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:s}=await Promise.resolve().then(()=>Ln);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},dk=()=>hk(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gr(()=>Promise.resolve().then(()=>Ln),void 0)).Response:Response}),Tu=t=>{if(Array.isArray(t))return t.map(r=>Tu(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Tu(s)}),e};var Fs=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const ec=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),fk=(t,e,r)=>Fs(void 0,void 0,void 0,function*(){const s=yield dk();t instanceof s&&!r?.noResolveJson?t.json().then(n=>{e(new uk(ec(n),t.status||500))}).catch(n=>{e(new Eu(ec(n),n))}):e(new Eu(ec(t),t))}),pk=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),r))};function fo(t,e,r,s,n,i){return Fs(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,pk(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>fk(l,a,s))})})}function Ba(t,e,r,s){return Fs(this,void 0,void 0,function*(){return fo(t,"GET",e,r,s)})}function Fr(t,e,r,s,n){return Fs(this,void 0,void 0,function*(){return fo(t,"POST",e,s,n,r)})}function mk(t,e,r,s,n){return Fs(this,void 0,void 0,function*(){return fo(t,"PUT",e,s,n,r)})}function gk(t,e,r,s){return Fs(this,void 0,void 0,function*(){return fo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Bx(t,e,r,s,n){return Fs(this,void 0,void 0,function*(){return fo(t,"DELETE",e,s,n,r)})}var Vt=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Ak={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},um={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class yk{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=jx(n)}uploadOrUpdate(e,r,s,n){return Vt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},um),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Ze(i))return{data:null,error:i};throw i}})}upload(e,r,s){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return Vt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:um.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(Ze(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Vt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield Fr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new cd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(Ze(s))return{data:null,error:s};throw s}})}update(e,r,s){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return Vt(this,void 0,void 0,function*(){try{return{data:yield Fr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}})}copy(e,r,s){return Vt(this,void 0,void 0,function*(){try{return{data:{path:(yield Fr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return Vt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Fr(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return Vt(this,void 0,void 0,function*(){try{const n=yield Fr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}})}download(e,r){return Vt(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ba(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Ze(a))return{data:null,error:a};throw a}})}info(e){return Vt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield Ba(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Tu(s),error:null}}catch(s){if(Ze(s))return{data:null,error:s};throw s}})}exists(e){return Vt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield gk(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Ze(s)&&s instanceof Eu){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield Bx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}})}list(e,r,s){return Vt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ak),r),{prefix:e||""});return{data:yield Fr(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const xk="2.7.1",bk={"X-Client-Info":`storage-js/${xk}`};var Qs=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class wk{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},bk),r),this.fetch=jx(s)}listBuckets(){return Qs(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ze(e))return{data:null,error:e};throw e}})}getBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Qs(this,void 0,void 0,function*(){try{return{data:yield Fr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ze(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Qs(this,void 0,void 0,function*(){try{return{data:yield mk(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ze(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield Fr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield Bx(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}})}}class qk extends wk{constructor(e,r={},s){super(e,r,s)}from(e){return new yk(this.url,this.headers,e,this.fetch)}}const vk="2.51.0";let fi="";typeof Deno<"u"?fi="deno":typeof document<"u"?fi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?fi="react-native":fi="node";const Vk={"X-Client-Info":`supabase-js-${fi}/${vk}`},_k={headers:Vk},Sk={schema:"public"},kk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ck={};var Pk=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Ek=t=>{let e;return t?e=t:typeof fetch>"u"?e=_x:e=fetch,(...r)=>e(...r)},Tk=()=>typeof Headers>"u"?Sx:Headers,Rk=(t,e,r)=>{const s=Ek(r),n=Tk();return(i,o)=>Pk(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new n(o?.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},o),{headers:c}))})};var Mk=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function Ik(t){return t.endsWith("/")?t:t+"/"}function jk(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(s=a?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>Mk(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Ox="2.71.0",an=30*1e3,Ru=3,tc=Ru*an,Bk="http://localhost:9999",Ok="supabase.auth.token",zk={"X-Client-Info":`gotrue-js/${Ox}`},Mu="X-Supabase-Api-Version",zx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Nk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Dk=600*1e3;class ud extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function se(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Fk extends ud{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Lk(t){return se(t)&&t.name==="AuthApiError"}class Nx extends ud{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class ss extends ud{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Dr extends ss{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Uk(t){return se(t)&&t.name==="AuthSessionMissingError"}class Uo extends ss{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ho extends ss{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $o extends ss{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Hk(t){return se(t)&&t.name==="AuthImplicitGrantRedirectError"}class hm extends ss{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Iu extends ss{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function rc(t){return se(t)&&t.name==="AuthRetryableFetchError"}class dm extends ss{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class ju extends ss{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Oa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fm=` 	
\r=`.split(""),$k=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<fm.length;e+=1)t[fm[e].charCodeAt(0)]=-2;for(let e=0;e<Oa.length;e+=1)t[Oa[e].charCodeAt(0)]=e;return t})();function pm(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Oa[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Oa[s]),e.queuedBits-=6}}function Dx(t,e,r){const s=$k[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function mm(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{Yk(o,s,r)};for(let o=0;o<t.length;o+=1)Dx(t.charCodeAt(o),n,i);return e.join("")}function Gk(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Wk(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Gk(s,e)}}function Yk(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Qk(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Dx(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Kk(t){const e=[];return Wk(t,r=>e.push(r)),new Uint8Array(e)}function Xk(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>pm(n,r,s)),pm(null,r,s),e.join("")}function Jk(t){return Math.round(Date.now()/1e3)+t}function Zk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Jt=()=>typeof window<"u"&&typeof document<"u",as={tested:!1,writable:!1},Fx=()=>{if(!Jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(as.tested)return as.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),as.tested=!0,as.writable=!0}catch{as.tested=!0,as.writable=!1}return as.writable};function e1(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Lx=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>gr(async()=>{const{default:s}=await Promise.resolve().then(()=>Ln);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},t1=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ln=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ls=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},zr=async(t,e)=>{await t.removeItem(e)};class al{constructor(){this.promise=new al.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}al.promiseConstructor=Promise;function sc(t){const e=t.split(".");if(e.length!==3)throw new ju("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Nk.test(e[s]))throw new ju("JWT not in base64url format");return{header:JSON.parse(mm(e[0])),payload:JSON.parse(mm(e[1])),signature:Qk(e[2]),raw:{header:e[0],payload:e[1]}}}async function r1(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function s1(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function n1(t){return("0"+t.toString(16)).substr(-2)}function i1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,n1).join("")}async function o1(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function a1(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await o1(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ks(t,e,r=!1){const s=i1();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await ln(t,`${e}-code-verifier`,n);const i=await a1(s);return[i,s===i?"plain":"s256"]}const l1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function c1(t){const e=t.headers.get(Mu);if(!e||!e.match(l1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function u1(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function h1(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const d1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Xs(t){if(!d1.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function nc(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var f1=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const ms=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),p1=[502,503,504];async function gm(t){var e;if(!t1(t))throw new Iu(ms(t),0);if(p1.includes(t.status))throw new Iu(ms(t),t.status);let r;try{r=await t.json()}catch(i){throw new Nx(ms(i),i)}let s;const n=c1(t);if(n&&n.getTime()>=zx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new dm(ms(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Dr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new dm(ms(r),t.status,r.weak_password.reasons);throw new Fk(ms(r),t.status||500,s)}const m1=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function de(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[Mu]||(i[Mu]=zx["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await g1(t,e,r+a,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function g1(t,e,r,s,n,i){const o=m1(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new Iu(ms(l),0)}if(a.ok||await gm(a),s?.noResolveJson)return a;try{return await a.json()}catch(l){await gm(l)}}function Vr(t){var e;let r=null;b1(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Jk(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function Am(t){const e=Vr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Lr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function A1(t){return{data:t,error:null}}function y1(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=f1(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function x1(t){return t}function b1(t){return t.access_token&&t.refresh_token&&t.expires_in}const ic=["global","local","others"];var w1=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class q1{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Lx(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=ic[0]){if(ic.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ic.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Lr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=w1(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:y1,redirectTo:r?.redirectTo})}catch(r){if(se(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Lr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:x1});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const A=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=A}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(se(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Xs(e);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Lr})}catch(r){if(se(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Xs(e);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Lr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Xs(e);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Lr})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Xs(e.userId);try{const{data:r,error:s}=await de(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(se(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Xs(e.userId),Xs(e.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}}function ym(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function v1(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Js={debug:!!(globalThis&&Fx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ux extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class V1 extends Ux{}async function _1(t,e,r){Js.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Js.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Js.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Js.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Js.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new V1(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Js.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}v1();const S1={url:Bk,storageKey:Ok,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function xm(t,e,r){return await r()}const Zs={};class Di{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Di.nextInstanceID,Di.nextInstanceID+=1,this.instanceID>0&&Jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},S1),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new q1({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Lx(n.fetch),this.lock=n.lock||xm,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Jt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=_1:this.lock=xm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Fx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ym(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=ym(this.memoryStorage)),Jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Zs[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Zs[this.storageKey]=Object.assign(Object.assign({},Zs[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Zs[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Zs[this.storageKey]=Object.assign(Object.assign({},Zs[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ox}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=e1(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),Jt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Hk(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return se(r)?{error:r}:{error:new Nx("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Vr}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Ks(this.storage,this.storageKey)),i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},xform:Vr})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Vr})}else throw new Ho("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(se(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Am})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Am})}else throw new Ho("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Uo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,l,c,u,h,d,f;let m,A;if("message"in e)m=e.message,A=e.signature;else{const{chain:g,wallet:y,statement:w,options:x}=e;let b;if(Jt())if(typeof y=="object")b=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))b=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const V=new URL((r=x?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const _=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),w?{statement:w}:null));let v;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")v=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)v=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in v&&"signature"in v&&(typeof v.signedMessage=="string"||v.signedMessage instanceof Uint8Array)&&v.signature instanceof Uint8Array)m=typeof v.signedMessage=="string"?v.signedMessage:new TextDecoder().decode(v.signedMessage),A=v.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${V.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(n=(s=x?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=x?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(v=>`- ${v}`)]:[]].join(`
`);const _=await b.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=_}}try{const{data:g,error:y}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Xk(A)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Vr});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Uo}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(se(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await ls(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Vr});if(await zr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Uo}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(se(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Vr}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Uo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ks(this.storage,this.storageKey));const{error:h}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Ho("You must provide either an email or phone number.")}catch(a){if(se(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Vr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(se(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ks(this.storage,this.storageKey)),await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:A1})}catch(i){if(se(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Dr;const{error:n}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(se(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await de(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await de(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new Ho("You must provide either an email or phone number and a type")}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ls(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<tc:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await ls(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=nc()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Lr}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dr}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Lr})})}catch(r){if(se(r))return Uk(r)&&(await this._removeSession(),await zr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Dr;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ks(this.storage,this.storageKey));const{data:c,error:u}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Lr});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(se(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dr;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=sc(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(se(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Dr;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Jt())throw new $o("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $o(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new hm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $o("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new hm("No code detected.");const{data:w,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new $o("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=an&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:A,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(se(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ls(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Lk(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await zr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Zk(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ks(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(se(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Jt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(se(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await s1(async n=>(n>0&&await r1(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Vr})),(n,i)=>{const o=200*Math.pow(2,n);return i&&rc(i)&&Date.now()+o-s<an})}catch(s){if(this._debug(r,"error",s),se(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Jt()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ls(this.storage,this.storageKey);if(n&&this.userStorage){let o=await ls(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await ln(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:nc()}else if(n&&!n.user&&!n.user){const o=await ls(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await zr(this.storage,this.storageKey+"-user"),await ln(this.storage,this.storageKey,n)):n.user=nc()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<tc;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${tc}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),rc(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Dr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new al;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Dr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),se(i)){const o={session:null,error:i};return rc(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await ln(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=structuredClone(n);await ln(this.storage,this.storageKey,i)}else{const n=structuredClone(r);await ln(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await zr(this.storage,this.storageKey),await zr(this.storage,this.storageKey+"-code-verifier"),await zr(this.storage,this.storageKey+"-user"),this.userStorage&&await zr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Jt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),an);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/an);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${an}ms, refresh threshold is ${Ru} ticks`),n<=Ru&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ux)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ks(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await de(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await de(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(se(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(se(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=e?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=sc(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+Dk>n)return s;const{data:i,error:o}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:m}=await this.getSession();if(m||!f.session)return{data:null,error:m};s=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=sc(s);r?.allowExpired||u1(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const u=h1(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Kk(`${a}.${l}`)))throw new ju("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}}Di.nextInstanceID=0;const k1=Di;class C1 extends k1{constructor(e){super(e)}}var P1=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class E1{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=Ik(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Sk,realtime:Ck,auth:Object.assign(Object.assign({},kk),{storageKey:c}),global:_k},h=jk(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Rk(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new YS(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new BS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new qk(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return P1(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new C1({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ck(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const T1=(t,e,r)=>new E1(t,e,r),hd=T1("https://pkswdnpftrundnewgnya.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrc3dkbnBmdHJ1bmRuZXdnbnlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODI2MzIsImV4cCI6MjA2ODI1ODYzMn0.r_Y1RLOGJ55C0De5SBTVXqO09SMDqgV38sQuE-oDxXE"),R1=async t=>{if(t.locator.campaignName===void 0)throw new Error("can not save a campaign without a name");const e=await hd.rpc("save_campaign_version",{p_name:t.locator.campaignName,p_data:await RS(t),p_published:t.meta?.published??!1});if(e.error)throw new Error(`error saving to db ${e.error.message} ${e.error.details}`,{cause:e.error});return e.data},M1=async t=>{const e=await hd.rpc("get_latest_campaign",{p_campaign_name:t.campaignName,p_user_id:t.userId,p_version:t.version===-1?void 0:t.version});if(e.error)throw new Error("could not get campaign",{cause:e.error});const r=await Vx(e.data.data);return Object.values(r.rooms).forEach(s=>{delete s.size}),r.locator===void 0&&(r.locator={userId:t.userId||"upgraded, unknown",campaignName:t.campaignName,version:e.data.version}),delete r.name,r},I1=async({publishedOnly:t})=>{const e=await hd.rpc("get_all_users_latest_campaigns",{p_published_only:t});if(e.error)throw new Error("could not get user campaigns",{cause:e.error});return e.data},Si=t=>{const e=[];for(let r=t;r!==void 0;r=r instanceof Error?r.cause:void 0)r instanceof Error&&e.push({message:r.message,stack:r.stack});return e},Bs=yS({reducerPath:"campaignsApi",baseQuery:Q_(),endpoints:t=>({getCampaign:t.query({async queryFn(e){try{return e.userId==="@@original"&&e.campaignName==="original"?{data:(await xS()).campaign}:e.campaignName.startsWith("data:")?{data:await Vx(e.campaignName.substring(5))}:{data:await M1(e)}}catch(r){return{error:Si(new Error(`getCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}}),getAllUsersLatestCampaigns:t.query({async queryFn({publishedOnly:e}){try{return{data:await I1({publishedOnly:e})}}catch(r){return{error:Si(new Error(`getAllUsersLatestCampaigns queryFn() failed: ${r}`))}}}}),saveCampaign:t.mutation({async queryFn(e){try{return{data:await R1(e)}}catch(r){return{error:Si(new Error(`saveCampaign queryFn( ${JSON.stringify(e)} ) failed: ${r}`))}}}})})}),{useGetAllUsersLatestCampaignsQuery:j1}=Bs,B1=Bs.endpoints.getCampaign.select,O1=(t,e)=>B1(e)(t).data,z1=8,Hx=({renderAreaSize:t,emulatedResolutionName:e,devicePixelRatio:r,deviceType:s=Pt()})=>{const n=Fn[e],{renderAreaSize:i,rotate90:o}=s!=="desktop"&&t.x<t.y?{renderAreaSize:{x:t.y,y:t.x},rotate90:!0}:{renderAreaSize:t,rotate90:!1},a=Xy(i,r),l=Math.max(Math.floor(Math.min(a.x/n.x,a.y/n.y)),1),c=Math.min(z1,l),u=l/c/r,h={x:Math.floor(a.x/l),y:Math.floor(a.y/l)},d={x:Math.ceil(i.x/u),y:Math.ceil(i.y/u)};return{gameEngineUpscale:c,cssUpscale:u,gameEngineScreenSize:h,canvasSize:d,rotate90:o}},N1=t=>Pt()==="server"?Fn.zxSpectrum:t?{x:t.clientWidth,y:t.clientHeight}:{x:window.innerWidth,y:window.innerHeight},dd=(t,e)=>{const r=Pt();return{renderAreaSize:N1(e),emulatedResolutionName:t,devicePixelRatio:r==="server"?1:window.devicePixelRatio}},D1={upscale:Hx(dd(ed.displaySettings.emulatedResolution))},za=Sr({name:"upscale",initialState:D1,reducers:{upscaleToWindow(t,{payload:e}){t.upscale=Hx(e)}},selectors:{selectCanvasSize(t){return t.upscale.canvasSize},selectGameEngineUpscale(t){return t.upscale.gameEngineUpscale},selectGameEngineScreenSize(t){return t.upscale.gameEngineScreenSize},selectRot90(t){return t.upscale.rotate90},selectUpscale(t){return t.upscale},selectTotalUpscale({upscale:{cssUpscale:t,gameEngineUpscale:e}}){return t*e}}}),{upscaleToWindow:$x}=za.actions,{selectCanvasSize:F1,selectRot90:L1,selectUpscale:U1,selectGameEngineUpscale:LF,selectTotalUpscale:H1,selectGameEngineScreenSize:UF}=za.selectors,Rt=t=>e=>Ia(e.gameMenus.userSettings,t)??Ia(ed,t),po=()=>ie(H1),Na=Rt("inputAssignment"),HF=t=>t.gameMenus.openMenus.length>0,$1=()=>ie(t=>t.gameMenus.cheatsOn),Gx=t=>t.gameMenus.assigningInput!==void 0,Wx=()=>ie(Gx),G1=t=>{for(const[e,r]of Ke(lx(vn)))if(O_(r.inputAssignment,t.gameMenus.userSettings.inputAssignment))return e},_n=()=>ie(t=>t.gameMenus.gameRunning),W1=Rt("showFps"),ll=Rt("displaySettings.emulatedResolution"),fd=Rt("gameSpeed"),Y1=()=>ie(ll),Q1=Rt("displaySettings.uncolourised"),pd=()=>ie(Q1),Yx=Rt("infiniteLivesPoke"),Qx=Rt("infiniteDoughnutsPoke"),$F=t=>t.gameMenus.gameInPlay.planetsLiberated.egyptus&&t.gameMenus.gameInPlay.planetsLiberated.bookworld&&t.gameMenus.gameInPlay.planetsLiberated.penitentiary&&t.gameMenus.gameInPlay.planetsLiberated.safari,md=()=>ie(t=>t.gameMenus.userSettings.screenRelativeControl),gd=Rt("inputDirectionMode"),Kx=()=>ie(gd),K1=t=>qu(Ke(Or(t.gameMenus.gameInPlay.planetsLiberated)).filter(Boolean)),X1=Rt("displaySettings.showBoundingBoxes"),GF=()=>ie(X1),J1=Rt("displaySettings.showShadowMasks"),WF=()=>ie(J1),Z1=Rt("screenRelativeControl"),eC=Rt("onScreenControls"),tC=Rt("soundSettings.mute"),rC=Rt("soundSettings.noFootsteps"),YF=({gameMenus:t,upscale:e})=>(t.userSettings.onScreenControls??ed.onScreenControls)&&e.upscale.rotate90===!1,sC=()=>ie(eC),QF=(t,e)=>!!Ia(t.gameMenus,e),nC=()=>ie(t=>t.gameMenus.gameInPlay.roomsExplored),Xx=t=>{const e=iC(t);if(!e)throw new Error(`No current campaign. Campaign locator is:
${JSON.stringify(t.gameMenus.gameInPlay.campaignLocator,null,2)}`);return e},Jx=hx(Xx),iC=t=>{const e=t.gameMenus.gameInPlay.campaignLocator;return e===void 0?void 0:O1(t,e)},Bu=[1,1.2,1.5,2],KF=["none","non-wall","all"],si=t=>t0(Oi(t,"userId","campaignName")),Zx=["4-way","8-way","analogue"],oC=Pt()!=="server",aC=oC?$r().has("cheats"):!1,lC={blacktooth:!1,bookworld:!1,egyptus:!1,penitentiary:!1,safari:!1},Ou={planetsLiberated:lC,roomsExplored:{},scrollsRead:{},reincarnationPoint:void 0},zu={userSettings:{displaySettings:{},soundSettings:navigator.webdriver?{mute:!0}:{}},gameRunning:!1,gameInPlay:Ou,openMenus:[{menuId:"mainMenu",scrollableSelection:!1,menuParam:Ae}],assigningInput:void 0,cheatsOn:aC,savedGames:{saves:{}}},mo=Sr({name:"gameMenus",initialState:zu,reducers:{setEmulatedResolution(t,{payload:e}){let r;e===void 0?r=Yl(R_,ll({gameMenus:t})):r=e,t.userSettings.displaySettings.emulatedResolution=r},setGameSpeed(t,{payload:e}){let r;e===void 0?r=Yl(Bu,fd({gameMenus:t})):r=e,t.userSettings.gameSpeed=r},scrollRead(t,{payload:e}){e.source==="manual"?(t.gameInPlay.scrollsRead[e.page]=!0,t.openMenus=[{menuId:`markdown/${e.page}`,scrollableSelection:!1,menuParam:Ae}]):t.openMenus=[{menuId:"markdown/inline",scrollableSelection:!1,menuParam:{markdown:e.markdown}}]},nextInputDirectionMode(t){t.userSettings.inputDirectionMode=Yl(Zx,gd({gameMenus:t}))},inputAddedDuringAssignment(t,{payload:e}){if(t.assigningInput===void 0)throw new Error("reducer called while not assigning keys");const r=(o,a)=>{o.includes(a)||o.push(a)},{presses:s,axes:n,action:i}=t.assigningInput;switch(e.type){case"key":r(s.keys,e.input);break;case"gamepadButtons":r(s.gamepadButtons,e.input);break;case"gamepadAxes":{fn.includes(i)&&r(n,e.input);break}}},doneAssigningInput(t){if(t.assigningInput===void 0)throw new Error("illegal action for state");const{action:e,presses:r,axes:s}=t.assigningInput,n=r.keys.length+r.gamepadButtons.length+s.length,i=t.userSettings.inputAssignment===void 0?t.userSettings.inputAssignment=structuredClone(vn.default.inputAssignment):t.userSettings.inputAssignment;n>0&&(i.presses[e]=r,(e==="left"||e==="right")&&(i.axes.x=s),(e==="towards"||e==="away")&&(i.axes.y=s)),t.assigningInput=void 0},menuOpenOrExitPressed(t){if(t.openMenus.length>0){if(t.openMenus.length===1&&!t.gameRunning)return;const[,...e]=t.openMenus;t.openMenus=e}else t.openMenus=[{menuId:"mainMenu",scrollableSelection:!1,menuParam:Ae}]},goToSubmenu(t,{payload:e}){t.openMenus=[{menuId:e,scrollableSelection:!1,menuParam:{}},...t.openMenus]},closeAllMenus(t){t.openMenus=[]},gameStarted(t,{payload:{campaignLocator:e,noShowCrowns:r}}){if(t.gameRunning)throw new Error("game is already running");t.openMenus=r?[]:[{menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!1}}],t.gameRunning=!0,t.gameInPlay={...Ou,campaignLocator:e}},backToParentMenu(t){const[,...e]=t.openMenus;t.openMenus=e},assignInputStart(t,{payload:e}){t.assigningInput={action:e,presses:{gamepadButtons:[],keys:[]},axes:[]}},keyAssignmentPresetChosen(t,{payload:e}){const[,...r]=t.openMenus;t.openMenus=r,t.userSettings.inputAssignment=vn[e].inputAssignment},setFocussedMenuItemId(t,{payload:{focussedItemId:e,scrollableSelection:r}}){const[s]=t.openMenus;s.focussedItemId=e,s.scrollableSelection=r},holdPressed(t,{payload:e}){t.openMenus.length>0?t.openMenus[0]?.menuId==="hold"&&e!=="hold"&&(t.openMenus=[]):e!=="unhold"&&(t.openMenus=[{menuId:"hold",scrollableSelection:!1,menuParam:Ae}])},mapPressed(t){t.openMenus.length>0?t.openMenus[0]?.menuId==="map"&&(t.openMenus=[]):t.openMenus=[{menuId:"map",scrollableSelection:!1,menuParam:Ae}]},setShowBoundingBoxes(t,{payload:e}){t.userSettings.displaySettings.showBoundingBoxes=e},setShowShadowMasks(t,{payload:e}){t.userSettings.displaySettings.showShadowMasks=e},toggleBoolean(t,{payload:e}){I_(t,e,!Ia(t,e))},crownCollected(t,{payload:e}){t.gameInPlay.planetsLiberated[e]=!0;const r=Object.values(t.gameInPlay.planetsLiberated).every(n=>n),s={menuId:"crowns",scrollableSelection:!1,menuParam:{playMusic:!0}};r?t.openMenus=[{menuId:"proclaimEmperor",scrollableSelection:!1,menuParam:Ae},s]:t.openMenus=[s]},roomExplored(t,{payload:e}){t.gameInPlay.roomsExplored[e]=!0},gameOver(t,{payload:{offerReincarnation:e}}){if(e&&t.gameInPlay.reincarnationPoint!==void 0)t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:Ae},{menuId:"offerReincarnation",scrollableSelection:!1,menuParam:Ae}];else{t.gameRunning=!1,delete t.gameInPlay.reincarnationPoint;const r=t.gameInPlay.campaignLocator,s=r&&si(r);console.log(gu(t.savedGames)),s&&(delete t.savedGames.saves[s],delete t.savedGames.lastSavedCampaignLocator),console.log(gu(t.savedGames)),t.openMenus=[{menuId:"score",scrollableSelection:!1,menuParam:Ae},{menuId:"mainMenu",scrollableSelection:!0,menuParam:Ae}]}},reincarnationFishEaten(t,{payload:e}){t.gameInPlay.reincarnationPoint=e},reincarnationAccepted(t){delete t.gameInPlay.reincarnationPoint,t.openMenus=[{menuId:"reincarnatedRestart",scrollableSelection:!1,menuParam:Ae}]},saveGame(t,{payload:e}){const r=t.gameInPlay.campaignLocator;if(r===void 0)throw new Error("trying to save a game, but seems like there's no campaign to save against");if(Jh())throw new Error("shouldn't be saving in playtest mode");t.savedGames.saves[si(r)]=e,t.savedGames.lastSavedCampaignLocator=r},gameRestoreFromSave(t,{payload:e}){t.gameInPlay=e},errorCaught(t,{payload:e}){t.openMenus=[{menuId:"errorCaught",scrollableSelection:!1,menuParam:e}]},errorDismissed(t,{payload:e}){switch(e){case"ignore":t.openMenus=[];break;case"clearAllData":Object.assign(t,zu),t.gameRunning=!1;break}},debugItemClicked(t,e){},characterRoomChange(t,e){},lostLife(t,e){}},extraReducers(t){t.addCase(lo,(e,r)=>{if($r().get("campaignName")?.startsWith("data:"))return;const s=[{menuId:"hold",scrollableSelection:!1,menuParam:Ae}],n={userId:$r().get("campaignAuthorUserId")??void 0,campaignName:$r().get("campaignName")??void 0},i=r.payload?.savedGames;if((c=>c.userId!==void 0&&c.campaignName!==void 0)(n)){e.gameRunning=!0;const c=i?.saves[si(n)];if(c){e.gameRunning=!0,e.gameInPlay=c.store.gameMenus.gameInPlay,e.openMenus=s;return}else{e.gameRunning=!0,e.gameInPlay={...Ou,campaignLocator:n},e.openMenus=s;return}}const a=i?.lastSavedCampaignLocator,l=a&&i.saves[si(a)];l&&(e.gameRunning=!0,e.gameInPlay=l.store.gameMenus.gameInPlay,e.openMenus=s)})},selectors:{selectHasError(t){return t.openMenus.some(e=>e.menuId==="errorCaught")},selectSaveForCampaign(t,e){return t.savedGames.saves[si(e)]}}}),{assignInputStart:$e,backToParentMenu:Le,characterRoomChange:cC,closeAllMenus:uC,crownCollected:hC,debugItemClicked:dC,doneAssigningInput:fC,errorCaught:Ad,errorDismissed:bm,gameOver:yd,gameRestoreFromSave:XF,gameStarted:Fi,goToSubmenu:bt,holdPressed:eb,inputAddedDuringAssignment:pC,keyAssignmentPresetChosen:mC,lostLife:gC,mapPressed:AC,menuOpenOrExitPressed:wm,nextInputDirectionMode:yC,reincarnationAccepted:xd,reincarnationFishEaten:JF,roomExplored:xC,saveGame:bC,scrollRead:ZF,setEmulatedResolution:bd,setFocussedMenuItemId:wd,setGameSpeed:wC,setShowBoundingBoxes:eL,setShowShadowMasks:tL,toggleBoolean:ur}=mo.actions,{selectHasError:rL}=mo.selectors,sL=mo.selectors.selectSaveForCampaign,tb=t=>e=>(t(e),null),qC=pr(yd,xd,gC,Ad,Fi,hC),vC=()=>{const t=Dh();S.useEffect(()=>Gy({matcher:qC,effect(r,{getState:s}){const n=t?.gameState,[,i]=r.type.split("/"),o=s(),a=n?Math.round(n.gameTime/1e3):void 0,l=r.payload===void 0?{}:r.type==="gameMenus/crownCollected"?{crownForPlanet:r.payload}:r.type==="gameMenus/gameStarted"?void 0:r.type==="gameMenus/lostLife"?{position:r.payload.characterLosingLifeItem.state.position}:r.payload,c={gameTimeSeconds:a,...o.gameMenus.gameInPlay,cheatsOn:o.gameMenus.cheatsOn,...l,currentCharacter:n?.currentCharacterName,inRoom:n?.characterRooms[n.currentCharacterName]};window.umami?(console.debug(" umami event:",i,c),window.umami.track(i,c)):console.debug(" no umami for event:",i,c)}}),[t])},VC=tb(vC),_C=so(()=>gr(()=>import("./Cheats-hMgSfktQ.js"),__vite__mapDeps([3,1,2,4]))),en=(t,e,r)=>{const s=({x:i,y:o,w:a,h:l,pivot:c})=>e==="x"?{...Wr(r,{x:-i-a-1,y:o}),w:a,h:l,pivot:{x:a-c.x,y:c.y}}:{...Wr(r,{x:i+2,y:o}),w:a,h:l,pivot:c};function*n(){yield[`door.frame.${t}.${e}.whole`,{frame:{...s({x:-41,y:0,w:40,h:64,pivot:{x:9,y:63}})}}],yield[`door.frame.${t}.${e}.far`,{frame:{...s({x:-18,y:0,w:17,h:57,pivot:{x:9,y:52}})}}],yield[`door.frame.${t}.${e}.near`,{frame:{...s({x:-41,y:6,w:20,h:58,pivot:{x:8,y:58}})}}],yield[`door.frame.${t}.${e}.top`,{frame:{...s({x:-57,y:-1,w:15,h:36,pivot:{x:0,y:36.5}})}}]}return Nn(n())},SC={frames:{...en("generic","y",{x:580,y:415}),...en("generic","x",{x:582,y:415}),...en("moonbase","y",{x:752,y:232}),...en("moonbase","x",{x:915,y:232}),...en("moonbase.dark","y",{x:752,y:306}),...en("moonbase.dark","x",{x:915,y:306})}},cs=(t,{x:e,y:r},s)=>{function*n(){yield[`${t}.left`,{frame:{x:e,y:r,...s}}],yield[`${t}.away`,{frame:{x:e+s.w+1,y:r,...s}}],yield[`${t}.towards`,{frame:{x:e,y:r+s.h+1,...s}}],yield[`${t}.right`,{frame:{x:e+s.w+1,y:r+s.h+1,...s}}]}return Object.fromEntries(n())},Me=(t,e,{x:r,y:s},n,i=e)=>{function*o(){for(let a=0;a<e;a++)yield[`${t}.${a+1}`,{frame:{x:r+a%i*(n.w+1),y:s+Math.floor(a/i)*(n.h+1),...n}}]}return Object.fromEntries(o())},qm=(t,{x:e,y:r},s,n=t.length,i)=>{function*o(){for(let a=0;a<t.length;a++)yield[i?`${i}.${t[a]}`:t[a],{frame:{x:e+a%n*(s.w+1),y:r+Math.floor(a/n)*(s.h+1),...s}}]}return Object.fromEntries(o())},kC=(t,e,r,s)=>({...Me(`${t}.left`,e,r,s),...Me(`${t}.away`,e,Wr(r,{x:(s.w+1)*e}),s),...Me(`${t}.towards`,e,Wr(r,{y:s.h+1}),s),...Me(`${t}.right`,e,Wr(r,{x:(s.w+1)*e,y:s.h+1}),s)}),pi=(t,e)=>[...Ke(ax(1,e+1)).map(r=>`${t}.${String(r)}`)],CC={frames:{...qm(["share","save","pointer","eyedropper"],{x:588,y:0},{w:12,h:12},void 0,"editor.tool"),...qm(["single","corridor","double","triple.line","triple.^","quad.square","quad.s","quad.31","quad.t","5.x"],{x:640,y:0},{w:9,h:9},void 0,"editor.addRoom")}},PC={" ":"space","'":"singleQuote",":":"colon","<":"lt",">":"gt","`":"backtick"},rb=t=>PC[t]??t,Nu={w:32,h:16},Ot={w:16,h:56},he={w:32,h:28},G={w:24,h:24},Aa={w:8,h:8},W=t=>({x:t.x*(G.w+1)+1,y:t.y*(G.h+1)+2}),fe=t=>({x:t.x*(he.w+1)+1,y:t.y*(he.h+1)+396}),sb="",nb="",EC="",TC="",RC="",MC="",IC=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","#","","","","",{char:"",double:!0},{char:sb,double:!0},{char:nb,double:!0}],jC=[" ","?","!",".",",",";",":","/","\\","","","'","`","-","+","%","","","","","","","","","(",")","[","]","<",">","","","","EnterFullscreen","ExitFullscreen","Menu","*","@","",EC,TC,RC,MC,"","","^","","",""],vm=(t,e)=>{function*r(){let{x:s}=e;for(let n=0;n<t.length;n++){const i=t[n],o=typeof i=="string"?i:i.char,l=(typeof i=="string"?!1:i.double)?Aa.w*2:Aa.w;yield[`hud.char.${rb(o)}`,{frame:{x:s,y:e.y,...Aa,w:l}}],s+=l+1}}return Nn(r())},BC={frames:{...vm(IC,{x:126,y:1}),...vm(jC,{x:126,y:10})}},ge=(t,e)=>Object.assign([...t],{animationSpeed:e}),OC={...Me("dalek",2,W({x:0,y:0}),G),"shadowMask.dalek":{frame:{...W({x:2,y:0}),...G}},...Me("bubbles.cold",2,W({x:3,y:0}),G),...cs("cyberman",W({x:1,y:1}),G),...cs("charles",W({x:3,y:1}),G),"shadowMask.charles.away":{frame:{...W({x:5,y:1}),...G}},"shadowMask.charles.right":{frame:{...W({x:5,y:2}),...G}},...cs("elephant",W({x:6,y:1}),G),"crown.blacktooth":{frame:{...W({x:8,y:1}),...G}},"crown.safari":{frame:{...W({x:9,y:1}),...G}},"crown.egyptus":{frame:{...W({x:10,y:1}),...G}},"crown.penitentiary":{frame:{...W({x:11,y:1}),...G}},"crown.bookworld":{frame:{...W({x:12,y:1}),...G}},ball:{frame:{...W({x:13,y:1}),...G}},"shadowMask.ball":{frame:{...W({x:14,y:1}),...G}},sticks:{frame:{...W({x:8,y:2}),...G}},cube:{frame:{...W({x:9,y:2}),...G}},drum:{frame:{...W({x:10,y:2}),...G}},hooter:{frame:{...W({x:11,y:2}),...G}},bag:{frame:{...W({x:12,y:2}),...G}},joystick:{frame:{...W({x:13,y:2}),...G}},"shadowMask.joystick":{frame:{...W({x:14,y:2}),...G}},...kC("turtle",2,W({x:0,y:3}),G),"shadowMask.turtle.away":{frame:{...W({x:4,y:3}),...G}},"shadowMask.turtle.right":{frame:{...W({x:4,y:4}),...G}},...cs("monkey",W({x:5,y:3}),G),...cs("computerBot",W({x:7,y:3}),G),"spring.compressed":{frame:{...W({x:9,y:3}),...G}},"spring.released":{frame:{...W({x:10,y:3}),...G}},"switch.left":{frame:{...W({x:11,y:3}),...G}},"switch.right":{frame:{...W({x:12,y:3}),...G}},"shadowMask.switch":{frame:{...W({x:13,y:3}),...G}},tower:{frame:{...W({x:14,y:3}),...G}},"shadowMask.tower":{frame:{...W({x:15,y:3}),...G}},scroll:{frame:{...W({x:9,y:4}),...G,pivot:{x:17,y:24}}},"shadow.scroll":{frame:{...W({x:10,y:4}),...G,pivot:{x:17,y:24}}},"shadowMask.scroll":{frame:{...W({x:11,y:4}),...G,pivot:{x:17,y:24}}},"spikyBall.1":{frame:{...W({x:12,y:4}),...G}},"spikyBall.2":{frame:{...W({x:13,y:4}),...G}},puck:{frame:{...W({x:14,y:4}),...G}},"shadow.smallRound":{frame:{...W({x:15,y:4}),...G}},"shadowMask.smallRound":{frame:{...W({x:16,y:4}),...G}},...Me("helicopterBug",4,W({x:0,y:5}),G),"barrier.x":{frame:{...W({x:4,y:5}),...G,pivot:{x:18,y:23}}},"barrier.y":{frame:{...W({x:5,y:5}),...G,pivot:{x:6,y:23}}},"shadow.barrier.y":{frame:{...W({x:6,y:5}),...G,pivot:{x:6,y:22}}},"shadowMask.barrier.y":{frame:{...W({x:7,y:5}),...G,pivot:{x:6,y:22}}},...Me("bubbles.taupe",3,W({x:8,y:5}),G),whiteRabbit:{frame:{...W({x:11,y:5}),...G}},"shadowMask.whiteRabbit":{frame:{...W({x:12,y:5}),...G}},...Me("bubbles.white",3,W({x:13,y:5}),G),...Me("fish",2,W({x:12,y:6}),G),doughnuts:{frame:{...W({x:14,y:6}),...G}},"shadowMask.doughnuts":{frame:{...W({x:15,y:6}),...G}},"lift.static":{frame:{...W({x:10,y:7}),...G}},"shadow.smallBlock":{frame:{...W({x:11,y:7}),...G}},"shadowMask.smallBlock":{frame:{...W({x:12,y:7}),...G}},buttonInGame:{frame:{...W({x:13,y:7}),...G}},"buttonInGame.pressed":{frame:{...W({x:14,y:7}),...G}},"shadowMask.buttonInGame":{frame:{...W({x:15,y:7}),...G}},...Me("lift",4,W({x:10,y:8}),G),headlessBase:{frame:{...W({x:14,y:8}),...G}},...Me("headlessBase",4,W({x:10,y:9}),G),"headlessBase.all":{frame:{...W({x:14,y:9}),...G}},...cs("skiHead.greenAndPink",{x:251,y:252},{w:24,h:32}),...cs("skiHead.starsAndStripes",{x:301,y:252},{w:24,h:32}),"shadowMask.skiHead.away":{frame:{x:351,y:252,w:24,h:32}},"shadowMask.skiHead.right":{frame:{x:351,y:285,w:24,h:32}},"editor.cursor.xz":{frame:{...fe({x:7,y:-2}),...he}},"editor.cursor.floor":{frame:{...fe({x:7,y:-1}),...he}},"block.organic":{frame:{...fe({x:0,y:0}),...he}},"block.organic.disappearing":{frame:{...fe({x:1,y:0}),...he}},"block.organic.dark":{frame:{...fe({x:2,y:0}),...he}},"block.organic.dark.disappearing":{frame:{...fe({x:3,y:0}),...he}},"block.artificial":{frame:{...fe({x:4,y:0}),...he}},"block.artificial.disappearing":{frame:{...fe({x:5,y:0}),...he}},"book.x":{frame:{...fe({x:6,y:0}),...he}},"book.y":{frame:{...fe({x:7,y:0}),...he}},"shadow.fullBlock":{frame:{...fe({x:8,y:0}),...he}},"shadowMask.fullBlock":{frame:{...fe({x:9,y:0}),...he}},stepStool:{frame:{...fe({x:0,y:1}),...he}},"shadowMask.stepStool":{frame:{...fe({x:1,y:1}),...he}},"volcano.1":{frame:{...fe({x:2,y:1}),...he}},"volcano.2":{frame:{...fe({x:3,y:1}),...he}},"shadowMask.volcano":{frame:{...fe({x:4,y:1}),...he}},hushPuppy:{frame:{...fe({x:5,y:1}),...he}},"shadowMask.hushPuppy":{frame:{...fe({x:6,y:1}),...he}},"toaster.on":{frame:{...fe({x:7,y:1}),...he}},"toaster.off":{frame:{...fe({x:8,y:1}),...he}},"shadowMask.toaster":{frame:{...fe({x:9,y:1}),...he}},sandwich:{frame:{...fe({x:10,y:1}),...he}},spikes:{frame:{...fe({x:11,y:1}),...he}},"shadowMask.spikes":{frame:{...fe({x:12,y:1}),...he}},...Me("conveyor.x",7,fe({x:0,y:2}),he),"shadowMask.conveyor":{frame:{...fe({x:7,y:2}),...he}},button:{frame:{...fe({x:9,y:2}),...he}},"button.pressed":{frame:{...fe({x:10,y:2}),...he}},"button.surfaceMask":{frame:{...fe({x:11,y:2}),...he}},...Me("conveyor.y",7,fe({x:0,y:3}),he),teleporter:{frame:{...fe({x:7,y:3}),...he}},...Me("teleporter.flashing",2,fe({x:8,y:3}),he),"shadowMask.teleporter":{frame:{...fe({x:10,y:3}),...he}},"shadowMask.teleporter.flashing":{frame:{...fe({x:11,y:3}),...he}},...Me("particle",4,{x:331,y:396},{w:9,h:11})},ib={frames:OC,animations:{"teleporter.flashing":ge(["teleporter.flashing.1","teleporter.flashing.2"],.5),fish:ge(["fish.1","fish.2"],.25),lift:ge(["lift.1","lift.2","lift.3","lift.4"],.5),dalek:ge(["dalek.1","dalek.2"],.5),"turtle.left":ge(["turtle.left.1","turtle.left.2"],.25),"turtle.away":ge(["turtle.away.1","turtle.away.2"],.25),"turtle.towards":ge(["turtle.towards.1","turtle.towards.2"],.25),"turtle.right":ge(["turtle.right.1","turtle.right.2"],.25),helicopterBug:ge(["helicopterBug.1","helicopterBug.2","helicopterBug.3","helicopterBug.4"],.5),"bubbles.cold":ge(["bubbles.cold.1","bubbles.cold.2"],.25),"bubbles.white":ge(["bubbles.white.1","bubbles.white.2","bubbles.white.3"],.5),"bubbles.bounce.white":ge(["bubbles.white.1","bubbles.white.2","bubbles.white.3","bubbles.white.2"],.5),"bubbles.doughnut":ge(["bubbles.taupe.1","bubbles.taupe.2"],.5),"conveyor.x":ge(pi("conveyor.x",7),.5),"conveyor.y":ge(pi("conveyor.y",7),.5),volcano:ge(pi("volcano",2),3/16),"spring.bounce":ge(["spring.released","spring.compressed","spring.released","spring.compressed","spring.released"],.5),"headlessBase.scan":ge(["headlessBase.4","headlessBase","headlessBase.3","headlessBase","headlessBase.2","headlessBase","headlessBase.1","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase","headlessBase.all","headlessBase","headlessBase","headlessBase","headlessBase"],.25),"headlessBase.flash":ge(["headlessBase.all","headlessBase"],.5),switch:ge(["switch.left","switch.right"],.02),"particle.fade":ge(pi("particle",4),.5)}},zC=.5,ob=5e3,NC=ob*2,ni=(t,e)=>{const r=Math.round(ob/(ho*4)),s=`head.walking.${t}.${e}`,n=`head.blinking.${t}`,i=[...new Array(r-3).fill(s),n,s,n];return ge(i,.5)},oc=(t,e)=>{const r=Math.round(NC/(ho*4)),s=`heels.walking.${t}.${e}`,n=`heels.blinking.${t}`,i=[...new Array(Math.floor(r*.8)).fill(s),...new Array(Math.ceil(r*.2)).fill(n)];return ge(i,.5)},Vm=(t,e,r)=>{const s=["awayLeft","away","awayRight","right","towardsRight","towards","towardsLeft","left"];function*n(){for(let i=0;i<qn.length;i++){const o=s[i];for(let a=0;a<=2;a++)yield[`${t}.walking.${o}.${a+1}`,{frame:{...W({x:e.x+a,y:e.y+i}),...G}}];yield[`${t}.falling.${o}`,{frame:{...W({x:e.x+3,y:e.y+i}),...G}}],r[o]?.noBlinking||(yield[`${t}.blinking.${o}`,{frame:{...W({x:e.x+4,y:e.y+i}),...G}}])}}return Object.fromEntries(n())};function _m(t){function*e(r,s){yield`${r}.walking.${s}.1`,yield`${r}.walking.${s}.2`,yield`${r}.walking.${s}.3`,yield`${r}.walking.${s}.2`}return qn.reduce((r,s)=>({...r,[`${t}.walking.${s}`]:ge([...e(t,s)],zC)}),{})}const DC={...Me("bubbles.head",6,W({x:0,y:6}),G),...Vm("head",{x:0,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},left:{noBlinking:!0}}),...Me("bubbles.heels",6,W({x:6,y:6}),G),...Vm("heels",{x:5,y:7},{awayLeft:{noBlinking:!0},away:{noBlinking:!0},awayRight:{noBlinking:!0},towardsLeft:{noBlinking:!0},left:{noBlinking:!0}}),...Me("shine",6,fe({x:8,y:-2}),he,3),blank:{frame:{...W({x:0,y:2}),...G}}},ab={frames:DC,animations:{..._m("head"),..._m("heels"),"heels.screenDirections":ge(["heels.walking.towardsRight.2","heels.walking.towardsLeft.2","heels.walking.awayLeft.2","heels.walking.awayRight.2"],1/16),"heels.worldDirections":ge(["heels.walking.towards.2","heels.walking.left.2","heels.walking.away.2","heels.walking.right.2"],1/16),"head.idle.right":ni("right",3),"head.idle.towards":ni("towards",3),"head.idle.towardsRight":ni("towardsRight",2),"head.idle.towardsLeft":ni("towardsLeft",2),"head.idle.awayRight":ni("awayRight",2),"heels.idle.right":oc("right",2),"heels.idle.towards":oc("towards",2),"heels.idle.towardsRight":oc("towardsRight",2),"head.fadeOut":ge(["bubbles.head.1","bubbles.head.2","bubbles.head.4","bubbles.head.3","bubbles.head.4","bubbles.head.6","bubbles.head.5","bubbles.head.6","bubbles.head.5"],.5),"heels.fadeOut":ge(["bubbles.heels.1","bubbles.heels.2","bubbles.heels.4","bubbles.heels.3","bubbles.heels.4","bubbles.heels.6","bubbles.heels.5","bubbles.heels.6","bubbles.heels.5"],.5),shine:ge(pi("shine",6),.5),"shine.headInSymbio":ge(["shine.1","shine.2","shine.3","blank","blank","blank","blank","blank","blank","shine.4","shine.5","shine.6"],.5),"shine.heelsInSymbio":ge(["blank","blank","blank","shine.1","shine.2","shine.3","shine.4","shine.5","shine.6","blank","blank","blank"],.5)}},FC={jail:["bars"],blacktooth:["plain","shield","armour"],bookworld:["book","cowboy"],egyptus:["hieroglyphics","sarcophagus"],market:["more-fruits","fruits","passage"],moonbase:["coil","window3","window2","window1","window-clear"],penitentiary:["skeleton","loop"],safari:["wall","shield","window"]},nL=["blacktooth","penitentiary","bookworld","egyptus","safari"],ct=(t,e,r,s)=>{function*n(i,o,a){const l=FC[i],{w:c,h:u}=Ot,h=c>>1;for(let d=0;d<l.length;d++)yield[`${i}${s}.wall.${l[d]}.left`,{frame:{x:o-c*(d+1),y:a+h*d,...Ot}}],yield[`${i}${s}.wall.${l[d]}.away`,{frame:{x:o+c*d,y:a+h*d,...Ot}}];yield[`${i}${s}.floor`,{frame:{x:o-c,y:a+u,...Nu}}]}return Object.fromEntries(n(t,e,r))},Sm={w:16,h:13},km={w:8,h:9},or=74;let ut=53;const LC={...ct("egyptus",834,ut,""),...ct("egyptus",834,ut+=or,".dark"),...ct("moonbase",834,ut+=or,""),...ct("moonbase",834,ut+=or,".dark"),...ct("bookworld",834,ut+=or,""),...ct("bookworld",834,ut,".dark"),...ct("jail",834,ut+=or,""),...ct("jail",834,ut,".dark"),...ct("blacktooth",834,ut+=or,""),...ct("blacktooth",834,ut+=or,".dark"),...ct("penitentiary",834,ut+=or,""),...ct("penitentiary",834,ut,".dark"),...ct("market",834,ut+=or,""),...ct("market",834,ut,".dark"),...ct("safari",834,ut+=or,""),...ct("safari",834,ut,".dark"),"floorEdge.right":{frame:{x:418,y:466,...Sm,pivot:{x:0,y:4}}},"floorEdge.towards":{frame:{x:401,y:466,...Sm,pivot:{x:15,y:4}}},"floorEdge.half.right":{frame:{x:418,y:470,...km,pivot:{x:0,y:0}}},"floorEdge.half.towards":{frame:{x:401,y:466,...km,pivot:{x:7,y:0}}},"floorOverdraw.cornerNearWall":{frame:{x:623,y:452,w:Ot.w,h:8}},"shadow.wall.y":{frame:{x:432,y:435,w:36,h:16}},"generic.floor.deadly":{frame:{x:786,y:462,...Nu}},"generic.dark.floor.deadly":{frame:{x:786,y:479,...Nu}},"generic.door.legs.pillar.y":{frame:{x:508,y:476,w:Ot.w,h:12}},"generic.door.legs.base.y":{frame:{x:508,y:488,w:Ot.w,h:9}},"generic.door.legs.pillar.x":{frame:{x:524,y:476,w:Ot.w,h:12}},"generic.door.legs.base.x":{frame:{x:524,y:488,w:Ot.w,h:9}},"generic.door.legs.threshold.double.x":{frame:{x:508,y:452,w:Ot.w*2,h:24}},"generic.door.legs.threshold.double.y":{frame:{x:469,y:452,w:Ot.w*2,h:24}},"shadowMask.door.legs.threshold.double.y":{frame:{x:469,y:430,w:Ot.w*2,h:21,pivot:{x:0,y:21}}},"generic.door.floatingThreshold.x":{frame:{x:457,y:492,w:26,h:19,pivot:{x:18,y:12}}},"generic.door.floatingThreshold.y":{frame:{x:430,y:492,w:26,h:19,pivot:{x:8,y:12}}},"shadowMask.door.floatingThreshold.double.y":{frame:{x:541,y:480,w:42,h:21,pivot:{x:8,y:20}}},"shadow.door.floatingThreshold.double.y":{frame:{x:584,y:480,w:42,h:21,pivot:{x:8,y:20}}},...Me("moonbase.wall.screen.window1.away",3,{x:883,y:217},{w:10,h:7}),...Me("moonbase.wall.screen.window2.away",2,{x:867,y:209},{w:10,h:7}),...Me("moonbase.wall.screen.window3.away",4,{x:851,y:201},{w:10,h:7})},lb={frames:LC,animations:{"moonbase.wall.screen.window1.away":ge(["moonbase.wall.screen.window1.away.1","moonbase.wall.screen.window1.away.2","moonbase.wall.screen.window1.away.3"],1/16),"moonbase.wall.screen.window2.away":ge(["moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.1","moonbase.wall.screen.window2.away.2"],1/16),"moonbase.wall.screen.window3.away":ge(["moonbase.wall.screen.window3.away.1","moonbase.wall.screen.window3.away.2","moonbase.wall.screen.window3.away.3","moonbase.wall.screen.window3.away.4","moonbase.wall.screen.window3.away.4"],1/16)}},UC={...ib.frames,...ab.frames,...lb.frames,...BC.frames,...SC.frames,...CC.frames},Nt={frames:UC,animations:{...ab.animations,...ib.animations,...lb.animations},meta:{scale:1}};function iL(t){if(!Du(t))throw new Error(`Invalid textureId: "${t}"; textureId  {${Object.keys(Nt.frames).sort().map(e=>`"${e}"`).join(`,
`)}}`)}function Du(t){return Nt.frames[t]!==void 0}function oL(t){return Nt.animations[t]!==void 0}var ee=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(ee||{});const Fu=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Go=(t,e)=>Fu(t).priority??e,Et={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Fu).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(Fu).forEach(e=>{e.type.forEach(r=>{const s=this._addHandlers,n=this._queue;s[r]?s[r]?.(e):(n[r]=n[r]||[],n[r]?.push(e))})}),this},handle(t,e,r){const s=this._addHandlers,n=this._removeHandlers;if(s[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,n[t]=r;const i=this._queue;return i[t]&&(i[t]?.forEach(o=>e(o)),delete i[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByNamedList(t,e,r=-1){return this.handle(t,s=>{e.findIndex(i=>i.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((i,o)=>Go(o.value,r)-Go(i.value,r)))},s=>{const n=e.findIndex(i=>i.name===s.name);n!==-1&&e.splice(n,1)})},handleByList(t,e,r=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((n,i)=>Go(i,r)-Go(n,r)))},s=>{const n=e.indexOf(s.ref);n!==-1&&e.splice(n,1)})},mixin(t,...e){for(const r of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(r))}},HC={extension:{type:ee.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await gr(()=>import("./browserAll-4WYFAcFT.js"),__vite__mapDeps([5,6,7,8,1,2]))}},$C={extension:{type:ee.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await gr(()=>import("./webworkerAll-CJOkTTaQ.js"),__vite__mapDeps([6,7,8,1,2]))}};class zt{constructor(e,r,s){this._x=r||0,this._y=s||0,this._observer=e}clone(e){return new zt(e??this._observer,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var ac={exports:{}},Cm;function GC(){return Cm||(Cm=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,h||l,d),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,m=new Array(f);d<f;d++)m[d]=h[d].fn;return m},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,m){var A=r?r+c:c;if(!this._events[A])return!1;var g=this._events[A],y=arguments.length,w,x;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,d),!0;case 5:return g.fn.call(g.context,u,h,d,f),!0;case 6:return g.fn.call(g.context,u,h,d,f,m),!0}for(x=1,w=new Array(y-1);x<y;x++)w[x-1]=arguments[x];g.fn.apply(g.context,w)}else{var b=g.length,V;for(x=0;x<b;x++)switch(g[x].once&&this.removeListener(c,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,u);break;case 3:g[x].fn.call(g[x].context,u,h);break;case 4:g[x].fn.call(g[x].context,u,h,d);break;default:if(!w)for(V=1,w=new Array(y-1);V<y;V++)w[V-1]=arguments[V];g[x].fn.apply(g[x].context,w)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var A=0,g=[],y=m.length;A<y;A++)(m[A].fn!==u||d&&!m[A].once||h&&m[A].context!==h)&&g.push(m[A]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(ac)),ac.exports}var WC=GC();const Ar=rt(WC),YC=Math.PI*2,QC=180/Math.PI,KC=Math.PI/180;class mt{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new mt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return lc.x=0,lc.y=0,lc}}const lc=new mt;class me{constructor(e=1,r=0,s=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,s,n,i,o){return this.a=e,this.b=r,this.c=s,this.d=n,this.tx=i,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,r){r=r||new mt;const s=e.x,n=e.y;return r.x=this.a*s+this.c*n+this.tx,r.y=this.b*s+this.d*n+this.ty,r}applyInverse(e,r){r=r||new mt;const s=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,c=1/(s*o+i*-n),u=e.x,h=e.y;return r.x=o*c*u+-i*c*h+(l*i-a*o)*c,r.y=s*c*h+-n*c*u+(-l*s+a*n)*c,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*r-this.b*s,this.b=n*s+this.b*r,this.c=i*r-this.d*s,this.d=i*s+this.d*r,this.tx=o*r-this.ty*s,this.ty=o*s+this.ty*r,this}append(e){const r=this.a,s=this.b,n=this.c,i=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*s+e.b*i,this.c=e.c*r+e.d*n,this.d=e.c*s+e.d*i,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*i+this.ty,this}appendFrom(e,r){const s=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,l=e.ty,c=r.a,u=r.b,h=r.c,d=r.d;return this.a=s*c+n*h,this.b=s*u+n*d,this.c=i*c+o*h,this.d=i*u+o*d,this.tx=a*c+l*h+r.tx,this.ty=a*u+l*d+r.ty,this}setTransform(e,r,s,n,i,o,a,l,c){return this.a=Math.cos(a+c)*i,this.b=Math.sin(a+c)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(s*this.a+n*this.c),this.ty=r-(s*this.b+n*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,s=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),l=Math.atan2(s,r),c=Math.abs(a+l);return c<1e-5||Math.abs(YC-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+s*s),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*r+o.y*n),e.position.y=this.ty+(o.x*s+o.y*i),e}invert(){const e=this.a,r=this.b,s=this.c,n=this.d,i=this.tx,o=e*n-r*s;return this.a=n/o,this.b=-r/o,this.c=-s/o,this.d=e/o,this.tx=(s*this.ty-n*i)/o,this.ty=-(e*this.ty-r*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new me;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return JC.identity()}static get shared(){return XC.identity()}}const XC=new me,JC=new me,gs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],As=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ys=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],xs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Lu=[],cb=[],Wo=Math.sign;function ZC(){for(let t=0;t<16;t++){const e=[];Lu.push(e);for(let r=0;r<16;r++){const s=Wo(gs[t]*gs[r]+ys[t]*As[r]),n=Wo(As[t]*gs[r]+xs[t]*As[r]),i=Wo(gs[t]*ys[r]+ys[t]*xs[r]),o=Wo(As[t]*ys[r]+xs[t]*xs[r]);for(let a=0;a<16;a++)if(gs[a]===s&&As[a]===n&&ys[a]===i&&xs[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new me;e.set(gs[t],As[t],ys[t],xs[t],0,0),cb.push(e)}}ZC();const Pe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>gs[t],uY:t=>As[t],vX:t=>ys[t],vY:t=>xs[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Lu[t][e],sub:(t,e)=>Lu[t][Pe.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Pe.S:Pe.N:Math.abs(e)*2<=Math.abs(t)?t>0?Pe.E:Pe.W:e>0?t>0?Pe.SE:Pe.SW:t>0?Pe.NE:Pe.NW,matrixAppendRotationInv:(t,e,r=0,s=0)=>{const n=cb[Pe.inv(e)];n.tx=r,n.ty=s,t.append(n)}},Yo=[new mt,new mt,new mt,new mt];class De{constructor(e=0,r=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(r),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new De(0,0,0,0)}clone(){return new De(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}strokeContains(e,r,s,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,c=s*(1-n),u=s-c,h=a-c,d=a+i+c,f=l-c,m=l+o+c,A=a+u,g=a+i-u,y=l+u,w=l+o-u;return e>=h&&e<=d&&r>=f&&r<=m&&!(e>A&&e<g&&r>y&&r<w)}intersects(e,r){if(!r){const k=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=k)return!1;const T=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>T}const s=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=s||o<=i)return!1;const a=Yo[0].set(e.left,e.top),l=Yo[1].set(e.left,e.bottom),c=Yo[2].set(e.right,e.top),u=Yo[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=s||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=i||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),m=d*s+f*i,A=d*n+f*i,g=d*s+f*o,y=d*n+f*o;if(Math.max(m,A,g,y)<=d*a.x+f*a.y||Math.min(m,A,g,y)>=d*u.x+f*u.y)return!1;const w=h*(a.y-c.y),x=h*(c.x-a.x),b=w*s+x*i,V=w*n+x*i,_=w*s+x*o,v=w*n+x*o;return!(Math.max(b,V,_,v)<=w*a.x+x*a.y||Math.min(b,V,_,v)>=w*u.x+x*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(s-r,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,r=.001){const s=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=s-this.x,this.height=n-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=s-r,this.y=n,this.height=i-n,this}getBounds(e){return e||(e=new De),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const r=e.x,s=e.y,n=e.x+e.width,i=e.y+e.height;return r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const cc={default:-1};function Fe(t="default"){return cc[t]===void 0&&(cc[t]=-1),++cc[t]}const Pm={},pt="8.0.0",eP="8.3.4";function Be(t,e,r=3){if(Pm[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(s=s.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(s))),Pm[e]=!0}const ub=()=>{};function Da(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Em(t){return!(t&t-1)&&!!t}function hb(t){const e={};for(const r in t)t[r]!==void 0&&(e[r]=t[r]);return e}const Tm=Object.create(null);function tP(t){const e=Tm[t];return e===void 0&&(Tm[t]=Fe("resource")),e}const db=class fb extends Ar{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...fb.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){Be(pt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=tP(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};db.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let rP=db;const pb=class mb extends Ar{constructor(e={}){super(),this.options=e,this.uid=Fe("textureSource"),this._resourceType="textureSource",this._resourceId=Fe("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...mb.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new rP(hb(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Fe("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,r,s){s||(s=this._resolution),e||(e=this.width),r||(r=this.height);const n=Math.round(e*s),i=Math.round(r*s);return this.width=n/s,this.height=i/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=Fe("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Em(this.pixelWidth)&&Em(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};pb.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let yr=pb;class qd extends yr{constructor(e){const r=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(r instanceof Float32Array?s="rgba32float":r instanceof Int32Array||r instanceof Uint32Array?s="rgba32uint":r instanceof Int16Array||r instanceof Uint16Array?s="rgba16uint":(r instanceof Int8Array,s="bgra8unorm")),super({...e,resource:r,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}qd.extension=ee.TextureSource;const Rm=new me;class sP{constructor(e,r){this.mapCoord=new me,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof r>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=r,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,r){r===void 0&&(r=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];r[n]=i*s.a+o*s.c+s.tx,r[n+1]=i*s.b+o*s.d+s.ty}return r}update(){const e=this._texture;this._updateID++;const r=e.uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(Rm.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Rm));const i=e.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(e.frame.x+a+l)/i.width,o[1]=(e.frame.y+a+l)/i.height,o[2]=(e.frame.x+e.frame.width-a+l)/i.width,o[3]=(e.frame.y+e.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&e.rotate===0,!0}}class pe extends Ar{constructor({source:e,label:r,frame:s,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:c}={}){if(super(),this.uid=Fe("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new De,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=r,this.source=e?.source??new yr,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=n||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new sP(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:r}=this,{width:s,height:n}=this._source,i=r.x/s,o=r.y/n,a=r.width/s,l=r.height/n;let c=this.rotate;if(c){const u=a/2,h=l/2,d=i+u,f=o+h;c=Pe.add(c,Pe.NW),e.x0=d+u*Pe.uX(c),e.y0=f+h*Pe.uY(c),c=Pe.add(c,2),e.x1=d+u*Pe.uX(c),e.y1=f+h*Pe.uY(c),c=Pe.add(c,2),e.x2=d+u*Pe.uX(c),e.y2=f+h*Pe.uY(c),c=Pe.add(c,2),e.x3=d+u*Pe.uX(c),e.y3=f+h*Pe.uY(c)}else e.x0=i,e.y0=o,e.x1=i+a,e.y1=o,e.x2=i+a,e.y2=o+l,e.x3=i,e.y3=o+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Be(pt,"Texture.baseTexture is now Texture.source"),this._source}}pe.EMPTY=new pe({label:"EMPTY",source:new yr({label:"EMPTY"})});pe.EMPTY.destroy=ub;pe.WHITE=new pe({source:new qd({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});pe.WHITE.destroy=ub;function nP(t,e,r){const{width:s,height:n}=r.orig,i=r.trim;if(i){const o=i.width,a=i.height;t.minX=i.x-e._x*s,t.maxX=t.minX+o,t.minY=i.y-e._y*n,t.maxY=t.minY+a}else t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*n,t.maxY=t.minY+n}const Mm=new me;class rr{constructor(e=1/0,r=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Mm,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new De);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Mm,this}set(e,r,s,n){this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(e,r,s,n,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,c=i.d,u=i.tx,h=i.ty;let d=this.minX,f=this.minY,m=this.maxX,A=this.maxY,g=o*e+l*r+u,y=a*e+c*r+h;g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*s+l*r+u,y=a*s+c*r+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*e+l*n+u,y=a*e+c*n+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),g=o*s+l*n+u,y=a*s+c*n+h,g<d&&(d=g),y<f&&(f=y),g>m&&(m=g),y>A&&(A=y),this.minX=d,this.minY=f,this.maxX=m,this.maxY=A}addRect(e,r){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,r)}addBounds(e,r){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,r)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const r=this.minX,s=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:c,tx:u,ty:h}=e;let d=o*r+l*s+u,f=a*r+c*s+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*n+l*s+u,f=a*n+c*s+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+l*i+u,f=a*r+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*n+l*i+u,f=a*n+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,r,s,n){return this.minX<e&&(this.minX=e),this.maxX>r&&(this.maxX=r),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,r=e){return this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new rr(this.minX,this.minY,this.maxX,this.maxY)}scale(e,r=e){return this.minX*=e,this.minY*=r,this.maxX*=e,this.maxY*=r,this}get x(){return this.minX}set x(e){const r=this.maxX-this.minX;this.minX=e,this.maxX=e+r}get y(){return this.minY}set y(e){const r=this.maxY-this.minY;this.minY=e,this.maxY=e+r}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,r,s,n){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;n||(n=this.matrix);const c=n.a,u=n.b,h=n.c,d=n.d,f=n.tx,m=n.ty;for(let A=r;A<s;A+=2){const g=e[A],y=e[A+1],w=c*g+h*y+f,x=u*g+d*y+m;i=w<i?w:i,o=x<o?x:o,a=w>a?w:a,l=x>l?x:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(e,r){return this.minX<=e&&this.minY<=r&&this.maxX>=e&&this.maxY>=r}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var iP={grad:.9,turn:360,rad:360/(2*Math.PI)},vr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},et=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Qt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},gb=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Im=function(t){return{r:Qt(t.r,0,255),g:Qt(t.g,0,255),b:Qt(t.b,0,255),a:Qt(t.a)}},uc=function(t){return{r:et(t.r),g:et(t.g),b:et(t.b),a:et(t.a,3)}},oP=/^#([0-9a-f]{3,8})$/i,Qo=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Ab=function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=Math.max(e,r,s),o=i-Math.min(e,r,s),a=o?i===e?(r-s)/o:i===r?2+(s-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},yb=function(t){var e=t.h,r=t.s,s=t.v,n=t.a;e=e/360*6,r/=100,s/=100;var i=Math.floor(e),o=s*(1-r),a=s*(1-(e-i)*r),l=s*(1-(1-e+i)*r),c=i%6;return{r:255*[s,a,o,o,l,s][c],g:255*[l,s,s,a,o,o][c],b:255*[o,o,l,s,s,a][c],a:n}},jm=function(t){return{h:gb(t.h),s:Qt(t.s,0,100),l:Qt(t.l,0,100),a:Qt(t.a)}},Bm=function(t){return{h:et(t.h),s:et(t.s),l:et(t.l),a:et(t.a,3)}},Om=function(t){return yb((r=(e=t).s,{h:e.h,s:(r*=((s=e.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:e.a}));var e,r,s},ki=function(t){return{h:(e=Ab(t)).h,s:(n=(200-(r=e.s))*(s=e.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,s,n},aP=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lP=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cP=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uP=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Uu={string:[[function(t){var e=oP.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?et(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?et(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=cP.exec(t)||uP.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Im({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=aP.exec(t)||lP.exec(t);if(!e)return null;var r,s,n=jm({h:(r=e[1],s=e[2],s===void 0&&(s="deg"),Number(r)*(iP[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Om(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,s=t.b,n=t.a,i=n===void 0?1:n;return vr(e)&&vr(r)&&vr(s)?Im({r:Number(e),g:Number(r),b:Number(s),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,s=t.l,n=t.a,i=n===void 0?1:n;if(!vr(e)||!vr(r)||!vr(s))return null;var o=jm({h:Number(e),s:Number(r),l:Number(s),a:Number(i)});return Om(o)},"hsl"],[function(t){var e=t.h,r=t.s,s=t.v,n=t.a,i=n===void 0?1:n;if(!vr(e)||!vr(r)||!vr(s))return null;var o=(function(a){return{h:gb(a.h),s:Qt(a.s,0,100),v:Qt(a.v,0,100),a:Qt(a.a)}})({h:Number(e),s:Number(r),v:Number(s),a:Number(i)});return yb(o)},"hsv"]]},zm=function(t,e){for(var r=0;r<e.length;r++){var s=e[r][0](t);if(s)return[s,e[r][1]]}return[null,void 0]},hP=function(t){return typeof t=="string"?zm(t.trim(),Uu.string):typeof t=="object"&&t!==null?zm(t,Uu.object):[null,void 0]},hc=function(t,e){var r=ki(t);return{h:r.h,s:Qt(r.s+100*e,0,100),l:r.l,a:r.a}},dc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Nm=function(t,e){var r=ki(t);return{h:r.h,s:r.s,l:Qt(r.l+100*e,0,100),a:r.a}},Hu=(function(){function t(e){this.parsed=hP(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return et(dc(this.rgba),2)},t.prototype.isDark=function(){return dc(this.rgba)<.5},t.prototype.isLight=function(){return dc(this.rgba)>=.5},t.prototype.toHex=function(){return e=uc(this.rgba),r=e.r,s=e.g,n=e.b,o=(i=e.a)<1?Qo(et(255*i)):"","#"+Qo(r)+Qo(s)+Qo(n)+o;var e,r,s,n,i,o},t.prototype.toRgb=function(){return uc(this.rgba)},t.prototype.toRgbString=function(){return e=uc(this.rgba),r=e.r,s=e.g,n=e.b,(i=e.a)<1?"rgba("+r+", "+s+", "+n+", "+i+")":"rgb("+r+", "+s+", "+n+")";var e,r,s,n,i},t.prototype.toHsl=function(){return Bm(ki(this.rgba))},t.prototype.toHslString=function(){return e=Bm(ki(this.rgba)),r=e.h,s=e.s,n=e.l,(i=e.a)<1?"hsla("+r+", "+s+"%, "+n+"%, "+i+")":"hsl("+r+", "+s+"%, "+n+"%)";var e,r,s,n,i},t.prototype.toHsv=function(){return e=Ab(this.rgba),{h:et(e.h),s:et(e.s),v:et(e.v),a:et(e.a,3)};var e},t.prototype.invert=function(){return ar({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),ar(hc(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),ar(hc(this.rgba,-e))},t.prototype.grayscale=function(){return ar(hc(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),ar(Nm(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),ar(Nm(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?ar({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):et(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=ki(this.rgba);return typeof e=="number"?ar({h:e,s:r.s,l:r.l,a:r.a}):et(r.h)},t.prototype.isEqual=function(e){return this.toHex()===ar(e).toHex()},t})(),ar=function(t){return t instanceof Hu?t:new Hu(t)},Dm=[],dP=function(t){t.forEach(function(e){Dm.indexOf(e)<0&&(e(Hu,Uu),Dm.push(e))})};function fP(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in r)s[r[n]]=n;var i={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=s[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),h=1/0,d="black";if(!i.length)for(var f in r)i[f]=new t(r[f]).toRgb();for(var m in r){var A=(a=u,l=i[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<h&&(h=A,d=m)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}dP([fP]);const Sn=class mi{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof mi)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,r){const s=typeof e;if(s!==typeof r)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,o)=>i===r[o]);if(e!==null&&r!==null){const i=Object.keys(e),o=Object.keys(r);return i.length!==o.length?!1:i.every(a=>e[a]===r[a])}return e===r}toRgba(){const[e,r,s,n]=this._components;return{r:e,g:r,b:s,a:n}}toRgb(){const[e,r,s]=this._components;return{r:e,g:r,b:s}}toRgbaString(){const[e,r,s]=this.toUint8RgbArray();return`rgba(${e},${r},${s},${this.alpha})`}toUint8RgbArray(e){const[r,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(r*255),e[1]=Math.round(s*255),e[2]=Math.round(n*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[r,s,n,i]=this._components;return e[0]=r,e[1]=s,e[2]=n,e[3]=i,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[r,s,n]=this._components;return e[0]=r,e[1]=s,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,r,s]=this.toUint8RgbArray();return(s<<16)+(r<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,s,n,i]=mi._temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=s,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return r&&(s=s*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const r=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-r.length)+r}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let r,s,n,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,s=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,s,n,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,s,n,i=255]=e,r/=255,s/=255,n/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=mi.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=ar(e);o.isValid()&&({r,g:s,b:n,a:i}=o.rgba,r/=255,s/=255,n/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=s,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,r,s]=this._components;this._int=(e*255<<16)+(r*255<<8)+(s*255|0)}_clamp(e,r=0,s=1){return typeof e=="number"?Math.min(Math.max(e,r),s):(e.forEach((n,i)=>{e[i]=Math.min(Math.max(n,r),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof mi||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Sn.shared=new Sn;Sn._temp=new Sn;Sn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let lt=Sn;const pP={cullArea:null,cullable:!1,cullableChildren:!0};class vd{constructor(e,r){this._pool=[],this._count=0,this._index=0,this._classType=e,r&&this.prepopulate(r)}prepopulate(e){for(let r=0;r<e;r++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let r;return this._index>0?r=this._pool[--this._index]:r=new this._classType,r.init?.(e),r}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class mP{constructor(){this._poolsByClass=new Map}prepopulate(e,r){this.getPool(e).prepopulate(r)}get(e,r){return this.getPool(e).get(r)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new vd(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(r=>{const s=e[r._classType.name]?r._classType.name+r._classType.ID:r._classType.name;e[s]={free:r.totalFree,used:r.totalUsed,size:r.totalSize}}),e}}const Rr=new mP,gP={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(t){typeof t=="boolean"&&t===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(t===!0?{}:t))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){Be("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};function AP(t,e,r){const s=t.length;let n;if(e>=s||r===0)return;r=e+r>s?s-e:r;const i=s-r;for(n=e;n<i;++n)t[n]=t[n+r];t.length=i}const yP={allowChildren:!0,removeChildren(t=0,e){const r=e??this.children.length,s=r-t,n=[];if(s>0&&s<=r){for(let o=r-1;o>=t;o--){const a=this.children[o];a&&(n.push(a),a.parent=null)}AP(this.children,t,r);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(n);for(let o=0;o<n.length;++o)this.emit("childRemoved",n[o],this,o),n[o].emit("removed",this);return n.length>0&&this._didViewChangeTick++,n}else if(s===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||Be(pt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:r}=this;if(e<0||e>r.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${r.length}`);if(t.parent){const n=t.parent.children.indexOf(t);if(t.parent===this&&n===e)return t;n!==-1&&t.parent.children.splice(n,1)}e===r.length?r.push(t):r.splice(e,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const r=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const s=this.worldTransform.clone();return s.invert(),r.prepend(s),t.setFromMatrix(r),t}},xP={collectRenderables(t,e,r){this.parentRenderLayer&&this.parentRenderLayer!==r||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(t,e,r):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,t):this.collectRenderablesWithEffects(t,e,r))},collectRenderablesSimple(t,e,r){const s=this.children,n=s.length;for(let i=0;i<n;i++)s[i].collectRenderables(t,e,r)},collectRenderablesWithEffects(t,e,r){const{renderPipes:s}=e;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];s[i.pipe].push(i,this,t)}this.collectRenderablesSimple(t,e,r);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];s[i.pipe].pop(i,this,t)}}};class Fm{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class bP{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let r=0;r<this._tests.length;r++){const s=this._tests[r];if(s.test(e))return Rr.get(s.maskClass,e)}return e}returnMaskEffect(e){Rr.return(e)}}const $u=new bP;Et.handleByList(ee.MaskEffect,$u._effectClasses);const wP={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((r,s)=>r.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),$u.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=$u.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Fm);t=t;const r=t?.length>0,s=e.filters?.length>0,n=r!==s;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),n&&(r?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Fm),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},qP={label:null,get name(){return Be(pt,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){Be(pt,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const r=this.children;for(let s=0;s<r.length;s++){const n=r[s];if(n.label===t||t instanceof RegExp&&t.test(n.label))return n}if(e)for(let s=0;s<r.length;s++){const i=r[s].getChildByLabel(t,!0);if(i)return i}return null},getChildrenByLabel(t,e=!1,r=[]){const s=this.children;for(let n=0;n<s.length;n++){const i=s[n];(i.label===t||t instanceof RegExp&&t.test(i.label))&&r.push(i)}if(e)for(let n=0;n<s.length;n++)s[n].getChildrenByLabel(t,!0,r);return r}},wt=new vd(me),Mr=new vd(rr),vP=new me,VP={getFastGlobalBounds(t,e){e||(e=new rr),e.clear(),this._getGlobalBoundsRecursive(!!t,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const r=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(r.worldTransform),e},_getGlobalBoundsRecursive(t,e,r){let s=e;if(t&&this.parentRenderLayer&&this.parentRenderLayer!==r||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(s=Mr.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;s.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(t,s,r)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,s.applyMatrix(o.worldTransform)),this.effects[a].addBounds(s,!0));i&&(s.applyMatrix(o.worldTransform.copyTo(vP).invert()),e.addBounds(s,this.relativeGroupTransform)),e.addBounds(s),Mr.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Mr.return(s))}};function xb(t,e,r){r.clear();let s,n;return t.parent?e?s=t.parent.worldTransform:(n=wt.get().identity(),s=Vd(t,n)):s=me.IDENTITY,bb(t,r,s,e),n&&wt.return(n),r.isValid||r.set(0,0,0,0),r}function bb(t,e,r,s){if(!t.visible||!t.measurable)return;let n;s?n=t.worldTransform:(t.updateLocalTransform(),n=wt.get(),n.appendFrom(t.localTransform,r));const i=e,o=!!t.effects.length;if(o&&(e=Mr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,n);else{t.bounds&&(e.matrix=n,e.addBounds(t.bounds));for(let a=0;a<t.children.length;a++)bb(t.children[a],e,n,s)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);i.addBounds(e,me.IDENTITY),Mr.return(e)}s||wt.return(n)}function Vd(t,e){const r=t.parent;return r&&(Vd(r,e),r.updateLocalTransform(),e.append(r.localTransform)),e}function wb(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const r=t>>16&255,s=t>>8&255,n=t&255,i=e>>16&255,o=e>>8&255,a=e&255,l=r*i/255|0,c=s*o/255|0,u=n*a/255|0;return(l<<16)+(c<<8)+u}const Lm=16777215;function Um(t,e){return t===Lm?e:e===Lm?t:wb(t,e)}function ya(t){return((t&255)<<16)+(t&65280)+(t>>16&255)}const _P={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,r=this.parent;for(;r;)e*=r.alpha,r=r.parent;return e},getGlobalTransform(t,e){if(e)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const r=Vd(this,wt.get().identity());return t.appendFrom(this.localTransform,r),wt.return(r),t},getGlobalTint(t){if(t)return this.renderGroup?ya(this.renderGroup.worldColor):this.parentRenderGroup?ya(Um(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,r=this.parent;for(;r;)e=Um(e,r.localColor),r=r.parent;return ya(e)}};let fc=0;const Hm=500;function Ee(...t){fc!==Hm&&(fc++,fc===Hm?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function qb(t,e,r){return e.clear(),r||(r=me.IDENTITY),vb(t,e,r,t,!0),e.isValid||e.set(0,0,0,0),e}function vb(t,e,r,s,n){let i;if(n)i=wt.get(),i=r.copyTo(i);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const l=t.localTransform;i=wt.get(),i.appendFrom(l,r)}const o=e,a=!!t.effects.length;if(a&&(e=Mr.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.renderPipeId&&(e.matrix=i,e.addBounds(t.bounds));const l=t.children;for(let c=0;c<l.length;c++)vb(l[c],e,i,s,!1)}if(a){for(let l=0;l<t.effects.length;l++)t.effects[l].addLocalBounds?.(e,s);o.addBounds(e,me.IDENTITY),Mr.return(e)}wt.return(i)}function Vb(t,e){const r=t.children;for(let s=0;s<r.length;s++){const n=r[s],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=e.index;(e.data[a]!==i||e.data[a+1]!==o)&&(e.data[e.index]=i,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,n.children.length&&Vb(n,e)}return e.didChange}const SP=new me,kP={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const r=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*r:this.scale.x=r},_setHeight(t,e){const r=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*r:this.scale.y=r},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new rr});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),Vb(this,t),t.didChange&&qb(this,t.localBounds,SP),t.localBounds},getBounds(t,e){return xb(this,t,e||new rr)}},CP={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},PP={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(EP))}};function EP(t,e){return t._zIndex-e._zIndex}const TP={getGlobalPosition(t=new mt,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,r=!1){const s=this.getGlobalTransform(wt.get(),r);return e=s.apply(t,e),wt.return(s),e},toLocal(t,e,r,s){e&&(t=e.toGlobal(t,r,s));const n=this.getGlobalTransform(wt.get(),s);return r=n.applyInverse(t,r),wt.return(n),r}};class _b{constructor(){this.uid=Fe("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let RP=0;class MP{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,r,s){const n=new yr({...this.textureOptions,width:e,height:r,resolution:1,antialias:s,autoGarbageCollect:!1});return new pe({source:n,label:`texturePool_${RP++}`})}getOptimalTexture(e,r,s=1,n){let i=Math.ceil(e*s-1e-6),o=Math.ceil(r*s-1e-6);i=Da(i),o=Da(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,n)),l.source._resolution=s,l.source.width=i/s,l.source.height=o/s,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=r,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(e,r=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,r)}returnTexture(e){const r=this._poolKeyHash[e.uid];this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const r in this._texturePool){const s=this._texturePool[r];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const IP=new MP;class jP{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new me,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new _b,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const r=e.children;for(let s=0;s<r.length;s++){const n=r[s];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(IP.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const r=this.childrenToUpdate[e];r.list.fill(null),r.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const r=this.renderGroupChildren.indexOf(e);r>-1&&this.renderGroupChildren.splice(r,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const r=e.children;for(let s=0;s<r.length;s++)this.addChild(r[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const r=e.children;for(let s=0;s<r.length;s++)this.removeChild(r[s])}removeChildren(e){for(let r=0;r<e.length;r++)this.removeChild(e[r])}onChildUpdate(e){let r=this.childrenToUpdate[e.relativeRenderGroupDepth];r||(r=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),r.list[r.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let r=0;r<this._onRenderContainers.length;r++)this._onRenderContainers[r]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const r=this.root.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],e);return e}_getChildren(e,r=[]){if(r.push(e),e.renderGroup)return r;const s=e.children;for(let n=0;n<s.length;n++)this._getChildren(s[n],r);return r}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new me),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new me),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new me),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function BP(t,e,r={}){for(const s in e)!r[s]&&e[s]!==void 0&&(t[s]=e[s])}const pc=new zt(null),mc=new zt(null),gc=new zt(null,1,1),$m=1,OP=2,Ac=4;class go extends Ar{constructor(e={}){super(),this.uid=Fe("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new me,this.relativeGroupTransform=new me,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new zt(this,0,0),this._scale=gc,this._pivot=mc,this._skew=pc,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],BP(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(r=>this.addChild(r)),e.parent?.addChild(this)}static mixin(e){Be("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Et.mixin(go,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||Be(pt,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let n=0;n<e.length;n++)this.addChild(e[n]);return e[0]}const r=e[0],s=this.renderGroup||this.parentRenderGroup;return r.parent===this?(this.children.splice(this.children.indexOf(r),1),this.children.push(r),s&&(s.structureDidChange=!0),r):(r.parent&&r.parent.removeChild(r),this.children.push(r),this.sortableChildren&&(this.sortDirty=!0),r.parent=this,r.didChange=!0,r._updateFlags=15,s&&s.addChild(r),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this),this._didViewChangeTick++,r._zIndex!==0&&r.depthOfChildModified(),r)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const r=e[0],s=this.children.indexOf(r);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(r):this.parentRenderGroup&&this.parentRenderGroup.removeChild(r),r.parentRenderLayer&&r.parentRenderLayer.detach(r),r.parent=null,this.emit("childRemoved",r,this,s),r.emit("removed",this)),r}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Rr.get(jP,this),this.groupTransform=me.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Rr.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new me),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*QC}set angle(e){this.rotation=e*KC}get pivot(){return this._pivot===mc&&(this._pivot=new zt(this,0,0)),this._pivot}set pivot(e){this._pivot===mc&&(this._pivot=new zt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===pc&&(this._skew=new zt(this,0,0)),this._skew}set skew(e){this._skew===pc&&(this._skew=new zt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===gc&&(this._scale=new zt(this,1,1)),this._scale}set scale(e){this._scale===gc&&(this._scale=new zt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const r=this.getLocalBounds().width;this._setWidth(e,r)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const r=this.getLocalBounds().height;this._setHeight(e,r)}getSize(e){e||(e={});const r=this.getLocalBounds();return e.width=Math.abs(this.scale.x*r.width),e.height=Math.abs(this.scale.y*r.height),e}setSize(e,r){const s=this.getLocalBounds();typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,r=this._skew;this._cx=Math.cos(e+r._y),this._sx=Math.sin(e+r._y),this._cy=-Math.sin(e-r._x),this._sy=Math.cos(e-r._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const r=this.localTransform,s=this._scale,n=this._pivot,i=this._position,o=s._x,a=s._y,l=n._x,c=n._y;r.a=this._cx*o,r.b=this._sx*o,r.c=this._cy*a,r.d=this._sy*a,r.tx=i._x-(l*r.a+c*r.c),r.ty=i._y-(l*r.b+c*r.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=$m,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=lt.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=$m,this._onUpdate())}get tint(){return ya(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=OP,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const r=e?2:0;(this.localDisplayStatus&2)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ac,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const r=e?0:4;(this.localDisplayStatus&4)!==r&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ac,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const r=e?1:0;(this.localDisplayStatus&1)!==r&&(this._updateFlags|=Ac,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let r;if(this.children.length&&(r=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&r)for(let n=0;n<r.length;++n)r[n].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Et.mixin(go,yP,VP,TP,CP,kP,wP,qP,PP,pP,gP,_P,xP);class zP extends go{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new rr(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const r=this.bounds,{x:s,y:n}=e;return s>=r.minX&&s<=r.maxX&&n>=r.minY&&n<=r.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null}collectRenderablesSimple(e,r,s){const{renderPipes:n,renderableGC:i}=r;n.blendMode.setBlendMode(this,this.groupBlendMode,e),n[this.renderPipeId].addRenderable(this,e),i.addRenderable(this),this.didViewUpdate=!1;const a=this.children,l=a.length;for(let c=0;c<l;c++)a[c].collectRenderables(e,r,s)}}class Li extends zP{constructor(e=pe.EMPTY){e instanceof pe&&(e={texture:e});const{texture:r=pe.EMPTY,anchor:s,roundPixels:n,width:i,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new zt({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:r.defaultAnchor&&(this.anchor=r.defaultAnchor),this.texture=r,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(e,r=!1){return e instanceof pe?new Li(e):new Li(pe.from(e,r))}set texture(e){e||(e=pe.EMPTY);const r=this._texture;r!==e&&(r&&r.dynamic&&r.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return nP(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Be("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,r=this._texture,s=this._bounds,{width:n,height:i}=r.orig;s.minX=-e._x*n,s.maxX=s.minX+n,s.minY=-e._y*i,s.maxY=s.minY+i}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,r){typeof e=="object"?(r=e.height??e.width,e=e.width):r??(r=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const NP=new rr;function Sb(t,e,r){const s=NP;t.measurable=!0,xb(t,r,s),e.addBoundsMask(s),t.measurable=!1}function kb(t,e,r){const s=Mr.get();t.measurable=!0;const n=wt.get().identity(),i=Cb(t,r,n);qb(t,s,i),t.measurable=!1,e.addBoundsMask(s),wt.return(n),Mr.return(s)}function Cb(t,e,r){return t?(t!==e&&(Cb(t.parent,e,r),t.updateLocalTransform(),r.append(t.localTransform)),r):(Ee("Mask bounds, renderable is not inside the root container"),r)}class Pb{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Li),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,r){this.inverse||Sb(this.mask,e,r)}addLocalBounds(e,r){kb(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof Li}}Pb.extension=ee.MaskEffect;class Eb{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Eb.extension=ee.MaskEffect;class Tb{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,r){Sb(this.mask,e,r)}addLocalBounds(e,r){kb(this.mask,e,r)}containsPoint(e,r){const s=this.mask;return r(s,e)}destroy(){this.reset()}static test(e){return e instanceof go}}Tb.extension=ee.MaskEffect;const DP={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let Gm=DP;const Qe={get(){return Gm},set(t){Gm=t}};class Rb extends yr{constructor(e){e.resource||(e.resource=Qe.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,r=this.height,s=this._resolution){const n=super.resize(e,r,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Rb.extension=ee.TextureSource;class Os extends yr{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const r=Qe.get().createCanvas(e.resource.width,e.resource.height);r.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=r,Ee("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Os.extension=ee.TextureSource;var Fa=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Fa||{});class yc{constructor(e,r=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=r,this.priority=s,this._once=n}match(e,r=null){return this._fn===e&&this._context===r}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const r=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Mb=class jt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new yc(null,null,1/0),this.deltaMS=1/jt.targetFPMS,this.elapsedMS=1/jt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,s=Fa.NORMAL){return this._addListener(new yc(e,r,s))}addOnce(e,r,s=Fa.NORMAL){return this._addListener(new yc(e,r,s,!0))}_addListener(e){let r=this._head.next,s=this._head;if(!r)e.connect(s);else{for(;r;){if(e.priority>r.priority){e.connect(s);break}s=r,r=r.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,r){let s=this._head.next;for(;s;)s.match(e,r)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*jt.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,r)/1e3,jt.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!jt._shared){const e=jt._shared=new jt;e.autoStart=!0,e._protected=!0}return jt._shared}static get system(){if(!jt._system){const e=jt._system=new jt;e.autoStart=!0,e._protected=!0}return jt._system}};Mb.targetFPMS=.06;let Ct=Mb,xc;async function Ib(){return xc??(xc=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const r=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!r)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(s),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),xc}const cl=class jb extends yr{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...jb.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=Ct.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,r=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await Ib(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,r.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${r.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ct.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ct.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};cl.extension=ee.TextureSource;cl.defaultOptions={...yr.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};cl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let xa=cl;const er=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(s=>typeof s=="string"||r?e(s):s):t);class FP{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||Ee(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const s=er(e);let n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(s,r);break}}const i=new Map(Object.entries(n||{}));n||s.forEach(l=>{i.set(l,r)});const o=[...i.keys()],a={cacheKeys:o,keys:s};s.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const c=n?n[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&Ee("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(e){if(!this._cacheMap.has(e)){Ee(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const Ie=new FP,Gu=[];Et.handleByList(ee.TextureSource,Gu);function Bb(t={}){const e=t&&t.resource,r=e?t.resource:t,s=e?t:{resource:t};for(let n=0;n<Gu.length;n++){const i=Gu[n];if(i.test(r))return new i(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function LP(t={},e=!1){const r=t&&t.resource,s=r?t.resource:t,n=r?t:{resource:t};if(!e&&Ie.has(s))return Ie.get(s);const i=new pe({source:Bb(n)});return i.on("destroy",()=>{Ie.has(s)&&Ie.remove(s)}),e||Ie.set(s,i),i}function UP(t,e=!1){return typeof t=="string"?Ie.get(t):t instanceof yr?new pe({source:t}):LP(t,e)}pe.from=UP;yr.from=Bb;Et.add(Pb,Eb,Tb,xa,Os,Rb,qd);var ns=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(ns||{});function Xt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function ii(t){return t.split("?")[0].split("#")[0]}function HP(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $P(t,e,r){return t.replace(new RegExp(HP(e),"g"),r)}function GP(t,e){let r="",s=0,n=-1,i=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",s=0):(r=r.slice(0,l),s=r.length-1-r.lastIndexOf("/")),n=a,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,n=a,i=0;continue}}}else r.length>0?r+=`/${t.slice(n+1,a)}`:r=t.slice(n+1,a),s=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}const Lt={toPosix(t){return $P(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Xt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(Xt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const s=ii(this.toPosix(e??Qe.get().getBaseUrl())),n=ii(this.toPosix(r??this.rootname(s)));return t=this.toPosix(t),t.startsWith("/")?Lt.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(Xt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=GP(t),t.length>0&&s&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Xt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const s=t[r];if(Xt(s),s.length>0)if(e===void 0)e=s;else{const n=t[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Xt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let s=-1,n=!0;const i=this.getProtocol(t),o=t;t=t.slice(i.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){s=a;break}}else n=!1;return s===-1?r?"/":this.isUrl(o)?i+t:i:r&&s===1?"//":i+t.slice(0,s)},rootname(t){Xt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Xt(t),e&&Xt(e),t=ii(this.toPosix(t));let r=0,s=-1,n=!0,i;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(l===47){if(!n){r=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(s=i):(o=-1,s=a))}return r===s?s=a:s===-1&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(t.charCodeAt(i)===47){if(!n){r=i+1;break}}else s===-1&&(n=!1,s=i+1);return s===-1?"":t.slice(r,s)},extname(t){Xt(t),t=ii(this.toPosix(t));let e=-1,r=0,s=-1,n=!0,i=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!n){r=o+1;break}continue}s===-1&&(n=!1,s=o+1),a===46?e===-1?e=o:i!==1&&(i=1):e!==-1&&(i=-1)}return e===-1||s===-1||i===0||i===1&&e===s-1&&e===r+1?"":t.slice(e,s)},parse(t){Xt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=ii(this.toPosix(t));let r=t.charCodeAt(0);const s=this.isAbsolute(t);let n;e.root=this.rootname(t),s||this.hasProtocol(t)?n=1:n=0;let i=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}return i===-1||a===-1||u===0||u===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&s?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&s?(e.name=t.slice(1,i),e.base=t.slice(1,a)):(e.name=t.slice(o,i),e.base=t.slice(o,a)),e.ext=t.slice(i,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Ob(t,e,r,s,n){const i=e[r];for(let o=0;o<i.length;o++){const a=i[o];r<e.length-1?Ob(t.replace(s[r],a),e,r+1,s,n):n.push(t.replace(s[r],a))}}function WP(t){const e=/\{(.*?)\}/g,r=t.match(e),s=[];if(r){const n=[];r.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),Ob(t,n,0,r,s)}else s.push(t);return s}const La=t=>!Array.isArray(t);class Un{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}getAlias(e){const{alias:r,src:s}=e;return er(r||s,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(e){this._manifest&&Ee("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const s=[];let n=r;Array.isArray(r)||(n=Object.entries(r).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(e,a);s.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(e,u));s.push(...c),l=[...a,...c]}this.add({...i,alias:l,src:o})}),this._bundles[e]=s}add(e){const r=[];Array.isArray(e)?r.push(...e):r.push(e);let s;s=i=>{this.hasKey(i)&&Ee(`[Resolver] already has key: ${i} overwriting`)},er(r).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:c}=i;const u=er(o).map(f=>typeof f=="string"?WP(f):Array.isArray(f)?f:[f]),h=this.getAlias(i);Array.isArray(h)?h.forEach(s):s(h);const d=[];u.forEach(f=>{f.forEach(m=>{let A={};if(typeof m!="object"){A.src=m;for(let g=0;g<this._parsers.length;g++){const y=this._parsers[g];if(y.test(m)){A=y.parse(m);break}}}else a=m.data??a,l=m.format??l,c=m.loadParser??c,A={...A,...m};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${A.src}`);A=this._buildResolvedAsset(A,{aliases:h,data:a,format:l,loadParser:c}),d.push(A)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const r=La(e);e=er(e);const s={};return e.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(n,l)]=c}s[n]=a}}),r?s[e[0]]:s}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const s={};for(const n in r)s[n]=r[n].src;return s}return r.src}resolve(e){const r=La(e);e=er(e);const s={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const c=i.filter(u=>u[a]?u[a]===l:!1);c.length&&(i=c)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),r?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const s=e[r],n=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}_buildResolvedAsset(e,r){const{aliases:s,data:n,loadParser:i,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=Lt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.format=o??e.format??YP(e.src),e}}Un.RETINA_PREFIX=/@([0-9\.]+)x/;function YP(t){return t.split(".").pop().split("?").shift().split("#").shift()}const Wu=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t},zb=class gi{constructor(e,r){this.linkedSheets=[],this._texture=e instanceof pe?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=r;const s=parseFloat(r.meta.scale);s?(this.resolution=s,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=gi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const s=gi.BATCH_SIZE;for(;r-e<s&&r<this._frameKeys.length;){const n=this._frameKeys[r],i=this._frames[n],o=i.frame;if(o){let a=null,l=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new De(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?a=new De(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new De(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new De(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new pe({source:this.textureSource,frame:a,orig:u,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let s=0;s<e[r].length;s++){const n=e[r][s];this.animations[r].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*gi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*gi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};zb.BATCH_SIZE=1e3;let Yu=zb;const QP=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Nb(t,e,r){const s={};if(t.forEach(n=>{s[n]=e}),Object.keys(e.textures).forEach(n=>{s[n]=e.textures[n]}),!r){const n=Lt.dirname(t[0]);e.linkedSheets.forEach((i,o)=>{const a=Nb([`${n}/${e.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(s,a)})}return s}const KP={extension:ee.Asset,cache:{test:t=>t instanceof Yu,getCacheableAssets:(t,e)=>Nb(t,e,!1)},resolver:{extension:{type:ee.ResolveParser,name:"resolveSpritesheet"},test:t=>{const r=t.split("?")[0].split("."),s=r.pop(),n=r.pop();return s==="json"&&QP.includes(n)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Un.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:ee.LoadParser,priority:ns.Normal,name:"spritesheetLoader"},async testParse(t,e){return Lt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){const{texture:s,imageFilename:n,textureOptions:i}=e?.data??{};let o=Lt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(s instanceof pe)a=s;else{const u=Wu(o+(n??t.meta.image),e.src);a=(await r.load([{src:u,data:i}]))[u]}const l=new Yu(a.source,t);await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const d of c){if(typeof d!="string")continue;let f=o+d;e.data?.ignoreMultiPack||(f=Wu(f,e.src),u.push(r.load({src:f,data:{textureOptions:i,ignoreMultiPack:!0}})))}const h=await Promise.all(u);l.linkedSheets=h,h.forEach(d=>{d.linkedSheets=[l].concat(l.linkedSheets.filter(f=>f!==d))})}return l},async unload(t,e,r){await r.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};Et.add(KP);const bc=Object.create(null),Wm=Object.create(null);function _d(t,e){let r=Wm[t];return r===void 0&&(bc[e]===void 0&&(bc[e]=1),Wm[t]=r=bc[e]++),r}let Ko;function Db(){return(!Ko||Ko?.isContextLost())&&(Ko=Qe.get().createCanvas().getContext("webgl",{})),Ko}let Xo;function XP(){if(!Xo){Xo="mediump";const t=Db();t&&t.getShaderPrecisionFormat&&(Xo=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return Xo}function JP(t,e,r){return e?t:r?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function ZP(t,e,r){const s=r?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let n=r?e.requestedFragmentPrecision:e.requestedVertexPrecision;return n==="highp"&&s!=="highp"&&(n="mediump"),`precision ${n} float;
${t}`}else if(s!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function eE(t,e){return e?`#version 300 es
${t}`:t}const tE={},rE={};function sE(t,{name:e="pixi-program"},r=!0){e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex";const s=r?tE:rE;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function nE(t,e){return e?t.replace("#version 300 es",""):t}const wc={stripVersion:nE,ensurePrecision:ZP,addProgramDefines:JP,setProgramName:sE,insertVersion:eE},qc=Object.create(null),Fb=class Qu{constructor(e){e={...Qu.defaultOptions,...e};const r=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:XP()},setProgramName:{name:e.name},addProgramDefines:r,insertVersion:r};let n=e.fragment,i=e.vertex;Object.keys(wc).forEach(o=>{const a=s[o];n=wc[o](n,a,!0),i=wc[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=_d(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const r=`${e.vertex}:${e.fragment}`;return qc[r]||(qc[r]=new Qu(e)),qc[r]}};Fb.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Lb=Fb;const Ym={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function iE(t){return Ym[t]??Ym.float32}const oE={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function aE({source:t,entryPoint:e}){const r={},s=t.indexOf(`fn ${e}`);if(s!==-1){const n=t.indexOf("->",s);if(n!==-1){const i=t.substring(s,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=oE[a[3]]??"float32";r[a[2]]={location:parseInt(a[1],10),format:l,stride:iE(l).stride,offset:0,instance:!1,start:0}}}}return r}function vc(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,r=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=t.match(e)?.map(h=>({group:parseInt(h.match(r)[1],10),binding:parseInt(h.match(s)[1],10),name:h.match(n)[2],isUniform:h.match(n)[1]==="<uniform>",type:h.match(i)[1]}));if(!c)return{groups:[],structs:[]};const u=t.match(o)?.map(h=>{const d=h.match(l)[1],f=h.match(a).reduce((m,A)=>{const[g,y]=A.split(":");return m[g.trim()]=y.trim(),m},{});return f?{name:d,members:f}:null}).filter(({name:h})=>c.some(d=>d.type===h))??[];return{groups:c,structs:u}}var Ai=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Ai||{});function lE({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:Ai.VERTEX|Ai.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:Ai.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:Ai.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function cE({groups:t}){const e=[];for(let r=0;r<t.length;r++){const s=t[r];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function uE(t,e){const r=new Set,s=new Set,n=[...t.structs,...e.structs].filter(o=>r.has(o.name)?!1:(r.add(o.name),!0)),i=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return s.has(a)?!1:(s.add(a),!0)});return{structs:n,groups:i}}const Vc=Object.create(null);class ul{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:r,vertex:s,layout:n,gpuLayout:i,name:o}=e;if(this.name=o,this.fragment=r,this.vertex=s,r.source===s.source){const a=vc(r.source);this.structsAndGroups=a}else{const a=vc(s.source),l=vc(r.source);this.structsAndGroups=uE(a,l)}this.layout=n??cE(this.structsAndGroups),this.gpuLayout=i??lE(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:r}=this,s=e.source+r.source+e.entryPoint+r.entryPoint;this._layoutKey=_d(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=aE(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const r=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return Vc[r]||(Vc[r]=new ul(e)),Vc[r]}}const Ub=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],hE=Ub.reduce((t,e)=>(t[e]=!0,t),{});function dE(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Hb=class $b{constructor(e,r){this._touched=0,this.uid=Fe("uniform"),this._resourceType="uniformGroup",this._resourceId=Fe("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r={...$b.defaultOptions,...r},this.uniformStructures=e;const s={};for(const n in e){const i=e[n];if(i.name=n,i.size=i.size??1,!hE[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${Ub.join(", ")}`);i.value??(i.value=dE(i.type,i.size)),s[n]=i.value}this.uniforms=s,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=_d(Object.keys(s).map(n=>`${n}-${e[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Hb.defaultOptions={ubo:!1,isStatic:!1};let Gb=Hb;class ba{constructor(e){this.resources=Object.create(null),this._dirty=!0;let r=0;for(const s in e){const n=e[s];this.setResource(n,r++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let r=0;for(const s in this.resources)e[r++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,r){const s=this.resources[r];e!==s&&(s&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[r]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const r=this.resources;for(const s in r)r[s]._touched=e}destroy(){const e=this.resources;for(const r in e)e[r].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const r=this.resources;for(const s in r)r[s]===e&&(r[s]=null)}else this._updateKey()}}var Ku=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(Ku||{});class Sd extends Ar{constructor(e){super(),this.uid=Fe("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:r,glProgram:s,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=r,this.glProgram=s,o===void 0&&(o=0,r&&(o|=Ku.WEBGPU),s&&(o|=Ku.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!r&&n&&a)for(const c in a)for(const u in a[c]){const h=a[c][u];l[h]={group:c,binding:u,name:h}}else if(r&&n&&!a){const c=r.structsAndGroups.groups;a={},c.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u})}else if(i){n={},a={},r&&r.structsAndGroups.groups.forEach(h=>{a[h.group]=a[h.group]||{},a[h.group][h.binding]=h.name,l[h.name]=h});let c=0;for(const u in i)l[u]||(n[99]||(n[99]=new ba,this._ownedBindGroups.push(n[99])),l[u]={group:99,binding:c,name:u},a[99]=a[99]||{},a[99][c]=u,c++);for(const u in i){const h=u;let d=i[u];!d.source&&!d._resourceType&&(d=new Gb(d));const f=l[h];f&&(n[f.group]||(n[f.group]=new ba,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(d,f.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,l)}addResource(e,r,s){var n,i;(n=this._uniformBindMap)[r]||(n[r]={}),(i=this._uniformBindMap[r])[s]||(i[s]=e),this.groups[r]||(this.groups[r]=new ba,this._ownedBindGroups.push(this.groups[r]))}_buildResourceAccessor(e,r){const s={};for(const n in r){const i=r[n];Object.defineProperty(s,i.name,{get(){return e[i.group].getResource(i.binding)},set(o){e[i.group].setResource(o,i.binding)}})}return s}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:r,gl:s,...n}=e;let i,o;return r&&(i=ul.from(r)),s&&(o=Lb.from(s)),new Sd({gpuProgram:i,glProgram:o,...n})}}var Jo={exports:{}},Qm;function fE(){if(Qm)return Jo.exports;Qm=1,Jo.exports=t,Jo.exports.default=t;function t(q,C,P){P=P||2;var M=C&&C.length,I=M?C[0]*P:q.length,z=e(q,0,I,P,!0),O=[];if(!z||z.next===z.prev)return O;var D,$,L,Q,te,ne,we;if(M&&(z=l(q,C,z,P)),q.length>80*P){D=L=q[0],$=Q=q[1];for(var ue=P;ue<I;ue+=P)te=q[ue],ne=q[ue+1],te<D&&(D=te),ne<$&&($=ne),te>L&&(L=te),ne>Q&&(Q=ne);we=Math.max(L-D,Q-$),we=we!==0?32767/we:0}return s(z,O,P,D,$,we,0),O}function e(q,C,P,M,I){var z,O;if(I===U(q,C,P,M)>0)for(z=C;z<P;z+=M)O=j(z,q[z],q[z+1],O);else for(z=P-M;z>=C;z-=M)O=j(z,q[z],q[z+1],O);return O&&b(O,O.next)&&(B(O),O=O.next),O}function r(q,C){if(!q)return q;C||(C=q);var P=q,M;do if(M=!1,!P.steiner&&(b(P,P.next)||x(P.prev,P,P.next)===0)){if(B(P),P=C=P.prev,P===P.next)break;M=!0}else P=P.next;while(M||P!==C);return C}function s(q,C,P,M,I,z,O){if(q){!O&&z&&f(q,M,I,z);for(var D=q,$,L;q.prev!==q.next;){if($=q.prev,L=q.next,z?i(q,M,I,z):n(q)){C.push($.i/P|0),C.push(q.i/P|0),C.push(L.i/P|0),B(q),q=L.next,D=L.next;continue}if(q=L,q===D){O?O===1?(q=o(r(q),C,P),s(q,C,P,M,I,z,2)):O===2&&a(q,C,P,M,I,z):s(r(q),C,P,M,I,z,1);break}}}}function n(q){var C=q.prev,P=q,M=q.next;if(x(C,P,M)>=0)return!1;for(var I=C.x,z=P.x,O=M.x,D=C.y,$=P.y,L=M.y,Q=I<z?I<O?I:O:z<O?z:O,te=D<$?D<L?D:L:$<L?$:L,ne=I>z?I>O?I:O:z>O?z:O,we=D>$?D>L?D:L:$>L?$:L,ue=M.next;ue!==C;){if(ue.x>=Q&&ue.x<=ne&&ue.y>=te&&ue.y<=we&&y(I,D,z,$,O,L,ue.x,ue.y)&&x(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function i(q,C,P,M){var I=q.prev,z=q,O=q.next;if(x(I,z,O)>=0)return!1;for(var D=I.x,$=z.x,L=O.x,Q=I.y,te=z.y,ne=O.y,we=D<$?D<L?D:L:$<L?$:L,ue=Q<te?Q<ne?Q:ne:te<ne?te:ne,At=D>$?D>L?D:L:$>L?$:L,He=Q>te?Q>ne?Q:ne:te>ne?te:ne,st=A(we,ue,C,P,M),Mt=A(At,He,C,P,M),oe=q.prevZ,be=q.nextZ;oe&&oe.z>=st&&be&&be.z<=Mt;){if(oe.x>=we&&oe.x<=At&&oe.y>=ue&&oe.y<=He&&oe!==I&&oe!==O&&y(D,Q,$,te,L,ne,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,be.x>=we&&be.x<=At&&be.y>=ue&&be.y<=He&&be!==I&&be!==O&&y(D,Q,$,te,L,ne,be.x,be.y)&&x(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;oe&&oe.z>=st;){if(oe.x>=we&&oe.x<=At&&oe.y>=ue&&oe.y<=He&&oe!==I&&oe!==O&&y(D,Q,$,te,L,ne,oe.x,oe.y)&&x(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;be&&be.z<=Mt;){if(be.x>=we&&be.x<=At&&be.y>=ue&&be.y<=He&&be!==I&&be!==O&&y(D,Q,$,te,L,ne,be.x,be.y)&&x(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function o(q,C,P){var M=q;do{var I=M.prev,z=M.next.next;!b(I,z)&&V(I,M,M.next,z)&&E(I,z)&&E(z,I)&&(C.push(I.i/P|0),C.push(M.i/P|0),C.push(z.i/P|0),B(M),B(M.next),M=q=z),M=M.next}while(M!==q);return r(M)}function a(q,C,P,M,I,z){var O=q;do{for(var D=O.next.next;D!==O.prev;){if(O.i!==D.i&&w(O,D)){var $=R(O,D);O=r(O,O.next),$=r($,$.next),s(O,C,P,M,I,z,0),s($,C,P,M,I,z,0);return}D=D.next}O=O.next}while(O!==q)}function l(q,C,P,M){var I=[],z,O,D,$,L;for(z=0,O=C.length;z<O;z++)D=C[z]*M,$=z<O-1?C[z+1]*M:q.length,L=e(q,D,$,M,!1),L===L.next&&(L.steiner=!0),I.push(g(L));for(I.sort(c),z=0;z<I.length;z++)P=u(I[z],P);return P}function c(q,C){return q.x-C.x}function u(q,C){var P=h(q,C);if(!P)return C;var M=R(P,q);return r(M,M.next),r(P,P.next)}function h(q,C){var P=C,M=q.x,I=q.y,z=-1/0,O;do{if(I<=P.y&&I>=P.next.y&&P.next.y!==P.y){var D=P.x+(I-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(D<=M&&D>z&&(z=D,O=P.x<P.next.x?P:P.next,D===M))return O}P=P.next}while(P!==C);if(!O)return null;var $=O,L=O.x,Q=O.y,te=1/0,ne;P=O;do M>=P.x&&P.x>=L&&M!==P.x&&y(I<Q?M:z,I,L,Q,I<Q?z:M,I,P.x,P.y)&&(ne=Math.abs(I-P.y)/(M-P.x),E(P,q)&&(ne<te||ne===te&&(P.x>O.x||P.x===O.x&&d(O,P)))&&(O=P,te=ne)),P=P.next;while(P!==$);return O}function d(q,C){return x(q.prev,q,C.prev)<0&&x(C.next,q,q.next)<0}function f(q,C,P,M){var I=q;do I.z===0&&(I.z=A(I.x,I.y,C,P,M)),I.prevZ=I.prev,I.nextZ=I.next,I=I.next;while(I!==q);I.prevZ.nextZ=null,I.prevZ=null,m(I)}function m(q){var C,P,M,I,z,O,D,$,L=1;do{for(P=q,q=null,z=null,O=0;P;){for(O++,M=P,D=0,C=0;C<L&&(D++,M=M.nextZ,!!M);C++);for($=L;D>0||$>0&&M;)D!==0&&($===0||!M||P.z<=M.z)?(I=P,P=P.nextZ,D--):(I=M,M=M.nextZ,$--),z?z.nextZ=I:q=I,I.prevZ=z,z=I;P=M}z.nextZ=null,L*=2}while(O>1);return q}function A(q,C,P,M,I){return q=(q-P)*I|0,C=(C-M)*I|0,q=(q|q<<8)&16711935,q=(q|q<<4)&252645135,q=(q|q<<2)&858993459,q=(q|q<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,q|C<<1}function g(q){var C=q,P=q;do(C.x<P.x||C.x===P.x&&C.y<P.y)&&(P=C),C=C.next;while(C!==q);return P}function y(q,C,P,M,I,z,O,D){return(I-O)*(C-D)>=(q-O)*(z-D)&&(q-O)*(M-D)>=(P-O)*(C-D)&&(P-O)*(z-D)>=(I-O)*(M-D)}function w(q,C){return q.next.i!==C.i&&q.prev.i!==C.i&&!k(q,C)&&(E(q,C)&&E(C,q)&&T(q,C)&&(x(q.prev,q,C.prev)||x(q,C.prev,C))||b(q,C)&&x(q.prev,q,q.next)>0&&x(C.prev,C,C.next)>0)}function x(q,C,P){return(C.y-q.y)*(P.x-C.x)-(C.x-q.x)*(P.y-C.y)}function b(q,C){return q.x===C.x&&q.y===C.y}function V(q,C,P,M){var I=v(x(q,C,P)),z=v(x(q,C,M)),O=v(x(P,M,q)),D=v(x(P,M,C));return!!(I!==z&&O!==D||I===0&&_(q,P,C)||z===0&&_(q,M,C)||O===0&&_(P,q,M)||D===0&&_(P,C,M))}function _(q,C,P){return C.x<=Math.max(q.x,P.x)&&C.x>=Math.min(q.x,P.x)&&C.y<=Math.max(q.y,P.y)&&C.y>=Math.min(q.y,P.y)}function v(q){return q>0?1:q<0?-1:0}function k(q,C){var P=q;do{if(P.i!==q.i&&P.next.i!==q.i&&P.i!==C.i&&P.next.i!==C.i&&V(P,P.next,q,C))return!0;P=P.next}while(P!==q);return!1}function E(q,C){return x(q.prev,q,q.next)<0?x(q,C,q.next)>=0&&x(q,q.prev,C)>=0:x(q,C,q.prev)<0||x(q,q.next,C)<0}function T(q,C){var P=q,M=!1,I=(q.x+C.x)/2,z=(q.y+C.y)/2;do P.y>z!=P.next.y>z&&P.next.y!==P.y&&I<(P.next.x-P.x)*(z-P.y)/(P.next.y-P.y)+P.x&&(M=!M),P=P.next;while(P!==q);return M}function R(q,C){var P=new N(q.i,q.x,q.y),M=new N(C.i,C.x,C.y),I=q.next,z=C.prev;return q.next=C,C.prev=q,P.next=I,I.prev=P,M.next=P,P.prev=M,z.next=M,M.prev=z,M}function j(q,C,P,M){var I=new N(q,C,P);return M?(I.next=M.next,I.prev=M,M.next.prev=I,M.next=I):(I.prev=I,I.next=I),I}function B(q){q.next.prev=q.prev,q.prev.next=q.next,q.prevZ&&(q.prevZ.nextZ=q.nextZ),q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function N(q,C,P){this.i=q,this.x=C,this.y=P,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.deviation=function(q,C,P,M){var I=C&&C.length,z=I?C[0]*P:q.length,O=Math.abs(U(q,0,z,P));if(I)for(var D=0,$=C.length;D<$;D++){var L=C[D]*P,Q=D<$-1?C[D+1]*P:q.length;O-=Math.abs(U(q,L,Q,P))}var te=0;for(D=0;D<M.length;D+=3){var ne=M[D]*P,we=M[D+1]*P,ue=M[D+2]*P;te+=Math.abs((q[ne]-q[ue])*(q[we+1]-q[ne+1])-(q[ne]-q[we])*(q[ue+1]-q[ne+1]))}return O===0&&te===0?0:Math.abs((te-O)/O)};function U(q,C,P,M){for(var I=0,z=C,O=P-M;z<P;z+=M)I+=(q[O]-q[z])*(q[z+1]+q[O+1]),O=z;return I}return t.flatten=function(q){for(var C=q[0][0].length,P={vertices:[],holes:[],dimensions:C},M=0,I=0;I<q.length;I++){for(var z=0;z<q[I].length;z++)for(var O=0;O<C;O++)P.vertices.push(q[I][z][O]);I>0&&(M+=q[I-1].length,P.holes.push(M))}return P},Jo.exports}var pE=fE();const mE=rt(pE);class Wb extends Ar{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Be(pt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Be(pt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Be(pt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Be(pt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Be(pt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)this.chars[r].texture?.destroy();this.chars=null,e&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Km=[{offset:0,color:"white"},{offset:1,color:"black"}],kd=class Xu{constructor(...e){this.uid=Fe("fillGradient"),this.type="linear",this.colorStops=[];let r=gE(e);r={...r.type==="radial"?Xu.defaultRadialOptions:Xu.defaultLinearOptions,...hb(r)},this._textureSize=r.textureSize,r.type==="radial"?(this.center=r.center,this.outerCenter=r.outerCenter??this.center,this.innerRadius=r.innerRadius,this.outerRadius=r.outerRadius,this.scale=r.scale,this.rotation=r.rotation):(this.start=r.start,this.end=r.end),this.textureSpace=r.textureSpace,this.type=r.type,r.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(e,r){return this.colorStops.push({offset:e,color:lt.shared.setValue(r).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Km,r=this._textureSize,{canvas:s,context:n}=Jm(r,1),i=n.createLinearGradient(0,0,this._textureSize,0);Xm(i,e),n.fillStyle=i,n.fillRect(0,0,r,1),this.texture=new pe({source:new Os({resource:s})});const{x:o,y:a}=this.start,{x:l,y:c}=this.end,u=new me,h=l-o,d=c-a,f=Math.sqrt(h*h+d*d),m=Math.atan2(d,h);u.scale(f/r,1),u.rotate(m),u.translate(o,a),this.textureSpace==="local"&&u.scale(r,r),this.transform=u}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:Km,r=this._textureSize,{canvas:s,context:n}=Jm(r,r),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,h=a-u,d=l-u,f=r/(u*2),m=(i-h)*f,A=(o-d)*f,g=n.createRadialGradient(m,A,c*f,(a-h)*f,(l-d)*f,u*f);Xm(g,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,r,r),n.fillStyle=g,n.translate(m,A),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-A),n.fillRect(0,0,r,r),this.texture=new pe({source:new Os({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const y=new me;y.scale(1/f,1/f),y.translate(h,d),this.textureSpace==="local"&&y.scale(r,r),this.transform=y}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}};kd.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};kd.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let Xr=kd;function Xm(t,e){for(let r=0;r<e.length;r++){const s=e[r];t.addColorStop(s.offset,s.color)}}function Jm(t,e){const r=Qe.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}function gE(t){let e=t[0]??{};return(typeof e=="number"||t[1])&&(Be("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??Xr.defaultLinearOptions.textureSize}),e}const Zm={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class hl{constructor(e,r){this.uid=Fe("fillPattern"),this.transform=new me,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),r&&(e.source.style.addressModeU=Zm[r].addressModeU,e.source.style.addressModeV=Zm[r].addressModeV)}setTransform(e){const r=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/r.frame.width,1/r.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var _c,eg;function AE(){if(eg)return _c;eg=1,_c=r;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function r(i){var o=[];return i.replace(e,function(a,l,c){var u=l.toLowerCase();for(c=n(c),u=="m"&&c.length>2&&(o.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==t[u])return c.unshift(l),o.push(c);if(c.length<t[u])throw new Error("malformed path data");o.push([l].concat(c.splice(0,t[u])))}}),o}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(s);return o?o.map(Number):[]}return _c}var yE=AE();const xE=rt(yE);function bE(t,e){const r=xE(t),s=[];let n=null,i=0,o=0;for(let a=0;a<r.length;a++){const l=r[a],c=l[0],u=l;switch(c){case"M":i=u[1],o=u[2],e.moveTo(i,o);break;case"m":i+=u[1],o+=u[2],e.moveTo(i,o);break;case"H":i=u[1],e.lineTo(i,o);break;case"h":i+=u[1],e.lineTo(i,o);break;case"V":o=u[1],e.lineTo(i,o);break;case"v":o+=u[1],e.lineTo(i,o);break;case"L":i=u[1],o=u[2],e.lineTo(i,o);break;case"l":i+=u[1],o+=u[2],e.lineTo(i,o);break;case"C":i=u[5],o=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],i,o);break;case"c":e.bezierCurveTo(i+u[1],o+u[2],i+u[3],o+u[4],i+u[5],o+u[6]),i+=u[5],o+=u[6];break;case"S":i=u[3],o=u[4],e.bezierCurveToShort(u[1],u[2],i,o);break;case"s":e.bezierCurveToShort(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"Q":i=u[3],o=u[4],e.quadraticCurveTo(u[1],u[2],i,o);break;case"q":e.quadraticCurveTo(i+u[1],o+u[2],i+u[3],o+u[4]),i+=u[3],o+=u[4];break;case"T":i=u[1],o=u[2],e.quadraticCurveToShort(i,o);break;case"t":i+=u[1],o+=u[2],e.quadraticCurveToShort(i,o);break;case"A":i=u[6],o=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"a":i+=u[6],o+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],i,o);break;case"Z":case"z":e.closePath(),s.length>0&&(n=s.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:Ee(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&n===null&&(n={startX:i,startY:o},s.push(n))}return e}class Cd{constructor(e=0,r=0,s=0){this.type="circle",this.x=e,this.y=r,this.radius=s}clone(){return new Cd(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-e,i=this.y-r;return n*=n,i*=i,n+i<=s}strokeContains(e,r,s,n=.5){if(this.radius===0)return!1;const i=this.x-e,o=this.y-r,a=this.radius,l=(1-n)*s,c=Math.sqrt(i*i+o*o);return c<=a+l&&c>a-(s-l)}getBounds(e){return e||(e=new De),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Pd{constructor(e=0,r=0,s=0,n=0){this.type="ellipse",this.x=e,this.y=r,this.halfWidth=s,this.halfHeight=n}clone(){return new Pd(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,r){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,n=(r-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(e,r,s,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=s*(1-n),l=s-a,c=i-l,u=o-l,h=i+a,d=o+a,f=e-this.x,m=r-this.y,A=f*f/(c*c)+m*m/(u*u),g=f*f/(h*h)+m*m/(d*d);return A>1&&g<=1}getBounds(e){return e||(e=new De),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function wE(t,e,r,s,n,i){const o=t-r,a=e-s,l=n-r,c=i-s,u=o*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,m;d<0?(f=r,m=s):d>1?(f=n,m=i):(f=r+d*l,m=s+d*c);const A=t-f,g=e-m;return A*A+g*g}let qE,vE;class Ci{constructor(...e){this.type="polygon";let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const s=[];for(let n=0,i=r.length;n<i;n++)s.push(r[n].x,r[n].y);r=s}this.points=r,this.closePath=!0}isClockwise(){let e=0;const r=this.points,s=r.length;for(let n=0;n<s;n+=2){const i=r[n],o=r[n+1],a=r[(n+2)%s],l=r[(n+3)%s];e+=(a-i)*(l+o)}return e<0}containsPolygon(e){const r=this.getBounds(qE),s=e.getBounds(vE);if(!r.containsRect(s))return!1;const n=e.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const e=this.points.slice(),r=new Ci(e);return r.closePath=this.closePath,r}contains(e,r){let s=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],l=this.points[i*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(s=!s)}return s}strokeContains(e,r,s,n=.5){const i=s*s,o=i*(1-n),a=i-o,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const h=l[u],d=l[u+1],f=l[(u+2)%l.length],m=l[(u+3)%l.length],A=wE(e,r,h,d,f,m),g=Math.sign((f-h)*(r-d)-(m-d)*(e-h));if(A<=(g<0?a:o))return!0}return!1}getBounds(e){e||(e=new De);const r=this.points;let s=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,l=r.length;a<l;a+=2){const c=r[a],u=r[a+1];s=c<s?c:s,n=c>n?c:n,i=u<i?u:i,o=u>o?u:o}return e.x=s,e.width=n-s,e.y=i,e.height=o-i,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Zo=(t,e,r,s,n,i,o)=>{const a=t-r,l=e-s,c=Math.sqrt(a*a+l*l);return c>=n-i&&c<=n+o};class Ed{constructor(e=0,r=0,s=0,n=0,i=20){this.type="roundedRectangle",this.x=e,this.y=r,this.width=s,this.height=n,this.radius=i}getBounds(e){return e||(e=new De),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Ed(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let n=e-(this.x+s),i=r-(this.y+s);const o=s*s;if(n*n+i*i<=o||(n=e-(this.x+this.width-s),n*n+i*i<=o)||(i=r-(this.y+this.height-s),n*n+i*i<=o)||(n=e-(this.x+s),n*n+i*i<=o))return!0}return!1}strokeContains(e,r,s,n=.5){const{x:i,y:o,width:a,height:l,radius:c}=this,u=s*(1-n),h=s-u,d=i+c,f=o+c,m=a-c*2,A=l-c*2,g=i+a,y=o+l;return(e>=i-u&&e<=i+h||e>=g-h&&e<=g+u)&&r>=f&&r<=f+A||(r>=o-u&&r<=o+h||r>=y-h&&r<=y+u)&&e>=d&&e<=d+m?!0:e<d&&r<f&&Zo(e,r,d,f,c,h,u)||e>g-c&&r<f&&Zo(e,r,g-c,f,c,h,u)||e>g-c&&r>y-c&&Zo(e,r,g-c,y-c,c,h,u)||e<d&&r>y-c&&Zo(e,r,d,y-c,c,h,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const VE=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function _E(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function SE(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=VE.replace(/%forloop%/gi,_E(t));if(e.shaderSource(r,s),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(r)}return t}let tn=null;function Yb(){if(tn)return tn;const t=Db();return tn=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),tn=SE(tn,t),t.getExtension("WEBGL_lose_context")?.loseContext(),tn}const Qb={};function kE(t,e){let r=2166136261;for(let s=0;s<e;s++)r^=t[s].uid,r=Math.imul(r,16777619),r>>>=0;return Qb[r]||CE(t,e,r)}let Sc=0;function CE(t,e,r){const s={};let n=0;Sc||(Sc=Yb());for(let o=0;o<Sc;o++){const a=o<e?t[o]:pe.EMPTY.source;s[n++]=a.source,s[n++]=a.style}const i=new ba(s);return Qb[r]=i,i}class tg{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function rg(t,e){const r=t.byteLength/8|0,s=new Float64Array(t,0,r);new Float64Array(e,0,r).set(s);const i=t.byteLength-r*8;if(i>0){const o=new Uint8Array(t,r*8,i);new Uint8Array(e,r*8,i).set(o)}}const PE={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var EE=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",t[t.NONE=5]="NONE",t))(EE||{});function sg(t,e){return e.alphaMode==="no-premultiply-alpha"&&PE[t]||t}class TE{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const r=this.textures[e];this.textures[e]=null,this.ids[r.uid]=null}this.count=0}}class RE{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new TE,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Kb=[];let Ju=0;function ng(){return Ju>0?Kb[--Ju]:new RE}function ig(t){Kb[Ju++]=t}let oi=0;const Xb=class wa{constructor(e={}){this.uid=Fe("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],wa.defaultOptions.maxTextures=wa.defaultOptions.maxTextures??Yb(),e={...wa.defaultOptions,...e};const{maxTextures:r,attributesInitialSize:s,indicesInitialSize:n}=e;this.attributeBuffer=new tg(s*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=r}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)ig(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,r){const s=e._batch.textures.ids[r._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=r,!0)}updateElement(e){this.dirty=!0;const r=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,r.float32View,r.uint32View,e._attributeStart,e._textureId)}break(e){const r=this._elements;if(!r[this.elementStart])return;let s=ng(),n=s.textures;n.clear();const i=r[this.elementStart];let o=sg(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let h=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const m=this.maxTextures;for(let A=this.elementStart;A<this.elementSize;++A){const g=r[A];r[A]=null;const w=g.texture._source,x=sg(g.blendMode,w),b=o!==x||a!==g.topology;if(w._batchTick===oi&&!b){g._textureId=w._textureBindLocation,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=s;continue}w._batchTick=oi,(n.count>=m||b)&&(this._finishBatch(s,d,h-d,n,o,a,e,f),f="renderBatch",d=h,o=x,a=g.topology,s=ng(),n=s.textures,n.clear(),++oi),g._textureId=w._textureBindLocation=n.count,n.ids[w.uid]=n.count,n.textures[n.count++]=w,g._batch=s,h+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,c,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,c,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(s,d,h-d,n,o,a,e,f),d=h,++oi),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=h}_finishBatch(e,r,s,n,i,o,a,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=n,e.blendMode=i,e.topology=o,e.start=r,e.size=s,++oi,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const r=Math.max(e,this.attributeBuffer.size*2),s=new tg(r);rg(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const r=this.indexBuffer;let s=Math.max(e,r.length*1.5);s+=s%2;const n=s>65535?new Uint32Array(s):new Uint16Array(s);if(n.BYTES_PER_ELEMENT!==r.BYTES_PER_ELEMENT)for(let i=0;i<r.length;i++)n[i]=r[i];else rg(r.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,r,s){e[r]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+3]=s+0,e[r+4]=s+2,e[r+5]=s+3}packIndex(e,r,s,n){const i=e.indices,o=e.indexSize,a=e.indexOffset,l=e.attributeOffset;for(let c=0;c<o;c++)r[s++]=n+i[c+a]-l}destroy(){for(let e=0;e<this.batches.length;e++)ig(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Xb.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let ME=Xb;var kt=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(kt||{});let Ui=class extends Ar{constructor(e){let{data:r,size:s}=e;const{usage:n,label:i,shrinkToFit:o}=e;super(),this.uid=Fe("buffer"),this._resourceType="buffer",this._resourceId=Fe("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,r instanceof Array&&(r=new Float32Array(r)),this._data=r,s??(s=r?.byteLength);const a=!!r;this.descriptor={size:s,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&kt.STATIC)}set static(e){e?this.descriptor.usage|=kt.STATIC:this.descriptor.usage&=~kt.STATIC}setDataWithSize(e,r,s){if(this._updateID++,this._updateSize=r*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,this._dataInt32=null,!n||n.length!==e.length){!this.shrinkToFit&&n&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Fe("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Jb(t,e){if(!(t instanceof Ui)){let r=e?kt.INDEX:kt.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),r=kt.INDEX|kt.COPY_DST):(t=new Float32Array(t),r=kt.VERTEX|kt.COPY_DST)),t=new Ui({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return t}function IE(t,e,r){const s=t.getAttribute(e);if(!s)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;const n=s.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const c=n.BYTES_PER_ELEMENT,u=(s.offset||0)/c,h=(s.stride||8)/c;for(let d=u;d<n.length;d+=h){const f=n[d],m=n[d+1];f>a&&(a=f),m>l&&(l=m),f<i&&(i=f),m<o&&(o=m)}return r.minX=i,r.minY=o,r.maxX=a,r.maxY=l,r}function jE(t){return(t instanceof Ui||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Jb(t.buffer,!1),t}class BE extends Ar{constructor(e={}){super(),this.uid=Fe("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new rr,this._boundsDirty=!0;const{attributes:r,indexBuffer:s,topology:n}=e;if(this.buffers=[],this.attributes={},r)for(const i in r)this.addAttribute(i,r[i]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const r=this.attributes[e];return r.buffer.data.length/(r.stride/4||r.size)}return 0}addAttribute(e,r){const s=jE(r);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=Jb(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,IE(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(r=>r.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const OE=new Float32Array(1),zE=new Uint32Array(1);class NE extends BE{constructor(){const r=new Ui({data:OE,label:"attribute-batch-buffer",usage:kt.VERTEX|kt.COPY_DST,shrinkToFit:!1}),s=new Ui({data:zE,label:"index-batch-buffer",usage:kt.INDEX|kt.COPY_DST,shrinkToFit:!1}),n=24;super({attributes:{aPosition:{buffer:r,format:"float32x2",stride:n,offset:0},aUV:{buffer:r,format:"float32x2",stride:n,offset:8},aColor:{buffer:r,format:"unorm8x4",stride:n,offset:16},aTextureIdAndRound:{buffer:r,format:"uint16x2",stride:n,offset:20}},indexBuffer:s})}}function og(t,e,r){if(t)for(const s in t){const n=s.toLocaleLowerCase(),i=e[n];if(i){let o=t[s];s==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(o)}else Ee(`${s} placement hook does not exist in shader`)}}const DE=/\{\{(.*?)\}\}/g;function ag(t){const e={};return(t.match(DE)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{e[s]=[]}),e}function lg(t,e){let r;const s=/@in\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function cg(t,e,r=!1){const s=[];lg(e,s),t.forEach(a=>{a.header&&lg(a.header,s)});const n=s;r&&n.sort();const i=n.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function ug(t,e){let r;const s=/@out\s+([^;]+);/g;for(;(r=s.exec(t))!==null;)e.push(r[1])}function FE(t){const r=/\b(\w+)\s*:/g.exec(t);return r?r[1]:""}function LE(t){const e=/@.*?\s+/g;return t.replace(e,"")}function UE(t,e){const r=[];ug(e,r),t.forEach(l=>{l.header&&ug(l.header,r)});let s=0;const n=r.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),i=r.sort().map(l=>`       var ${LE(l)};`).join(`
`),o=`return VSOutput(
            ${r.sort().map(l=>` ${FE(l)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function hg(t,e){let r=t;for(const s in e){const n=e[s];n.join(`
`).length?r=r.replace(`{{${s}}}`,`//-----${s} START-----//
${n.join(`
`)}
//----${s} FINISH----//`):r=r.replace(`{{${s}}}`,"")}return r}const Hr=Object.create(null),kc=new Map;let HE=0;function $E({template:t,bits:e}){const r=Zb(t,e);if(Hr[r])return Hr[r];const{vertex:s,fragment:n}=WE(t,e);return Hr[r]=ew(s,n,e),Hr[r]}function GE({template:t,bits:e}){const r=Zb(t,e);return Hr[r]||(Hr[r]=ew(t.vertex,t.fragment,e)),Hr[r]}function WE(t,e){const r=e.map(o=>o.vertex).filter(o=>!!o),s=e.map(o=>o.fragment).filter(o=>!!o);let n=cg(r,t.vertex,!0);n=UE(r,n);const i=cg(s,t.fragment,!0);return{vertex:n,fragment:i}}function Zb(t,e){return e.map(r=>(kc.has(r)||kc.set(r,HE++),kc.get(r))).sort((r,s)=>r-s).join("-")+t.vertex+t.fragment}function ew(t,e,r){const s=ag(t),n=ag(e);return r.forEach(i=>{og(i.vertex,s,i.name),og(i.fragment,n,i.name)}),{vertex:hg(t,s),fragment:hg(e,n)}}const YE=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,QE=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,KE=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,XE=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,JE={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},ZE={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function eT({bits:t,name:e}){const r=$E({template:{fragment:QE,vertex:YE},bits:[JE,...t]});return ul.from({name:e,vertex:{source:r.vertex,entryPoint:"main"},fragment:{source:r.fragment,entryPoint:"main"}})}function tT({bits:t,name:e}){return new Lb({name:e,...GE({template:{vertex:KE,fragment:XE},bits:[ZE,...t]})})}const rT={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},sT={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Cc={};function nT(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let r=0;for(let s=0;s<t;s++)e.push(`@group(1) @binding(${r++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${r++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function iT(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let r=0;r<t;r++)r===t-1?e.push("  default:{"):e.push(`  case ${r}:{`),e.push(`      outColor = textureSampleGrad(textureSource${r+1}, textureSampler${r+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function oT(t){return Cc[t]||(Cc[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${nT(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${iT(t)}
            `}}),Cc[t]}const Pc={};function aT(t){const e=[];for(let r=0;r<t;r++)r>0&&e.push("else"),r<t-1&&e.push(`if(vTextureId < ${r}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${r}], vUV);`),e.push("}");return e.join(`
`)}function lT(t){return Pc[t]||(Pc[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${aT(t)}
            `}}),Pc[t]}const cT={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},uT={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},dg={};function hT(t){let e=dg[t];if(e)return e;const r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=s;return e=dg[t]=new Gb({uTextures:{value:r,type:"i32",size:t}},{isStatic:!0}),e}class dT extends Sd{constructor(e){const r=tT({name:"batch",bits:[sT,lT(e),uT]}),s=eT({name:"batch",bits:[rT,oT(e),cT]});super({glProgram:r,gpuProgram:s,resources:{batchSamplers:hT(e)}})}}let fg=null;const tw=class rw extends ME{constructor(){super(...arguments),this.geometry=new NE,this.shader=fg||(fg=new dT(this.maxTextures)),this.name=rw.extension.name,this.vertexSize=6}packAttributes(e,r,s,n,i){const o=i<<16|e.roundPixels&65535,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,{positions:m,uvs:A}=e,g=e.color,y=e.attributeOffset,w=y+e.attributeSize;for(let x=y;x<w;x++){const b=x*2,V=m[b],_=m[b+1];r[n++]=l*V+u*_+d,r[n++]=h*_+c*V+f,r[n++]=A[b],r[n++]=A[b+1],s[n++]=g,s[n++]=o}}packQuadAttributes(e,r,s,n,i){const o=e.texture,a=e.transform,l=a.a,c=a.b,u=a.c,h=a.d,d=a.tx,f=a.ty,m=e.bounds,A=m.maxX,g=m.minX,y=m.maxY,w=m.minY,x=o.uvs,b=e.color,V=i<<16|e.roundPixels&65535;r[n+0]=l*g+u*w+d,r[n+1]=h*w+c*g+f,r[n+2]=x.x0,r[n+3]=x.y0,s[n+4]=b,s[n+5]=V,r[n+6]=l*A+u*w+d,r[n+7]=h*w+c*A+f,r[n+8]=x.x1,r[n+9]=x.y1,s[n+10]=b,s[n+11]=V,r[n+12]=l*A+u*y+d,r[n+13]=h*y+c*A+f,r[n+14]=x.x2,r[n+15]=x.y2,s[n+16]=b,s[n+17]=V,r[n+18]=l*g+u*y+d,r[n+19]=h*y+c*g+f,r[n+20]=x.x3,r[n+21]=x.y3,s[n+22]=b,s[n+23]=V}};tw.extension={type:[ee.Batcher],name:"default"};let fT=tw;function pT(t,e,r,s,n,i,o,a=null){let l=0;r*=e,n*=i;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,m=a.ty;for(;l<o;){const A=t[r],g=t[r+1];s[n]=c*A+h*g+f,s[n+1]=u*A+d*g+m,n+=i,r+=e,l++}}function mT(t,e,r,s){let n=0;for(e*=r;n<s;)t[e]=0,t[e+1]=0,e+=r,n++}function sw(t,e,r,s,n){const i=e.a,o=e.b,a=e.c,l=e.d,c=e.tx,u=e.ty;r||(r=0),s||(s=2),n||(n=t.length/s-r);let h=r*s;for(let d=0;d<n;d++){const f=t[h],m=t[h+1];t[h]=i*f+a*m+c,t[h+1]=o*f+l*m+u,h+=s}}const gT=new me;class nw{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,r=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?wb(r,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):r+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||gT}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Hi={extension:{type:ee.ShapeBuilder,name:"circle"},build(t,e){let r,s,n,i,o,a;if(t.type==="circle"){const b=t;r=b.x,s=b.y,o=a=b.radius,n=i=0}else if(t.type==="ellipse"){const b=t;r=b.x,s=b.y,o=b.halfWidth,a=b.halfHeight,n=i=0}else{const b=t,V=b.width/2,_=b.height/2;r=b.x+V,s=b.y+_,o=a=Math.max(0,Math.min(b.radius,Math.min(V,_))),n=V-o,i=_-a}if(!(o>=0&&a>=0&&n>=0&&i>=0))return e;const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(n?4:0)+(i?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=r+n,e[1]=e[3]=s+i,e[2]=e[4]=r-n,e[5]=e[7]=s-i,e;let u=0,h=l*4+(n?2:0)+2,d=h,f=c,m=n+o,A=i,g=r+m,y=r-m,w=s+A;if(e[u++]=g,e[u++]=w,e[--h]=w,e[--h]=y,i){const b=s-A;e[d++]=y,e[d++]=b,e[--f]=b,e[--f]=g}for(let b=1;b<l;b++){const V=Math.PI/2*(b/l),_=n+Math.cos(V)*o,v=i+Math.sin(V)*a,k=r+_,E=r-_,T=s+v,R=s-v;e[u++]=k,e[u++]=T,e[--h]=T,e[--h]=E,e[d++]=E,e[d++]=R,e[--f]=R,e[--f]=k}m=n,A=i+a,g=r+m,y=r-m,w=s+A;const x=s-A;return e[u++]=g,e[u++]=w,e[--f]=x,e[--f]=g,n&&(e[u++]=y,e[u++]=w,e[--f]=x,e[--f]=y),e},triangulate(t,e,r,s,n,i){if(t.length===0)return;let o=0,a=0;for(let u=0;u<t.length;u+=2)o+=t[u],a+=t[u+1];o/=t.length/2,a/=t.length/2;let l=s;e[l*r]=o,e[l*r+1]=a;const c=l++;for(let u=0;u<t.length;u+=2)e[l*r]=t[u],e[l*r+1]=t[u+1],u>0&&(n[i++]=l,n[i++]=c,n[i++]=l-1),l++;n[i++]=c+1,n[i++]=c,n[i++]=l-1}},AT={...Hi,extension:{...Hi.extension,name:"ellipse"}},yT={...Hi,extension:{...Hi.extension,name:"roundedRectangle"}},iw=1e-4,pg=1e-4;function xT(t){const e=t.length;if(e<6)return 1;let r=0;for(let s=0,n=t[e-2],i=t[e-1];s<e;s+=2){const o=t[s],a=t[s+1];r+=(o-n)*(a+i),n=o,i=a}return r<0?-1:1}function mg(t,e,r,s,n,i,o,a){const l=t-r*n,c=e-s*n,u=t+r*i,h=e+s*i;let d,f;o?(d=s,f=-r):(d=-s,f=r);const m=l+d,A=c+f,g=u+d,y=h+f;return a.push(m,A),a.push(g,y),2}function us(t,e,r,s,n,i,o,a){const l=r-t,c=s-e;let u=Math.atan2(l,c),h=Math.atan2(n-t,i-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,m=Math.abs(f),A=Math.sqrt(l*l+c*c),g=(15*m*Math.sqrt(A)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(t,e),o.push(r,s);for(let w=1,x=d;w<g;w++,x+=y)o.push(t,e),o.push(t+Math.sin(x)*A,e+Math.cos(x)*A);o.push(t,e),o.push(n,i)}else{o.push(r,s),o.push(t,e);for(let w=1,x=d;w<g;w++,x+=y)o.push(t+Math.sin(x)*A,e+Math.cos(x)*A),o.push(t,e);o.push(n,i),o.push(t,e)}return g*2}function bT(t,e,r,s,n,i){const o=iw;if(t.length===0)return;const a=e;let l=a.alignment;if(e.alignment!==.5){let M=xT(t);l=(l-.5)*M+.5}const c=new mt(t[0],t[1]),u=new mt(t[t.length-2],t[t.length-1]),h=s,d=Math.abs(c.x-u.x)<o&&Math.abs(c.y-u.y)<o;if(h){t=t.slice(),d&&(t.pop(),t.pop(),u.set(t[t.length-2],t[t.length-1]));const M=(c.x+u.x)*.5,I=(u.y+c.y)*.5;t.unshift(M,I),t.push(M,I)}const f=n,m=t.length/2;let A=t.length;const g=f.length/2,y=a.width/2,w=y*y,x=a.miterLimit*a.miterLimit;let b=t[0],V=t[1],_=t[2],v=t[3],k=0,E=0,T=-(V-v),R=b-_,j=0,B=0,N=Math.sqrt(T*T+R*R);T/=N,R/=N,T*=y,R*=y;const U=l,q=(1-U)*2,C=U*2;h||(a.cap==="round"?A+=us(b-T*(q-C)*.5,V-R*(q-C)*.5,b-T*q,V-R*q,b+T*C,V+R*C,f,!0)+2:a.cap==="square"&&(A+=mg(b,V,T,R,q,C,!0,f))),f.push(b-T*q,V-R*q),f.push(b+T*C,V+R*C);for(let M=1;M<m-1;++M){b=t[(M-1)*2],V=t[(M-1)*2+1],_=t[M*2],v=t[M*2+1],k=t[(M+1)*2],E=t[(M+1)*2+1],T=-(V-v),R=b-_,N=Math.sqrt(T*T+R*R),T/=N,R/=N,T*=y,R*=y,j=-(v-E),B=_-k,N=Math.sqrt(j*j+B*B),j/=N,B/=N,j*=y,B*=y;const I=_-b,z=V-v,O=_-k,D=E-v,$=I*O+z*D,L=z*O-D*I,Q=L<0;if(Math.abs(L)<.001*Math.abs($)){f.push(_-T*q,v-R*q),f.push(_+T*C,v+R*C),$>=0&&(a.join==="round"?A+=us(_,v,_-T*q,v-R*q,_-j*q,v-B*q,f,!1)+4:A+=2,f.push(_-j*C,v-B*C),f.push(_+j*q,v+B*q));continue}const te=(-T+b)*(-R+v)-(-T+_)*(-R+V),ne=(-j+k)*(-B+v)-(-j+_)*(-B+E),we=(I*ne-O*te)/L,ue=(D*te-z*ne)/L,At=(we-_)*(we-_)+(ue-v)*(ue-v),He=_+(we-_)*q,st=v+(ue-v)*q,Mt=_-(we-_)*C,oe=v-(ue-v)*C,be=Math.min(I*I+z*z,O*O+D*D),yf=Q?q:C,Wq=be+yf*yf*w;At<=Wq?a.join==="bevel"||At/w>x?(Q?(f.push(He,st),f.push(_+T*C,v+R*C),f.push(He,st),f.push(_+j*C,v+B*C)):(f.push(_-T*q,v-R*q),f.push(Mt,oe),f.push(_-j*q,v-B*q),f.push(Mt,oe)),A+=2):a.join==="round"?Q?(f.push(He,st),f.push(_+T*C,v+R*C),A+=us(_,v,_+T*C,v+R*C,_+j*C,v+B*C,f,!0)+4,f.push(He,st),f.push(_+j*C,v+B*C)):(f.push(_-T*q,v-R*q),f.push(Mt,oe),A+=us(_,v,_-T*q,v-R*q,_-j*q,v-B*q,f,!1)+4,f.push(_-j*q,v-B*q),f.push(Mt,oe)):(f.push(He,st),f.push(Mt,oe)):(f.push(_-T*q,v-R*q),f.push(_+T*C,v+R*C),a.join==="round"?Q?A+=us(_,v,_+T*C,v+R*C,_+j*C,v+B*C,f,!0)+2:A+=us(_,v,_-T*q,v-R*q,_-j*q,v-B*q,f,!1)+2:a.join==="miter"&&At/w<=x&&(Q?(f.push(Mt,oe),f.push(Mt,oe)):(f.push(He,st),f.push(He,st)),A+=2),f.push(_-j*q,v-B*q),f.push(_+j*C,v+B*C),A+=2)}b=t[(m-2)*2],V=t[(m-2)*2+1],_=t[(m-1)*2],v=t[(m-1)*2+1],T=-(V-v),R=b-_,N=Math.sqrt(T*T+R*R),T/=N,R/=N,T*=y,R*=y,f.push(_-T*q,v-R*q),f.push(_+T*C,v+R*C),h||(a.cap==="round"?A+=us(_-T*(q-C)*.5,v-R*(q-C)*.5,_-T*q,v-R*q,_+T*C,v+R*C,f,!1)+2:a.cap==="square"&&(A+=mg(_,v,T,R,q,C,!1,f)));const P=pg*pg;for(let M=g;M<A+g-2;++M)b=f[M*2],V=f[M*2+1],_=f[(M+1)*2],v=f[(M+1)*2+1],k=f[(M+2)*2],E=f[(M+2)*2+1],!(Math.abs(b*(v-E)+_*(E-V)+k*(V-v))<P)&&i.push(M,M+1,M+2)}function wT(t,e,r,s){const n=iw;if(t.length===0)return;const i=t[0],o=t[1],a=t[t.length-2],l=t[t.length-1],c=e||Math.abs(i-a)<n&&Math.abs(o-l)<n,u=r,h=t.length/2,d=u.length/2;for(let f=0;f<h;f++)u.push(t[f*2]),u.push(t[f*2+1]);for(let f=0;f<h-1;f++)s.push(d+f,d+f+1);c&&s.push(d+h-1,d)}function ow(t,e,r,s,n,i,o){const a=mE(t,e,2);if(!a)return;for(let c=0;c<a.length;c+=3)i[o++]=a[c]+n,i[o++]=a[c+1]+n,i[o++]=a[c+2]+n;let l=n*s;for(let c=0;c<t.length;c+=2)r[l]=t[c],r[l+1]=t[c+1],l+=s}const qT=[],vT={extension:{type:ee.ShapeBuilder,name:"polygon"},build(t,e){for(let r=0;r<t.points.length;r++)e[r]=t.points[r];return e},triangulate(t,e,r,s,n,i){ow(t,qT,e,r,s,n,i)}},VT={extension:{type:ee.ShapeBuilder,name:"rectangle"},build(t,e){const r=t,s=r.x,n=r.y,i=r.width,o=r.height;return i>=0&&o>=0&&(e[0]=s,e[1]=n,e[2]=s+i,e[3]=n,e[4]=s+i,e[5]=n+o,e[6]=s,e[7]=n+o),e},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[6],e[s+o+1]=t[7],o+=r,e[s+o]=t[4],e[s+o+1]=t[5],o+=r;const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},_T={extension:{type:ee.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,s,n,i){let o=0;s*=r,e[s+o]=t[0],e[s+o+1]=t[1],o+=r,e[s+o]=t[2],e[s+o+1]=t[3],o+=r,e[s+o]=t[4],e[s+o+1]=t[5];const a=s/r;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},ST=new me,kT=new De;function CT(t,e,r,s){const n=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if(e.textureSpace==="local"){const i=r.getBounds(kT);n.translate(-i.x,-i.y),n.scale(1/i.width,1/i.height)}else{n.translate(e.texture.frame.x,e.texture.frame.y),n.scale(1/e.texture.source.width,1/e.texture.source.height);const i=e.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}return s&&n.append(ST.copyFrom(s).invert()),n}const dl={};Et.handleByMap(ee.ShapeBuilder,dl);Et.add(VT,vT,_T,Hi,AT,yT);const PT=new De,ET=new me;function TT(t,e){const{geometryData:r,batches:s}=e;s.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(let n=0;n<t.instructions.length;n++){const i=t.instructions[n];if(i.action==="texture")RT(i.data,s,r);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,c=i.data.hole;o&&c&&gg(c.shapePath,l,!0,s,r),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),gg(a,l,o,s,r)}}}function RT(t,e,r){const{vertices:s,uvs:n,indices:i}=r,o=i.length,a=s.length/2,l=[],c=dl.rectangle,u=PT,h=t.image;u.x=t.dx,u.y=t.dy,u.width=t.dw,u.height=t.dh;const d=t.transform;c.build(u,l),d&&sw(l,d),c.triangulate(l,s,2,a,i,o);const f=h.uvs;n.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const m=Rr.get(nw);m.indexOffset=o,m.indexSize=i.length-o,m.attributeOffset=a,m.attributeSize=s.length/2-a,m.baseColor=t.style,m.alpha=t.alpha,m.texture=h,m.geometryData=r,e.push(m)}function gg(t,e,r,s,n){const{vertices:i,uvs:o,indices:a}=n;t.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const h=a.length,d=i.length/2,f=[],m=dl[l.type];let A="triangle-list";if(m.build(l,f),c&&sw(f,c),r){const x=l.closePath??!0,b=e;b.pixelLine?(wT(f,x,i,a),A="line-list"):bT(f,b,!1,x,i,a)}else if(u){const x=[],b=f.slice();MT(u).forEach(_=>{x.push(b.length/2),b.push(..._)}),ow(b,x,i,2,d,a,h)}else m.triangulate(f,i,2,d,a,h);const g=o.length/2,y=e.texture;if(y!==pe.WHITE){const x=CT(ET,e,l,c);pT(i,2,d,o,g,2,i.length/2-d,x)}else mT(o,g,2,i.length/2-d);const w=Rr.get(nw);w.indexOffset=h,w.indexSize=a.length-h,w.attributeOffset=d,w.attributeSize=i.length/2-d,w.baseColor=e.color,w.alpha=e.alpha,w.texture=y,w.geometryData=n,w.topology=A,s.push(w)})}function MT(t){const e=[];for(let r=0;r<t.length;r++){const s=t[r].shape,n=[];dl[s.type].build(s,n),e.push(n)}return e}class IT{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class jT{constructor(){this.batcher=new fT,this.instructions=new _b}init(){this.instructions.reset()}get geometry(){return Be(eP,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Td=class Zu{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){Zu.defaultOptions.bezierSmoothness=e?.bezierSmoothness??Zu.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let r=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){r?this._cleanGraphicsContextData(e):r=this._initContext(e),TT(e,r);const s=e.batchMode;e.customShader||s==="no-batch"?r.isBatchable=!1:s==="auto"&&(r.isBatchable=r.geometryData.vertices.length<400),e.dirty=!1}return r}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const r=Rr.get(jT),{batches:s,geometryData:n}=this._gpuContextHash[e.uid],i=n.vertices.length,o=n.indices.length;for(let u=0;u<s.length;u++)s[u].applyTransform=!1;const a=r.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let u=0;u<s.length;u++){const h=s[u];a.add(h)}a.finish(r.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=kE(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=r,r}_initContext(e){const r=new IT;return r.context=e,this._gpuContextHash[e.uid]=r,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const r=this._gpuContextHash[e.uid];r.isBatchable||this._graphicsDataContextHash[e.uid]&&(Rr.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),r.batches&&r.batches.forEach(s=>{Rr.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};Td.extension={type:[ee.WebGLSystem,ee.WebGPUSystem,ee.CanvasSystem],name:"graphicsContext"};Td.defaultOptions={bezierSmoothness:.5};let aw=Td;const BT=8,ea=11920929e-14,OT=1;function lw(t,e,r,s,n,i,o,a,l,c){const h=Math.min(.99,Math.max(0,c??aw.defaultOptions.bezierSmoothness));let d=(OT-h)/1;return d*=d,zT(e,r,s,n,i,o,a,l,t,d),t}function zT(t,e,r,s,n,i,o,a,l,c){eh(t,e,r,s,n,i,o,a,l,c,0),l.push(o,a)}function eh(t,e,r,s,n,i,o,a,l,c,u){if(u>BT)return;const h=(t+r)/2,d=(e+s)/2,f=(r+n)/2,m=(s+i)/2,A=(n+o)/2,g=(i+a)/2,y=(h+f)/2,w=(d+m)/2,x=(f+A)/2,b=(m+g)/2,V=(y+x)/2,_=(w+b)/2;if(u>0){let v=o-t,k=a-e;const E=Math.abs((r-o)*k-(s-a)*v),T=Math.abs((n-o)*k-(i-a)*v);if(E>ea&&T>ea){if((E+T)*(E+T)<=c*(v*v+k*k)){l.push(V,_);return}}else if(E>ea){if(E*E<=c*(v*v+k*k)){l.push(V,_);return}}else if(T>ea){if(T*T<=c*(v*v+k*k)){l.push(V,_);return}}else if(v=V-(t+o)/2,k=_-(e+a)/2,v*v+k*k<=c){l.push(V,_);return}}eh(t,e,h,d,y,w,V,_,l,c,u+1),eh(V,_,x,b,A,g,o,a,l,c,u+1)}const NT=8,DT=11920929e-14,FT=1;function LT(t,e,r,s,n,i,o,a){const c=Math.min(.99,Math.max(0,a??aw.defaultOptions.bezierSmoothness));let u=(FT-c)/1;return u*=u,UT(e,r,s,n,i,o,t,u),t}function UT(t,e,r,s,n,i,o,a){th(o,t,e,r,s,n,i,a,0),o.push(n,i)}function th(t,e,r,s,n,i,o,a,l){if(l>NT)return;const c=(e+s)/2,u=(r+n)/2,h=(s+i)/2,d=(n+o)/2,f=(c+h)/2,m=(u+d)/2;let A=i-e,g=o-r;const y=Math.abs((s-i)*g-(n-o)*A);if(y>DT){if(y*y<=a*(A*A+g*g)){t.push(f,m);return}}else if(A=f-(e+i)/2,g=m-(r+o)/2,A*A+g*g<=a){t.push(f,m);return}th(t,e,r,c,u,f,m,a,l+1),th(t,f,m,h,d,i,o,a,l+1)}function cw(t,e,r,s,n,i,o,a){let l=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),a=Math.max(a,3);let c=l/a,u=n;c*=o?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),m=e+d*s,A=r+f*s;t.push(m,A),u+=c}}function HT(t,e,r,s,n,i){const o=t[t.length-2],l=t[t.length-1]-r,c=o-e,u=n-r,h=s-e,d=Math.abs(l*h-c*u);if(d<1e-8||i===0){(t[t.length-2]!==e||t[t.length-1]!==r)&&t.push(e,r);return}const f=l*l+c*c,m=u*u+h*h,A=l*u+c*h,g=i*Math.sqrt(f)/d,y=i*Math.sqrt(m)/d,w=g*A/f,x=y*A/m,b=g*h+y*c,V=g*u+y*l,_=c*(y+w),v=l*(y+w),k=h*(g+x),E=u*(g+x),T=Math.atan2(v-V,_-b),R=Math.atan2(E-V,k-b);cw(t,b+e,V+r,i,T,R,c*u>h*l)}const Pi=Math.PI*2,Ec={centerX:0,centerY:0,ang1:0,ang2:0},Tc=({x:t,y:e},r,s,n,i,o,a,l)=>{t*=r,e*=s;const c=n*t-i*e,u=i*t+n*e;return l.x=c+o,l.y=u+a,l};function $T(t,e){const r=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:r,n=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:n-i*s,y:i+n*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Ag=(t,e,r,s)=>{const n=t*s-e*r<0?-1:1;let i=t*r+e*s;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},GT=(t,e,r,s,n,i,o,a,l,c,u,h,d)=>{const f=Math.pow(n,2),m=Math.pow(i,2),A=Math.pow(u,2),g=Math.pow(h,2);let y=f*m-f*g-m*A;y<0&&(y=0),y/=f*g+m*A,y=Math.sqrt(y)*(o===a?-1:1);const w=y*n/i*h,x=y*-i/n*u,b=c*w-l*x+(t+r)/2,V=l*w+c*x+(e+s)/2,_=(u-w)/n,v=(h-x)/i,k=(-u-w)/n,E=(-h-x)/i,T=Ag(1,0,_,v);let R=Ag(_,v,k,E);a===0&&R>0&&(R-=Pi),a===1&&R<0&&(R+=Pi),d.centerX=b,d.centerY=V,d.ang1=T,d.ang2=R};function WT(t,e,r,s,n,i,o,a=0,l=0,c=0){if(i===0||o===0)return;const u=Math.sin(a*Pi/360),h=Math.cos(a*Pi/360),d=h*(e-s)/2+u*(r-n)/2,f=-u*(e-s)/2+h*(r-n)/2;if(d===0&&f===0)return;i=Math.abs(i),o=Math.abs(o);const m=Math.pow(d,2)/Math.pow(i,2)+Math.pow(f,2)/Math.pow(o,2);m>1&&(i*=Math.sqrt(m),o*=Math.sqrt(m)),GT(e,r,s,n,i,o,l,c,u,h,d,f,Ec);let{ang1:A,ang2:g}=Ec;const{centerX:y,centerY:w}=Ec;let x=Math.abs(g)/(Pi/4);Math.abs(1-x)<1e-7&&(x=1);const b=Math.max(Math.ceil(x),1);g/=b;let V=t[t.length-2],_=t[t.length-1];const v={x:0,y:0};for(let k=0;k<b;k++){const E=$T(A,g),{x:T,y:R}=Tc(E[0],i,o,h,u,y,w,v),{x:j,y:B}=Tc(E[1],i,o,h,u,y,w,v),{x:N,y:U}=Tc(E[2],i,o,h,u,y,w,v);lw(t,V,_,T,R,j,B,N,U),V=N,_=U,A+=g}}function YT(t,e,r){const s=(o,a)=>{const l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},n=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let i=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],l=a.radius??r;if(l<=0){n(o,a),i=a;continue}const c=e[(o+1)%e.length],u=s(a,i),h=s(a,c);if(u.len<1e-4||h.len<1e-4){n(o,a),i=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,m=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,m=!0):d>0&&(f=-1,m=!0);const A=d/2;let g,y=Math.abs(Math.cos(A)*l/Math.sin(A));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),g=Math.abs(y*Math.sin(A)/Math.cos(A))):g=l;const w=a.x+h.nx*y+-h.ny*g*f,x=a.y+h.ny*y+h.nx*g*f,b=Math.atan2(u.ny,u.nx)+Math.PI/2*f,V=Math.atan2(h.ny,h.nx)-Math.PI/2*f;o===0&&t.moveTo(w+Math.cos(b)*g,x+Math.sin(b)*g),t.arc(w,x,g,b,V,m),i=a}}function QT(t,e,r,s){const n=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),o=e.length;for(let a=0;a<o;a++){const l=e[(a+1)%o],c=l.radius??r;if(c<=0){a===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y);continue}const u=e[a],h=e[(a+2)%o],d=n(u,l);let f;if(d<1e-4)f=l;else{const g=Math.min(d/2,c);f=i(l,u,g/d)}const m=n(h,l);let A;if(m<1e-4)A=l;else{const g=Math.min(m/2,c);A=i(l,h,g/m)}a===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y),t.quadraticCurveTo(l.x,l.y,A.x,A.y,s)}}const KT=new De;class XT{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new rr,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,r){return this.startPoly(e,r),this}lineTo(e,r){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],i=s[s.length-1];return(n!==e||i!==r)&&s.push(e,r),this}arc(e,r,s,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return cw(a,e,r,s,n,i,o),this}arcTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly.points;return HT(o,e,r,s,n,i),this}arcToSvg(e,r,s,n,i,o,a){const l=this._currentPoly.points;return WT(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,r,s,n,i),this}bezierCurveTo(e,r,s,n,i,o,a){this._ensurePoly();const l=this._currentPoly;return lw(this._currentPoly.points,l.lastX,l.lastY,e,r,s,n,i,o,a),this}quadraticCurveTo(e,r,s,n,i){this._ensurePoly();const o=this._currentPoly;return LT(this._currentPoly.points,o.lastX,o.lastY,e,r,s,n,i),this}closePath(){return this.endPoly(!0),this}addPath(e,r){this.endPoly(),r&&!r.isIdentity()&&(e=e.clone(!0),e.transform(r));const s=this.shapePrimitives,n=s.length;for(let i=0;i<e.instructions.length;i++){const o=e.instructions[i];this[o.action](...o.data)}if(e.checkForHoles&&s.length-n>1){let i=null;for(let o=n;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const l=a.shape,c=i?.shape;c&&c.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):i=a}}}return this}finish(e=!1){this.endPoly(e)}rect(e,r,s,n,i){return this.drawShape(new De(e,r,s,n),i),this}circle(e,r,s,n){return this.drawShape(new Cd(e,r,s),n),this}poly(e,r,s){const n=new Ci(e);return n.closePath=r,this.drawShape(n,s),this}regularPoly(e,r,s,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/n,c=[];for(let u=0;u<n;u++){const h=a-u*l;c.push(e+s*Math.cos(h),r+s*Math.sin(h))}return this.poly(c,!0,o),this}roundPoly(e,r,s,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(e,r,s,n,o);const l=s*Math.sin(Math.PI/n)-.001;i=Math.min(i,l);const c=-1*Math.PI/2+o,u=Math.PI*2/n,h=(n-2)*Math.PI/n/2;for(let d=0;d<n;d++){const f=d*u+c,m=e+s*Math.cos(f),A=r+s*Math.sin(f),g=f+Math.PI+h,y=f-Math.PI-h,w=m+i*Math.cos(g),x=A+i*Math.sin(g),b=m+i*Math.cos(y),V=A+i*Math.sin(y);d===0?this.moveTo(w,x):this.lineTo(w,x),this.quadraticCurveTo(m,A,b,V,a)}return this.closePath()}roundShape(e,r,s=!1,n){return e.length<3?this:(s?QT(this,e,r,n):YT(this,e,r),this.closePath())}filletRect(e,r,s,n,i){if(i===0)return this.rect(e,r,s,n);const o=Math.min(s,n)/2,a=Math.min(o,Math.max(-o,i)),l=e+s,c=r+n,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(e,r+h).arcTo(e+u,r+u,e+h,r,h).lineTo(l-h,r).arcTo(l-u,r+u,l,r+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+s-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,r,s,n,i,o){if(i<=0)return this.rect(e,r,s,n);const a=Math.min(i,Math.min(s,n)/2),l=e+s,c=r+n,u=[e+a,r,l-a,r,l,r+a,l,c-a,l-a,c,e+a,c,e,c-a,e,r+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,o)}ellipse(e,r,s,n,i){return this.drawShape(new Pd(e,r,s,n),i),this}roundRect(e,r,s,n,i,o){return this.drawShape(new Ed(e,r,s,n,i),o),this}drawShape(e,r){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:r}),this}startPoly(e,r){let s=this._currentPoly;return s&&this.endPoly(),s=new Ci,s.points.push(e,r),this._currentPoly=s,this}endPoly(e=!1){const r=this._currentPoly;return r&&r.points.length>2&&(r.closePath=e,this.shapePrimitives.push({shape:r})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Ci,e)){const r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let s=r.shape.x,n=r.shape.y;if(r.transform&&!r.transform.isIdentity()){const i=r.transform,o=s;s=i.a*s+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let r=0;r<e.instructions.length;r++){const s=e.instructions[r];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const r=this.shapePrimitives;for(let s=0;s<r.length;s++){const n=r[s],i=n.shape.getBounds(KT);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}class kn{constructor(e,r=!1){this.instructions=[],this.uid=Fe("graphicsPath"),this._dirty=!0,this.checkForHoles=r,typeof e=="string"?bE(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new XT(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,r){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,r]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,r,s,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(mt.shared);let l=0,c=0;if(!o||o.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=o.data[2],c=o.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,r,s,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,r,s){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(mt.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const l=i.x,c=i.y;o=l+(l-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,r,s]}),this._dirty=!0,this}rect(e,r,s,n,i){return this.instructions.push({action:"rect",data:[e,r,s,n,i]}),this._dirty=!0,this}circle(e,r,s,n){return this.instructions.push({action:"circle",data:[e,r,s,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,r,s,n,i,o,a){i||(i=n/2);const l=-1*Math.PI/2+o,c=s*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?i:n,m=d*u+l;h.push(e+f*Math.cos(m),r+f*Math.sin(m))}return this.poly(h,!0,a),this}clone(e=!1){const r=new kn;if(r.checkForHoles=this.checkForHoles,!e)r.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];r.instructions.push({action:n.action,data:n.data.slice()})}return r}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const r=e.a,s=e.b,n=e.c,i=e.d,o=e.tx,a=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,m=0,A=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],w=y.data;switch(y.action){case"moveTo":case"lineTo":l=w[0],c=w[1],w[0]=r*l+n*c+o,w[1]=s*l+i*c+a;break;case"bezierCurveTo":u=w[0],h=w[1],d=w[2],f=w[3],l=w[4],c=w[5],w[0]=r*u+n*h+o,w[1]=s*u+i*h+a,w[2]=r*d+n*f+o,w[3]=s*d+i*f+a,w[4]=r*l+n*c+o,w[5]=s*l+i*c+a;break;case"quadraticCurveTo":u=w[0],h=w[1],l=w[2],c=w[3],w[0]=r*u+n*h+o,w[1]=s*u+i*h+a,w[2]=r*l+n*c+o,w[3]=s*l+i*c+a;break;case"arcToSvg":l=w[5],c=w[6],m=w[0],A=w[1],w[0]=r*m+n*A,w[1]=s*m+i*A,w[5]=r*l+n*c+o,w[6]=s*l+i*c+a;break;case"circle":w[4]=ai(w[3],e);break;case"rect":w[4]=ai(w[4],e);break;case"ellipse":w[8]=ai(w[8],e);break;case"roundRect":w[5]=ai(w[5],e);break;case"addPath":w[0].transform(e);break;case"poly":w[2]=ai(w[2],e);break;default:Ee("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let r=this.instructions.length-1,s=this.instructions[r];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(r--,r<0)return e.x=0,e.y=0,e;s=this.instructions[r]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function ai(t,e){return t?t.prepend(e):e.clone()}function Re(t,e,r){const s=t.getAttribute(e);return s?Number(s):r}function JT(t,e){const r=t.querySelectorAll("defs");for(let s=0;s<r.length;s++){const n=r[s];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=ZT(o);break;case"radialgradient":e.defs[o.id]=eR();break}}}}function ZT(t){const e=Re(t,"x1",0),r=Re(t,"y1",0),s=Re(t,"x2",1),n=Re(t,"y2",0),i=t.getAttribute("gradientUnits")||"objectBoundingBox",o=new Xr(e,r,s,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<t.children.length;a++){const l=t.children[a],c=Re(l,"offset",0),u=lt.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(c,u)}return o}function eR(t){return Ee("[SVG Parser] Radial gradients are not yet supported"),new Xr(0,0,1,0)}function yg(t){const e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const xg={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function uw(t,e){const r=t.getAttribute("style"),s={},n={},i={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const o in xg){const a=t.getAttribute(o);a&&bg(e,i,o,a.trim())}if(r){const o=r.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[c,u]=l.split(":");xg[c]&&bg(e,i,c,u.trim())}}return{strokeStyle:i.useStroke?s:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function bg(t,e,r,s){switch(r){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=yg(s);e.strokeStyle.fill=t.defs[n]}else e.strokeStyle.color=lt.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=yg(s);e.fillStyle.fill=t.defs[n]}else e.fillStyle.color=lt.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function tR(t,e){if(typeof t=="string"){const o=document.createElement("div");o.innerHTML=t.trim(),t=o.querySelector("svg")}const r={context:e,defs:{},path:new kn};JT(t,r);const s=t.children,{fillStyle:n,strokeStyle:i}=uw(t,r);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&hw(a,r,n,i)}return e}function hw(t,e,r,s){const n=t.children,{fillStyle:i,strokeStyle:o}=uw(t,e);i&&r?r={...r,...i}:i&&(r=i),o&&s?s={...s,...o}:o&&(s=o);const a=!r&&!s;a&&(r={color:0});let l,c,u,h,d,f,m,A,g,y,w,x,b,V,_,v,k;switch(t.nodeName.toLowerCase()){case"path":V=t.getAttribute("d"),t.getAttribute("fill-rule")==="evenodd"&&Ee("SVG Evenodd fill rule not supported, your svg may render incorrectly"),_=new kn(V,!0),e.context.path(_),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"circle":m=Re(t,"cx",0),A=Re(t,"cy",0),g=Re(t,"r",0),e.context.ellipse(m,A,g,g),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"rect":l=Re(t,"x",0),c=Re(t,"y",0),v=Re(t,"width",0),k=Re(t,"height",0),y=Re(t,"rx",0),w=Re(t,"ry",0),y||w?e.context.roundRect(l,c,v,k,y||w):e.context.rect(l,c,v,k),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"ellipse":m=Re(t,"cx",0),A=Re(t,"cy",0),y=Re(t,"rx",0),w=Re(t,"ry",0),e.context.beginPath(),e.context.ellipse(m,A,y,w),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"line":u=Re(t,"x1",0),h=Re(t,"y1",0),d=Re(t,"x2",0),f=Re(t,"y2",0),e.context.beginPath(),e.context.moveTo(u,h),e.context.lineTo(d,f),s&&e.context.stroke(s);break;case"polygon":b=t.getAttribute("points"),x=b.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!0),r&&e.context.fill(r),s&&e.context.stroke(s);break;case"polyline":b=t.getAttribute("points"),x=b.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{Ee(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}a&&(r=null);for(let E=0;E<n.length;E++)hw(n[E],e,r,s)}function rR(t){return lt.isColorLike(t)}function wg(t){return t instanceof hl}function qg(t){return t instanceof Xr}function sR(t){return t instanceof pe}function nR(t,e,r){const s=lt.shared.setValue(e??0);return t.color=s.toNumber(),t.alpha=s.alpha===1?r.alpha:s.alpha,t.texture=pe.WHITE,{...r,...t}}function iR(t,e,r){return t.texture=e,{...r,...t}}function vg(t,e,r){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...r,...t}}function Vg(t,e,r){return e.buildGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...r,...t}}function oR(t,e){const r={...e,...t},s=lt.shared.setValue(r.color);return r.alpha*=s.alpha,r.color=s.toNumber(),r}function Ss(t,e){if(t==null)return null;const r={},s=t;return rR(t)?nR(r,t,e):sR(t)?iR(r,t,e):wg(t)?vg(r,t,e):qg(t)?Vg(r,t,e):s.fill&&wg(s.fill)?vg(s,s.fill,e):s.fill&&qg(s.fill)?Vg(s,s.fill,e):oR(s,e)}function Ua(t,e){const{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...l}=e,c=Ss(t,l);return c?{width:r,alignment:s,miterLimit:n,cap:i,join:o,pixelLine:a,...c}:null}const aR=new mt,_g=new me,Rd=class lr extends Ar{constructor(){super(...arguments),this.uid=Fe("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new kn,this._transform=new me,this._fillStyle={...lr.defaultFillStyle},this._strokeStyle={...lr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new rr,this._boundsDirty=!0}clone(){const e=new lr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Ss(e,lr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Ua(e,lr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Ss(e,lr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Ss(e,lr.defaultStrokeStyle),this}texture(e,r,s,n,i,o){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:n||0,dw:i||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:r?lt.shared.setValue(r).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new kn,this}fill(e,r){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(e!=null&&(r!==void 0&&typeof e=="number"&&(Be(pt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=Ss(e,lr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:r}=this._activePath.getLastPoint(mt.shared);this._activePath.clear(),this._activePath.moveTo(e,r)}stroke(e){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?r=s.data.path:r=this._activePath.clone(),r?(e!=null&&(this._strokeStyle=Ua(e,lr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const r=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(r&&(r.action==="stroke"||r.action==="fill"))if(r.data.hole)r.data.hole.addPath(s);else{r.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,r,s,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*r+a.tx,a.b*e+a.d*r+a.ty,s,n,i,o),this}arcTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}arcToSvg(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,r,s,n,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(e,r,s,n,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*r+l.tx,l.b*e+l.d*r+l.ty,l.a*s+l.c*n+l.tx,l.b*s+l.d*n+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,r,s,n){return this._tick++,this._activePath.ellipse(e,r,s,n,this._transform.clone()),this}circle(e,r,s){return this._tick++,this._activePath.circle(e,r,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,r){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*r+s.tx,s.b*e+s.d*r+s.ty),this}moveTo(e,r){this._tick++;const s=this._transform,n=this._activePath.instructions,i=s.a*e+s.c*r+s.tx,o=s.b*e+s.d*r+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(e,r,s,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*r+o.tx,o.b*e+o.d*r+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,i),this}rect(e,r,s,n){return this._tick++,this._activePath.rect(e,r,s,n,this._transform.clone()),this}roundRect(e,r,s,n,i){return this._tick++,this._activePath.roundRect(e,r,s,n,i,this._transform.clone()),this}poly(e,r){return this._tick++,this._activePath.poly(e,r,this._transform.clone()),this}regularPoly(e,r,s,n,i=0,o){return this._tick++,this._activePath.regularPoly(e,r,s,n,i,o),this}roundPoly(e,r,s,n,i,o){return this._tick++,this._activePath.roundPoly(e,r,s,n,i,o),this}roundShape(e,r,s,n){return this._tick++,this._activePath.roundShape(e,r,s,n),this}filletRect(e,r,s,n,i){return this._tick++,this._activePath.filletRect(e,r,s,n,i),this}chamferRect(e,r,s,n,i,o){return this._tick++,this._activePath.chamferRect(e,r,s,n,i,o),this}star(e,r,s,n,i=0,o=0){return this._tick++,this._activePath.star(e,r,s,n,i,o,this._transform.clone()),this}svg(e){return this._tick++,tR(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,r=e){return this._transform.scale(e,r),this}setTransform(e,r,s,n,i,o){return e instanceof me?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,r,s,n,i,o),this)}transform(e,r,s,n,i,o){return e instanceof me?(this._transform.append(e),this):(_g.set(e,r,s,n,i,o),this._transform.append(_g),this)}translate(e,r=e){return this._transform.translate(e,r),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r],n=s.action;if(n==="fill"){const i=s.data;e.addBounds(i.path.bounds)}else if(n==="texture"){const i=s.data;e.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=s.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;e.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const r=this.instructions;let s=!1;for(let n=0;n<r.length;n++){const i=r[n],o=i.data,a=o.path;if(!i.action||!a)continue;const l=o.style,c=a.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const h=c[u].shape;if(!l||!h)continue;const d=c[u].transform,f=d?d.applyInverse(e,aR):e;if(i.action==="fill")s=h.contains(f.x,f.y);else{const A=l;s=h.strokeContains(f.x,f.y,A.width,A.alignment)}const m=o.hole;if(m){const A=m.shapePath?.shapePrimitives;if(A)for(let g=0;g<A.length;g++)A[g].shape.contains(f.x,f.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Rd.defaultFillStyle={color:16777215,alpha:1,texture:pe.WHITE,matrix:null,fill:null,textureSpace:"local"};Rd.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:pe.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let bs=Rd;const Sg=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function lR(t){const e=[];let r=0;for(let s=0;s<Sg.length;s++){const n=`_${Sg[s]}`;e[r++]=t[n]}return r=dw(t._fill,e,r),r=cR(t._stroke,e,r),r=uR(t.dropShadow,e,r),e.join("-")}function dw(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.styleKey),r}function cR(t,e,r){return t&&(r=dw(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}function uR(t,e,r){return t&&(e[r++]=t.alpha,e[r++]=t.angle,e[r++]=t.blur,e[r++]=t.distance,e[r++]=lt.shared.setValue(t.color).toNumber()),r}const Md=class cn extends Ar{constructor(e={}){super(),hR(e);const r={...cn.defaultTextStyle,...e};for(const s in r){const n=s;this[n]=r[s]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...cn.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...cn.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...bs.defaultFillStyle,...e},()=>{this._fill=Ss({...this._originalFill},bs.defaultFillStyle)})),this._fill=Ss(e===0?"black":e,bs.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...bs.defaultStrokeStyle,...e},()=>{this._stroke=Ua({...this._originalStroke},bs.defaultStrokeStyle)})),this._stroke=Ua(e,bs.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=lR(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=cn.defaultTextStyle;for(const r in e)this[r]=e[r]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new cn({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const s=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,r){return new Proxy(e,{set:(s,n,i)=>(s[n]=i,r?.(n,i),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(lt.isColorLike(e)||e instanceof Xr||e instanceof hl)}};Md.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Md.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let $i=Md;function hR(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const r=$i.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??r.alpha,angle:e.dropShadowAngle??r.angle,blur:e.dropShadowBlur??r.blur,color:e.dropShadowColor??r.color,distance:e.dropShadowDistance??r.distance}}if(e.strokeThickness!==void 0){Be(pt,"strokeThickness is now a part of stroke");const r=e.stroke;let s={};if(lt.isColorLike(r))s.color=r;else if(r instanceof Xr||r instanceof hl)s.fill=r;else if(Object.hasOwnProperty.call(r,"color")||Object.hasOwnProperty.call(r,"fill"))s=r;else throw new Error("Invalid stroke value.");t.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){Be(pt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let r;t.fontSize==null?t.fontSize=$i.defaultTextStyle.fontSize:typeof t.fontSize=="string"?r=parseInt(t.fontSize,10):r=t.fontSize;const s=new Xr({start:{x:0,y:0},end:{x:0,y:(r||0)*1.7}}),n=e.fillGradientStops.map(i=>lt.shared.setValue(i).toNumber());n.forEach((i,o)=>{const a=o/(n.length-1);s.addColorStop(a,i)}),t.fill={fill:s}}}class dR{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,r){const s=Qe.get().createCanvas();s.width=e,s.height=r;const n=s.getContext("2d");return{canvas:s,context:n}}getOptimalCanvasAndContext(e,r,s=1){e=Math.ceil(e*s-1e-6),r=Math.ceil(r*s-1e-6),e=Da(e),r=Da(r);const n=(e<<17)+(r<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,r)),i}returnCanvasAndContext(e){const r=e.canvas,{width:s,height:n}=r,i=(s<<17)+(n<<1);e.context.clearRect(0,0,s,n),this._canvasPool[i].push(e)}clear(){this._canvasPool={}}}const kg=new dR,fR=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function rh(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let s=r.length-1;s>=0;s--){let n=r[s].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!fR.includes(n)&&(n=`"${n}"`),r[s]=n}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${r.join(",")}`}const Rc={willReadFrequently:!0},ir=class K{static get experimentalLetterSpacingSupported(){let e=K._experimentalLetterSpacingSupported;if(e!==void 0){const r=Qe.get().getCanvasRenderingContext2D().prototype;e=K._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,s,n,i,o,a,l,c){this.text=e,this.style=r,this.width=s,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",r,s=K._canvas,n=r.wordWrap){const i=`${e}:${r.styleKey}`;if(K._measurementCache[i])return K._measurementCache[i];const o=rh(r),a=K.measureFont(o);a.fontSize===0&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const l=K.__context;l.font=o;const u=(n?K._wordWrap(e,r,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let w=0;w<u.length;w++){const x=K._measureText(u[w],r.letterSpacing,l);h[w]=x,d=Math.max(d,x)}const f=r._stroke?.width||0;let m=d+f;r.dropShadow&&(m+=r.dropShadow.distance);const A=r.lineHeight||a.fontSize;let g=Math.max(A,a.fontSize+f)+(u.length-1)*(A+r.leading);return r.dropShadow&&(g+=r.dropShadow.distance),new K(e,r,m,g,u,h,A+r.leading,d,a)}static _measureText(e,r,s){let n=!1;K.experimentalLetterSpacingSupported&&(K.experimentalLetterSpacing?(s.letterSpacing=`${r}px`,s.textLetterSpacing=`${r}px`,n=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const i=s.measureText(e);let o=i.width;const a=-i.actualBoundingBoxLeft;let c=i.actualBoundingBoxRight-a;if(o>0)if(n)o-=r,c-=r;else{const u=(K.graphemeSegmenter(e).length-1)*r;o+=u,c+=u}return Math.max(o,c)}static _wordWrap(e,r,s=K._canvas){const n=s.getContext("2d",Rc);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=r,h=K._collapseSpaces(u),d=K._collapseNewlines(u);let f=!h;const m=r.wordWrapWidth+c,A=K._tokenize(e);for(let g=0;g<A.length;g++){let y=A[g];if(K._isNewline(y)){if(!d){a+=K._addLine(o),f=!h,o="",i=0;continue}y=" "}if(h){const x=K.isBreakingSpace(y),b=K.isBreakingSpace(o[o.length-1]);if(x&&b)continue}const w=K._getFromCache(y,c,l,n);if(w>m)if(o!==""&&(a+=K._addLine(o),o="",i=0),K.canBreakWords(y,r.breakWords)){const x=K.wordWrapSplit(y);for(let b=0;b<x.length;b++){let V=x[b],_=V,v=1;for(;x[b+v];){const E=x[b+v];if(!K.canBreakChars(_,E,y,b,r.breakWords))V+=E;else break;_=E,v++}b+=v-1;const k=K._getFromCache(V,c,l,n);k+i>m&&(a+=K._addLine(o),f=!1,o="",i=0),o+=V,i+=k}}else{o.length>0&&(a+=K._addLine(o),o="",i=0);const x=g===A.length-1;a+=K._addLine(y,!x),f=!1,o="",i=0}else w+i>m&&(f=!1,a+=K._addLine(o),o="",i=0),(o.length>0||!K.isBreakingSpace(y)||f)&&(o+=y,i+=w)}return a+=K._addLine(o,!1),a}static _addLine(e,r=!0){return e=K._trimRight(e),e=r?`${e}
`:e,e}static _getFromCache(e,r,s,n){let i=s[e];return typeof i!="number"&&(i=K._measureText(e,r,n)+r,s[e]=i),i}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const s=e[r];if(!K.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:K._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:K._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const r=[];let s="";if(typeof e!="string")return r;for(let n=0;n<e.length;n++){const i=e[n],o=e[n+1];if(K.isBreakingSpace(i,o)||K._isNewline(i)){s!==""&&(r.push(s),s=""),r.push(i);continue}s+=i}return s!==""&&r.push(s),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,s,n,i){return!0}static wordWrapSplit(e){return K.graphemeSegmenter(e)}static measureFont(e){if(K._fonts[e])return K._fonts[e];const r=K._context;r.font=e;const s=r.measureText(K.METRICS_STRING+K.BASELINE_SYMBOL),n={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return K._fonts[e]=n,n}static clearMetrics(e=""){e?delete K._fonts[e]:K._fonts={}}static get _canvas(){if(!K.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Rc)?.measureText)return K.__canvas=r,r;e=Qe.get().createCanvas()}catch{e=Qe.get().createCanvas()}e.width=e.height=10,K.__canvas=e}return K.__canvas}static get _context(){return K.__context||(K.__context=K._canvas.getContext("2d",Rc)),K.__context}};ir.METRICS_STRING="|q";ir.BASELINE_SYMBOL="M";ir.BASELINE_MULTIPLIER=1.4;ir.HEIGHT_MULTIPLIER=2;ir.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();ir.experimentalLetterSpacing=!1;ir._fonts={};ir._newlines=[10,13];ir._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ir._measurementCache={};let Cg=ir;const Pg=1e5;function Eg(t,e,r,s=0){if(t.texture===pe.WHITE&&!t.fill)return lt.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof hl){const n=t.fill,i=e.createPattern(n.texture.source.resource,"repeat"),o=n.transform.copyTo(me.shared);return o.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(o),i}else if(t.fill instanceof Xr){const n=t.fill,i=n.type==="linear",o=n.textureSpace==="local";let a=1,l=1;o&&r&&(a=r.width+s,l=r.height+s);let c,u=!1;if(i){const{start:h,end:d}=n;c=e.createLinearGradient(h.x*a,h.y*l,d.x*a,d.y*l),u=Math.abs(d.x-h.x)<Math.abs((d.y-h.y)*.1)}else{const{center:h,innerRadius:d,outerCenter:f,outerRadius:m}=n;c=e.createRadialGradient(h.x*a,h.y*l,d*a,f.x*a,f.y*l,m*a)}if(u&&o&&r){const h=r.lineHeight/l;for(let d=0;d<r.lines.length;d++){const f=(d*r.lineHeight+s/2)/l;n.colorStops.forEach(m=>{const A=f+m.offset*h;c.addColorStop(Math.floor(A*Pg)/Pg,lt.shared.setValue(m.color).toHex())})}}else n.colorStops.forEach(h=>{c.addColorStop(h.offset,lt.shared.setValue(h.color).toHex())});return c}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(me.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(i),n}return Ee("FillStyle not recognised",t),"red"}function fw(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let r=0,s=t.length;r<s;r++){const n=t[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const pw=class mw extends Wb{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const r={...mw.defaultOptions,...e};this._textureSize=r.textureSize,this._mipmap=r.mipmap;const s=r.style.clone();r.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=pe.WHITE,s._fill.fill=null),this.applyFillAsTint=r.overrideFill;const n=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const i=rh(s);r.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/n):s.fontSize=this.baseRenderedFontSize=n,this._style=s,this._skipKerning=r.skipKerning??!1,this.resolution=r.resolution??1,this._padding=r.padding??4,this.fontMetrics=Cg.measureFont(i),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){const r=fw(e).filter(g=>!this._currentChars.includes(g)).filter((g,y,w)=>w.indexOf(g)===y);if(!r.length)return;this._currentChars=[...this._currentChars,...r];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:n,context:i}=s.canvasAndContext,o=s.texture.source;const a=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u;let d=0,f=!1;const m=n.width/this.resolution,A=n.height/this.resolution;for(let g=0;g<r.length;g++){const y=r[g],w=Cg.measureText(y,a,n,!1);w.lineHeight=w.height;const x=w.width*u,b=Math.ceil((a.fontStyle==="italic"?2:1)*x),V=w.height*u,_=b+h*2,v=V+h*2;if(f=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(f=!0,d=Math.ceil(Math.max(v,d))),l+_>m&&(c+=d,d=v,l=0,c+d>A)){o.update();const E=this._nextPage();n=E.canvasAndContext.canvas,i=E.canvasAndContext.context,o=E.texture.source,c=0}const k=x/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:k,kerning:{}},f){this._drawGlyph(i,w,l+h,c+h,u,a);const E=o.width*u,T=o.height*u,R=new De(l/E*o.width,c/T*o.height,_/E*o.width,v/T*o.height);this.chars[y].texture=new pe({source:o,frame:R}),l+=Math.ceil(_)}}o.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(r,i)}get pageTextures(){return Be(pt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,r){const s=this._measureCache;for(let n=0;n<e.length;n++){const i=e[n];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=s[i];l||(l=s[i]=r.measureText(i).width);let c=s[a];c||(c=s[a]=r.measureText(a).width);let u=r.measureText(i+a).width,h=u-(l+c);h&&(this.chars[i].kerning[a]=h),u=r.measureText(i+a).width,h=u-(l+c),h&&(this.chars[a].kerning[i]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,r=kg.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(r.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new pe({source:new Os({resource:r.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),i={canvasAndContext:r,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(e,r,s){r.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=rh(r),r.fontSize=this.baseMeasurementFontSize,e.textBaseline=r.textBaseline;const n=r._stroke,i=n?.width??0;if(n&&(e.lineWidth=i,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=Eg(n,e)),r._fill&&(e.fillStyle=Eg(r._fill,e)),r.dropShadow){const o=r.dropShadow,a=lt.shared.setValue(o.color).toArray(),l=o.blur*s,c=o.distance*s;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(o.angle)*c,e.shadowOffsetY=Math.sin(o.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,r,s,n,i,o){const a=r.text,l=r.fontProperties,u=(o._stroke?.width??0)*i,h=s+u/2,d=n-u/2,f=l.descent*i,m=r.lineHeight*i;o.stroke&&u&&e.strokeText(a,h,d+m-f),o._fill&&e.fillText(a,h,d+m-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:r,texture:s}=this.pages[e];kg.returnCanvasAndContext(r),s.destroy(!0)}this.pages=null}};pw.defaultOptions={textureSize:512,style:new $i,mipmap:!0};let Tg=pw;function pR(t,e,r,s){const n={width:0,height:0,offsetY:0,scale:e.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=r.baseLineOffset;let i=n.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},c=m=>{const A=i.width;for(let g=0;g<l.index;g++){const y=m.positions[g];i.chars.push(m.chars[g]),i.charPositions.push(y+A)}i.width+=m.width,a=!1,l.width=0,l.index=0,l.chars.length=0},u=()=>{let m=i.chars.length-1;if(s){let A=i.chars[m];for(;A===" ";)i.width-=r.chars[A].xAdvance,A=i.chars[--m]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,n.lines.push(i),n.height+=r.lineHeight},h=r.baseMeasurementFontSize/e.fontSize,d=e.letterSpacing*h,f=e.wordWrapWidth*h;for(let m=0;m<t.length+1;m++){let A;const g=m===t.length;g||(A=t[m]);const y=r.chars[A]||r.chars[" "];if(/(?:\s)/.test(A)||A==="\r"||A===`
`||g){if(!a&&e.wordWrap&&i.width+l.width-d>f?(u(),c(l),g||i.charPositions.push(0)):(l.start=i.width,c(l),g||i.charPositions.push(0)),A==="\r"||A===`
`)i.width!==0&&u();else if(!g){const V=y.xAdvance+(y.kerning[o]||0)+d;i.width+=V,i.spaceWidth=V,i.spacesIndex.push(i.charPositions.length),i.chars.push(A)}}else{const b=y.kerning[o]||0,V=y.xAdvance+b+d;l.positions[l.index++]=l.width+b,l.chars.push(A),l.width+=V}o=A}return u(),e.align==="center"?mR(n):e.align==="right"?gR(n):e.align==="justify"&&AR(n),n}function mR(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width/2-r.width/2;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function gR(t){for(let e=0;e<t.lines.length;e++){const r=t.lines[e],s=t.width-r.width;for(let n=0;n<r.charPositions.length;n++)r.charPositions[n]+=s}}function AR(t){const e=t.width;for(let r=0;r<t.lines.length;r++){const s=t.lines[r];let n=0,i=s.spacesIndex[n++],o=0;const a=s.spacesIndex.length,c=(e-s.width)/a;for(let u=0;u<s.charPositions.length;u++)u===i&&(i=s.spacesIndex[n++],o+=c),s.charPositions[u]+=o}}let ta=0;class yR{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,r){let s=`${r.fontFamily}-bitmap`,n=!0;if(r._fill.fill&&!r._stroke)s+=r._fill.fill.styleKey,n=!1;else if(r._stroke||r.dropShadow){let o=r.styleKey;o=o.substring(0,o.lastIndexOf("-")),s=`${o}-bitmap`,n=!1}if(!Ie.has(s)){const o=new Tg({style:r,overrideFill:n,overrideSize:!0,...this.defaultOptions});ta++,ta>50&&Ee("BitmapText",`You have dynamically created ${ta} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{ta--,Ie.remove(s)}),Ie.set(s,o)}const i=Ie.get(s);return i.ensureCharacters?.(e),i}getLayout(e,r,s=!0){const n=this.getFont(e,r);return pR([...e],r,n,s)}measureText(e,r,s=!0){return this.getLayout(e,r,s)}install(...e){let r=e[0];typeof r=="string"&&(r={name:r,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},Be(pt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=r?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");r={...this.defaultOptions,...r};const n=r.style,i=n instanceof $i?n:new $i(n),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new Tg({style:i,overrideFill:o,skipKerning:r.skipKerning,padding:r.padding,resolution:r.resolution,overrideSize:!1}),l=fw(r.chars);return a.ensureCharacters(l.join("")),Ie.set(`${s}-bitmap`,a),a.once("destroy",()=>Ie.remove(`${s}-bitmap`)),a}uninstall(e){const r=`${e}-bitmap`,s=Ie.get(r);s&&s.destroy()}}const Rg=new yR;class gw extends Wb{constructor(e,r){super();const{textures:s,data:n}=e;Object.keys(n.pages).forEach(i=>{const o=n.pages[parseInt(i,10)],a=s[o.id];this.pages.push({texture:a})}),Object.keys(n.chars).forEach(i=>{const o=n.chars[i],{frame:a,source:l}=s[o.page],c=new De(o.x+a.x,o.y+a.y,o.width,o.height),u=new pe({source:l,frame:c});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:u}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=r}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:r}=this.pages[e];r.destroy(!0)}this.pages=null}static install(e){Rg.install(e)}static uninstall(e){Rg.uninstall(e)}}const Mc={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const A in f){const g=f[A].split("="),y=g[0],w=g[1].replace(/"/gm,""),x=parseFloat(w),b=isNaN(x)?w:x;m[y]=b}r[d].push(m)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=r.info,[i]=r.common,[o]=r.distanceField??[];o&&(s.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),s.fontSize=parseInt(n.size,10),s.fontFamily=n.face,s.lineHeight=parseInt(i.lineHeight,10);const a=r.page;for(let h=0;h<a.length;h++)s.pages.push({id:parseInt(a[h].id,10)||0,file:a[h].file});const l={};s.baseLineOffset=s.lineHeight-parseInt(i.base,10);const c=r.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let m=d.letter??d.char??String.fromCharCode(f);m==="space"&&(m=" "),l[f]=m,s.chars[m]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=r.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),m=parseInt(u[h].amount,10);s.chars[l[f]].kerning[l[d]]=m}return s}},Mg={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},r=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(r.getAttribute("size"),10),e.fontFamily=r.getAttribute("face"),e.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let c=0;c<i.length;c++)e.pages.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(s.getAttribute("base"),10);for(let c=0;c<o.length;c++){const u=o[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const u=parseInt(a[c].getAttribute("first"),10),h=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},Ig={test(t){return typeof t=="string"&&t.includes("<font>")?Mg.test(Qe.get().parseXML(t)):!1},parse(t){return Mg.parse(Qe.get().parseXML(t))}},xR=[".xml",".fnt"],bR={extension:{type:ee.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof gw,getCacheableAssets(t,e){const r={};return t.forEach(s=>{r[s]=e,r[`${s}-bitmap`]=e}),r[`${e.fontFamily}-bitmap`]=e,r}},wR={extension:{type:ee.LoadParser,priority:ns.Normal},name:"loadBitmapFont",test(t){return xR.includes(Lt.extname(t).toLowerCase())},async testParse(t){return Mc.test(t)||Ig.test(t)},async parse(t,e,r){const s=Mc.test(t)?Mc.parse(t):Ig.parse(t),{src:n}=e,{pages:i}=s,o=[],a=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<i.length;++h){const d=i[h].file;let f=Lt.join(Lt.dirname(n),d);f=Wu(f,n),o.push({src:f,data:a})}const l=await r.load(o),c=o.map(h=>l[h.src]);return new gw({data:s,textures:c},n)},async load(t,e){return await(await Qe.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(s=>r.unload(s.texture.source._sourceOrigin))),t.destroy()}};class qR{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<r;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const vR={extension:{type:ee.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof pe),getCacheableAssets:(t,e)=>{const r={};return t.forEach(s=>{e.forEach((n,i)=>{r[s+(i===0?"":i+1)]=n})}),r}};async function Aw(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const VR={extension:{type:ee.DetectionParser,priority:1},test:async()=>Aw("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},jg=["png","jpg","jpeg"],_R={extension:{type:ee.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...jg],remove:async t=>t.filter(e=>!jg.includes(e))},SR="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Id(t){return SR?!1:document.createElement("video").canPlayType(t)!==""}const kR={extension:{type:ee.DetectionParser,priority:0},test:async()=>Id("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},CR={extension:{type:ee.DetectionParser,priority:0},test:async()=>Id("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},PR={extension:{type:ee.DetectionParser,priority:0},test:async()=>Id("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},ER={extension:{type:ee.DetectionParser,priority:0},test:async()=>Aw("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class TR{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,s)=>(this._parsersValidated=!1,e[r]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const s={promise:null,parser:null};return s.promise=(async()=>{let n=null,i=null;if(r.loadParser&&(i=this._parserHash[r.loadParser],i||Ee(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,r,this)){i=a;break}}if(!i)return Ee(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,r,this),s.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(n,r,this)&&(n=await a.parse(n,r,this)||n,s.parser=a)}return n})(),s}async load(e,r){this._parsersValidated||this._validateParsers();let s=0;const n={},i=La(e),o=er(e,c=>({alias:[c],src:c,data:{}})),a=o.length,l=o.map(async c=>{const u=Lt.toAbsolute(c.src);if(!n[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),n[c.src]=await this.promiseCache[u].promise,r&&r(++s/a)}catch(h){throw delete this.promiseCache[u],delete n[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),i?n[o[0].src]:n}async unload(e){const s=er(e,n=>({alias:[n],src:n})).map(async n=>{const i=Lt.toAbsolute(n.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,n,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(r.name?e[r.name]&&Ee(`[Assets] loadParser name conflict "${r.name}"`):Ee("[Assets] loadParser should have a name"),{...e,[r.name]:r}),{})}}function Hn(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function $n(t,e){const r=t.split("?")[0],s=Lt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const RR=".json",MR="application/json",IR={extension:{type:ee.LoadParser,priority:ns.Low},name:"loadJson",test(t){return Hn(t,MR)||$n(t,RR)},async load(t){return await(await Qe.get().fetch(t)).json()}},jR=".txt",BR="text/plain",OR={name:"loadTxt",extension:{type:ee.LoadParser,priority:ns.Low,name:"loadTxt"},test(t){return Hn(t,BR)||$n(t,jR)},async load(t){return await(await Qe.get().fetch(t)).text()}},zR=["normal","bold","100","200","300","400","500","600","700","800","900"],NR=[".ttf",".otf",".woff",".woff2"],DR=["font/ttf","font/otf","font/woff","font/woff2"],FR=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function LR(t){const e=Lt.extname(t),n=Lt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=n.length>0;for(const a of n)if(!a.match(FR)){i=!1;break}let o=n.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const UR=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function HR(t){return UR.test(t)?t:encodeURI(t)}const $R={extension:{type:ee.LoadParser,priority:ns.Low},name:"loadWebFont",test(t){return Hn(t,DR)||$n(t,NR)},async load(t,e){const r=Qe.get().getFontFaceSet();if(r){const s=[],n=e.data?.family??LR(t),i=e.data?.weights?.filter(a=>zR.includes(a))??["normal"],o=e.data??{};for(let a=0;a<i.length;a++){const l=i[a],c=new FontFace(n,`url(${HR(t)})`,{...o,weight:l});await c.load(),r.add(c),s.push(c)}return Ie.set(`${n}-and-url`,{url:t,fontFaces:s}),s.length===1?s[0]:s}return Ee("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{Ie.remove(`${e.family}-and-url`),Qe.get().getFontFaceSet().delete(e)})}};function jd(t,e=1){const r=Un.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}function Bd(t,e,r){t.label=r,t._sourceOrigin=r;const s=new pe({source:t,label:r}),n=()=>{delete e.promiseCache[r],Ie.has(r)&&Ie.remove(r)};return s.source.once("destroy",()=>{e.promiseCache[r]&&(Ee("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),s.once("destroy",()=>{t.destroyed||(Ee("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),s}const GR=".svg",WR="image/svg+xml",YR={extension:{type:ee.LoadParser,priority:ns.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return Hn(t,WR)||$n(t,GR)},async load(t,e,r){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?KR(t):QR(t,e,r,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function QR(t,e,r,s){const i=await(await Qe.get().fetch(t)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=s,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),c=l.getContext("2d"),u=e.data?.resolution||jd(t),h=e.data?.width??a.width,d=e.data?.height??a.height;l.width=h*u,l.height=d*u,c.drawImage(a,0,0,h*u,d*u);const{parseAsGraphicsContext:f,...m}=e.data??{},A=new Os({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...m});return Bd(A,r,t)}async function KR(t){const r=await(await Qe.get().fetch(t)).text(),s=new bs;return s.svg(r),s}const XR=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let mn=null,sh=class{constructor(){mn||(mn=URL.createObjectURL(new Blob([XR],{type:"application/javascript"}))),this.worker=new Worker(mn)}};sh.revokeObjectURL=function(){mn&&(URL.revokeObjectURL(mn),mn=null)};const JR=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let gn=null;class yw{constructor(){gn||(gn=URL.createObjectURL(new Blob([JR],{type:"application/javascript"}))),this.worker=new Worker(gn)}}yw.revokeObjectURL=function(){gn&&(URL.revokeObjectURL(gn),gn=null)};let Bg=0,Ic;class ZR{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new sh;r.addEventListener("message",s=>{r.terminate(),sh.revokeObjectURL(),e(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,r){return this._run("loadImageBitmap",[e,r?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Ic===void 0&&(Ic=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Ic&&(this._createdWorkers++,e=new yw().worker,e.addEventListener("message",r=>{this._complete(r.data),this._returnWorker(r.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const s=new Promise((n,i)=>{this._queue.push({id:e,arguments:r,resolve:n,reject:i})});return this._next(),s}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const r=this._queue.pop(),s=r.id;this._resolveHash[Bg]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Bg++,id:s})}}const Og=new ZR,eM=[".jpeg",".jpg",".png",".webp",".avif"],tM=["image/jpeg","image/png","image/webp","image/avif"];async function rM(t,e){const r=await Qe.get().fetch(t);if(!r.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${r.status} ${r.statusText}`);const s=await r.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const xw={name:"loadTextures",extension:{type:ee.LoadParser,priority:ns.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Hn(t,tM)||$n(t,eM)},async load(t,e,r){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Og.isImageBitmapSupported()?s=await Og.loadImageBitmap(t,e):s=await rM(t,e):s=await new Promise((i,o)=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?i(s):(s.onload=()=>{i(s)},s.onerror=o)});const n=new Os({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||jd(t),...e.data});return Bd(n,r,t)},unload(t){t.destroy(!0)}},bw=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],sM=bw.map(t=>`video/${t.substring(1)}`);function nM(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=oM(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}function iM(t){return new Promise((e,r)=>{t.addEventListener("canplaythrough",s),t.addEventListener("error",n),t.load();function s(){i(),e()}function n(o){i(),r(o)}function i(){t.removeEventListener("canplaythrough",s),t.removeEventListener("error",n)}})}function oM(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}const aM={name:"loadVideo",extension:{type:ee.LoadParser,name:"loadVideo"},test(t){const e=Hn(t,sM),r=$n(t,bw);return e||r},async load(t,e,r){const s={...xa.defaultOptions,resolution:e.data?.resolution||jd(t),alphaMode:e.data?.alphaMode||await Ib(),...e.data},n=document.createElement("video"),i={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const c=i[l];c!==void 0&&n.setAttribute(l,c)}),s.muted===!0&&(n.muted=!0),nM(n,t,s.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=xa.MIME_TYPES[l]||`video/${l}`}return o.src=t,a&&(o.type=a),new Promise(l=>{const c=async()=>{const u=new xa({...s,resource:n});n.removeEventListener("canplay",c),e.data.preload&&await iM(n),l(Bd(u,r,t))};n.addEventListener("canplay",c),n.appendChild(o)})},unload(t){t.destroy(!0)}},ww={extension:{type:ee.ResolveParser,name:"resolveTexture"},test:xw.test,parse:t=>({resolution:parseFloat(Un.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},lM={extension:{type:ee.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Un.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:ww.parse};class cM{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Un,this.loader=new TR,this.cache=Ie,this._backgroundLoader=new qR(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){Ee("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let i=e.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const r=e.texturePreference?.resolution??1,s=typeof r=="number"?[r]:r,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:s}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,r){this._initialized||await this.init();const s=La(e),n=er(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,r);return s?o[n[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);let a=0,l=0;const c=()=>{r?.(++a/l)},u=o.map(h=>{const d=n[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{i[h]=f})});return await Promise.all(u),s?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Ie.get(e);const r={};for(let s=0;s<e.length;s++)r[s]=Ie.get(e[s]);return r}async _mapLoadToResolve(e,r){const s=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(s,r);this._backgroundLoader.active=!0;const i={};return s.forEach(o=>{const a=n[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(c=>{i[c]=a}),Ie.set(l,a)}),i}async unload(e){this._initialized||await this.init();const r=er(e).map(n=>typeof n!="string"?n.src:n),s=this.resolver.resolve(r);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=er(e);const r=this.resolver.resolveBundle(e),s=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(s)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(s=>{Ie.remove(s.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const s of e.detections)e.skipDetections||await s.test()?r=await s.add(r):e.skipDetections||(r=await s.remove(r));return r=r.filter((s,n)=>r.indexOf(s)===n),r}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(s=>s in e).forEach(s=>{r.config[s]=e[s]})})}}const yi=new cM;Et.handleByList(ee.LoadParser,yi.loader.parsers).handleByList(ee.ResolveParser,yi.resolver.parsers).handleByList(ee.CacheParser,yi.cache.parsers).handleByList(ee.DetectionParser,yi.detections);Et.add(vR,_R,VR,ER,kR,CR,PR,IR,OR,$R,YR,xw,aM,wR,bR,ww,lM);const zg={loader:ee.LoadParser,resolver:ee.ResolveParser,cache:ee.CacheParser,detection:ee.DetectionParser};Et.handle(ee.Asset,t=>{const e=t.ref;Object.entries(zg).filter(([r])=>!!e[r]).forEach(([r,s])=>Et.add(Object.assign(e[r],{extension:e[r].extension??s})))},t=>{const e=t.ref;Object.keys(zg).filter(r=>!!e[r]).forEach(r=>Et.remove(e[r]))});Et.add(HC,$C);const qw="/assets/sprites-B9UMy6cv.png";let Ei;const uM=async()=>{if(Ei!==void 0)return Ei;let t;try{t=await yi.load(qw)}catch{console.warn("did not load textures - hopefully this is running on a server!"),t=pe.EMPTY}const e=new Yu(t,Nt);return await e.parse(),e.textureSource.scaleMode="nearest",Ei=e,e},hM=()=>{if(Ei===void 0)throw new Error(`spritesheet not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Ei},dM=({className:t,children:e})=>t?p.jsx("div",{className:`contents ${t}`,children:e}):e,fM=t=>t.replaceAll(/(?<!\.)\./g,"_"),F=({children:t,className:e,noSlitWords:r,classnameCycle:s,onClick:n,noTint:i=!1,TagName:o="span",role:a})=>{const l=Array.isArray(t)?t.join(" "):typeof t=="number"?`${t}`:t;if(l.length===0)return null;const c=r?[l.toUpperCase()]:l.toUpperCase().split(/\s+/);return p.jsxs(o,{className:e,onClick:n,children:[p.jsx("span",{className:"sr-only",children:l}),c.map((u,h)=>p.jsx("span",{className:gt("text-nowrap inline-block",h===c.length-1?"":"me-1"),children:Array.from(u).map((d,f)=>{const m=`hud.char.${rb(d)}`;return Du(m)||console.error("no texture for char",d,d.charCodeAt(0),m,"we have:",Object.keys(hM().textures)),p.jsx("span",{role:a,className:`sprite ${Du(m)?`texture-${fM(m)}`:"texture-hud_char_?"}
                  ${i?"":"sprite-tinted"}
                  ${s===void 0?"":s[f%s.length]}`},f)})},h))]})},pM=t=>t.props.children!==void 0,xt=({children:t,className:e})=>p.jsx(dM,{className:e,children:Array.isArray(t)?t.map((r,s)=>p.jsx(xt,{children:r},s)):typeof t=="number"?p.jsx(F,{children:String(t)}):typeof t=="string"?p.jsx(F,{children:t}):S.isValidElement(t)?t.type===F||t.type===xt?t:pM(t)?S.cloneElement(t,void 0,typeof t.props.children=="string"?p.jsx(F,{children:`${t.props.children}`}):p.jsx(xt,{children:t.props.children})):t:t});function H(t,e){const r=Zh();return S.useCallback(()=>{r(t(e))},[t,r,e])}const mM={count:0},Ha=Sr({name:"manualLoading",initialState:mM,reducers:{manualLoadingStarted(t){t.count++},manualLoadingFinished(t){t.count=Math.max(0,t.count-1)}},selectors:{selectManualLoadingCount(t){return t.count}}}),{manualLoadingStarted:gM,manualLoadingFinished:Ng}=Ha.actions,{selectManualLoadingCount:AM}=Ha.selectors,yM=t=>{const{queries:e}=t[Bs.reducerPath],{mutations:r}=t[Bs.reducerPath],s=Object.values(e??{}).some(o=>o?.status==="pending"),n=Object.values(r??{}).some(o=>o?.status==="pending"),i=AM(t)>0;return s||n||i},vw=hx(yM),Ue=({className:t,onClick:e})=>vw()?p.jsx(Qq,{}):p.jsx("div",{className:`fixed inset-0 z-border ${t??""}`,onClick:e});var fl=uy();const xM=rt(fl),An=({children:t,scaleFactor:e})=>{const r=po();return p.jsx("div",{className:"contents set-spritesheet-vars",style:{"--scale":e??r,"--block":`${(e??r)*8}px`},children:t})},Oe=({children:t})=>fl.createPortal(p.jsx(An,{children:t}),document.body),bM=({text:t})=>p.jsxs("div",{className:"flex flex-col h-full items-center justify-center gap-y-1",children:[p.jsx("span",{className:"sprite texture-animated-dalek"}),p.jsx(F,{children:t})]}),wM=()=>p.jsx("div",{className:"flex h-full items-center justify-center loading-border zx:zx-loading-border",children:p.jsx("span",{className:"sprite texture-animated-head_walking_right"})});var Wt={},rn={},sn={},Dg;function pl(){if(Dg)return sn;Dg=1;var t=sn&&sn.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(sn,"__esModule",{value:!0});const r=t(jn()).default.createContext({refs:{},renderItems:{},register:()=>{},unregister:()=>{}});return sn.default=r,sn}var Fg;function qM(){if(Fg)return rn;Fg=1;var t=rn&&rn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(rn,"__esModule",{value:!0});const e=t(jn()),r=t(uy()),s=t(pl()),n=({id:i,children:o})=>{const{refs:a,renderItems:l}=e.default.useContext(s.default),c=a[i],u=l[i];return c?u?r.default.createPortal(u(o),c,i):r.default.createPortal(o,c,i):null};return rn.default=n,rn}var nn={},Lg;function vM(){if(Lg)return nn;Lg=1;var t=nn&&nn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nn,"__esModule",{value:!0});const e=t(jn()),r=t(pl()),s=({id:n,renderItem:i=a=>a,className:o})=>{const{register:a,unregister:l}=e.default.useContext(r.default),c=e.default.useRef(null);return e.default.useEffect(()=>(c.current&&a(n,c.current,i),()=>l(n)),[n,c.current]),e.default.createElement("div",{className:[`portal-placeholder-${n}`,o].filter(u=>!!u).join(" "),ref:c})};return nn.default=s,nn}var Nr={},Ug;function VM(){if(Ug)return Nr;Ug=1;var t=Nr&&Nr.__rest||function(i,o){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&o.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(i);c<l.length;c++)o.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(i,l[c])&&(a[l[c]]=i[l[c]]);return a},e=Nr&&Nr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Nr,"__esModule",{value:!0});const r=e(jn()),s=e(pl()),n=({children:i})=>{const[o,a]=r.default.useState({}),[l,c]=r.default.useState({}),u=r.default.useCallback((f,m,A)=>{a(g=>Object.assign(Object.assign({},g),{[f]:m})),c(g=>Object.assign(Object.assign({},g),{[f]:A}))},[]),h=r.default.useCallback(f=>{a(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])}),c(m=>{const A=m,g=f;return A[g],t(A,[typeof g=="symbol"?g:g+""])})},[]),d=r.default.useMemo(()=>({refs:o,renderItems:l,register:u,unregister:h}),[o,l,u,h]);return r.default.createElement(s.default.Provider,{value:d},i)};return Nr.default=n,Nr}var Hg;function _M(){if(Hg)return Wt;Hg=1;var t=Wt&&Wt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Context=Wt.Placeholder=Wt.Provider=void 0;const e=t(qM()),r=t(vM()),s=t(VM()),n=t(pl());Wt.Provider=s.default,Wt.Placeholder=r.default,Wt.Context=n.default;const i=e.default;return i.Context=n.default,i.Placeholder=r.default,i.Provider=s.default,Wt.default=i,Wt}var SM=_M();const Ls=rt(SM),kM=()=>({directionVector:ae,lookVector:{...ae},...Nn(ex.map(t=>[t,!1]))});var li={},ra={},sa={},$g;function CM(){if($g)return sa;$g=1,sa.__esModule=!0,sa.default=n;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var r={getItem:e,setItem:e,removeItem:e};function s(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var o=self[i],a="redux-persist ".concat(i," test");o.setItem(a,"test"),o.getItem(a),o.removeItem(a)}catch{return!1}return!0}function n(i){var o="".concat(i,"Storage");return s(o)?self[o]:r}return sa}var Gg;function PM(){if(Gg)return ra;Gg=1,ra.__esModule=!0,ra.default=r;var t=e(CM());function e(s){return s&&s.__esModule?s:{default:s}}function r(s){var n=(0,t.default)(s);return{getItem:function(o){return new Promise(function(a,l){a(n.getItem(o))})},setItem:function(o,a){return new Promise(function(l,c){l(n.setItem(o,a))})},removeItem:function(o){return new Promise(function(a,l){a(n.removeItem(o))})}}}return ra}var Wg;function EM(){if(Wg)return li;Wg=1,li.__esModule=!0,li.default=void 0;var t=e(PM());function e(s){return s&&s.__esModule?s:{default:s}}var r=(0,t.default)("local");return li.default=r,li}var TM=EM();const RM=rt(TM),nt=t=>{const e=zu.userSettings;return console.log("migrating state: persisted is:",t,"I am not migrating - reverting to initial/default state:",e),e},MM=q0({1:nt,2:nt,3:nt,4:nt,5:nt,6:nt,7:nt,8:nt,9:nt,10:nt,11:nt,12:nt,13:nt,14:nt,15:nt,16:nt,17:nt}),IM=["userSettings","savedGames"],jM=17,BM={key:"hohol/gameMenus/userSettings",version:jM,migrate:MM,storage:RM,whitelist:IM},OM=m0(BM,mo.reducer),zM=()=>{Pt()!=="server"&&Gy({actionCreator:bd,effect(t,{dispatch:e,getState:r}){const{emulatedResolution:s}=r().gameMenus.userSettings.displaySettings;s!==void 0&&e($x(dd(s)))}})},nh=ZV({[mo.reducerPath]:OM,[za.reducerPath]:za.reducer,[Bs.reducerPath]:Bs.reducer,[Ha.reducerPath]:Ha.reducer}).withLazyLoadedSlices();nh.inject;const NM=(t,e)=>e.type==="@@_RESET_FOR_TESTS"?nh(void 0,e):nh(t,e),xe=yV({reducer:NM,middleware:t=>t({serializableCheck:{ignoredActions:[Lh,lo,Uh,Hh,$h,Gh,dC.type]}}).prepend($y.middleware).concat(Bs.middleware)});typeof window<"u"&&(window._e2e_store=xe);zM();const DM=w0(xe),jc={x:1,y:0,z:0},Bc={x:-1,y:0,z:0},Oc={x:0,y:-1,z:0},zc={x:0,y:1,z:0},ye={away:zc,left:jc,right:Bc,towards:Oc,down:{x:0,y:0,z:-1},up:{x:0,y:0,z:1},awayRight:hn(Z(zc,Bc)),towardsRight:hn(Z(Oc,Bc)),towardsLeft:hn(Z(Oc,jc)),awayLeft:hn(Z(zc,jc))},FM={left:{axis:"x",direction:-1},right:{axis:"x",direction:1},towards:{axis:"y",direction:1},away:{axis:"y",direction:-1},lookLeft:{axis:"xLook",direction:-1},lookRight:{axis:"xLook",direction:1},lookUp:{axis:"yLook",direction:1},lookDown:{axis:"yLook",direction:-1}},Vw=t=>FM[t],LM=Math.cos(13*(Math.PI/180)),Yg=-Math.PI/4,_w=t=>{const e=Math.cos(Yg),r=Math.sin(Yg);return{x:t.x*e-t.y*r,y:t.x*r+t.y*e,z:0}};hn({x:1,y:2,z:0});hn({x:-1,y:2,z:0});const UM=t=>{const e=j0(t);return e===void 0?ae:ye[e]},HM=t=>{const e=Qh(t);return e===void 0?ae:ye[e]},$M=(t,e=LM)=>{const{x:r,y:s}=t,n=Math.sqrt(r*r+s*s);if(n===0)return ae;const i=r/n,o=s/n,a=Math.abs(i),l=Math.abs(o);if(a>l){if(a>=e)return{x:Math.sign(r)*n,y:0,z:0}}else if(l>=e)return{x:0,y:Math.sign(s)*n,z:0};return t},GM={"4-way":UM,"8-way":HM,analogue:$M},WM=t=>t.map(e=>e===null?null:{buttons:e.buttons.map(r=>({pressed:r.pressed})),axes:e.axes.map(r=>r)}),YM={lookLeft:ye.left,lookRight:ye.right,lookUp:ye.away,lookDown:ye.towards},QM=.2,KM=45,XM=(t,e)=>!!t.keyboardState.has(e),Sw=(t,e)=>{for(const r of t.gamepads)if(!(r===null||r.buttons.length<=e)&&r.buttons[e].pressed)return!0;return!1},ih=.5,kw=(t,e,r)=>{for(const s of t.gamepads)if(!(s===null||s.axes.length<=e)){if(r===void 0){if(Math.abs(s.axes[e])>ih)return!0}else if(s.axes[e]*r>ih)return!0}return!1},hs=(t,e,r=!0)=>{const s=Na(xe.getState()),n=s.presses[e];if(t.hudInputState[e])return!0;for(const i of n.keys)if(XM(t,i))return!0;for(const i of n.gamepadButtons)if(Sw(t,i))return!0;if(r){const i=Vw(e);if(i!==void 0){const o=s.axes[i.axis];for(const a of o)if(kw(t,a,i.direction))return!0}}return!1},Qg=t=>{const e=Jy(t);return e>1?vt(t,1/e):t};class JM{constructor(e,r){this.keyboardStateMap=e,this.hudInputState=r}#e=[];#t=ae;#r=ae;actionsHandled=new Set;#i=()=>{const e=this.#e.at(0);if(e===void 0||hs(e,"lookShift",!1))return ae;let r,s,n,i;switch("tap"){case(r=this.currentActionPress("left")):return ye.left;case(s=this.currentActionPress("right")):return ye.right;case(n=this.currentActionPress("away")):return ye.away;case(i=this.currentActionPress("towards")):return ye.towards}const o=(r!=="released"?1:0)+(s!=="released"?1:0)+(n!=="released"?1:0)+(i!=="released"?1:0);if(o>1)return this.#t;if(o===1)switch("hold"){case r:return ye.left;case s:return ye.right;case n:return ye.away;case i:return ye.towards}return ae};*#s(e,r,s){for(const n of r)hs(e,n,!1)&&(yield s[n])}*#n(e,r,s,n,i){const o=Na(xe.getState()).axes,a=o[r],l=o[s];for(const c of e.gamepads){if(c===null)continue;let u=0,h=0;for(const f of a)c.axes.length<=f||(u+=c.axes[f]*n);for(const f of l)c.axes.length<=f||(h+=c.axes[f]*i);const d={x:u,y:h,z:0};zn(d)>QM&&(yield d)}}#a(){const e=this.#e.at(0);if(e===void 0||hs(e,"lookShift",!1))return ae;let r=[...this.#s(e,fn,ye)],s;if(r.length===1){const[n]=r,i=[...Ke(this.#e).drop(1).map(o=>[...this.#s(o,fn,ye)])];e:for(const o of i){if(o.length>2)break e;if(o.length===2&&o.some(a=>Yh(a,n))){const a=o.find(l=>Ma(l,n)<.001);if(a!==void 0){s=a;break e}}}if(!s)for(const o of i)o.length===0&&(r=ma)}return Z(s??ae,...r,...this.#n(e,"x","y",-1,-1))}#l(){const e=this.#e.at(0);if(e===void 0)return ae;const r=hs(e,"lookShift",!1);return Qg(Z(...this.#s(e,Zy,YM),...this.#n(e,"xLook","yLook",-1,-1),...r?this.#s(e,fn,ye):ma,...r?this.#n(e,"x","y",-1,-1):ma))}#o=({lastTime:e})=>{const r=gd(xe.getState()),i=Z1(xe.getState())&&r?_w:u=>u,o=GM[r];this.#t=Qg(o(Z(i(r==="4-way"?this.#i():this.#a()),this.hudInputState.directionVector))),this.#r=this.#l();const a={keyboardState:new Map(this.keyboardStateMap),hudInputState:{...this.hudInputState},gamepads:WM(navigator.getGamepads()),atTime:e};this.#e.unshift(a);const l=e-KM,c=this.#e.findIndex(u=>u.atTime<l);c!==-1&&this.#e.splice(c+1);for(const u of this.actionsHandled)hs(a,u)||this.actionsHandled.delete(u)};currentActionPress(e){const r=this.#e.at(0);if(r===void 0)return"released";const s=hs(r,e);if(this.actionsHandled.has(e))return"released";if(s){const n=this.#e.at(1);return(n===void 0?!1:hs(n,e))?"hold":"tap"}return"released"}inputTap(){const e=this.#e.at(0),r=this.#e.at(1);if(e!==void 0){for(const s of this.keyboardStateMap.keys())if(r===void 0||!r.keyboardState.has(s))return{type:"key",input:s};for(const s of e.gamepads)if(s!==null){for(const[n,i]of s.buttons.entries())if(i.pressed&&(r===void 0||!Sw(r,n)))return{type:"gamepadButtons",input:n};for(const[n,i]of s.axes.entries())if(Math.abs(i)>ih&&(r===void 0||!kw(r,n)))return{type:"gamepadAxes",input:n}}}}get directionVector(){return this.#t}get lookVector(){return this.#r}startTicking(){Ct.shared.add(this.#o,void 0,Fa.INTERACTION)}stopTicking(){Ct.shared.remove(this.#o)}}const ZM=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","","0","1","2","3","4","5","6","7","8","9","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","]","{","}",";",":","'",'"',",",".","/","<",">","?","\\","|"," ","Enter","Shift","Control","Alt","Meta","`","~","Tab","Backspace","Delete","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Numpad+","Numpad-","Numpad*","Numpad/","Numpad.","NumpadEnter","Numpad=","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Escape",""],eI=t=>ZM.includes(t);let tI=1;const rI=()=>tI++,sI=3,Kg=({key:t,location:e,repeat:r})=>{if(r)return;const s=t.length===1?t.toUpperCase():t,n=e===sI?`Numpad${s}`:s;if(eI(n))return n;console.warn("unrecognised key",t)},nI=()=>new Map,iI=t=>{const e=n=>{const i=Kg(n);i!==void 0&&t.set(i,rI())},r=n=>{const i=Kg(n);i!==void 0&&t.delete(i)},s=()=>{t.clear()};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",r,!1),window.addEventListener("blur",s,!1),()=>{window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",r,!1),window.removeEventListener("blur",s,!1)}},Cw=S.createContext(null),oI=({children:t})=>{const[e]=S.useState(nI),[r]=S.useState(()=>new JM(e,kM()));return S.useEffect(()=>{const s=iI(e);return r.startTicking(),()=>{s(),r.stopTicking()}},[r,e]),p.jsx(Cw,{value:r,children:t})},Od=()=>{const t=S.useContext(Cw);if(t===null)throw new Error("InputStateProvider required to use useInputState");return t},dt=({handler:t,action:e,disabled:r=!1})=>{const s=S.useMemo(()=>Array.isArray(e)?e:[e],[e]),n=Od();S.useEffect(()=>{if(r)return;const i=()=>{for(const o of s)if(n.currentActionPress(o)==="tap"){if(!t(o))for(const c of s)n.actionsHandled.add(c);break}};return Ct.shared.add(i),()=>{Ct.shared.remove(i)}},[s,r,n,t])},aI=({handler:t,disabled:e=!1})=>{const r=Od();S.useEffect(()=>{if(e)return;const s=()=>{const n=r.inputTap();n!==void 0&&t(n,r)};return Ct.shared.add(s),()=>{Ct.shared.remove(s)}},[e,t,r])},lI=({flip:t=!1,focussed:e=!1,verticalAlignItemsCentre:r=!1})=>p.jsx(F,{className:"inline-block col-start-1 w-min mx-auto "+(t?"scale-[-1] relative bottom-oneScaledPix":"")+(r===!0?"flex items-center h-3":""),children:e?"":""}),Cn="data-menuitem_id",Pw="data-menuitem_hidden",Ew="data-menuitem_disabled",cI=["menu_select","swop","jump"],uI=()=>{},Tw=({id:t,hidden:e=!1,disabled:r=!1,onSelect:s=uI})=>{const n=S.useRef(!0),i=ie(a=>a.gameMenus.openMenus.at(0)?.scrollableSelection??!1),o=ie(a=>a.gameMenus.openMenus.at(0)?.focussedItemId===t);return dt({action:cI,handler:s,disabled:!o||e||r}),{menuItemProps:{[Cn]:t,[Pw]:e,[Ew]:r,onMouseMove:H(wd,{focussedItemId:t,scrollableSelection:!1}),onClick:r?void 0:s,tabIndex:0,role:"menuitem"},ref(a){o&&i&&a?.scrollIntoView({behavior:n.current?"instant":"smooth",block:"center"}),n.current=!1},focussed:o}},qe="leading-none [&_[class*='texture-hud']]:mb-oneScaledPix",hI=["menu_select","swop","jump"],dI=()=>{},Y=({id:t,label:e,valueElement:r,flipLeader:s=!1,doubleHeightWhenFocussed:n,onSelect:i=dI,hidden:o=!1,disabled:a=!1,hintInline:l=!1,className:c,hint:u,leader:h,verticalAlignItemsCentre:d=!1})=>{const{menuItemProps:f,ref:m,focussed:A}=Tw({id:t,hidden:o,disabled:a,onSelect:i});dt({action:hI,handler:i,disabled:!A||o||a});const g=p.jsxs("li",{...f,className:gt("contents",o?"hidden":"",n&&A?"sprites-double-height":"",A?"selectedMenuItem":"",c),children:[h||p.jsx(lI,{verticalAlignItemsCentre:d,flip:s,focussed:A}),p.jsx("div",{ref:m,className:gt(r===void 0?"col-span-2":"",d===!0?"flex items-center":""),children:typeof e=="string"?p.jsx(p.Fragment,{children:p.jsx(F,{children:e})}):e}),r&&p.jsx("div",{className:`flex ${d===!0?"items-center":""}`,children:r}),!A||u===void 0||l?null:p.jsx(Ls,{children:typeof u=="string"?p.jsx(F,{className:qe,children:u}):u})]});return l&&u?p.jsxs(p.Fragment,{children:[g,p.jsx("div",{className:"col-span-2 col-start-2 mb-1",children:u})]}):g},xr=({customLabel:t})=>p.jsx(Y,{id:"back",label:t||"Back",flipLeader:!0,doubleHeightWhenFocussed:!0,onSelect:H(Le)}),Rw=()=>{const t=document.body.querySelectorAll(`[${Cn}]`);return Array.from(t)},Xg=t=>{const{gameMenus:{openMenus:[{focussedItemId:e}]}}=xe.getState();if(e===void 0)return!0;const r=Rw();if(r.length<=1)return!0;const s=r.findIndex(i=>i.getAttribute(Cn)===e);if(s===-1)return!0;let n=s;do n=(n+t+r.length)%r.length;while(r[n].getAttribute(Pw)==="true"||r[n].getAttribute(Ew)==="true");return xe.dispatch(wd({focussedItemId:r[n].getAttribute(Cn),scrollableSelection:!0})),!1},fI=t=>{const e=Wx();dt({action:"away",handler:S.useCallback(()=>{if(t.current!==null)return Xg(-1)},[t]),disabled:e}),dt({action:"towards",handler:S.useCallback(()=>{if(t.current!==null)return Xg(1)},[t]),disabled:e})},Te=({className:t="",children:e})=>{const r=S.useRef(null);return S.useEffect(()=>{if(r.current===null||xe.getState().gameMenus.openMenus[0].focussedItemId!==void 0)return;const s=Rw(),n=s[0].getAttribute(Cn),i=n==="back"&&s.length>1?s[1].getAttribute(Cn):n;xe.dispatch(wd({focussedItemId:i,scrollableSelection:!0}))},[]),fI(r),p.jsx("menu",{ref:r,className:gt("grid grid-cols-menuItems gap-x-1 gap-y-oneScaledPix mobile:!gap-y-half mobile:sprites-double-height h-min",t),children:e})},is=({className:t})=>{const e=H(Le),{menuItemProps:r,ref:s,focussed:n}=Tw({id:"back",onSelect:e});return p.jsxs("div",{...r,className:gt("  sprites-double-height flex flex-row gap-1 "+(n?"selectedMenuItem":""),t),ref:s,children:[p.jsx(F,{className:"inline-block scale-[-1]",children:""}),p.jsx(F,{className:"inline-block",children:"Back"})]})};var pI=["second","minute","hour","day","week","month","year"];function mI(t,e){if(e===0)return["just now","right now"];var r=pI[Math.floor(e/2)];return t>1&&(r+="s"),[t+" "+r+" ago","in "+t+" "+r]}var gI=["","","","","","",""];function AI(t,e){if(e===0)return["",""];var r=gI[~~(e/2)];return[t+" "+r+"",t+" "+r+""]}var oh={},Mw=function(t,e){oh[t]=e},yI=function(t){return oh[t]||oh.en_US},Nc=[60,60,24,7,365/7/12,12];function xI(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function bI(t,e){var r=t<0?1:0;t=Math.abs(t);for(var s=t,n=0;t>=Nc[n]&&n<Nc.length;n++)t/=Nc[n];return t=Math.floor(t),n*=2,t>(n===0?9:1)&&(n+=1),e(t,n,s)[r].replace("%s",t.toString())}function wI(t,e){var r=new Date;return(+r-+xI(t))/1e3}var qI=function(t,e,r){var s=wI(t);return bI(s,yI(e))};Mw("en_US",mI);Mw("zh_CN",AI);const vI={"":S.Fragment,pre:"pre",code:"code",ol:"ol",ul:"ul",hr:"hr",blockquote:"blockquote",li:"li",a:"a",img:"img",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",em:"em",strong:"strong"},Jg=t=>t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),""),VI=t=>t&&typeof t!="string"&&["div","ul","ol","pre","h1","h2","h3","h4","h5","h6"].includes(t.t),Dc=t=>t.replace(/^\s+|\s+$/g," "),Je=(t,e=[],r={})=>({t,c:Array.isArray(e)?e:[e],p:r}),xi=(t,e=!1)=>{let r=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,s=0;const n=Je("");let i,o;e?(i=Je("p"),o=[n,i],n.c.push(i)):(i=n,o=[n]);let a;const l=(h,d=!0)=>(d&&o.push(h),i.c.push(h),d&&(i=h),h),c=h=>{const d=o.findIndex(f=>f.t===h);o=o.slice(0,d),i=o.at(-1)};for(;a=r.exec(t);){const h=t.substring(s,a.index);if(s=r.lastIndex,h!=="")if(i===n&&e){const d=Je("p",Dc(h));n.c.push(d),o=[n,d],i=d}else i.c.push(Dc(h));if(!h.match(/[^\\](\\\\)*\\$/)){if(a[3]||a[4]){const d=Je("pre",a[4]?Jg(a[4]):Je("code",Jg(a[3]),a[2]?{language:`language-${a[2].toLowerCase()}`}:{}));n.c.push(d),o=[n],i=n}else if(a[6]){const d=a[6],f=d!==">",m=!!d.match(/\./),A=f?m?"ol":"ul":"blockquote",g=a[5].split(`
`).map(w=>w.replace(/^(\*|-|\+|>|\d+\.)\s+/,"")).filter(w=>w.trim()!==""),y=Je(A,f?g.map(w=>Je("li",xi(w).c)):xi(g.join(`
`)).c);n.c.push(y),o=[n,y],i=n}else if(a[8]){const d=Je("img",[],{src:a[8],...a[7]?{alt:a[7]}:{}});if(e&&i===n){const f=Je("p",d);n.c.push(f),i=f,o=[n,f]}else l(d,!1)}else if(a[10]){const d=o.find(f=>f.t==="a");d&&(d.p.href=a[11])}else if(a[9])l(Je("a"));else if(a[14]){const d="h"+a[14].length;n.c.push(Je(d,xi(a[15]).c)),o=[n],i=n}else if(a[13])n.c.push(Je("h1",xi(a[12]).c)),o=[n],i=n;else if(a[16])l(Je("code",a[16]),!1);else if(a[17]?.[0]===`
`||a[17]===`  
`){if(!(o[1]?.t==="p")){const m=n.c;let A;for(A=m.length-1;A>=0&&!VI(m[A]);A--);if(A!==n.c.length-1){const g=n.c.splice(A+1);n.c.push(Je("p",g))}}const f=Je("p");n.c.push(f),o=[n,f],i=f}else if(a[1])n.c.push(Je("hr")),o=[n],i=n;else if(a[17]){const d=a[17].length===2?"strong":"em";o.findIndex(m=>m.t===d)===-1?l(Je(d)):c(d)}}}const u=Dc(t.substring(s));if(u.length){const h=n.c.at(-1);let d;h?.t==="p"?d=h:e?(d=Je("p"),n.c.push(d)):d=n,d.c.push(u)}return n.c=n.c.filter(h=>typeof h=="string"||h.t!=="p"||h.c?.length>0),n},_I=(t,e={})=>{const r={...vI,...e},s=(n,i=0)=>{const o=n.t===""?S.Fragment:r[n.t];return S.createElement(o,{...n.p,key:i},n.c.length===0?void 0:n.c.map((a,l)=>typeof a=="string"?a:s(a,l)))};return s(xi(t,!0))},SI=({markdown:t,customComponents:e})=>_I(t,e),kI={h2:function({children:e}){return p.jsx("h2",{className:`mb-1 sprites-double-height text-metallicBlue zx:text-zxBlue clear-both ${qe}`,children:p.jsx(xt,{children:e})})},h3:function({children:e}){return p.jsx("h3",{className:"mt-1 mb-1 text-metallicBlue zx:text-zxBlue clear-both",children:p.jsx(xt,{children:e})})},blockquote:function({children:e}){return p.jsx("blockquote",{className:`${qe} mt-1 mb-1 text-moss zx:text-zxBlue clear-both`,children:p.jsxs(xt,{children:["> ",e]})})},p:function({children:e}){return p.jsx("div",{className:`mb-1 last:mb-0 ${qe}`,children:p.jsx(xt,{children:e})})},a:function({children:e,href:r}){return p.jsx("a",{className:"bitmap-text-link",href:r,target:"_blank",rel:"noopener noreferrer",children:p.jsx(xt,{children:e})})},li:function({children:e}){return p.jsx("div",{className:`mb-1 clear-both ${qe}`,children:p.jsxs(xt,{children:[p.jsx(F,{className:"text-metallicBlue zx:text-zxYellow",children:""}),e]})})},strong:function({children:e}){return p.jsx(xt,{className:"strong text-midRed zx:text-zxRed",children:e})},em:function({children:e}){return p.jsx(xt,{className:"em text-moss zx:text-zxBlue",children:e})},img:function({src:e}){const r=po();if(e===void 0)throw new Error("image without src");const s=e.split(/\?|&/);return p.jsx("span",{style:{"--scale":r*2},children:p.jsx("span",{className:gt("sprite float-left mr-1 mb-1 zx:sprite-revert-to-two-tone",s.join(" "))})})},hr:function(){return p.jsx("hr",{className:"bg-metallicBlue zx:bg-zxWhite h-half mb-half border-none"})}},_e=({markdown:t,className:e})=>p.jsx("div",{className:`contents ${e}`,children:p.jsx(SI,{customComponents:kI,markdown:t})}),CI=({userId:t,campaignName:e,label:r})=>p.jsx(Y,{id:`campaign-${t}-${e}`,label:r,doubleHeightWhenFocussed:!0,onSelect:H(Fi,{campaignLocator:{userId:t,campaignName:e,version:-1}})}),PI=({campaigns:t})=>p.jsx(p.Fragment,{children:p.jsx("div",{className:"zx:text-zxCyan  resHandheld:mt-half flex flex-col gap-2",children:Object.values(t).flatMap(e=>p.jsxs("div",{className:"flex flex-col gap-half",children:[p.jsx(F,{className:"text-metallicBlue",children:e.user.username}),Object.values(e.campaigns).map(r=>p.jsxs(p.Fragment,{children:[p.jsx(Te,{children:p.jsx(CI,{userId:e.user.id,campaignName:r.name,label:`'${r.name}'`})}),p.jsx("div",{className:"pl-3",children:p.jsx(_e,{className:"text-midGrey",markdown:` v.${r.version} updated ${qI(r.created_at)}`})})]},r.name))]},e.user.id))})}),EI=t=>{const{data:e,error:r,isLoading:s,refetch:n}=j1({publishedOnly:!0});return S.useEffect(()=>{n()},[n]),p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:H(Le)}),p.jsxs(ke,{tall:!0,className:"bg-metallicBlueHalfbrite selectedMenuItem:text-white text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[hr()&&p.jsx(is,{className:"text-highlightBeige"}),p.jsx(F,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-3",children:"Community Contributed"})]}),r!==void 0?p.jsx(bM,{text:"Failed to load campaigns"}):null,s?p.jsx(wM,{}):null,e!==void 0?p.jsx(PI,{campaigns:e}):null,hr()||p.jsx(Te,{children:p.jsx(xr,{})})]})]})};function Iw(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=Iw(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function zd(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=Iw(t))&&(s&&(s+=" "),s+=e);return s}function Nd(...t){return gt(zd(t))}const TI=t=>t.replace(/ArrowLeft/g,"").replace(/ArrowRight/g,"").replace(/ArrowUp/g,"").replace(/ArrowDown/g,""),Zg=t=>{const e=t.map(TI);return e.length===1?`

key: **${e[0]}**`:`

keys: ${e.map(r=>`**${r}**`).join(" or ")}`},Dd=(t,e)=>e?t?`${t}${Zg(e)}`:Zg(e):t;function Cr(t,e,{checkForDefaultPrevented:r=!0}={}){return function(n){if(t?.(n),r===!1||!n.defaultPrevented)return e?.(n)}}function eA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function jw(...t){return e=>{let r=!1;const s=t.map(n=>{const i=eA(n,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let n=0;n<s.length;n++){const i=s[n];typeof i=="function"?i():eA(t[n],null)}}}}function Us(...t){return S.useCallback(jw(...t),t)}function Bw(t,e=[]){let r=[];function s(i,o){const a=S.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:d,children:f,...m}=h,A=d?.[t]?.[l]||a,g=S.useMemo(()=>m,Object.values(m));return p.jsx(A.Provider,{value:g,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,m=S.useContext(f);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const n=()=>{const i=r.map(o=>S.createContext(o));return function(a){const l=a?.[t]||i;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return n.scopeName=t,[s,RI(n,...e)]}function RI(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function MI(t){const e=II(t),r=S.forwardRef((s,n)=>{const{children:i,...o}=s,a=S.Children.toArray(i),l=a.find(BI);if(l){const c=l.props.children,u=a.map(h=>h===l?S.Children.count(c)>1?S.Children.only(null):S.isValidElement(c)?c.props.children:null:h);return p.jsx(e,{...o,ref:n,children:S.isValidElement(c)?S.cloneElement(c,void 0,u):null})}return p.jsx(e,{...o,ref:n,children:i})});return r.displayName=`${t}.Slot`,r}function II(t){const e=S.forwardRef((r,s)=>{const{children:n,...i}=r;if(S.isValidElement(n)){const o=zI(n),a=OI(i,n.props);return n.type!==S.Fragment&&(a.ref=s?jw(s,o):o),S.cloneElement(n,a)}return S.Children.count(n)>1?S.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Ow=Symbol("radix.slottable");function jI(t){const e=({children:r})=>p.jsx(p.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=Ow,e}function BI(t){return S.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ow}function OI(t,e){const r={...e};for(const s in e){const n=t[s],i=e[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...a)=>{const l=i(...a);return n(...a),l}:n&&(r[s]=n):s==="style"?r[s]={...n,...i}:s==="className"&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...t,...r}}function zI(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var NI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],os=NI.reduce((t,e)=>{const r=MI(`Primitive.${e}`),s=S.forwardRef((n,i)=>{const{asChild:o,...a}=n,l=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function DI(t,e){t&&fl.flushSync(()=>t.dispatchEvent(e))}function ml(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...r)=>e.current?.(...r),[])}function FI(t,e=globalThis?.document){const r=ml(t);S.useEffect(()=>{const s=n=>{n.key==="Escape"&&r(n)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[r,e])}var LI="DismissableLayer",ah="dismissableLayer.update",UI="dismissableLayer.pointerDownOutside",HI="dismissableLayer.focusOutside",tA,zw=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Nw=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=S.useContext(zw),[u,h]=S.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=S.useState({}),m=Us(e,v=>h(v)),A=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=A.indexOf(g),w=u?A.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,b=w>=y,V=WI(v=>{const k=v.target,E=[...c.branches].some(T=>T.contains(k));!b||E||(n?.(v),o?.(v),v.defaultPrevented||a?.())},d),_=YI(v=>{const k=v.target;[...c.branches].some(T=>T.contains(k))||(i?.(v),o?.(v),v.defaultPrevented||a?.())},d);return FI(v=>{w===c.layers.size-1&&(s?.(v),!v.defaultPrevented&&a&&(v.preventDefault(),a()))},d),S.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(tA=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),rA(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=tA)}},[u,d,r,c]),S.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),rA())},[u,c]),S.useEffect(()=>{const v=()=>f({});return document.addEventListener(ah,v),()=>document.removeEventListener(ah,v)},[]),p.jsx(os.div,{...l,ref:m,style:{pointerEvents:x?b?"auto":"none":void 0,...t.style},onFocusCapture:Cr(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Cr(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Cr(t.onPointerDownCapture,V.onPointerDownCapture)})});Nw.displayName=LI;var $I="DismissableLayerBranch",GI=S.forwardRef((t,e)=>{const r=S.useContext(zw),s=S.useRef(null),n=Us(e,s);return S.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),p.jsx(os.div,{...t,ref:n})});GI.displayName=$I;function WI(t,e=globalThis?.document){const r=ml(t),s=S.useRef(!1),n=S.useRef(()=>{});return S.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){Dw(UI,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=l,e.addEventListener("click",n.current,{once:!0})):l()}else e.removeEventListener("click",n.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",n.current)}},[e,r]),{onPointerDownCapture:()=>s.current=!0}}function YI(t,e=globalThis?.document){const r=ml(t),s=S.useRef(!1);return S.useEffect(()=>{const n=i=>{i.target&&!s.current&&Dw(HI,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function rA(){const t=new CustomEvent(ah);document.dispatchEvent(t)}function Dw(t,e,r,{discrete:s}){const n=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),s?DI(n,i):n.dispatchEvent(i)}var Jr=globalThis?.document?S.useLayoutEffect:()=>{},QI=qh[" useId ".trim().toString()]||(()=>{}),KI=0;function XI(t){const[e,r]=S.useState(QI());return Jr(()=>{r(s=>s??String(KI++))},[t]),e?`radix-${e}`:""}const JI=["top","right","bottom","left"],Zr=Math.min,Dt=Math.max,$a=Math.round,na=Math.floor,dr=t=>({x:t,y:t}),ZI={left:"right",right:"left",bottom:"top",top:"bottom"},ej={start:"end",end:"start"};function lh(t,e,r){return Dt(t,Zr(e,r))}function Ir(t,e){return typeof t=="function"?t(e):t}function jr(t){return t.split("-")[0]}function Gn(t){return t.split("-")[1]}function Fd(t){return t==="x"?"y":"x"}function Ld(t){return t==="y"?"height":"width"}function es(t){return["top","bottom"].includes(jr(t))?"y":"x"}function Ud(t){return Fd(es(t))}function tj(t,e,r){r===void 0&&(r=!1);const s=Gn(t),n=Ud(t),i=Ld(n);let o=n==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Ga(o)),[o,Ga(o)]}function rj(t){const e=Ga(t);return[ch(t),e,ch(e)]}function ch(t){return t.replace(/start|end/g,e=>ej[e])}function sj(t,e,r){const s=["left","right"],n=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?n:s:e?s:n;case"left":case"right":return e?i:o;default:return[]}}function nj(t,e,r,s){const n=Gn(t);let i=sj(jr(t),r==="start",s);return n&&(i=i.map(o=>o+"-"+n),e&&(i=i.concat(i.map(ch)))),i}function Ga(t){return t.replace(/left|right|bottom|top/g,e=>ZI[e])}function ij(t){return{top:0,right:0,bottom:0,left:0,...t}}function Fw(t){return typeof t!="number"?ij(t):{top:t,right:t,bottom:t,left:t}}function Wa(t){const{x:e,y:r,width:s,height:n}=t;return{width:s,height:n,top:r,left:e,right:e+s,bottom:r+n,x:e,y:r}}function sA(t,e,r){let{reference:s,floating:n}=t;const i=es(e),o=Ud(e),a=Ld(o),l=jr(e),c=i==="y",u=s.x+s.width/2-n.width/2,h=s.y+s.height/2-n.height/2,d=s[a]/2-n[a]/2;let f;switch(l){case"top":f={x:u,y:s.y-n.height};break;case"bottom":f={x:u,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:h};break;case"left":f={x:s.x-n.width,y:h};break;default:f={x:s.x,y:s.y}}switch(Gn(e)){case"start":f[o]-=d*(r&&c?-1:1);break;case"end":f[o]+=d*(r&&c?-1:1);break}return f}const oj=async(t,e,r)=>{const{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:h}=sA(c,s,l),d=s,f={},m=0;for(let A=0;A<a.length;A++){const{name:g,fn:y}=a[A],{x:w,y:x,data:b,reset:V}=await y({x:u,y:h,initialPlacement:s,placement:d,strategy:n,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=w??u,h=x??h,f={...f,[g]:{...f[g],...b}},V&&m<=50&&(m++,typeof V=="object"&&(V.placement&&(d=V.placement),V.rects&&(c=V.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:n}):V.rects),{x:u,y:h}=sA(c,d,l)),A=-1)}return{x:u,y:h,placement:d,strategy:n,middlewareData:f}};async function Gi(t,e){var r;e===void 0&&(e={});const{x:s,y:n,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=Ir(e,t),m=Fw(f),g=a[d?h==="floating"?"reference":"floating":h],y=Wa(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=h==="floating"?{x:s,y:n,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},V=Wa(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:x,strategy:l}):w);return{top:(y.top-V.top+m.top)/b.y,bottom:(V.bottom-y.bottom+m.bottom)/b.y,left:(y.left-V.left+m.left)/b.x,right:(V.right-y.right+m.right)/b.x}}const aj=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:s,placement:n,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Ir(t,e)||{};if(c==null)return{};const h=Fw(u),d={x:r,y:s},f=Ud(n),m=Ld(f),A=await o.getDimensions(c),g=f==="y",y=g?"top":"left",w=g?"bottom":"right",x=g?"clientHeight":"clientWidth",b=i.reference[m]+i.reference[f]-d[f]-i.floating[m],V=d[f]-i.reference[f],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let v=_?_[x]:0;(!v||!await(o.isElement==null?void 0:o.isElement(_)))&&(v=a.floating[x]||i.floating[m]);const k=b/2-V/2,E=v/2-A[m]/2-1,T=Zr(h[y],E),R=Zr(h[w],E),j=T,B=v-A[m]-R,N=v/2-A[m]/2+k,U=lh(j,N,B),q=!l.arrow&&Gn(n)!=null&&N!==U&&i.reference[m]/2-(N<j?T:R)-A[m]/2<0,C=q?N<j?N-j:N-B:0;return{[f]:d[f]+C,data:{[f]:U,centerOffset:N-U-C,...q&&{alignmentOffset:C}},reset:q}}}),lj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,s;const{placement:n,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:A=!0,...g}=Ir(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=jr(n),w=es(a),x=jr(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),V=d||(x||!A?[Ga(a)]:rj(a)),_=m!=="none";!d&&_&&V.push(...nj(a,A,m,b));const v=[a,...V],k=await Gi(e,g),E=[];let T=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&E.push(k[y]),h){const N=tj(n,o,b);E.push(k[N[0]],k[N[1]])}if(T=[...T,{placement:n,overflows:E}],!E.every(N=>N<=0)){var R,j;const N=(((R=i.flip)==null?void 0:R.index)||0)+1,U=v[N];if(U)return{data:{index:N,overflows:T},reset:{placement:U}};let q=(j=T.filter(C=>C.overflows[0]<=0).sort((C,P)=>C.overflows[1]-P.overflows[1])[0])==null?void 0:j.placement;if(!q)switch(f){case"bestFit":{var B;const C=(B=T.filter(P=>{if(_){const M=es(P.placement);return M===w||M==="y"}return!0}).map(P=>[P.placement,P.overflows.filter(M=>M>0).reduce((M,I)=>M+I,0)]).sort((P,M)=>P[1]-M[1])[0])==null?void 0:B[0];C&&(q=C);break}case"initialPlacement":q=a;break}if(n!==q)return{reset:{placement:q}}}return{}}}};function nA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function iA(t){return JI.some(e=>t[e]>=0)}const cj=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:s="referenceHidden",...n}=Ir(t,e);switch(s){case"referenceHidden":{const i=await Gi(e,{...n,elementContext:"reference"}),o=nA(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:iA(o)}}}case"escaped":{const i=await Gi(e,{...n,altBoundary:!0}),o=nA(i,r.floating);return{data:{escapedOffsets:o,escaped:iA(o)}}}default:return{}}}}};async function uj(t,e){const{placement:r,platform:s,elements:n}=t,i=await(s.isRTL==null?void 0:s.isRTL(n.floating)),o=jr(r),a=Gn(r),l=es(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=Ir(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const hj=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,s;const{x:n,y:i,placement:o,middlewareData:a}=e,l=await uj(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},dj=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:s,placement:n}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:w}=g;return{x:y,y:w}}},...l}=Ir(t,e),c={x:r,y:s},u=await Gi(e,l),h=es(jr(n)),d=Fd(h);let f=c[d],m=c[h];if(i){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=f+u[g],x=f-u[y];f=lh(w,f,x)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=m+u[g],x=m-u[y];m=lh(w,m,x)}const A=a.fn({...e,[d]:f,[h]:m});return{...A,data:{x:A.x-r,y:A.y-s,enabled:{[d]:i,[h]:o}}}}}},fj=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:s,placement:n,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Ir(t,e),u={x:r,y:s},h=es(n),d=Fd(h);let f=u[d],m=u[h];const A=Ir(a,e),g=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=d==="y"?"height":"width",b=i.reference[d]-i.floating[x]+g.mainAxis,V=i.reference[d]+i.reference[x]-g.mainAxis;f<b?f=b:f>V&&(f=V)}if(c){var y,w;const x=d==="y"?"width":"height",b=["top","left"].includes(jr(n)),V=i.reference[h]-i.floating[x]+(b&&((y=o.offset)==null?void 0:y[h])||0)+(b?0:g.crossAxis),_=i.reference[h]+i.reference[x]+(b?0:((w=o.offset)==null?void 0:w[h])||0)-(b?g.crossAxis:0);m<V?m=V:m>_&&(m=_)}return{[d]:f,[h]:m}}}},pj=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,s;const{placement:n,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Ir(t,e),u=await Gi(e,c),h=jr(n),d=Gn(n),f=es(n)==="y",{width:m,height:A}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=d==="end"?"top":"bottom");const w=A-u.top-u.bottom,x=m-u.left-u.right,b=Zr(A-u[g],w),V=Zr(m-u[y],x),_=!e.middlewareData.shift;let v=b,k=V;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(k=x),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(v=w),_&&!d){const T=Dt(u.left,0),R=Dt(u.right,0),j=Dt(u.top,0),B=Dt(u.bottom,0);f?k=m-2*(T!==0||R!==0?T+R:Dt(u.left,u.right)):v=A-2*(j!==0||B!==0?j+B:Dt(u.top,u.bottom))}await l({...e,availableWidth:k,availableHeight:v});const E=await o.getDimensions(a.floating);return m!==E.width||A!==E.height?{reset:{rects:!0}}:{}}}};function gl(){return typeof window<"u"}function Wn(t){return Lw(t)?(t.nodeName||"").toLowerCase():"#document"}function Ut(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function br(t){var e;return(e=(Lw(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Lw(t){return gl()?t instanceof Node||t instanceof Ut(t).Node:!1}function sr(t){return gl()?t instanceof Element||t instanceof Ut(t).Element:!1}function mr(t){return gl()?t instanceof HTMLElement||t instanceof Ut(t).HTMLElement:!1}function oA(t){return!gl()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ut(t).ShadowRoot}function Ao(t){const{overflow:e,overflowX:r,overflowY:s,display:n}=nr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+r)&&!["inline","contents"].includes(n)}function mj(t){return["table","td","th"].includes(Wn(t))}function Al(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Hd(t){const e=$d(),r=sr(t)?nr(t):t;return["transform","translate","scale","rotate","perspective"].some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(r.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(r.contain||"").includes(s))}function gj(t){let e=ts(t);for(;mr(e)&&!Pn(e);){if(Hd(e))return e;if(Al(e))return null;e=ts(e)}return null}function $d(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Pn(t){return["html","body","#document"].includes(Wn(t))}function nr(t){return Ut(t).getComputedStyle(t)}function yl(t){return sr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ts(t){if(Wn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||oA(t)&&t.host||br(t);return oA(e)?e.host:e}function Uw(t){const e=ts(t);return Pn(e)?t.ownerDocument?t.ownerDocument.body:t.body:mr(e)&&Ao(e)?e:Uw(e)}function Wi(t,e,r){var s;e===void 0&&(e=[]),r===void 0&&(r=!0);const n=Uw(t),i=n===((s=t.ownerDocument)==null?void 0:s.body),o=Ut(n);if(i){const a=uh(o);return e.concat(o,o.visualViewport||[],Ao(n)?n:[],a&&r?Wi(a):[])}return e.concat(n,Wi(n,[],r))}function uh(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Hw(t){const e=nr(t);let r=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const n=mr(t),i=n?t.offsetWidth:r,o=n?t.offsetHeight:s,a=$a(r)!==i||$a(s)!==o;return a&&(r=i,s=o),{width:r,height:s,$:a}}function Gd(t){return sr(t)?t:t.contextElement}function yn(t){const e=Gd(t);if(!mr(e))return dr(1);const r=e.getBoundingClientRect(),{width:s,height:n,$:i}=Hw(e);let o=(i?$a(r.width):r.width)/s,a=(i?$a(r.height):r.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Aj=dr(0);function $w(t){const e=Ut(t);return!$d()||!e.visualViewport?Aj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function yj(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ut(t)?!1:e}function zs(t,e,r,s){e===void 0&&(e=!1),r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=Gd(t);let o=dr(1);e&&(s?sr(s)&&(o=yn(s)):o=yn(t));const a=yj(i,r,s)?$w(i):dr(0);let l=(n.left+a.x)/o.x,c=(n.top+a.y)/o.y,u=n.width/o.x,h=n.height/o.y;if(i){const d=Ut(i),f=s&&sr(s)?Ut(s):s;let m=d,A=uh(m);for(;A&&s&&f!==m;){const g=yn(A),y=A.getBoundingClientRect(),w=nr(A),x=y.left+(A.clientLeft+parseFloat(w.paddingLeft))*g.x,b=y.top+(A.clientTop+parseFloat(w.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=x,c+=b,m=Ut(A),A=uh(m)}}return Wa({width:u,height:h,x:l,y:c})}function Wd(t,e){const r=yl(t).scrollLeft;return e?e.left+r:zs(br(t)).left+r}function Gw(t,e,r){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),n=s.left+e.scrollLeft-(r?0:Wd(t,s)),i=s.top+e.scrollTop;return{x:n,y:i}}function xj(t){let{elements:e,rect:r,offsetParent:s,strategy:n}=t;const i=n==="fixed",o=br(s),a=e?Al(e.floating):!1;if(s===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=dr(1);const u=dr(0),h=mr(s);if((h||!h&&!i)&&((Wn(s)!=="body"||Ao(o))&&(l=yl(s)),mr(s))){const f=zs(s);c=yn(s),u.x=f.x+s.clientLeft,u.y=f.y+s.clientTop}const d=o&&!h&&!i?Gw(o,l,!0):dr(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function bj(t){return Array.from(t.getClientRects())}function wj(t){const e=br(t),r=yl(t),s=t.ownerDocument.body,n=Dt(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Dt(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+Wd(t);const a=-r.scrollTop;return nr(s).direction==="rtl"&&(o+=Dt(e.clientWidth,s.clientWidth)-n),{width:n,height:i,x:o,y:a}}function qj(t,e){const r=Ut(t),s=br(t),n=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(n){i=n.width,o=n.height;const c=$d();(!c||c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:a,y:l}}function vj(t,e){const r=zs(t,!0,e==="fixed"),s=r.top+t.clientTop,n=r.left+t.clientLeft,i=mr(t)?yn(t):dr(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=n*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function aA(t,e,r){let s;if(e==="viewport")s=qj(t,r);else if(e==="document")s=wj(br(t));else if(sr(e))s=vj(e,r);else{const n=$w(t);s={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Wa(s)}function Ww(t,e){const r=ts(t);return r===e||!sr(r)||Pn(r)?!1:nr(r).position==="fixed"||Ww(r,e)}function Vj(t,e){const r=e.get(t);if(r)return r;let s=Wi(t,[],!1).filter(a=>sr(a)&&Wn(a)!=="body"),n=null;const i=nr(t).position==="fixed";let o=i?ts(t):t;for(;sr(o)&&!Pn(o);){const a=nr(o),l=Hd(o);!l&&a.position==="fixed"&&(n=null),(i?!l&&!n:!l&&a.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||Ao(o)&&!l&&Ww(t,o))?s=s.filter(u=>u!==o):n=a,o=ts(o)}return e.set(t,s),s}function _j(t){let{element:e,boundary:r,rootBoundary:s,strategy:n}=t;const o=[...r==="clippingAncestors"?Al(e)?[]:Vj(e,this._c):[].concat(r),s],a=o[0],l=o.reduce((c,u)=>{const h=aA(e,u,n);return c.top=Dt(h.top,c.top),c.right=Zr(h.right,c.right),c.bottom=Zr(h.bottom,c.bottom),c.left=Dt(h.left,c.left),c},aA(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Sj(t){const{width:e,height:r}=Hw(t);return{width:e,height:r}}function kj(t,e,r){const s=mr(e),n=br(e),i=r==="fixed",o=zs(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=dr(0);if(s||!s&&!i)if((Wn(e)!=="body"||Ao(n))&&(a=yl(e)),s){const d=zs(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else n&&(l.x=Wd(n));const c=n&&!s&&!i?Gw(n,a):dr(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function Fc(t){return nr(t).position==="static"}function lA(t,e){if(!mr(t)||nr(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return br(t)===r&&(r=r.ownerDocument.body),r}function Yw(t,e){const r=Ut(t);if(Al(t))return r;if(!mr(t)){let n=ts(t);for(;n&&!Pn(n);){if(sr(n)&&!Fc(n))return n;n=ts(n)}return r}let s=lA(t,e);for(;s&&mj(s)&&Fc(s);)s=lA(s,e);return s&&Pn(s)&&Fc(s)&&!Hd(s)?r:s||gj(t)||r}const Cj=async function(t){const e=this.getOffsetParent||Yw,r=this.getDimensions,s=await r(t.floating);return{reference:kj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Pj(t){return nr(t).direction==="rtl"}const Ej={convertOffsetParentRelativeRectToViewportRelativeRect:xj,getDocumentElement:br,getClippingRect:_j,getOffsetParent:Yw,getElementRects:Cj,getClientRects:bj,getDimensions:Sj,getScale:yn,isElement:sr,isRTL:Pj};function Qw(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Tj(t,e){let r=null,s;const n=br(t);function i(){var a;clearTimeout(s),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const m=na(h),A=na(n.clientWidth-(u+d)),g=na(n.clientHeight-(h+f)),y=na(u),x={rootMargin:-m+"px "+-A+"px "+-g+"px "+-y+"px",threshold:Dt(0,Zr(1,l))||1};let b=!0;function V(_){const v=_[0].intersectionRatio;if(v!==l){if(!b)return o();v?o(!1,v):s=setTimeout(()=>{o(!1,1e-7)},1e3)}v===1&&!Qw(c,t.getBoundingClientRect())&&o(),b=!1}try{r=new IntersectionObserver(V,{...x,root:n.ownerDocument})}catch{r=new IntersectionObserver(V,x)}r.observe(t)}return o(!0),i}function Rj(t,e,r,s){s===void 0&&(s={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=Gd(t),u=n||i?[...c?Wi(c):[],...Wi(e)]:[];u.forEach(y=>{n&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const h=c&&a?Tj(c,r):null;let d=-1,f=null;o&&(f=new ResizeObserver(y=>{let[w]=y;w&&w.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let m,A=l?zs(t):null;l&&g();function g(){const y=zs(t);A&&!Qw(A,y)&&r(),A=y,m=requestAnimationFrame(g)}return r(),()=>{var y;u.forEach(w=>{n&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),h?.(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const Mj=hj,Ij=dj,jj=lj,Bj=pj,Oj=cj,cA=aj,zj=fj,Nj=(t,e,r)=>{const s=new Map,n={platform:Ej,...r},i={...n.platform,_c:s};return oj(t,e,{...n,platform:i})};var qa=typeof document<"u"?S.useLayoutEffect:S.useEffect;function Ya(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,s,n;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(s=r;s--!==0;)if(!Ya(t[s],e[s]))return!1;return!0}if(n=Object.keys(t),r=n.length,r!==Object.keys(e).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(e,n[s]))return!1;for(s=r;s--!==0;){const i=n[s];if(!(i==="_owner"&&t.$$typeof)&&!Ya(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function Kw(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function uA(t,e){const r=Kw(t);return Math.round(e*r)/r}function Lc(t){const e=S.useRef(t);return qa(()=>{e.current=t}),e}function Dj(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:s=[],platform:n,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=S.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=S.useState(s);Ya(d,s)||f(s);const[m,A]=S.useState(null),[g,y]=S.useState(null),w=S.useCallback(P=>{P!==_.current&&(_.current=P,A(P))},[]),x=S.useCallback(P=>{P!==v.current&&(v.current=P,y(P))},[]),b=i||m,V=o||g,_=S.useRef(null),v=S.useRef(null),k=S.useRef(u),E=l!=null,T=Lc(l),R=Lc(n),j=Lc(c),B=S.useCallback(()=>{if(!_.current||!v.current)return;const P={placement:e,strategy:r,middleware:d};R.current&&(P.platform=R.current),Nj(_.current,v.current,P).then(M=>{const I={...M,isPositioned:j.current!==!1};N.current&&!Ya(k.current,I)&&(k.current=I,fl.flushSync(()=>{h(I)}))})},[d,e,r,R,j]);qa(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,h(P=>({...P,isPositioned:!1})))},[c]);const N=S.useRef(!1);qa(()=>(N.current=!0,()=>{N.current=!1}),[]),qa(()=>{if(b&&(_.current=b),V&&(v.current=V),b&&V){if(T.current)return T.current(b,V,B);B()}},[b,V,B,T,E]);const U=S.useMemo(()=>({reference:_,floating:v,setReference:w,setFloating:x}),[w,x]),q=S.useMemo(()=>({reference:b,floating:V}),[b,V]),C=S.useMemo(()=>{const P={position:r,left:0,top:0};if(!q.floating)return P;const M=uA(q.floating,u.x),I=uA(q.floating,u.y);return a?{...P,transform:"translate("+M+"px, "+I+"px)",...Kw(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:M,top:I}},[r,a,q.floating,u.x,u.y]);return S.useMemo(()=>({...u,update:B,refs:U,elements:q,floatingStyles:C}),[u,B,U,q,C])}const Fj=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:n}=typeof t=="function"?t(r):t;return s&&e(s)?s.current!=null?cA({element:s.current,padding:n}).fn(r):{}:s?cA({element:s,padding:n}).fn(r):{}}}},Lj=(t,e)=>({...Mj(t),options:[t,e]}),Uj=(t,e)=>({...Ij(t),options:[t,e]}),Hj=(t,e)=>({...zj(t),options:[t,e]}),$j=(t,e)=>({...jj(t),options:[t,e]}),Gj=(t,e)=>({...Bj(t),options:[t,e]}),Wj=(t,e)=>({...Oj(t),options:[t,e]}),Yj=(t,e)=>({...Fj(t),options:[t,e]});var Qj="Arrow",Xw=S.forwardRef((t,e)=>{const{children:r,width:s=10,height:n=5,...i}=t;return p.jsx(os.svg,{...i,ref:e,width:s,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});Xw.displayName=Qj;var Kj=Xw;function Xj(t){const[e,r]=S.useState(void 0);return Jr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const i=n[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),e}var Yd="Popper",[Jw,Zw]=Bw(Yd),[Jj,eq]=Jw(Yd),tq=t=>{const{__scopePopper:e,children:r}=t,[s,n]=S.useState(null);return p.jsx(Jj,{scope:e,anchor:s,onAnchorChange:n,children:r})};tq.displayName=Yd;var rq="PopperAnchor",sq=S.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:s,...n}=t,i=eq(rq,r),o=S.useRef(null),a=Us(e,o);return S.useEffect(()=>{i.onAnchorChange(s?.current||o.current)}),s?null:p.jsx(os.div,{...n,ref:a})});sq.displayName=rq;var Qd="PopperContent",[Zj,eB]=Jw(Qd),nq=S.forwardRef((t,e)=>{const{__scopePopper:r,side:s="bottom",sideOffset:n=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:m,...A}=t,g=eq(Qd,r),[y,w]=S.useState(null),x=Us(e,te=>w(te)),[b,V]=S.useState(null),_=Xj(b),v=_?.width??0,k=_?.height??0,E=s+(i!=="center"?"-"+i:""),T=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},R=Array.isArray(c)?c:[c],j=R.length>0,B={padding:T,boundary:R.filter(rB),altBoundary:j},{refs:N,floatingStyles:U,placement:q,isPositioned:C,middlewareData:P}=Dj({strategy:"fixed",placement:E,whileElementsMounted:(...te)=>Rj(...te,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[Lj({mainAxis:n+k,alignmentAxis:o}),l&&Uj({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Hj():void 0,...B}),l&&$j({...B}),Gj({...B,apply:({elements:te,rects:ne,availableWidth:we,availableHeight:ue})=>{const{width:At,height:He}=ne.reference,st=te.floating.style;st.setProperty("--radix-popper-available-width",`${we}px`),st.setProperty("--radix-popper-available-height",`${ue}px`),st.setProperty("--radix-popper-anchor-width",`${At}px`),st.setProperty("--radix-popper-anchor-height",`${He}px`)}}),b&&Yj({element:b,padding:a}),sB({arrowWidth:v,arrowHeight:k}),d&&Wj({strategy:"referenceHidden",...B})]}),[M,I]=aq(q),z=ml(m);Jr(()=>{C&&z?.()},[C,z]);const O=P.arrow?.x,D=P.arrow?.y,$=P.arrow?.centerOffset!==0,[L,Q]=S.useState();return Jr(()=>{y&&Q(window.getComputedStyle(y).zIndex)},[y]),p.jsx("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:C?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[P.transformOrigin?.x,P.transformOrigin?.y].join(" "),...P.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(Zj,{scope:r,placedSide:M,onArrowChange:V,arrowX:O,arrowY:D,shouldHideArrow:$,children:p.jsx(os.div,{"data-side":M,"data-align":I,...A,ref:x,style:{...A.style,animation:C?void 0:"none"}})})})});nq.displayName=Qd;var iq="PopperArrow",tB={top:"bottom",right:"left",bottom:"top",left:"right"},oq=S.forwardRef(function(e,r){const{__scopePopper:s,...n}=e,i=eB(iq,s),o=tB[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(Kj,{...n,ref:r,style:{...n.style,display:"block"}})})});oq.displayName=iq;function rB(t){return t!==null}var sB=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:s,middlewareData:n}=e,o=n.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=aq(r),h={start:"0%",center:"50%",end:"100%"}[u],d=(n.arrow?.x??0)+a/2,f=(n.arrow?.y??0)+l/2;let m="",A="";return c==="bottom"?(m=o?h:`${d}px`,A=`${-l}px`):c==="top"?(m=o?h:`${d}px`,A=`${s.floating.height+l}px`):c==="right"?(m=`${-l}px`,A=o?h:`${f}px`):c==="left"&&(m=`${s.floating.width+l}px`,A=o?h:`${f}px`),{data:{x:m,y:A}}}});function aq(t){const[e,r="center"]=t.split("-");return[e,r]}var nB=tq,iB=sq,oB=nq,aB=oq,lB="Portal",lq=S.forwardRef((t,e)=>{const{container:r,...s}=t,[n,i]=S.useState(!1);Jr(()=>i(!0),[]);const o=r||n&&globalThis?.document?.body;return o?xM.createPortal(p.jsx(os.div,{...s,ref:e}),o):null});lq.displayName=lB;function cB(t,e){return S.useReducer((r,s)=>e[r][s]??r,t)}var Kd=t=>{const{present:e,children:r}=t,s=uB(e),n=typeof r=="function"?r({present:s.isPresent}):S.Children.only(r),i=Us(s.ref,hB(n));return typeof r=="function"||s.isPresent?S.cloneElement(n,{ref:i}):null};Kd.displayName="Presence";function uB(t){const[e,r]=S.useState(),s=S.useRef(null),n=S.useRef(t),i=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=cB(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const c=ia(s.current);i.current=a==="mounted"?c:"none"},[a]),Jr(()=>{const c=s.current,u=n.current;if(u!==t){const d=i.current,f=ia(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,l]),Jr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const A=ia(s.current).includes(f.animationName);if(f.target===e&&A&&(l("ANIMATION_END"),!n.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},d=f=>{f.target===e&&(i.current=ia(s.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(c=>{s.current=c?getComputedStyle(c):null,r(c)},[])}}function ia(t){return t?.animationName||"none"}function hB(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var dB=qh[" useInsertionEffect ".trim().toString()]||Jr;function fB({prop:t,defaultProp:e,onChange:r=()=>{},caller:s}){const[n,i,o]=pB({defaultProp:e,onChange:r}),a=t!==void 0,l=a?t:n;{const u=S.useRef(t!==void 0);S.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,s])}const c=S.useCallback(u=>{if(a){const h=mB(u)?u(t):u;h!==t&&o.current?.(h)}else i(u)},[a,t,i,o]);return[l,c]}function pB({defaultProp:t,onChange:e}){const[r,s]=S.useState(t),n=S.useRef(r),i=S.useRef(e);return dB(()=>{i.current=e},[e]),S.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}function mB(t){return typeof t=="function"}var gB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),AB="VisuallyHidden",cq=S.forwardRef((t,e)=>p.jsx(os.span,{...t,ref:e,style:{...gB,...t.style}}));cq.displayName=AB;var yB=cq,[xl,cL]=Bw("Tooltip",[Zw]),bl=Zw(),xB="TooltipProvider",hh="tooltip.open",[uL,Xd]=xl(xB),Yi="Tooltip",[bB,yo]=xl(Yi),uq=t=>{const{__scopeTooltip:e,children:r,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=Xd(Yi,t.__scopeTooltip),c=bl(e),[u,h]=S.useState(null),d=XI(),f=S.useRef(0),m=o??l.disableHoverableContent,A=a??l.delayDuration,g=S.useRef(!1),[y,w]=fB({prop:s,defaultProp:n??!1,onChange:v=>{v?(l.onOpen(),document.dispatchEvent(new CustomEvent(hh))):l.onClose(),i?.(v)},caller:Yi}),x=S.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),b=S.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g.current=!1,w(!0)},[w]),V=S.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w(!1)},[w]),_=S.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{g.current=!0,w(!0),f.current=0},A)},[A,w]);return S.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),p.jsx(nB,{...c,children:p.jsx(bB,{scope:e,contentId:d,open:y,stateAttribute:x,trigger:u,onTriggerChange:h,onTriggerEnter:S.useCallback(()=>{l.isOpenDelayedRef.current?_():b()},[l.isOpenDelayedRef,_,b]),onTriggerLeave:S.useCallback(()=>{m?V():(window.clearTimeout(f.current),f.current=0)},[V,m]),onOpen:b,onClose:V,disableHoverableContent:m,children:r})})};uq.displayName=Yi;var dh="TooltipTrigger",hq=S.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=yo(dh,r),i=Xd(dh,r),o=bl(r),a=S.useRef(null),l=Us(e,a,n.onTriggerChange),c=S.useRef(!1),u=S.useRef(!1),h=S.useCallback(()=>c.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),p.jsx(iB,{asChild:!0,...o,children:p.jsx(os.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:l,onPointerMove:Cr(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:Cr(t.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:Cr(t.onPointerDown,()=>{n.open&&n.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Cr(t.onFocus,()=>{c.current||n.onOpen()}),onBlur:Cr(t.onBlur,n.onClose),onClick:Cr(t.onClick,n.onClose)})})});hq.displayName=dh;var Jd="TooltipPortal",[wB,qB]=xl(Jd,{forceMount:void 0}),dq=t=>{const{__scopeTooltip:e,forceMount:r,children:s,container:n}=t,i=yo(Jd,e);return p.jsx(wB,{scope:e,forceMount:r,children:p.jsx(Kd,{present:r||i.open,children:p.jsx(lq,{asChild:!0,container:n,children:s})})})};dq.displayName=Jd;var En="TooltipContent",fq=S.forwardRef((t,e)=>{const r=qB(En,t.__scopeTooltip),{forceMount:s=r.forceMount,side:n="top",...i}=t,o=yo(En,t.__scopeTooltip);return p.jsx(Kd,{present:s||o.open,children:o.disableHoverableContent?p.jsx(pq,{side:n,...i,ref:e}):p.jsx(vB,{side:n,...i,ref:e})})}),vB=S.forwardRef((t,e)=>{const r=yo(En,t.__scopeTooltip),s=Xd(En,t.__scopeTooltip),n=S.useRef(null),i=Us(e,n),[o,a]=S.useState(null),{trigger:l,onClose:c}=r,u=n.current,{onPointerInTransitChange:h}=s,d=S.useCallback(()=>{a(null),h(!1)},[h]),f=S.useCallback((m,A)=>{const g=m.currentTarget,y={x:m.clientX,y:m.clientY},w=CB(y,g.getBoundingClientRect()),x=PB(y,w),b=EB(A.getBoundingClientRect()),V=RB([...x,...b]);a(V),h(!0)},[h]);return S.useEffect(()=>()=>d(),[d]),S.useEffect(()=>{if(l&&u){const m=g=>f(g,u),A=g=>f(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",A)}}},[l,u,f,d]),S.useEffect(()=>{if(o){const m=A=>{const g=A.target,y={x:A.clientX,y:A.clientY},w=l?.contains(g)||u?.contains(g),x=!TB(y,o);w?d():x&&(d(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,d]),p.jsx(pq,{...t,ref:i})}),[VB,_B]=xl(Yi,{isInside:!1}),SB=jI("TooltipContent"),pq=S.forwardRef((t,e)=>{const{__scopeTooltip:r,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=yo(En,r),c=bl(r),{onClose:u}=l;return S.useEffect(()=>(document.addEventListener(hh,u),()=>document.removeEventListener(hh,u)),[u]),S.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),p.jsx(Nw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:p.jsxs(oB,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(SB,{children:s}),p.jsx(VB,{scope:r,isInside:!0,children:p.jsx(yB,{id:l.contentId,role:"tooltip",children:n||s})})]})})});fq.displayName=En;var mq="TooltipArrow",kB=S.forwardRef((t,e)=>{const{__scopeTooltip:r,...s}=t,n=bl(r);return _B(mq,r).isInside?null:p.jsx(aB,{...n,...s,ref:e})});kB.displayName=mq;function CB(t,e){const r=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,s,n,i)){case i:return"left";case n:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function PB(t,e,r=5){const s=[];switch(e){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function EB(t){const{top:e,right:r,bottom:s,left:n}=t;return[{x:n,y:e},{x:r,y:e},{x:r,y:s},{x:n,y:s}]}function TB(t,e){const{x:r,y:s}=t;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>s!=d>s&&r<(h-c)*(s-u)/(d-u)+c&&(n=!n)}return n}function RB(t){const e=t.slice();return e.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),MB(e)}function MB(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const n=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const r=[];for(let s=t.length-1;s>=0;s--){const n=t[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var IB=uq;const Zd=({triggerContent:t,tooltipContent:e})=>e?p.jsxs(IB,{children:[p.jsx(hq,{asChild:!0,children:t}),p.jsx(dq,{children:p.jsx(An,{scaleFactor:2,children:p.jsx(fq,{side:"bottom",align:"end",className:"bg-highlightBeige text-white p-1 mt-oneScaledPix drop-shadow-oneBlock z-popups",children:typeof e=="string"?p.jsx("div",{className:"max-w-16",children:p.jsx(_e,{markdown:e})}):e})})})]}):t,jB=/^(?<modifiers>[^]*)(?<key>.+)$/,BB=t=>{const e=new Set;for(const r of t){if(e.has(r))return!0;e.add(r)}return!1},ef=(t,e,r,s=void 0)=>{const n=t?.join(" ");S.useEffect(()=>{if(!t||t.length===0||s===null)return;const i=s??window,o=a=>{let c=a.target;for(;c&&c!==i;){if(c.classList.contains("no-keyboard-shortcuts"))return;c=c.parentElement}for(const u of t){const h=u.match(jB);if(!h||!h.groups)continue;const{modifiers:d,key:f}=h.groups;if(BB(d)){console.warn(`Invalid shortcut "${u}": duplicate modifiers`);continue}const m=d.includes("^"),A=d.includes(""),g=d.includes(""),y=d.includes(""),w=m||A||g||y,x=m===a.ctrlKey&&A===a.metaKey&&g===a.shiftKey&&y===a.altKey&&(w||!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey);if((y&&a.altKey?a.code.replace(/^Key/,"").toLowerCase():a.key.toLowerCase())===f.toLowerCase()&&x){e||r?.(),a.preventDefault();break}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[e,r,n,s])},OB=({className:t,selected:e,disabled:r=!1,onClick:s,ref:n,tooltipContent:i,shortcutKeys:o,children:a,...l})=>{ef(o,r,s);const c=p.jsx("button",{disabled:r,onClick:s,"data-selected":e,className:Nd(`inline-flex items-center justify-center whitespace-nowrap 
          bg-metallicBlue zx:bg-zxBlue border-none border-shadow
          gap-2
           disabled:bg-midGrey disabled:text-lightGrey 
           data-[selected=true]:bg-lightBeige
           [&:not(:disabled):hover:not([data-selected=true])]:bg-pastelBlue 
           `,t),ref:n,...l,children:a}),u=Dd(typeof i=="string"?i:void 0,o)??i;return p.jsx(Zd,{triggerContent:c,tooltipContent:u})},ce=t=>t,zB=t=>{const e=t.length;if(e===1)return[t[0]];let r=0;for(let n=0;n<e-1;n++)r=Math.max(r,t[n].length+n);const s=t[e-1].length+(e-1);return r=Math.max(r,s),t.map((n,i)=>{if(i===e-1){const a=r-n.length;return" ".repeat(a)+n}else{const a=i,l=r-n.length-a;return" ".repeat(a)+n+" ".repeat(l)}})},gq=({label:t})=>p.jsx(F,{className:"inline-block mr-1 text-lightGrey py-half",noSlitWords:!0,children:t}),ks=({className:t,value:e,onChange:r,trueLabel:s="ON",falseLabel:n="OFF",label:i,shortcutKeys:o,tooltipContent:a})=>{const l=Math.max(s.length,n.length)+1,c=s.padStart(l," "),u=n.padEnd(l," ");ef(o,!1,()=>{r?.(!e,void 0)});const h=p.jsxs("span",{onClick:f=>r?.(!e,f),className:Nd("inline-flex justify-between leading-none",t),children:[i&&p.jsx(gq,{label:i}),p.jsx(F,{role:"switch",className:zd("inline-block w-min h-min py-half px-half",e?"bg-shadowHalfbrite text-moss zx:bg-zxBlack zx:text-zxGreen":"bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"),noSlitWords:!0,children:e?c:u})]}),d=Dd(typeof a=="string"?a:void 0,o)??a;return p.jsx(Zd,{triggerContent:h,tooltipContent:d})},hA=ce(["bg-redShadowHalfbrite text-highlightBeige zx:bg-zxBlack zx:text-zxGreen","bg-metallicBlueHalfbrite text-pastelBlue zx:bg-zxBlack zx:text-zxBlue","bg-pinkHalfbrite text-pink zx:bg-zxBlack zx:text-zxYellow","bg-redShadowHalfbrite text-midRed zx:bg-zxBlack zx:text-zxRed"]),tf=({className:t,value:e,onChange:r,values:s,valueLabels:n=s.map(l=>`${l}`),label:i,shortcutKeys:o,tooltipContent:a})=>{const l=s.indexOf(e),c=s.length,u=S.useCallback(()=>{const A=(l+1)%c;r?.(s[A],void 0)},[r,l,s,c]);ef(o,!1,()=>{u()});const h=zB(n),d=c>4?l%4:l,f=p.jsxs("span",{onClick:u,className:Nd("inline-flex justify-between leading-none",t),children:[i&&p.jsx(gq,{label:i}),p.jsx(F,{role:"switch",className:zd("inline-block w-min h-min py-half px-half",hA[d]??hA[0]),noSlitWords:!0,children:h[l]})]}),m=Dd(typeof a=="string"?a:void 0,o)??a;return p.jsx(Zd,{triggerContent:f,tooltipContent:m})},cr=ce("[&_.em]:text-moss zx:[&_.em]:text-zxCyan text-lightGrey zx:text-zxBlack sprites-normal-height"),Se="sprite zx:sprite-revert-to-two-tone colourised:brightness-halfBrite selectedMenuItem:filter-none zx:selectedMenuItem:sprite-revert-zxYellow sprites-normal-height",NB="**4-way**: true to the 1987 original - move in x directions only",DB="**8-way**: the original with *4-way* movement, plus *diagonals*",FB="**analogue**: move in *any* direction with analogue stick",LB=()=>{const t=Kx();return p.jsx(Y,{id:"analogueControl",label:"Directions",leader:p.jsx("span",{className:`${Se} texture-joystick sprites-normal-height`}),valueElement:p.jsx(tf,{className:"ml-auto",values:Zx,valueLabels:["4w","8w","al"],value:t}),onSelect:H(yC),verticalAlignItemsCentre:!0,doubleHeightWhenFocussed:!0,hintInline:!0,hint:p.jsx(_e,{className:cr,markdown:t==="analogue"?FB:t==="8-way"?DB:NB})})},UB=()=>p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"onScreenControls",label:p.jsx(F,{className:`${qe} mobile:w-max`,children:"touch controls"}),valueElement:p.jsx(ks,{className:"ml-auto",value:sC()}),onSelect:H(ur,"userSettings.onScreenControls"),verticalAlignItemsCentre:!0,hintInline:!0,hint:p.jsx(_e,{className:cr,markdown:`enables on-screen controls: for mobile, tablet, or any device with a touch-screen.

You can turn this off for phones paired with joypads/keyboards`})}),rf="text-metallicBlueHalfbrite zx:text-zxBlue disabledMenuItem:text-midGrey zx:disabledMenuItem:text-zxYellow selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxGreen",sf="scrollbar-thumb-midGrey scrollbar-track-white zx:scrollbar-thumb-zxBlue zx:scrollbar-track-zxWhite ",HB="**world**: Control is relative to directions in the isometric world",$B=`**screen**: Control is relative to the screen.

More intuitive if you find directions confusing in isometric games, but means hitting diagonals a lot`,GB=()=>{const t=md();return p.jsx(tf,{className:"ml-auto",values:["world","screen"],value:t?"screen":"world"})},WB=()=>{const t=md();return p.jsx(Y,{id:"screenRelativeControl",label:"input axes",leader:p.jsx("span",{className:`${Se} ${t?"texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_screenDirections":"texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_worldDirections sprites-normal-height"} `}),valueElement:p.jsx(GB,{}),onSelect:H(ur,"userSettings.screenRelativeControl"),hintInline:!0,verticalAlignItemsCentre:!0,doubleHeightWhenFocussed:!0,hint:p.jsx(_e,{className:cr,markdown:t?$B:HB})})},qs="text-mossHalfbrite zx:text-zxGreen selectedMenuItem:text-moss zx:selectedMenuItem:text-zxGreen",YB=t=>{const e=/(Numpad|F)(.*)/.exec(t);if(e!==null)return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:qs,children:e[1]}),e[2]]});switch(t){case" ":return"space";case"ArrowDown":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:qs,children:"Cursor"}),""]});case"ArrowUp":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:qs,children:"Cursor"}),""]});case"ArrowLeft":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:qs,children:"Cursor"}),""]});case"ArrowRight":return p.jsxs(p.Fragment,{children:[p.jsx("span",{className:qs,children:"Cursor"}),""]});default:return t}},QB=["","","R","R"],KB=t=>QB[t]??`axis${t}`,XB=t=>{switch(Tp[t]){case"dPadDown":return"d-Pad";case"dPadUp":return"d-Pad";case"dPadLeft":return"d-Pad";case"dPadRight":return"d-Pad";case"a":return p.jsx("span",{className:"colourised:text-mossHalfbrite colourised:selectedMenuItem:text-moss zx:text-zxGreen",children:"a"});case"b":return p.jsx("span",{className:"colourised:text-midRedHalfbrite colourised:selectedMenuItem:text-midRed zx:text-zxRed",children:"b"});case"x":return p.jsx("span",{className:"colourised:text-metallicBlueHalfbrite colourised:selectedMenuItem:text-metallicBlue zx:text-zxBlue",children:"x"});case"y":return p.jsx("span",{className:"colourised:text-highlightBeigeHalfbrite colourised:selectedMenuItem:text-highlightBeige zx:text-zxYellow",children:"y"})}return Tp[t]??t},nf=({action:t,keyClassName:e,className:r,flashingCursor:s=!1})=>{const n=ie(o=>o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput?.presses:Na(o).presses[t]),i=ie(o=>{const a=Vw(t);return a===void 0?ma:o.gameMenus.assigningInput?.action===t?o.gameMenus.assigningInput.axes:Na(o).axes[a.axis]});return p.jsxs("div",{className:r,children:[n.keys.map(o=>p.jsx("span",{className:gt("text-nowrap",e),children:p.jsx(xt,{children:YB(o)})},`key:${o}`)),i.map(o=>p.jsx("span",{className:gt("text-nowrap",e),children:p.jsxs(xt,{children:[p.jsx("span",{className:qs,children:""}),KB(o)]})},`gamePadAxis:${o}`)),n.gamepadButtons.map(o=>p.jsx("span",{className:gt("text-nowrap",e),children:p.jsxs(xt,{children:[p.jsx("span",{className:qs,children:""}),XB(o)]})},`gamePadButton:${o}`)),s&&p.jsx("span",{className:"sprite texture-hud_char_space bg-[currentColor] animate-flash"})]})},dA="text-pink zx:text-zxCyan",JB=()=>{const t=ie(({gameMenus:e})=>e.assigningInput?.action);return t===void 0?null:p.jsxs("div",{className:`
        bg-metallicBlueHalfbrite text-white
        zx:bg-zxBlueDimmed zx:text-zxCyanDimmed

        ${qe} inline-block absolute inset-x-0 bottom-0 h-min pt-1 px-1`,children:[p.jsx(F,{children:"Press "}),p.jsx(nf,{className:`inline ${dA}`,action:"menu_openOrExit",keyClassName:"me-1"}),p.jsx(F,{children:"when done selecting keys for "}),p.jsx(F,{className:dA,children:t})]})},ZB="text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",Ge=({className:t,action:e})=>{const r=ie(s=>s.gameMenus.assigningInput?.action===e);return p.jsx(nf,{className:gt("flex flex-wrap gap-y-oneScaledPix gap-x-1",t),action:e,keyClassName:ZB,flashingCursor:r})},eO=({className:t})=>{const e=ie(G1);return p.jsx(F,{className:gt("text-nowrap","text-pinkHalfbrite zx:text-zxRed selectedMenuItem:text-pink zx:selectedMenuItem:text-zxRed",t),children:e??"custom"})},tO=()=>{const t=md();return p.jsxs(p.Fragment,{children:[p.jsx(Y,{id:"preset",label:p.jsx(F,{className:`inline-block w-6 ${qe}`,children:"key/ button preset"}),valueElement:p.jsx(eO,{}),onSelect:H(bt,"inputPreset")}),p.jsx(Y,{id:"left",label:`Left ${t?"":""}`,leader:p.jsx("span",{className:`${Se} ${t?"texture-head_walking_towardsLeft_2 selectedMenuItem:texture-animated-head_walking_towardsLeft":"texture-head_walking_left_2 selectedMenuItem:texture-animated-head_walking_left"}`}),valueElement:p.jsx(Ge,{action:"left"}),onSelect:H($e,"left")}),p.jsx(Y,{id:"right",label:`Right ${t?"":""}`,leader:p.jsx("span",{className:`${Se} ${t?"texture-head_walking_awayRight_2 selectedMenuItem:texture-animated-head_walking_awayRight":"texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right"}`}),valueElement:p.jsx(Ge,{action:"right"}),onSelect:H($e,"right")}),p.jsx(Y,{id:"up",label:`Up ${t?"":""}`,leader:p.jsx("span",{className:`${Se} ${t?"texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_awayLeft":"texture-head_walking_away_2 selectedMenuItem:texture-animated-head_walking_away"}`}),valueElement:p.jsx(Ge,{action:"away"}),onSelect:H($e,"away")}),p.jsx(Y,{id:"down",label:`Down ${t?"":""}`,leader:p.jsx("span",{className:`${Se} ${t?"texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight":"texture-head_walking_towards_2 selectedMenuItem:texture-animated-head_walking_towards"}`}),valueElement:p.jsx(Ge,{action:"towards"}),onSelect:H($e,"towards")}),p.jsxs("div",{className:`${qe} col-span-3`,children:[p.jsx(F,{className:"text-midRed bg-pureBlack inline-block zx:text-zxRed zx:bg-zxYellow me-1",children:"Note:"}),p.jsx(F,{className:"text-midGrey zx:text-zxBlack",children:"some puzzles require you to jump and pick up simultaneously - assign a key for both jump and carry"})]}),p.jsx(Y,{id:"jump",label:"Jump",leader:p.jsx("span",{className:`${Se} texture-spring_released selectedMenuItem:texture-spring_compressed`}),valueElement:p.jsx(Ge,{action:"jump"}),onSelect:H($e,"jump")}),p.jsx(Y,{id:"carry",label:"Carry",leader:p.jsx("span",{className:`${Se} texture-bag`}),valueElement:p.jsx(Ge,{action:"carry"}),onSelect:H($e,"carry"),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"**carrying is heels only**. requires the bag"}),hintInline:!0}),p.jsx(Y,{id:"fire",label:p.jsx(F,{className:`inline-block w-6 ${qe}`,children:"fire dough- nuts"}),leader:p.jsx("span",{className:`${Se} texture-doughnuts`}),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"**firing doughnuts is head only**. requires the hooter"}),hintInline:!0,valueElement:p.jsx(Ge,{action:"fire"}),onSelect:H($e,"fire")}),p.jsx(Y,{id:"swop",label:"Swop",valueElement:p.jsx(Ge,{action:"swop"}),onSelect:H($e,"swop"),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"Like the swop key from the original game; *cycles through* the characters, Moves *in and out of symbiosis* if head is on top of heels"}),hintInline:!0,leader:p.jsxs("span",{className:`${Se} texture-blank relative overflow-hidden`,children:[p.jsx("span",{className:`${Se} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight absolute right-[50%]`}),p.jsx("span",{className:`${Se} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight absolute left-[50%]`})]})}),p.jsx(Y,{id:"swopHead",label:p.jsx(F,{className:`inline-block w-6 ${qe}`,children:"Swop to head"}),valueElement:p.jsx(Ge,{action:"swop.head"}),onSelect:H($e,"swop.head"),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *head*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Se} texture-head_walking_towardsRight_2 selectedMenuItem:texture-animated-head_walking_towardsRight`})}),p.jsx(Y,{id:"swopHeels",label:p.jsxs("div",{className:`w-6 ${qe}`,children:[p.jsx(F,{className:"me-1",children:"Swop to"}),p.jsx(F,{className:"text-pinkHalfbrite selectedMenuItem:text-pink",children:"heels"})]}),valueElement:p.jsx(Ge,{action:"swop.heels"}),onSelect:H($e,"swop.heels"),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"**shortcut**: go *directly* to *heels*, avoiding cycling if in symbiosis"}),hintInline:!0,leader:p.jsx("span",{className:`${Se} texture-heels_walking_towardsRight_2 selectedMenuItem:texture-animated-heels_walking_towardsRight`})}),p.jsx(Y,{id:"map",label:"Map",valueElement:p.jsx(Ge,{action:"map"}),onSelect:H($e,"map"),leader:p.jsx("span",{className:`${Se} texture-scroll`})}),p.jsx(Y,{id:"hold",label:"Pause",valueElement:p.jsx(Ge,{action:"hold"}),onSelect:H($e,"hold"),leader:p.jsx("span",{className:`${Se} texture-drum`})}),p.jsxs("div",{className:"col-span-3",children:[p.jsx(F,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${qe} pt-1 sprites-double-height pb-1`,children:"Look controls"}),p.jsx(F,{TagName:"h2",className:`text-midGrey zx:text-zxBlack ${qe}`,children:"useful for seeing more of larger rooms that don't fit on the screen."})]}),p.jsx(Y,{id:"lookShift",label:"Look",valueElement:p.jsx(Ge,{action:"lookShift"}),onSelect:H($e,"lookShift"),hint:p.jsx(_e,{className:"text-midGrey zx:text-zxBlack",markdown:"Hold the look key and press a direction to look around the room"}),hintInline:!0}),p.jsx(Y,{id:"lookLeft",label:"Look ",valueElement:p.jsx(Ge,{action:"lookLeft"}),onSelect:H($e,"lookLeft")}),p.jsx(Y,{id:"lookRight",label:"Look ",valueElement:p.jsx(Ge,{action:"lookRight"}),onSelect:H($e,"lookRight")}),p.jsx(Y,{id:"lookUp",label:"Look ",valueElement:p.jsx(Ge,{action:"lookUp"}),onSelect:H($e,"lookUp")}),p.jsx(Y,{id:"lookDown",label:"Look ",valueElement:p.jsx(Ge,{action:"lookDown"}),onSelect:H($e,"lookDown")}),p.jsx("div",{className:"col-span-3",children:p.jsx(F,{TagName:"h2",className:`text-midRed zx:text-zxBlue ${qe} pt-1  sprites-double-height`,children:"Remake option toggles"})}),p.jsx(Y,{id:"toggleColourisation",label:p.jsx(F,{className:`inline-block w-6 ${qe}`,children:"toggle colour- isation"}),valueElement:p.jsx(Ge,{action:"toggleColourisation"}),onSelect:H($e,"toggleColourisation")}),p.jsx(Y,{id:"cycleRes",label:p.jsx(F,{className:`inline-block w-6 ${qe}`,children:"cycle res- olution"}),valueElement:p.jsx(Ge,{action:"cycleResolution"}),onSelect:H($e,"cycleResolution")})]})},rO=()=>{const t=!Wx();dt({action:"menu_openOrExit",handler:S.useCallback(()=>{xe.dispatch(fC())},[]),disabled:t}),aI({handler:S.useCallback((e,r)=>{r.currentActionPress("menu_openOrExit")==="released"&&Gx(xe.getState())&&xe.dispatch(pC(e))},[]),disabled:t})},sO=({showAll:t})=>p.jsxs("div",{className:"text-metallicBlueHalfbrite zx:text-zxBlue",children:[p.jsx(F,{className:`block mb-1 ${qe}`,children:"Detected that you are on a phone or tablet"}),p.jsx(F,{className:`block mb-1 ${qe}`,children:"Additional settings for keys and gamepad buttons are designed for desktop/laptops, but you can use them on phones/tablets if you have a keyboard or gamepad connected"}),p.jsx(OB,{className:`block w-full mb-2 text-white p-1 bg-midRed zx:text-zxRed ${qe}`,onClick:t,children:p.jsx(F,{children:"Tap here to show all settings"})})]}),fA=" !gap-y-1 ",nO=()=>{rO();const[t,e]=S.useState(!hr()),r=Kx();return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:H(Le)}),p.jsxs(ke,{fullScreen:!0,className:`bg-white zx:bg-zxWhite pl-1 py-0 ${rf}`,children:[p.jsxs("div",{className:"flex flex-col gap-y-1 pr-1 overflow-y-scroll scrollbar  scrollbar-w-1 "+sf,children:[p.jsx(is,{className:"pt-half"}),p.jsx(F,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height block ml-4",children:"control options"}),p.jsxs(Te,{className:`${fA} w-full`,children:[p.jsx(LB,{}),p.jsx(UB,{}),r!=="4-way"&&t&&p.jsx(WB,{})]}),t?p.jsxs(p.Fragment,{children:[p.jsx(F,{TagName:"h1",className:"text-midRed zx:text-zxBlue sprites-double-height mt-1 block col-span-3",children:"Select the keys"}),p.jsx(Te,{className:`${fA} !sprites-normal-height`,children:p.jsx(tO,{})})]}):p.jsx(p.Fragment,{children:p.jsx(sO,{showAll:()=>e(!0)})})]}),p.jsx(JB,{})]})]})},iO="/assets/rock-C4e7VvX5.mp3",pA={egyptus:["text-lightBeige","text-midRed","text-highlightBeige"],blacktooth:["text-midGrey","text-lightGrey","text-moss","text-midRed"],safari:["text-moss","text-midRed","text-highlightBeige"],bookworld:["text-midRed","text-redShadow","text-midGrey"],penitentiary:["text-shadow","text-metallicBlue","text-midGrey"]},oO={egyptus:ce("texture-crown_egyptus"),blacktooth:ce("texture-crown_blacktooth"),bookworld:ce("texture-crown_bookworld"),penitentiary:ce("texture-crown_penitentiary"),safari:ce("texture-crown_safari")},ci=({planet:t,className:e,label:r=t})=>{const s=ie(i=>i.gameMenus.gameInPlay.planetsLiberated[t]),n=!pd();return p.jsxs("div",{className:`flex flex-col ${e}`,children:[p.jsx("span",{className:`sprite block ${oO[t]} ${s?"zx:sprite-revert-zxYellow":"colourised:brightness-halfBrite zx:sprite-revert-zxMagenta"} mx-auto`}),p.jsx("span",{className:`sprite block texture-ball zx:sprite-revert-zxYellow mx-auto ${s?"":"colourised:brightness-halfBrite"} ${pA[t][0]}`}),p.jsx(F,{classnameCycle:n?pA[t]:void 0,className:`block mx-auto zx:text-zxMagenta ${s?"":"colourised:brightness-halfBrite"}`,children:r})]})},aO=()=>p.jsxs(p.Fragment,{children:[p.jsx(F,{className:"block sprites-double-height text-highlightBeige zx:text-zxYellow mx-auto w-max",children:"The blacktooth empire"}),p.jsxs("div",{className:"mx-auto relative w-0 h-1",children:[p.jsx(ci,{planet:"egyptus",className:"w-12 absolute left-m10 top-1 resHandheld:left-m8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(ci,{planet:"penitentiary",className:"w-12 absolute left-10 top-1 resHandheld:left-8 resHandheld:top-m1 translate-x-[-50%]"}),p.jsx(ci,{planet:"safari",className:"w-12 left-m10 top-15 absolute resHandheld:left-m8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(ci,{planet:"bookworld",label:"book world",className:"w-12 absolute left-10 top-15 resHandheld:left-8 resHandheld:top-8 translate-x-[-50%]"}),p.jsx(ci,{planet:"blacktooth",className:"w-12 absolute left-0 top-8 resHandheld:left-0 ml-[-50%] resHandheld:top-3 translate-x-[-50%]"})]})]}),lO=({playMusic:t=!1})=>{const e=vw(),r=H(Le);return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsxs(ke,{className:"bg-pureBlack w-zx h-full block p-0",onClick:e?void 0:r,dialogId:"crowns",children:[t&&p.jsx("audio",{src:iO,autoPlay:!0,loop:!0}),p.jsx(aO,{}),p.jsx(Te,{className:"hidden",children:!e&&p.jsx(xr,{})})]})]})},Yn=t=>p.jsx("div",{className:`col-span-3 h-1 ${t}`}),xo=({className:t})=>p.jsx("div",{className:gt("contents",t),children:p.jsx(Ls.Placeholder,{})}),cO=t=>t.replace(/([a-z])([A-Z])/g,"$1 $2"),uO=({resolutionName:t})=>{const e=ie(ll),r=Fn[t];return p.jsx(Y,{id:t,label:`${e===t?"* ":""}${cO(t)}`,doubleHeightWhenFocussed:!0,hint:`${r.x} x ${r.y}`,onSelect:H(bd,t)},t)},hO=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Le)}),p.jsx(ke,{className:"bg-white pl-1",children:p.jsxs(Ls.Provider,{children:[p.jsx(F,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Emulated resolution"}),p.jsxs(Te,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[cx(Fn).map(t=>p.jsx(uO,{resolutionName:t})),p.jsx(Yn,{}),p.jsx(xr,{})]}),p.jsx(xo,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),dO="/Users/jim/dev/hohjs",fO=({children:t})=>{const e=/https?:\/\/[^\s)>\]}]+/gi,r=t.split(e),s=[...t.matchAll(e)],n=[];return r.forEach((i,o)=>{n.push(i);const a=s[o];if(a)try{const[l]=a,c=new URL(l);if(c.pathname.startsWith("/node_modules/.vite/deps/")){n.push(l);return}const u=`${dO}${c.pathname}`,h=l.match(/:(\d+):(\d+)$/),d=h?`:${h[1]}:${h[2]}`:"",f=`vscode://file${u}${d}`;n.push(p.jsx("a",{href:f,target:"_blank",children:c.pathname},o))}catch{n.push(a[0])}}),p.jsx(S.Fragment,{children:n})},pO=t=>{const{message:e,stack:r}=t;if(!r)return{message:e,sanitizedStack:""};const s=/^(?:Error|TypeError|ReferenceError|SyntaxError|RangeError|EvalError|URIError):\s*/,n=s.test(r);let i=r;n&&(i=i.replace(s,"")),i.startsWith(e)&&(i=i.slice(e.length),i=i.replace(/^\n/,""));const o=i.indexOf(`
`);if(o!==-1){const a=i.slice(0,o);(a===e||a===`Error: ${e}`)&&(i=i.slice(o+1))}return i=i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).join(`
`),{message:e,sanitizedStack:i}},mO=`##The game crashed!
You could:

* open an [issue on github](https://github.com/jimhigson/head-over-heels-online/issues)
* email [jim@blockstack.ing](mailto:jim@blockstack.ing)
* rant on the [discord server](https://discord.gg/XmV9QNWY)
* play [the msx remake](https://www.file-hunter.com/Homebrew/?id=headoverheels) instead`,gO=({errors:t})=>{const e=ie(o=>o.gameMenus.gameInPlay.reincarnationPoint!==void 0),[r,s]=S.useState(!1),n=H(xd),i=t.toReversed().map(o=>{const{message:a,sanitizedStack:l}=pO(o);return`
${a}

${l}
  `}).join(`
    

 ERROR        CAUGHT, WRAPPED, & RETHROWN 


`);return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"loading-border"}),p.jsx(ke,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1",tall:!0,wide:!0,children:p.jsxs("div",{className:"overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan",children:[p.jsx(_e,{markdown:mO}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsxs(Te,{className:`text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1 ${qe}`,children:[p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"tryContinue",label:"Ignore, hope it goes away",onSelect:H(bm,"ignore")}),e&&p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Try reincarnating",onSelect:n}),p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"clearAllData",label:"Clear all data, start again",onSelect:H(bm,"clearAllData")}),r?p.jsx(F,{className:"text-metallicBlue col-span-2 sprites-double-height ml-3",children:"Error report copied"}):p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"copyClipboard",label:"Copy error to clipboard",onSelect:()=>navigator.clipboard.writeText(i).then(()=>s(!0))})]}),p.jsx("hr",{className:"bg-pastelBlue zx:bg-zxWhite h-1 my-1 border-none"}),p.jsx(F,{className:"block sprites-double-height my-1 text-midRed zx:text-zxWhite`",children:"Error message for nerds:"}),p.jsx("pre",{className:"bg-shadow zx:bg-zxBlack text-white zx:text-zxWhite leading-[1em] [&_a]:text-pastelBlue px-1 w-max min-w-full",children:p.jsx(fO,{children:i})})]})})]})},AO=({action:t,className:e,keyClassName:r="text-pink zx:text-zxRed"})=>p.jsx("div",{className:`${e} bg-zxBlack py-oneScaledPix`,children:Pt()==="desktop"?p.jsxs(p.Fragment,{children:[p.jsx(F,{className:"me-1",children:"Press"}),p.jsx(F,{className:gt("me-1",r),children:t}),p.jsx(F,{children:"to continue"}),p.jsxs("div",{className:"flex flex-row gap-1 w-min mx-auto",children:[p.jsx(F,{children:"("}),p.jsx(nf,{className:"flex flex-row gap-1",keyClassName:r,action:"hold"}),p.jsx(F,{children:")"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx(F,{className:gt("me-1",r),children:"Tap"}),p.jsx(F,{children:"to continue"})]})}),yO=()=>p.jsx(Oe,{children:p.jsxs(ke,{className:"!h-min !w-max text-center text-zxCyan p-0 bg-transparent",onClick:H(Le),children:[p.jsx(F,{className:"block w-min mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix",children:"hold"}),p.jsx("span",{className:"zx",children:p.jsx(AO,{className:`${qe} px-1`,action:"hold"})})]})}),xO=({presetName:t})=>p.jsx(Y,{id:t,label:t,doubleHeightWhenFocussed:!0,hint:vn[t].description,onSelect:H(mC,t)},t),bO=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Le)}),p.jsx(ke,{className:"bg-white pl-1",children:p.jsxs(Ls.Provider,{children:[p.jsx(F,{TagName:"h1",className:"text-midRed zx:text-zxRed sprites-double-height ml-3",children:"Key presets"}),p.jsxs(Te,{className:"text-metallicBlue zx:text-zxBlue selectedMenuItem:text-moss zx:selectedMenuItem:text-zxMagenta",children:[cx(vn).map(t=>p.jsx(xO,{presetName:t},t)),p.jsx(Yn,{}),p.jsx(xr,{})]}),p.jsx(xo,{className:"text-midGrey zx:text-zxMagenta"})]})})]}),wO="https://github.com/jimhigson/head-over-heels-online/",qO=()=>{const[t,e]=S.useReducer(r=>!r,!1);return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"flex absolute top-oneScaledPix right-1 z-dialog",children:p.jsxs("a",{href:wO,className:"bitmap-text-link bg-transparent zx:bg-zxBlack",children:[p.jsx(F,{className:"text-highlightBeige zx:text-zxYellow",children:""}),p.jsxs("span",{className:"text-lightGrey zx:text-whiteHalfbrite",children:[p.jsx(F,{className:"resHandheld:hidden",children:" on"}),p.jsx(F,{children:nb}),p.jsx(F,{className:"resHandheld:hidden",children:"github"})]})]})}),p.jsx("div",{className:"flex absolute bottom-oneScaledPix right-oneScaledPix z-dialog",children:p.jsxs("div",{onClick:e,className:"text-metallicBlue zx:text-zxMagenta",children:[!t&&p.jsx(F,{children:"v"}),t&&p.jsxs(F,{className:"bg-metallicBlueHalfbrite block",children:["2feac76","2025-09-14"]})]})})]})},Pr=["text-midRed zx:text-zxCyan","text-highlightBeige zx:text-zxYellow","text-moss zx:text-zxWhite"],vO=({className:t})=>p.jsxs("div",{className:`flex justify-center gap-2 resHandheld:gap-1 leading-none ${t??""}`,children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(F,{className:"text-pastelBlue zx:text-zxBlack",children:"1987 original"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(F,{classnameCycle:Pr,children:"Jon"}),p.jsx(F,{classnameCycle:Pr,children:"Ritman"})]}),p.jsxs("address",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(F,{classnameCycle:Pr,children:"Bernie"}),p.jsx(F,{classnameCycle:Pr,children:"Drummand"})]})]})]}),p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(F,{className:"text-pink zx:text-zxBlack",children:"2025 remake"}),p.jsx("address",{className:"flex",children:p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center",children:[p.jsx(F,{classnameCycle:Pr,children:"Jim"}),p.jsx(F,{classnameCycle:Pr,children:"Higson"})]})})]})]}),Tn=({facingXy8:t,character:e,action:r})=>{switch(e){case"head":{switch(r){case"walking":switch(t){case"away":return ce("texture-animated-head_walking_away");case"towards":return ce("texture-animated-head_walking_towards");case"left":return ce("texture-animated-head_walking_left");case"right":return ce("texture-animated-head_walking_right");case"awayRight":return ce("texture-animated-head_walking_awayRight");case"towardsRight":return ce("texture-animated-head_walking_towardsRight");case"towardsLeft":return ce("texture-animated-head_walking_towardsLeft");case"awayLeft":return ce("texture-animated-head_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return ce("texture-animated-head_idle_towards");case"right":return ce("texture-animated-head_idle_right");case"awayRight":return ce("texture-animated-head_idle_awayRight");case"towardsRight":return ce("texture-animated-head_idle_towardsRight");case"towardsLeft":return ce("texture-animated-head_idle_towardsLeft");case"away":return ce("texture-head_walking_away_2");case"left":return ce("texture-head_walking_left_2");case"awayLeft":return ce("texture-head_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}case"heels":{switch(r){case"walking":switch(t){case"away":return ce("texture-animated-heels_walking_away");case"towards":return ce("texture-animated-heels_walking_towards");case"left":return ce("texture-animated-heels_walking_left");case"right":return ce("texture-animated-heels_walking_right");case"awayRight":return ce("texture-animated-heels_walking_awayRight");case"towardsRight":return ce("texture-animated-heels_walking_towardsRight");case"towardsLeft":return ce("texture-animated-heels_walking_towardsLeft");case"awayLeft":return ce("texture-animated-heels_walking_awayLeft");default:throw new Error(`Invalid facingXy8: ${t}`)}case"idle":switch(t){case"towards":return ce("texture-heels_walking_towards_2");case"right":return ce("texture-heels_walking_right_2");case"awayRight":return ce("texture-heels_walking_awayRight_2");case"towardsRight":return ce("texture-heels_walking_towardsRight_2");case"towardsLeft":return ce("texture-heels_walking_towardsLeft_2");case"away":return ce("texture-heels_walking_away_2");case"left":return ce("texture-heels_walking_left_2");case"awayLeft":return ce("texture-heels_walking_awayLeft_2");default:throw new Error(`Invalid facingXy8: ${t}`)}}break}}},VO=(t,e,r)=>{const s=t.getBoundingClientRect(),n=s.left+s.width/2,i=s.top+s.height/2,o=n-e,a=i-r,c=_w({x:o,y:a});return Qh(c)},mA=({character:t,defaultFacing:e,className:r=""})=>{const[s,n]=S.useState(e),[i,o]=S.useState(!1),a=S.useRef(null);S.useEffect(()=>{const d=m=>{a.current&&n(VO(a.current,m.clientX,m.clientY)||"right")},f=()=>{n(e),o(!1)};return window.addEventListener("mousemove",d),document.addEventListener("mouseleave",f),()=>{window.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",f)}},[e,t]);const l=()=>{o(!0)},c=()=>{o(!1)},h=Tn({character:t,facingXy8:s,action:i?"walking":"idle"});return p.jsxs("div",{ref:a,className:`relative ${r}`,onMouseEnter:l,onMouseLeave:c,children:[p.jsx("span",{className:`sprite zx:sprite-revert-to-white ${h} relative z-topSprite`}),p.jsx("span",{className:"sprite zx:hidden texture-shadow_smallRound absolute left-0 top-[calc(var(--scale)*1px)] opacity-halfBrite"})]})},Aq=({noSubtitle:t,className:e})=>p.jsxs("div",{className:`flex flex-col items-center ${e}`,children:[p.jsxs("h1",{className:"flex",children:[p.jsxs("div",{className:"flex flex-col resHandheld:flex-row resHandheld:gap-1 gap-y-oneScaledPix items-center me-1",children:[p.jsx(F,{className:"sprites-double-height text-pastelBlue zx:text-zxYellow resHandheld:mt-1",children:"Head"}),p.jsx(mA,{character:"head",defaultFacing:"right",className:"mt-1 resHandheld:mt-0"})]}),p.jsx(F,{classnameCycle:Pr,className:"mt-1 me-1 resHandheld:mt-2",children:"over"}),p.jsxs("div",{className:"flex flex-col resHandheld:flex-row-reverse resHandheld:gap-1 items-center me-1",children:[p.jsx(F,{className:"sprites-double-height text-pink zx:text-zxYellow resHandheld:mt-1",children:"Heels"}),p.jsx(mA,{character:"heels",defaultFacing:"towards",className:"mt-1 resHandheld:mt-0"})]})]}),t||p.jsxs("h2",{className:"mt-1 w-max resHandheld:hidden",children:[p.jsx(F,{className:"text-midRed zx:text-zxCyan",children:"block"}),p.jsx(F,{className:"text-highlightBeige zx:text-zxYellow",children:"stack"}),p.jsx(F,{className:"text-metallicBlue zx:text-zxBlack",children:"."}),p.jsx(F,{className:"text-moss zx:text-zxWhite",children:"ing"}),p.jsx(F,{classnameCycle:Pr,children:" remake"})]})]}),_O=()=>{const t=_n(),e=H(uC),r=H(bt,"whichGame");return t?p.jsx(Y,{id:"playGame",label:p.jsx(F,{children:"Resume the game"}),doubleHeightWhenFocussed:!0,onSelect:e}):p.jsx(Y,{id:"playGame",label:p.jsx(F,{children:"Play the game"}),doubleHeightWhenFocussed:!0,onSelect:r})},SO=()=>p.jsx(Y,{id:"installGuide",label:"Install",doubleHeightWhenFocussed:!0,onSelect:H(bt,"installGuide")}),kO=()=>p.jsx(Y,{id:"levelEditor",label:"Level Editor",doubleHeightWhenFocussed:!0,onSelect:H(bt,"sureWantEditor")}),CO=()=>{const t=_n(),e=ie(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0);return p.jsx(Y,{id:"quitGame",label:e?"quit / reincarnate":"quit the game",className:"text-midRed zx:text-zxYellow",onSelect:H(bt,"quitGameConfirm"),doubleHeightWhenFocussed:!0,hidden:!t})},gA="https://discord.gg/Se5Jznc2jm",PO=t=>{const e=_n(),r=H(bt,"crowns"),s=H(bt,"score"),n=S.useCallback(()=>{r(),s()},[r,s]),i=M_();return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed"}),p.jsxs(ke,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 justify-center",children:[p.jsx(Aq,{noSubtitle:e,className:e?"resHandheld:hidden":""}),p.jsxs("div",{className:"text-highlightBeige zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:[p.jsxs(Te,{className:"w-24 mx-auto",children:[p.jsx(_O,{}),!e&&Pt()==="desktop"&&p.jsx(kO,{}),p.jsx(Y,{id:"map",label:"use the Map",onSelect:H(bt,"map"),doubleHeightWhenFocussed:!0,hidden:!e}),p.jsx(Y,{id:"viewCrowns",label:"Progress so far",onSelect:n,doubleHeightWhenFocussed:!0,hidden:!e})]}),p.jsxs("div",{className:"flex flex-row justify-between gap-2 w-24 mx-auto",children:[p.jsxs(Te,{children:[p.jsx(Y,{id:"options",label:"Options",doubleHeightWhenFocussed:!0,onSelect:H(bt,"modernisationOptions")}),p.jsx(Y,{id:"readTheManual",label:"Manual",doubleHeightWhenFocussed:!0,onSelect:H(bt,"readTheManual")})]}),p.jsxs(Te,{children:[i?null:p.jsx(SO,{}),p.jsx(Y,{id:"discord",leader:p.jsx(F,{children:sb}),label:p.jsx("a",{href:gA,target:"_blank",children:p.jsx(F,{children:"Discord"})}),doubleHeightWhenFocussed:!0,onSelect:S.useCallback(()=>{window.open(gA,"_blank")},[])}),i?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"}),p.jsx("div",{className:"h-1"})]}):null]})]}),e&&p.jsx(Te,{className:"w-24 mx-auto",children:p.jsx(CO,{})})]}),!e&&p.jsx(vO,{className:"resHandheld:mt-1"})]}),p.jsx(qO,{})]})};var Uc,AA;function of(){if(AA)return Uc;AA=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Uc=t,Uc}var Hc,yA;function EO(){if(yA)return Hc;yA=1;var t=typeof bo=="object"&&bo&&bo.Object===Object&&bo;return Hc=t,Hc}var $c,xA;function yq(){if(xA)return $c;xA=1;var t=EO(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return $c=r,$c}var Gc,bA;function TO(){if(bA)return Gc;bA=1;var t=yq(),e=function(){return t.Date.now()};return Gc=e,Gc}var Wc,wA;function RO(){if(wA)return Wc;wA=1;var t=/\s/;function e(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return Wc=e,Wc}var Yc,qA;function MO(){if(qA)return Yc;qA=1;var t=RO(),e=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(e,"")}return Yc=r,Yc}var Qc,vA;function xq(){if(vA)return Qc;vA=1;var t=yq(),e=t.Symbol;return Qc=e,Qc}var Kc,VA;function IO(){if(VA)return Kc;VA=1;var t=xq(),e=Object.prototype,r=e.hasOwnProperty,s=e.toString,n=t?t.toStringTag:void 0;function i(o){var a=r.call(o,n),l=o[n];try{o[n]=void 0;var c=!0}catch{}var u=s.call(o);return c&&(a?o[n]=l:delete o[n]),u}return Kc=i,Kc}var Xc,_A;function jO(){if(_A)return Xc;_A=1;var t=Object.prototype,e=t.toString;function r(s){return e.call(s)}return Xc=r,Xc}var Jc,SA;function BO(){if(SA)return Jc;SA=1;var t=xq(),e=IO(),r=jO(),s="[object Null]",n="[object Undefined]",i=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?n:s:i&&i in Object(a)?e(a):r(a)}return Jc=o,Jc}var Zc,kA;function OO(){if(kA)return Zc;kA=1;function t(e){return e!=null&&typeof e=="object"}return Zc=t,Zc}var eu,CA;function zO(){if(CA)return eu;CA=1;var t=BO(),e=OO(),r="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&t(n)==r}return eu=s,eu}var tu,PA;function NO(){if(PA)return tu;PA=1;var t=MO(),e=of(),r=zO(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return s;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=i.test(c);return h||o.test(c)?a(c.slice(2),h?2:8):n.test(c)?s:+c}return tu=l,tu}var ru,EA;function bq(){if(EA)return ru;EA=1;var t=of(),e=TO(),r=NO(),s="Expected a function",n=Math.max,i=Math.min;function o(a,l,c){var u,h,d,f,m,A,g=0,y=!1,w=!1,x=!0;if(typeof a!="function")throw new TypeError(s);l=r(l)||0,t(c)&&(y=!!c.leading,w="maxWait"in c,d=w?n(r(c.maxWait)||0,l):d,x="trailing"in c?!!c.trailing:x);function b(B){var N=u,U=h;return u=h=void 0,g=B,f=a.apply(U,N),f}function V(B){return g=B,m=setTimeout(k,l),y?b(B):f}function _(B){var N=B-A,U=B-g,q=l-N;return w?i(q,d-U):q}function v(B){var N=B-A,U=B-g;return A===void 0||N>=l||N<0||w&&U>=d}function k(){var B=e();if(v(B))return E(B);m=setTimeout(k,_(B))}function E(B){return m=void 0,x&&u?b(B):(u=h=void 0,f)}function T(){m!==void 0&&clearTimeout(m),g=0,u=A=h=m=void 0}function R(){return m===void 0?f:E(e())}function j(){var B=e(),N=v(B);if(u=arguments,h=this,A=B,N){if(m===void 0)return V(A);if(w)return clearTimeout(m),m=setTimeout(k,l),b(A)}return m===void 0&&(m=setTimeout(k,l)),f}return j.cancel=T,j.flush=R,j}return ru=o,ru}var DO=bq();const FO=rt(DO);var su,TA;function LO(){if(TA)return su;TA=1;var t=bq(),e=of(),r="Expected a function";function s(n,i,o){var a=!0,l=!0;if(typeof n!="function")throw new TypeError(r);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),t(n,i,{leading:a,maxWait:i,trailing:l})}return su=s,su}var UO=LO();const HO=rt(UO),$O=(t,e,r,s)=>{switch(e){case"debounce":return FO(t,r,s);case"throttle":return HO(t,r,s);default:return t}},GO=t=>{const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>((...r)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...r)}),[])},WO=t=>{const[e,r]=S.useState(t?.current||null);return t&&setTimeout(()=>{t.current!==e&&r(t.current)},0),{refProxy:S.useMemo(()=>new Proxy(n=>{n!==e&&r(n)},{get(n,i){return i==="current"?e:n[i]},set(n,i,o){return i==="current"?r(o):n[i]=o,!0}}),[e]),refElement:e,setRefElement:r}},YO=(t,e)=>e==="border-box"?{width:t.borderBoxSize[0].inlineSize,height:t.borderBoxSize[0].blockSize}:e==="content-box"?{width:t.contentBoxSize[0].inlineSize,height:t.contentBoxSize[0].blockSize}:{width:t.contentRect.width,height:t.contentRect.height};function QO({skipOnMount:t=!1,refreshMode:e,refreshRate:r=1e3,refreshOptions:s,handleWidth:n=!0,handleHeight:i=!0,targetRef:o,observerOptions:a,onResize:l}={}){const c=S.useRef(t),u=GO(l),[h,d]=S.useState({width:void 0,height:void 0}),{refProxy:f,refElement:m}=WO(o),{box:A}=a||{},g=S.useCallback(w=>{if(!n&&!i)return;if(c.current){c.current=!1;return}const x=(b,V)=>n&&b.width!==V.width||i&&b.height!==V.height;w.forEach(b=>{const V=YO(b,A);d(_=>x(_,V)?(u?.({width:V.width,height:V.height,entry:b}),V):_)})},[n,i,c,A]),y=S.useCallback($O(g,e,r,s),[g,e,r,s]);return S.useEffect(()=>{let w;return m?(w=new window.ResizeObserver(y),w.observe(m,a)):(h.width||h.height)&&(u?.({width:null,height:null,entry:null}),d({width:void 0,height:void 0})),()=>{var x,b,V;(x=w?.disconnect)===null||x===void 0||x.call(w),(V=(b=y).cancel)===null||V===void 0||V.call(b)}},[y,m]),Object.assign({ref:f},h)}const re={w:16,d:16,h:12},Ti={x:16,y:16,z:12},KO=["head","heels"],XO=[...KO,"headOverHeels"],xn=t=>t==="head"?"heels":"head",wq="@@original",JO="original",ZO={userId:wq,campaignName:JO,version:-1},Ce=(...t)=>{if(t.length===1){const[e]=t;return r=>r.type===e}return e=>t.includes(e.type)},ez=Ce("bubbles","stopAutowalk","firedDoughnut","floatingText","emitter","particle"),tz=(t,e)=>ez(t)||vs(t)&&(e!==void 0&&Vq(e)||t.config.direction.z!==0)||Cq(t)&&t.config.floorType==="none",Qi=(t,e)=>!tz(t,e),rz=t=>t.type==="movingPlatform"||t.type==="pushableBlock",qq=(t,e,r=!1)=>Rn(e)&&!(!r&&Vq(e)&&e.state.autoWalk)&&!(cz(t)&&rz(e))&&!(af(e)&&e.config.which==="cyberman"&&e.state.everActivated===!1),vq=["ball","slidingBlock","slidingDeadly"],sz=Ce(...vq),nz=["portableBlock","spring","sceneryPlayer","sceneryCrown","monster","slidingBlock"],iz=["dalek","turtle","elephantHead","homingBot","helicopterBug"],hL=t=>t.type==="slidingBlock"?t.config.style==="puck":t.type==="monster"?iz.includes(t.config.which):nz.includes(t.type),Vq=t=>t.type==="head"||t.type==="heels"||t.type==="headOverHeels";function Rn(t){return _q.includes(t.type)}const _q=[...XO,"monster","ball","charles","pushableBlock","movingPlatform","moveableDeadly","pickup","portableBlock","slidingBlock","slidingDeadly","spring","sceneryPlayer","sceneryCrown"],oz=["monster","deadlyBlock","moveableDeadly","slidingDeadly"],az=Ce(...oz),dL=t=>af(t)&&!t.state.activated?!1:az(t)||t.type==="floor"&&t.config.floorType==="deadly",lz=t=>t.config.times!==void 0,vs=Ce("portal"),fL=Ce("teleporter"),Sq=Ce("heels"),kq=Ce("head"),Qa=Ce("headOverHeels"),pL=Ce("heels","headOverHeels"),mL=Ce("head","headOverHeels"),cz=Ce("lift"),gL=Ce("button"),AL=Ce("emitter"),af=Ce("monster"),Cq=Ce("floor"),uz=Ce("pickup"),yL=t=>t.type==="button"||t.type==="switch"&&t.config.type==="in-room",xL=t=>uz(t)&&t.config.gives==="crown",bL=Ce("spring"),wL=Ce("joystick"),qL=Ce("conveyor"),hz=Ce("hushPuppy"),vL=Ce("firedDoughnut"),VL=Ce("wall","doorFrame"),_L=Ce("monster","movingPlatform"),SL=t=>af(t)&&t.config.which==="cyberman"&&t.state.everActivated===!1,Br=(t,e)=>t.characterRooms[e]?.items[e],kL=t=>Br(t,t.currentCharacterName),CL=t=>{if(kq(t))return t.state;if(Qa(t))return t.state.head},dz=t=>{if(Sq(t))return t.state;if(Qa(t))return t.state.heels},fz=(t,e)=>{const r=Br(t,t.currentCharacterName==="headOverHeels"?"headOverHeels":e);if(r!==void 0){if(e==="head"&&kq(r)||e==="heels"&&Sq(r))return r.state;if(e==="head"&&Qa(r))return r.state.head;if(e==="heels"&&Qa(r))return r.state.heels}},PL=fz,pz=t=>{const e=Br(t,"head"),r=Br(t,"heels");return e!==void 0&&r!==void 0&&e.state.action==="idle"&&r.state.action==="idle"&&e.state.standingOnItemId==="heels"},fh=(t,e)=>e?.[t],mz=t=>Or(t),Ft=t=>Ke(mz(t)),EL=t=>Ke(Kh(t)),TL=t=>({head:t.head,heels:t.heels,headOverHeels:t.headOverHeels}),rs=Symbol("roomSpatialIndexKey"),yt={x:12,y:12,z:re.h},gz={x:14,y:14,z:re.h},Vs={x:16,y:16,z:re.h},va={...yt,z:re.h*2},lf=t=>{switch(t.type){case"spring":case"portableBlock":case"moveableDeadly":case"slidingDeadly":case"firedDoughnut":return{aabb:yt};case"slidingBlock":return t.config.style==="book"?{aabb:Vs}:{aabb:yt};case"lift":return{aabb:{...yt,z:yt.z}};case"switch":return{aabb:{...yt,z:yt.z}};case"button":return{aabb:{x:15,y:15,z:2}};case"pickup":return t.config.gives==="scroll"?{aabb:{x:16,y:4,z:13}}:{aabb:yt};case"charles":return{aabb:va};case"ball":return{aabb:{x:12,y:12,z:12}};case"pushableBlock":case"movingPlatform":return{aabb:Vs};case"block":switch(t.config.style){case"artificial":case"organic":case"book":return{aabb:Vs};case"tower":return{aabb:{x:11,y:11,z:re.h}};default:throw new Error("unknown block style")}case"monster":switch(t.config.which){case"skiHead":return{aabb:{...yt,z:21}};case"bubbleRobot":case"cyberman":case"elephant":case"emperorsGuardian":case"monkey":case"computerBot":return{aabb:va};case"helicopterBug":case"dalek":case"emperor":case"homingBot":case"elephantHead":return{aabb:yt};case"turtle":return{aabb:yt};default:throw t.config,new Error("unknown monster type")}case"deadlyBlock":case"spikes":return{aabb:Vs};case"bubbles":return{aabb:yt};case"conveyor":case"hushPuppy":case"teleporter":return{aabb:Vs};case"barrier":return{aabb:t.config.axis==="y"?{x:3,y:15,z:re.h}:{x:15,y:3,z:re.h}};case"sceneryPlayer":return t.config.which==="headOverHeels"?{aabb:va}:{aabb:yt};case"emitter":return{aabb:ae};default:return{aabb:gz}}},ft={aabb:yt,castsShadowWhileStoodOn:!1},wl=t=>({x:t.direction==="away"?t.tiles.length:t.direction==="towards"?t.times?.x:1,y:t.direction==="left"?t.tiles.length:t.direction==="right"?t.times?.y:1}),RL=t=>t.type==="wall"?wl(t.config):lz(t)?t.config.times:void 0,Ki=(t=co)=>({x:t.x??1,y:t.y??1,z:t.z??1}),ML=t=>({x:t.x??1,y:t.y??1}),RA=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?Ki(wl(t.config)):e(t)?Ki(t.config.times):co},Az=t=>{const e=r=>r.config.times!==void 0;return t.type==="wall"?Ki(wl(t.config)):e(t)?Ki(t.config.times):co},IL=t=>{const e={};let r=!1;return t.x!==1&&(e.x=t.x,r=!0),t.y!==1&&(e.y=t.y,r=!0),t.z!==1&&(e.z=t.z,r=!0),r?e:void 0},Xi=(t,e={})=>{const r=Ki(e),s=Kr(Ti,t);return T0(S0(r,Ti),s)},jL=1e3,Rs=-2,Ye=Number.MIN_SAFE_INTEGER,We=ho/1e3,BL={head:15e-5,heels:15e-5},OL=1e3/110,zL=240,yz=2e-4,xz={head:re.h*2/1e3,others:re.h*6/1e3},NL=yz*.35,DL=xz.others*.5,FL=.8,LL=.001,bz={head:We,heels:2*We,charles:We,dalek:Math.SQRT2*We,bubbleRobot:(Math.SQRT2+1)/2*We,cyberman:1*We,skiHead:We,helicopterBug:We,homingBot:2*We,monkey:We,elephant:We,elephantHead:0,emperor:We,emperorsGuardian:Math.SQRT2*We,computerBot:We,turtle:We,ball:2*We,firedDoughnut:2*We,movingPlatform:We,floatingText:We},wz=(t=1)=>t*ho/1e3,UL=wz(),HL=2,MA=1.1,$L={head:re.h*2.6+MA,heels:re.h+MA},qz=10,GL=6e4,vz=8,WL=750,YL=1500,QL=200,KL=.15,XL=150,Vz=8,_z=Ot.h-Ot.w/2,Pq=_z+2,cf=9999,JL=({x:t=0,y:e=0})=>e-t,je=({x:t=0,y:e=0,z:r=0})=>({x:e-t,y:-(t+e)/2-r}),Ne=({x:t=0,y:e=0,z:r=0})=>({x:t*re.w,y:e*re.d,z:r*re.h}),ZL=t=>je(Ne(t)),ph=t=>{const e=Ne(t.position),{aabb:r}=lf(t);if(r===void 0)throw new Error(`item type= ${t.type} config=${JSON.stringify(t.config)} has no bounding box`);return t.type==="wall"?e:Z(e,{x:re.w-r.x>>1,y:re.d-r.y>>1})},ot=()=>({expires:null,stoodOnBy:{},disappearing:null,switchedAtRoomTime:Ye,stoodOnUntilRoomTime:Ye,actedOnAt:{roomTime:Ye,by:Ae}}),Ji=()=>({standingOnItemId:null,vels:{gravity:ae,movingFloor:ae},latentMovement:[],collidedWith:{roomTime:Ye,by:Ae},controlledWithJoystickAtRoomTime:Ye}),Sz=t=>{const e=_q.includes(t.type);return{...ot(),position:ph(t),...e?{standingOnItemId:null,vels:{gravity:ae,movingFloor:ae,...vq.includes(t.type)?{sliding:ae}:{},...t.type==="monster"||t.type==="movingPlatform"?{walking:ae}:{}},latentMovement:[],collidedWith:{roomTime:Ye,by:Ae}}:{},...t.type==="joystick"||t.type==="emitter"||t.type==="lift"||t.type==="conveyor"||t.type==="teleporter"?{...structuredClone(t.config)}:{},...t.type==="monster"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",timeOfLastDirectionChange:Number.NEGATIVE_INFINITY,...t.config.which==="skiHead"||t.config.which==="turtle"||t.config.which==="elephantHead"||t.config.which==="cyberman"?{facing:ye[t.config.startDirection]}:{facing:ye.towards}}:{},...t.type==="pickup"?{disappearing:{on:"touch",byType:t.config.gives==="bag"||t.config.gives==="jumps"?["heels","headOverHeels"]:t.config.gives==="doughnuts"||t.config.gives==="hooter"||t.config.gives==="fast"?["head","headOverHeels"]:["head","heels","headOverHeels"]}}:{},...t.type==="movingPlatform"?{activated:t.config.activated==="on",everActivated:t.config.activated==="on",facing:ye[t.config.startDirection]}:{},...t.type==="switch"?{setting:t.config.initialSetting,touchedOnProgression:-1}:{},...t.type==="button"?{pressed:!1}:{},...t.type==="block"?{disappearing:t.config.disappearing??null}:{},...t.type==="conveyor"?{disappearing:t.config.disappearing??null}:{},...t.type==="barrier"?{disappearing:t.config.disappearing??null}:{},...t.type==="lift"?{direction:"up",vels:{lift:ae}}:{},...t.type==="charles"?{facing:ye.towards}:{},...t.type==="emitter"?{lastEmittedAtRoomTime:Ye,quantityEmitted:0}:{},...t.type==="firedDoughnut"?{disappearing:{on:"touch"},vels:{fired:t.config.direction?vt(ye[t.config.direction],bz.firedDoughnut):ae}}:{}}},kz=({config:{direction:t},position:e})=>t==="right"&&e.x===0||t==="towards"&&e.y===0,nu=re.h*2,Cz=4,oa=re.h*Cz,Pz=2,Ez=.5,IA=2;function*Tz(t,e){const{config:{direction:r},position:s}=t,n=Ky(r),i=Wh(n),o=kz(t),a={...ae,[i]:o?-.5:0},l=1,c={[i]:o?-l:0},u=l*re.w,h={...ae,[i]:u},d=9,f=8,m=8;{const A={[n]:f,[i]:m,z:oa};yield{...t,...ft,type:"doorFrame",id:`${e}/frameFar`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"far"},state:{...ot(),position:Ne(Z(s,{[n]:1.5},a,c)),stoodOnBy:Ae},aabb:Z(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:d,[i]:m,z:oa};yield{...t,...ft,type:"doorFrame",id:`${e}/frameNear`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"near"},state:{...ot(),position:Ne(Z(s,a,c)),stoodOnBy:Ae},aabb:Z(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}{const A={[n]:2*re.w-d-f,[i]:m,z:oa-nu};yield{...t,...ft,type:"doorFrame",id:`${e}/frameTop`,jsonItemId:e,config:{...t.config,inHiddenWall:o,part:"top"},state:{...ot(),position:Z(Ne(Z(s,a,c)),{[n]:d,z:nu}),stoodOnBy:Ae},aabb:Z(A,h),renderAabb:A,renderAabbOffset:o?h:void 0}}yield{...t,...ft,type:"blocker",id:`${e}/blockerAbove`,jsonItemId:e,config:{},renders:!1,state:{...ot(),position:Z(Ne(Z(s,a,c)),{z:oa}),stoodOnBy:Ae},aabb:Z(Ne({[n]:2,[i]:l}),{[i]:m,z:cf}),renderAabb:ae,fixedZIndex:Rs},yield{...t,...ft,type:"portal",id:`${e}/portal`,jsonItemId:e,config:{...Oi(t.config,"toRoom","toDoor"),inHidden:o,relativePoint:Ne({...ae,[i]:o?l+.25:-.25}),direction:ye[r]},fixedZIndex:Rs,state:{...ot(),position:Z(Ne(Z(s,{[i]:o?-.5-l:.5})),{[n]:d}),stoodOnBy:Ae},aabb:{[n]:Pz*re.w-d-f,[i]:u,z:nu}},s.z!==0&&(yield{...t,...ft,type:"doorLegs",id:`${e}/legs`,jsonItemId:e,config:{...t.config,inHiddenWall:o,style:"none",side:"away",height:s.z},renders:!0,shadowCastTexture:o?{textureId:"shadow.door.floatingThreshold.double.y",flipX:n==="x"}:void 0,castsShadowWhileStoodOn:o,state:{...ot(),position:{...Ne(Z(s,a,c)),z:0}},aabb:Z(Ne({[n]:2,[i]:.5,z:s.z}),h),renderAabb:o?Z(Ne({[n]:2,[i]:.5,z:.5})):void 0,renderAabbOffset:o?Z({[n]:0,[i]:0,z:(s.z-.5)*re.h},{[i]:h[i]}):void 0,shadowOffset:{z:s.z*re.h,[i]:o?h[i]:void 0}}),yield{...ft,type:"stopAutowalk",id:`${e}/stopAutowalk`,jsonItemId:e,aabb:Ne({[n]:2,[i]:IA,z:2}),config:{},fixedZIndex:Rs,state:{...ot(),position:Ne(Kr(s,vt(ye[r],Ez),o?ae:{[i]:IA})),stoodOnBy:Ae}}}const jA=3,BA=10,OA=.52,aa=.5,Rz=(t,e,r)=>{const{config:{times:s},position:n}=e,i=Z(n,{z:-jA}),o={...s,z:jA};let a=i,l=o;const c=Ke(Or(r.items)).filter(d=>d.type==="door");if(n.z===0){const d={};for(const f of c){const{position:m,config:{direction:A}}=f;switch(A){case"towards":!d.towards&&m.y===i.y&&m.x>=i.x&&m.x<=i.x+s.x-2&&(l=Z(l,{y:aa}),a=Z(a,{y:-aa}),d.towards=!0);break;case"away":!d.away&&m.y===i.y+s.y&&m.x>=i.x&&m.x<=i.x+s.x-2&&(l=Z(l,{y:OA}),d.away=!0);break;case"right":!d.right&&m.x===i.x&&m.y>=i.y&&m.y<=i.y+s.y-2&&(l=Z(l,{x:aa}),a=Z(a,{x:-aa}),d.right=!0);break;case"left":!d.left&&m.x===i.x+s.x&&m.y>=i.y&&m.y<=i.y+s.y-2&&(l=Z(l,{x:OA}),d.left=!0);break}}}const u=Ne(a),h=Xi(Vs,l);return{...ft,type:"floor",id:t,jsonItemId:t,config:{...e.config,naturalFootprint:{aabb:Xi(Vs,o),position:Ne(i)}},aabb:h,renderAabb:{...h,z:BA},renderAabbOffset:{...ae,z:h.z-BA},shadowCastTexture:"shadow.fullBlock",state:{...ot(),position:u}}},Ka={config:Ae,shadowCastTexture:"shadow.smallRound",castsShadowWhileStoodOn:!0,aabb:yt},Zi=()=>{const t=Yx(xe.getState());return{action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:ye.towards,walkStartFacing:ye.towards,walkDistance:0,vels:{walking:ae,gravity:ae,movingFloor:ae},switchedToAt:Ye,lastDiedAt:Ye,gameTime:0,jumpStartTime:Ye,lives:t?"infinite":vz,jumpStartZ:0}},Mz=(t,e)=>{const r=Qx(xe.getState());return t.config.which==="head"?{id:e,jsonItemId:e,type:"head",...ft,...Ka,state:{...ot(),...Ji(),...Zi(),hasHooter:!1,gameWalkDistance:0,fastStepsStartedAtDistance:Ye,shieldCollectedAt:Ye,doughnuts:r?"infinite":0,position:ph(t),stoodOnUntilRoomTime:Ye}}:{id:e,jsonItemId:e,type:"heels",...ft,...Ka,state:{...ot(),...Ji(),...Zi(),carrying:null,hasBag:!1,bigJumps:0,isBigJump:!1,shieldCollectedAt:Ye,position:ph(t),stoodOnUntilRoomTime:Ye}}},Iz=t=>t==="towards"||t==="right",uf=1,jz={x:re.w,y:re.d*uf,z:cf},Bz={x:re.w,y:0,z:Pq},Oz={x:re.w*uf,y:re.d,z:cf},zz={x:0,y:re.d,z:Pq},Nz=(t,e)=>{const{config:{direction:r},position:s}=e,n=wl(e.config),i=Ky(r),o=Wh(i),a=Iz(r),l={...ae,[o]:a?-uf:0};return{type:"wall",id:t,jsonItemId:t,config:e.config,aabb:Xi(i==="y"?Oz:jz,n),renderAabb:a?ae:Xi(i==="y"?zz:Bz,n),fixedZIndex:a?Rs:void 0,state:{...ot(),position:Ne(Z(s,l)),stoodOnBy:Ae},shadowCastTexture:i==="y"?"shadow.wall.y":{textureId:"shadow.wall.y",flipX:!0},castsShadowWhileStoodOn:a}};function*hf(t,e,r,s=Ae,n={},i=""){if(!s[t]&&!(e.type==="pickup"&&e.config.gives==="scroll"&&e.config.source==="manual"&&n[e.config.page]))switch(!0){case e.type==="door":return yield*Tz(e,t);case e.type==="player":{yield Mz(e,t);return}case e.type==="wall":{yield Nz(t,e);return}case e.type==="floor":{yield Rz(t,e,r);return}case(e.type==="block"&&e.config.disappearing!==void 0&&zn(RA(e))>=2):{const o=RA(e);for(let a=0;a<o.x;a++)for(let l=0;l<o.y;l++)for(let c=0;c<o.z;c++){const u=Bn(e,h=>{h.position={x:e.position.x+a,y:e.position.y+l,z:e.position.z+c},h.config.times=co});yield*hf(t,u,r,s,n,`${i}_${a}_${l}_${c}`)}break}case(e.type==="sceneryCrown"&&!xe.getState().gameMenus.gameInPlay.planetsLiberated[e.config.planet]):return;default:{const o=lf(e),a=e.config.times!==void 0?{aabb:Xi(o.aabb,e.config.times),renderAabb:void 0}:o;let l;try{l=Sz(e)}catch(c){throw new Error(`loadItemFromJson: error creating initial state for jsonItem ${JSON.stringify(e,null,2)}`,{cause:c})}yield{...e,...ft,...a,id:`${t}${i}`,jsonItemId:t,fixedZIndex:e.type==="emitter"?Rs:void 0,shadowCastTexture:Dz(e),castsShadowWhileStoodOn:e.type==="monster"&&(e.config.which==="emperor"||e.config.which==="emperorsGuardian"||e.config.which==="turtle"||e.config.which==="helicopterBug")||e.type==="pickup"||e.type==="ball"||e.type==="lift"||e.type==="pushableBlock"||e.type==="sceneryPlayer"||e.type==="slidingDeadly"||e.type==="spring",config:e.config,state:l}}}}const Dz=t=>{switch(t.type){case"lift":case"switch":return"shadow.smallBlock";case"conveyor":return{textureId:"shadow.fullBlock",flipX:Qy(t.config.direction)==="x"};case"barrier":return{textureId:"shadow.barrier.y",flipX:t.config.axis==="x"};case"spring":case"firedDoughnut":case"slidingDeadly":return"shadow.smallRound";case"block":return t.config.style==="tower"?"shadow.smallRound":"shadow.fullBlock";case"pushableBlock":case"movingPlatform":case"hushPuppy":case"deadlyBlock":case"teleporter":case"spikes":return"shadow.fullBlock";case"portableBlock":return t.config.style==="drum"?"shadow.smallRound":"shadow.smallBlock";case"pickup":return t.config.gives==="scroll"?"shadow.scroll":"shadow.smallRound";case"ball":case"charles":case"monster":return"shadow.smallRound";case"slidingBlock":return t.config.style==="book"?"shadow.fullBlock":"shadow.smallRound"}};let Fz=0;const Lz=({gameState:t,room:e,itemType:r,config:s,position:n})=>{const i={type:r,config:s,position:ae},o=`${r}/${Fz++}`,a=ix(hf(o,i,e.roomJson,t.pickupsCollected[e.id]??Ae));if(a===void 0)throw console.error("failed to generate any items for json",o,i),new Error("failed to generate any items");return eo({room:e,item:a,atPosition:n}),a},eo=({room:t,item:e,atPosition:r})=>(t.items[e.id]=e,r!==void 0&&(e.state.position=r),t[rs].addItem(e),e),Uz=(t,e)=>Ke(Xh(t)).map(r=>{const s=e.items[r];if(s===void 0)throw new Error(`item ${r} in stoodOnBy is not in the room`);return s});function Eq(t,e){return t===null?null:e.items[t]}const mh=(t,e)=>{if(t.state.standingOnItemId!==null){const r=Eq(t.state.standingOnItemId,e);delete r.state.stoodOnBy[t.id],t.state.standingOnItemId=null,r.state.stoodOnUntilRoomTime=e.roomTime}},Mn=({room:t,item:e})=>{const r=Tq({room:t,item:e});t[rs].removeItem(r)},Tq=({room:t,item:e})=>{const r=typeof e=="string"?t.items[e]:e;Rn(r)&&mh(r,t);for(const s of Uz(r.state.stoodOnBy,t))mh(s,t);return typeof e=="string"?delete t.items[e]:delete t.items[r.id],r},df=({above:t,below:e})=>{const r=e.state.stoodOnBy;if(!Object.isExtensible(r))throw new Error(`${t.id} can't stand on ${e.id} - its standingOn is not extensible`);t.state.standingOnItemId=e.id,r[t.id]=!0},Hz=t=>{const e={id:"head",type:"head",...ft,...Ka,state:{...ot(),...Ji(),...Zi(),...t.state.head,facing:t.state.facing,position:Z(t.state.position,{z:re.h}),switchedToAt:Ye,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime}},r={id:"heels",type:"heels",...ft,...Ka,state:{...ot(),...Ji(),...Zi(),...t.state.heels,facing:t.state.facing,position:Z(t.state.position),switchedToAt:Ye,actedOnAt:t.state.actedOnAt,collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:t.state.stoodOnUntilRoomTime,isBigJump:!1}};return{head:e,heels:r}},$z=({head:t,heels:e})=>({id:"headOverHeels",type:"headOverHeels",...ft,shadowCastTexture:e.shadowCastTexture,config:Ae,aabb:va,state:{...ot(),...Ji(),...Zi(),position:e.state.position,action:"idle",jumped:!1,teleporting:null,autoWalk:!1,facing:e.state.facing,actedOnAt:e.state.actedOnAt.roomTime>t.state.actedOnAt.roomTime?e.state.actedOnAt:t.state.actedOnAt,collidedWith:e.state.collidedWith.roomTime>t.state.collidedWith.roomTime?e.state.collidedWith:t.state.collidedWith,stoodOnUntilRoomTime:e.state.stoodOnUntilRoomTime,head:{...Oi(t.state,"hasHooter","doughnuts","fastStepsStartedAtDistance","gameWalkDistance","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ye},heels:{...Oi(e.state,"hasBag","bigJumps","carrying","lives","gameTime","shieldCollectedAt","lastDiedAt"),switchedToAt:Ye}}}),Gz=t=>{const e=t.characterRooms.head,r=Br(t,"head"),s=Br(t,"heels"),n=$z({head:r,heels:s});Mn({room:e,item:"head"}),Mn({room:e,item:"heels"}),eo({room:e,item:n}),t.previousPlayable=t.currentCharacterName,t.currentCharacterName="headOverHeels",t.characterRooms={head:void 0,heels:void 0,headOverHeels:e}},Wz=(t,e)=>{const r=t.characterRooms.headOverHeels,s=Br(t,"headOverHeels"),n=e??xn(t.previousPlayable),{head:i,heels:o}=Hz(s);Mn({room:r,item:"headOverHeels"}),eo({room:r,item:i}),eo({room:r,item:o}),df({above:i,below:o}),t.currentCharacterName=n,t.previousPlayable=void 0,t.characterRooms={head:r,heels:r,headOverHeels:void 0}},Yz=t=>{const e=Br(t,t.currentCharacterName);e!==void 0&&(e.type==="headOverHeels"?(e.state.head.switchedToAt=e.state.head.gameTime,e.state.heels.switchedToAt=e.state.heels.gameTime):e.state.switchedToAt=e?.state.gameTime)},Va=(t,e)=>{pz(t)&&(!e||e===t.currentCharacterName)?Gz(t):t.currentCharacterName==="headOverHeels"?Wz(t,e):(!e||e!==t.currentCharacterName)&&Br(t,xn(t.currentCharacterName))!==void 0&&(t.currentCharacterName=xn(t.currentCharacterName)),Yz(t)},zA=4,NA=Aa.h,Rq=()=>{const t=po(),e=S.useRef(null),r=S.useCallback(s=>{if(e.current===null)return;const{scrollTop:n,scrollLeft:i}=e.current,o=ye[s],a=n+t*zA*-o.y*NA,l=i+t*zA*o.x*NA;e.current.scrollTo({left:l,top:a,behavior:"instant"})},[t]);return dt({handler:S.useCallback(()=>{r("towards")},[r]),action:"towards"}),dt({handler:S.useCallback(()=>{r("away")},[r]),action:"away"}),dt({handler:S.useCallback(()=>{r("left")},[r]),action:"left"}),dt({handler:S.useCallback(()=>{r("right")},[r]),action:"right"}),e},Qz=(t,e,r)=>{if(e==="*")return!0;const s=r.meta.subRooms[e];return t.x>=s.physicalPosition.from.x&&t.y>=s.physicalPosition.from.y&&t.x<=s.physicalPosition.to.x&&t.y<=s.physicalPosition.to.y},Kz=({position:t},e,r)=>Qz(t,e,r),Xz=(t,e,r)=>{if(e==="*")return 0;const s=r.meta.subRooms[e],{from:n,to:i}=s.physicalPosition;if(t.x>=n.x&&t.y>=n.y&&t.x<=i.x&&t.y<=i.y)return 0;let o=0,a=0;return t.x<n.x?o=n.x-t.x:t.x>i.x&&(o=t.x-i.x),t.y<n.y?a=n.y-t.y:t.y>i.y&&(a=t.y-i.y),o+a},ff=(t,e,r)=>{const s=r.meta?.subRooms;if(s===void 0)return"*";let n,i=1/0;const o=e==="fine"?{x:t.x/re.w,y:t.y/re.d}:t;for(const a of Xh(s)){const l=Xz(o,a,r);if(l===0)return a;l<i&&(i=l,n=a)}if(n===void 0)throw new Error(`item not found in any subroom of ${r.id}
      item at  ${JSON.stringify(o)}
      subrooms ${JSON.stringify(r.meta?.subRooms,null,2)}`);return n},J=48,Er=36,to=.55,St=J*((1-to)/2),_t=J-St,ro=8,Cs=128,_s=({mapTitle:t,y:e=0,className:r,textOnly:s=!1})=>{const n=po();return p.jsxs("g",{className:r,children:[s||p.jsx("rect",{y:e,width:1e4,height:1e4}),p.jsx("foreignObject",{width:n*(t.length+3)*8,height:n*16*3,x:ro,y:e+16,children:p.jsx(F,{className:`left-2 relative sprites-double-height ${qe}`,children:t})})]})},Ur={blacktooth:{bgClassName:"fill-redShadow zx:fill-zxGreenDimmed text-lightGrey zx:text-zxWhite",containerClassName:"bg-moss zx:bg-zxGreenDimmed scrollbar-track-moss zx:scrollbar-track-zxGreenDimmed scrollbar-thumb-shadow zx:scrollbar-thumb-zxWhite"},bookworld:{bgClassName:"fill-redShadow zx:fill-zxBlue text-highlightBeige zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxWhite"},jail:{bgClassName:"fill-shadow zx:fill-zxBlue text-black zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-lightGrey zx:scrollbar-thumb-zxWhite"},egyptus:{bgClassName:"fill-midRed zx:fill-zxRedDimmed text-highlightBeige zx:text-zxYellow",containerClassName:"bg-midRed zx:bg-zxRedDimmed scrollbar-track-midRed zx:scrollbar-track-zxBlue zx:scrollbar-track-zxRedDimmed scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxYellow"},moonbase:{bgClassName:"fill-pastelBlue zx:fill-zxBlue text-metallicBlue zx:text-zxWhite",containerClassName:"bg-pastelBlue zx:bg-zxBlue scrollbar-track-pastelBlue zx:scrollbar-track-zxBlue scrollbar-thumb-metallicBlue zx:scrollbar-thumb-zxWhite"},market:{bgClassName:"fill-metallicBlueHalfbrite zx:fill-zxCyan text-highlightBeige zx:text-zxBlack",containerClassName:"bg-metallicBlueHalfbrite zx:bg-zxCyan scrollbar-track-metallicBlueHalfbrite zx:scrollbar-track-zxBlue scrollbar-thumb-highlightBeige zx:scrollbar-thumb-zxBlack"},penitentiary:{bgClassName:"fill-shadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-shadow zx:bg-zxBlue scrollbar-track-shadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},safari:{bgClassName:"fill-redShadow zx:fill-zxBlue text-moss zx:text-zxWhite",containerClassName:"bg-redShadow zx:bg-zxBlue scrollbar-track-redShadow zx:scrollbar-track-zxBlue scrollbar-thumb-moss zx:scrollbar-thumb-zxWhite"},freedom:{bgClassName:"fill-moss zx:fill-zxGreen text-metallicBlue zx:text-zxBlack",containerClassName:"bg-moss zx:bg-zxGreen scrollbar-track-moss zx:scrollbar-track-zxGreen scrollbar-thumb-moss zx:scrollbar-thumb-zxBlack"}},Jz=t=>{switch(t.hue){case"cyan":return"[--roomHintColor:theme(colors.pastelBlue)] [--roomHintColorDarker:theme(colors.pastelBlueHalfbrite)] zx:[--roomHintColor:theme(colors.zxCyan)] zx:[--roomHintColorDarker:theme(colors.zxCyanDimmed)]";case"green":return"[--roomHintColor:theme(colors.moss)] [--roomHintColorDarker:theme(colors.mossHalfbrite)] zx:[--roomHintColor:theme(colors.zxGreen)] zx:[--roomHintColorDarker:theme(colors.zxGreenDimmed)]";case"magenta":return"[--roomHintColor:theme(colors.pink)] [--roomHintColorDarker:theme(colors.pinkHalfbrite)] zx:[--roomHintColor:theme(colors.zxMagenta)] zx:[--roomHintColorDarker:theme(colors.zxMagentaDimmed)]";case"white":return"[--roomHintColor:theme(colors.lightGrey)] [--roomHintColorDarker:theme(colors.lightGreyHalfbrite)] zx:[--roomHintColor:theme(colors.zxWhiteDimmed)] zx:[--roomHintColorDarker:theme(colors.zxBlack)]";case"yellow":return"[--roomHintColor:theme(colors.lightBeige)] [--roomHintColorDarker:theme(colors.highlightBeigeHalfbrite)] zx:[--roomHintColor:theme(colors.zxYellow)] zx:[--roomHintColorDarker:theme(colors.zxYellowDimmed)]";default:throw t.hue,new Error("unknown hue")}},Mq=t=>(t&&Ur[t])??{bgClassName:"fill-shadow",containerClassName:""},Kt=t=>({x:(t.x??0)*J,y:(t.y??0)*J,z:(t.z??0)*Er}),In=t=>Math.round(t*10)/10,pf=t=>{const e=je(t);return`translate(${In(e.x)},${In(e.y)})`},X=t=>{const e=je(t);return Bt(e)},Bt=t=>`${In(t.x)},${In(t.y)}`,Zz=({originalCampaignPositions:t,mapBounds:e,containerWidth:r})=>{const s=po(),n=e.r-e.l+2*ro,i={x:-e.l+ro+(r-n)/2,y:-e.t+Cs},o=(x,b=ae)=>Wr(i,je(Kt(Z(t[x].gridPosition,b)))),a=o("blacktooth44market/*",{x:1,z:1.5}),l=o("blacktooth44market/*",{x:1}),c=o("blacktooth45market/*"),u=o("blacktooth48market/*",{y:1}),h=o("blacktooth53market/*",{x:0,y:0,z:0}),d=o("blacktooth53market/*",{x:0,y:1,z:0}),f=o("blacktooth53market/*",{x:1,y:1,z:0}),m=o("blacktooth52market/*",{x:1,y:.5,z:0}),A=s*8*2,g="Market",y=(g.length+3)*s*8,w=s*8*2+32;return p.jsxs(p.Fragment,{children:[p.jsx("path",{className:`${Ur.market.bgClassName} stroke-metallicBlueHalfbrite zx:stroke-zxCyan`,strokeWidth:12,d:`
M ${Bt({x:A,y:m.y+w})}
L ${Bt({x:y,y:m.y+w})}
L ${Bt({x:y,y:a.y})}
L ${Bt(a)}
L ${Bt(l)}
L ${Bt(c)}
L ${Bt(u)}
L ${Bt(h)}
L ${Bt(d)}
L ${Bt(f)}
L ${Bt(m)}
L ${Bt({...m,x:A})}
z`}),p.jsx(_s,{y:m.y,mapTitle:g,className:Ur.market.bgClassName,textOnly:!0})]})},eN=({gridPositions:t,mapBounds:e,containerWidth:r})=>{const s=t,n=je(Kt({x:1,y:1,z:0})).y,i=(o,a)=>{if(s[o]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${o}" to use to calculate yBetweenRooms`);if(s[a]===void 0)throw new Error(`OriginalCampaignMainMapBackground: this campaign does not have any room called "${a}" to use to calculate yBetweenRooms`);const l=je(Kt(s[o].gridPosition)).y,c=je(Kt(s[a].gridPosition)).y+n;return(l+c)/2};return p.jsxs(p.Fragment,{children:[p.jsx(_s,{y:0,mapTitle:"Freedom",className:Ur.freedom.bgClassName}),p.jsx(_s,{y:i("finalroom/*","blacktooth83tofreedom/*")-e.t+Cs,mapTitle:"Castle Blacktooth",className:Ur.blacktooth.bgClassName}),p.jsx(_s,{y:i("blacktooth87crown/*","moonbase35/*")-e.t+Cs,mapTitle:"moonbase",className:Ur.moonbase.bgClassName}),p.jsx(_s,{y:i("moonbase4/*","blacktooth62fish/right")-e.t+Cs,mapTitle:"Blacktooth escape",className:Ur.blacktooth.bgClassName}),p.jsx(Zz,{mapBounds:e,originalCampaignPositions:s,containerWidth:r}),p.jsx(_s,{y:i("blacktooth24/*","blacktooth1head/*")-e.t+Cs,mapTitle:"Jail",className:Ur.jail.bgClassName})]})},tN={blacktooth:"blacktooth",bookworld:"bookworld",jail:"blacktooth",egyptus:"egyptus",moonbase:"moonbase",market:"market",penitentiary:"penitentiary",safari:"safari"},rN=t=>{const{campaign:e,curRoomId:r}=t,s=e.locator.userId===wq&&!["penitentiary","bookworld","egyptus","safari"].includes(e.rooms[r].planet),n=Mq(t.curRoomScenery);return s?p.jsx(eN,{...t}):p.jsx(_s,{mapTitle:tN[e.rooms[r].planet],className:n.bgClassName})},DA=t=>P0(vt(t.aabb,.5),t.state.position),sN={x:1,y:1,z:1},FA=(t,e,r)=>e===r?t===e?.5:t>e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:(t-e)/(r-e),eU=t=>t,nN=t=>Or(t.items),iN=t=>Kh(t),oN=t=>Ke(nN(t)),tU=(t,...e)=>{const r=Ke(iN(t));return e.length===0?r:r.filter(([,s])=>e.includes(s.type))},aN={floors:{edgeLeftX:Number.POSITIVE_INFINITY,edgeRightX:Number.NEGATIVE_INFINITY,topEdgeY:Number.POSITIVE_INFINITY,bottomEdgeY:Number.NEGATIVE_INFINITY},allItems:{topEdgeY:Number.POSITIVE_INFINITY}},rU=t=>Ft(t.items).reduce((e,r)=>{if(r.type==="floor"){const{config:{naturalFootprint:s},state:{position:n},renderAabb:i,renderAabbOffset:o,aabb:a}=r,l=je(Z(s.position,{x:s.aabb.x,z:s.aabb.z})).x,c=je(Z(s.position,{y:s.aabb.y,z:s.aabb.z})).x,u=je(Z(s.position,s.aabb)).y,h=je(Z(n,o??ae,{z:(i??a).z})).y;return{allItems:e.allItems,floors:{edgeLeftX:Math.min(e.floors.edgeLeftX,l),edgeRightX:Math.max(e.floors.edgeRightX,c),topEdgeY:Math.min(e.floors.topEdgeY,u),bottomEdgeY:Math.max(e.floors.bottomEdgeY,h)}}}else{const s=je(Z(r.state.position,r.renderAabb??r.aabb??ae,r.renderAabbOffset??ae)).y;return{allItems:{topEdgeY:Math.min(e.allItems.topEdgeY,s)},floors:e.floors}}},aN),lN={from:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},to:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}},Iq=t=>{const e=oN(t).filter(r=>r.type==="floor").reduce((r,s)=>{const{position:n,config:{times:i}}=s;return{from:{x:Math.min(r.from.x,n.x),y:Math.min(r.from.y,n.y),z:Math.min(r.from.z,n.z)},to:{x:Math.max(r.to.x,n.x+i.x),y:Math.max(r.to.y,n.y+i.y),z:Math.max(r.to.z,n.z)}}},lN);if(isFinite(e.from.x))return e},jq=({svg:t=!1,smooth:e=!1})=>{const r=S.useRef(null);return S.useLayoutEffect(()=>{r.current?.scrollIntoView({behavior:e?"smooth":"instant",block:"center"})}),t?p.jsx("g",{ref:r}):p.jsx("div",{ref:r})},_a=({className:t,scrollTo:e=!1,onClick:r,yAdjust:s=0})=>p.jsxs("foreignObject",{x:-50,y:-100+s,width:100,height:100,className:t,style:{pointerEvents:"none"},children:[p.jsx("div",{className:`sprite zx:sprite-revert-to-two-tone ml-[calc(50px-var(--scale)*var(--w)/2)] mt-[calc(100px-var(--scale)*var(--h))] ${t}`,onClick:r,style:r?{pointerEvents:"all"}:{}}),e&&p.jsx(jq,{})]}),bi=({characterName:t,facing:e,isCurrent:r=!1,onlyPlayableInRoom:s=!1,yAdjust:n=0,onClick:i})=>p.jsx(_a,{className:`${s?"[--scale:2.5]":"[--scale:1.5]"}
                ${Tn({character:t,action:r?"walking":"idle",facingXy8:Qh(e)??"towards"})}`,scrollTo:r,yAdjust:n,onClick:o=>{i?.(t),o.preventDefault(),o.stopPropagation()}}),cN=({item:t})=>{const r=t.type==="hushPuppy"||t.type==="teleporter"?"[--scale:1.25]":"[--scale:1.5]";if(t.type==="lift")return p.jsxs(p.Fragment,{children:[p.jsx(_a,{className:`${r} texture-lift_static`}),p.jsx(_a,{className:`${r} texture-lift_2`})]});const s=t.type==="teleporter"?"texture-teleporter":t.type==="hushPuppy"?"texture-hushPuppy":t.config.gives==="extra-life"||t.config.gives==="fast"||t.config.gives==="jumps"||t.config.gives==="shield"?"texture-whiteRabbit":t.config.gives==="doughnuts"?"texture-doughnuts":t.config.gives==="hooter"?"texture-hooter":t.config.gives==="bag"?"texture-bag":t.config.gives==="reincarnation"?"texture-animated-fish":t.config.gives==="crown"?t.config.planet==="blacktooth"?"texture-crown_blacktooth":t.config.planet==="egyptus"?"texture-crown_egyptus":t.config.planet==="penitentiary"?"texture-crown_penitentiary":t.config.planet==="safari"?"texture-crown_safari":t.config.planet==="bookworld"?"texture-crown_bookworld":"texture-crown_dark":"texture-block_organic";return p.jsx(_a,{className:`${r} ${s}`})},uN=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}],hN=({x:t,y:e},{x:r,y:s})=>(t-r)**2+(e-s)**2,dN=(t,e)=>{const r=t%3,s=Math.floor(t/3),n=e%3,i=Math.floor(e/3);return Math.abs(r-n)<=1&&Math.abs(s-i)<=1&&t!==e},LA=t=>t.some((e,r)=>t.slice(r+1).some(s=>dN(e,s))),Ri=(t,e)=>{if(e===0)return[[]];if(t.length<e)return[];const[r,...s]=t;return[...Ri(s,e),...Ri(s,e-1).map(n=>[r,...n])]},Bq=t=>t.length<=1?[t]:t.flatMap((e,r)=>Bq([...t.slice(0,r),...t.slice(r+1)]).map(s=>[e,...s])),UA={1:Ri([...Array(9).keys()],1),2:Ri([...Array(9).keys()],2).filter(t=>!LA(t)),3:Ri([...Array(9).keys()],3).filter(t=>!LA(t))},gh=3,Oq=({items:t,itemNormalisedPosition:e})=>{const r=uo(t),s=r.length;if(s===0)return Ae;if(s>gh)throw new Error(`roomItemPositions supports up to ${gh} items, but got ${s}: ${Object.keys(t).join(", ")}`);const n=r.map(([a,l])=>({id:a,pos:e(l)}));let i=Ae,o=1/0;if(UA[s]===void 0)throw new Error(`no precomputed valid grid index combinations for count ${s}`);for(const a of UA[s]){const l=a.map(c=>uN[c]);for(const c of Bq(l)){const u={};let h=0;for(let d=0;d<s;d++){const{id:f,pos:m}=n[d],A=c[d];u[f]=A,h+=hN(m,A)}h<o&&(o=h,i=u)}}return i},zq=({items:t,positions:e,ItemComponent:r})=>p.jsx("g",{"data-class":"items",children:uo(e).sort(([s,n],[i,o])=>o.y-n.y+(o.x-n.x)).map(([s,n])=>p.jsx("g",{"data-position":JSON.stringify(n),transform:`${pf(Xy(n,J*.5))} translate(0,-3)`,children:p.jsx(r,{item:t[s]})},s))}),fN=(t,e)=>{if(t==="*"){const r=Iq(e);if(r===void 0)throw new Error(`no floors in room ${e.id} when trying to get start and end for subroom ${t}`);return r}else{if(!e.meta?.subRooms)throw new Error(`no subrooms in ${e.id} when trying to get start and end for subroom ${t}`);return e.meta.subRooms[t].physicalPosition}},pN=({items:t,roomJson:e,subRoomId:r})=>{const s=S.useMemo(()=>Oq({items:t,itemNormalisedPosition:i=>{const o={...i.config.times??Ae,...sN},a=Wr(i.position,vt(o,.5)),l=fN(r,e);return{x:(a.x-l.from.x)/(l.to.x-l.from.x),y:(a.y-l.from.y)/(l.to.y-l.from.y)}}}),[t,e,r]);return p.jsx(zq,{ItemComponent:cN,items:t,positions:s})},mN=({headItemInRoom:t,heelsItemInRoom:e,roomJson:r,currentCharacterName:s,onClick:n})=>{const i=S.useMemo(()=>({item:{type:l,state:{facing:c}}})=>p.jsx(bi,{characterName:l,facing:c,isCurrent:s===l,onlyPlayableInRoom:!1,onClick:n}),[s,n]),o=S.useMemo(()=>({head:t,heels:e}),[t,e]),a=S.useMemo(()=>Oq({items:o,itemNormalisedPosition:c=>{const u=DA(c),h=E0(DA(c),{x:1/re.w,y:1/re.d,z:1}),d=Iq(r);if(d===void 0)throw new Error(`no floors in room ${r.id} when trying to get item position`);return{x:FA(h.x,d.from.x,d.to.x),y:FA(u.y,d.from.y,d.to.y)}}}),[o,r]);return p.jsx(zq,{ItemComponent:i,items:o,positions:a})},gN=(t,e,r)=>Kz(t,e,r)&&(t.type==="teleporter"||t.type==="hushPuppy"||t.type==="lift"||t.type==="pickup"&&t.config.gives!=="scroll"),AN=(t,e)=>{const r=Object.entries(t);if(r.length<=e)return t;const s=Object.groupBy(r,i=>i[1].type),n=w_(e,g_(...Or(s)));return Object.fromEntries(n)},yN=(t,e,r)=>S.useMemo(()=>{let s=!1,n=!1;const i=Ke(uo(t.items)).filter(([o,a])=>!e[o]).filter(([o,a])=>{if(a.type==="hushPuppy"){if(s)return!1;s=!0}if(a.type==="pickup"&&a.config.gives==="crown"){if(n)return!1;n=!0}return!0}).filter(o=>gN(o[1],r,t));return AN(Nn(i),gh)},[t,e,r]),Nq=.15,la=je(Kt({x:.5,y:.5,z:0})),HA=je(Kt({x:Nq,y:0,z:0})),$A=je(Kt({x:Nq*1.66,y:0,z:0})),xN=({className:t})=>p.jsxs(p.Fragment,{children:[p.jsx("ellipse",{className:"fill-white",cx:la.x,cy:la.y,rx:Math.abs($A.x),ry:Math.abs($A.y)}),p.jsx("ellipse",{className:t,cx:la.x,cy:la.y,rx:Math.abs(HA.x),ry:Math.abs(HA.y)})]}),Yt=3,GA=Jy(je({x:J,y:0})),ca={wall:void 0,open:"0,999",doorway:`${In(GA*((1-to)/2)-Yt/2)}, ${In(GA*to+Yt)}, 999`},iu=`
M ${X({})}
L ${X({y:J})}
L ${X({x:J,y:J})}
L ${X({x:J})}
z`,ua=(t,e=to)=>{const r=J*((1-e)/2),s=J-r,n=t.away!=="wall",i=t.towards!=="wall",o=t.left!=="wall",a=t.right!=="wall";let l=`M${X({x:r,y:r})}`;return a&&(l+=`L${X({x:0,y:r})} L${X({x:0,y:s})}`),l+=`L${X({x:r,y:s})}`,n&&(l+=`L${X({x:r,y:J})} L${X({x:s,y:J})}`),l+=`L${X({x:s,y:s})}`,o&&(l+=`L${X({x:J,y:s})} L${X({x:J,y:r})}`),l+=`L${X({x:s,y:r})}`,i&&(l+=`L${X({x:s,y:0})} L${X({x:r,y:0})}`),l+="z",l},ou=4,bN=Ke(ax(ou)).map(t=>`
M${X({x:J*((t+.5)/ou),y:0})}
L${X({x:J*((t+.5)/ou),y:J})}`).toArray().join(""),WA=t=>{const e=`
M${X({x:0,y:J})}
L${X({x:0,y:J,z:Er})}
L${X({x:J,y:J,z:Er})}
L${X({x:J,y:J})}
z
`;return t?e+`
M${X({x:St,y:J})}
L${X({x:St,y:J,z:Er})}
L${X({x:_t,y:J,z:Er})}
L${X({x:_t,y:J})}
L${X({x:St,y:J})}`:e},wN=`            
M${X({x:J,y:J,z:Er})}            
L${X({x:J,y:J})}            
M${X({x:J,y:0,z:Er})}            
L${X({x:J,y:0})}            
M${X({x:0,y:J,z:Er})}            
L${X({x:0,y:J})}            
`,qN=`            
M${X({x:0,y:0,z:Er})}            
L0, 0            
`,vN=({roomGridPositionSpec:{boundaries:t,subRoomId:e},roomPickupsCollected:r,roomJson:s,roomVisited:n,headItemInRoom:i,heelsItemInRoom:o,headOverHeelsItemInRoom:a,currentCharacterName:l,onPlayableClick:c,onRoomClick:u})=>{const{id:h,roomAbove:d,color:f,items:m}=s,A=s.meta?.label,g=yN(s,r,e),y=Object.values(m).filter(b=>b.type==="floor"),w=y.every(b=>b.config.floorType==="none"),x=y.some(b=>b.config.floorType==="deadly");return p.jsxs("g",{"data-room-id":h,strokeWidth:Yt,className:Jz(f),children:[w?p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",d:`${iu} ${ua(t)}`}),p.jsx("path",{className:"fill-white",fillRule:"evenodd",d:`${ua(t)} ${ua(t,to*.7)}`})]}):p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:iu}),p.jsx("path",{className:"fill-white",d:ua(t)}),x&&p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeDasharray:"1, 12.4",d:bN})]}),s.id==="blacktooth11"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",d:`
M${X({x:St,y:St})}
L${X({x:_t,y:St})}
L${X({x:_t,y:St-Yt*2})}
L${X({x:St,y:St-Yt*2})}
z
M${X({x:St,y:_t})}
L${X({x:_t,y:_t})}
L${X({x:_t,y:_t+Yt*2})}
L${X({x:St,y:_t+Yt*2})}
z
`}):s.id==="moonbase20"||s.id==="moonbase23"?p.jsx("path",{className:"stroke-[var(--roomHintColor)]",strokeWidth:Yt*2,d:`
M${X({x:St,y:J/2})}
L${X({x:_t,y:J/2})}

M${X({x:J/2,y:St})}
L${X({x:_t,y:J/2})}

M${X({x:J/2,y:_t})}
L${X({x:_t,y:J/2})}
`}):s.id==="blacktooth77"||s.id==="safari26"?p.jsx("path",{className:"fill-[var(--roomHintColor)]",strokeWidth:1,d:`
M${X({x:J/2-Yt,y:0})}
L${X({x:J/2+Yt,y:0})}
L${X({x:J/2+Yt,y:J})}
L${X({x:J/2-Yt,y:J})}
z
`}):null,d&&p.jsxs(p.Fragment,{children:[p.jsx("path",{className:"fill-[var(--roomHintColorDarker)]",fillRule:"evenodd",d:WA(t.away==="doorway")}),p.jsx("path",{className:"fill-[var(--roomHintColor)]",fillRule:"evenodd",transform:"scale(-1, 1)",d:WA(t.left==="doorway")})]}),p.jsxs("g",{className:"fill-transparent stroke-midGreyHalfbrite",children:[p.jsx("path",{d:`M${X({x:0,y:J})} L0, 0`,"data-direction":"right","data-boundary":t.right,strokeDasharray:ca[t.right]}),p.jsx("path",{d:`M${X({x:J,y:0})} L${X({x:J,y:J})}`,"data-direction":"left","data-boundary":t.left,strokeDasharray:ca[t.left]}),p.jsx("path",{d:`M${X({x:J,y:0})} L0, 0`,"data-direction":"towards","data-boundary":t.towards,strokeDasharray:ca[t.towards]}),p.jsx("path",{d:`M${X({x:0,y:J})} L${X({x:J,y:J})}`,"data-direction":"away","data-boundary":t.away,strokeDasharray:ca[t.away]})]}),n&&p.jsx(xN,{className:"fill-[var(--roomHintColor)]"}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:wN}),i&&o?p.jsx(mN,{roomJson:s,currentCharacterName:l,headItemInRoom:i,heelsItemInRoom:o,onClick:c}):i?p.jsx(bi,{characterName:"head",isCurrent:l==="head",onlyPlayableInRoom:!0,facing:i.state.facing,yAdjust:-8,onClick:c}):o?p.jsx(bi,{characterName:"heels",isCurrent:l==="heels",onlyPlayableInRoom:!0,facing:o.state.facing,yAdjust:-8,onClick:c}):a?p.jsxs(p.Fragment,{children:[p.jsx(bi,{characterName:"heels",onlyPlayableInRoom:!1,facing:a.state.facing,yAdjust:-16,isCurrent:!0}),p.jsx(bi,{characterName:"head",onlyPlayableInRoom:!1,facing:a.state.facing,isCurrent:!0,yAdjust:-36})]}):p.jsx(pN,{roomJson:s,subRoomId:e,items:g}),d&&p.jsx("path",{className:"fill-transparent stroke-midGreyHalfbrite",d:qN}),A&&p.jsx("g",{transform:pf(Kt(Wr(A.gridOffset,{x:.5,y:.5}))),children:p.jsx("foreignObject",{width:A.text.length*16,height:16,y:-8,x:A.align==="left"?0:A.text.length*-16,children:p.jsx(F,{noTint:!0,className:"[--scale:2] [--block:16px]",children:A.text})})}),u?p.jsx("path",{className:"fill-transparent cursor-pointer",d:iu,onClick:()=>{u(h)}}):null]})},au=(t,e,r,s)=>{const n=fh(e,t[e]?.items);return n&&r===t[e].roomJson.id&&s===ff(n.state.position,"fine",t[e].roomJson)?n:void 0},VN=t=>{const{campaign:e,pickupsCollected:r,gridPositions:s,currentCharacterName:n,characterRooms:i,mapBounds:o,containerWidth:a,roomsExplored:l,onPlayableClick:c,curRoomId:u,onRoomClick:h}=t;if(a===void 0)return null;const d=o.r-o.l+2*ro,f=o.b-o.t+2*Cs,m=Object.values(s);return p.jsxs("svg",{className:"w-full",style:{minWidth:`${d}px`,height:`${f}px`},strokeLinecap:"round",strokeLinejoin:"round",children:[u===void 0?null:p.jsx(rN,{...t,curRoomId:u,containerWidth:a}),p.jsx("g",{transform:`translate(${-o.l+ro+(a-d)/2},${-o.t+ +Cs})`,children:m.map(A=>{const{roomId:g,subRoomId:y,gridPosition:w}=A,x=`${g}/${y}`;return p.jsxs("g",{"data-id":x,transform:pf(Kt(w)),children:[p.jsx(vN,{roomGridPositionSpec:A,roomPickupsCollected:r[g]??Ae,roomJson:e.rooms[g],headItemInRoom:au(i,"head",g,y),heelsItemInRoom:au(i,"heels",g,y),headOverHeelsItemInRoom:au(i,"headOverHeels",g,y),currentCharacterName:n,roomVisited:l[g]??!1,onPlayableClick:c,onRoomClick:h}),u===g?p.jsx(jq,{svg:!0,smooth:!0}):null]},x)})})]})},_N=t=>{const{inputStateTracker:e}=t;return e.currentActionPress("swop")==="tap"?(Va(t),!0):e.currentActionPress("swop.head")==="tap"?(Va(t,"head"),!0):e.currentActionPress("swop.heels")==="tap"?(Va(t,"heels"),!0):!1},SN=()=>{const t=On(),[e,r]=S.useState(t.gameState.currentCharacterName);return S.useEffect(()=>{const s=()=>{r(t.gameState.currentCharacterName)};return Ct.shared.add(s),()=>{Ct.shared.remove(s)}},[t.gameState]),e},kN=()=>{const t=On();S.useEffect(()=>{const e=()=>{_N(t.gameState)};return Ct.shared.add(e),()=>{Ct.shared.remove(e)}},[t.gameState])},CN=t=>t.characterRooms[t.currentCharacterName],Ah=t=>JSON.parse(JSON.stringify(t)),PN=()=>$r().get("cheats")==="1",EN=(t,e)=>{const r=new URL(e),s=r.hash.substring(1);if(s!==""&&t.rooms[s]!==void 0)return r.hash.substring(1)},TN=t=>je(t),RN=(t,e)=>je(Z(t,{x:e.x,z:e.z})),MN=(t,e)=>je(Z(t,{y:e.y,z:e.z})),YA=(t,e,r)=>{const s=RN(e,r),n=MN(e,r),i=TN(e),o=t;return o.xAxisProjectionMin=n.y-n.x/2,o.xAxisProjectionMax=i.y-i.x/2,o.yAxisProjectionMin=s.y+s.x/2,o.yAxisProjectionMax=i.y+i.x/2,o.zAxisProjectionMin=s.x,o.zAxisProjectionMax=n.x,o},QA=re.w*2,KA=re.w*2,XA=re.w*2,JA=re.w*2;class Dq{#e=new Map;#t=new Map;#r=new Map;#i=new Map;#s=new Map;constructor(e){if(e)for(const r of e)this.addItem(r)}#n(e,r,s,n){const i=new Set;for(const o of r)n(o).add(e),i.add(o);s.set(e,i)}#a(e,r,s){const n=s.get(e);if(s.delete(e),!!n)for(const i of n){const o=r.get(i);o&&(o.delete(e),o.size===0&&r.delete(i))}}#l(e,r,s,n,i){const o=n.get(e);if(!o)throw new Error(`Item ${e.id} not in index`);const a=new Set(r);let l=!1,c=!1;for(const u of o)if(!a.has(u)){const h=s.get(u);h&&(l=!0,h.delete(e))}for(const u of a)o.has(u)||(i(u).add(e),c=!0);if(l)for(const u of o){const h=s.get(u);h&&h.size===0&&s.delete(u)}l||c?n.set(e,a):a.clear()}addItem(e){if(this.#r.has(e)){const r=this.#r.get(e);throw new Error(`Item ${e.id} is already in the spatial index at ${[...r].join(" ")}`)}this.#n(e,this.#c(e.state.position,e.aabb),this.#r,r=>this.#h(r)),this.#f(e),this.#n(e,this.#u(e),this.#i,r=>this.#d(r))}#o(e,r){return`${e},${r}`}#h(e){let r=this.#e.get(e);return r||(r=new Set,this.#e.set(e,r)),r}#d(e){let r=this.#t.get(e);return r||(r=new Set,this.#t.set(e,r)),r}*#c(e,r){const s=e,n=Z(e,r),i=Math.floor(s.x/KA),o=Math.floor(s.y/QA),a=Math.floor(n.x/KA),l=Math.floor(n.y/QA);for(let c=i;c<=a;c++)for(let u=o;u<=l;u++)yield this.#o(c,u)}#f(e){const r=e.renderAabbOffset?Z(e.state.position,e.renderAabbOffset):e.state.position,s=e.renderAabb||e.aabb,n=this.#s.get(e);if(n!==void 0)return YA(n,r,s),n;{const i=YA({},r,s);return this.#s.set(e,i),i}}*#u(e){const r=this.#s.get(e);if(r===void 0)throw new Error("projectionAxes not calculated for "+e.id);const{xAxisProjectionMin:s,xAxisProjectionMax:n,yAxisProjectionMin:i,yAxisProjectionMax:o}=r,a=Math.floor(s/JA),l=Math.floor(i/XA),c=Math.floor(n/JA),u=Math.floor(o/XA);for(let h=a;h<=c;h++)for(let d=l;d<=u;d++)yield this.#o(h,d)}removeItem(e){if(!this.#r.has(e))throw new Error(`Item ${e.id} is not in the spatial index`);this.#a(e,this.#e,this.#r),this.#a(e,this.#t,this.#i),this.#s.delete(e)}updateItemSpatialIndex(e){this.#l(e,this.#c(e.state.position,e.aabb),this.#e,this.#r,r=>this.#h(r))}updateItemProjectedIndex(e){this.#f(e),this.#l(e,this.#u(e),this.#t,this.#i,r=>this.#d(r))}getCuboidNeighbourhood(e,r,s){const n=new Set;for(const i of this.#c(e,r)){const o=this.#e.get(i);if(o)for(const a of o)a!==s&&n.add(a)}return n}getProjectedNeighbourhood(e,r){const s=new Set;for(const n of this.#u(e)){const i=this.#t.get(n);if(i)for(const o of i)o!==r&&s.add(o)}return s}getItemCuboidNeighbourhood(e){return this.getCuboidNeighbourhood(e.state.position,e.aabb,e)}getItemProjectedNeighbourhood(e){return this.getProjectedNeighbourhood(e,e)}getItemAxesProjections(e){return this.#s.get(e)}debugToString(){const r=Array.from(this.#e.keys()).sort().map(i=>{const o=this.#e.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`}),n=Array.from(this.#t.keys()).sort().map(i=>{const o=this.#t.get(i),a=Array.from(o).map(l=>l.id);return`  (${i}) => [${a.join(", ")}]`});return`GridSpatialIndex (${this.#e.size} 2D cells, ${this.#t.size} projected cells, ${this.#r.size} items) {
  2D Cells:
${r.join(`,
`)}
  Projected Cells:
${n.join(`,
`)}
}`}}const mf=({aabb:t,state:{position:e}},{aabb:r,state:{position:s}})=>!(e.x+t.x<=s.x||e.x>=s.x+r.x)&&!(e.y+t.y<=s.y||e.y>=s.y+r.y)&&!(e.z+t.z<=s.z||e.z>=s.z+r.z),IN=t=>!0;function*gf(t,e,r=IN){const s=e.getItemCuboidNeighbourhood(t);for(const n of s)r(n)&&mf(t,n)&&(yield n)}const ZA=(t,e)=>({x:t.x>0?e.state.position.x:e.state.position.x+e.aabb.x,y:t.y>0?e.state.position.y:e.state.position.y+e.aabb.y,z:t.z>0?e.state.position.z:e.state.position.z+e.aabb.z}),ey={stopAutowalk:5,portal:5,wall:5,blocker:5,doorLegs:5,sceneryPlayer:5,bubbles:5,switch:10,button:10,doorFrame:15,ball:18,block:20,barrier:20,floor:20,hushPuppy:20,teleporter:20,lift:30,movingPlatform:30,pushableBlock:30,portableBlock:30,sceneryCrown:30,slidingBlock:30,spring:30,joystick:40,charles:40,conveyor:40,head:50,heels:50,headOverHeels:50,pickup:80,firedDoughnut:90,spikes:98,slidingDeadly:100,moveableDeadly:100,deadlyBlock:100,monster:100,floatingText:200,particle:200,emitter:200},Fq=(t,e)=>ey[t.type]-ey[e.type],jN=(t,e)=>e.toSorted((r,s)=>{const n=Fq(r,s);if(n!==0)return n;const i=Ma(t,ZA(t,r)),o=Ma(t,ZA(t,s));return Math.abs(i-o)<1e-4?r.id<s.id?-1:1:i-o}),BN=(t,e,r,s)=>{const n=Math.max(0,Math.min(t.x+e.x,r.x+s.x)-Math.max(t.x,r.x)),i=Math.max(0,Math.min(t.y+e.y,r.y+s.y)-Math.max(t.y,r.y));return n*i},ty=({state:{position:t},aabb:e},{state:{position:r},aabb:s})=>BN(t,e,r,s),ds={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},fs={state:{position:{x:0,y:0,z:0}},aabb:{x:0,y:0,z:0}},ON=(t,e,r=.001)=>{if(!Qi(e,t)||t.id===e.id)return!1;const{state:{vels:{gravity:{z:s}}}}=t;return s>0?!1:(ds.state.position.x=t.state.position.x,ds.state.position.y=t.state.position.y,ds.state.position.z=t.state.position.z-Ts,ds.aabb.x=t.aabb.x,ds.aabb.y=t.aabb.y,ds.aabb.z=t.aabb.z+r+Ts,fs.state.position.x=e.state.position.x,fs.state.position.y=e.state.position.y,fs.state.position.z=e.state.position.z+e.aabb.z,fs.aabb.x=e.aabb.x,fs.aabb.y=e.aabb.y,fs.aabb.z=0,mf(ds,fs))},zN=(t,e)=>{const s=[...Ke(e).filter(i=>ON(t,i))];return s.length===0?void 0:s.reduce((i,o)=>{const a=Fq(o,i);return a<0||a===0&&ty(t,o)>ty(t,i)?o:i})},ha=re.h,NN=-12,DN=t=>{const e=Ft(t).filter(Cq).reduce((r,{config:{naturalFootprint:{position:{x:s,y:n},aabb:{x:i,y:o}}}})=>{const a=s+i,l=n+o;return{minX:Math.min(r.minX,s),maxX:Math.max(r.maxX,a),minY:Math.min(r.minY,n),maxY:Math.max(r.maxY,l)}},{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0});if(!(e.minX>e.maxY))return e};function*FN(t,e){const r=DN(e);if(r===void 0)return;const{minX:s,maxX:n,minY:i,maxY:o}=r;t.roomBelow!==void 0&&(yield{...ft,type:"portal",id:"portal/toRoomBelow",fixedZIndex:Rs,config:{toRoom:t.roomBelow,relativePoint:{x:(s+n)/2,y:(i+o)/2,z:ha+re.h},direction:ye.down},aabb:{x:n-s,y:o-i,z:ha},state:{...ot(),position:{x:s,y:i,z:NN-ha}},renders:!1}),t.roomAbove!==void 0&&(yield{...ft,type:"portal",id:"portal/toRoomAbove",fixedZIndex:Rs,config:{toRoom:t.roomAbove,relativePoint:{...t.ceilingRelativePoint!==void 0?Ne(t.ceilingRelativePoint):{x:(s+n)/2,y:(i+o)/2},z:-12},direction:ye.up},aabb:{x:n-s,y:o-i,z:ha},state:{...ot(),position:Z({x:s,y:i},{z:re.h*(t.height??qz)})}})}function*LN(t,e,r,s){const n=uo(t.items);for(const[i,o]of n)o.type==="player"&&!s||(yield*hf(i,o,t,e,r))}const ry=t=>Ke(t).reduce((e,r)=>({...e,[r.id]:r}),{}),yh=({roomJson:t,roomPickupsCollected:e,scrollsRead:r,isNewGame:s=!1})=>{const n=ry(LN(t,e,r,s)),i={...ry(FN(t,n)),...n},o=new Dq(Ft(i));for(const l of Ft(i)){const u=gf(l,o).find(h=>Qi(l)&&Qi(h)&&!(l.type==="wall"&&h.type==="wall"));u!==void 0&&console.error(`in room ${t.id} item ${l.id} @${JSON.stringify(l.state.position)} #${JSON.stringify(l.aabb)} is colliding with (solid item) ${u.id} @${JSON.stringify(u.state.position)} #${JSON.stringify(u.aabb)} on loading room ${t.id}`)}for(const l of Ft(i).filter(Rn)){const c=zN(l,Ft(i).filter(u=>u.id!==l.id));c!==void 0&&df({above:l,below:c})}return{...t,roomJson:t,items:i,roomTime:0,[rs]:o}},Tr=(t,e,r)=>{const s=t[rs];e.state.position=r,s.updateItemSpatialIndex(e)},UN=.5,HN=(t,e,r,s)=>t.x<r.x+s.x&&t.x+e.x>r.x&&t.y<r.y+s.y&&t.y+e.y>r.y&&t.z<r.z+s.z&&t.z+e.z>r.z,$N=(t,e,r,s,n)=>{if(zn(n)<1e-4)return{x:0,y:0,z:0};const o=C0(n);if(!HN(t,e,r,s))return{x:0,y:0,z:0};let a=-1/0,l=1/0;for(const c of I0){const u=o[c];if(Math.abs(u)<1e-4){const x=t[c],b=t[c]+e[c],V=r[c],_=r[c]+s[c];if(b<=V||x>=_)return{x:0,y:0,z:0};continue}const h=r[c],d=r[c]+s[c],f=t[c],m=t[c]+e[c],A=(h-m)/u,g=(d-f)/u,y=Math.min(A,g),w=Math.max(A,g);a=Math.max(a,y),l=Math.min(l,w)}return a>l?{x:0,y:0,z:0}:l>0&&(a>=0||l<-a)?vt(o,l):a<0?vt(o,a):{x:0,y:0,z:0}},xh=(t,e,r,s)=>{const n=r.x+s.x-t.x,i=r.y+s.y-t.y,o=r.z+s.z-t.z,a=t.x+e.x-r.x,l=t.y+e.y-r.y,c=t.z+e.z-r.z,u=Math.abs(n)<Math.abs(a)?n:-a,h=Math.abs(i)<Math.abs(l)?i:-l,d=Math.abs(o)<Math.abs(c)?o:-c,f=Math.abs(u),m=Math.abs(h),A=Math.abs(d)*UN;return f<m&&f<A?{x:u,y:0,z:0}:m<A?{x:0,y:h,z:0}:{x:0,y:0,z:d}},sy=(t,e,r)=>{const s=e.state.actedOnAt;s!==void 0&&(s.roomTime===r.roomTime?t&&(s.by[t.id]=!0):(s.by=t?{[t.id]:!0}:{},s.roomTime=r.roomTime))},GN=(t,e,r)=>{const s=(n,i)=>{const{collidedWith:o}=n.state;o.roomTime===r.roomTime?o.by[i.id]=!0:(o.by={[i.id]:!0},o.roomTime=r.roomTime)};s(t,e),Rn(e)&&s(e,t)},WN=(t,e,r,s)=>{const n=qq(t,e,r),i=xh(t.state.position,t.aabb,e.state.position,e.aabb);if(n&&i.z===0){const o=Kr(s,t.state.position),a=k0(o),l=Ma(i,o)/a;if(o.z=0,l>.44)return $N(t.state.position,t.aabb,e.state.position,e.aabb,o)}return i},Lq=({subjectItem:t,posDelta:e,gameState:r,room:s,pusher:n,deltaMS:i,forceful:o=Ce("lift")(t)&&n===void 0,onTouch:a,path:l=new Set})=>{if(Yh(e,ae))return;const{state:{position:c}}=t;Tr(s,t,Z(c,e)),n===void 0&&sy(void 0,t,s);const u=jN(e,gf(t,s[rs]).toArray());for(const h of u){if(l.has(h.id)||!mf(t,h))continue;if(sy(t,h,s),a?.({movingItem:t,touchedItem:h,movementVector:Kr(t.state.position,c),gameState:r,deltaMS:i,room:s}),s.items[t.id]===void 0)return;if(s.items[h.id]===void 0||!Qi(h,t)||!Qi(t))continue;const d=qq(t,h,o),f=WN(t,h,o,c),m=Gr(zn(xh(c,t.aabb,h.state.position,h.aabb)),0);if(d){const A=o||sz(h)?-1:-.5,g=vt(f,A);if(Tr(s,t,Z(t.state.position,f,g)),l.size<Vz?(Lq({subjectItem:h,posDelta:g,gameState:r,room:s,deltaMS:i,forceful:o,pusher:t,path:l.add(t.id),onTouch:a}),l.delete(t.id)):console.warn("hit recursion depth limit",new Error),s.items[h.id]===void 0)continue;Tr(s,t,Z(t.state.position,xh(t.state.position,t.aabb,h.state.position,h.aabb)))}else Tr(s,t,Z(t.state.position,f));Rn(t)&&f.z>0&&e.z<0&&(t.state.standingOnItemId===null||!u.includes(Eq(t.state.standingOnItemId,s)))&&(mh(t,s),df({above:t,below:h})),Rn(t)&&!m&&GN(t,h,s)}},bh=({state:{position:t,facing:e,autoWalk:r,action:s,vels:n}})=>({position:t,facing:e,autoWalk:r,action:s,vels:{...n}}),sU=t=>t[Math.floor(Math.random()*t.length)],YN=(t,e)=>t+Math.random()*(e-t),QN=1e3/25,Uq=t=>{const e=Nt.animations[t],r=e.length,{animationSpeed:s}=e;return r*QN/s};Uq("bubbles.white");const KN=Uq("head.fadeOut"),XN=({touchedItem:t,room:e,gameState:r})=>{Mn({room:e,item:t});const s=Az(t),n=t.type==="pickup"?{type:"pickup",gives:t.config.gives}:t.type==="hushPuppy"?{type:"hushPuppy"}:{type:"disappearing"},i=vt(lf(t).aabb,.5);for(let o=0;o<s.x;o++)for(let a=0;a<s.y;a++)for(let l=0;l<s.z;l++){const c=Lz({itemType:"bubbles",config:{style:"white",was:n},position:ae,room:e,gameState:r}),u={x:o*Ti.x,y:a*Ti.y,z:l*Ti.z},h=Z(t.state.position,u,i);Tr(e,c,Kr(h,vt(c.aabb,.5))),c.state.expires=e.roomTime+KN*YN(.75,1.25)}},JN=(t,e)=>{const r=Ft(t.items).filter(hz);for(const s of r)XN({touchedItem:s,gameState:e,room:t})},ZN=(t,e,{changeType:r,sourceItem:s})=>{switch(r){case"portal":return Ft(t.items).find(n=>vs(n)&&n.config.toRoom===e.id&&(s.config.toDoor===void 0||n.jsonItemId===s.config.toDoor)&&Yh(vt(s.config.direction,-1),n.config.direction));case"level-select":return Ft(t.items).find(n=>vs(n)&&n.config.toRoom===e.id&&n.config.direction.z===0)??Ft(t.items).find(n=>vs(n)&&n.config.direction.z===0)??Ft(t.items).find(n=>vs(n)&&n.config.direction.z>0)??Ft(t.items).find(vs)}},e2=(t,e,r,s)=>{const n=1*re.w;Tr(s,t,Z(t.state.position,vt(e,n)));for(let i=0;i<n;i++)Lq({subjectItem:t,posDelta:vt(e,-1),gameState:r,room:s,deltaMS:16,forceful:!0,onTouch:void 0})},t2=t=>{const{playableItem:e,gameState:r,toRoomId:s,changeType:n,sourceItem:i}=t,o=r.characterRooms[e.id];if(o===void 0)throw new Error(`${e.id} is not in a room on the gameState`);if(s===o.id)throw new Error(`Can't move ${e.id} to the same room "${s}""`);let a;switch(n){case"portal":{const{config:{relativePoint:m},state:{position:A}}=i;a=Kr(e.state.position,Z(A,m));break}case"teleport":{const{state:{position:m}}=i;a=Kr(e.state.position,m);break}case"level-select":a={x:0,y:0,z:0};break;default:throw new Error}const l=e.type==="headOverHeels"?void 0:r.characterRooms[xn(e.id)],u=Xx(xe.getState()).rooms[s];if(u===void 0)throw new Error(`room ${s} does not exist in campaign`);const h=l?.id===s?l:yh({roomJson:u,roomPickupsCollected:r.pickupsCollected[s]??Ae,scrollsRead:xe.getState().gameMenus.gameInPlay.scrollsRead});Mn({room:o,item:e});const d=dz(e);if(d!==void 0&&(d.carrying=null),e.state.latentMovement=[],(e.type==="head"||e.type==="headOverHeels")&&JN(h,r),h.items[e.id]!==void 0&&Mn({room:h,item:e}),eo({room:h,item:e}),r.characterRooms[e.id]=h,t.changeType==="teleport"){const{state:{toPosition:m}}=t.sourceItem;Tr(h,e,Z(Ne(m),a))}else{const m=ZN(h,o,t);if(m===void 0)if(t.changeType==="level-select")Tr(h,e,Ne({x:1,y:1,z:8}));else throw new Error(`trying to move ${e.id} from ${o.id} --to-> ${s} but no destination portal found to locate with`);else{const A=Z(m.state.position,m.config.relativePoint,a,n==="portal"&&i.config.direction.z>0?{z:re.h}:{});Tr(h,e,A);const{config:{direction:g}}=m;g.z===0&&(e.state.autoWalk=!0,e.state.facing=vt(g,-1),e.state.action==="idle"&&(e.state.action="moving"),e2(e,g,r,h))}}const f=ix(gf(e,h[rs],m=>!vs(m)));f!==void 0&&console.warn("on entering room",s,"character",e.id,"at",e.state.position,"collides with (at least one; only first is shown) non-portal item:",f),r.entryState[e.id]=bh(e),e.id==="headOverHeels"?(delete r.entryState.head,delete r.entryState.heels):(r.entryState[xn(e.id)]||(r.entryState[xn(e.id)]=r.entryState.headOverHeels),delete r.entryState.headOverHeels),xe.dispatch(xC(s)),xe.dispatch(cC({characterName:e.type,roomId:s}))},Hq=t=>{const e={};for(const r of Object.values(t.rooms))for(const s of Object.values(r.items))if(s.type==="player"){const{which:n}=s.config;if(e[n]!==void 0)throw new Error(`Campaign has duplicate starting rooms for ${n}`);e[n]=r.id}return e},r2=t=>{const e=Hq(t),r={...e};if(e.head===void 0&&e.heels===void 0)throw new Error("couldn't find either head or heels in campaign");let s=$r().get("playAsHeels")==="1"?"heels":e.head!==void 0?"head":"heels";const n=PN()?EN(t,window.location.href):void 0;return n!==void 0&&(r[s]=n),r.head===void 0&&(s="heels"),{campaignStartingRoomIds:e,startingRoomIds:r,startAs:s,changedCharacterRoomFromCampaign:n!==void 0&&e[s]!==r[s]}},s2=t=>{for(const e of Or(t)){const r=e;r[rs]===void 0&&(r[rs]=new Dq(Ft(e.items)))}return t},n2=({campaign:t,inputStateTracker:e,savedGame:r,writeInto:s={}})=>{if(r){const m=r.gameState.characterRooms,A=Ah(m);return m.head!==void 0&&m.head.id===m.heels?.id&&(A.heels=A.head),Object.assign(s,{inputStateTracker:e,gameSpeed:1,...Ah(r.gameState)}),s.characterRooms=s2(A),s}const{startAs:n,startingRoomIds:i,campaignStartingRoomIds:o,changedCharacterRoomFromCampaign:a}=r2(t),l={roomPickupsCollected:Ae,scrollsRead:Ae,isNewGame:!0},c=o.head&&yh({roomJson:t.rooms[o.head],...l}),u=o.heels===o.head?c:o.heels&&yh({roomJson:t.rooms[o.heels],...l}),h=c===void 0?void 0:fh("head",c?.items),d=u===void 0?void 0:fh("heels",u?.items),f=Object.assign(s,{inputStateTracker:e,gameSpeed:1,currentCharacterName:n,entryState:{head:h===void 0?void 0:bh(h),heels:d===void 0?void 0:bh(d)},pickupsCollected:{},gameTime:0,progression:0,characterRooms:{head:c,heels:u,headOverHeels:void 0}});return a&&t2({changeType:"level-select",gameState:f,playableItem:n==="head"?h:d,toRoomId:i[n],sourceItem:void 0}),f},nU=t=>{try{return n2(t)}catch(e){throw new Error("failed to load game state",{cause:e})}},i2=je(Kt({x:1,y:1,z:1})).y,ny=je(Kt({x:0,y:1,z:0})).x,o2=t=>t.reduce((e,{gridPosition:r})=>{const s=je(Kt(r));return{t:Math.min(e.t,s.y+i2),b:Math.max(e.b,s.y),l:Math.min(e.l,s.x-ny),r:Math.max(e.r,s.x+ny)}},{t:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,l:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY}),da=(t,e,r,s)=>e.some(n=>n.config.direction===t)?"doorway":r===void 0?"wall":Object.values(r).some(({gridPosition:n})=>R0(ye[t],V0(n,s)))?"open":"wall";function*un(t){try{yield*a2(t)}catch(e){const r=e;throw new Error(`
  error in recursion ${t.roomId}/${t.subRoomId??"*"}`,{cause:r})}}function*a2({roomId:t,subRoomId:e="*",campaign:r,visited:s={},vectorFromPrevious:n,previousRoomGridPosition:i=ae}){if(t==="nowhere"||s[t]?.[e])return;s[t]===void 0&&(s[t]={}),s[t][e]=!0;const o=r.rooms[t];if(o===void 0)throw new Error(`no room in the campaign with id="${t}"`);const a=[...Ke(Or(o.items)).filter(f=>f.type==="door").filter(f=>ff(f.position,"block",o)===e)],l=Z(i,n===void 0?M0:n),c=o.meta?.subRooms;if(c){if(e==="*")throw new Error(`subRoomId '*' means 'all' and is not allowed for big rooms. Must be one of the sub-rooms in ${t}: ${Object.keys(c)}`);if(!c[e])throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`)}const u=c?.[e].gridPosition,h={left:da("left",a,c,u),right:da("right",a,c,u),away:da("away",a,c,u),towards:da("towards",a,c,u)};if(yield{roomId:t,subRoomId:e,gridPosition:l,boundaries:h},c!==void 0){if(u===void 0)throw new Error(`Sub-room ${e} not found in room ${t}. Available sub-rooms: ${Object.keys(c)}`);for(const[f,{gridPosition:m}]of Ke(uo(c)))f!==e&&(yield*un({roomId:t,subRoomId:f,campaign:r,visited:s,vectorFromPrevious:Kr({...m,z:0},u),previousRoomGridPosition:l}))}if(o.roomAbove!==void 0){const{roomAbove:f,subRoomAbove:m}=o;yield*un({roomId:f,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:ye.up,previousRoomGridPosition:l})}if(o.roomBelow!==void 0){const{roomBelow:f,subRoomBelow:m}=o;yield*un({roomId:f,subRoomId:m,campaign:r,visited:s,vectorFromPrevious:ye.down,previousRoomGridPosition:l})}for(const f of a){const{toRoom:m}=f.config;try{yield*un({roomId:m,campaign:r,visited:s,subRoomId:f.config.meta?.toSubRoom,vectorFromPrevious:ye[f.config.direction],previousRoomGridPosition:l})}catch(A){throw new Error(`error while traversing door ${JSON.stringify(f,null,2)} in room ${t} to room ${m}`,{cause:A})}}const d=o.meta?.nonContiguousRelationship;if(d!==void 0){const{with:{room:f},gridOffset:m}=d;yield*un({roomId:f,campaign:r,visited:s,subRoomId:"*",vectorFromPrevious:m,previousRoomGridPosition:l})}}const l2=t=>{const r=[...t].sort(({gridPosition:s},{gridPosition:n})=>s.z!==n.z?s.z-n.z:n.x+n.y-(s.x+s.y)).map(s=>[`${s.roomId}/${s.subRoomId}`,s]);return Nn(r)},c2=()=>{const t=SN(),e=nC(),{gameState:r}=On(),s=Jx();return S.useMemo(()=>{try{const n=CN(r),i=n?.roomJson.id??Hq(s).head;let o;if(!r)o="*";else if(!n?.roomJson.meta?.subRooms)o="*";else{const u=n?.items[t];u?o=ff(u.state.position,"fine",n.roomJson):o="*"}const a=[...un({campaign:s,roomId:i,subRoomId:o})],l=l2(a);return{mapBounds:o2(a),curRoomId:n?.roomJson.id,gridPositions:l,currentCharacterName:t,pickupsCollected:r.pickupsCollected,characterRooms:r.characterRooms,campaign:s,roomsExplored:e,curRoomScenery:n?.planet}}catch(n){throw new Error("error getting map data",{cause:n})}},[s,t,r,e])},u2=()=>{const{ref:t,width:e}=QO(),r=Rq(),s=On();kN();const n=c2(),i=Mq(n.curRoomScenery);return p.jsx(Oe,{children:p.jsx(ke,{ref:t,fullScreen:!0,className:`bg-white zx:bg-zxBlack pr-0 p-0 mobile:pl-0 justify-center ${i.containerClassName}`,onClick:H(Le),children:p.jsx("div",{className:"overflow-y-scroll scrollbar scrollbar-w-1 h-min",ref:r,children:p.jsx(VN,{onPlayableClick:o=>Va(s.gameState,o),containerWidth:e,...n})})})})},h2=`## BAG

![](texture-bag)The *bag* may be used to carry small objects around a room. It is essential for
Heels to find and get the bag as it is impossible to get far without it.

The object in the bag will be displayed immediately above the bags icon at the
bottom right of the screen. To pick up an object just stand on top of it and
press the *CARRY* key. 

![](texture-cube)![](texture-drum)![](texture-spring_compressed)![](texture-sticks)

It is not possible to take items through doorways.

> Head Over Heels Manual

`,d2=`## BLACKTOOTH

![](texture-blacktooth_wall_armour_left?bg-pureBlack)![](texture-blacktooth_wall_shield_away?bg-pureBlack&float-right)This planet has a large moon with three lunar space stations on it, the larger
of these, *Moon Station HQ*, is the main teleport center for the empire, with a
direct teleport to all the slave planets.

Sometime after the Egyptus episode,
the latest Emperor sent out a craft to find that same strange planet, and after
much exploration, it was finally located, and the craft landed. However, the
crew found the people had changed: instead of pyramids they used castles,
instead of wrapping corpses up in cloth, they wrapped living men in metal and
then tried to turn them into corpses with sharp metal sticks.

![](texture-teleporter)The Emperor, not to be outdone by his ancestor, built a castle on Blacktooth and
used it as his headquarters. The castle is surrounded by a small market, and
then a range of impassable mountains. The only way to leave is via teleport to
one of the three lunar space stations.

> Head Over Heels Manual`,f2=`## BOOK WORLD

![](texture-bookworld_wall_cowboy_left?bg-pureBlack)![](texture-book_x?float-right&clear-right)![](texture-book_y?float-right&clear-right)The emperor is very keen
on *cowboy books* and has devoted an entire world to a *western library*.

Only the emperor's minions are permitted to read them.
Information is rigorously suppressed in the empire.

> Head Over Heels Manual
`,p2=`## CONVEYOR BELTS

![](texture-animated-heels_walking_right?z-topSprite&relative&ml-centreSmallBlockOnLarge&mr-2)![](texture-animated-conveyor_x?&relative&clear-left&bottom-bottomStackPullup)The rollers on the conveyor simply push you along it. If you wish to go the
opposite direction you have to jump along.

> Head Over Heels Manual
`,m2=`## CREDITS

### Original credits

Written by Jon Ritman and Bernie Drummond.  
Music and sound effect by Guy Stevens.  
Produced by D.C. Ward.  
1987 Ocean Software Limited.

### 38 years later, a Remake

* code by Jim Higson
* Playtesting, ideas, map design, and general support by my brother, Tom Higson
* Playtesting, moral support, and constant comms by [Jon Albaugh](https://x.com/fextwolf?s=21&t=PEqxJblCn3JB_NH8AOR6Zg)
* Head over heels [font](https://fontstruct.com/fontstructions/show/996776/head_over_heels)
recreated by [Patrick H. Lauke](http://splintered.co.uk/)

This project is licensed under the GNU Affero General Public License v3.0 (only) - see the LICENSE file for details. All code is original except where indicated otherwise.

2025 Jim Higson`,g2=`## CROWNS

![](texture-crown_blacktooth)![](texture-crown_bookworld?float-right)![](texture-crown_egyptus?clear-left)![](texture-crown_penitentiary?float-right&clear-right)![](texture-crown_safari?clear-left)Find a crown and start a revolution. At the beginning of each game, a screen
showing all five planets with a crown above each will be displayed.

As each
crown is collected this screen will be shown again with the appropriate crowns
in a bright color.

> Head Over Heels Manual`,A2=`## CUDDLY STUFFED WHITE RABBITS

![](texture-whiteRabbit?float-right)The *cute toy bunnies* magically enhance your powers. The status display at the
bottom of the screen will keep you informed as to which powers are temporarily
enhanced.

If Head and Heels are connected when they pick up a *Life* or *Iron pill*,
they will both get the enhanced power.

There are four types:

## Two extra lives
if you pick them up while head and heels are joined, they get *two each*

## Iron pills ![](texture-hud_shield?sprite-tinted&text-metallicBlue&sprites-normal-height)

![](texture-animated-shine?text-metallicBlue&float-left)to make you invulnerable

## ![](texture-hud_bigJumps?sprite-tinted&text-metallicBlue&sprites-normal-height) Jump higher bunny 

![](texture-animated-heels_idle_right?text-metallicBlue&float-left)only works on Heels

## ![](texture-hud_fastSteps?sprite-tinted&text-metallicBlue&sprites-normal-height) Go faster bunny 
![](texture-animated-head_idle_right?text-metallicBlue&float-left)only works on slow-moving Head

> Head Over Heels Manual
`,y2=`## DOUGHNUTS

![](texture-doughnuts)Trays of *six doughnuts* are few and far between, so dont waste shots. Only Head
may pick up doughnuts.

The number of remaining doughnuts will be displayed above
the doughnut icon at the bottom left of the screen.

> Head Over Heels Manual
`,x2=`## EGYPTUS

![](texture-egyptus_wall_sarcophagus_left)![](texture-egyptus_wall_sarcophagus_away?float-right)![](texture-egyptus_wall_hieroglyphics_left?clear-left)![](texture-egyptus_wall_hieroglyphics_away?float-right&clear-right)Once, a long time ago, a craft from Blacktooth got a bit lost while doing a
hyperspace jump and landed on an unknown planet.

Here the crew found a primitive
animal forming a sort of civilization that appeared to revolve around wrapping
corpses in lots of bandages and putting them into huge stone pyramids.

When they
returned to Blacktooth their emperor liked the sound of it so much that he
rebuilt the capital city of one of the slave planets to resemble the story.

> Head Over Heels Manual
`,b2=`## HEAD 
### (HEADUS MOUTHION)

![](texture-animated-head_walking_towards?float-right)This creature is a symbiotic partner to Heels and will normally be found sitting
on top of one.

![](texture-head_falling_right)Head is descended from a breed of flying reptile and still has
rudimentary wings that allow Head to jump up to twice his own height and to
guide himself through the air.

> Head Over Heels Manual
`,w2=`## HEELS 
### (FOOTUS UNDERIUM)

![](texture-animated-heels_walking_towards?float-right)During Heelss evolution, the arms have totally disappeared while the legs have
become very powerful.

Heels can jump his own height and can also run very fast.

> Head Over Heels Manual`,q2=`## HINTS AND TIPS

1. **1** *:* Beginners should aim to escape from Blacktooth and get back to Freedom initially. Only the very skillful can hope to liberate a planet or two.
2. **2** *:* ![](texture-animated-head_idle_towards?float-right&relative&z-topSprite)![](texture-heels_walking_towards_2&float-right&clear-right&relative&bottom-bottomStackPullup)When you first get Head and Heels in the same location, practice placing Head on top of Heels and joining them together accurately with the swop key. Both of their icons will light up when they are successfully joined.
3. **3** *:* Remember Head and Heels are a team. Just because both are in the same room does not mean you have to join them together, and in fact, some problems may only be solved by separating Head and Heels.
4. **4** *:* Make sure Head learns to climb ladders; this is an essential skill.
5. **5** *:* ![](texture-bag?float-right)![](texture-hooter?float-right)Both Heelss bag and Heads hooter must be collected at the initial stages for there to be any chance of completing the game.
6. **6** *:* If Head and Heels are in the same room, extra jumping height may be obtained by one jumping off the others back.
7. **7** *:* Find a safe spot and get used to how far Head and Heels may move over the edge of a brick before they fall. This will enable you to make the longest jumps. Both Head and Heels will jump slightly further if they are running as they jump.
8. **8** *:* Learn the difference in distance and control between Heads jumps and Heelss jumps.
9. **9** *:* This remake comes with a **map**. Use it!
10. **10** *:* ![](texture-doughnuts?float-right)Do not waste doughnuts; they are not easy to find.
11. **11** *:* Do not get confused; only Heels may carry anything, and only Head may fire.
12. **12** *:* ![](texture-spring_released?float-right&relative&z-topSprite)![](texture-cube?float-right&clear-right&relative&bottom-bottomStackPullup)To discover if there is a room above, pile objects as high as possible and jump from the top. If there is a spring in the room, put it on the top for extra jumping height.
13. **13** *:* If you cant understand a room, try exiting and entering again, watching carefully for any movement in the room as you enter.

> Head Over Heels Manual`,v2=`## HISTORY OF THE BLACKTOOTH EMPIRE

![](texture-crown_blacktooth)Far, far away from our star Sol lies the Blacktooth empire, an evil empire, four
worlds enslaved by the planet Blacktooth.

![](texture-animated-dalek?float-right)All of the slave worlds bubble with
unrest, but due to the oppressive nature of their rulers they never reach
boiling point, they all lack a leader to draw the masses of population together.

![](texture-animated-helicopterBug?float-right)Blacktooth itself is not any better, a world rigidly controlled by its dynastic
leaders for so long that the populace do not ever think about revolution.

![](texture-head_walking_right_2)The peoples of the neighbouring stars are getting very worried about signs of
military expansion from Blacktooth and have sent a spy from the planet Freedom
to see if he can push the slave planets into full rebellion by finding the
crowns lost when Blacktooth took over.

![](texture-heels_walking_right_2)The creatures of *Freedom* are very strange in that they are formed from a pair of
*symbiotic animals* that have adapted to operate either independently or, to their
mutual advantage, join together as one - Head saddled on Heels, and indeed these
ARE their names and both are highly trained spies.

> Head Over Heels Manual
`,V2=`## HOOTER

![](texture-hooter)The *hooter* may be used by Head to fire *doughnuts* at attacking monsters.

This will freeze them in place as they lick the doughnut off their faces.

![](texture-doughnuts?float-right&clear-both)The hooter may only be used by Head and requires a tray of doughnuts to be of any use.

> Head Over Heels Manual
`,_2=`## HUSH PUPPIES

![](texture-hushPuppy?float-right)These are a very strange type of beast; they are incredibly 
sleepy. In fact, they never wake up and it is quite normal for them to sleep for 
their entire lives.

They are often used as tables and even used as building bricks. 
They are a native of Freedom, ![](texture-head_walking_right_2?clear-both)and for many thousands of years Head and his ancestors 
have been mistaking them for Heels and causing so much trouble to the poor old hush
puppies that they evolved a defense mechanism they somehow learned to teleport
themselves away.

![](texture-animated-bubbles_white?float-right&clear-both)Nobody knows where they go, but
the instant they see any of Heads race, they disappear and wont return until they are sure the coast is
clear.

> Head Over Heels Manual
`,S2=`
## PENITENTIARY
### The empire's prison planet

![](texture-penitentiary_wall_skeleton_left)Millions are imprisoned here. A harsh planet, very mountainous, much climbing,
skill required.

The worst place is The Pit, try not to fall into it!

> Head Over Heels Manual
`,k2=`## REINCARNATION FISH

![](texture-animated-fish)The strangest animal in the known universe! This fish likes to be eaten! There
have been cases of it jumping onto plates!

But there is more: when you eat one,
its prodigious memory remembers everything about you. Its memory is so good that
if you die at some later date, you will be reincarnated at the very place you
ate the fish, and you will even have its taste still in your mouth!

How a fish
can remember anything when it's been eaten has never been successfully
explained.

![](texture-fish_1)You must be very careful to check that the fish is
alive and wriggling as **dead fish decompose very quickly and it rapidly
turns so poisonous that a single lick can kill.**

### WARNING:

Even living reincarnation fish taste horrible!

> Head Over Heels Manual
`,C2=`## Install the game

**> This page also available with normal fonts: [on Github](https://github.com/jimhigson/head-over-heels-online/tree/main/src/manual/remake/installGuide.md)**

You can play the blockstack.ing Head over Heels remake from *any modern web
browser*: phone, desktop, or tablet.

However, It is **highly recommended** to **install the game** as a [P.W.A.](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

----
## Chrome / Chromium

On: **Mac**, **Windows**, **Linux**, **Chromebooks**, **iphone**, or **Android**

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* To the right of the address bar, click the **install icon: **. It might also look like a 'download' icon.
* In the dialog, choose *install*
* **Head over heels** is now installed as an app!

----
## iphone / ipad Safari

To install:

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Tap the **share button **
* The share button is at the bottom of the screen for phones in portrait, or to the right of the address bar on ipad or phones in landscape
* Choose **Add to Home Screen **
* **Head over heels** is now available on your home screen!

----
## Mac Safari

* Go to [blockstack.ing](https://blockstack.ing) if youre not there already
* Click the **share button ** to the right of the address bar
* Choose **Add to Dock **
* **Head over heels** is now installed on your mac
* If you dont want to keep the game in the Dock, right-click the doc icon and uncheck **Options  keep in doc**. It is still available in Applications

---

## Firefox 

* Firefox doesn't support PWAs out of the box, but there is a [browser extension](https://addons.mozilla.org/en-US/firefox/addon/pwas-for-firefox/).
* Probably easier to play in the browser until Mozilla adds support`,P2=`## Supported platforms

Almost anything with an up-to-date browser can play

Heres some Ive tried:

* **Linux** - install using Chromium. Play in-browser using Chromium or Firefox
* **Mac** - install using Safari or Chrome. Play in-browser using Safari, Chrome, or Firefox
* **Windows** - Chrome works for installed and in-browser play. Edge not tested but should work
* **iPhone** - in-browser play works, but there is no way to go full-screen - installing as a an app is better. 60fps cap in Safari. Turning on [Guided access](https://support.apple.com/en-gb/111795) is recommended for gaming.
* **Android** - Default browser has *excellent* PWA support
* **Raspberry Pi** - Pi 5 gets 45-60fps with Chromium and Firefox; 30 in busier rooms.
* **Apple watch** - Not really playable, but it runs if you message yourself the link to open it on the watch!
* **ZX Spectrum** - Currently untested`,E2=`## SAFARI

![](texture-monkey_right?float-left&relative&z-topSprite)![](texture-homingBot?float-left&clear-left&relative&bottom-bottomStackPullup)![](texture-elephant_towards?float-right&relative&z-topSprite)![](texture-homingBot?float-right&clear-right&relative&bottom-bottomStackPullup)A densely vegetated planet, mainly used for hunting.

The natives live in wooden forts in the jungle, **beware traps!**

> Head Over Heels Manual`,T2=`## SPRINGS

![](texture-animated-once-spring_bounce)Jumping from a spring will give extra height to your jump.

> Head Over Heels Manual
`,R2=`## SWITCHES

![](texture-animated-switch)Simply push the switch to switch things off and on!

Switching a deadly monster off will make them no longer deadly to touch. Push them or jump on them to reach new areas!

This varies from the original Head over Heels game, where disabled enemies remained deadly.

> Head Over Heels Manual, revised for remake
`,M2=`## SWOP KEY

If Head is sitting on Heels, the swop key will, on each push, give you control
of:

* *1* Heels.
* *2* Head + Heels.
* *3* Head.
* *4* Head + Heels.

If Head is not on Heels, the swop key will, on each push, give you control of:

* *1* Head.
* *2* Heels.

At all times, the character(s) whose icon is lit is under player control. When
Head and Heels are joined together, all their abilities are combined.

> Head Over Heels Manual`,I2=`## Exalted Emperor:

![](texture-teleporter)Sire, I took the liberty of installing this teleporter 
to aid your magnificent return to the moonbase after the daily crown inspections.

![](texture-cyberman_towards)Supplies are running short of teleporters, so I set it up one-way
until more come in.
May I humbly suggest you teleport after inspecting the crown or his grace
will have a long walk (well, ride on a minions back) to get back here.

Of course, those two spies we threw in jail might try to use it to grab the crown and escape.
Just kidding, theyll never get this far!

*> Your humble minion*
`,j2=`## TELEPORTS

![](texture-teleporter)Standing on a teleport will activate its mechanism, which will sound a warning
siren. Pressing the *jump key* will cause you to teleport.

Not all teleports are two-way; some are linked in a chain.

> Head Over Heels Manual `,B2=`## THE EMPERORS GUARDIAN

![](texture-ball?relative&z-topSprite)![](texture-animated-bubbles_cold?relative&clear-both&bottom-bottomStackPullup)The guardian blocks the door to the throne room in Blacktooth castle. He is **very
dangerous**, and he *doesn't like doughnuts*.

Only a true hero may pass the guardian.

> Head Over Heels Manual
`,O2=`## THE GAME

![](texture-animated-heels_idle_right)![](texture-animated-head_idle_towards?float-right)Head and Heels have been captured, separated and imprisoned in the castle
headquarters of Blacktooth. Their cells contain keep fit equipment, including
a wall ladder that Head really must learn to climb.

![](texture-market_wall_fruits_left?bg-pureBlack)![](texture-moonbase_wall_window2_away?bg-pureBlack&float-right)Your job is to get them both
out of the castle and into the *marketplace* so they can join up again. From
there, the journey leads to *Moonbase Headquarters*, where you will have to decide
either to try to escape back to *Freedom* or to be a true hero and teleport to one
of the slave planets to search for its lost crown!

![](texture-crown_bookworld?clear-left)To overthrow the dictatorship on any of the slave planets would be a major blow
to Blacktooth and you could return to Freedom in glory. Of course, Blacktooth
would probably enslave them again eventually but it would slow down any
expansion plans for now.


![](texture-cyberman_towards?float-right&relative&z-topSprite)![](texture-animated-bubbles_cold?float-right&clear-right&relative&bottom-bottomStackPullup)The populace of Blacktooth are so heavily oppressed
that they would have to see all four of the slave planets revolt before the
Blacktooth crown could cause an uprising. ![](texture-animated-turtle_right)This of course would be the ultimate
accolade, and unfortunately, almost certain suicide.

> Head Over Heels Manual
`,ve=Object.assign({"./bag.md":h2,"./blacktooth.md":d2,"./bookWorld.md":f2,"./conveyorBelts.md":p2,"./credits.md":m2,"./crowns.md":g2,"./cuddlyStuffedWhiteRabbits.md":A2,"./doughnuts.md":y2,"./egyptus.md":x2,"./head.md":b2,"./heels.md":w2,"./hintsAndTips.md":q2,"./historyOfTheBlacktoothEmpire.md":v2,"./hooter.md":V2,"./hushPuppies.md":_2,"./penitentiary.md":S2,"./reincarnationFish.md":k2,"./remake/installGuide.md":C2,"./remake/supportedPlatforms.md":P2,"./safari.md":E2,"./springs.md":T2,"./switches.md":R2,"./swopKey.md":M2,"./teleportBack.md":I2,"./teleports.md":j2,"./theEmperorsGuardian.md":B2,"./theGame.md":O2}),Af={historyOfTheBlacktoothEmpire:ve["./historyOfTheBlacktoothEmpire.md"],theGame:ve["./theGame.md"],egyptus:ve["./egyptus.md"],penitentiary:ve["./penitentiary.md"],safari:ve["./safari.md"],bookWorld:ve["./bookWorld.md"],blacktooth:ve["./blacktooth.md"],head:ve["./head.md"],heels:ve["./heels.md"],reincarnationFish:ve["./reincarnationFish.md"],cuddlyStuffedWhiteRabbits:ve["./cuddlyStuffedWhiteRabbits.md"],hooter:ve["./hooter.md"],doughnuts:ve["./doughnuts.md"],bag:ve["./bag.md"],crowns:ve["./crowns.md"],teleports:ve["./teleports.md"],springs:ve["./springs.md"],switches:ve["./switches.md"],conveyorBelts:ve["./conveyorBelts.md"],hushPuppies:ve["./hushPuppies.md"],theEmperorsGuardian:ve["./theEmperorsGuardian.md"],swopKey:ve["./swopKey.md"],hintsAndTips:ve["./hintsAndTips.md"],credits:ve["./credits.md"],installGuide:ve["./remake/installGuide.md"]},z2={...Af,teleportBack:ve["./teleportBack.md"]},N2=/^##\s+(.*)$/m,D2=t=>{const e=t.match(N2);if(e===null)return"no title found";const[,r]=e;return r},lu=t=>{const e=t.source==="manual"?z2[t.pageName]:t.markdown,r=Rq();return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midGrey zx:bg-zxWhiteDimmed",onClick:H(Le)}),p.jsxs(ke,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyan text-shadow zx:text-zxBlack",onClick:H(Le),children:[p.jsxs("div",{className:gt("overflow-y-scroll h-full scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-midRed scrollbar-track-highlightBeige zx:scrollbar-thumb-zxCyanDimmed zx:scrollbar-track-zxCyan"),ref:r,children:[hr()&&p.jsx(is,{className:"pb-1"}),p.jsx(_e,{markdown:e})]}),p.jsx(Te,{className:"hidden",children:p.jsx(xr,{})})]})]})},$q=t=>{t.reincarnateFrom(xe.getState().gameMenus.gameInPlay.reincarnationPoint),xe.dispatch(xd())},F2="![](?sprite&texture-animated-fish&float-left)Ah, But you ate a Reincarnation Fish! Reincarnate?",L2=()=>{const t=On();return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midRed zx:bg-zxYellow"}),p.jsxs(ke,{className:"bg-white zx:bg-zxRed px-1",children:[p.jsx(F,{className:"sprites-double-height mt-1 mb-2 resHandheld:mt-0 text-redShadow zx:text-zxWhite",children:"Uh-oh! Game over."}),p.jsx(_e,{markdown:F2,className:"text-redShadow zx:text-zxWhite"}),p.jsxs(Te,{className:"text-lightGrey zx:text-zxWhite mt-1 resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",onSelect:()=>{$q(t)}}),p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"donotreincarnate",label:"Stay dead",onSelect:H(yd,{offerReincarnation:!1})})]})]})]})},U2=`![](texture-animated-head_walking_towards?float-right&mt-1)**off**: Original *two-tone* spectrum graphics

**on**: *16-colour* palette with colourised sprites`,H2="Play at the original **1x** speed, **1.2x (default)** or faster **1.5x** or **2x** speeds",$2=`pokes cant be set mid-game

**off**: *8* lives to start; extra life rabbits spread thinly through the game

*A true hero leaves this* **off**`,G2="everything to *select the keys* and other input settings",W2=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:H(Le)}),p.jsx(ke,{fullScreen:!0,className:`bg-white zx:bg-zxWhite pl-1 py-0 ${rf}`,children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 pr-1 min-h-full "+sf,children:[p.jsx(is,{className:"pt-half"}),p.jsx(F,{TagName:"h1",className:"ml-4 text-midRed zx:text-zxBlue sprites-double-height block",children:"Options"}),p.jsxs(Te,{className:"gap-y-half",children:[p.jsx(Y,{hintInline:!0,id:"controlOptions",label:"Controls",verticalAlignItemsCentre:!0,doubleHeightWhenFocussed:!0,onSelect:H(bt,"controlOptions"),hint:p.jsx(_e,{className:cr,markdown:G2}),leader:p.jsx("span",{className:`${Se} sprite texture-joystick sprites-normal-height zx:sprite-revert-to-white`})}),p.jsx(Y,{hintInline:!0,id:"sound",label:"Sound options",doubleHeightWhenFocussed:!0,verticalAlignItemsCentre:!0,onSelect:H(bt,"sound"),hint:p.jsx(_e,{className:cr,markdown:"footsteps getting annoying?"})}),p.jsx(Y,{hintInline:!0,id:"gameSpeed",label:"Game speed",doubleHeightWhenFocussed:!0,valueElement:p.jsx(tf,{className:"ml-auto",values:Bu,valueLabels:Bu.map(t=>`${t}`),value:ie(fd)}),onSelect:H(wC,void 0),hint:p.jsx(_e,{className:cr,markdown:H2}),verticalAlignItemsCentre:!0}),p.jsx(Y,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"colourise",label:"Colourise",valueElement:p.jsx(ks,{className:"ml-auto",value:!pd()}),onSelect:H(ur,"userSettings.displaySettings.uncolourised"),hint:p.jsx(_e,{className:cr,markdown:U2}),verticalAlignItemsCentre:!0}),p.jsx(Y,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"livesModel",verticalAlignItemsCentre:!0,label:" Lives poke",leader:p.jsx("span",{className:`${Se} sprite texture-whiteRabbit sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(_e,{className:cr,markdown:$2}),valueElement:p.jsx(ks,{className:"ml-auto",value:ie(Yx)}),onSelect:H(ur,"userSettings.infiniteLivesPoke"),disabled:_n()}),p.jsx(Y,{hintInline:!0,leader:p.jsx("span",{className:`${Se} sprite texture-doughnuts sprites-normal-height zx:sprite-revert-to-white`}),doubleHeightWhenFocussed:!0,verticalAlignItemsCentre:!0,id:"infiniteDoughnutsPoke",label:" doughnuts poke",valueElement:p.jsx(ks,{className:"ml-auto",value:ie(Qx)}),onSelect:H(ur,"userSettings.infiniteDoughnutsPoke"),disabled:_n()}),p.jsx(Y,{hintInline:!0,doubleHeightWhenFocussed:!0,verticalAlignItemsCentre:!0,id:"showFps",label:"Show FPS",valueElement:p.jsx(ks,{className:"ml-auto",value:ie(W1)}),onSelect:H(ur,"userSettings.showFps"),hint:p.jsx(_e,{className:cr,markdown:"frames-per-second shown during gameplay"})}),p.jsx(Y,{hintInline:!0,doubleHeightWhenFocussed:!0,id:"emulatedResolution",label:"Emulated resolution",onSelect:H(bt,"emulatedResolution"),verticalAlignItemsCentre:!0,hint:p.jsx(_e,{className:cr,markdown:"see more of the room by choosing a higher resolution to emulate"})}),p.jsx(Yn,{})]})]})})]}),Y2=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-pureBlack zx:bg-zxBlack"}),p.jsx(ke,{className:"bg-pureBlack w-zx h-full block p-0",onClick:H(Le),children:p.jsxs("div",{className:"flex flex-col gap-3 items-center",children:[p.jsxs("div",{className:"flex gap-7",children:[p.jsxs("div",{className:"flex flex-col gap-y-oneScaledPix items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-animated-head_idle_right hover:texture-animated-head_walking_right relative z-topSprite"})]}),p.jsxs("div",{className:"flex flex-col items-center me-1",children:[p.jsx("span",{className:"sprite texture-crown_blacktooth zx:sprite-revert-zxYellow"}),p.jsx("span",{className:"sprite zx:sprite-revert-zxYellow texture-heels_walking_towards_2 hover:texture-animated-heels_walking_towards relative z-topSprite"})]})]}),p.jsxs("div",{className:"flex flex-col gap-1 items-center text-lightGrey zx:text-zxCyan",children:[p.jsx(F,{children:"The people salute your heroism"}),p.jsx(F,{children:"and proclaim you"})]}),p.jsx(F,{className:"text-highlightBeige sprites-double-height",classnameCycle:["text-pink zx:text-zxMagenta","text-metallicBlue zx:text-zxCyan","text-highlightBeige zx:text-zxYellow"],children:"EMPEROR"}),p.jsx(Te,{className:"hidden",children:p.jsx(xr,{})})]})})]}),Q2=()=>{const t=ie(r=>r.gameMenus.gameInPlay.reincarnationPoint!==void 0),e=On();return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midRed zx:bg-zxYellow"}),p.jsx(ke,{className:"bg-white zx:bg-zxRed px-1",children:p.jsx(Ls.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 items-center h-full",children:[p.jsx(F,{className:"sprites-double-height resHandheld:mt-0 text-midRed zx:text-zxWhite",children:"Quit the game?"}),p.jsxs(Te,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-midRed zx:selectedMenuItem:text-zxYellow resHandheld:!gap-y-1",children:[p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"no",label:"Back",leader:p.jsx("span",{className:`${Se} sprite texture-head_walking_awayLeft_2 selectedMenuItem:texture-animated-head_walking_towardsRight sprites-normal-height zx:sprite-revert-to-white`}),onSelect:H(Le),hint:"Back to the game",verticalAlignItemsCentre:!0}),t&&p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"reincarnate",label:"Reincarnate",leader:p.jsx("span",{className:`${Se} sprite texture-fish_1 selectedMenuItem:texture-animated-fish sprites-normal-height zx:sprite-revert-to-white`}),onSelect:()=>$q(e),hint:"Go back and continue from the last reincarnation fish you ate",verticalAlignItemsCentre:!0}),p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"yes",label:"Quit",onSelect:H(yd,{offerReincarnation:!1}),leader:p.jsx("span",{className:`${Se} sprite texture-bubbles_white_1 selectedMenuItem:texture-animated-bubbles_bounce_white sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(_e,{className:"zx:[&_.strong]:text-zxYellow",markdown:"**Warning!** This game will end!"}),verticalAlignItemsCentre:!0})]}),p.jsx(xo,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},K2=({pageName:t})=>{const e=Af[t],r=D2(e),s=Pt()==="desktop";return p.jsx(Y,{id:`markdown/${t}`,label:r,onSelect:H(bt,`markdown/${t}`),doubleHeightWhenFocussed:s})},X2=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-midGrey zx:bg-zxCyan",onClick:H(Le)}),p.jsx(ke,{tall:!0,className:"bg-highlightBeige zx:bg-zxCyanDimmed max-h-[calc(var(--block)*40)]",children:p.jsxs("div",{className:`text-redShadow zx:text-zxWhite ${qe} !gap-y-0 selectedMenuItem:text-shadow zx:selectedMenuItem:text-zxBlack overflow-y-scroll scrollbar scrollbar-w-1 pl-1 scrollbar-thumb-moss scrollbar-track-highlightBeige zx:scrollbar-thumb-zxBlack zx:scrollbar-track-zxCyanDimmed `,children:[p.jsx(is,{className:"mb-1"}),p.jsxs("h1",{className:"text-moss zx:text-zxBlack mx-auto flex flex-row justify-center items-center w-full mb-1",children:[p.jsx("span",{className:"sprite texture-book_x zx:sprite-revert-to-white sprites-normal-height"}),p.jsx(F,{className:"sprites-double-height mx-1",children:"Read the manual"}),p.jsx("span",{className:"sprite texture-book_y zx:sprite-revert-to-white sprites-normal-height"})]}),p.jsxs(Te,{children:[[...Ke(Xh(Af)).map(t=>p.jsx(K2,{pageName:t},t))],p.jsx(Yn,{})]})]})})]}),J2=()=>p.jsx(Oe,{children:p.jsxs(ke,{className:"!h-min !w-max text-center p-0 bg-transparent",onClick:H(Le),children:[p.jsx(F,{className:`${qe} text-zxRed block w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You dont go towards the light"}),p.jsx(F,{className:`${qe} block text-zxYellow w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"You have a horrible taste in your mouth"}),p.jsx(F,{className:`${qe} block text-zxGreen w-24 mx-auto px-1 sprites-double-height bg-zxBlack py-oneScaledPix`,children:"You have reincarnated!"}),p.jsx(F,{className:`${qe} block text-zxCyan w-24 mx-auto px-1 bg-zxBlack py-oneScaledPix`,children:"Everything is back to how it was when you ate the fish"}),p.jsx("span",{className:"sprite mx-auto  bg-zxBlack texture-animated-fish sprite-revert-to-white"}),p.jsx(Te,{className:"hidden",children:p.jsx(xr,{})})]})}),ui=94e3,iy=(t,e)=>t*160+e*1e4,Z2=[{upToProportion:8e3/ui,label:"beginner"},{upToProportion:2e4/ui,label:"novice"},{upToProportion:3e4/ui,label:"spy"},{upToProportion:55e3/ui,label:"master-spy"},{upToProportion:84e3/ui,label:"hero"},{upToProportion:1,label:"liberator"},{upToProportion:1/0,label:"completionist"}],eD=(t,e)=>{const r=t/e;for(const{upToProportion:s,label:n}of Z2)if(r<s)return n;return"completionist"},tD=()=>{const t=Jx(),e=ie(K1),r=ie(({gameMenus:{gameInPlay:{roomsExplored:a}}})=>qu(Ke(Or(a)))),s=iy(r,e),n=qu(ox(t.rooms)),i=iy(n,5),o=eD(s,i);return p.jsxs(p.Fragment,{children:[p.jsx(Aq,{noSubtitle:!0,className:"resHandheld:hidden"}),p.jsx(F,{classnameCycle:Pr,className:"mt-2 resHandheld:mt-3 block text-center mx-auto sprites-double-height",children:o}),p.jsxs("div",{className:`contents ${qe}`,children:[p.jsxs(F,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-highlightBeige zx:text-zxYellow",children:["Score ",s.toLocaleString()]}),p.jsxs(F,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-pink zx:text-zxCyan",children:["Explored ",r," / ",n," rooms"," ",`(${(100*r/n).toFixed(1)}%)`]}),p.jsxs(F,{className:"mt-2 resHandheld:mt-1 block text-center mx-auto text-lightGrey zx:text-zxWhite",children:["Liberated ",e," planets"]}),p.jsx(Te,{className:"hidden",children:p.jsx(xr,{})})]})]})},rD=()=>p.jsx(Oe,{children:p.jsxs(S.Suspense,{fallback:p.jsxs(p.Fragment,{children:[p.jsx(Ue,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(ke,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed h-full block"})]}),children:[p.jsx(Ue,{className:"bg-metallicBlue zx:bg-zxCyan"}),p.jsx(ke,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed w-zx h-full block",onClick:H(Le),children:p.jsx(tD,{})})]})}),sD=()=>{const t=ie(tC),e=ie(rC);return p.jsxs(p.Fragment,{children:[p.jsx(Ue,{className:"bg-lightGrey zx:bg-zxRedDimmed",onClick:H(Le)}),p.jsx(ke,{fullScreen:!0,className:`bg-white zx:bg-zxWhite py-0 pl-1 ${rf}`,children:p.jsxs("div",{className:"flex flex-col gap-1 overflow-y-scroll scrollbar scrollbar-w-1 min-h-full "+sf,children:[p.jsx(is,{className:"pt-half"}),p.jsx(F,{TagName:"h1",className:"ml-3 text-midRed zx:text-zxBlue sprites-double-height block",children:"Sound Options"}),p.jsxs(Te,{children:[p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"mute",label:"Mute",valueElement:p.jsx(ks,{value:t}),verticalAlignItemsCentre:!0,onSelect:H(ur,"userSettings.soundSettings.mute")}),p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"footsteps",label:"Footstep sounds",valueElement:p.jsx(ks,{value:!t&&!e}),verticalAlignItemsCentre:!0,onSelect:H(ur,"userSettings.soundSettings.noFootsteps"),disabled:t}),p.jsx(Yn,{})]})]})})]})},nD=`##*HoH-ed * The Level editor
I built an *editor* so I could make the **sequel levels**

![](texture-headlessBase?float-left)**Make puzzles**!

*Challenge* others to **solve them**!

**in beta**; expect occasional crashes and *frequent confusion*`,iD=()=>{const t=S.useCallback(()=>{window.location.href="/editor/"},[]);return p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-pureBlack zx:bg-zxBlack",onClick:H(Le)}),p.jsx(ke,{className:"bg-shadowHalfbrite zx:bg-zxBlack px-1",children:p.jsx(Ls.Provider,{children:p.jsxs("div",{className:"flex flex-col gap-y-2 mt-1 h-full",children:[hr()&&p.jsx(is,{className:"text-midGrey zx:text-zxWhite"}),p.jsx("div",{children:p.jsx(_e,{className:"text-midGrey zx:text-zxWhite",markdown:nD})}),p.jsxs(Te,{className:"text-lightGrey zx:text-zxWhite resHandheld:mt-0 selectedMenuItem:text-metallicBlue zx:selectedMenuItem:text-zxCyan resHandheld:!gap-y-1",children:[p.jsx(Y,{doubleHeightWhenFocussed:!0,id:"yes",label:"Edit the levels",onSelect:t}),hr()||p.jsx(xr,{customLabel:"Im scared, go back"})]}),hr()||p.jsx(xo,{className:"text-midGrey zx:text-zxWhite resHandheld:hidden"})]})})})]})},oD="2924c962-99f1-4dd2-9b9c-fef832dc991b",aD=t=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"bg-metallicBlueHalfbrite zx:bg-zxRed",onClick:H(Le)}),p.jsx(ke,{tall:!0,className:"bg-metallicBlueHalfbrite text-highlightBeige zx:bg-zxRed gap-y-2 resHandheld:gap-y-1 overflow-y-scroll",children:p.jsxs(Ls.Provider,{children:[p.jsxs("div",{className:"flex flex-col gap-2",children:[hr()&&p.jsx(is,{className:"text-highlightBeige"}),p.jsx(F,{className:"text-midRed zx:text-zxYellow sprites-double-height pl-4",children:"Select which game"})]}),p.jsx("div",{className:"zx:text-zxCyan selectedMenuItem:text-white resHandheld:mt-half flex flex-col gap-1",children:p.jsxs(Te,{className:"gap-y-1",children:[p.jsx(Y,{id:"originalGame",label:"original remastered",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:H(Fi,{campaignLocator:ZO}),leader:p.jsx("span",{className:`${Se} sprite texture-head_walking_right_2 selectedMenuItem:texture-animated-head_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(_e,{className:"text-lightGrey sprites-normal-height",markdown:"remaster of the **300-some** rooms from the original game"})}),p.jsx(Y,{id:"remake",label:"Sequel",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:H(Fi,{campaignLocator:{userId:oD,campaignName:"sequel",version:-1}}),leader:p.jsx("span",{className:`${Se} sprite texture-heels_walking_right_2 selectedMenuItem:texture-animated-heels_walking_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(_e,{className:"text-lightGrey sprites-normal-height",markdown:`unofficial; **work in progress**

the story continues **38 years later**: All-new levels designed for the remake`})}),p.jsx(Y,{id:"community",label:"Community contributed",doubleHeightWhenFocussed:!0,hintInline:!0,onSelect:H(bt,"communityGames"),leader:p.jsx("span",{className:`${Se} sprite texture-charles_right sprites-normal-height zx:sprite-revert-to-white`}),hint:p.jsx(_e,{className:"text-lightGrey sprites-normal-height",markdown:"check out what people have made in the editor"})}),p.jsx(Yn,{}),hr()||p.jsx(xr,{})]})}),hr()||p.jsx(xo,{className:"text-highlightBeige zx:text-zxCyan text-center max-w-32 mx-auto"})]})})]}),lD=t=>t.startsWith("markdown/"),cD=t=>{const e=ie(r=>r.gameMenus.openMenus.at(0));if(e===void 0)return null;if(lD(e.menuId))return e.menuId==="markdown/inline"?p.jsx(lu,{source:"inline",markdown:e.menuParam.markdown}):p.jsx(lu,{source:"manual",pageName:e.menuId.slice(9)});switch(e.menuId){case"communityGames":return p.jsx(EI,{});case"controlOptions":return p.jsx(nO,{});case"crowns":return p.jsx(lO,{playMusic:e.menuParam.playMusic});case"emulatedResolution":return p.jsx(hO,{});case"errorCaught":return p.jsx(gO,{errors:e.menuParam});case"hold":return p.jsx(yO,{});case"inputPreset":return p.jsx(bO,{});case"installGuide":return p.jsx(lu,{source:"manual",pageName:"installGuide"});case"mainMenu":return p.jsx(PO,{});case"map":return p.jsx(u2,{});case"modernisationOptions":return p.jsx(W2,{});case"offerReincarnation":return p.jsx(L2,{});case"proclaimEmperor":return p.jsx(Y2,{});case"quitGameConfirm":return p.jsx(Q2,{});case"readTheManual":return p.jsx(X2,{});case"reincarnatedRestart":return p.jsx(J2,{});case"score":return p.jsx(rD,{});case"sound":return p.jsx(sD,{});case"sureWantEditor":return p.jsx(iD,{});case"whichGame":return p.jsx(aD,{});default:return e.menuId,p.jsx(ke,{children:p.jsx(F,{children:`unknown dialog ${e}`})})}},uD=so(()=>gr(()=>import("./gameMain-BhKMnCrr.js").then(t=>t.g),__vite__mapDeps([9,7,4,1,2]))),hD="data:audio/mpeg;base64,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",dD="/assets/bonus-CvVo342Z.mp3",fD="/assets/bubblesLoop-B_LY362Z.mp3",pD="/assets/conveyorLoop-CF-OA6qJ.mp3",mD="/assets/conveyorStart-CcCK4MGd.mp3",gD="/assets/conveyorStop-D5zeg8cv.mp3",AD="/assets/destroy-CZDN4Ktz.mp3",yD="/assets/detect-D_kRR5uD.mp3",xD="data:audio/mpeg;base64,SUQzAwAAAAABZlRZRVIAAAALAAAAMjAxOS0wNy0yMlREUkMAAAALAAAAMjAxOS0wNy0yMlRJVDIAAAARAAAASGl0IEdsYXNzIEJvdHRsZVRBTEIAAAAlAAAAR2xhc3MgRXNzZW50aWFscyBmb3IgU291bmQgRGVzaWduZXJzVFJDSwAAAAQAAAA3OTdDT01NAAAAKAAAAAAAAABIaXR0aW5nIEdsYXNzIEJvdHRsZSwgU2luZ2xlLCBDbGlua0NPTU0AAAAoAAAAWFhYAEhpdHRpbmcgR2xhc3MgQm90dGxlLCBTaW5nbGUsIENsaW5r//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAOAAAJ3QBLS0tLS0tLZWVlZWVlZXR0dHR0dHSBgYGBgYGBjo6Ojo6Ojpqampqampqnp6enp6entLS0tLS0tLTAwMDAwMDAzc3Nzc3Nzdra2tra2trm5ubm5ubm8/Pz8/Pz8/////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAXAQQABuAAACd1hx+LLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uwxAAAA5wBYfQAACIEmGp/N6ABmZYgAzErrwAAAfB8cQKLB83lwfD5c+X6w/BM/y8XQAAAAAAABkLQ3wlAAAAEQCwAwww0+WFa3dKgv4UAX3JSIKgDXzlh5HA2onSwloqV6WFcNjBcHO5I/A2nao/IO7QNDrL5DEV7sGilCECu5N2ZdD6x5VWsTCGjFa9mHHFiEu5P37Hf9oTWJXUhuJbi0f3jf/////Kx/6w1IqXWNbDPhkACAABbeAAglG0QILxOnB7jM6izYniEZDiombEIbu2UDNAsCoiDAR8RMrHzFdtSTKSlIhwndIvEFQJoni8dPVGKK060UeUVmT39aE/l8mXwVKPLZsuYARADU+sYvG5LsvtYZ1nAN6GjBlThtPbQ41qaNRKnLBREVTK3U1235+UqDZrLmni127D6GP7hQP7esoGjUNUiyqt5YQVQCibgADqFMeHg1YBC+v1Uf8WImfCX2fb7uOELxKpF7Zo0YMEJXiHq9QV1GuBcuGQ1oIy1R5Yyaq4EFYAiXvMoZmtw887IpW1j30JKl6XVIj/aMvP6BTW7aIDIRXh8oxbkyFCdKLvuxAmEf7gAACUdZaUJZc/MUygMRlgX4rXomhjhgAI61iUMeob/9VyliVmmGAHcGncdaLpwYClXWFmpAllZeRCMRufXVZ9fSZpuIF6SzMlVALqhB5WdwAAAKqjzk1H9osoBA0+eS2xDa9B7PvtMmf9YBVVYZdVwAMnzjOLOixgcJ+o4iHkTm4Ghzqw+dUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVQC6tguqngAAACpVR4j+BDEUApT/+1DE34BKpKlb/YkAIQkVa32VnlRNmgn05U6qyId3/pItAN3GDc4OCrmmUNA+BOcus1KXqDolTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAJiVCAgAAACCtZrSkAaFXbQN8xwByrKrBKAC3GVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUAWg0A//sgxPEAR1hjU+ZgpaC5CGo9l5WUPFJEWDoMAGAGAMAKSkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoEAAWFJYIvgAC3XiY3TEFNRTMuMTAwqqqqqv/7EMTzAMVIXVvg4QNgk4hpOBykZKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqoAMAAAg8N5aA1MQU1FMy4xMDCqqqqq//sQxPSARBQ/T+BhIyBviCq8B6hsqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpRlYUFXUxBTUUzLjEwMFVVVVX/+xDE8IDEAEFT4D0jYFMGK7gEoG1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUF9aTEFNRTMuMTAwqqqqqv/7EMTkgMIYG0/ACYJgMQOo0AQsXaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy4xMDCqqqqq//sQxN6AwTwdQIAFZGgaA6jgACQeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjEwMKqqqqr/+xDE3IHA5B82oAGA8BeDp1AAPByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTag8D4HTUAKeggBQNmQAAcJKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNiDwFAdKACB4SAJg6WAECQkqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDE14PALBsuAIBBIAUAZoAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/7EMTWA8AAAf4AAAAgAAA/wAAABKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//sQxNYDwAAB/gAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",bD="/assets/headFall-rxdxTCeK.mp3",wD="/assets/headJump-GCHlCfni.mp3",qD="/assets/headWalk-B5kQ4tvC.mp3",vD="/assets/heelsFall-IsGtipMw.mp3",VD="data:audio/mpeg;base64,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",_D="/assets/heelsWalk-Bmk6WOTI.mp3",SD="/assets/helicopter-BYGzJTF2.mp3",kD="data:audio/mpeg;base64,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",CD="/assets/hushPuppyVanish-CZOUg83F.mp3",PD="data:audio/mpeg;base64,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Jua1SIdWdaWZ7+3Z7eWYEQU4VAXcl3izAQDAQCAYEA7wGviBAo+OjXyI6D38AUeGw29Qd//7CoAYEAQDAQEAAAAAAgItfBWiR8eJV4CgD4FUv4iYy//7cEToABISJVfR7Bm6P0J6/THoCwhwmV9MMGWhBg+r9YYMdP4kHg834qd/10xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2BE7wACPypWbTygCEPFSr2njAED8E04mKOAAJsMJ7MaUABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xBk3Y/wAABpBwAACAAADSDgAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",ED="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAEAAAHVQCSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpK2tra2tra2tra2tra2tra2tra2tra2tra27e3t7e3t7e3t7e3t7e3t7e3t7e3t7e3t7f////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJATpQQABuAAAB1VdJF2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vQxAAABxQBZfQAACPjQav/MUAAAAEShDM7J7pnHA+fECjgDPlAfB8Hz5c+UBDg+fLh/6gxigIf+D//5c35QEHFwfeIDmD8uH///+CAAAkwmpRB0hs1kTclhaJSJjSFpGr7DzDheqXqq6EC8wWUHFZcuhXpdpduxAAvg2bLwYzAeCD9B9B8YRFABSQBgopAZoh47yaIiO4MgihA6YQuOwdBJigxPAog4yGkSJ4iRASySgncgRuxTWo4ekDL50jRgjklIlSVIcaFIxLxGE6RNKT5EikdMDpwiw7i8XCdJshhFCoyZmmWC8Ym6loMkRqEvIIGaZHIktYyLhoaHGOqMECbMluYsWDFZ5EpIqdu6SzhbROF8mygThoZpHDQgZMn0zBZDjpiampeLJmaKU6jWaT5QJg6cIkVCJrKDU////7If///5maqA0aFdlVa5E0QslGN4UBj7Kg9SmJ+lC/GOeJ1JVVRg+AKHzAtEguIqRd5otUltoPNZlypGiIcNo7ZB+OFho4WvaYqPWomGkZbTxPqk0090dVfSxawrTNPxbLHx6VHTLXPX/1Es6RMMs/P/vfz/czLW/W6H3U/FssTCTLm2AJHBCCcIysaPY400CQEOIkKwDK4ehyIqsdWUTY8nCsxBUdeIkszUXA7ebUglyQaNlgKCs6WDSbizxK4We0t90JPcwRXaFg0pVNnv8f7PnRgNKyx5HtW6AYQZXiFdCcckjTXx8lxfljcC8s5YYyhYZHNILmd8LEBLVzUzyMyRkU0NhIiUOLBVLRzjz0A4jCQOyx4JNSLOTET89YxvCS5IW2uZ0emWsQx+8CwVvPFkqBoCB2SlWUWERlOzNugAAAABajznzQcoBnPkxJEqqceWTHEY7UxwMAAt4yYMFh8uRwkFB+pskpBDQMUwj7JSQY5n8daUxWqIfR0mU3H8o00yry0km1XMcRSsQmvVKGqalYFn3OB0uocR5CrCa4ahVCzTD528xf534Vv7WzX////1rnNNe+Pmv8lbZ////xv+lsY3m+d+2dQdW/9t////4+M/Xzjy+2961v/7r64rjdszVkf/8x//XVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVf/7UMT+AA/lk3H89AApUonsvPYYaFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVapFiGAAEwNgPCMqZWrToKnYlHncN/ywcET4iUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+3DE8YAK+Fdd9PGAAtayKn8y8EhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxOODw1gRMTzAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",TD="data:audio/mpeg;base64,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v//7MMT6AAkw+XHnmEzhKJ8stMSJdSs8K0xBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7QMTzgAkcVW/mFHChNZWsvPQNpFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//swxPiACES5ZeeUbmEPGqv+nnAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sQxPKABxyHT7jWgAAAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",RD="/assets/metalicScraping-BqmM5ys4.mp3",MD="/assets/mojo-D9S1pz9n.mp3",ID="/assets/robotBeepingLoop-Cz0TGwJH.mp3",jD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAFAAAHBgCHh4eHh4eHh4eHh4eHh4eHh4eHpKSkpKSkpKSkpKSkpKSkpKSkpKTBwcHBwcHBwcHBwcHBwcHBwcHBwdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ//////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAM2QQABuAAABwbVZvomAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAACbQNZ7QwACnxFem3NvABAAAb/0m/2/DnECCBGAgAAHfHfAVjn/mAGf+YeHv9AI/9/mHh4AAAAABh4eHj3Sf6MPH////7zDw8PAAAAAAMPDw8PAAAAAFY4ef4AAAAAACAJLlcmslzaAAAAA2dhA8cuNgUzOZEQCemOB48SmLBSXoBIB4bRWLmodWkIyM3KQbxTk5MgkxYg5TEmKcVImoNot5fXBIMZ6wUILqZqPRipgksX3ycRsY3WhpPFfXD9wjP2WCzWi4Z9M1lU4rrEJyfbg4tf5nlSFyl9BDltdXPvf+ALefotw91Kg4XKLrKnrM7XFKkPlm0r62lQG0SkaIee1fdc3yedKObrKqLVO1Tt+09AQj4eK79+e/bVR/unc8uLTcn34t3eGbDHckkUd3K0+q+QaU3nU3EvM2q0GCgoYcv1QP5+7LldGULYTd9qYJKpfHTDNTWlWkCVxEXsA0NJe8kpbGX1Q1lrpG7f/wAFfElzwgk5nDf0u0JoQI2sRE3BsCSljdGmx70Q5Yg/U20rsJ0NItx4T1FXM2t7V2/dZ76daq/iuwEHOUVVLy7f8AGSoqMcpzEIGFVQPIdxGC1g8eyzUJPB/m+Vs40oU0Ln1rchVwreG7jwtkrzwk2XyO1OjltCtYM8yWuSW38AFFsUh7NgmT2ISQn6LxK5lZATETo/wgKuhIPbwWTCUA+ZF4ZAKFIVcWqQvTeka0Plby4pSVnEKmgzDXm45rtwAUOrrpafToPNcaq3bO4tWy+kVpIIrlC3c+YfE4bc9y8bUa2N0mmqfTltWw+ALkINOReTXarVeRKPhu81QCgSjCUVpZ2R/d7LQIAgAAESQ6DJhyCwQEJtFbpvkLRAB6vDAgDTBYBzU1CDEMllappkMZMWwCMNhdXkshDm11YEBBJYB5BLIsRiSvE0FyqJQbB1edgF+H3iZhEhOTOBh3ebtKNyZ/40/D/Qw//+zDE/gBJ6HVjvYWAKPOObHWGCVwKxYYhmDMqGV0sjpqeHI3F5XTO1EpE6NWHdd33HPcYpoxbkErn9b1lrtX/////+vlSZWM7FcLhJQUAvy5QGCQfCwlYIiJ07/dd0KUFAKVYWZ////50YkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+zDE+wAH+IllqLyhqPyJrL0nrByqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+yDE/wAH8EtjrDxjoQyNbHawYASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//tQxPQAGFTpVfncAEAAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==",BD="/assets/rollingBallLoop-BUA084C_.mp3",OD="/assets/servosLoop-Bn-haKck.mp3",zD="/assets/servosStart-BgsySGJF.mp3",ND="/assets/servosStop-BR1i0gi5.mp3",DD="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAF6QCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+f///////////////////////////////////////////8AAAAoTEFNRTMuMTAwBKUAAAAAAAAAABUgJAV6QQABuAAABel6uP7WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vAxAAAB9gRZfRgACKqmyl/OYAAAAACI1hbN7r+CemAgACCCAZB8Hwfh/WUBAEAQdggCBcP8Hwf/ggCAYqdlAfD/5AHwff/1AMHwfD8EAQd+CBwAABI1kyRERCWqKVtkgAAA42djFAiNzBQIMQVI5g8aESdUUGkKkOYLCLOCAIGDwArAKAEs8YnDjqLFfhp8lYiODUwghOhrcCurDOSqLUCcyJMM6gPOkeWXTqE5Dk8TaQBI4eiVFWfSch+awwo7sVp5ZG/mv7elVHPw9ekbceU0ip6acrW8MM7E1S3dc1S4WsOZR6/rlcJg4Lzjq0lgLOVCDBIs9nWE0JGbalKA4KIWpSZSJSZv5tDYAAAAPtilTj7SsKZLpm1EpwZwFwYMrkoFPLeJQBYhjQGt9ThSgC2YBdx6EqWEliGKgWRZVRkPUOUCVVR9iyo4vy5gkvMUt5IxbiFNJ+KZrVapeSTt+LVkz6x6PN18lcyxY2czxs41/S+cZ39/+vvPJC7Ve/tEClDL/+CxV6RzS3//SIQDni4i2eXeVYLhGAAAAAAAfmqMy0mLmhWDlAyyLqppdsjlLcX8YA2k7EnTAJDPLFYTz4nr46zX4cZMGHUOZmZabfv0bK7MqAhh4bf1UxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+2DE7gAR8MtP+beQATGN6z8ywkBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+xDE1gPAAAH+HAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",FD="data:audio/mp4;base64,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",LD="/assets/jetpack-loop-1-XbLJ84YF.m4a",UD="/assets/wind-swoosh-short-289744-DGaM3j04.mp3",HD="/assets/spring-CP3uOhml.mp3",$D="data:audio/mpeg;base64,//OAZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAErwBDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr///////////////////////////////////////////8AAAAyTEFNRTMuMTAwBG4AAAAAAAAAADUIJAL7LQABwgAABK//PX1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zkGQAAcwDIACgAAAAAAP8AUAAAP/////////8pD6nHC7yChYKxXdLXLLlcpVcZRKfNIh3joGTm+AAOhvljbRkUtWRrLKfwzRbh9MTGzzP/7BT6LoXH//vG3L5icqgAEIwyGpkSP5f9LCJ6HHUlfbAJYmDMBYOFzaizvh1veOO8cauf4f/f7TmWIOil+DQJftXDPAMIaNZ/X///lQQ45kPMEWZFmWKQgeHHUlZKLNqtNMVCz4KJTUMwq6AiE0ukL1iLKAiZokGW/ypt41ast1Vx7hvt/mcvqc5n3/+BRZmY4UvwzxYCBjREFMkv3LUtX+zgMFFBUyofH9Sr/y/9fjjrLKx/P/z4GThI33zdy/F6JBFQ77e/5jSQO3bcXw+KV+93n3du/zMaAsOSQApEeTGkNFWALiDZnQxIxVqar4ZgpCUJAGUJfJ6tO3jS/jW1KpdbawqaQiIihLZZK5VKXTKXCmv00y1vGxeaWSpx+tLAesCj/GDpc7hl3JhyxKT3jk8lp+DnAAYCMedrU1M8lukvAqaOgEywc4/8tVopLI/FxACHQYRlNCLM0iyy1/yeOuPCoy09e50Wh7CBMvNSgIqpjkxiqm/7/5fLKe3/56sWDKGx4kn214uwHD2QJpgYjl394///Xt2JXPw5H377dl9qlMiNV0EgzNCzmoTEiDeBiIUalUdokZsGYI4BjO8f//1l+sv+XxepYou2LH/z/7zNRYgDDAExYEOGruSrIhMPSZ/14K4eIVAqM//7/LL//////P/53DXM8////v///BTWIQztkEBiwQGhV/N+79JlLKSSVaSxabqH4dniAqgezyMJYFQVUDQwGioK8RA0CoKgry0FVgqdLHlA1BUqGs6Cp3EriJU6JQ1BpQNHip0ShqDRY9Ue4KlQVd/yx4RPWdgrUeUegrBVwiPCIOwVWCrix4RYiUHZVxUFYNKDv4lD+YjkSQaDiUq4RLDYlO4iDqCx4Gnhoso9UeDuIv1xEo9nuCv+CsFfy3UeT/8GlB1TEFNRTMuMTAwVVVVVVVVVf/zgGSlDKADQ4/gAAAL8AZZvcAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",GD="/assets/teleportIn-DZAhHW9-.mp3",WD="/assets/teleportOut-Bra-ABlh.mp3",YD="/assets/teleportWarningSiren-Boo1HoAB.mp3",QD="/assets/toasterPopUp-CNfTxQPs.mp3",cu=new window.AudioContext;let Xa;const le=async t=>{try{return await cu.decodeAudioData(await(await fetch(t)).arrayBuffer())}catch(e){if(navigator.webdriver===!0)return console.warn(`Audio decode failed for ${t} - running in automated browser`,e),cu.createBuffer(2,1,cu.sampleRate);throw e}},KD=so(async()=>({bonus:await le(dD),bubbleRobotLoop:await le(fD),carry:await le(UD),conveyorEnd:await le(gD),conveyorLoop:await le(pD),conveyorStart:await le(mD),destroy:await le(AD),detect:await le(yD),drum:await le(hD),glassClink:await le(xD),headFall:await le(bD),headJump:await le(wD),headWalk:await le(qD),heelsFall:await le(vD),heelsJump:await le(VD),heelsWalk:await le(_D),helicopter:await le(SD),hooter:await le(kD),hushPuppyVanish:await le(CD),jetpackLoop:await le(LD),jetpackTurnaround:await le(PD),landing:await le(ED),metalHit:await le(TD),mojoLoop:await le(MD),mojoTurn:await le(FD),robotBeepingLoop:await le(ID),robotWhirLoop:await le(jD),rollingBallLoop:await le(BD),servoLoop:await le(OD),servoStart:await le(zD),servoStop:await le(ND),softBump:await le(DD),springBoing:await le(HD),stepStoolScraping:await le(RD),switchClick:await le($D),toasterPopUpSoundUrl:await le(QD),teleportIn:await le(GD),teleportOut:await le(WD),teleportWarningSiren:await le(YD)})),XD=async()=>{Xa===void 0&&(Xa=await KD())},iU=()=>{if(Xa===void 0)throw new Error(`sounds not loaded - only call this from inside code 
      (like in a render loop) that is protected and only executed once 
      loading has happened`);return Xa},JD=["characterRooms","currentCharacterName","entryState","gameTime","progression","pickupsCollected","previousPlayable"],ZD=(t,e,r)=>{const s=Ah({saveTime:Date.now(),gameState:Oi(t,...JD),store:{gameMenus:{gameInPlay:e.gameMenus.gameInPlay}}});if(r){const{characterPickingUp:n,pickupId:i}=r,o=s.gameState,a=o.characterRooms[n];if(a===void 0)throw new Error("how are we saving from a pickup if the character picking up is not in any room?");const l=a.id;for(const c of Or(o.characterRooms))c.id===l&&Tq({room:c,item:c.items[i]})}return s},eF=()=>{const t=Zh(),e=Dh();S.useEffect(()=>{if(e===void 0)return;const r=()=>{Jh()||(t(bC(ZD(e.gameState,xe.getState()))),DM.flush())},s=()=>{document.visibilityState==="hidden"&&(t(eb("hold")),r())};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",r)}},[t,e])},tF=()=>{const t=ie(r=>r.gameMenus.assigningInput!==void 0),e=ie(r=>r.gameMenus.openMenus.length>0);dt({action:"menu_openOrExit",handler:S.useCallback(()=>{Jh()&&window.close(),xe.dispatch(wm())},[]),disabled:t}),dt({action:"menu_exit",handler:H(wm),disabled:!e}),dt({action:"toggleShowFps",handler:H(ur,"userSettings.showFps"),disabled:e}),dt({action:"hold",handler:H(eb,"toggle"),disabled:t}),dt({action:"map",handler:H(AC),disabled:t}),S.useEffect(()=>{const r=()=>{};return window.addEventListener("blur",r,!1),()=>{window.removeEventListener("blur",r,!1)}}),dt({action:"toggleColourisation",handler:H(ur,"userSettings.displaySettings.uncolourised"),disabled:t}),dt({action:"cycleResolution",handler:H(bd,void 0),disabled:t})},oy=(t,e)=>{xe.dispatch($x(dd(ll(xe.getState()),e)))},rF=(t,e)=>{const r=Zh();S.useLayoutEffect(()=>{oy()},[]),S.useLayoutEffect(()=>{const s=()=>oy(t,e);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[r,e,t])},sF=()=>(rF(),tF(),eF(),null),nF=()=>{const t=ie(fd),e=Dh();S.useEffect(()=>{e!==void 0&&(e.gameState.gameSpeed=t)},[e,t])},iF=tb(nF);class oF extends S.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("Error caught in DispatchingErrorBoundary:",e),xe.dispatch(Ad(Si(e)))}render(){return this.props.children}}const aF=()=>{const{cssUpscale:t,canvasSize:e,rotate90:r}=ie(U1);return{transform:r?`scale(${t}) rotate(90deg) translate(0, -${e.y}px)`:`scale(${t})`,width:e.x,height:e.y,transformOrigin:"top left"}},ay=t=>`res${t[0].toUpperCase()}${t.slice(1)}`,lF=()=>{const t=Y1(),e=ie(L1);S.useEffect(()=>{document.body.classList.add("overscroll-none","overflow-hidden","select-none",Pt())},[]),S.useEffect(()=>{document.body.classList.remove(...Object.keys(Fn).map(ay)),document.body.classList.add(ay(t)),document.body.classList.toggle("portrait-rot",e)},[t,e])},cF=S.lazy(_C),ly=so(()=>Promise.all([uD(),uM(),XD()])),uF=()=>{const[t,e]=S.useState(),r=_n(),s=ie(i=>i.gameMenus.gameInPlay.campaignLocator),n=Od();return S.useEffect(()=>{if(!r){e(void 0),window._e2e_gamePageGameAi=void 0,ly();return}let i=!1,o;return(async()=>{let l=!1;try{if(s===void 0)throw new Error("game is marked as running, but we have no campaign locator, no way to know which campaign to load");l=!0,xe.dispatch(gM());const[{default:c}]=await ly();xe.dispatch(Ng()),i||(o=await c(s,n),e(o),window._e2e_gamePageGameAi=o)}catch(c){l&&xe.dispatch(Ng()),console.error(c),xe.dispatch(Ad(Si(new Error("error in loading game assets or state",{cause:c}))))}})(),()=>{o?.stop(),i=!0}},[r,n,s]),t},hF=()=>{const[t,e]=S.useState(null),r=$1(),s=uF(),n=ie(F1),i=aF();return lF(),S.useEffect(()=>{t===null||s===void 0||(s.renderIn(t),t.addEventListener("touchstart",o=>o.preventDefault(),{passive:!1}))},[s,t]),S.useEffect(()=>{s?.resizeTo(n)},[n,s]),p.jsxs(p.Fragment,{children:[p.jsx("div",{tabIndex:0,className:"fixed top-0",style:i,ref:e}),p.jsxs(e0,{gameApi:s,children:[p.jsxs(oF,{children:[p.jsx(VC,{}),p.jsx(sF,{}),p.jsx(iF,{}),p.jsx(cD,{})]}),s&&r&&p.jsx(S.Suspense,{fallback:null,children:p.jsx(cF,{})})]})]})},wh=4,fa=20,dF=({textureId:t,spritesheetSize:e})=>{const{frame:r}=Nt.frames[t];return p.jsx("div",{className:"absolute border hover:bg-white",style:{left:`${r.x/e.x*100}%`,top:`${r.y/e.y*100}%`,width:`${r.w/e.x*100}%`,height:`${r.h/e.y*100}%`}})},fF=()=>{const[t,e]=S.useState(null),[r,s]=S.useState(null),n=S.useRef(null),i=S.useRef(null);S.useEffect(()=>{const c=()=>{n.current&&s({x:n.current.naturalWidth,y:n.current.naturalHeight})},u=n.current;if(u)if(u.complete)c();else return u.addEventListener("load",c),()=>u.removeEventListener("load",c)},[]);const o=c=>{if(!n.current||!r)return;const u=n.current.getBoundingClientRect(),h=r.x/u.width,d=r.y/u.height,f=Math.floor((c.clientX-u.left)*h),m=Math.floor((c.clientY-u.top)*d);f>=0&&f<r.x&&m>=0&&m<r.y&&e({x:f,y:m})},a=()=>{e(null)},l=Object.keys(Nt.frames).sort();return p.jsxs("div",{ref:i,className:"relative w-full",onMouseMove:o,onMouseLeave:a,children:[p.jsx("img",{ref:n,src:qw,className:"w-full cursor-crosshair [background:repeating-conic-gradient(#999_0_25%,_#888_0_50%)_50%_/_20px_20px] pixelated"}),r&&l.map(c=>p.jsx(dF,{textureId:c,spritesheetSize:r},c)),t&&r&&n.current&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"absolute pointer-events-none border bg-pink outline-2",style:{left:`${t.x/r.x*100}%`,top:`${t.y/r.y*100}%`,width:`${1/r.x*100}%`,height:`${1/r.y*100}%`}}),p.jsxs("div",{className:"absolute pointer-events-none bg-black text-white px-1 text-xs font-mono",style:{left:`${t.x/r.x*100}%`,top:`calc(${t.y/r.y*100}% + 40px)`,transform:"translate(8px, -100%)"},children:[t.x,",",t.y]})]})]})},pF=()=>{const t=Object.keys(Nt.frames).sort();return p.jsxs(p.Fragment,{children:[p.jsx(fF,{}),p.jsx("title",{children:"Sprites"}),p.jsx("div",{className:"flex flex-wrap p-[8px] bg-pureBlack",children:t.map(e=>{const{frame:r}=Nt.frames[e],s=r;return p.jsxs("div",{className:"bg-shadow m-[8px] p-[16px] text-center flex flex-col",children:[p.jsx("div",{className:"sprite bg-shadow hover:bg-pink hover:border-white border-shadow border-1 mb-1 box-content mx-auto w-min",style:{"--x":`${Nt.frames[e].frame.x}px`,"--y":`${Nt.frames[e].frame.y}px`,"--h":`${Nt.frames[e].frame.h}px`,"--w":`${Nt.frames[e].frame.w}px`},children:s.pivot?p.jsx("div",{className:"border-midRed relative",style:{borderWidth:"2px",borderRadius:"50%",width:`${fa}px`,height:`${fa}px`,left:`${s.pivot.x*wh-fa/2}px`,top:`${s.pivot.y*wh-fa/2}px`}}):null}),p.jsx("div",{className:"flex-grow"}),p.jsx("div",{className:"text-moss",children:e}),p.jsxs("div",{className:"text-lightGrey",children:[r.w,"x",r.h]}),p.jsx("div",{className:"text-midRed",children:s.pivot?p.jsxs(p.Fragment,{children:["pivot: (",s.pivot.x,",",s.pivot.y,")"]}):"no pivot"}),p.jsxs("div",{className:"text-midGrey",children:["@(",r.x,",",r.y,")"]})]},e)})})]})},mF=()=>p.jsx(An,{scaleFactor:wh,children:p.jsx(pF,{})}),gF=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"loading-border"}),p.jsxs(ke,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:qn.map(t=>p.jsx("span",{className:`sprite ${Tn({action:"walking",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(F,{className:"sprites-double-height",children:"404 Not found"}),p.jsx(F,{className:`${qe} p-1 pt-2 text-metallicBlue`,children:"whatever youre looking for, it aint here"})]}),p.jsx("div",{className:"flex flex-col",children:qn.toReversed().map(t=>p.jsx("span",{className:`sprite ${Tn({action:"walking",character:"heels",facingXy8:t})}`},t))})]})]}),AF=()=>p.jsxs(Oe,{children:[p.jsx(Ue,{className:"loading-border"}),p.jsxs(ke,{className:"bg-white zx:bg-zxRed gap-y-0 text-redShadow zx:text-zxBlack px-1 flex-row",children:[p.jsx("div",{className:"flex flex-col",children:qn.map(t=>p.jsx("span",{className:`sprite ${Tn({action:"idle",character:"head",facingXy8:t})}`},t))}),p.jsxs("div",{className:"flex flex-col grow text-center justify-center",children:[p.jsx(F,{className:"sprites-double-height mb-1",children:"This is not the editor"}),p.jsxs(xt,{className:`${qe} p-1 pt-2 text-metallicBlue`,children:[p.jsx("p",{children:"If youre seeing this, youre trying to access the level editor, but the web manifest is getting in the way and redirected you to the games client-side routing."}),p.jsxs("p",{className:"pt-1",children:["You could try going to:"," ",p.jsx("a",{href:"/editor/",className:"bitmap-text-link",children:"/editor/"})," ","(with a slash on the end)"]})]})]}),p.jsx("div",{className:"flex flex-col",children:qn.toReversed().map(t=>p.jsx("span",{className:`sprite ${Tn({action:"idle",character:"heels",facingXy8:t})}`},t))})]})]}),Gq=$r(),cy=Gq.get("campaignName");cy!==null&&xe.dispatch(Fi({campaignLocator:{userId:Gq.get("campaignAuthorUserId")||"editorUser",campaignName:cy,version:-1},noShowCrowns:!0}));const yF=()=>{const t=pd();return S.useEffect(()=>{document.body.classList.toggle("zx",t),document.body.classList.toggle("colourised",!t)},[t]),p.jsxs(zv,{children:[p.jsx(wo,{path:"/",children:p.jsx(An,{children:p.jsx(oI,{children:p.jsx(hF,{})})})}),p.jsx(wo,{path:"/sprites",children:p.jsx(mF,{})}),p.jsx(wo,{path:"/editor",children:p.jsx(An,{children:p.jsx(AF,{})})}),p.jsx(wo,{children:p.jsx(An,{children:p.jsx(gF,{})})})]})},xF=()=>p.jsx(hv,{store:xe,children:p.jsx(yF,{})}),oU=Object.freeze(Object.defineProperty({__proto__:null,App:xF},Symbol.toStringTag,{value:"Module"}));export{BE as $,fT as A,kt as B,go as C,Qe as D,ee as E,Rr as F,bs as G,xb as H,rr as I,IP as J,Fm as K,iE as L,me as M,Fe as N,De as O,mt as P,Um as Q,Ku as R,Li as S,Ct as T,Fa as U,zP as V,Ac as W,$m as X,OP as Y,lt as Z,qb as _,Ar as a,PF as a$,tT as a0,sT as a1,lT as a2,uT as a3,hT as a4,fl as a5,xM as a6,xv as a7,Nd as a8,Dj as a9,kL as aA,CN as aB,rs as aC,xn as aD,fh as aE,t2 as aF,Gz as aG,Br as aH,Lz as aI,re as aJ,$t as aK,H0 as aL,Q0 as aM,zt as aN,Ie as aO,$i as aP,Cg as aQ,xe as aR,Bs as aS,IF as aT,lx as aU,ma as aV,GL as aW,v_ as aX,LF as aY,YL as aZ,TL as a_,Lj as aa,Uj as ab,$j as ac,Gj as ad,Yj as ae,Wj as af,Hj as ag,Rj as ah,Ae as ai,OB as aj,F as ak,An as al,Zh as am,GF as an,KF as ao,eL as ap,On as aq,Gy as ar,cC as as,dC as at,Ce as au,Rn as av,EN as aw,WF as ax,ks as ay,tL as az,EE as b,ot as b$,sU as b0,af as b1,$F as b2,Qi as b3,ae as b4,V0 as b5,vt as b6,qF as b7,Jy as b8,ye as b9,$L as bA,zn as bB,Kr as bC,LL as bD,FL as bE,BL as bF,dL as bG,ON as bH,df as bI,XN as bJ,Uz as bK,QN as bL,sy as bM,Ma as bN,Ft as bO,ur as bP,Tr as bQ,Z as bR,Ky as bS,hC as bT,eo as bU,ZD as bV,JF as bW,ZF as bX,dz as bY,CL as bZ,DA as b_,j0 as ba,R0 as bb,M0 as bc,EF as bd,Wh as be,C0 as bf,Or as bg,bz as bh,Yh as bi,xh as bj,fn as bk,qn as bl,v0 as bm,TF as bn,P0 as bo,QF as bp,fL as bq,KN as br,Eq as bs,bL as bt,uz as bu,Vq as bv,yz as bw,MA as bx,MF as by,HL as bz,Ui as c,Ti as c$,jL as c0,ft as c1,vq as c2,zN as c3,hL as c4,Lq as c5,Mn as c6,gf as c7,Ki as c8,ZL as c9,oL as cA,Ot as cB,SL as cC,G as cD,ux as cE,jF as cF,H1 as cG,_w as cH,$M as cI,QM as cJ,Oi as cK,KO as cL,PL as cM,W1 as cN,cu as cO,iU as cP,ed as cQ,rU as cR,VF as cS,qz as cT,w_ as cU,Ih as cV,Bn as cW,Kh as cX,yh as cY,co as cZ,RA as c_,hM as ca,Nt as cb,qu as cc,iL as cd,rb as ce,Aa as cf,Ke as cg,Xh as ch,wL as ci,Ye as cj,Qy as ck,lz as cl,RL as cm,iC as cn,je as co,Wr as cp,wl as cq,JL as cr,VL as cs,Rs as ct,Qh as cu,zC as cv,WL as cw,QL as cx,KL as cy,Du as cz,Be as d,Ad as d$,t0 as d0,BF as d1,IL as d2,nL as d3,ax as d4,RF as d5,ix as d6,tU as d7,ox as d8,uo as d9,mf as dA,$z as dB,Xx as dC,JN as dD,mh as dE,mz as dF,SF as dG,kF as dH,CF as dI,XL as dJ,hf as dK,cz as dL,xz as dM,NL as dN,DL as dO,qL as dP,Sq as dQ,UL as dR,vL as dS,xL as dT,pL as dU,mL as dV,_L as dW,AL as dX,gL as dY,EL as dZ,_N as d_,ML as da,ff as db,vF as dc,un as dd,gu as de,oN as df,Iz as dg,E0 as dh,Sr as di,my as dj,yL as dk,cf as dl,X1 as dm,Q1 as dn,Gr as dp,I0 as dq,Dq as dr,Pt as ds,_F as dt,Ts as du,Xy as dv,gC as dw,yd as dx,Hz as dy,bh as dz,Et as e,Si as e0,rL as e1,HF as e2,YF as e3,gd as e4,OL as e5,zL as e6,sL as e7,nU as e8,XF as e9,xC as ea,rP as eb,eU as ec,lR as ed,nw as ee,sg as ef,tg as eg,Rg as eh,pR as ei,nP as ej,Da as ek,rh as el,Eg as em,aw as en,oU as eo,rg as f,kE as g,ba as h,_d as i,Rb as j,yr as k,Gb as l,kg as m,eT as n,rT as o,oT as p,cT as q,AP as r,Yb as s,Sd as t,pe as u,pt as v,Ee as w,sP as x,ul as y,Lb as z};
